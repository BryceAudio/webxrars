/*! For license information please see main.ba8dc4f0348d7754b624.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=874)}([function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(this,n(27))},function(e,t,n){(function(t){var r,i=void 0!==t?t:"undefined"!=typeof window?window:{},a=n(1036);"undefined"!=typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"])||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=a),e.exports=r}).call(this,n(27))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=void 0,t=[],n={},r={};function i(e,n){for(var r in t){var i=t[r];if(i.context===e&&i.name===n)return i.instance}return null}function a(e,t){return t[e]}function o(e,t,n){e in n&&(n[e]=t)}function s(t,n,r){var i=void 0,a=t.__dashjs_factory_name,o=n[a];if(o){var s=o.instance;if(!o.override)return s.apply({context:n,factory:e},r);for(var u in i=t.apply({context:n},r),s=s.apply({context:n,factory:e,parent:i},r))i.hasOwnProperty(u)&&(i[u]=s[u])}else i=t.apply({context:n},r);return i.getClassName=function(){return a},i}return e={extend:function(e,t,n,r){!r[e]&&t&&(r[e]={instance:t,override:n})},getSingletonInstance:i,setSingletonInstance:function(e,n,r){for(var i in t){var a=t[i];if(a.context===e&&a.name===n)return void(t[i].instance=r)}t.push({name:n,context:e,instance:r})},getSingletonFactory:function(e){var r=a(e.__dashjs_factory_name,n);return r||(r=function(n){var r=void 0;return void 0===n&&(n={}),{getInstance:function(){return r||(r=i(n,e.__dashjs_factory_name)),r||(r=s(e,n,arguments),t.push({name:e.__dashjs_factory_name,context:n,instance:r})),r}}},n[e.__dashjs_factory_name]=r),r},getSingletonFactoryByName:function(e){return a(e,n)},updateSingletonFactory:function(e,t){o(e,t,n)},getClassFactory:function(e){var t=a(e.__dashjs_factory_name,r);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return s(e,t,arguments)}}},r[e.__dashjs_factory_name]=t),t},getClassFactoryByName:function(e){return a(e,r)},updateClassFactory:function(e,t){o(e,t,r)}}}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=void 0,t=[],n={},r={};function i(e,n){for(var r in t){var i=t[r];if(i.context===e&&i.name===n)return i.instance}return null}function a(e,t){return t[e]}function o(e,t,n){e in n&&(n[e]=t)}function s(t,n,r){var i=void 0,a=t.__dashjs_factory_name,o=n[a];if(o){var s=o.instance;if(!o.override)return s.apply({context:n,factory:e},r);for(var u in i=t.apply({context:n},r),s=s.apply({context:n,factory:e,parent:i},r))i.hasOwnProperty(u)&&(i[u]=s[u])}else i=t.apply({context:n},r);return i.getClassName=function(){return a},i}return e={extend:function(e,t,n,r){!r[e]&&t&&(r[e]={instance:t,override:n})},getSingletonInstance:i,setSingletonInstance:function(e,n,r){for(var i in t){var a=t[i];if(a.context===e&&a.name===n)return void(t[i].instance=r)}t.push({name:n,context:e,instance:r})},getSingletonFactory:function(e){var r=a(e.__dashjs_factory_name,n);return r||(r=function(n){var r=void 0;return void 0===n&&(n={}),{getInstance:function(){return r||(r=i(n,e.__dashjs_factory_name)),r||(r=s(e,n,arguments),t.push({name:e.__dashjs_factory_name,context:n,instance:r})),r}}},n[e.__dashjs_factory_name]=r),r},getSingletonFactoryByName:function(e){return a(e,n)},updateSingletonFactory:function(e,t){o(e,t,n)},getClassFactory:function(e){var t=a(e.__dashjs_factory_name,r);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return s(e,t,arguments)}}},r[e.__dashjs_factory_name]=t),t},getClassFactoryByName:function(e){return a(e,r)},updateClassFactory:function(e,t){o(e,t,r)}}}();t.default=r,e.exports=t.default},function(e,t){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}},function(e,t,n){"use strict";var r=n(0),i=n.n(r),a=n(1),o=n.n(a),s=n(98),u=n.n(s),l=n(8),c=n.n(l),d=(n(1037),n(1039),n(4)),h=n.n(d),f=n(699),p=n.n(f),m=n(7),g=n.n(m),v=n(169),y=n.n(v),_=n(170),b=n.n(_),E=n(700),T=n.n(E),S=n(701),w=n.n(S),A=n(121),x=n.n(A);function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var R=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},t.trigger=function(e){var t,n,r,i=this.listeners[e];if(i)if(2===arguments.length)for(n=i.length,t=0;t<n;++t)i[t].call(this,arguments[1]);else for(r=Array.prototype.slice.call(arguments,1),n=i.length,t=0;t<n;++t)i[t].apply(this,r)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}(),I=function(e){function t(){var t;return(t=e.call(this)||this).buffer="",t}return C(t,e),t.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(R),O=function(e){for(var t,n=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),r={},i=n.length;i--;)""!==n[i]&&((t=/([^=]*)=(.*)/.exec(n[i]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),r[t[0]]=t[1]);return r},D=function(e){function t(){var t;return(t=e.call(this)||this).customParsers=[],t.tagMappers=[],t}C(t,e);var n=t.prototype;return n.push=function(e){var t,n,r=this;0!==(e=e.trim()).length&&("#"===e[0]?this.tagMappers.reduce((function(t,n){var r=n(e);return r===e?t:t.concat([r])}),[e]).forEach((function(e){for(var i=0;i<r.customParsers.length;i++)if(r.customParsers[i].call(r,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))r.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return n={type:"tag",tagType:"inf"},t[1]&&(n.duration=parseFloat(t[1])),t[2]&&(n.title=t[2]),void r.trigger("data",n);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"targetduration"},t[1]&&(n.duration=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"totalduration"},t[1]&&(n.duration=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"version"},t[1]&&(n.version=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={type:"tag",tagType:"media-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return n={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(n.number=parseInt(t[1],10)),void r.trigger("data",n);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return n={type:"tag",tagType:"playlist-type"},t[1]&&(n.playlistType=t[1]),void r.trigger("data",n);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return n={type:"tag",tagType:"byterange"},t[1]&&(n.length=parseInt(t[1],10)),t[2]&&(n.offset=parseInt(t[2],10)),void r.trigger("data",n);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return n={type:"tag",tagType:"allow-cache"},t[1]&&(n.allowed=!/NO/.test(t[1])),void r.trigger("data",n);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(n={type:"tag",tagType:"map"},t[1]){var a=O(t[1]);if(a.URI&&(n.uri=a.URI),a.BYTERANGE){var o=a.BYTERANGE.split("@"),s=o[0],u=o[1];n.byterange={},s&&(n.byterange.length=parseInt(s,10)),u&&(n.byterange.offset=parseInt(u,10))}}r.trigger("data",n)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(n={type:"tag",tagType:"stream-inf"},t[1]){if(n.attributes=O(t[1]),n.attributes.RESOLUTION){var l=n.attributes.RESOLUTION.split("x"),c={};l[0]&&(c.width=parseInt(l[0],10)),l[1]&&(c.height=parseInt(l[1],10)),n.attributes.RESOLUTION=c}n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes["PROGRAM-ID"]&&(n.attributes["PROGRAM-ID"]=parseInt(n.attributes["PROGRAM-ID"],10))}r.trigger("data",n)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return n={type:"tag",tagType:"media"},t[1]&&(n.attributes=O(t[1])),void r.trigger("data",n);if(t=/^#EXT-X-ENDLIST/.exec(e))r.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))r.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return n={type:"tag",tagType:"program-date-time"},t[1]&&(n.dateTimeString=t[1],n.dateTimeObject=new Date(t[1])),void r.trigger("data",n);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return n={type:"tag",tagType:"key"},t[1]&&(n.attributes=O(t[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2).toLowerCase()&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void r.trigger("data",n);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return n={type:"tag",tagType:"start"},t[1]&&(n.attributes=O(t[1]),n.attributes["TIME-OFFSET"]=parseFloat(n.attributes["TIME-OFFSET"]),n.attributes.PRECISE=/YES/.test(n.attributes.PRECISE)),void r.trigger("data",n);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-out-cont"},t[1]?n.data=t[1]:n.data="",void r.trigger("data",n);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-out"},t[1]?n.data=t[1]:n.data="",void r.trigger("data",n);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return n={type:"tag",tagType:"cue-in"},t[1]?n.data=t[1]:n.data="",void r.trigger("data",n);r.trigger("data",{type:"tag",data:e.slice(4)})}}}else r.trigger("data",{type:"comment",text:e.slice(1)})})):this.trigger("data",{type:"uri",uri:e}))},n.addParser=function(e){var t=this,n=e.expression,r=e.customType,i=e.dataParser,a=e.segment;"function"!=typeof i&&(i=function(e){return e}),this.customParsers.push((function(e){if(n.exec(e))return t.trigger("data",{type:"custom",data:i(e),customType:r,segment:a}),!0}))},n.addTagMapper=function(e){var t=e.expression,n=e.map;this.tagMappers.push((function(e){return t.test(e)?n(e):e}))},t}(R);function P(e){for(var t=i.a.atob(e||""),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}var L=function(e){function t(){var t;(t=e.call(this)||this).lineStream=new I,t.parseStream=new D,t.lineStream.pipe(t.parseStream);var n,r,i=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),a=[],o={},s=function(){},u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},l=0;return t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},t.parseStream.on("data",(function(e){var t,c;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&(o.byterange=t,t.length=e.length,"offset"in e||(this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0)),"offset"in e&&(o.byterange=t,t.offset=e.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>0&&(o.duration=e.duration),0===e.duration&&(o.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===e.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:P(e.attributes.URI.split(",")[1])}}):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),r={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(r.iv=e.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else r=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,l=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){n={},e.uri&&(n.uri=e.uri),e.byterange&&(n.byterange=e.byterange)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||u,e.attributes?(o.attributes||(o.attributes={}),M(o.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var n=this.manifest.mediaGroups[e.attributes.TYPE];n[e.attributes["GROUP-ID"]]=n[e.attributes["GROUP-ID"]]||{},t=n[e.attributes["GROUP-ID"]],(c={default:/yes/i.test(e.attributes.DEFAULT)}).default?c.autoselect=!0:c.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(c.language=e.attributes.LANGUAGE),e.attributes.URI&&(c.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(c.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(c.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(c.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=c}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){l+=1,o.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),o.dateTimeString=e.dateTimeString,o.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},totalduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){o.cueOut=e.data},"cue-out-cont":function(){o.cueOutCont=e.data},"cue-in":function(){o.cueIn=e.data}}[e.tagType]||s).call(i)},uri:function(){o.uri=e.uri,a.push(o),this.manifest.targetDuration&&!("duration"in o)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),o.duration=this.manifest.targetDuration),r&&(o.key=r),o.timeline=l,n&&(o.map=n),o={}},comment:function(){},custom:function(){e.segment?(o.custom=o.custom||{},o.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(i)})),t}C(t,e);var n=t.prototype;return n.push=function(e){this.lineStream.push(e)},n.end=function(){this.lineStream.push("\n")},n.addParser=function(e){this.parseStream.addParser(e)},n.addTagMapper=function(e){this.parseStream.addTagMapper(e)},t}(R),N=n(127),k=n.n(N),F=n(702),B=n.n(F),U=n(703),j=function(e){return!!e&&"object"==typeof e},G=function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.reduce((function(t,n){return Object.keys(n).forEach((function(r){Array.isArray(t[r])&&Array.isArray(n[r])?t[r]=t[r].concat(n[r]):j(t[r])&&j(n[r])?t[r]=e(t[r],n[r]):t[r]=n[r]})),t}),{})},H=function(e){return e.reduce((function(e,t){return e.concat(t)}),[])},V=function(e){if(!e.length)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t},z="INVALID_NUMBER_OF_PERIOD",W="DASH_EMPTY_MANIFEST",q="DASH_INVALID_XML",Y="NO_BASE_URL",K="SEGMENT_TIME_UNSPECIFIED",X="UNSUPPORTED_UTC_TIMING_SCHEME",Q=function(e){var t=e.baseUrl,n=void 0===t?"":t,r=e.source,i=void 0===r?"":r,a=e.range,o=void 0===a?"":a,s=e.indexRange,u=void 0===s?"":s,l={uri:i,resolvedUri:k()(n||"",i)};if(o||u){var c=(o||u).split("-"),d=parseInt(c[0],10),h=parseInt(c[1],10);l.byterange={length:h-d+1,offset:d}}return l},Z={static:function(e){var t=e.duration,n=e.timescale,r=void 0===n?1:n,i=e.sourceDuration;return{start:0,end:Math.ceil(i/(t/r))}},dynamic:function(e){var t=e.NOW,n=e.clientOffset,r=e.availabilityStartTime,i=e.timescale,a=void 0===i?1:i,o=e.duration,s=e.start,u=void 0===s?0:s,l=e.minimumUpdatePeriod,c=void 0===l?0:l,d=e.timeShiftBufferDepth,h=void 0===d?1/0:d,f=(t+n)/1e3,p=r+u,m=f+c-p,g=Math.ceil(m*a/o),v=Math.floor((f-p-h)*a/o),y=Math.floor((f-p)*a/o);return{start:Math.max(0,v),end:Math.min(g,y)}}},J=function(e){var t=e.type,n=void 0===t?"static":t,r=e.duration,i=e.timescale,a=void 0===i?1:i,o=e.sourceDuration,s=Z[n](e),u=function(e,t){for(var n=[],r=e;r<t;r++)n.push(r);return n}(s.start,s.end).map(function(e){return function(t,n){var r=e.duration,i=e.timescale,a=void 0===i?1:i,o=e.periodIndex,s=e.startNumber;return{number:(void 0===s?1:s)+t,duration:r/a,timeline:o,time:n*r}}}(e));if("static"===n){var l=u.length-1;u[l].duration=o-r/a*l}return u},$=function(e){var t=e.baseUrl,n=e.initialization,r=void 0===n?{}:n,i=e.sourceDuration,a=e.timescale,o=void 0===a?1:a,s=e.indexRange,u=void 0===s?"":s,l=e.duration;if(!t)throw new Error(Y);var c=Q({baseUrl:t,source:r.sourceURL,range:r.range}),d=Q({baseUrl:t,source:t,indexRange:u});if(d.map=c,l){var h=J(e);h.length&&(d.duration=h[0].duration,d.timeline=h[0].timeline)}else i&&(d.duration=i/o,d.timeline=0);return d.number=0,[d]},ee=function(e,t,n){for(var r=e.sidx.map?e.sidx.map:null,i=e.sidx.duration,a=e.timeline||0,o=e.sidx.byterange,s=o.offset+o.length,u=t.timescale,l=t.references.filter((function(e){return 1!==e.referenceType})),c=[],d=s+t.firstOffset,h=0;h<l.length;h++){var f=t.references[h],p=f.referencedSize,m=f.subsegmentDuration,g=$({baseUrl:n,timescale:u,timeline:a,periodIndex:a,duration:m,sourceDuration:i,indexRange:d+"-"+(d+p-1)})[0];r&&(g.map=r),c.push(g),d+=p}return e.segments=c,e},te=function(e){var t;return(t=e.reduce((function(e,t){var n,r=t.attributes.id+(t.attributes.lang||"");return e[r]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(n=e[r].segments).push.apply(n,t.segments),t.attributes.contentProtection&&(e[r].attributes.contentProtection=t.attributes.contentProtection)):e[r]=t,e}),{}),Object.keys(t).map((function(e){return t[e]}))).map((function(e){var t,n;return e.discontinuityStarts=(t=e.segments,n="discontinuity",t.reduce((function(e,t,r){return t[n]&&e.push(r),e}),[])),e}))},ne=function(e,t){if(void 0===t&&(t={}),!Object.keys(t).length)return e;for(var n in e){var r=e[n];if(r.sidx){var i=r.sidx.uri+"-"+(o=r.sidx.byterange,s=void 0,s=o.offset+o.length-1,o.offset+"-"+s),a=t[i]&&t[i].sidx;r.sidx&&a&&ee(r,a,r.sidx.resolvedUri)}}var o,s;return e},re=function(e){var t,n=e.attributes,r=e.segments,i=e.sidx,a={attributes:(t={NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:r,mediaSequence:r.length?r[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),i&&(a.sidx=i),a},ie=function(e){var t,n=e.attributes,r=e.segments,i=e.sidx,a={attributes:(t={NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:r,mediaSequence:r.length?r[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),i&&(a.sidx=i),a},ae=function(e,t){var n;if(void 0===t&&(t={}),!e.length)return{};var r=e[0].attributes,i=r.sourceDuration,a=r.type,o=void 0===a?"static":a,s=r.suggestedPresentationDelay,u=r.minimumUpdatePeriod,l=void 0===u?0:u,c=te(e.filter((function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType}))).map(ie),d=te(e.filter((function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType}))),h=e.filter((function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType})),f={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(n={AUDIO:{},VIDEO:{}},n["CLOSED-CAPTIONS"]={},n.SUBTITLES={},n),uri:"",duration:i,playlists:ne(c,t),minimumUpdatePeriod:1e3*l};return"dynamic"===o&&(f.suggestedPresentationDelay=s),d.length&&(f.mediaGroups.AUDIO.audio=function(e,t){var n;void 0===t&&(t={});var r=e.reduce((function(e,r){var i=r.attributes.role&&r.attributes.role.value||"",a=r.attributes.lang||"",o="main";if(a){var s=i?" ("+i+")":"";o=""+r.attributes.lang+s}return e[o]&&e[o].playlists[0].attributes.BANDWIDTH>r.attributes.bandwidth||(e[o]={language:a,autoselect:!0,default:"main"===i,playlists:ne([re(r)],t),uri:""},void 0===n&&"main"===i&&((n=r).default=!0)),e}),{});return n||(r[Object.keys(r)[0]].default=!0),r}(d,t)),h.length&&(f.mediaGroups.SUBTITLES.subs=function(e,t){return void 0===t&&(t={}),e.reduce((function(e,n){var r,i,a,o,s=n.attributes.lang||"text";return e[s]||(e[s]={language:s,default:!1,autoselect:!1,playlists:ne([(r=n,a=r.attributes,o=r.segments,void 0===o&&(o=[{uri:a.baseUrl,timeline:a.periodIndex,resolvedUri:a.baseUrl||"",duration:a.sourceDuration,number:0}],a.duration=a.sourceDuration),{attributes:(i={NAME:a.id,BANDWIDTH:a.bandwidth},i["PROGRAM-ID"]=1,i),uri:"",endList:"static"===(a.type||"static"),timeline:a.periodIndex,resolvedUri:a.baseUrl||"",targetDuration:a.duration,segments:o,mediaSequence:o.length?o[0].number:1})],t),uri:""}),e}),{})}(h,t)),f},oe=function(e,t,n){var r=e.NOW,i=e.clientOffset,a=e.availabilityStartTime,o=e.timescale,s=void 0===o?1:o,u=e.start,l=void 0===u?0:u,c=e.minimumUpdatePeriod,d=(r+i)/1e3+(void 0===c?0:c)-(a+l);return Math.ceil((d*s-t)/n)},se=function(e,t){for(var n=e.type,r=void 0===n?"static":n,i=e.minimumUpdatePeriod,a=void 0===i?0:i,o=e.media,s=void 0===o?"":o,u=e.sourceDuration,l=e.timescale,c=void 0===l?1:l,d=e.startNumber,h=void 0===d?1:d,f=e.periodIndex,p=[],m=-1,g=0;g<t.length;g++){var v=t[g],y=v.d,_=v.r||0,b=v.t||0;m<0&&(m=b),b&&b>m&&(m=b);var E=void 0;if(_<0){var T=g+1;E=T===t.length?"dynamic"===r&&a>0&&s.indexOf("$Number$")>0?oe(e,m,y):(u*c-m)/y:(t[T].t-m)/y}else E=_+1;for(var S=h+p.length+E,w=h+p.length;w<S;)p.push({number:w,duration:y/c,time:m,timeline:f}),m+=y,w++}return p},ue=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,le=function(e,t){return e.replace(ue,function(e){return function(t,n,r,i){if("$$"===t)return"$";if(void 0===e[n])return t;var a=""+e[n];return"RepresentationID"===n?a:(i=r?parseInt(i,10):1,a.length>=i?a:""+new Array(i-a.length+1).join("0")+a)}}(t))},ce=function(e,t){var n={RepresentationID:e.id,Bandwidth:e.bandwidth||0},r=e.initialization,i=void 0===r?{sourceURL:"",range:""}:r,a=Q({baseUrl:e.baseUrl,source:le(i.sourceURL,n),range:i.range});return function(e,t){return e.duration||t?e.duration?J(e):se(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}(e,t).map((function(t){n.Number=t.number,n.Time=t.time;var r=le(e.media||"",n);return{uri:r,timeline:t.timeline,duration:t.duration,resolvedUri:k()(e.baseUrl||"",r),map:a,number:t.number}}))},de=function(e,t){var n=e.duration,r=e.segmentUrls,i=void 0===r?[]:r;if(!n&&!t||n&&t)throw new Error(K);var a,o=i.map((function(t){return function(e,t){var n=e.baseUrl,r=e.initialization,i=void 0===r?{}:r,a=Q({baseUrl:n,source:i.sourceURL,range:i.range}),o=Q({baseUrl:n,source:t.media,range:t.mediaRange});return o.map=a,o}(e,t)}));return n&&(a=J(e)),t&&(a=se(e,t)),a.map((function(e,t){if(o[t]){var n=o[t];return n.timeline=e.timeline,n.duration=e.duration,n.number=e.number,n}})).filter((function(e){return e}))},he=function(e){var t,n,r=e.attributes,i=e.segmentInfo;i.template?(n=ce,t=G(r,i.template)):i.base?(n=$,t=G(r,i.base)):i.list&&(n=de,t=G(r,i.list));var a={attributes:r};if(!n)return a;var o=n(t,i.timeline);if(t.duration){var s=t,u=s.duration,l=s.timescale,c=void 0===l?1:l;t.duration=u/c}else o.length?t.duration=o.reduce((function(e,t){return Math.max(e,Math.ceil(t.duration))}),0):t.duration=0;return a.attributes=t,a.segments=o,i.base&&t.indexRange&&(a.sidx=o[0],a.segments=[]),a},fe=function(e,t){return V(e.childNodes).filter((function(e){return e.tagName===t}))},pe=function(e){return e.textContent.trim()},me=function(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t)return 0;var n=t.slice(1),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5];return 31536e3*parseFloat(r||0)+2592e3*parseFloat(i||0)+86400*parseFloat(a||0)+3600*parseFloat(o||0)+60*parseFloat(s||0)+parseFloat(u||0)},ge={mediaPresentationDuration:function(e){return me(e)},availabilityStartTime:function(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(t=e)&&(t+="Z"),Date.parse(t)/1e3;var t},minimumUpdatePeriod:function(e){return me(e)},suggestedPresentationDelay:function(e){return me(e)},type:function(e){return e},timeShiftBufferDepth:function(e){return me(e)},start:function(e){return me(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?me(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}},ve=function(e){return e&&e.attributes?V(e.attributes).reduce((function(e,t){var n=ge[t.name]||ge.DEFAULT;return e[t.name]=n(t.value),e}),{}):{}},ye={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},_e=function(e,t){return t.length?H(e.map((function(e){return t.map((function(t){return k()(e,pe(t))}))}))):e},be=function(e){var t=fe(e,"SegmentTemplate")[0],n=fe(e,"SegmentList")[0],r=n&&fe(n,"SegmentURL").map((function(e){return G({tag:"SegmentURL"},ve(e))})),i=fe(e,"SegmentBase")[0],a=n||t,o=a&&fe(a,"SegmentTimeline")[0],s=n||i||t,u=s&&fe(s,"Initialization")[0],l=t&&ve(t);l&&u?l.initialization=u&&ve(u):l&&l.initialization&&(l.initialization={sourceURL:l.initialization});var c={template:l,timeline:o&&fe(o,"S").map((function(e){return ve(e)})),list:n&&G(ve(n),{segmentUrls:r,initialization:ve(u)}),base:i&&G(ve(i),{initialization:ve(u)})};return Object.keys(c).forEach((function(e){c[e]||delete c[e]})),c},Ee=function(e,t,n){return function(r){var i=ve(r),a=_e(t,fe(r,"BaseURL")),o=fe(r,"Role")[0],s={role:ve(o)},u=G(e,i,s),l=fe(r,"ContentProtection").reduce((function(e,t){var n=ve(t),r=ye[n.schemeIdUri];if(r){e[r]={attributes:n};var i=fe(t,"cenc:pssh")[0];if(i){var a=pe(i),o=a&&B()(a);e[r].pssh=o}}return e}),{});Object.keys(l).length&&(u=G(u,{contentProtection:l}));var c=be(r),d=fe(r,"Representation"),h=G(n,c);return H(d.map(function(e,t,n){return function(r){var i=fe(r,"BaseURL"),a=_e(t,i),o=G(e,ve(r)),s=be(r);return a.map((function(e){return{segmentInfo:G(n,s),attributes:G(o,{baseUrl:e})}}))}}(u,a,h)))}},Te=function(e,t){void 0===t&&(t={});var n=t,r=n.manifestUri,a=void 0===r?"":r,o=n.NOW,s=void 0===o?Date.now():o,u=n.clientOffset,l=void 0===u?0:u,c=fe(e,"Period");if(!c.length)throw new Error(z);var d=ve(e),h=_e([a],fe(e,"BaseURL"));return d.sourceDuration=d.mediaPresentationDuration||0,d.NOW=s,d.clientOffset=l,H(c.map(function(e,t){return function(n,r){var a=_e(t,fe(n,"BaseURL")),o=ve(n),s=parseInt(o.id,10),u=i.a.isNaN(s)?r:s,l=G(e,{periodIndex:u}),c=fe(n,"AdaptationSet"),d=be(n);return H(c.map(Ee(l,a,d)))}}(d,h)))},Se=function(e){if(""===e)throw new Error(W);var t=(new U.DOMParser).parseFromString(e,"application/xml"),n=t&&"MPD"===t.documentElement.tagName?t.documentElement:null;if(!n||n&&n.getElementsByTagName("parsererror").length>0)throw new Error(q);return n},we=function(e,t){return void 0===t&&(t={}),ae(Te(Se(e),t).map(he),t.sidxMapping)},Ae=function(e){return function(e){var t=fe(e,"UTCTiming")[0];if(!t)return null;var n=ve(t);switch(n.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":n.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":n.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":n.method="DIRECT",n.value=Date.parse(n.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(X)}return n}(Se(e))},xe=n(120),Me=n.n(xe),Ce=n(82),Re=n.n(Ce),Ie=n(704),Oe=n.n(Ie),De=n(705),Pe=n.n(De);var Le=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Ne=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),ke=null,Fe=function(){function e(t){Le(this,e),ke||(ke=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],r=t[4],i=n[4],a=void 0,o=void 0,s=void 0,u=[],l=[],c=void 0,d=void 0,h=void 0,f=void 0,p=void 0;for(a=0;a<256;a++)l[(u[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!r[o];o^=c||1,s=l[s]||1)for(h=(h=s^s<<1^s<<2^s<<3^s<<4)>>8^255&h^99,r[o]=h,i[h]=o,p=16843009*u[d=u[c=u[o]]]^65537*d^257*c^16843008*o,f=257*u[h]^16843008*h,a=0;a<4;a++)t[a][o]=f=f<<24^f>>>8,n[a][h]=p=p<<24^p>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e}()),this._tables=[[ke[0][0].slice(),ke[0][1].slice(),ke[0][2].slice(),ke[0][3].slice(),ke[0][4].slice()],[ke[1][0].slice(),ke[1][1].slice(),ke[1][2].slice(),ke[1][3].slice(),ke[1][4].slice()]];var n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=this._tables[0][4],u=this._tables[1],l=t.length,c=1;if(4!==l&&6!==l&&8!==l)throw new Error("Invalid aes key size");for(a=t.slice(0),o=[],this._key=[a,o],n=l;n<4*l+28;n++)i=a[n-1],(n%l==0||8===l&&n%l==4)&&(i=s[i>>>24]<<24^s[i>>16&255]<<16^s[i>>8&255]<<8^s[255&i],n%l==0&&(i=i<<8^i>>>24^c<<24,c=c<<1^283*(c>>7))),a[n]=a[n-l]^i;for(r=0;n;r++,n--)i=a[3&r?n:n-4],o[r]=n<=4||r<4?i:u[0][s[i>>>24]]^u[1][s[i>>16&255]]^u[2][s[i>>8&255]]^u[3][s[255&i]]}return e.prototype.decrypt=function(e,t,n,r,i,a){var o=this._key[1],s=e^o[0],u=r^o[1],l=n^o[2],c=t^o[3],d=void 0,h=void 0,f=void 0,p=o.length/4-2,m=void 0,g=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],E=v[3],T=v[4];for(m=0;m<p;m++)d=y[s>>>24]^_[u>>16&255]^b[l>>8&255]^E[255&c]^o[g],h=y[u>>>24]^_[l>>16&255]^b[c>>8&255]^E[255&s]^o[g+1],f=y[l>>>24]^_[c>>16&255]^b[s>>8&255]^E[255&u]^o[g+2],c=y[c>>>24]^_[s>>16&255]^b[u>>8&255]^E[255&l]^o[g+3],g+=4,s=d,u=h,l=f;for(m=0;m<4;m++)i[(3&-m)+a]=T[s>>>24]<<24^T[u>>16&255]<<16^T[l>>8&255]<<8^T[255&c]^o[g++],d=s,s=u,u=l,l=c,c=d},e}(),Be=function(){function e(){Le(this,e),this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},e.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,r=0;r<n;++r)t[r].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,i)},e.prototype.dispose=function(){this.listeners={}},e.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}(),Ue=function(e){function t(){Le(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,Be));return n.jobs=[],n.delay=1,n.timeout_=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},t.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(Be),je=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},Ge=function(e,t,n){var r=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),i=new Fe(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),s=void 0,u=void 0,l=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0;for(s=n[0],u=n[1],l=n[2],c=n[3],m=0;m<r.length;m+=4)d=je(r[m]),h=je(r[m+1]),f=je(r[m+2]),p=je(r[m+3]),i.decrypt(d,h,f,p,o,m),o[m]=je(o[m]^s),o[m+1]=je(o[m+1]^u),o[m+2]=je(o[m+2]^l),o[m+3]=je(o[m+3]^c),s=d,u=h,l=f,c=p;return a},He=function(){function e(t,n,r,i){Le(this,e);var a=e.STEP,o=new Int32Array(t.buffer),s=new Uint8Array(t.byteLength),u=0;for(this.asyncStream_=new Ue,this.asyncStream_.push(this.decryptChunk_(o.subarray(u,u+a),n,r,s)),u=a;u<o.length;u+=a)r=new Uint32Array([je(o[u-4]),je(o[u-3]),je(o[u-2]),je(o[u-1])]),this.asyncStream_.push(this.decryptChunk_(o.subarray(u,u+a),n,r,s));this.asyncStream_.push((function(){var e;i(null,(e=s).subarray(0,e.byteLength-e[e.byteLength-1]))}))}return e.prototype.decryptChunk_=function(e,t,n,r){return function(){var i=Ge(e,t,n);r.set(i,e.byteOffset)}},Ne(e,null,[{key:"STEP",get:function(){return 32e3}}]),e}(),Ve="7.8.4",ze=[];var We=function e(t){var n,r="info",a=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n("log",r,t)};return n=function(e,t){return function(n,r,a){var o=t.levels[r],s=new RegExp("^("+o+")$");if("log"!==n&&a.unshift(n.toUpperCase()+":"),a.unshift(e+":"),ze){ze.push([].concat(a));var u=ze.length-1e3;ze.splice(0,u>0?u:0)}if(i.a.console){var l=i.a.console[n];l||"debug"!==n||(l=i.a.console.info||i.a.console.log),l&&o&&s.test(n)&&l[Array.isArray(a)?"apply":"call"](i.a.console,a)}}}(t,a),a.createLogger=function(n){return e(t+": "+n)},a.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:r},a.level=function(e){if("string"==typeof e){if(!a.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');r=e}return r},(a.history=function(){return ze?[].concat(ze):[]}).filter=function(e){return(ze||[]).filter((function(t){return new RegExp(".*"+e+".*").test(t[0])}))},a.history.clear=function(){ze&&(ze.length=0)},a.history.disable=function(){null!==ze&&(ze.length=0,ze=null)},a.history.enable=function(){null===ze&&(ze=[])},a.error=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n("error",r,t)},a.warn=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n("warn",r,t)},a.debug=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return n("debug",r,t)},a}("VIDEOJS"),qe=We.createLogger,Ye=Object.prototype.toString,Ke=function(e){return Ze(e)?Object.keys(e):[]};function Xe(e,t){Ke(e).forEach((function(n){return t(e[n],n)}))}function Qe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object.assign?u.a.apply(void 0,[e].concat(n)):(n.forEach((function(t){t&&Xe(t,(function(t,n){e[n]=t}))})),e)}function Ze(e){return!!e&&"object"==typeof e}function Je(e){return Ze(e)&&"[object Object]"===Ye.call(e)&&e.constructor===Object}function $e(e,t){if(!e||!t)return"";if("function"==typeof i.a.getComputedStyle){var n=i.a.getComputedStyle(e);return n?n.getPropertyValue(t)||n[t]:""}return""}function et(e){return"string"==typeof e&&Boolean(e.trim())}function tt(e){if(e.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function nt(){return o.a===i.a.document}function rt(e){return Ze(e)&&1===e.nodeType}function it(){try{return i.a.parent!==i.a.self}catch(e){return!0}}function at(e){return function(t,n){if(!et(t))return o.a[e](null);et(n)&&(n=o.a.querySelector(n));var r=rt(n)?n:o.a;return r[e]&&r[e](t)}}function ot(e,t,n,r){void 0===e&&(e="div"),void 0===t&&(t={}),void 0===n&&(n={});var i=o.a.createElement(e);return Object.getOwnPropertyNames(t).forEach((function(e){var n=t[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(We.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set "+e+" to "+n+"."),i.setAttribute(e,n)):"textContent"===e?st(i,n):i[e]!==n&&(i[e]=n)})),Object.getOwnPropertyNames(n).forEach((function(e){i.setAttribute(e,n[e])})),r&&xt(i,r),i}function st(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function ut(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function lt(e,t){return tt(t),e.classList?e.classList.contains(t):(n=t,new RegExp("(^|\\s)"+n+"($|\\s)")).test(e.className);var n}function ct(e,t){return e.classList?e.classList.add(t):lt(e,t)||(e.className=(e.className+" "+t).trim()),e}function dt(e,t){return e.classList?e.classList.remove(t):(tt(t),e.className=e.className.split(/\s+/).filter((function(e){return e!==t})).join(" ")),e}function ht(e,t,n){var r=lt(e,t);if("function"==typeof n&&(n=n(e,t)),"boolean"!=typeof n&&(n=!r),n!==r)return n?ct(e,t):dt(e,t),e}function ft(e,t){Object.getOwnPropertyNames(t).forEach((function(n){var r=t[n];null==r||!1===r?e.removeAttribute(n):e.setAttribute(n,!0===r?"":r)}))}function pt(e){var t={},n=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(e&&e.attributes&&e.attributes.length>0)for(var r=e.attributes,i=r.length-1;i>=0;i--){var a=r[i].name,o=r[i].value;"boolean"!=typeof e[a]&&-1===n.indexOf(","+a+",")||(o=null!==o),t[a]=o}return t}function mt(e,t){return e.getAttribute(t)}function gt(e,t,n){e.setAttribute(t,n)}function vt(e,t){e.removeAttribute(t)}function yt(){o.a.body.focus(),o.a.onselectstart=function(){return!1}}function _t(){o.a.onselectstart=function(){return!0}}function bt(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach((function(e){void 0!==t[e]&&(n[e]=t[e])})),n.height||(n.height=parseFloat($e(e,"height"))),n.width||(n.width=parseFloat($e(e,"width"))),n}}function Et(e){var t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var n=o.a.documentElement,r=o.a.body,a=n.clientLeft||r.clientLeft||0,s=i.a.pageXOffset||r.scrollLeft,u=t.left+s-a,l=n.clientTop||r.clientTop||0,c=i.a.pageYOffset||r.scrollTop,d=t.top+c-l;return{left:Math.round(u),top:Math.round(d)}}function Tt(e,t){var n={},r=Et(e),i=e.offsetWidth,a=e.offsetHeight,o=r.top,s=r.left,u=t.pageY,l=t.pageX;return t.changedTouches&&(l=t.changedTouches[0].pageX,u=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(o-u+a)/a)),n.x=Math.max(0,Math.min(1,(l-s)/i)),n}function St(e){return Ze(e)&&3===e.nodeType}function wt(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function At(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map((function(e){return"function"==typeof e&&(e=e()),rt(e)||St(e)?e:"string"==typeof e&&/\S/.test(e)?o.a.createTextNode(e):void 0})).filter((function(e){return e}))}function xt(e,t){return At(t).forEach((function(t){return e.appendChild(t)})),e}function Mt(e,t){return xt(wt(e),t)}function Ct(e){return void 0===e.button&&void 0===e.buttons||(0===e.button&&void 0===e.buttons||("mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons))}var Rt,It=at("querySelector"),Ot=at("querySelectorAll"),Dt=Object.freeze({__proto__:null,isReal:nt,isEl:rt,isInFrame:it,createEl:ot,textContent:st,prependTo:ut,hasClass:lt,addClass:ct,removeClass:dt,toggleClass:ht,setAttributes:ft,getAttributes:pt,getAttribute:mt,setAttribute:gt,removeAttribute:vt,blockTextSelection:yt,unblockTextSelection:_t,getBoundingClientRect:bt,findPosition:Et,getPointerPosition:Tt,isTextNode:St,emptyEl:wt,normalizeContent:At,appendContent:xt,insertContent:Mt,isSingleLeftClick:Ct,$:It,$$:Ot}),Pt=!1,Lt=function(){if(nt()&&!1!==Rt.options.autoSetup){var e=Array.prototype.slice.call(o.a.getElementsByTagName("video")),t=Array.prototype.slice.call(o.a.getElementsByTagName("audio")),n=Array.prototype.slice.call(o.a.getElementsByTagName("video-js")),r=e.concat(t,n);if(r&&r.length>0)for(var i=0,a=r.length;i<a;i++){var s=r[i];if(!s||!s.getAttribute){Nt(1);break}void 0===s.player&&null!==s.getAttribute("data-setup")&&Rt(s)}else Pt||Nt(1)}};function Nt(e,t){t&&(Rt=t),i.a.setTimeout(Lt,e)}function kt(){Pt=!0,i.a.removeEventListener("load",kt)}nt()&&("complete"===o.a.readyState?kt():i.a.addEventListener("load",kt));var Ft,Bt=function(e){var t=o.a.createElement("style");return t.className=e,t},Ut=function(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t},jt=3;function Gt(){return jt++}i.a.WeakMap||(Ft=function(){function e(){this.vdata="vdata"+Math.floor(i.a.performance&&i.a.performance.now()||Date.now()),this.data={}}var t=e.prototype;return t.set=function(e,t){var n=e[this.vdata]||Gt();return e[this.vdata]||(e[this.vdata]=n),this.data[n]=t,this},t.get=function(e){var t=e[this.vdata];if(t)return this.data[t];We("We have no data for this element",e)},t.has=function(e){return e[this.vdata]in this.data},t.delete=function(e){var t=e[this.vdata];t&&(delete this.data[t],delete e[this.vdata])},e}());var Ht,Vt=i.a.WeakMap?new WeakMap:new Ft;function zt(e,t){if(Vt.has(e)){var n=Vt.get(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&Vt.delete(e)}}function Wt(e,t,n,r){n.forEach((function(n){e(t,n,r)}))}function qt(e){if(e.fixed_)return e;function t(){return!0}function n(){return!1}if(!e||!e.isPropagationStopped){var r=e||i.a.event;for(var a in e={},r)"layerX"!==a&&"layerY"!==a&&"keyLocation"!==a&&"webkitMovementX"!==a&&"webkitMovementY"!==a&&("returnValue"===a&&r.preventDefault||(e[a]=r[a]));if(e.target||(e.target=e.srcElement||o.a),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){r.preventDefault&&r.preventDefault(),e.returnValue=!1,r.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),e.cancelBubble=!0,r.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=n,e.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=n,null!==e.clientX&&void 0!==e.clientX){var s=o.a.documentElement,u=o.a.body;e.pageX=e.clientX+(s&&s.scrollLeft||u&&u.scrollLeft||0)-(s&&s.clientLeft||u&&u.clientLeft||0),e.pageY=e.clientY+(s&&s.scrollTop||u&&u.scrollTop||0)-(s&&s.clientTop||u&&u.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e.fixed_=!0,e}var Yt=["touchstart","touchmove"];function Kt(e,t,n){if(Array.isArray(t))return Wt(Kt,e,t,n);Vt.has(e)||Vt.set(e,{});var r=Vt.get(e);if(r.handlers||(r.handlers={}),r.handlers[t]||(r.handlers[t]=[]),n.guid||(n.guid=Gt()),r.handlers[t].push(n),r.dispatcher||(r.disabled=!1,r.dispatcher=function(t,n){if(!r.disabled){t=qt(t);var i=r.handlers[t.type];if(i)for(var a=i.slice(0),o=0,s=a.length;o<s&&!t.isImmediatePropagationStopped();o++)try{a[o].call(e,t,n)}catch(e){We.error(e)}}}),1===r.handlers[t].length)if(e.addEventListener){var a=!1;(function(){if("boolean"!=typeof Ht){Ht=!1;try{var e=Object.defineProperty({},"passive",{get:function(){Ht=!0}});i.a.addEventListener("test",null,e),i.a.removeEventListener("test",null,e)}catch(e){}}return Ht})()&&Yt.indexOf(t)>-1&&(a={passive:!0}),e.addEventListener(t,r.dispatcher,a)}else e.attachEvent&&e.attachEvent("on"+t,r.dispatcher)}function Xt(e,t,n){if(Vt.has(e)){var r=Vt.get(e);if(r.handlers){if(Array.isArray(t))return Wt(Xt,e,t,n);var i=function(e,t){r.handlers[t]=[],zt(e,t)};if(void 0!==t){var a=r.handlers[t];if(a)if(n){if(n.guid)for(var o=0;o<a.length;o++)a[o].guid===n.guid&&a.splice(o--,1);zt(e,t)}else i(e,t)}else for(var s in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},s)&&i(e,s)}}}function Qt(e,t,n){var r=Vt.has(e)?Vt.get(e):{},i=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=qt(t),r.dispatcher&&r.dispatcher.call(e,t,n),i&&!t.isPropagationStopped()&&!0===t.bubbles)Qt.call(null,i,t,n);else if(!i&&!t.defaultPrevented&&t.target&&t.target[t.type]){Vt.has(t.target)||Vt.set(t.target,{});var a=Vt.get(t.target);t.target[t.type]&&(a.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function Zt(e,t,n){if(Array.isArray(t))return Wt(Zt,e,t,n);var r=function r(){Xt(e,t,r),n.apply(this,arguments)};r.guid=n.guid=n.guid||Gt(),Kt(e,t,r)}function Jt(e,t,n){var r=function r(){Xt(e,t,r),n.apply(this,arguments)};r.guid=n.guid=n.guid||Gt(),Kt(e,t,r)}var $t,en=Object.freeze({__proto__:null,fixEvent:qt,on:Kt,off:Xt,trigger:Qt,one:Zt,any:Jt}),tn=30,nn=function(e,t,n){t.guid||(t.guid=Gt());var r=t.bind(e);return r.guid=n?n+"_"+t.guid:t.guid,r},rn=function(e,t){var n=i.a.performance.now();return function(){var r=i.a.performance.now();r-n>=t&&(e.apply(void 0,arguments),n=r)}},an=function(){};an.prototype.allowedEvents_={},an.prototype.on=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},Kt(this,e,t),this.addEventListener=n},an.prototype.addEventListener=an.prototype.on,an.prototype.off=function(e,t){Xt(this,e,t)},an.prototype.removeEventListener=an.prototype.off,an.prototype.one=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},Zt(this,e,t),this.addEventListener=n},an.prototype.any=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},Jt(this,e,t),this.addEventListener=n},an.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=qt(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),Qt(this,e)},an.prototype.dispatchEvent=an.prototype.trigger,an.prototype.queueTrigger=function(e){var t=this;$t||($t=new Map);var n=e.type||e,r=$t.get(this);r||(r=new Map,$t.set(this,r));var a=r.get(n);r.delete(n),i.a.clearTimeout(a);var o=i.a.setTimeout((function(){0===r.size&&(r=null,$t.delete(t)),t.trigger(e)}),0);r.set(n,o)};var on=function(e){return e instanceof an||!!e.eventBusEl_&&["on","one","off","trigger"].every((function(t){return"function"==typeof e[t]}))},sn=function(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length},un=function(e){if(!e.nodeName&&!on(e))throw new Error("Invalid target; must be a DOM node or evented object.")},ln=function(e){if(!sn(e))throw new Error("Invalid event type; must be a non-empty string or array.")},cn=function(e){if("function"!=typeof e)throw new Error("Invalid listener; must be a function.")},dn=function(e,t){var n,r,i,a=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return a?(n=e.eventBusEl_,t.length>=3&&t.shift(),r=t[0],i=t[1]):(n=t[0],r=t[1],i=t[2]),un(n),ln(r),cn(i),{isTargetingSelf:a,target:n,type:r,listener:i=nn(e,i)}},hn=function(e,t,n,r){un(e),e.nodeName?en[t](e,n,r):e[t](n,r)},fn={on:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=dn(this,n),a=i.isTargetingSelf,o=i.target,s=i.type,u=i.listener;if(hn(o,"on",s,u),!a){var l=function(){return e.off(o,s,u)};l.guid=u.guid;var c=function(){return e.off("dispose",l)};c.guid=u.guid,hn(this,"on","dispose",l),hn(o,"on","dispose",c)}},one:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=dn(this,n),a=i.isTargetingSelf,o=i.target,s=i.type,u=i.listener;if(a)hn(o,"one",s,u);else{var l=function t(){e.off(o,s,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];u.apply(null,r)};l.guid=u.guid,hn(o,"one",s,l)}},any:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=dn(this,n),a=i.isTargetingSelf,o=i.target,s=i.type,u=i.listener;if(a)hn(o,"any",s,u);else{var l=function t(){e.off(o,s,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];u.apply(null,r)};l.guid=u.guid,hn(o,"any",s,l)}},off:function(e,t,n){if(!e||sn(e))Xt(this.eventBusEl_,e,t);else{var r=e,i=t;un(r),ln(i),cn(n),n=nn(this,n),this.off("dispose",n),r.nodeName?(Xt(r,i,n),Xt(r,"dispose",n)):on(r)&&(r.off(i,n),r.off("dispose",n))}},trigger:function(e,t){return Qt(this.eventBusEl_,e,t)}};function pn(e,t){void 0===t&&(t={});var n=t.eventBusKey;if(n){if(!e[n].nodeName)throw new Error('The eventBusKey "'+n+'" does not refer to an element.');e.eventBusEl_=e[n]}else e.eventBusEl_=ot("span",{className:"vjs-event-bus"});return Qe(e,fn),e.eventedCallbacks&&e.eventedCallbacks.forEach((function(e){e()})),e.on("dispose",(function(){e.off(),i.a.setTimeout((function(){e.eventBusEl_=null}),0)})),e}var mn={state:{},setState:function(e){var t,n=this;return"function"==typeof e&&(e=e()),Xe(e,(function(e,r){n.state[r]!==e&&((t=t||{})[r]={from:n.state[r],to:e}),n.state[r]=e})),t&&on(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function gn(e,t){return Qe(e,mn),e.state=Qe({},e.state,t),"function"==typeof e.handleStateChanged&&on(e)&&e.on("statechanged",e.handleStateChanged),e}var vn=function(e){return"string"!=typeof e?e:e.replace(/./,(function(e){return e.toLowerCase()}))},yn=function(e){return"string"!=typeof e?e:e.replace(/./,(function(e){return e.toUpperCase()}))};function _n(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){t&&Xe(t,(function(t,n){Je(t)?(Je(e[n])||(e[n]={}),e[n]=_n(e[n],t)):e[n]=t}))})),e}var bn=function(){function e(e,t,n){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=_n({},this.options_),t=this.options_=_n(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var r=e&&e.id&&e.id()||"no_player";this.id_=r+"_component_"+Gt()}var a;this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&pn(this,{eventBusKey:this.el_?"el_":null}),gn(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},i.a.Set||(a=function(){function e(){this.set_={}}var t=e.prototype;return t.has=function(e){return e in this.set_},t.delete=function(e){var t=this.has(e);return delete this.set_[e],t},t.add=function(e){return this.set_[e]=1,this},t.forEach=function(e,t){for(var n in this.set_)e.call(t,n,n,this)},e}()),this.setTimeoutIds_=i.a.Set?new Set:new a,this.setIntervalIds_=i.a.Set?new Set:new a,this.rafIds_=i.a.Set?new Set:new a,this.clearingTimersOnDispose_=!1,!1!==t.initChildren&&this.initChildren(),this.ready(n),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var t=e.prototype;return t.dispose=function(){if(!this.isDisposed_){if(this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var e=this.children_.length-1;e>=0;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),Vt.has(this.el_)&&Vt.delete(this.el_),this.el_=null),this.player_=null}},t.isDisposed=function(){return Boolean(this.isDisposed_)},t.player=function(){return this.player_},t.options=function(e){return e?(this.options_=_n(this.options_,e),this.options_):this.options_},t.el=function(){return this.el_},t.createEl=function(e,t,n){return ot(e,t,n)},t.localize=function(e,t,n){void 0===n&&(n=e);var r=this.player_.language&&this.player_.language(),i=this.player_.languages&&this.player_.languages(),a=i&&i[r],o=r&&r.split("-")[0],s=i&&i[o],u=n;return a&&a[e]?u=a[e]:s&&s[e]&&(u=s[e]),t&&(u=u.replace(/\{(\d+)\}/g,(function(e,n){var r=t[n-1],i=r;return void 0===r&&(i=e),i}))),u},t.contentEl=function(){return this.contentEl_||this.el_},t.id=function(){return this.id_},t.name=function(){return this.name_},t.children=function(){return this.children_},t.getChildById=function(e){return this.childIndex_[e]},t.getChild=function(e){if(e)return this.childNameIndex_[e]},t.getDescendant=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t=t.reduce((function(e,t){return e.concat(t)}),[]);for(var r=this,i=0;i<t.length;i++)if(!(r=r.getChild(t[i]))||!r.getChild)return;return r},t.addChild=function(t,n,r){var i,a;if(void 0===n&&(n={}),void 0===r&&(r=this.children_.length),"string"==typeof t){a=yn(t);var o=n.componentClass||a;n.name=a;var s=e.getComponent(o);if(!s)throw new Error("Component "+o+" does not exist");if("function"!=typeof s)return null;i=new s(this.player_||this,n)}else i=t;if(i.parentComponent_&&i.parentComponent_.removeChild(i),this.children_.splice(r,0,i),i.parentComponent_=this,"function"==typeof i.id&&(this.childIndex_[i.id()]=i),(a=a||i.name&&yn(i.name()))&&(this.childNameIndex_[a]=i,this.childNameIndex_[vn(a)]=i),"function"==typeof i.el&&i.el()){var u=null;this.children_[r+1]&&(this.children_[r+1].el_?u=this.children_[r+1].el_:rt(this.children_[r+1])&&(u=this.children_[r+1])),this.contentEl().insertBefore(i.el(),u)}return i},t.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,n=this.children_.length-1;n>=0;n--)if(this.children_[n]===e){t=!0,this.children_.splice(n,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[yn(e.name())]=null,this.childNameIndex_[vn(e.name())]=null;var r=e.el();r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},t.initChildren=function(){var t=this,n=this.options_.children;if(n){var r,i=this.options_,a=e.getComponent("Tech");(r=Array.isArray(n)?n:Object.keys(n)).concat(Object.keys(this.options_).filter((function(e){return!r.some((function(t){return"string"==typeof t?e===t:e===t.name}))}))).map((function(e){var r,i;return"string"==typeof e?i=n[r=e]||t.options_[r]||{}:(r=e.name,i=e),{name:r,opts:i}})).filter((function(t){var n=e.getComponent(t.opts.componentClass||yn(t.name));return n&&!a.isTech(n)})).forEach((function(e){var n=e.name,r=e.opts;if(void 0!==i[n]&&(r=i[n]),!1!==r){!0===r&&(r={}),r.playerOptions=t.options_.playerOptions;var a=t.addChild(n,r);a&&(t[n]=a)}}))}},t.buildCSSClass=function(){return""},t.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},t.triggerReady=function(){this.isReady_=!0,this.setTimeout((function(){var e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach((function(e){e.call(this)}),this),this.trigger("ready")}),1)},t.$=function(e,t){return It(e,t||this.contentEl())},t.$$=function(e,t){return Ot(e,t||this.contentEl())},t.hasClass=function(e){return lt(this.el_,e)},t.addClass=function(e){ct(this.el_,e)},t.removeClass=function(e){dt(this.el_,e)},t.toggleClass=function(e,t){ht(this.el_,e,t)},t.show=function(){this.removeClass("vjs-hidden")},t.hide=function(){this.addClass("vjs-hidden")},t.lockShowing=function(){this.addClass("vjs-lock-showing")},t.unlockShowing=function(){this.removeClass("vjs-lock-showing")},t.getAttribute=function(e){return mt(this.el_,e)},t.setAttribute=function(e,t){gt(this.el_,e,t)},t.removeAttribute=function(e){vt(this.el_,e)},t.width=function(e,t){return this.dimension("width",e,t)},t.height=function(e,t){return this.dimension("height",e,t)},t.dimensions=function(e,t){this.width(e,!0),this.height(t)},t.dimension=function(e,t,n){if(void 0!==t)return null!==t&&t==t||(t=0),-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var r=this.el_.style[e],i=r.indexOf("px");return-1!==i?parseInt(r.slice(0,i),10):parseInt(this.el_["offset"+yn(e)],10)},t.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(t=$e(this.el_,e),0===(t=parseFloat(t))||isNaN(t)){var n="offset"+yn(e);t=this.el_[n]}return t},t.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.currentWidth=function(){return this.currentDimension("width")},t.currentHeight=function(){return this.currentDimension("height")},t.focus=function(){this.el_.focus()},t.blur=function(){this.el_.blur()},t.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},t.handleKeyPress=function(e){this.handleKeyDown(e)},t.emitTapEvents=function(){var e,t=0,n=null;this.on("touchstart",(function(r){1===r.touches.length&&(n={pageX:r.touches[0].pageX,pageY:r.touches[0].pageY},t=i.a.performance.now(),e=!0)})),this.on("touchmove",(function(t){if(t.touches.length>1)e=!1;else if(n){var r=t.touches[0].pageX-n.pageX,i=t.touches[0].pageY-n.pageY;Math.sqrt(r*r+i*i)>10&&(e=!1)}}));var r=function(){e=!1};this.on("touchleave",r),this.on("touchcancel",r),this.on("touchend",(function(r){(n=null,!0===e)&&(i.a.performance.now()-t<200&&(r.preventDefault(),this.trigger("tap")))}))},t.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=nn(this.player(),this.player().reportUserActivity);this.on("touchstart",(function(){t(),this.clearInterval(e),e=this.setInterval(t,250)}));var n=function(n){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",n),this.on("touchcancel",n)}},t.setTimeout=function(e,t){var n,r=this;return e=nn(this,e),this.clearTimersOnDispose_(),n=i.a.setTimeout((function(){r.setTimeoutIds_.has(n)&&r.setTimeoutIds_.delete(n),e()}),t),this.setTimeoutIds_.add(n),n},t.clearTimeout=function(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),i.a.clearTimeout(e)),e},t.setInterval=function(e,t){e=nn(this,e),this.clearTimersOnDispose_();var n=i.a.setInterval(e,t);return this.setIntervalIds_.add(n),n},t.clearInterval=function(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),i.a.clearInterval(e)),e},t.requestAnimationFrame=function(e){var t,n=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),e=nn(this,e),t=i.a.requestAnimationFrame((function(){n.rafIds_.has(t)&&n.rafIds_.delete(t),e()})),this.rafIds_.add(t),t):this.setTimeout(e,1e3/60)},t.cancelAnimationFrame=function(e){return this.supportsRaf_?(this.rafIds_.has(e)&&(this.rafIds_.delete(e),i.a.cancelAnimationFrame(e)),e):this.clearTimeout(e)},t.clearTimersOnDispose_=function(){var e=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",(function(){[["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach((function(t){var n=t[0],r=t[1];e[n].forEach(e[r],e)})),e.clearingTimersOnDispose_=!1})))},e.registerComponent=function(t,n){if("string"!=typeof t||!t)throw new Error('Illegal component name, "'+t+'"; must be a non-empty string.');var r,i=e.getComponent("Tech"),a=i&&i.isTech(n),o=e===n||e.prototype.isPrototypeOf(n.prototype);if(a||!o)throw r=a?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+t+'"; '+r+".");t=yn(t),e.components_||(e.components_={});var s=e.getComponent("Player");if("Player"===t&&s&&s.players){var u=s.players,l=Object.keys(u);if(u&&l.length>0&&l.map((function(e){return u[e]})).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return e.components_[t]=n,e.components_[vn(t)]=n,n},e.getComponent=function(t){if(t&&e.components_)return e.components_[t]},e}();bn.prototype.supportsRaf_="function"==typeof i.a.requestAnimationFrame&&"function"==typeof i.a.cancelAnimationFrame,bn.registerComponent("Component",bn);var En,Tn=i.a.navigator&&i.a.navigator.userAgent||"",Sn=/AppleWebKit\/([\d.]+)/i.exec(Tn),wn=Sn?parseFloat(Sn.pop()):null,An=/iPod/i.test(Tn),xn=(En=Tn.match(/OS (\d+)_/i))&&En[1]?En[1]:null,Mn=/Android/i.test(Tn),Cn=function(){var e=Tn.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),Rn=Mn&&Cn<5&&wn<537,In=/Firefox/i.test(Tn),On=/Edg/i.test(Tn),Dn=!On&&(/Chrome/i.test(Tn)||/CriOS/i.test(Tn)),Pn=function(){var e=Tn.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null}(),Ln=function(){var e=/MSIE\s(\d+)\.\d/.exec(Tn),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(Tn)&&/rv:11.0/.test(Tn)&&(t=11),t}(),Nn=/Safari/i.test(Tn)&&!Dn&&!Mn&&!On,kn=/Windows/i.test(Tn),Fn=nt()&&("ontouchstart"in i.a||i.a.navigator.maxTouchPoints||i.a.DocumentTouch&&i.a.document instanceof i.a.DocumentTouch),Bn=/iPad/i.test(Tn)||Nn&&Fn&&!/iPhone/i.test(Tn),Un=/iPhone/i.test(Tn)&&!Bn,jn=Un||Bn||An,Gn=(Nn||jn)&&!Dn,Hn=Object.freeze({__proto__:null,IS_IPOD:An,IOS_VERSION:xn,IS_ANDROID:Mn,ANDROID_VERSION:Cn,IS_NATIVE_ANDROID:Rn,IS_FIREFOX:In,IS_EDGE:On,IS_CHROME:Dn,CHROME_VERSION:Pn,IE_VERSION:Ln,IS_SAFARI:Nn,IS_WINDOWS:kn,TOUCH_ENABLED:Fn,IS_IPAD:Bn,IS_IPHONE:Un,IS_IOS:jn,IS_ANY_SAFARI:Gn});function Vn(e,t,n,r){return function(e,t,n){if("number"!=typeof t||t<0||t>n)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+n+").")}(e,r,n.length-1),n[r][t]}function zn(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:Vn.bind(null,"start",0,e),end:Vn.bind(null,"end",1,e)}}function Wn(e,t){return Array.isArray(e)?zn(e):void 0===e||void 0===t?zn():zn([[e,t]])}function qn(e,t){var n,r,i=0;if(!t)return 0;e&&e.length||(e=Wn(0,0));for(var a=0;a<e.length;a++)n=e.start(a),(r=e.end(a))>t&&(r=t),i+=r-n;return i/t}for(var Yn,Kn={prefixed:!0},Xn=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],Qn=Xn[0],Zn=0;Zn<Xn.length;Zn++)if(Xn[Zn][1]in o.a){Yn=Xn[Zn];break}if(Yn){for(var Jn=0;Jn<Yn.length;Jn++)Kn[Qn[Jn]]=Yn[Jn];Kn.prefixed=Yn[0]!==Qn[0]}function $n(e){if(e instanceof $n)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:Ze(e)&&("number"==typeof e.code&&(this.code=e.code),Qe(this,e)),this.message||(this.message=$n.defaultMessages[this.code]||"")}$n.prototype.code=0,$n.prototype.message="",$n.prototype.status=null,$n.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],$n.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var er=0;er<$n.errorTypes.length;er++)$n[$n.errorTypes[er]]=er,$n.prototype[$n.errorTypes[er]]=er;function tr(e){return null!=e&&"function"==typeof e.then}function nr(e){tr(e)&&e.then(null,(function(e){}))}var rr=function(e){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((function(t,n,r){return e[n]&&(t[n]=e[n]),t}),{cues:e.cues&&Array.prototype.map.call(e.cues,(function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}}))})},ir=function(e){var t=e.$$("track"),n=Array.prototype.map.call(t,(function(e){return e.track}));return Array.prototype.map.call(t,(function(e){var t=rr(e.track);return e.src&&(t.src=e.src),t})).concat(Array.prototype.filter.call(e.textTracks(),(function(e){return-1===n.indexOf(e)})).map(rr))},ar=function(e,t){return e.forEach((function(e){var n=t.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach((function(e){return n.addCue(e)}))})),t.textTracks()},or=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).opened_=r.hasBeenOpened_=r.hasBeenFilled_=!1,r.closeable(!r.options_.uncloseable),r.content(r.options_.content),r.contentEl_=ot("div",{className:"vjs-modal-dialog-content"},{role:"document"}),r.descEl_=ot("p",{className:"vjs-modal-dialog-description vjs-control-text",id:r.el().getAttribute("aria-describedby")}),st(r.descEl_,r.description()),r.el_.appendChild(r.descEl_),r.el_.appendChild(r.contentEl_),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},n.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return"vjs-modal-dialog vjs-hidden "+e.prototype.buildCSSClass.call(this)},n.label=function(){return this.localize(this.options_.label||"Modal Window")},n.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},n.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},n.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},n.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},n.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,n=this.getChild("closeButton");if(t&&!n){var r=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=r,this.on(n,"close",this.close)}!t&&n&&(this.off(n,"close",this.close),this.removeChild(n),n.dispose())}return this.closeable_},n.fill=function(){this.fillWith(this.content())},n.fillWith=function(e){var t=this.contentEl(),n=t.parentNode,r=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(t),this.empty(),Mt(t,e),this.trigger("modalfill"),r?n.insertBefore(t,r):n.appendChild(t);var i=this.getChild("closeButton");i&&n.appendChild(i.el_)},n.empty=function(){this.trigger("beforemodalempty"),wt(this.contentEl()),this.trigger("modalempty")},n.content=function(e){return void 0!==e&&(this.content_=e),this.content_},n.conditionalFocus_=function(){var e=o.a.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())},n.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},n.handleKeyDown=function(e){if(e.stopPropagation(),g.a.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(g.a.isEventKey(e,"Tab")){for(var t,n=this.focusableEls_(),r=this.el_.querySelector(":focus"),i=0;i<n.length;i++)if(r===n[i]){t=i;break}o.a.activeElement===this.el_&&(t=0),e.shiftKey&&0===t?(n[n.length-1].focus(),e.preventDefault()):e.shiftKey||t!==n.length-1||(n[0].focus(),e.preventDefault())}},n.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,(function(e){return(e instanceof i.a.HTMLAnchorElement||e instanceof i.a.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof i.a.HTMLInputElement||e instanceof i.a.HTMLSelectElement||e instanceof i.a.HTMLTextAreaElement||e instanceof i.a.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof i.a.HTMLIFrameElement||e instanceof i.a.HTMLObjectElement||e instanceof i.a.HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")}))},t}(bn);or.prototype.options_={pauseOnOpen:!0,temporary:!0},bn.registerComponent("ModalDialog",or);var sr=function(e){function t(t){var n;void 0===t&&(t=[]),(n=e.call(this)||this).tracks_=[],Object.defineProperty(c()(n),"length",{get:function(){return this.tracks_.length}});for(var r=0;r<t.length;r++)n.addTrack(t[r]);return n}h()(t,e);var n=t.prototype;return n.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this}))},n.removeTrack=function(e){for(var t,n=0,r=this.length;n<r;n++)if(this[n]===e){(t=this[n]).off&&t.off(),this.tracks_.splice(n,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},n.getTrackById=function(e){for(var t=null,n=0,r=this.length;n<r;n++){var i=this[n];if(i.id===e){t=i;break}}return t},t}(an);for(var ur in sr.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},sr.prototype.allowedEvents_)sr.prototype["on"+ur]=null;var lr=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].enabled=!1)},cr=function(e){function t(t){var n;void 0===t&&(t=[]);for(var r=t.length-1;r>=0;r--)if(t[r].enabled){lr(t,t[r]);break}return(n=e.call(this,t)||this).changing_=!1,n}h()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.enabled&&lr(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.enabledChange_=function(){n.changing_||(n.changing_=!0,lr(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)},t}(sr),dr=function(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].selected=!1)},hr=function(e){function t(t){var n;void 0===t&&(t=[]);for(var r=t.length-1;r>=0;r--)if(t[r].selected){dr(t,t[r]);break}return(n=e.call(this,t)||this).changing_=!1,Object.defineProperty(c()(n),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),n}h()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;t.selected&&dr(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.selectedChange_=function(){n.changing_||(n.changing_=!0,dr(n,t),n.changing_=!1,n.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)},t}(sr),fr=function(e){function t(){return e.apply(this,arguments)||this}h()(t,e);var n=t.prototype;return n.addTrack=function(t){var n=this;e.prototype.addTrack.call(this,t),this.queueChange_||(this.queueChange_=function(){return n.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return n.trigger("selectedlanguagechange")}),t.addEventListener("modechange",this.queueChange_);-1===["metadata","chapters"].indexOf(t.kind)&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)},n.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},t}(sr),pr=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,n=e.length;t<n;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,n=0,r=this.trackElements_.length;n<r;n++)if(e===this.trackElements_[n].track){t=this.trackElements_[n];break}return t},t.removeTrackElement_=function(e){for(var t=0,n=this.trackElements_.length;t<n;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"==typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"==typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},e}(),mr=function(){function e(t){e.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;return t.setCues_=function(e){var t=this.length||0,n=0,r=e.length;this.cues_=e,this.length_=e.length;var i=function(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})};if(t<r)for(n=t;n<r;n++)i.call(this,n)},t.getCueById=function(e){for(var t=null,n=0,r=this.length;n<r;n++){var i=this[n];if(i.id===e){t=i;break}}return t},e}(),gr={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},vr={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},yr={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},_r={disabled:"disabled",hidden:"hidden",showing:"showing"},br=function(e){function t(t){var n;void 0===t&&(t={}),n=e.call(this)||this;var r={id:t.id||"vjs_track_"+Gt(),kind:t.kind||"",label:t.label||"",language:t.language||""},i=function(e){Object.defineProperty(c()(n),e,{get:function(){return r[e]},set:function(){}})};for(var a in r)i(a);return n}return h()(t,e),t}(an),Er=function(e){var t=["protocol","hostname","port","pathname","search","hash","host"],n=o.a.createElement("a");n.href=e;var r,a=""===n.host&&"file:"!==n.protocol;a&&((r=o.a.createElement("div")).innerHTML='<a href="'+e+'"></a>',n=r.firstChild,r.setAttribute("style","display:none; position:absolute;"),o.a.body.appendChild(r));for(var s={},u=0;u<t.length;u++)s[t[u]]=n[t[u]];return"http:"===s.protocol&&(s.host=s.host.replace(/:80$/,"")),"https:"===s.protocol&&(s.host=s.host.replace(/:443$/,"")),s.protocol||(s.protocol=i.a.location.protocol),a&&o.a.body.removeChild(r),s},Tr=function(e){if(!e.match(/^https?:\/\//)){var t=o.a.createElement("div");t.innerHTML='<a href="'+e+'">x</a>',e=t.firstChild.href}return e},Sr=function(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e);if(t)return t.pop().toLowerCase()}return""},wr=function(e,t){void 0===t&&(t=i.a.location);var n=Er(e);return(":"===n.protocol?t.protocol:n.protocol)+n.host!==t.protocol+t.host},Ar=Object.freeze({__proto__:null,parseUrl:Er,getAbsoluteURL:Tr,getFileExtension:Sr,isCrossOrigin:wr}),xr=function(e,t){var n=new i.a.WebVTT.Parser(i.a,i.a.vttjs,i.a.WebVTT.StringDecoder()),r=[];n.oncue=function(e){t.addCue(e)},n.onparsingerror=function(e){r.push(e)},n.onflush=function(){t.trigger({type:"loadeddata",target:t})},n.parse(e),r.length>0&&(i.a.console&&i.a.console.groupCollapsed&&i.a.console.groupCollapsed("Text Track parsing errors for "+t.src),r.forEach((function(e){return We.error(e)})),i.a.console&&i.a.console.groupEnd&&i.a.console.groupEnd()),n.flush()},Mr=function(e,t){var n={uri:e},r=wr(e);r&&(n.cors=r),y()(n,nn(this,(function(e,n,r){if(e)return We.error(e,n);t.loaded_=!0,"function"!=typeof i.a.WebVTT?t.tech_&&t.tech_.any(["vttjsloaded","vttjserror"],(function(e){if("vttjserror"!==e.type)return xr(r,t);We.error("vttjs failed to load, stopping trying to process "+t.src)})):xr(r,t)})))},Cr=function(e){function t(t){var n;if(void 0===t&&(t={}),!t.tech)throw new Error("A tech was not provided.");var r=_n(t,{kind:yr[t.kind]||"subtitles",language:t.language||t.srclang||""}),i=_r[r.mode]||"disabled",a=r.default;"metadata"!==r.kind&&"chapters"!==r.kind||(i="hidden"),(n=e.call(this,r)||this).tech_=r.tech,n.cues_=[],n.activeCues_=[],n.preload_=!1!==n.tech_.preloadTextTracks;var o=new mr(n.cues_),s=new mr(n.activeCues_),u=!1,l=nn(c()(n),(function(){this.activeCues=this.activeCues,u&&(this.trigger("cuechange"),u=!1)}));return"disabled"!==i&&n.tech_.ready((function(){n.tech_.on("timeupdate",l)}),!0),Object.defineProperties(c()(n),{default:{get:function(){return a},set:function(){}},mode:{get:function(){return i},set:function(e){var t=this;_r[e]&&(i=e,this.preload_||"disabled"===i||0!==this.cues.length||Mr(this.src,this),"disabled"!==i?this.tech_.ready((function(){t.tech_.on("timeupdate",l)}),!0):this.tech_.off("timeupdate",l),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?o:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return s;for(var e=this.tech_.currentTime(),t=[],n=0,r=this.cues.length;n<r;n++){var i=this.cues[n];(i.startTime<=e&&i.endTime>=e||i.startTime===i.endTime&&i.startTime<=e&&i.startTime+.5>=e)&&t.push(i)}if(u=!1,t.length!==this.activeCues_.length)u=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(u=!0);return this.activeCues_=t,s.setCues_(this.activeCues_),s},set:function(){}}}),r.src?(n.src=r.src,n.preload_||(n.loaded_=!0),(n.preload_||a||"subtitles"!==r.kind&&"captions"!==r.kind)&&Mr(n.src,c()(n))):n.loaded_=!0,n}h()(t,e);var n=t.prototype;return n.addCue=function(e){var t=e;if(i.a.vttjs&&!(e instanceof i.a.vttjs.VTTCue)){for(var n in t=new i.a.vttjs.VTTCue(e.startTime,e.endTime,e.text),e)n in t||(t[n]=e[n]);t.id=e.id,t.originalCue_=e}for(var r=this.tech_.textTracks(),a=0;a<r.length;a++)r[a]!==this&&r[a].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},n.removeCue=function(e){for(var t=this.cues_.length;t--;){var n=this.cues_[t];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},t}(br);Cr.prototype.allowedEvents_={cuechange:"cuechange"};var Rr=function(e){function t(t){var n;void 0===t&&(t={});var r=_n(t,{kind:vr[t.kind]||""});n=e.call(this,r)||this;var i=!1;return Object.defineProperty(c()(n),"enabled",{get:function(){return i},set:function(e){"boolean"==typeof e&&e!==i&&(i=e,this.trigger("enabledchange"))}}),r.enabled&&(n.enabled=r.enabled),n.loaded_=!0,n}return h()(t,e),t}(br),Ir=function(e){function t(t){var n;void 0===t&&(t={});var r=_n(t,{kind:gr[t.kind]||""});n=e.call(this,r)||this;var i=!1;return Object.defineProperty(c()(n),"selected",{get:function(){return i},set:function(e){"boolean"==typeof e&&e!==i&&(i=e,this.trigger("selectedchange"))}}),r.selected&&(n.selected=r.selected),n}return h()(t,e),t}(br),Or=function(e){function t(t){var n,r;void 0===t&&(t={}),n=e.call(this)||this;var i=new Cr(t);return n.kind=i.kind,n.src=i.src,n.srclang=i.language,n.label=i.label,n.default=i.default,Object.defineProperties(c()(n),{readyState:{get:function(){return r}},track:{get:function(){return i}}}),r=0,i.addEventListener("loadeddata",(function(){r=2,n.trigger({type:"load",target:c()(n)})})),n}return h()(t,e),t}(an);Or.prototype.allowedEvents_={load:"load"},Or.NONE=0,Or.LOADING=1,Or.LOADED=2,Or.ERROR=3;var Dr={audio:{ListClass:cr,TrackClass:Rr,capitalName:"Audio"},video:{ListClass:hr,TrackClass:Ir,capitalName:"Video"},text:{ListClass:fr,TrackClass:Cr,capitalName:"Text"}};Object.keys(Dr).forEach((function(e){Dr[e].getterName=e+"Tracks",Dr[e].privateName=e+"Tracks_"}));var Pr={remoteText:{ListClass:fr,TrackClass:Cr,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:pr,TrackClass:Or,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Lr=u()({},Dr,Pr);Pr.names=Object.keys(Pr),Dr.names=Object.keys(Dr),Lr.names=[].concat(Pr.names).concat(Dr.names);var Nr=function(e){function t(t,n){var r;return void 0===t&&(t={}),void 0===n&&(n=function(){}),t.reportTouchActivity=!1,(r=e.call(this,null,t,n)||this).hasStarted_=!1,r.on("playing",(function(){this.hasStarted_=!0})),r.on("loadstart",(function(){this.hasStarted_=!1})),Lr.names.forEach((function(e){var n=Lr[e];t&&t[n.getterName]&&(r[n.privateName]=t[n.getterName])})),r.featuresProgressEvents||r.manualProgressOn(),r.featuresTimeupdateEvents||r.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach((function(e){!1===t["native"+e+"Tracks"]&&(r["featuresNative"+e+"Tracks"]=!1)})),!1===t.nativeCaptions||!1===t.nativeTextTracks?r.featuresNativeTextTracks=!1:!0!==t.nativeCaptions&&!0!==t.nativeTextTracks||(r.featuresNativeTextTracks=!0),r.featuresNativeTextTracks||r.emulateTextTracks(),r.preloadTextTracks=!1!==t.preloadTextTracks,r.autoRemoteTextTracks_=new Lr.text.ListClass,r.initTrackListeners(),t.nativeControlsForTouch||r.emitTapEvents(),r.constructor&&(r.name_=r.constructor.name||"Unknown Tech"),r}h()(t,e);var n=t.prototype;return n.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",(function(){return t.setTimeout((function(){return t.triggerSourceset(e)}),1)})),this.trigger({src:e,type:"sourceset"})},n.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},n.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},n.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(nn(this,(function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),this.bufferedPercent_=e,1===e&&this.stopTrackingProgress()})),500)},n.onDurationChange=function(e){this.duration_=this.duration()},n.buffered=function(){return Wn(0,0)},n.bufferedPercent=function(){return qn(this.buffered(),this.duration_)},n.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},n.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},n.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},n.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval((function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}),250)},n.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},n.dispose=function(){this.clearTracks(Dr.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),e.prototype.dispose.call(this)},n.clearTracks=function(e){var t=this;(e=[].concat(e)).forEach((function(e){for(var n=t[e+"Tracks"]()||[],r=n.length;r--;){var i=n[r];"text"===e&&t.removeRemoteTextTrack(i),n.removeTrack(i)}}))},n.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var n=e[t];this.removeRemoteTextTrack(n)}},n.reset=function(){},n.error=function(e){return void 0!==e&&(this.error_=new $n(e),this.trigger("error")),this.error_},n.played=function(){return this.hasStarted_?Wn(0,0):Wn()},n.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},n.initTrackListeners=function(){var e=this;Dr.names.forEach((function(t){var n=Dr[t],r=function(){e.trigger(t+"trackchange")},i=e[n.getterName]();i.addEventListener("removetrack",r),i.addEventListener("addtrack",r),e.on("dispose",(function(){i.removeEventListener("removetrack",r),i.removeEventListener("addtrack",r)}))}))},n.addWebVttScript_=function(){var e=this;if(!i.a.WebVTT)if(o.a.body.contains(this.el())){if(!this.options_["vtt.js"]&&Je(b.a)&&Object.keys(b.a).length>0)return void this.trigger("vttjsloaded");var t=o.a.createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",t.onload=function(){e.trigger("vttjsloaded")},t.onerror=function(){e.trigger("vttjserror")},this.on("dispose",(function(){t.onload=null,t.onerror=null})),i.a.WebVTT=!0,this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)},n.emulateTextTracks=function(){var e=this,t=this.textTracks(),n=this.remoteTextTracks(),r=function(e){return t.addTrack(e.track)},i=function(e){return t.removeTrack(e.track)};n.on("addtrack",r),n.on("removetrack",i),this.addWebVttScript_();var a=function(){return e.trigger("texttrackchange")},o=function(){a();for(var e=0;e<t.length;e++){var n=t[e];n.removeEventListener("cuechange",a),"showing"===n.mode&&n.addEventListener("cuechange",a)}};o(),t.addEventListener("change",o),t.addEventListener("addtrack",o),t.addEventListener("removetrack",o),this.on("dispose",(function(){n.off("addtrack",r),n.off("removetrack",i),t.removeEventListener("change",o),t.removeEventListener("addtrack",o),t.removeEventListener("removetrack",o);for(var e=0;e<t.length;e++){t[e].removeEventListener("cuechange",a)}}))},n.addTextTrack=function(e,t,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,n,r,i){void 0===i&&(i={});var a=e.textTracks();i.kind=t,n&&(i.label=n),r&&(i.language=r),i.tech=e;var o=new Lr.text.TrackClass(i);return a.addTrack(o),o}(this,e,t,n)},n.createRemoteTextTrack=function(e){var t=_n(e,{tech:this});return new Pr.remoteTextEl.TrackClass(t)},n.addRemoteTextTrack=function(e,t){var n=this;void 0===e&&(e={});var r=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(We.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),!0!==t&&this.ready((function(){return n.autoRemoteTextTracks_.addTrack(r.track)})),r},n.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},n.getVideoPlaybackQuality=function(){return{}},n.requestPictureInPicture=function(){var e=this.options_.Promise||i.a.Promise;if(e)return e.reject()},n.setPoster=function(){},n.playsinline=function(){},n.setPlaysinline=function(){},n.overrideNativeAudioTracks=function(){},n.overrideNativeVideoTracks=function(){},n.canPlayType=function(){return""},t.canPlayType=function(){return""},t.canPlaySource=function(e,n){return t.canPlayType(e.type)},t.isTech=function(e){return e.prototype instanceof t||e instanceof t||e===t},t.registerTech=function(e,n){if(t.techs_||(t.techs_={}),!t.isTech(n))throw new Error("Tech "+e+" must be a Tech");if(!t.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!t.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=yn(e),t.techs_[e]=n,t.techs_[vn(e)]=n,"Tech"!==e&&t.defaultTechOrder_.push(e),n},t.getTech=function(e){if(e)return t.techs_&&t.techs_[e]?t.techs_[e]:(e=yn(e),i.a&&i.a.videojs&&i.a.videojs[e]?(We.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),i.a.videojs[e]):void 0)},t}(bn);Lr.names.forEach((function(e){var t=Lr[e];Nr.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}})),Nr.prototype.featuresVolumeControl=!0,Nr.prototype.featuresMuteControl=!0,Nr.prototype.featuresFullscreenResize=!1,Nr.prototype.featuresPlaybackRate=!1,Nr.prototype.featuresProgressEvents=!1,Nr.prototype.featuresSourceset=!1,Nr.prototype.featuresTimeupdateEvents=!1,Nr.prototype.featuresNativeTextTracks=!1,Nr.withSourceHandlers=function(e){e.registerSourceHandler=function(t,n){var r=e.sourceHandlers;r||(r=e.sourceHandlers=[]),void 0===n&&(n=r.length),r.splice(n,0,t)},e.canPlayType=function(t){for(var n,r=e.sourceHandlers||[],i=0;i<r.length;i++)if(n=r[i].canPlayType(t))return n;return""},e.selectSourceHandler=function(t,n){for(var r=e.sourceHandlers||[],i=0;i<r.length;i++)if(r[i].canHandleSource(t,n))return r[i];return null},e.canPlaySource=function(t,n){var r=e.selectSourceHandler(t,n);return r?r.canHandleSource(t,n):""};["seekable","seeking","duration"].forEach((function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})}),e.prototype),e.prototype.setSource=function(t){var n=e.selectSourceHandler(t,this.options_);n||(e.nativeSourceHandler?n=e.nativeSourceHandler:We.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),n!==e.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=n.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},bn.registerComponent("Tech",Nr),Nr.registerTech("Tech",Nr),Nr.defaultTechOrder_=[];var kr={},Fr={},Br={};function Ur(e,t,n){e.setTimeout((function(){return function e(t,n,r,i,a,o){void 0===t&&(t={});void 0===n&&(n=[]);void 0===a&&(a=[]);void 0===o&&(o=!1);var s=n,u=s[0],l=s.slice(1);if("string"==typeof u)e(t,kr[u],r,i,a,o);else if(u){var c=function(e,t){var n=Fr[e.id()],r=null;if(null==n)return r=t(e),Fr[e.id()]=[[t,r]],r;for(var i=0;i<n.length;i++){var a=n[i],o=a[0],s=a[1];o===t&&(r=s)}null===r&&(r=t(e),n.push([t,r]));return r}(i,u);if(!c.setSource)return a.push(c),e(t,l,r,i,a,o);c.setSource(Qe({},t),(function(n,s){if(n)return e(t,l,r,i,a,o);a.push(c),e(s,t.type===s.type?l:kr[s.type],r,i,a,o)}))}else l.length?e(t,l,r,i,a,o):o?r(t,a):e(t,kr["*"],r,i,a,!0)}(t,kr[t.type],n,e)}),1)}function jr(e,t,n,r){void 0===r&&(r=null);var i="call"+yn(n),a=e.reduce(zr(i),r),o=a===Br,s=o?null:t[n](a);return function(e,t,n,r){for(var i=e.length-1;i>=0;i--){var a=e[i];a[t]&&a[t](r,n)}}(e,n,s,o),s}var Gr={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1},Hr={setCurrentTime:1,setMuted:1,setVolume:1},Vr={play:1,pause:1};function zr(e){return function(t,n){return t===Br?Br:n[e]?n[e](t):t}}var Wr={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},qr=function(e){void 0===e&&(e="");var t=Sr(e);return Wr[t.toLowerCase()]||""};function Yr(e){if(!e.type){var t=qr(e.src);t&&(e.type=t)}return e}var Kr=function(e){function t(t,n,r){var i,a=_n({createEl:!1},n);if(i=e.call(this,t,a,r)||this,n.playerOptions.sources&&0!==n.playerOptions.sources.length)t.src(n.playerOptions.sources);else for(var o=0,s=n.playerOptions.techOrder;o<s.length;o++){var u=yn(s[o]),l=Nr.getTech(u);if(u||(l=bn.getComponent(u)),l&&l.isSupported()){t.loadTech_(u);break}}return i}return h()(t,e),t}(bn);bn.registerComponent("MediaLoader",Kr);var Xr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).emitTapEvents(),r.enable(),r}h()(t,e);var n=t.prototype;return n.createEl=function(t,n,r){void 0===t&&(t="div"),void 0===n&&(n={}),void 0===r&&(r={}),n=Qe({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},n),"button"===t&&We.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead."),r=Qe({role:"button"},r),this.tabIndex_=n.tabIndex;var i=e.prototype.createEl.call(this,t,n,r);return this.createControlTextEl(i),i},n.dispose=function(){this.controlTextEl_=null,e.prototype.dispose.call(this)},n.createControlTextEl=function(e){return this.controlTextEl_=ot("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},n.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var n=this.localize(e);this.controlText_=e,st(this.controlTextEl_,n),this.nonIconControl||t.setAttribute("title",n)},n.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)},n.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},n.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver),this.off("mouseout",this.handleMouseOut),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},n.handleClick=function(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},n.handleKeyDown=function(t){g.a.isEventKey(t,"Space")||g.a.isEventKey(t,"Enter")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(bn);bn.registerComponent("ClickableComponent",Xr);var Qr=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update(),t.on("posterchange",nn(c()(r),r.update)),r}h()(t,e);var n=t.prototype;return n.dispose=function(){this.player().off("posterchange",this.update),e.prototype.dispose.call(this)},n.createEl=function(){return ot("div",{className:"vjs-poster",tabIndex:-1})},n.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},n.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},n.handleClick=function(e){if(this.player_.controls()){var t=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;!this.player_.tech(!0)||(Ln||On)&&t||this.player_.tech(!0).focus(),this.player_.paused()?nr(this.player_.play()):this.player_.pause()}},t}(Xr);bn.registerComponent("PosterImage",Qr);var Zr={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Jr(e,t){var n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+t+")"}function $r(e,t,n){try{e.style[t]=n}catch(e){return}}var ei=function(e){function t(t,n,r){var a;a=e.call(this,t,n,r)||this;var o=nn(c()(a),a.updateDisplay);return t.on("loadstart",nn(c()(a),a.toggleDisplay)),t.on("texttrackchange",o),t.on("loadedmetadata",nn(c()(a),a.preselectTrack)),t.ready(nn(c()(a),(function(){if(t.tech_&&t.tech_.featuresNativeTextTracks)this.hide();else{t.on("fullscreenchange",o),t.on("playerresize",o),i.a.addEventListener("orientationchange",o),t.on("dispose",(function(){return i.a.removeEventListener("orientationchange",o)}));for(var e=this.options_.playerOptions.tracks||[],n=0;n<e.length;n++)this.player_.addRemoteTextTrack(e[n],!0);this.preselectTrack()}}))),a}h()(t,e);var n=t.prototype;return n.preselectTrack=function(){for(var e,t,n,r={captions:1,subtitles:1},i=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,o=0;o<i.length;o++){var s=i[o];a&&a.enabled&&a.language&&a.language===s.language&&s.kind in r?s.kind===a.kind?n=s:n||(n=s):a&&!a.enabled?(n=null,e=null,t=null):s.default&&("descriptions"!==s.kind||e?s.kind in r&&!t&&(t=s):e=s)}n?n.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},n.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},n.clearDisplay=function(){"function"==typeof i.a.WebVTT&&i.a.WebVTT.processCues(i.a,[],this.el_)},n.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var n=[],r=0;r<e.length;++r){var i=e[r];"showing"===i.mode&&n.push(i)}this.updateForTrack(n)}else{for(var a=null,o=null,s=e.length;s--;){var u=e[s];"showing"===u.mode&&("descriptions"===u.kind?a=u:o=u)}o?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):a&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a))}},n.updateDisplayState=function(e){for(var t=this.player_.textTrackSettings.getValues(),n=e.activeCues,r=n.length;r--;){var a=n[r];if(a){var o=a.displayState;if(t.color&&(o.firstChild.style.color=t.color),t.textOpacity&&$r(o.firstChild,"color",Jr(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(o.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&$r(o.firstChild,"backgroundColor",Jr(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?$r(o,"backgroundColor",Jr(t.windowColor,t.windowOpacity)):o.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?o.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===t.edgeStyle?o.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===t.edgeStyle?o.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===t.edgeStyle&&(o.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),t.fontPercent&&1!==t.fontPercent){var s=i.a.parseFloat(o.style.fontSize);o.style.fontSize=s*t.fontPercent+"px",o.style.height="auto",o.style.top="auto",o.style.bottom="2px"}t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=Zr[t.fontFamily])}}},n.updateForTrack=function(e){if(Array.isArray(e)||(e=[e]),"function"==typeof i.a.WebVTT&&!e.every((function(e){return!e.activeCues}))){for(var t=[],n=0;n<e.length;++n)for(var r=e[n],a=0;a<r.activeCues.length;++a)t.push(r.activeCues[a]);i.a.WebVTT.processCues(i.a,t,this.el_);for(var o=0;o<e.length;++o){for(var s=e[o],u=0;u<s.activeCues.length;++u){var l=s.activeCues[u].displayState;ct(l,"vjs-text-track-cue"),ct(l,"vjs-text-track-cue-"+(s.language?s.language:o))}this.player_.textTrackSettings&&this.updateDisplayState(s)}}},t}(bn);bn.registerComponent("TextTrackDisplay",ei);var ti=function(e){function t(){return e.apply(this,arguments)||this}return h()(t,e),t.prototype.createEl=function(){var t=this.player_.isAudio(),n=this.localize(t?"Audio Player":"Video Player"),r=ot("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[n])}),i=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return i.appendChild(r),i},t}(bn);bn.registerComponent("LoadingSpinner",ti);var ni=function(e){function t(){return e.apply(this,arguments)||this}h()(t,e);var n=t.prototype;return n.createEl=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={}),t=Qe({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),n=Qe({type:"button"},n);var r=bn.prototype.createEl.call(this,"button",t,n);return this.createControlTextEl(r),r},n.addChild=function(e,t){void 0===t&&(t={});var n=this.constructor.name;return We.warn("Adding an actionable (user controllable) child to a Button ("+n+") is not supported; use a ClickableComponent instead."),bn.prototype.addChild.call(this,e,t)},n.enable=function(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},n.disable=function(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},n.handleKeyDown=function(t){g.a.isEventKey(t,"Space")||g.a.isEventKey(t,"Enter")?t.stopPropagation():e.prototype.handleKeyDown.call(this,t)},t}(Xr);bn.registerComponent("Button",ni);var ri=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).mouseused_=!1,r.on("mousedown",r.handleMouseDown),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-big-play-button"},n.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){var n=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;return nr(t),void(!this.player_.tech(!0)||(Ln||On)&&n||this.player_.tech(!0).focus())}var r=this.player_.getChild("controlBar"),i=r&&r.getChild("playToggle");if(i){var a=function(){return i.focus()};tr(t)?t.then(a,(function(){})):this.setTimeout(a,1)}else this.player_.tech(!0).focus()},n.handleKeyDown=function(t){this.mouseused_=!1,e.prototype.handleKeyDown.call(this,t)},n.handleMouseDown=function(e){this.mouseused_=!0},t}(ni);ri.prototype.controlText_="Play Video",bn.registerComponent("BigPlayButton",ri);var ii=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).controlText(n&&n.controlText||r.localize("Close")),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},n.handleKeyDown=function(t){g.a.isEventKey(t,"Esc")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(ni);bn.registerComponent("CloseButton",ii);var ai=function(e){function t(t,n){var r;return void 0===n&&(n={}),r=e.call(this,t,n)||this,n.replay=void 0===n.replay||n.replay,r.on(t,"play",r.handlePlay),r.on(t,"pause",r.handlePause),n.replay&&r.on(t,"ended",r.handleEnded),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},n.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},n.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},n.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},t}(ni);ai.prototype.controlText_="Play",bn.registerComponent("PlayToggle",ai);var oi=function(e,t){e=e<0?0:e;var n=Math.floor(e%60),r=Math.floor(e/60%60),i=Math.floor(e/3600),a=Math.floor(t/60%60),o=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(i=r=n="-"),(i=i>0||o>0?i+":":"")+(r=((i||a>=10)&&r<10?"0"+r:r)+":")+(n=n<10?"0"+n:n)},si=oi;function ui(e,t){return void 0===t&&(t=e),si(e,t)}var li=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,["timeupdate","ended"],r.updateContent),r.updateTextNode_(),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t=this.buildCSSClass(),n=e.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+"</span>"});return this.contentEl_=ot("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"}),n.appendChild(this.contentEl_),n},n.dispose=function(){this.contentEl_=null,this.textNode_=null,e.prototype.dispose.call(this)},n.updateTextNode_=function(e){var t=this;void 0===e&&(e=0),e=ui(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestAnimationFrame((function(){if(t.contentEl_){var e=t.textNode_;t.textNode_=o.a.createTextNode(t.formattedTime_),t.textNode_&&(e?t.contentEl_.replaceChild(t.textNode_,e):t.contentEl_.appendChild(t.textNode_))}})))},n.updateContent=function(e){},t}(bn);li.prototype.labelText_="Time",li.prototype.controlText_="Time",bn.registerComponent("TimeDisplay",li);var ci=function(e){function t(){return e.apply(this,arguments)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-current-time"},n.updateContent=function(e){var t;t=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)},t}(li);ci.prototype.labelText_="Current Time",ci.prototype.controlText_="Current Time",bn.registerComponent("CurrentTimeDisplay",ci);var di=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"durationchange",r.updateContent),r.on(t,"loadstart",r.updateContent),r.on(t,"loadedmetadata",r.updateContent),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-duration"},n.updateContent=function(e){var t=this.player_.duration();this.updateTextNode_(t)},t}(li);di.prototype.labelText_="Duration",di.prototype.controlText_="Duration",bn.registerComponent("DurationDisplay",di);var hi=function(e){function t(){return e.apply(this,arguments)||this}return h()(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(bn);bn.registerComponent("TimeDivider",hi);var fi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"durationchange",r.updateContent),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-remaining-time"},n.createEl=function(){var t=e.prototype.createEl.call(this);return t.insertBefore(ot("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t},n.updateContent=function(e){var t;"number"==typeof this.player_.duration()&&(t=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime(),this.updateTextNode_(t))},t}(li);fi.prototype.labelText_="Remaining Time",fi.prototype.controlText_="Remaining Time",bn.registerComponent("RemainingTimeDisplay",fi);var pi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).updateShowing(),r.on(r.player(),"durationchange",r.updateShowing),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=ot("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"</span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},n.dispose=function(){this.contentEl_=null,e.prototype.dispose.call(this)},n.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},t}(bn);bn.registerComponent("LiveDisplay",pi);var mi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).updateLiveEdgeStatus(),r.player_.liveTracker&&r.on(r.player_.liveTracker,"liveedgechange",r.updateLiveEdgeStatus),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=ot("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t},n.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},n.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},n.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,e.prototype.dispose.call(this)},t}(ni);mi.prototype.controlText_="Seek to live, currently playing live",bn.registerComponent("SeekToLive",mi);var gi=function(e,t,n){return e=Number(e),Math.min(n,Math.max(t,isNaN(e)?t:e))},vi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).bar=r.getChild(r.options_.barName),r.vertical(!!r.options_.vertical),r.enable(),r}h()(t,e);var n=t.prototype;return n.enabled=function(){return this.enabled_},n.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},n.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},n.createEl=function(t,n,r){return void 0===n&&(n={}),void 0===r&&(r={}),n.className=n.className+" vjs-slider",n=Qe({tabIndex:0},n),r=Qe({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},r),e.prototype.createEl.call(this,t,n,r)},n.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||Dn||e.preventDefault(),yt(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},n.handleMouseMove=function(e){},n.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;_t(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},n.update=function(){var e=this;if(this.el_&&this.bar){var t=this.getProgress();return t===this.progress_||(this.progress_=t,this.requestAnimationFrame((function(){var n=e.vertical()?"height":"width";e.bar.el().style[n]=(100*t).toFixed(2)+"%"}))),t}},n.getProgress=function(){return Number(gi(this.getPercent(),0,1).toFixed(4))},n.calculateDistance=function(e){var t=Tt(this.el_,e);return this.vertical()?t.y:t.x},n.handleKeyDown=function(t){g.a.isEventKey(t,"Left")||g.a.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepBack()):g.a.isEventKey(t,"Right")||g.a.isEventKey(t,"Up")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){e.stopPropagation(),e.preventDefault()},n.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},t}(bn);bn.registerComponent("Slider",vi);var yi=function(e,t){return gi(e/t*100,0,100).toFixed(2)+"%"},_i=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).partEls_=[],r.on(t,"progress",r.update),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),n=ot("span",{className:"vjs-control-text"}),r=ot("span",{textContent:this.localize("Loaded")}),i=o.a.createTextNode(": ");return this.percentageEl_=ot("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),t.appendChild(n),n.appendChild(r),n.appendChild(i),n.appendChild(this.percentageEl_),t},n.dispose=function(){this.partEls_=null,this.percentageEl_=null,e.prototype.dispose.call(this)},n.update=function(e){var t=this;this.requestAnimationFrame((function(){var e=t.player_.liveTracker,n=t.player_.buffered(),r=e&&e.isLive()?e.seekableEnd():t.player_.duration(),i=t.player_.bufferedEnd(),a=t.partEls_,o=yi(i,r);t.percent_!==o&&(t.el_.style.width=o,st(t.percentageEl_,o),t.percent_=o);for(var s=0;s<n.length;s++){var u=n.start(s),l=n.end(s),c=a[s];c||(c=t.el_.appendChild(ot()),a[s]=c),c.dataset.start===u&&c.dataset.end===l||(c.dataset.start=u,c.dataset.end=l,c.style.left=yi(u,i),c.style.width=yi(l-u,i))}for(var d=a.length;d>n.length;d--)t.el_.removeChild(a[d-1]);a.length=n.length}))},t}(bn);bn.registerComponent("LoadProgressBar",_i);var bi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update=rn(nn(c()(r),r.update),tn),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},n.update=function(e,t,n){var r=bt(this.el_),i=bt(this.player_.el()),a=e.width*t;if(i&&r){var o=e.left-i.left+a,s=e.width-a+(i.right-e.right),u=r.width/2;o<u?u+=u-o:s<u&&(u=s),u<0?u=0:u>r.width&&(u=r.width),this.el_.style.right="-"+u+"px",this.write(n)}},n.write=function(e){st(this.el_,e)},n.updateTime=function(e,t,n,r){var i=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame((function(){var a,o=i.player_.duration();if(i.player_.liveTracker&&i.player_.liveTracker.isLive()){var s=i.player_.liveTracker.liveWindow(),u=s-t*s;a=(u<1?"":"-")+ui(u,s)}else a=ui(n,o);i.update(e,t,a),r&&r()}))},t}(bn);bn.registerComponent("TimeTooltip",bi);var Ei=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update=rn(nn(c()(r),r.update),tn),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},n.update=function(e,t){var n=this.getChild("timeTooltip");if(n){var r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,t,r)}},t}(bn);Ei.prototype.options_={children:[]},jn||Mn||Ei.prototype.options_.children.push("timeTooltip"),bn.registerComponent("PlayProgressBar",Ei);var Ti=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).update=rn(nn(c()(r),r.update),tn),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},n.update=function(e,t){var n=this,r=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,r,(function(){n.el_.style.left=e.width*t+"px"}))},t}(bn);Ti.prototype.options_={children:["timeTooltip"]},bn.registerComponent("MouseTimeDisplay",Ti);var Si=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).setEventHandlers_(),r}h()(t,e);var n=t.prototype;return n.setEventHandlers_=function(){this.update_=nn(this,this.update),this.update=rn(this.update_,tn),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in o.a&&"visibilityState"in o.a&&this.on(o.a,"visibilitychange",this.toggleVisibility_)},n.toggleVisibility_=function(e){o.a.hidden?this.disableInterval_(e):(this.enableInterval_(),this.update())},n.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,tn))},n.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&"ended"!==e.type||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},n.update=function(t){var n=this,r=e.prototype.update.call(this);return this.requestAnimationFrame((function(){var e=n.player_.ended()?n.player_.duration():n.getCurrentTime_(),t=n.player_.liveTracker,i=n.player_.duration();t&&t.isLive()&&(i=n.player_.liveTracker.liveCurrentTime()),n.percent_!==r&&(n.el_.setAttribute("aria-valuenow",(100*r).toFixed(2)),n.percent_=r),n.currentTime_===e&&n.duration_===i||(n.el_.setAttribute("aria-valuetext",n.localize("progress bar timing: currentTime={1} duration={2}",[ui(e,i),ui(i,i)],"{1} of {2}")),n.currentTime_=e,n.duration_=i),n.bar&&n.bar.update(bt(n.el()),n.getProgress())})),r},n.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},n.getPercent=function(){var e,t=this.getCurrentTime_(),n=this.player_.liveTracker;return n&&n.isLive()?(e=(t-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),e},n.handleMouseDown=function(t){Ct(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,t))},n.handleMouseMove=function(e){if(Ct(e)){var t,n=this.calculateDistance(e),r=this.player_.liveTracker;if(r&&r.isLive()){if(n>=.99)return void r.seekToLiveEdge();var i=r.seekableStart(),a=r.liveCurrentTime();if((t=i+n*r.liveWindow())>=a&&(t=a),t<=i&&(t=i+.1),t===1/0)return}else(t=n*this.player_.duration())===this.player_.duration()&&(t-=.1);this.player_.currentTime(t)}},n.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},n.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},n.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?nr(this.player_.play()):this.update_()},n.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},n.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},n.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},n.handleKeyDown=function(t){if(g.a.isEventKey(t,"Space")||g.a.isEventKey(t,"Enter"))t.preventDefault(),t.stopPropagation(),this.handleAction(t);else if(g.a.isEventKey(t,"Home"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(0);else if(g.a.isEventKey(t,"End"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(g()(t))){t.preventDefault(),t.stopPropagation();var n=10*(g.a.codes[g()(t)]-g.a.codes[0])/100;this.player_.currentTime(this.player_.duration()*n)}else g.a.isEventKey(t,"PgDn")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-60)):g.a.isEventKey(t,"PgUp")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+60)):e.prototype.handleKeyDown.call(this,t)},n.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableInterval_),this.off(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in o.a&&"visibilityState"in o.a&&this.off(o.a,"visibilitychange",this.toggleVisibility_),e.prototype.dispose.call(this)},t}(vi);Si.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},jn||Mn||Si.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),bn.registerComponent("SeekBar",Si);var wi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).handleMouseMove=rn(nn(c()(r),r.handleMouseMove),tn),r.throttledHandleMouseSeek=rn(nn(c()(r),r.handleMouseSeek),tn),r.enable(),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},n.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var n=t.getChild("playProgressBar"),r=t.getChild("mouseTimeDisplay");if(n||r){var i=t.el(),a=bt(i),o=Tt(i,e).x;o=gi(0,1,o),r&&r.update(a,o),n&&n.update(a,t.getProgress())}}},n.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},n.enabled=function(){return this.enabled_},n.disable=function(){this.children().forEach((function(e){return e.disable&&e.disable()})),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},n.enable=function(){this.children().forEach((function(e){return e.enable&&e.enable()})),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},n.handleMouseDown=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},t}(bn);wi.prototype.options_={children:["seekBar"]},bn.registerComponent("ProgressControl",wi);var Ai=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,["enterpictureinpicture","leavepictureinpicture"],r.handlePictureInPictureChange),o.a.pictureInPictureEnabled||r.disable(),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)},n.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture")},n.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},t}(ni);Ai.prototype.controlText_="Picture-in-Picture",bn.registerComponent("PictureInPictureToggle",Ai);var xi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"fullscreenchange",r.handleFullscreenChange),!1===o.a[t.fsApi_.fullscreenEnabled]&&r.disable(),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},n.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},n.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},t}(ni);xi.prototype.controlText_="Fullscreen",bn.registerComponent("FullscreenToggle",xi);var Mi=function(e){function t(){return e.apply(this,arguments)||this}return h()(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(bn);bn.registerComponent("VolumeLevel",Mi);var Ci=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on("slideractive",r.updateLastVolume_),r.on(t,"volumechange",r.updateARIAAttributes),t.ready((function(){return r.updateARIAAttributes()})),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},n.handleMouseDown=function(t){Ct(t)&&e.prototype.handleMouseDown.call(this,t)},n.handleMouseMove=function(e){Ct(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},n.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},n.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},n.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},n.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},n.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},n.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},n.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",(function(){0===e.player_.volume()&&e.player_.lastVolume_(t)}))},t}(vi);Ci.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Ci.prototype.playerEvent="volumechange",bn.registerComponent("VolumeBar",Ci);var Ri=function(e){function t(t,n){var r;return void 0===n&&(n={}),n.vertical=n.vertical||!1,(void 0===n.volumeBar||Je(n.volumeBar))&&(n.volumeBar=n.volumeBar||{},n.volumeBar.vertical=n.vertical),r=e.call(this,t,n)||this,function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",(function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))}(c()(r),t),r.throttledHandleMouseMove=rn(nn(c()(r),r.handleMouseMove),tn),r.on("mousedown",r.handleMouseDown),r.on("touchstart",r.handleMouseDown),r.on(r.volumeBar,["focus","slideractive"],(function(){r.volumeBar.addClass("vjs-slider-active"),r.addClass("vjs-slider-active"),r.trigger("slideractive")})),r.on(r.volumeBar,["blur","sliderinactive"],(function(){r.volumeBar.removeClass("vjs-slider-active"),r.removeClass("vjs-slider-active"),r.trigger("sliderinactive")})),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},n.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},n.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},n.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},t}(bn);Ri.prototype.options_={children:["volumeBar"]},bn.registerComponent("VolumeControl",Ri);var Ii=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",(function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")}))}(c()(r),t),r.on(t,["loadstart","volumechange"],r.update),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){var t=this.player_.volume(),n=this.player_.lastVolume_();if(0===t){var r=n<.1?.1:n;this.player_.volume(r),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},n.update=function(e){this.updateIcon_(),this.updateControlText_()},n.updateIcon_=function(){var e=this.player_.volume(),t=3;jn&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var n=0;n<4;n++)dt(this.el_,"vjs-vol-"+n);ct(this.el_,"vjs-vol-"+t)},n.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},t}(ni);Ii.prototype.controlText_="Mute",bn.registerComponent("MuteToggle",Ii);var Oi=function(e){function t(t,n){var r;return void 0===n&&(n={}),void 0!==n.inline?n.inline=n.inline:n.inline=!0,(void 0===n.volumeControl||Je(n.volumeControl))&&(n.volumeControl=n.volumeControl||{},n.volumeControl.vertical=!n.inline),(r=e.call(this,t,n)||this).on(t,["loadstart"],r.volumePanelState_),r.on(r.muteToggle,"keyup",r.handleKeyPress),r.on(r.volumeControl,"keyup",r.handleVolumeControlKeyUp),r.on("keydown",r.handleKeyPress),r.on("mouseover",r.handleMouseOver),r.on("mouseout",r.handleMouseOut),r.on(r.volumeControl,["slideractive"],r.sliderActive_),r.on(r.volumeControl,["sliderinactive"],r.sliderInactive_),r}h()(t,e);var n=t.prototype;return n.sliderActive_=function(){this.addClass("vjs-slider-active")},n.sliderInactive_=function(){this.removeClass("vjs-slider-active")},n.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},n.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},n.dispose=function(){this.handleMouseOut(),e.prototype.dispose.call(this)},n.handleVolumeControlKeyUp=function(e){g.a.isEventKey(e,"Esc")&&this.muteToggle.focus()},n.handleMouseOver=function(e){this.addClass("vjs-hover"),Kt(o.a,"keyup",nn(this,this.handleKeyPress))},n.handleMouseOut=function(e){this.removeClass("vjs-hover"),Xt(o.a,"keyup",nn(this,this.handleKeyPress))},n.handleKeyPress=function(e){g.a.isEventKey(e,"Esc")&&this.handleMouseOut()},t}(bn);Oi.prototype.options_={children:["muteToggle","volumeControl"]},bn.registerComponent("VolumePanel",Oi);var Di=function(e){function t(t,n){var r;return r=e.call(this,t,n)||this,n&&(r.menuButton_=n.menuButton),r.focusedChild_=-1,r.on("keydown",r.handleKeyDown),r.boundHandleBlur_=nn(c()(r),r.handleBlur),r.boundHandleTapClick_=nn(c()(r),r.handleTapClick),r}h()(t,e);var n=t.prototype;return n.addEventListenerForItem=function(e){e instanceof bn&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},n.removeEventListenerForItem=function(e){e instanceof bn&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},n.removeChild=function(t){"string"==typeof t&&(t=this.getChild(t)),this.removeEventListenerForItem(t),e.prototype.removeChild.call(this,t)},n.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},n.createEl=function(){var t=this.options_.contentElType||"ul";this.contentEl_=ot(t,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var n=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return n.appendChild(this.contentEl_),Kt(n,"click",(function(e){e.preventDefault(),e.stopImmediatePropagation()})),n},n.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,e.prototype.dispose.call(this)},n.handleBlur=function(e){var t=e.relatedTarget||o.a.activeElement;if(!this.children().some((function(e){return e.el()===t}))){var n=this.menuButton_;n&&n.buttonPressed_&&t!==n.el().firstChild&&n.unpressButton()}},n.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t))return;var n=t.filter((function(t){return t.el()===e.target}))[0];if(!n)return;"CaptionSettingsMenuItem"!==n.name()&&this.menuButton_.focus()}},n.handleKeyDown=function(e){g.a.isEventKey(e,"Left")||g.a.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(g.a.isEventKey(e,"Right")||g.a.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},n.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},n.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},n.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())},t}(bn);bn.registerComponent("Menu",Di);var Pi=function(e){function t(t,n){var r;void 0===n&&(n={}),(r=e.call(this,t,n)||this).menuButton_=new ni(t,n),r.menuButton_.controlText(r.controlText_),r.menuButton_.el_.setAttribute("aria-haspopup","true");var i=ni.prototype.buildCSSClass();return r.menuButton_.el_.className=r.buildCSSClass()+" "+i,r.menuButton_.removeClass("vjs-control"),r.addChild(r.menuButton_),r.update(),r.enabled_=!0,r.on(r.menuButton_,"tap",r.handleClick),r.on(r.menuButton_,"click",r.handleClick),r.on(r.menuButton_,"keydown",r.handleKeyDown),r.on(r.menuButton_,"mouseenter",(function(){r.addClass("vjs-hover"),r.menu.show(),Kt(o.a,"keyup",nn(c()(r),r.handleMenuKeyUp))})),r.on("mouseleave",r.handleMouseLeave),r.on("keydown",r.handleSubmenuKeyDown),r}h()(t,e);var n=t.prototype;return n.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},n.createMenu=function(){var e=new Di(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=ot("li",{className:"vjs-menu-title",innerHTML:yn(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var n=new bn(this.player_,{el:t});e.addItem(n)}if(this.items=this.createItems(),this.items)for(var r=0;r<this.items.length;r++)e.addItem(this.items[r]);return e},n.createItems=function(){},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},n.buildWrapperCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+ni.prototype.buildCSSClass()+" "+e.prototype.buildCSSClass.call(this)},n.buildCSSClass=function(){var t="vjs-menu-button";return!0===this.options_.inline?t+="-inline":t+="-popup","vjs-menu-button "+t+" "+e.prototype.buildCSSClass.call(this)},n.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},n.dispose=function(){this.handleMouseLeave(),e.prototype.dispose.call(this)},n.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},n.handleMouseLeave=function(e){this.removeClass("vjs-hover"),Xt(o.a,"keyup",nn(this,this.handleMenuKeyUp))},n.focus=function(){this.menuButton_.focus()},n.blur=function(){this.menuButton_.blur()},n.handleKeyDown=function(e){g.a.isEventKey(e,"Esc")||g.a.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),g.a.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(g.a.isEventKey(e,"Up")||g.a.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},n.handleMenuKeyUp=function(e){(g.a.isEventKey(e,"Esc")||g.a.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")},n.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},n.handleSubmenuKeyDown=function(e){(g.a.isEventKey(e,"Esc")||g.a.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),g.a.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},n.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),jn&&it())return;this.menu.focus()}},n.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},n.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},n.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},t}(bn);bn.registerComponent("MenuButton",Pi);var Li=function(e){function t(t,n){var r,i=n.tracks;if((r=e.call(this,t,n)||this).items.length<=1&&r.hide(),!i)return c()(r);var a=nn(c()(r),r.update);return i.addEventListener("removetrack",a),i.addEventListener("addtrack",a),r.player_.on("ready",a),r.player_.on("dispose",(function(){i.removeEventListener("removetrack",a),i.removeEventListener("addtrack",a)})),r}return h()(t,e),t}(Pi);bn.registerComponent("TrackButton",Li);var Ni=["Tab","Esc","Up","Down","Right","Left"],ki=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).selectable=n.selectable,r.isSelected_=n.selected||!1,r.multiSelectable=n.multiSelectable,r.selected(r.isSelected_),r.selectable?r.multiSelectable?r.el_.setAttribute("role","menuitemcheckbox"):r.el_.setAttribute("role","menuitemradio"):r.el_.setAttribute("role","menuitem"),r}h()(t,e);var n=t.prototype;return n.createEl=function(t,n,r){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",Qe({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},n),r)},n.handleKeyDown=function(t){Ni.some((function(e){return g.a.isEventKey(t,e)}))||e.prototype.handleKeyDown.call(this,t)},n.handleClick=function(e){this.selected(!0)},n.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(Xr);bn.registerComponent("MenuItem",ki);var Fi=function(e){function t(t,n){var r,a=n.track,s=t.textTracks();n.label=a.label||a.language||"Unknown",n.selected="showing"===a.mode,(r=e.call(this,t,n)||this).track=a,r.kinds=(n.kinds||[n.kind||r.track.kind]).filter(Boolean);var u,l=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleTracksChange.apply(c()(r),t)},d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleSelectedLanguageChange.apply(c()(r),t)};(t.on(["loadstart","texttrackchange"],l),s.addEventListener("change",l),s.addEventListener("selectedlanguagechange",d),r.on("dispose",(function(){t.off(["loadstart","texttrackchange"],l),s.removeEventListener("change",l),s.removeEventListener("selectedlanguagechange",d)})),void 0===s.onchange)&&r.on(["tap","click"],(function(){if("object"!=typeof i.a.Event)try{u=new i.a.Event("change")}catch(e){}u||(u=o.a.createEvent("Event")).initEvent("change",!0,!0),s.dispatchEvent(u)}));return r.handleTracksChange(),r}h()(t,e);var n=t.prototype;return n.handleClick=function(t){var n=this.track,r=this.player_.textTracks();if(e.prototype.handleClick.call(this,t),r)for(var i=0;i<r.length;i++){var a=r[i];-1!==this.kinds.indexOf(a.kind)&&(a===n?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled"))}},n.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},n.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},n.dispose=function(){this.track=null,e.prototype.dispose.call(this)},t}(ki);bn.registerComponent("TextTrackMenuItem",Fi);var Bi=function(e){function t(t,n){return n.track={player:t,kind:n.kind,kinds:n.kinds,default:!1,mode:"disabled"},n.kinds||(n.kinds=[n.kind]),n.label?n.track.label=n.label:n.track.label=n.kinds.join(" and ")+" off",n.selectable=!0,n.multiSelectable=!1,e.call(this,t,n)||this}h()(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!0,r=0,i=t.length;r<i;r++){var a=t[r];if(this.options_.kinds.indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n!==this.isSelected_&&this.selected(n)},n.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),n=!0,r=0,i=t.length;r<i;r++){var a=t[r];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&"showing"===a.mode){n=!1;break}}n&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(Fi);bn.registerComponent("OffTextTrackMenuItem",Bi);var Ui=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.textTracks(),e.call(this,t,n)||this}return h()(t,e),t.prototype.createItems=function(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t=Fi),this.label_&&(n=this.label_+" off"),e.push(new Bi(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;var r=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var i=0;i<r.length;i++){var a=r[i];if(this.kinds_.indexOf(a.kind)>-1){var o=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+a.kind+"-menu-item"),e.push(o)}}return e},t}(Li);bn.registerComponent("TextTrackButton",Ui);var ji=function(e){function t(t,n){var r,i=n.track,a=n.cue,o=t.currentTime();return n.selectable=!0,n.multiSelectable=!1,n.label=a.text,n.selected=a.startTime<=o&&o<a.endTime,(r=e.call(this,t,n)||this).track=i,r.cue=a,i.addEventListener("cuechange",nn(c()(r),r.update)),r}h()(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},n.update=function(e){var t=this.cue,n=this.player_.currentTime();this.selected(t.startTime<=n&&n<t.endTime)},t}(ki);bn.registerComponent("ChaptersTrackMenuItem",ji);var Gi=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)},n.update=function(t){this.track_&&(!t||"addtrack"!==t.type&&"removetrack"!==t.type)||this.setTrack(this.findChaptersTrack()),e.prototype.update.call(this)},n.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.addEventListener("load",this.updateHandler_)}}},n.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;t>=0;t--){var n=e[t];if(n.kind===this.kind_)return n}},n.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(yn(this.kind_))},n.createMenu=function(){return this.options_.title=this.getMenuCaption(),e.prototype.createMenu.call(this)},n.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var n=0,r=t.length;n<r;n++){var i=t[n],a=new ji(this.player_,{track:this.track_,cue:i});e.push(a)}return e},t}(Ui);Gi.prototype.kind_="chapters",Gi.prototype.controlText_="Chapters",bn.registerComponent("ChaptersButton",Gi);var Hi=function(e){function t(t,n,r){var i;i=e.call(this,t,n,r)||this;var a=t.textTracks(),o=nn(c()(i),i.handleTracksChange);return a.addEventListener("change",o),i.on("dispose",(function(){a.removeEventListener("change",o)})),i}h()(t,e);var n=t.prototype;return n.handleTracksChange=function(e){for(var t=this.player().textTracks(),n=!1,r=0,i=t.length;r<i;r++){var a=t[r];if(a.kind!==this.kind_&&"showing"===a.mode){n=!0;break}}n?this.disable():this.enable()},n.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Ui);Hi.prototype.kind_="descriptions",Hi.prototype.controlText_="Descriptions",bn.registerComponent("DescriptionsButton",Hi);var Vi=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(Ui);Vi.prototype.kind_="subtitles",Vi.prototype.controlText_="Subtitles",bn.registerComponent("SubtitlesButton",Vi);var zi=function(e){function t(t,n){var r;return n.track={player:t,kind:n.kind,label:n.kind+" settings",selectable:!1,default:!1,mode:"disabled"},n.selectable=!1,n.name="CaptionSettingsMenuItem",(r=e.call(this,t,n)||this).addClass("vjs-texttrack-settings"),r.controlText(", opens "+n.kind+" settings dialog"),r}return h()(t,e),t.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").open()},t}(Fi);bn.registerComponent("CaptionSettingsMenuItem",zi);var Wi=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new zi(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t)},t}(Ui);Wi.prototype.kind_="captions",Wi.prototype.controlText_="Captions",bn.registerComponent("CaptionsButton",Wi);var qi=function(e){function t(){return e.apply(this,arguments)||this}return h()(t,e),t.prototype.createEl=function(t,n,r){var i='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(i+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),i+="</span>",e.prototype.createEl.call(this,t,Qe({innerHTML:i},n),r)},t}(Fi);bn.registerComponent("SubsCapsMenuItem",qi);var Yi=function(e){function t(t,n){var r;return void 0===n&&(n={}),(r=e.call(this,t,n)||this).label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(r.player_.language_)>-1&&(r.label_="captions"),r.menuButton_.controlText(yn(r.label_)),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new zi(this.player_,{kind:this.label_})),this.hideThreshold_+=1),t=e.prototype.createItems.call(this,t,qi)},t}(Ui);Yi.prototype.kinds_=["captions","subtitles"],Yi.prototype.controlText_="Subtitles",bn.registerComponent("SubsCapsButton",Yi);var Ki=function(e){function t(t,n){var r,i=n.track,a=t.audioTracks();n.label=i.label||i.language||"Unknown",n.selected=i.enabled,(r=e.call(this,t,n)||this).track=i,r.addClass("vjs-"+i.kind+"-menu-item");var o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleTracksChange.apply(c()(r),t)};return a.addEventListener("change",o),r.on("dispose",(function(){a.removeEventListener("change",o)})),r}h()(t,e);var n=t.prototype;return n.createEl=function(t,n,r){var i='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(i+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),i+="</span>",e.prototype.createEl.call(this,t,Qe({innerHTML:i},n),r)},n.handleClick=function(t){var n=this.player_.audioTracks();e.prototype.handleClick.call(this,t);for(var r=0;r<n.length;r++){var i=n[r];i.enabled=i===this.track}},n.handleTracksChange=function(e){this.selected(this.track.enabled)},t}(ki);bn.registerComponent("AudioTrackMenuItem",Ki);var Xi=function(e){function t(t,n){return void 0===n&&(n={}),n.tracks=t.audioTracks(),e.call(this,t,n)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)},n.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),n=0;n<t.length;n++){var r=t[n];e.push(new Ki(this.player_,{track:r,selectable:!0,multiSelectable:!1}))}return e},t}(Li);Xi.prototype.controlText_="Audio Track",bn.registerComponent("AudioTrackButton",Xi);var Qi=function(e){function t(t,n){var r,i=n.rate,a=parseFloat(i,10);return n.label=i,n.selected=1===a,n.selectable=!0,n.multiSelectable=!1,(r=e.call(this,t,n)||this).label=i,r.rate=a,r.on(t,"ratechange",r.update),r}h()(t,e);var n=t.prototype;return n.handleClick=function(t){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},n.update=function(e){this.selected(this.player().playbackRate()===this.rate)},t}(ki);Qi.prototype.contentElType="button",bn.registerComponent("PlaybackRateMenuItem",Qi);var Zi=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).updateVisibility(),r.updateLabel(),r.on(t,"loadstart",r.updateVisibility),r.on(t,"ratechange",r.updateLabel),r}h()(t,e);var n=t.prototype;return n.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelEl_=ot("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},n.dispose=function(){this.labelEl_=null,e.prototype.dispose.call(this)},n.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},n.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)},n.createMenu=function(){var e=new Di(this.player()),t=this.playbackRates();if(t)for(var n=t.length-1;n>=0;n--)e.addChild(new Qi(this.player(),{rate:t[n]+"x"}));return e},n.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},n.handleClick=function(e){for(var t=this.player().playbackRate(),n=this.playbackRates(),r=n[0],i=0;i<n.length;i++)if(n[i]>t){r=n[i];break}this.player().playbackRate(r)},n.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},n.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},n.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},n.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},t}(Pi);Zi.prototype.controlText_="Playback Rate",bn.registerComponent("PlaybackRateMenuButton",Zi);var Ji=function(e){function t(){return e.apply(this,arguments)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(bn);bn.registerComponent("Spacer",Ji);var $i=function(e){function t(){return e.apply(this,arguments)||this}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML="",t},t}(Ji);bn.registerComponent("CustomControlSpacer",$i);var ea=function(e){function t(){return e.apply(this,arguments)||this}return h()(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(bn);ea.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in o.a&&ea.prototype.options_.children.splice(ea.prototype.options_.children.length-1,0,"pictureInPictureToggle"),bn.registerComponent("ControlBar",ea);var ta=function(e){function t(t,n){var r;return(r=e.call(this,t,n)||this).on(t,"error",r.open),r}h()(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},n.content=function(){var e=this.player().error();return e?this.localize(e.message):""},t}(or);ta.prototype.options_=u()({},or.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),bn.registerComponent("ErrorDisplay",ta);var na="vjs-text-track-settings",ra=["#000","Black"],ia=["#00F","Blue"],aa=["#0FF","Cyan"],oa=["#0F0","Green"],sa=["#F0F","Magenta"],ua=["#F00","Red"],la=["#FFF","White"],ca=["#FF0","Yellow"],da=["1","Opaque"],ha=["0.5","Semi-Transparent"],fa=["0","Transparent"],pa={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[ra,la,ua,oa,ia,ca,sa,aa]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[da,ha,fa]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[la,ra,ua,oa,ia,ca,sa,aa]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[da,ha]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[fa,ha,da]}};function ma(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}pa.windowColor.options=pa.backgroundColor.options;var ga=function(e){function t(t,n){var r;return n.temporary=!1,(r=e.call(this,t,n)||this).updateDisplay=nn(c()(r),r.updateDisplay),r.fill(),r.hasBeenOpened_=r.hasBeenFilled_=!0,r.endDialog=ot("p",{className:"vjs-control-text",textContent:r.localize("End of dialog window.")}),r.el().appendChild(r.endDialog),r.setDefaults(),void 0===n.persistTextTrackSettings&&(r.options_.persistTextTrackSettings=r.options_.playerOptions.persistTextTrackSettings),r.on(r.$(".vjs-done-button"),"click",(function(){r.saveSettings(),r.close()})),r.on(r.$(".vjs-default-button"),"click",(function(){r.setDefaults(),r.updateDisplay()})),Xe(pa,(function(e){r.on(r.$(e.selector),"change",r.updateDisplay)})),r.options_.persistTextTrackSettings&&r.restoreSettings(),r}h()(t,e);var n=t.prototype;return n.dispose=function(){this.endDialog=null,e.prototype.dispose.call(this)},n.createElSelect_=function(e,t,n){var r=this;void 0===t&&(t=""),void 0===n&&(n="label");var i=pa[e],a=i.id.replace("%s",this.id_),o=[t,a].join(" ").trim();return["<"+n+' id="'+a+'" class="'+("label"===n?"vjs-label":"")+'">',this.localize(i.label),"</"+n+">",'<select aria-labelledby="'+o+'">'].concat(i.options.map((function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+o+" "+t+'">',r.localize(e[1]),"</option>"].join("")}))).concat("</select>").join("")},n.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},n.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},n.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},n.createElColors_=function(){return ot("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},n.createElFont_=function(){return ot("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},n.createElControls_=function(){var e=this.localize("restore all settings to the default values");return ot("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},n.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},n.label=function(){return this.localize("Caption Settings Dialog")},n.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},n.buildCSSClass=function(){return e.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},n.getValues=function(){var e,t,n,r=this;return t=function(e,t,n){var i,a,o=(i=r.$(t.selector),a=t.parser,ma(i.options[i.options.selectedIndex].value,a));return void 0!==o&&(e[n]=o),e},void 0===(n={})&&(n=0),Ke(e=pa).reduce((function(n,r){return t(n,e[r],r)}),n)},n.setValues=function(e){var t=this;Xe(pa,(function(n,r){!function(e,t,n){if(t)for(var r=0;r<e.options.length;r++)if(ma(e.options[r].value,n)===t){e.selectedIndex=r;break}}(t.$(n.selector),e[r],n.parser)}))},n.setDefaults=function(){var e=this;Xe(pa,(function(t){var n=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=n}))},n.restoreSettings=function(){var e;try{e=JSON.parse(i.a.localStorage.getItem(na))}catch(e){We.warn(e)}e&&this.setValues(e)},n.saveSettings=function(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?i.a.localStorage.setItem(na,JSON.stringify(e)):i.a.localStorage.removeItem(na)}catch(e){We.warn(e)}}},n.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},n.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,n=e&&e.captionsButton;t?t.focus():n&&n.focus()},t}(or);bn.registerComponent("TextTrackSettings",ga);var va=function(e){function t(t,n){var r,a=n.ResizeObserver||i.a.ResizeObserver;null===n.ResizeObserver&&(a=!1);var o=_n({createEl:!a,reportTouchActivity:!1},n);return(r=e.call(this,t,o)||this).ResizeObserver=n.ResizeObserver||i.a.ResizeObserver,r.loadListener_=null,r.resizeObserver_=null,r.debouncedHandler_=function(e,t,n,r){var a;void 0===r&&(r=i.a);var o=function(){var i=this,o=arguments,s=function(){a=null,s=null,n||e.apply(i,o)};!a&&n&&e.apply(i,o),r.clearTimeout(a),a=r.setTimeout(s,t)};return o.cancel=function(){r.clearTimeout(a),a=null},o}((function(){r.resizeHandler()}),100,!1,c()(r)),a?(r.resizeObserver_=new r.ResizeObserver(r.debouncedHandler_),r.resizeObserver_.observe(t.el())):(r.loadListener_=function(){if(r.el_&&r.el_.contentWindow){var e=r.debouncedHandler_,t=r.unloadListener_=function(){Xt(this,"resize",e),Xt(this,"unload",t),t=null};Kt(r.el_.contentWindow,"unload",t),Kt(r.el_.contentWindow,"resize",e)}},r.one("load",r.loadListener_)),r}h()(t,e);var n=t.prototype;return n.createEl=function(){return e.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},n.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},n.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,e.prototype.dispose.call(this)},t}(bn);bn.registerComponent("ResizeManager",va);var ya={trackingThreshold:30,liveTolerance:15},_a=function(e){function t(t,n){var r,i=_n(ya,n,{createEl:!1});return(r=e.call(this,t,i)||this).reset_(),r.on(r.player_,"durationchange",r.handleDurationchange),Ln&&"hidden"in o.a&&"visibilityState"in o.a&&r.on(o.a,"visibilitychange",r.handleVisibilityChange),r}h()(t,e);var n=t.prototype;return n.handleVisibilityChange=function(){this.player_.duration()===1/0&&(o.a.hidden?this.stopTracking():this.startTracking())},n.trackLive_=function(){var e=this.player_.seekable();if(e&&e.length){var t=Number(i.a.performance.now().toFixed(4)),n=-1===this.lastTime_?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+n;var r=this.liveCurrentTime(),a=this.player_.currentTime(),o=this.player_.paused()||this.seekedBehindLive_||Math.abs(r-a)>this.options_.liveTolerance;this.timeupdateSeen_&&r!==1/0||(o=!1),o!==this.behindLiveEdge_&&(this.behindLiveEdge_=o,this.trigger("liveedgechange"))}},n.handleDurationchange=function(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},n.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,tn),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLive_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked):(this.one(this.player_,"play",this.handlePlay),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate)))},n.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked)},n.handleSeeked=function(){var e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=!this.skipNextSeeked_&&e>2,this.skipNextSeeked_=!1,this.trackLive_()},n.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},n.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.skipNextSeeked_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLive_),this.off(this.player_,"seeked",this.handleSeeked),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate),this.off(this.player_,"timeupdate",this.seekToLiveEdge)},n.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},n.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.end(n));return t.length?t.sort()[t.length-1]:1/0},n.seekableStart=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.start(n));return t.length?t.sort()[0]:0},n.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},n.isLive=function(){return this.isTracking()},n.atLiveEdge=function(){return!this.behindLiveEdge()},n.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},n.pastSeekEnd=function(){var e=this.seekableEnd();return-1!==this.lastSeekEnd_&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_},n.behindLiveEdge=function(){return this.behindLiveEdge_},n.isTracking=function(){return"number"==typeof this.trackingInterval_},n.seekToLiveEdge=function(){this.seekedBehindLive_=!1,this.atLiveEdge()||(this.skipNextSeeked_=!0,this.player_.currentTime(this.liveCurrentTime()))},n.dispose=function(){this.off(o.a,"visibilitychange",this.handleVisibilityChange),this.stopTracking(),e.prototype.dispose.call(this)},t}(bn);bn.registerComponent("LiveTracker",_a);var ba,Ea=function(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var n=e.$$("source"),r=[],i="";if(!n.length)return!1;for(var a=0;a<n.length;a++){var o=n[a].src;o&&-1===r.indexOf(o)&&r.push(o)}return!!r.length&&(1===r.length&&(i=r[0]),e.triggerSourceset(i),!0)},Ta=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(e){var t=o.a.createElement(this.nodeName.toLowerCase());t.innerHTML=e;for(var n=o.a.createDocumentFragment();t.childNodes.length;)n.appendChild(t.childNodes[0]);return this.innerText="",i.a.Element.prototype.appendChild.call(this,n),this.innerHTML}}),Sa=function(e,t){for(var n={},r=0;r<e.length&&!((n=Object.getOwnPropertyDescriptor(e[r],t))&&n.set&&n.get);r++);return n.enumerable=!0,n.configurable=!0,n},wa=function(e){var t=e.el();if(!t.resetSourceWatch_){var n={},r=function(e){return Sa([e.el(),i.a.HTMLMediaElement.prototype,i.a.Element.prototype,Ta],"innerHTML")}(e),a=function(n){return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var o=n.apply(t,i);return Ea(e),o}};["append","appendChild","insertAdjacentHTML"].forEach((function(e){t[e]&&(n[e]=t[e],t[e]=a(n[e]))})),Object.defineProperty(t,"innerHTML",_n(r,{set:a(r.set)})),t.resetSourceWatch_=function(){t.resetSourceWatch_=null,Object.keys(n).forEach((function(e){t[e]=n[e]})),Object.defineProperty(t,"innerHTML",r)},e.one("sourceset",t.resetSourceWatch_)}},Aa=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?Tr(i.a.Element.prototype.getAttribute.call(this,"src")):""},set:function(e){return i.a.Element.prototype.setAttribute.call(this,"src",e),e}}),xa=function(e){if(e.featuresSourceset){var t=e.el();if(!t.resetSourceset_){var n=function(e){return Sa([e.el(),i.a.HTMLMediaElement.prototype,Aa],"src")}(e),r=t.setAttribute,a=t.load;Object.defineProperty(t,"src",_n(n,{set:function(r){var i=n.set.call(t,r);return e.triggerSourceset(t.src),i}})),t.setAttribute=function(n,i){var a=r.call(t,n,i);return/src/i.test(n)&&e.triggerSourceset(t.src),a},t.load=function(){var n=a.call(t);return Ea(e)||(e.triggerSourceset(""),wa(e)),n},t.currentSrc?e.triggerSourceset(t.currentSrc):Ea(e)||wa(e),t.resetSourceset_=function(){t.resetSourceset_=null,t.load=a,t.setAttribute=r,Object.defineProperty(t,"src",n),t.resetSourceWatch_&&t.resetSourceWatch_()}}}},Ma=function(e,t,n,r){void 0===r&&(r=!0);var i=function(n){return Object.defineProperty(e,t,{value:n,enumerable:!0,writable:!0})},a={configurable:!0,enumerable:!0,get:function(){var e=n();return i(e),e}};return r&&(a.set=i),Object.defineProperty(e,t,a)},Ca=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var i=t.source,a=!1;if(i&&(r.el_.currentSrc!==i.src||t.tag&&3===t.tag.initNetworkState_)?r.setSource(i):r.handleLateInit_(r.el_),t.enableSourceset&&r.setupSourcesetHandling_(),r.el_.hasChildNodes()){for(var o=r.el_.childNodes,s=o.length,u=[];s--;){var l=o[s];"track"===l.nodeName.toLowerCase()&&(r.featuresNativeTextTracks?(r.remoteTextTrackEls().addTrackElement_(l),r.remoteTextTracks().addTrack(l.track),r.textTracks().addTrack(l.track),a||r.el_.hasAttribute("crossorigin")||!wr(l.src)||(a=!0)):u.push(l))}for(var c=0;c<u.length;c++)r.el_.removeChild(u[c])}return r.proxyNativeTracks_(),r.featuresNativeTextTracks&&a&&We.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),r.restoreMetadataTracksInIOSNativePlayer_(),(Fn||Un||Rn)&&!0===t.nativeControlsForTouch&&r.setControls(!0),r.proxyWebkitFullscreen_(),r.triggerReady(),r}h()(t,e);var n=t.prototype;return n.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),t.disposeMediaElement(this.el_),this.options_=null,e.prototype.dispose.call(this)},n.setupSourcesetHandling_=function(){xa(this)},n.restoreMetadataTracksInIOSNativePlayer_=function(){var e,t=this.textTracks(),n=function(){e=[];for(var n=0;n<t.length;n++){var r=t[n];"metadata"===r.kind&&e.push({track:r,storedMode:r.mode})}};n(),t.addEventListener("change",n),this.on("dispose",(function(){return t.removeEventListener("change",n)}));var r=function n(){for(var r=0;r<e.length;r++){var i=e[r];"disabled"===i.track.mode&&i.track.mode!==i.storedMode&&(i.track.mode=i.storedMode)}t.removeEventListener("change",n)};this.on("webkitbeginfullscreen",(function(){t.removeEventListener("change",n),t.removeEventListener("change",r),t.addEventListener("change",r)})),this.on("webkitendfullscreen",(function(){t.removeEventListener("change",n),t.addEventListener("change",n),t.removeEventListener("change",r)}))},n.overrideNative_=function(e,t){var n=this;if(t===this["featuresNative"+e+"Tracks"]){var r=e.toLowerCase();this[r+"TracksListeners_"]&&Object.keys(this[r+"TracksListeners_"]).forEach((function(e){n.el()[r+"Tracks"].removeEventListener(e,n[r+"TracksListeners_"][e])})),this["featuresNative"+e+"Tracks"]=!t,this[r+"TracksListeners_"]=null,this.proxyNativeTracksForType_(r)}},n.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},n.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},n.proxyNativeTracksForType_=function(e){var t=this,n=Dr[e],r=this.el()[n.getterName],i=this[n.getterName]();if(this["featuresNative"+n.capitalName+"Tracks"]&&r&&r.addEventListener){var a={change:function(n){var r={type:"change",target:i,currentTarget:i,srcElement:i};i.trigger(r),"text"===e&&t[Pr.remoteText.getterName]().trigger(r)},addtrack:function(e){i.addTrack(e.track)},removetrack:function(e){i.removeTrack(e.track)}},o=function(){for(var e=[],t=0;t<i.length;t++){for(var n=!1,a=0;a<r.length;a++)if(r[a]===i[t]){n=!0;break}n||e.push(i[t])}for(;e.length;)i.removeTrack(e.shift())};this[n.getterName+"Listeners_"]=a,Object.keys(a).forEach((function(e){var n=a[e];r.addEventListener(e,n),t.on("dispose",(function(t){return r.removeEventListener(e,n)}))})),this.on("loadstart",o),this.on("dispose",(function(e){return t.off("loadstart",o)}))}},n.proxyNativeTracks_=function(){var e=this;Dr.names.forEach((function(t){e.proxyNativeTracksForType_(t)}))},n.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var n=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(n,e),t.disposeMediaElement(e),e=n}else{e=o.a.createElement("video");var r=_n({},this.options_.tag&&pt(this.options_.tag));Fn&&!0===this.options_.nativeControlsForTouch||delete r.controls,ft(e,Qe(r,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&gt(e,"preload",this.options_.preload);for(var i=["loop","muted","playsinline","autoplay"],a=0;a<i.length;a++){var s=i[a],u=this.options_[s];void 0!==u&&(u?gt(e,s,s):vt(e,s),e[s]=u)}return e},n.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){var t=!1,n=function(){t=!0};this.on("loadstart",n);var r=function(){t||this.trigger("loadstart")};return this.on("loadedmetadata",r),void this.ready((function(){this.off("loadstart",n),this.off("loadedmetadata",r),t||this.trigger("loadstart")}))}var i=["loadstart"];i.push("loadedmetadata"),e.readyState>=2&&i.push("loadeddata"),e.readyState>=3&&i.push("canplay"),e.readyState>=4&&i.push("canplaythrough"),this.ready((function(){i.forEach((function(e){this.trigger(e)}),this)}))}},n.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){We(e,"Video is not ready. (Video.js)")}},n.duration=function(){var e=this;if(this.el_.duration===1/0&&Mn&&Dn&&0===this.el_.currentTime){return this.on("timeupdate",(function t(){e.el_.currentTime>0&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",t))})),NaN}return this.el_.duration||NaN},n.width=function(){return this.el_.offsetWidth},n.height=function(){return this.el_.offsetHeight},n.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},n=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",n),this.on("dispose",(function(){e.off("webkitbeginfullscreen",n),e.off("webkitendfullscreen",t)}))}},n.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var e=i.a.navigator&&i.a.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},n.enterFullScreen=function(){var e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)nr(this.el_.play()),this.setTimeout((function(){e.pause();try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}}),0);else try{e.webkitEnterFullScreen()}catch(e){this.trigger("fullscreenerror",e)}},n.exitFullScreen=function(){this.el_.webkitDisplayingFullscreen?this.el_.webkitExitFullScreen():this.trigger("fullscreenerror",new Error("The video is not fullscreen"))},n.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},n.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},n.reset=function(){t.resetMediaElement(this.el_)},n.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},n.setControls=function(e){this.el_.controls=!!e},n.addTextTrack=function(t,n,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(t,n,r):e.prototype.addTextTrack.call(this,t,n,r)},n.createRemoteTextTrack=function(t){if(!this.featuresNativeTextTracks)return e.prototype.createRemoteTextTrack.call(this,t);var n=o.a.createElement("track");return t.kind&&(n.kind=t.kind),t.label&&(n.label=t.label),(t.language||t.srclang)&&(n.srclang=t.language||t.srclang),t.default&&(n.default=t.default),t.id&&(n.id=t.id),t.src&&(n.src=t.src),n},n.addRemoteTextTrack=function(t,n){var r=e.prototype.addRemoteTextTrack.call(this,t,n);return this.featuresNativeTextTracks&&this.el().appendChild(r),r},n.removeRemoteTextTrack=function(t){if(e.prototype.removeRemoteTextTrack.call(this,t),this.featuresNativeTextTracks)for(var n=this.$$("track"),r=n.length;r--;)t!==n[r]&&t!==n[r].track||this.el().removeChild(n[r])},n.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var e={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),i.a.performance&&"function"==typeof i.a.performance.now?e.creationTime=i.a.performance.now():i.a.performance&&i.a.performance.timing&&"number"==typeof i.a.performance.timing.navigationStart&&(e.creationTime=i.a.Date.now()-i.a.performance.timing.navigationStart),e},t}(Nr);Ma(Ca,"TEST_VID",(function(){if(nt()){var e=o.a.createElement("video"),t=o.a.createElement("track");return t.kind="captions",t.srclang="en",t.label="English",e.appendChild(t),e}})),Ca.isSupported=function(){try{Ca.TEST_VID.volume=.5}catch(e){return!1}return!(!Ca.TEST_VID||!Ca.TEST_VID.canPlayType)},Ca.canPlayType=function(e){return Ca.TEST_VID.canPlayType(e)},Ca.canPlaySource=function(e,t){return Ca.canPlayType(e.type)},Ca.canControlVolume=function(){try{var e=Ca.TEST_VID.volume;return Ca.TEST_VID.volume=e/2+.1,e!==Ca.TEST_VID.volume}catch(e){return!1}},Ca.canMuteVolume=function(){try{var e=Ca.TEST_VID.muted;return Ca.TEST_VID.muted=!e,Ca.TEST_VID.muted?gt(Ca.TEST_VID,"muted","muted"):vt(Ca.TEST_VID,"muted"),e!==Ca.TEST_VID.muted}catch(e){return!1}},Ca.canControlPlaybackRate=function(){if(Mn&&Dn&&Pn<58)return!1;try{var e=Ca.TEST_VID.playbackRate;return Ca.TEST_VID.playbackRate=e/2+.1,e!==Ca.TEST_VID.playbackRate}catch(e){return!1}},Ca.canOverrideAttributes=function(){try{var e=function(){};Object.defineProperty(o.a.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(o.a.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(o.a.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(o.a.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},Ca.supportsNativeTextTracks=function(){return Gn||jn&&Dn},Ca.supportsNativeVideoTracks=function(){return!(!Ca.TEST_VID||!Ca.TEST_VID.videoTracks)},Ca.supportsNativeAudioTracks=function(){return!(!Ca.TEST_VID||!Ca.TEST_VID.audioTracks)},Ca.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach((function(e){var t=e[0],n=e[1];Ma(Ca.prototype,t,(function(){return Ca[n]()}),!0)})),Ca.prototype.movingMediaElementInDOM=!jn,Ca.prototype.featuresFullscreenResize=!0,Ca.prototype.featuresProgressEvents=!0,Ca.prototype.featuresTimeupdateEvents=!0,Ca.patchCanPlayType=function(){Cn>=4&&!In&&!Dn&&(ba=Ca.TEST_VID&&Ca.TEST_VID.constructor.prototype.canPlayType,Ca.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&/^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(e)?"maybe":ba.call(this,e)})},Ca.unpatchCanPlayType=function(){var e=Ca.TEST_VID.constructor.prototype.canPlayType;return ba&&(Ca.TEST_VID.constructor.prototype.canPlayType=ba),e},Ca.patchCanPlayType(),Ca.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},Ca.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),n=t.length;n--;)e.removeChild(t[n]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach((function(e){Ca.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}})),["muted","defaultMuted","autoplay","loop","playsinline"].forEach((function(e){Ca.prototype["set"+yn(e)]=function(t){this.el_[e]=t,t?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}})),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach((function(e){Ca.prototype[e]=function(){return this.el_[e]}})),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","crossOrigin"].forEach((function(e){Ca.prototype["set"+yn(e)]=function(t){this.el_[e]=t}})),["pause","load","play"].forEach((function(e){Ca.prototype[e]=function(){return this.el_[e]()}})),Nr.withSourceHandlers(Ca),Ca.nativeSourceHandler={},Ca.nativeSourceHandler.canPlayType=function(e){try{return Ca.TEST_VID.canPlayType(e)}catch(e){return""}},Ca.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Ca.nativeSourceHandler.canPlayType(e.type);if(e.src){var n=Sr(e.src);return Ca.nativeSourceHandler.canPlayType("video/"+n)}return""},Ca.nativeSourceHandler.handleSource=function(e,t,n){t.setSrc(e.src)},Ca.nativeSourceHandler.dispose=function(){},Ca.registerSourceHandler(Ca.nativeSourceHandler),Nr.registerTech("Html5",Ca);var Ra=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Ia={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Oa=["tiny","xsmall","small","medium","large","xlarge","huge"],Da={};Oa.forEach((function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Da[e]="vjs-layout-"+t}));var Pa={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},La=function(e){function t(n,r,i){var a;if(n.id=n.id||r.id||"vjs_video_"+Gt(),(r=Qe(t.getTagSettings(n),r)).initChildren=!1,r.createEl=!1,r.evented=!1,r.reportTouchActivity=!1,!r.language)if("function"==typeof n.closest){var s=n.closest("[lang]");s&&s.getAttribute&&(r.language=s.getAttribute("lang"))}else for(var u=n;u&&1===u.nodeType;){if(pt(u).hasOwnProperty("lang")){r.language=u.getAttribute("lang");break}u=u.parentNode}if((a=e.call(this,null,r,i)||this).boundDocumentFullscreenChange_=nn(c()(a),a.documentFullscreenChange_),a.boundFullWindowOnEscKey_=nn(c()(a),a.fullWindowOnEscKey),a.isFullscreen_=!1,a.log=qe(a.id_),a.fsApi_=Kn,a.isPosterFromTech_=!1,a.queuedCallbacks_=[],a.isReady_=!1,a.hasStarted_=!1,a.userActive_=!1,!a.options_||!a.options_.techOrder||!a.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(a.tag=n,a.tagAttributes=n&&pt(n),a.language(a.options_.language),r.languages){var l={};Object.getOwnPropertyNames(r.languages).forEach((function(e){l[e.toLowerCase()]=r.languages[e]})),a.languages_=l}else a.languages_=t.prototype.options_.languages;a.resetCache_(),a.poster_=r.poster||"",a.controls_=!!r.controls,n.controls=!1,n.removeAttribute("controls"),a.changingSrc_=!1,a.playCallbacks_=[],a.playTerminatedQueue_=[],n.hasAttribute("autoplay")?a.autoplay(!0):a.autoplay(a.options_.autoplay),r.plugins&&Object.keys(r.plugins).forEach((function(e){if("function"!=typeof a[e])throw new Error('plugin "'+e+'" does not exist')})),a.scrubbing_=!1,a.el_=a.createEl(),pn(c()(a),{eventBusKey:"el_"}),a.fsApi_.requestFullscreen&&(Kt(o.a,a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_),a.on(a.fsApi_.fullscreenchange,a.boundDocumentFullscreenChange_)),a.fluid_&&a.on("playerreset",a.updateStyleEl_);var d=_n(a.options_);r.plugins&&Object.keys(r.plugins).forEach((function(e){a[e](r.plugins[e])})),a.options_.playerOptions=d,a.middleware_=[],a.initChildren(),a.isAudio("audio"===n.nodeName.toLowerCase()),a.controls()?a.addClass("vjs-controls-enabled"):a.addClass("vjs-controls-disabled"),a.el_.setAttribute("role","region"),a.isAudio()?a.el_.setAttribute("aria-label",a.localize("Audio Player")):a.el_.setAttribute("aria-label",a.localize("Video Player")),a.isAudio()&&a.addClass("vjs-audio"),a.flexNotSupported_()&&a.addClass("vjs-no-flex"),Fn&&a.addClass("vjs-touch-enabled"),jn||a.addClass("vjs-workinghover"),t.players[a.id_]=c()(a);var h=Ve.split(".")[0];return a.addClass("vjs-v"+h),a.userActive(!0),a.reportUserActivity(),a.one("play",a.listenForUserActivity_),a.on("stageclick",a.handleStageClick_),a.on("keydown",a.handleKeyDown),a.breakpoints(a.options_.breakpoints),a.responsive(a.options_.responsive),a}h()(t,e);var n=t.prototype;return n.dispose=function(){var n=this;this.trigger("dispose"),this.off("dispose"),Xt(o.a,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),Xt(o.a,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),t.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),Fr[this.id()]=null,Lr.names.forEach((function(e){var t=Lr[e],r=n[t.getterName]();r&&r.off&&r.off()})),e.prototype.dispose.call(this)},n.createEl=function(){var t,n=this.tag,r=this.playerElIngest_=n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player"),a="video-js"===this.tag.tagName.toLowerCase();r?t=this.el_=n.parentNode:a||(t=this.el_=e.prototype.createEl.call(this,"div"));var s=pt(n);if(a){for(t=this.el_=n,n=this.tag=o.a.createElement("video");t.children.length;)n.appendChild(t.firstChild);lt(t,"video-js")||ct(t,"video-js"),t.appendChild(n),r=this.playerElIngest_=t,Object.keys(t).forEach((function(e){try{n[e]=t[e]}catch(e){}}))}if(n.setAttribute("tabindex","-1"),s.tabindex="-1",(Ln||Dn&&kn)&&(n.setAttribute("role","application"),s.role="application"),n.removeAttribute("width"),n.removeAttribute("height"),"width"in s&&delete s.width,"height"in s&&delete s.height,Object.getOwnPropertyNames(s).forEach((function(e){a&&"class"===e||t.setAttribute(e,s[e]),a&&n.setAttribute(e,s[e])})),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=t.player=this,this.addClass("vjs-paused"),!0!==i.a.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Bt("vjs-styles-dimensions");var u=It(".vjs-styles-defaults"),l=It("head");l.insertBefore(this.styleEl_,u?u.nextSibling:l.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var c=n.getElementsByTagName("a"),d=0;d<c.length;d++){var h=c.item(d);ct(h,"vjs-hidden"),h.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&!r&&n.parentNode.insertBefore(t,n),ut(n,t),this.children_.unshift(n),this.el_.setAttribute("lang",this.language_),this.el_=t,t},n.crossOrigin=function(e){if(!e)return this.techGet_("crossOrigin");"anonymous"===e||"use-credentials"===e?this.techCall_("setCrossOrigin",e):We.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+e+'"')},n.width=function(e){return this.dimension("width",e)},n.height=function(e){return this.dimension("height",e)},n.dimension=function(e,t){var n=e+"_";if(void 0===t)return this[n]||0;if(""===t||"auto"===t)return this[n]=void 0,void this.updateStyleEl_();var r=parseFloat(t);isNaN(r)?We.error('Improper value "'+t+'" supplied for for '+e):(this[n]=r,this.updateStyleEl_())},n.fluid=function(e){if(void 0===e)return!!this.fluid_;var t,n;this.fluid_=!!e,on(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),on(t=function(){this.on("playerreset",this.updateStyleEl_)})?n():(t.eventedCallbacks||(t.eventedCallbacks=[]),t.eventedCallbacks.push(n))):this.removeClass("vjs-fluid"),this.updateStyleEl_()},n.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},n.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},n.updateStyleEl_=function(){if(!0!==i.a.VIDEOJS_NO_DYNAMIC_STYLE){var e,t,n,r=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),a=r[1]/r[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/a:this.videoWidth()||300,t=void 0!==this.height_?this.height_:e*a,n=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(n),Ut(this.styleEl_,"\n      ."+n+" {\n        width: "+e+"px;\n        height: "+t+"px;\n      }\n\n      ."+n+".vjs-fluid {\n        padding-top: "+100*a+"%;\n      }\n    ")}else{var o="number"==typeof this.width_?this.width_:this.options_.width,s="number"==typeof this.height_?this.height_:this.options_.height,u=this.tech_&&this.tech_.el();u&&(o>=0&&(u.width=o),s>=0&&(u.height=s))}},n.loadTech_=function(e,t){var n=this;this.tech_&&this.unloadTech_();var r=yn(e),i=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==r&&this.tag&&(Nr.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=r,this.isReady_=!1;var a={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+i+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};Lr.names.forEach((function(e){var t=Lr[e];a[t.getterName]=n[t.privateName]})),Qe(a,this.options_[r]),Qe(a,this.options_[i]),Qe(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(a.startTime=this.cache_.currentTime);var o=Nr.getTech(e);if(!o)throw new Error("No Tech named '"+r+"' exists! '"+r+"' should be registered using videojs.registerTech()'");this.tech_=new o(a),this.tech_.ready(nn(this,this.handleTechReady_),!0),ar(this.textTracksJson_||[],this.tech_),Ra.forEach((function(e){n.on(n.tech_,e,n["handleTech"+yn(e)+"_"])})),Object.keys(Ia).forEach((function(e){n.on(n.tech_,e,(function(t){0===n.tech_.playbackRate()&&n.tech_.seeking()?n.queuedCallbacks_.push({callback:n["handleTech"+Ia[e]+"_"].bind(n),event:t}):n["handleTech"+Ia[e]+"_"](t)}))})),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"fullscreenerror",this.handleTechFullscreenError_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===r&&this.tag||ut(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},n.unloadTech_=function(){var e=this;Lr.names.forEach((function(t){var n=Lr[t];e[n.privateName]=e[n.getterName]()})),this.textTracksJson_=ir(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},n.tech=function(e){return void 0===e&&We.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_},n.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},n.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},n.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},n.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},n.manualAutoplay_=function(e){var t=this;if(this.tech_&&"string"==typeof e){var n,r=function(){var e=t.muted();t.muted(!0);var n=function(){t.muted(e)};t.playTerminatedQueue_.push(n);var r=t.play();if(tr(r))return r.catch(n)};if("any"===e&&!0!==this.muted()?tr(n=this.play())&&(n=n.catch(r)):n="muted"===e&&!0!==this.muted()?r():this.play(),tr(n))return n.then((function(){t.trigger({type:"autoplay-success",autoplay:e})})).catch((function(n){t.trigger({type:"autoplay-failure",autoplay:e})}))}},n.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,n="";"string"!=typeof t&&(t=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!n&&(n=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var n=e.cache_.sources.filter((function(e){return e.src===t}));if(n.length)return n[0].type;for(var r=e.$$("source"),i=0;i<r.length;i++){var a=r[i];if(a.type&&a.src&&a.src===t)return a.type}return qr(t)}(this,t)),this.cache_.source=_n({},e,{src:t,type:n});for(var r=this.cache_.sources.filter((function(e){return e.src&&e.src===t})),i=[],a=this.$$("source"),o=[],s=0;s<a.length;s++){var u=pt(a[s]);i.push(u),u.src&&u.src===t&&o.push(u.src)}o.length&&!r.length?this.cache_.sources=i:r.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},n.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var n=function(e){return t.updateSourceCaches_(e)},r=this.currentSource().src,i=e.src;r&&!/^blob:/.test(r)&&/^blob:/.test(i)&&(!this.lastSource_||this.lastSource_.tech!==i&&this.lastSource_.player!==r)&&(n=function(){}),n(i),e.src||this.tech_.any(["sourceset","loadstart"],(function(e){if("sourceset"!==e.type){var n=t.techGet("currentSrc");t.lastSource_.tech=n,t.updateSourceCaches_(n)}}))}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},n.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},n.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},n.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach((function(e){return e.callback(e.event)})),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},n.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting");var t=this.currentTime();this.on("timeupdate",(function n(){t!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",n))}))},n.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},n.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},n.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},n.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},n.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},n.handleTechFirstPlay_=function(){this.options_.starttime&&(We.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},n.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},n.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},n.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},n.handleTechClick_=function(e){Ct(e)&&this.controls_&&(this.paused()?nr(this.play()):this.pause())},n.handleTechDoubleClick_=function(e){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),(function(t){return t.contains(e.target)}))||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},n.handleTechTap_=function(){this.userActive(!this.userActive())},n.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},n.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},n.handleTechTouchEnd_=function(e){e.preventDefault()},n.handleStageClick_=function(){this.reportUserActivity()},n.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},n.documentFullscreenChange_=function(e){var t=e.target.player;if(!t||t===this){var n=this.el(),r=o.a[this.fsApi_.fullscreenElement]===n;!r&&n.matches?r=n.matches(":"+this.fsApi_.fullscreen):!r&&n.msMatchesSelector&&(r=n.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(r)}},n.handleTechFullscreenChange_=function(e,t){t&&(t.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(t.isFullscreen))},n.handleTechFullscreenError_=function(e,t){this.trigger("fullscreenerror",t)},n.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},n.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},n.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},n.handleTechError_=function(){var e=this.tech_.error();this.error(e)},n.handleTechTextData_=function(){var e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)},n.getCache=function(){return this.cache_},n.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},n.techCall_=function(e,t){this.ready((function(){if(e in Hr)return function(e,t,n,r){return t[n](e.reduce(zr(n),r))}(this.middleware_,this.tech_,e,t);if(e in Vr)return jr(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(e){throw We(e),e}}),!0)},n.techGet_=function(e){if(this.tech_&&this.tech_.isReady_){if(e in Gr)return function(e,t,n){return e.reduceRight(zr(n),t[n]())}(this.middleware_,this.tech_,e);if(e in Vr)return jr(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){if(void 0===this.tech_[e])throw We("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",t),t;if("TypeError"===t.name)throw We("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",t),this.tech_.isReady_=!1,t;throw We(t),t}}},n.play=function(){var e=this,t=this.options_.Promise||i.a.Promise;return t?new t((function(t){e.play_(t)})):this.play_()},n.play_=function(e){var t=this;void 0===e&&(e=nr),this.playCallbacks_.push(e);var n=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!n)return this.waitToPlay_=function(e){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(n||!Gn&&!jn||this.load());var r=this.techGet_("play");null===r?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(r)},n.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach((function(e){e()}))},n.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach((function(t){t(e)}))},n.pause=function(){this.techCall_("pause")},n.paused=function(){return!1!==this.techGet_("paused")},n.played=function(){return this.techGet_("played")||Wn(0,0)},n.scrubbing=function(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},n.currentTime=function(e){return void 0!==e?(e<0&&(e=0),this.isReady_&&!this.changingSrc_&&this.tech_&&this.tech_.isReady_?(this.techCall_("setCurrentTime",e),void(this.cache_.initTime=0)):(this.cache_.initTime=e,this.off("canplay",this.applyInitTime_),void this.one("canplay",this.applyInitTime_))):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},n.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},n.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))},n.remainingTime=function(){return this.duration()-this.currentTime()},n.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},n.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=Wn(0,0)),e},n.bufferedPercent=function(){return qn(this.buffered(),this.duration())},n.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),n=e.end(e.length-1);return n>t&&(n=t),n},n.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(t>0&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},n.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},n.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},n.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},n.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},n.isFullscreen=function(e){if(void 0!==e){var t=this.isFullscreen_;return this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),void this.toggleFullscreenClass_()}return this.isFullscreen_},n.requestFullscreen=function(e){var t=this.options_.Promise||i.a.Promise;if(t){var n=this;return new t((function(t,r){function i(){n.off("fullscreenerror",o),n.off("fullscreenchange",a)}function a(){i(),t()}function o(e,t){i(),r(t)}n.one("fullscreenchange",a),n.one("fullscreenerror",o);var s=n.requestFullscreenHelper_(e);if(s)return s.then(i,i),s}))}return this.requestFullscreenHelper_()},n.requestFullscreenHelper_=function(e){var t,n=this;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(t=e)),this.fsApi_.requestFullscreen){var r=this.el_[this.fsApi_.requestFullscreen](t);return r&&r.then((function(){return n.isFullscreen(!0)}),(function(){return n.isFullscreen(!1)})),r}this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):this.enterFullWindow()},n.exitFullscreen=function(){var e=this.options_.Promise||i.a.Promise;if(e){var t=this;return new e((function(e,n){function r(){t.off("fullscreenerror",a),t.off("fullscreenchange",i)}function i(){r(),e()}function a(e,t){r(),n(t)}t.one("fullscreenchange",i),t.one("fullscreenerror",a);var o=t.exitFullscreenHelper_();if(o)return o.then(r,r),o}))}return this.exitFullscreenHelper_()},n.exitFullscreenHelper_=function(){var e=this;if(this.fsApi_.requestFullscreen){var t=o.a[this.fsApi_.exitFullscreen]();return t&&t.then((function(){return e.isFullscreen(!1)})),t}this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):this.exitFullWindow()},n.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=o.a.documentElement.style.overflow,Kt(o.a,"keydown",this.boundFullWindowOnEscKey_),o.a.documentElement.style.overflow="hidden",ct(o.a.body,"vjs-full-window"),this.trigger("enterFullWindow")},n.fullWindowOnEscKey=function(e){g.a.isEventKey(e,"Esc")&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},n.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,Xt(o.a,"keydown",this.boundFullWindowOnEscKey_),o.a.documentElement.style.overflow=this.docOrigOverflow,dt(o.a.body,"vjs-full-window"),this.trigger("exitFullWindow")},n.isInPictureInPicture=function(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},n.requestPictureInPicture=function(){if("pictureInPictureEnabled"in o.a)return this.techGet_("requestPictureInPicture")},n.exitPictureInPicture=function(){if("pictureInPictureEnabled"in o.a)return o.a.exitPictureInPicture()},n.handleKeyDown=function(e){var t=this.options_.userActions;if(t&&t.hotkeys){(function(e){var t=e.tagName.toLowerCase();if(e.isContentEditable)return!0;if("input"===t)return-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(e.type);return-1!==["textarea"].indexOf(t)})(this.el_.ownerDocument.activeElement)||("function"==typeof t.hotkeys?t.hotkeys.call(this,e):this.handleHotkeys(e))}},n.handleHotkeys=function(e){var t=this.options_.userActions?this.options_.userActions.hotkeys:{},n=t.fullscreenKey,r=void 0===n?function(e){return g.a.isEventKey(e,"f")}:n,i=t.muteKey,a=void 0===i?function(e){return g.a.isEventKey(e,"m")}:i,s=t.playPauseKey,u=void 0===s?function(e){return g.a.isEventKey(e,"k")||g.a.isEventKey(e,"Space")}:s;if(r.call(this,e)){e.preventDefault(),e.stopPropagation();var l=bn.getComponent("FullscreenToggle");!1!==o.a[this.fsApi_.fullscreenEnabled]&&l.prototype.handleClick.call(this,e)}else if(a.call(this,e)){e.preventDefault(),e.stopPropagation(),bn.getComponent("MuteToggle").prototype.handleClick.call(this,e)}else if(u.call(this,e)){e.preventDefault(),e.stopPropagation(),bn.getComponent("PlayToggle").prototype.handleClick.call(this,e)}},n.canPlayType=function(e){for(var t,n=0,r=this.options_.techOrder;n<r.length;n++){var i=r[n],a=Nr.getTech(i);if(a||(a=bn.getComponent(i)),a){if(a.isSupported()&&(t=a.canPlayType(e)))return t}else We.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.')}return""},n.selectSource=function(e){var t,n=this,r=this.options_.techOrder.map((function(e){return[e,Nr.getTech(e)]})).filter((function(e){var t=e[0],n=e[1];return n?n.isSupported():(We.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)})),i=function(e,t,n){var r;return e.some((function(e){return t.some((function(t){if(r=n(e,t))return!0}))})),r},a=function(e,t){var r=e[0];if(e[1].canPlaySource(t,n.options_[r.toLowerCase()]))return{source:t,tech:r}};return(this.options_.sourceOrder?i(e,r,(t=a,function(e,n){return t(n,e)})):i(r,e,a))||!1},n.src=function(e){var t=this;if(void 0===e)return this.cache_.src||"";var n=function e(t){if(Array.isArray(t)){var n=[];t.forEach((function(t){t=e(t),Array.isArray(t)?n=n.concat(t):Ze(t)&&n.push(t)})),t=n}else t="string"==typeof t&&t.trim()?[Yr({src:t})]:Ze(t)&&"string"==typeof t.src&&t.src&&t.src.trim()?[Yr(t)]:[];return t}(e);n.length?(this.changingSrc_=!0,this.cache_.sources=n,this.updateSourceCaches_(n[0]),Ur(this,n[0],(function(e,r){var i,a;if(t.middleware_=r,t.cache_.sources=n,t.updateSourceCaches_(e),t.src_(e))return n.length>1?t.src(n.slice(1)):(t.changingSrc_=!1,t.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0),void t.triggerReady());i=r,a=t.tech_,i.forEach((function(e){return e.setTech&&e.setTech(a)}))}))):this.setTimeout((function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})}),0)},n.src_=function(e){var t,n,r=this,i=this.selectSource([e]);return!i||(t=i.tech,n=this.techName_,yn(t)!==yn(n)?(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready((function(){r.changingSrc_=!1})),!1):(this.ready((function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1}),!0),!1))},n.load=function(){this.techCall_("load")},n.reset=function(){var e=this,t=this.options_.Promise||i.a.Promise;this.paused()||!t?this.doReset_():nr(this.play().then((function(){return e.doReset_()})))},n.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),on(this)&&this.trigger("playerreset")},n.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},n.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,n=e.remainingTimeDisplay;t&&t.updateContent(),n&&n.updateContent()},n.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},n.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},n.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},n.currentSource=function(){return this.cache_.source||{}},n.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},n.currentType=function(){return this.currentSource()&&this.currentSource().type||""},n.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},n.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t=void 0===t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},n.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},n.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},n.poster=function(e){if(void 0===e)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},n.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},n.controls=function(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},n.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},n.error=function(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&4===e.code){var t=function(){this.error(e)};return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",(function(){this.off(["click","touchstart"],t)}))}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new $n(e),this.addClass("vjs-error"),We.error("(CODE:"+this.error_.code+" "+$n.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},n.reportUserActivity=function(e){this.userActivity_=!0},n.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",(function(e){e.stopPropagation(),e.preventDefault()})),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},n.listenForUserActivity_=function(){var e,t,n,r=nn(this,this.reportUserActivity),i=function(t){r(),this.clearInterval(e)};this.on("mousedown",(function(){r(),this.clearInterval(e),e=this.setInterval(r,250)})),this.on("mousemove",(function(e){e.screenX===t&&e.screenY===n||(t=e.screenX,n=e.screenY,r())})),this.on("mouseup",i),this.on("mouseleave",i);var a,o=this.getChild("controlBar");!o||jn||Mn||(o.on("mouseenter",(function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0})),o.on("mouseleave",(function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout}))),this.on("keydown",r),this.on("keyup",r),this.setInterval((function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(a);var e=this.options_.inactivityTimeout;e<=0||(a=this.setTimeout((function(){this.userActivity_||this.userActive(!1)}),e))}}),250)},n.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},n.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},n.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},n.addTextTrack=function(e,t,n){if(this.tech_)return this.tech_.addTextTrack(e,t,n)},n.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},n.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)},n.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},n.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},n.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},n.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},n.languages=function(){return _n(t.prototype.options_.languages,this.languages_)},n.toJSON=function(){var e=_n(this.options_),t=e.tracks;e.tracks=[];for(var n=0;n<t.length;n++){var r=t[n];(r=_n(r)).player=void 0,e.tracks[n]=r}return e},n.createModal=function(e,t){var n=this;(t=t||{}).content=e||"";var r=new or(this,t);return this.addChild(r),r.on("dispose",(function(){n.removeChild(r)})),r.open(),r},n.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),n=0;n<Oa.length;n++){var r=Oa[n];if(t<=this.breakpoints_[r]){if(e===r)return;e&&this.removeClass(Da[e]),this.addClass(Da[r]),this.breakpoint_=r;break}}},n.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},n.breakpoints=function(e){return void 0===e||(this.breakpoint_="",this.breakpoints_=Qe({},Pa,e),this.updateCurrentBreakpoint_()),Qe(this.breakpoints_)},n.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?(this.responsive_=e,e?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},n.currentBreakpoint=function(){return this.breakpoint_},n.currentBreakpointClass=function(){return Da[this.breakpoint_]||""},n.loadMedia=function(e,t){var n=this;if(e&&"object"==typeof e){this.reset(),this.cache_.media=_n(e);var r=this.cache_.media,i=r.artwork,a=r.poster,o=r.src,s=r.textTracks;!i&&a&&(this.cache_.media.artwork=[{src:a,type:qr(a)}]),o&&this.src(o),a&&this.poster(a),Array.isArray(s)&&s.forEach((function(e){return n.addRemoteTextTrack(e,!1)})),this.ready(t)}},n.getMedia=function(){if(!this.cache_.media){var e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),(function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}}))};return e&&(t.poster=e,t.artwork=[{src:t.poster,type:qr(t.poster)}]),t}return _n(this.cache_.media)},t.getTagSettings=function(e){var t={sources:[],tracks:[]},n=pt(e),r=n["data-setup"];if(lt(e,"vjs-fill")&&(n.fill=!0),lt(e,"vjs-fluid")&&(n.fluid=!0),null!==r){var i=p()(r||"{}"),a=i[0],o=i[1];a&&We.error(a),Qe(n,o)}if(Qe(t,n),e.hasChildNodes())for(var s=e.childNodes,u=0,l=s.length;u<l;u++){var c=s[u],d=c.nodeName.toLowerCase();"source"===d?t.sources.push(pt(c)):"track"===d&&t.tracks.push(pt(c))}return t},n.flexNotSupported_=function(){var e=o.a.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},t}(bn);Lr.names.forEach((function(e){var t=Lr[e];La.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}})),La.prototype.crossorigin=La.prototype.crossOrigin,La.players={};var Na=i.a.navigator;La.prototype.options_={techOrder:Nr.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Na&&(Na.languages&&Na.languages[0]||Na.userLanguage||Na.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach((function(e){La.prototype[e]=function(){return this.techGet_(e)}})),Ra.forEach((function(e){La.prototype["handleTech"+yn(e)+"_"]=function(){return this.trigger(e)}})),bn.registerComponent("Player",La);var ka="plugin",Fa={},Ba=function(e){return Fa.hasOwnProperty(e)},Ua=function(e){return Ba(e)?Fa[e]:void 0},ja=function(e,t){e.activePlugins_=e.activePlugins_||{},e.activePlugins_[t]=!0},Ga=function(e,t,n){var r=(n?"before":"")+"pluginsetup";e.trigger(r,t),e.trigger(r+":"+t.name,t)},Ha=function(e,t){return t.prototype.name=e,function(){Ga(this,{name:e,plugin:t,instance:null},!0);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=T()(t,[this].concat(r));return this[e]=function(){return a},Ga(this,a.getEventHash()),a}},Va=function(){function e(t){if(this.constructor===e)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,pn(this),delete this.trigger,gn(this,this.constructor.defaultState),ja(t,this.name),this.dispose=nn(this,this.dispose),t.on("dispose",this.dispose)}var t=e.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},t.trigger=function(e,t){return void 0===t&&(t={}),Qt(this.eventBusEl_,e,this.getEventHash(t))},t.handleStateChanged=function(e){},t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t.activePlugins_[e]=!1,this.player=this.state=null,t[e]=Ha(e,Fa[e])},e.isBasic=function(t){var n="string"==typeof t?Ua(t):t;return"function"==typeof n&&!e.prototype.isPrototypeOf(n.prototype)},e.registerPlugin=function(t,n){if("string"!=typeof t)throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(Ba(t))We.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(La.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if("function"!=typeof n)throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof n+".");return Fa[t]=n,t!==ka&&(e.isBasic(n)?La.prototype[t]=function(e,t){var n=function(){Ga(this,{name:e,plugin:t,instance:null},!0);var n=t.apply(this,arguments);return ja(this,e),Ga(this,{name:e,plugin:t,instance:n}),n};return Object.keys(t).forEach((function(e){n[e]=t[e]})),n}(t,n):La.prototype[t]=Ha(t,n)),n},e.deregisterPlugin=function(e){if(e===ka)throw new Error("Cannot de-register base plugin.");Ba(e)&&(delete Fa[e],delete La.prototype[e])},e.getPlugins=function(e){var t;return void 0===e&&(e=Object.keys(Fa)),e.forEach((function(e){var n=Ua(e);n&&((t=t||{})[e]=n)})),t},e.getPluginVersion=function(e){var t=Ua(e);return t&&t.VERSION||""},e}();Va.getPlugin=Ua,Va.BASE_PLUGIN_NAME=ka,Va.registerPlugin(ka,Va),La.prototype.usingPlugin=function(e){return!!this.activePlugins_&&!0===this.activePlugins_[e]},La.prototype.hasPlugin=function(e){return!!Ba(e)};var za=function(e){return 0===e.indexOf("#")?e.slice(1):e};function Wa(e,t,n){var r=Wa.getPlayer(e);if(r)return t&&We.warn('Player "'+e+'" is already initialised. Options will not be applied.'),n&&r.ready(n),r;var i="string"==typeof e?It("#"+za(e)):e;if(!rt(i))throw new TypeError("The element or ID supplied is not valid. (videojs)");i.ownerDocument.defaultView&&i.ownerDocument.body.contains(i)||We.warn("The element supplied is not included in the DOM"),t=t||{},Wa.hooks("beforesetup").forEach((function(e){var n=e(i,_n(t));Ze(n)&&!Array.isArray(n)?t=_n(t,n):We.error("please return an object in beforesetup hooks")}));var a=bn.getComponent("Player");return r=new a(i,t,n),Wa.hooks("setup").forEach((function(e){return e(r)})),r}if(Wa.hooks_={},Wa.hooks=function(e,t){return Wa.hooks_[e]=Wa.hooks_[e]||[],t&&(Wa.hooks_[e]=Wa.hooks_[e].concat(t)),Wa.hooks_[e]},Wa.hook=function(e,t){Wa.hooks(e,t)},Wa.hookOnce=function(e,t){Wa.hooks(e,[].concat(t).map((function(t){return function n(){return Wa.removeHook(e,n),t.apply(void 0,arguments)}})))},Wa.removeHook=function(e,t){var n=Wa.hooks(e).indexOf(t);return!(n<=-1)&&(Wa.hooks_[e]=Wa.hooks_[e].slice(),Wa.hooks_[e].splice(n,1),!0)},!0!==i.a.VIDEOJS_NO_DYNAMIC_STYLE&&nt()){var qa=It(".vjs-styles-defaults");if(!qa){qa=Bt("vjs-styles-defaults");var Ya=It("head");Ya&&Ya.insertBefore(qa,Ya.firstChild),Ut(qa,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}Nt(1,Wa),Wa.VERSION=Ve,Wa.options=La.prototype.options_,Wa.getPlayers=function(){return La.players},Wa.getPlayer=function(e){var t,n=La.players;if("string"==typeof e){var r=za(e),i=n[r];if(i)return i;t=It("#"+r)}else t=e;if(rt(t)){var a=t,o=a.player,s=a.playerId;if(o||n[s])return o||n[s]}},Wa.getAllPlayers=function(){return Object.keys(La.players).map((function(e){return La.players[e]})).filter(Boolean)},Wa.players=La.players,Wa.getComponent=bn.getComponent,Wa.registerComponent=function(e,t){Nr.isTech(t)&&We.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),bn.registerComponent.call(bn,e,t)},Wa.getTech=Nr.getTech,Wa.registerTech=Nr.registerTech,Wa.use=function(e,t){kr[e]=kr[e]||[],kr[e].push(t)},Object.defineProperty(Wa,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(Wa.middleware,"TERMINATOR",{value:Br,writeable:!1,enumerable:!0}),Wa.browser=Hn,Wa.TOUCH_ENABLED=Fn,Wa.extend=function(e,t){void 0===t&&(t={});var n=function(){e.apply(this,arguments)},r={};for(var i in"object"==typeof t?(t.constructor!==Object.prototype.constructor&&(n=t.constructor),r=t):"function"==typeof t&&(n=t),w()(n,e),e&&(n.super_=e),r)r.hasOwnProperty(i)&&(n.prototype[i]=r[i]);return n},Wa.mergeOptions=_n,Wa.bind=nn,Wa.registerPlugin=Va.registerPlugin,Wa.deregisterPlugin=Va.deregisterPlugin,Wa.plugin=function(e,t){return We.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Va.registerPlugin(e,t)},Wa.getPlugins=Va.getPlugins,Wa.getPlugin=Va.getPlugin,Wa.getPluginVersion=Va.getPluginVersion,Wa.addLanguage=function(e,t){var n;return e=(""+e).toLowerCase(),Wa.options.languages=_n(Wa.options.languages,((n={})[e]=t,n)),Wa.options.languages[e]},Wa.log=We,Wa.createLogger=qe,Wa.createTimeRange=Wa.createTimeRanges=Wn,Wa.formatTime=ui,Wa.setFormatTime=function(e){si=e},Wa.resetFormatTime=function(){si=oi},Wa.parseUrl=Er,Wa.isCrossOrigin=wr,Wa.EventTarget=an,Wa.on=Kt,Wa.one=Zt,Wa.off=Xt,Wa.trigger=Qt,Wa.xhr=y.a,Wa.TextTrack=Cr,Wa.AudioTrack=Rr,Wa.VideoTrack=Ir,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach((function(e){Wa[e]=function(){return We.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),Dt[e].apply(null,arguments)}})),Wa.computedStyle=$e,Wa.dom=Dt,Wa.url=Ar,Wa.defineLazyProperty=Ma;var Ka=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=x.a.buildAbsoluteURL(i.a.location.href,e)),x.a.buildAbsoluteURL(e,t))},Xa=function(e,t,n){return e&&n.responseURL&&t!==n.responseURL?n.responseURL:t},Qa=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Za=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ja=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},$a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},eo=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},to=Wa.mergeOptions,no=Wa.EventTarget,ro=Wa.log,io=function(e,t){["AUDIO","SUBTITLES"].forEach((function(n){for(var r in e.mediaGroups[n])for(var i in e.mediaGroups[n][r]){var a=e.mediaGroups[n][r][i];t(a,n,r,i)}}))},ao=function(e,t){var n=to(e,{}),r=n.playlists[t.id];if(!r)return null;if(r.segments&&t.segments&&r.segments.length===t.segments.length&&r.endList===t.endList&&r.mediaSequence===t.mediaSequence)return null;var i=to(r,t);r.segments&&(i.segments=function(e,t,n){var r=t.slice();n=n||0;for(var i=Math.min(e.length,t.length+n),a=n;a<i;a++)r[a-n]=to(e[a],r[a-n]);return r}(r.segments,t.segments,t.mediaSequence-r.mediaSequence)),i.segments.forEach((function(e){!function(e,t){e.resolvedUri||(e.resolvedUri=Ka(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=Ka(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=Ka(t,e.map.uri))}(e,i.resolvedUri)}));for(var a=0;a<n.playlists.length;a++)n.playlists[a].id===t.id&&(n.playlists[a]=i);return n.playlists[t.id]=i,n.playlists[t.uri]=i,n},oo=function(e,t){return e+"-"+t},so=function(e){for(var t=e.playlists.length;t--;){var n=e.playlists[t];n.resolvedUri=Ka(e.uri,n.uri),n.id=oo(t,n.uri),e.playlists[n.id]=n,e.playlists[n.uri]=n,n.attributes||(n.attributes={},ro.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}},uo=function(e){io(e,(function(t){t.uri&&(t.resolvedUri=Ka(e.uri,t.uri))}))},lo=function(e,t){var n=e.segments[e.segments.length-1];return t&&n&&n.duration?1e3*n.duration:500*(e.targetDuration||10)},co=function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Qa(this,t);var i=$a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),a=r.withCredentials,o=void 0!==a&&a,s=r.handleManifestRedirects,u=void 0!==s&&s;i.srcUrl=e,i.hls_=n,i.withCredentials=o,i.handleManifestRedirects=u;var l=n.options_;if(i.customTagParsers=l&&l.customTagParsers||[],i.customTagMappers=l&&l.customTagMappers||[],!i.srcUrl)throw new Error("A non-empty playlist URL is required");return i.state="HAVE_NOTHING",i.on("mediaupdatetimeout",(function(){"HAVE_METADATA"===i.state&&(i.state="HAVE_CURRENT_METADATA",i.request=i.hls_.xhr({uri:Ka(i.master.uri,i.media().uri),withCredentials:i.withCredentials},(function(e,t){if(i.request)return e?i.playlistRequestError(i.request,i.media(),"HAVE_METADATA"):void i.haveMetadata(i.request,i.media().uri,i.media().id)})))})),i}return Ja(t,e),Za(t,[{key:"playlistRequestError",value:function(e,t,n){var r=t.uri,i=t.id;this.request=null,n&&(this.state=n),this.error={playlist:this.master.playlists[i],status:e.status,message:"HLS playlist request error at URL: "+r+".",responseText:e.responseText,code:e.status>=500?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(e,t,n){var r=this;this.request=null,this.state="HAVE_METADATA";var a=new L;this.customTagParsers.forEach((function(e){return a.addParser(e)})),this.customTagMappers.forEach((function(e){return a.addTagMapper(e)})),a.push(e.responseText),a.end(),a.manifest.uri=t,a.manifest.id=n,a.manifest.attributes=a.manifest.attributes||{};var o=ao(this.master,a.manifest);this.targetDuration=a.manifest.targetDuration,o?(this.master=o,this.media_=this.master.playlists[n]):this.trigger("playlistunchanged"),this.media().endList||(i.a.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=i.a.setTimeout((function(){r.trigger("mediaupdatetimeout")}),lo(this.media(),!!o))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.trigger("dispose"),this.stopRequest(),i.a.clearTimeout(this.mediaUpdateTimeout),i.a.clearTimeout(this.finalRenditionTimeout),this.off()}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"media",value:function(e,t){var n=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof e){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}if(i.a.clearTimeout(this.finalRenditionTimeout),t){var r=e.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=i.a.setTimeout(this.media.bind(this,e,!1),r)}else{var a=this.state,o=!this.media_||e.id!==this.media_.id;if(this.master.playlists[e.id].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,void(o&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(o){if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials},(function(t,r){if(n.request){if(e.resolvedUri=Xa(n.handleManifestRedirects,e.resolvedUri,r),t)return n.playlistRequestError(n.request,e,a);n.haveMetadata(r,e.uri,e.id),"HAVE_MASTER"===a?n.trigger("loadedmetadata"):n.trigger("mediachange")}}))}}}},{key:"pause",value:function(){this.stopRequest(),i.a.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function(e){var t=this;i.a.clearTimeout(this.mediaUpdateTimeout);var n=this.media();if(e){var r=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=i.a.setTimeout((function(){return t.load()}),r)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"start",value:function(){var e=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"HLS playlist request error at URL: "+e.srcUrl+".",responseText:n.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");var r=new L;if(e.customTagParsers.forEach((function(e){return r.addParser(e)})),e.customTagMappers.forEach((function(e){return r.addTagMapper(e)})),r.push(n.responseText),r.end(),e.state="HAVE_MASTER",e.srcUrl=Xa(e.handleManifestRedirects,e.srcUrl,n),r.manifest.uri=e.srcUrl,r.manifest.playlists)return e.master=r.manifest,so(e.master),uo(e.master),e.trigger("loadedplaylist"),void(e.request||e.media(r.manifest.playlists[0]));var a=oo(0,e.srcUrl);return e.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:i.a.location.href,playlists:[{uri:e.srcUrl,id:a,resolvedUri:e.srcUrl,attributes:{}}]},e.master.playlists[a]=e.master.playlists[0],e.master.playlists[e.srcUrl]=e.master.playlists[0],e.haveMetadata(n,e.srcUrl,a),e.trigger("loadedmetadata")}}))}}]),t}(no),ho=Wa.createTimeRange,fo=function(e,t,n){var r,i;return void 0===t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence?0:(r=function(e,t){var n=0,r=t-e.mediaSequence,i=e.segments[r];if(i){if(void 0!==i.start)return{result:i.start,precise:!0};if(void 0!==i.end)return{result:i.end-i.duration,precise:!0}}for(;r--;){if(void 0!==(i=e.segments[r]).end)return{result:n+i.end,precise:!0};if(n+=i.duration,void 0!==i.start)return{result:n+i.start,precise:!0}}return{result:n,precise:!1}}(e,t)).precise?r.result:(i=function(e,t){for(var n=0,r=void 0,i=t-e.mediaSequence;i<e.segments.length;i++){if(void 0!==(r=e.segments[i]).start)return{result:r.start-n,precise:!0};if(n+=r.duration,void 0!==r.end)return{result:r.end-n,precise:!0}}return{result:-1,precise:!1}}(e,t)).precise?i.result:r.result+n},po=function(e,t,n){if(!e)return 0;if("number"!=typeof n&&(n=0),void 0===t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return i.a.Infinity}return fo(e,t,n)},mo=function(e,t,n){var r=0;if(t>n){var i=[n,t];t=i[0],n=i[1]}if(t<0){for(var a=t;a<Math.min(0,n);a++)r+=e.targetDuration;t=0}for(var o=t;o<n;o++)r+=e.segments[o].duration;return r},go=function(e,t){if(!e.segments.length)return 0;var n=e.segments.length,r=e.segments[n-1].duration||e.targetDuration,i="number"==typeof t?t:r+2*e.targetDuration;if(0===i)return n;for(var a=0;n--&&!((a+=e.segments[n].duration)>=i););return Math.max(0,n)},vo=function(e,t,n,r){if(!e||!e.segments)return null;if(e.endList)return po(e);if(null===t)return null;t=t||0;var i=n?go(e,r):e.segments.length;return fo(e,e.mediaSequence+i,t)},yo=function(e){return e-Math.floor(e)==0},_o=function(e,t){if(yo(t))return t+.1*e;for(var n=t.toString().split(".")[1].length,r=1;r<=n;r++){var i=Math.pow(10,r),a=t*i;if(yo(a)||r===n)return(a+e)/i}},bo=_o.bind(null,1),Eo=_o.bind(null,-1),To=function(e){return e.excludeUntil&&e.excludeUntil>Date.now()},So=function(e){return e.excludeUntil&&e.excludeUntil===1/0},wo=function(e){var t=To(e);return!e.disabled&&!t},Ao=function(e,t){return t.attributes&&t.attributes[e]},xo=function(e,t){if(1===e.playlists.length)return!0;var n=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter((function(e){return!!wo(e)&&(e.attributes.BANDWIDTH||0)<n})).length},Mo={duration:po,seekable:function(e,t,n){var r=t||0,i=vo(e,t,!0,n);return null===i?ho():ho(r,i)},safeLiveIndex:go,getMediaInfoForTime:function(e,t,n,r){var i=void 0,a=void 0,o=e.segments.length,s=t-r;if(s<0){if(n>0)for(i=n-1;i>=0;i--)if(a=e.segments[i],(s+=Eo(a.duration))>0)return{mediaIndex:i,startTime:r-mo(e,n,i)};return{mediaIndex:0,startTime:t}}if(n<0){for(i=n;i<0;i++)if((s-=e.targetDuration)<0)return{mediaIndex:0,startTime:t};n=0}for(i=n;i<o;i++)if(a=e.segments[i],(s-=bo(a.duration))<0)return{mediaIndex:i,startTime:r+mo(e,n,i)};return{mediaIndex:o-1,startTime:t}},isEnabled:wo,isDisabled:function(e){return e.disabled},isBlacklisted:To,isIncompatible:So,playlistEnd:vo,isAes:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},isFmp4:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].map)return!0;return!1},hasAttribute:Ao,estimateSegmentRequestTime:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!Ao("BANDWIDTH",n))return NaN;var i=e*n.attributes.BANDWIDTH;return(i-8*r)/t},isLowestEnabledRendition:xo},Co=Wa.xhr,Ro=Wa.mergeOptions,Io=function(){return function e(t,n){t=Ro({timeout:45e3},t);var r=e.beforeRequest||Wa.Hls.xhr.beforeRequest;if(r&&"function"==typeof r){var i=r(t);i&&(t=i)}var a=Co(t,(function(e,t){var r=a.response;!e&&r&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=r.byteLength||r.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),t.headers&&(a.responseHeaders=t.headers),e&&"ETIMEDOUT"===e.code&&(a.timedout=!0),e||a.aborted||200===t.statusCode||206===t.statusCode||0===t.statusCode||(e=new Error("XHR Failed with a response of: "+(a&&(r||a.responseText)))),n(e,a)})),o=a.abort;return a.abort=function(){return a.aborted=!0,o.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a}},Oo=function(e){var t,n,r={};return e.byterange&&(r.Range=(t=e.byterange,n=t.offset+t.length-1,"bytes="+t.offset+"-"+n)),r},Do=function(e,t){return e.start(t)+"-"+e.end(t)},Po=function(e,t){var n=e.toString(16);return"00".substring(0,2-n.length)+n+(t%2?" ":"")},Lo=function(e){return e>=32&&e<126?String.fromCharCode(e):"."},No=function(e){var t={};return Object.keys(e).forEach((function(n){var r=e[n];ArrayBuffer.isView(r)?t[n]={bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:t[n]=r})),t},ko=function(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")},Fo=function(e){return e.resolvedUri},Bo=function(e){for(var t=Array.prototype.slice.call(e),n=16,r="",i=0;i<t.length/n;i++)r+=t.slice(i*n,i*n+n).map(Po).join("")+" "+t.slice(i*n,i*n+n).map(Lo).join("")+"\n";return r},Uo=Object.freeze({createTransferableMessage:No,initSegmentId:ko,segmentKeyId:Fo,hexDump:Bo,tagDump:function(e){var t=e.bytes;return Bo(t)},textRanges:function(e){var t="",n=void 0;for(n=0;n<e.length;n++)t+=Do(e,n)+" ";return t}}),jo=function(e){var t=e.playlist,n=e.time,r=void 0===n?void 0:n,i=e.callback;if(!i)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===r)return i({message:"getProgramTime: playlist and time must be provided"});var a=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;for(var n=0,r=void 0,i=0;i<t.segments.length&&!(e<=(n=(r=t.segments[i]).videoTimingInfo?r.videoTimingInfo.transmuxedPresentationEnd:n+r.duration));i++);var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(e>n){if(e>n+.25*a.duration)return null;r=a}return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:n-r.duration,type:r.videoTimingInfo?"accurate":"estimate"}}(r,t);if(!a)return i({message:"valid programTime was not found"});if("estimate"===a.type)return i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var o={mediaSeconds:r},s=function(e,t){if(!t.dateTimeObject)return null;var n=t.videoTimingInfo.transmuxerPrependedSeconds,r=e-(t.videoTimingInfo.transmuxedPresentationStart+n);return new Date(t.dateTimeObject.getTime()+1e3*r)}(r,a.segment);return s&&(o.programDateTime=s.toISOString()),i(null,o)},Go=function e(t){var n=t.programTime,r=t.playlist,i=t.retryCount,a=void 0===i?2:i,o=t.seekTo,s=t.pauseAfterSeek,u=void 0===s||s,l=t.tech,c=t.callback;if(!c)throw new Error("seekToProgramTime: callback must be provided");if(void 0===n||!r||!o)return c({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!r.endList&&!l.hasStarted_)return c({message:"player must be playing a live stream to start buffering"});if(!function(e){if(!e.segments||0===e.segments.length)return!1;for(var t=0;t<e.segments.length;t++)if(!e.segments[t].dateTimeObject)return!1;return!0}(r))return c({message:"programDateTime tags must be provided in the manifest "+r.resolvedUri});var d=function(e,t){var n=void 0;try{n=new Date(e)}catch(e){return null}if(!t||!t.segments||0===t.segments.length)return null;var r=t.segments[0];if(n<r.dateTimeObject)return null;for(var i=0;i<t.segments.length-1&&(r=t.segments[i],!(n<t.segments[i+1].dateTimeObject));i++);var a,o=t.segments[t.segments.length-1],s=o.dateTimeObject,u=o.videoTimingInfo?(a=o.videoTimingInfo).transmuxedPresentationEnd-a.transmuxedPresentationStart-a.transmuxerPrependedSeconds:o.duration+.25*o.duration;return n>new Date(s.getTime()+1e3*u)?null:(n>s&&(r=o),{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:Mo.duration(t,t.mediaSequence+t.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"})}(n,r);if(!d)return c({message:n+" was not found in the stream"});var h=d.segment,f=function(e,t){var n=void 0,r=void 0;try{n=new Date(e),r=new Date(t)}catch(e){}var i=n.getTime();return(r.getTime()-i)/1e3}(h.dateTimeObject,n);if("estimate"===d.type)return 0===a?c({message:n+" is not buffered yet. Try again"}):(o(d.estimatedStart+f),void l.one("seeked",(function(){e({programTime:n,playlist:r,retryCount:a-1,seekTo:o,pauseAfterSeek:u,tech:l,callback:c})})));var p=h.start+f;l.one("seeked",(function(){return c(null,l.currentTime())})),u&&l.pause(),o(p)},Ho=1/30,Vo=.1,zo=function(e,t){var n=[],r=void 0;if(e&&e.length)for(r=0;r<e.length;r++)t(e.start(r),e.end(r))&&n.push([e.start(r),e.end(r)]);return Wa.createTimeRanges(n)},Wo=function(e,t){return zo(e,(function(e,n){return e-Vo<=t&&n+Vo>=t}))},qo=function(e,t){return zo(e,(function(e){return e-Ho>=t}))},Yo=function(e){var t=[];if(!e||!e.length)return"";for(var n=0;n<e.length;n++)t.push(e.start(n)+" => "+e.end(n));return t.join(", ")},Ko=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t},Xo=function(e,t,n){var r=void 0,i=void 0;if(n&&n.cues)for(r=n.cues.length;r--;)(i=n.cues[r]).startTime<=t&&i.endTime>=e&&n.removeCue(i)},Qo=function(e){return isNaN(e)||Math.abs(e)===1/0?Number.MAX_VALUE:e},Zo=function(e,t,n){var r=i.a.WebKitDataCue||i.a.VTTCue;if(t&&t.forEach((function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new r(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))}),e),n){var a=Qo(e.mediaSource_.duration);if(n.forEach((function(e){var t=e.cueTime+this.timestampOffset;!("number"!=typeof t||i.a.isNaN(t)||t<0)&&t<1/0&&e.frames.forEach((function(e){var n=new r(t,t,e.value||e.url||e.data||"");n.frame=e,n.value=e,function(e){Object.defineProperties(e.frame,{id:{get:function(){return Wa.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return Wa.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return Wa.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})}(n),this.metadataTrack_.addCue(n)}),this)}),e),e.metadataTrack_&&e.metadataTrack_.cues&&e.metadataTrack_.cues.length){for(var o=e.metadataTrack_.cues,s=[],u=0;u<o.length;u++)o[u]&&s.push(o[u]);var l=s.reduce((function(e,t){var n=e[t.startTime]||[];return n.push(t),e[t.startTime]=n,e}),{}),c=Object.keys(l).sort((function(e,t){return Number(e)-Number(t)}));c.forEach((function(e,t){var n=l[e],r=Number(c[t+1])||a;n.forEach((function(e){e.endTime=r}))}))}}},Jo="undefined"!=typeof window?window:{},$o="undefined"==typeof Symbol?"__target":Symbol(),es=Jo.BlobBuilder||Jo.WebKitBlobBuilder||Jo.MozBlobBuilder||Jo.MSBlobBuilder,ts=Jo.URL||Jo.webkitURL||ts&&ts.msURL,ns=Jo.Worker;function rs(e,t){return function(n){var r=this;if(!t)return new ns(e);if(ns&&!n){var i=ss(t.toString().replace(/^function.+?{/,"").slice(0,-1));return this[$o]=new ns(i),function(e,t){if(!e||!t)return;var n=e.terminate;e.objURL=t,e.terminate=function(){e.objURL&&ts.revokeObjectURL(e.objURL),n.call(e)}}(this[$o],i),this[$o]}var a={postMessage:function(e){r.onmessage&&setTimeout((function(){r.onmessage({data:e,target:a})}))}};t.call(a),this.postMessage=function(e){setTimeout((function(){a.onmessage({data:e,target:r})}))},this.isThisThread=!0}}if(ns){var is,as=ss("self.onmessage = function () {}"),os=new Uint8Array(1);try{(is=new ns(as)).postMessage(os,[os.buffer])}catch(e){ns=null}finally{ts.revokeObjectURL(as),is&&is.terminate()}}function ss(e){try{return ts.createObjectURL(new Blob([e],{type:"application/javascript"}))}catch(n){var t=new es;return t.append(e),ts.createObjectURL(t.getBlob(type))}}var us=new rs("./transmuxer-worker.worker.js",(function(e,t){var n=this;!function(){var e=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var r;return!!e[t]&&(r=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(r,1),r>-1)},this.trigger=function(t){var n,r,i,a;if(n=e[t])if(2===arguments.length)for(i=n.length,r=0;r<i;++r)n[r].call(this,arguments[1]);else{for(a=[],r=arguments.length,r=1;r<arguments.length;++r)a.push(arguments[r]);for(i=n.length,r=0;r<i;++r)n[r].apply(this,a)}},this.dispose=function(){e={}}}};e.prototype.pipe=function(e){return this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),this.on("partialdone",(function(t){e.partialFlush(t)})),this.on("endedtimeline",(function(t){e.endTimeline(t)})),this.on("reset",(function(t){e.reset(t)})),e},e.prototype.push=function(e){this.trigger("data",e)},e.prototype.flush=function(e){this.trigger("done",e)},e.prototype.partialFlush=function(e){this.trigger("partialdone",e)},e.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},e.prototype.reset=function(e){this.trigger("reset",e)};var t,r,i,a,o,s,u,l,c,d,h,f,p,m,g,v,y,_,b,E,T,S,w,A,x,M,C,R,I,O,D,P,L,N,k,F,B,U,j,G,H=e,V=Math.pow(2,32)-1;!function(){var e;if(S={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in S)S.hasOwnProperty(e)&&(S[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);w=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),x=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),A=new Uint8Array([0,0,0,1]),M=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),C=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),R={video:M,audio:C},D=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),O=new Uint8Array([0,0,0,0,0,0,0,0]),P=new Uint8Array([0,0,0,0,0,0,0,0]),L=P,N=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),k=P,I=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),t=function(e){var t,n,r=[],i=0;for(t=1;t<arguments.length;t++)r.push(arguments[t]);for(t=r.length;t--;)i+=r[t].byteLength;for(n=new Uint8Array(i+8),new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,n.byteLength),n.set(e,4),t=0,i=8;t<r.length;t++)n.set(r[t],i),i+=r[t].byteLength;return n},r=function(){return t(S.dinf,t(S.dref,D))},i=function(e){return t(S.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},g=function(e){return t(S.hdlr,R[e])},m=function(e){var n=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(n[12]=e.samplerate>>>24&255,n[13]=e.samplerate>>>16&255,n[14]=e.samplerate>>>8&255,n[15]=255&e.samplerate),t(S.mdhd,n)},p=function(e){return t(S.mdia,m(e),g(e.type),s(e))},o=function(e){return t(S.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},s=function(e){return t(S.minf,"video"===e.type?t(S.vmhd,I):t(S.smhd,O),r(),y(e))},u=function(e,n){for(var r=[],i=n.length;i--;)r[i]=b(n[i]);return t.apply(null,[S.moof,o(e)].concat(r))},l=function(e){for(var n=e.length,r=[];n--;)r[n]=h(e[n]);return t.apply(null,[S.moov,d(4294967295)].concat(r).concat(c(e)))},c=function(e){for(var n=e.length,r=[];n--;)r[n]=E(e[n]);return t.apply(null,[S.mvex].concat(r))},d=function(e){var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t(S.mvhd,n)},v=function(e){var n,r,i=e.samples||[],a=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return t(S.sdtp,a)},y=function(e){return t(S.stbl,_(e),t(S.stts,k),t(S.stsc,L),t(S.stsz,N),t(S.stco,P))},_=function(e){return t(S.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?F(e):B(e))},F=function(e){var n,r,i=e.sps||[],a=e.pps||[],o=[],s=[];for(n=0;n<i.length;n++)o.push((65280&i[n].byteLength)>>>8),o.push(255&i[n].byteLength),o=o.concat(Array.prototype.slice.call(i[n]));for(n=0;n<a.length;n++)s.push((65280&a[n].byteLength)>>>8),s.push(255&a[n].byteLength),s=s.concat(Array.prototype.slice.call(a[n]));if(r=[S.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),t(S.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([i.length],o,[a.length],s))),t(S.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],e.sarRatio){var u=e.sarRatio[0],l=e.sarRatio[1];r.push(t(S.pasp,new Uint8Array([(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u,(4278190080&l)>>24,(16711680&l)>>16,(65280&l)>>8,255&l])))}return t.apply(null,r)},B=function(e){return t(S.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),i(e))},f=function(e){var n=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return t(S.tkhd,n)},b=function(e){var n,r,i,a,o,s;return n=t(S.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),o=Math.floor(e.baseMediaDecodeTime/(V+1)),s=Math.floor(e.baseMediaDecodeTime%(V+1)),r=t(S.tfdt,new Uint8Array([1,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),92,"audio"===e.type?(i=T(e,92),t(S.traf,n,r,i)):(a=v(e),i=T(e,a.length+92),t(S.traf,n,r,i,a))},h=function(e){return e.duration=e.duration||4294967295,t(S.trak,f(e),p(e))},E=function(e){var n=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(n[n.length-1]=0),t(S.trex,n)},G=function(e,t){var n=0,r=0,i=0,a=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(r=2),void 0!==e[0].flags&&(i=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,n|r|i|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},j=function(e,n){var r,i,a,o;for(n+=20+16*(i=e.samples||[]).length,r=G(i,n),o=0;o<i.length;o++)a=i[o],r=r.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size,a.flags.isLeading<<2|a.flags.dependsOn,a.flags.isDependedOn<<6|a.flags.hasRedundancy<<4|a.flags.paddingValue<<1|a.flags.isNonSyncSample,61440&a.flags.degradationPriority,15&a.flags.degradationPriority,(4278190080&a.compositionTimeOffset)>>>24,(16711680&a.compositionTimeOffset)>>>16,(65280&a.compositionTimeOffset)>>>8,255&a.compositionTimeOffset]);return t(S.trun,new Uint8Array(r))},U=function(e,n){var r,i,a,o;for(n+=20+8*(i=e.samples||[]).length,r=G(i,n),o=0;o<i.length;o++)a=i[o],r=r.concat([(4278190080&a.duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size]);return t(S.trun,new Uint8Array(r))},T=function(e,t){return"audio"===e.type?U(e,t):j(e,t)};a=function(){return t(S.ftyp,w,A,w,x)};var z,W,q,Y,K,X,Q,Z,J=function(e){return t(S.mdat,e)},$=u,ee=function(e){var t,n=a(),r=l(e);return(t=new Uint8Array(n.byteLength+r.byteLength)).set(n),t.set(r,n.byteLength),t},te=function(e,t){var n={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return n.dataOffset=t,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n},ne=function(e){var t,n,r=[],i=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,r.byteLength=0,t=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(n=e[t]).nalUnitType?(r.length&&(r.duration=n.dts-r.dts,i.byteLength+=r.byteLength,i.nalCount+=r.length,i.duration+=r.duration,i.push(r)),(r=[n]).byteLength=n.data.byteLength,r.pts=n.pts,r.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(r.keyFrame=!0),r.duration=n.dts-r.dts,r.byteLength+=n.data.byteLength,r.push(n));return i.length&&(!r.duration||r.duration<=0)&&(r.duration=i[i.length-1].duration),i.byteLength+=r.byteLength,i.nalCount+=r.length,i.duration+=r.duration,i.push(r),i},re=function(e){var t,n,r=[],i=[];for(r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,t=0;t<e.length;t++)(n=e[t]).keyFrame?(r.length&&(i.push(r),i.byteLength+=r.byteLength,i.nalCount+=r.nalCount,i.duration+=r.duration),(r=[n]).nalCount=n.length,r.byteLength=n.byteLength,r.pts=n.pts,r.dts=n.dts,r.duration=n.duration):(r.duration+=n.duration,r.nalCount+=n.length,r.byteLength+=n.byteLength,r.push(n));return i.length&&r.duration<=0&&(r.duration=i[i.length-1].duration),i.byteLength+=r.byteLength,i.nalCount+=r.nalCount,i.duration+=r.duration,i.push(r),i},ie=function(e){var t;return!e[0][0].keyFrame&&e.length>1&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},ae=function(e,t){var n,r,i,a,o,s=t||0,u=[];for(n=0;n<e.length;n++)for(a=e[n],r=0;r<a.length;r++)o=a[r],s+=(i=te(o,s)).size,u.push(i);return u},oe=function(e){var t,n,r,i,a,o,s=0,u=e.byteLength,l=e.nalCount,c=new Uint8Array(u+4*l),d=new DataView(c.buffer);for(t=0;t<e.length;t++)for(i=e[t],n=0;n<i.length;n++)for(a=i[n],r=0;r<a.length;r++)o=a[r],d.setUint32(s,o.data.byteLength),s+=4,c.set(o.data,s),s+=o.data.byteLength;return c},se=[33,16,5,32,164,27],ue=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],le=function(e){for(var t=[];e--;)t.push(0);return t},ce={96e3:[se,[227,64],le(154),[56]],88200:[se,[231],le(170),[56]],64e3:[se,[248,192],le(240),[56]],48e3:[se,[255,192],le(268),[55,148,128],le(54),[112]],44100:[se,[255,192],le(268),[55,163,128],le(84),[112]],32e3:[se,[255,192],le(268),[55,234],le(226),[112]],24e3:[se,[255,192],le(268),[55,255,128],le(268),[111,112],le(126),[224]],16e3:[se,[255,192],le(268),[55,255,128],le(268),[111,255],le(269),[223,108],le(195),[1,192]],12e3:[ue,le(268),[3,127,248],le(268),[6,255,240],le(268),[13,255,224],le(268),[27,253,128],le(259),[56]],11025:[ue,le(268),[3,127,248],le(268),[6,255,240],le(268),[13,255,224],le(268),[27,255,192],le(268),[55,175,128],le(108),[112]],8e3:[ue,le(268),[3,121,16],le(47),[7]]},de=(z=ce,Object.keys(z).reduce((function(e,t){return e[t]=new Uint8Array(z[t].reduce((function(e,t){return e.concat(t)}),[])),e}),{})),he=9e4;X=function(e,t){return W(K(e,t))},Q=function(e,t){return q(Y(e),t)},Z=function(e,t,n){return Y(n?e:e-t)};var fe=he,pe=(W=function(e){return e*he},q=function(e,t){return e*t},Y=function(e){return e/he},K=function(e,t){return e/t},X),me=Q,ge=Z,ve=function(e,t,n,r){var i,a,o,s,u,l=0,c=0,d=0;if(t.length&&(i=pe(e.baseMediaDecodeTime,e.samplerate),a=Math.ceil(fe/(e.samplerate/1024)),n&&r&&(l=i-Math.max(n,r),d=(c=Math.floor(l/a))*a),!(c<1||d>fe/2))){for((o=de[e.samplerate])||(o=t[0].data),s=0;s<c;s++)u=t[0],t.splice(0,0,{data:o,dts:u.dts-a,pts:u.pts-a});e.baseMediaDecodeTime-=Math.floor(me(d,e.samplerate))}},ye=function(e,t,n){return t.minSegmentDts>=n?e:(t.minSegmentDts=1/0,e.filter((function(e){return e.dts>=n&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)})))},_e=function(e){var t,n,r=[];for(t=0;t<e.length;t++)n=e[t],r.push({size:n.data.byteLength,duration:1024});return r},be=function(e){var t,n,r=0,i=new Uint8Array(function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].data.byteLength;return n}(e));for(t=0;t<e.length;t++)n=e[t],i.set(n.data,r),r+=n.data.byteLength;return i},Ee=fe,Te=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},Se=function(e,t){var n,r=e.minSegmentDts;return t||(r-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=r,n=Math.max(0,n),"audio"===e.type&&(n*=e.samplerate/Ee,n=Math.floor(n)),n},we=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},Ae=function(e){for(var t=0,n={payloadType:-1,payloadSize:0},r=0,i=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)r+=255,t++;for(r+=e[t++];255===e[t];)i+=255,t++;if(i+=e[t++],!n.payload&&4===r){n.payloadType=r,n.payloadSize=i,n.payload=e.subarray(t,t+i);break}t+=i,r=0,i=0}return n},xe=function(e){return 181!==e.payload[0]||49!=(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},Me=function(e,t){var n,r,i,a,o=[];if(!(64&t[0]))return o;for(r=31&t[0],n=0;n<r;n++)a={type:3&t[(i=3*n)+2],pts:e},4&t[i+2]&&(a.ccData=t[i+3]<<8|t[i+4],o.push(a));return o},Ce=4,Re=function e(){e.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Le(0,0),new Le(0,1),new Le(1,0),new Le(1,1)],this.reset(),this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))}),this)};(Re.prototype=new H).push=function(e){var t,n,r;if("sei_rbsp"===e.nalUnitType&&(t=Ae(e.escapedRBSP)).payloadType===Ce&&(n=xe(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));r=Me(e.pts,n),this.captionPackets_=this.captionPackets_.concat(r),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},Re.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return"flush"===e?t.flush():t.partialFlush()}),this)},Re.prototype.flushStream=function(e){this.captionPackets_.length?(this.captionPackets_.forEach((function(e,t){e.presortIndex=t})),this.captionPackets_.sort((function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts})),this.captionPackets_.forEach((function(e){e.type<2&&this.dispatchCea608Packet(e)}),this),this.captionPackets_.length=0,this.flushCCStreams(e)):this.flushCCStreams(e)},Re.prototype.flush=function(){return this.flushStream("flush")},Re.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Re.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(e){e.reset()}))},Re.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},Re.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},Re.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},Re.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var Ie={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Oe=function(e){return null===e?"":(e=Ie[e]||e,String.fromCharCode(e))},De=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Pe=function(){for(var e=[],t=15;t--;)e.push("");return e},Le=function e(t,n){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=n||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,r,i,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,i=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Pe();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Pe();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=Pe()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(r,i))a=Oe((r=(3&r)<<8)|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(r,i))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Oe((r=(3&r)<<8)|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(r,i))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&i)&&this.addFormatting(e.pts,["i"]),1==(1&i)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(r,i))this.column_+=3&i;else if(this.isPAC(r,i)){var o=De.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&i&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(i)&&14==(14&i)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(r)&&(0===i&&(i=null),a=Oe(r),a+=Oe(i),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Le.prototype=new H,Le.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}})).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Le.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Pe(),this.nonDisplayed_=Pe(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Le.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Le.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},Le.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},Le.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},Le.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},Le.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},Le.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},Le.prototype.isNormalChar=function(e){return e>=32&&e<=127},Le.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=Pe(),this.displayed_=Pe()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Le.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,n)},Le.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[],this[this.mode_](e,t)}},Le.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},Le.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},Le.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Le.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n};var Ne={CaptionStream:Re,Cea608Stream:Le},ke={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Fe="shared",Be=function(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e},Ue=function e(t){var n,r;e.prototype.init.call(this),this.type_=t||Fe,this.push=function(e){this.type_!==Fe&&e.type!==this.type_||(void 0===r&&(r=e.dts),e.dts=Be(e.dts,r),e.pts=Be(e.pts,r),n=e.dts,this.trigger("data",e))},this.flush=function(){r=n,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){r=void 0,n=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Ue.prototype=new H;var je,Ge=Ue,He=function(e,t,n){var r,i="";for(r=t;r<n;r++)i+="%"+("00"+e[r].toString(16)).slice(-2);return i},Ve=function(e,t,n){return decodeURIComponent(He(e,t,n))},ze=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]},We={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Ve(e.data,1,t),e.value=Ve(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Ve(e.data,1,t),e.url=Ve(e.data,t+1,e.data.length);break}},PRIV:function(e){var t,n;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=(n=e.data,unescape(He(n,0,t)));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(je=function(e){var t,n={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},r=0,i=[],a=0;if(je.prototype.init.call(this),this.dispatchType=ke.METADATA_STREAM_TYPE.toString(16),n.descriptor)for(t=0;t<n.descriptor.length;t++)this.dispatchType+=("00"+n.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,o,s,u,l;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,i.length=0),0===i.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))n.debug&&console.log("Skipping unrecognized metadata packet");else if(i.push(e),a+=e.data.byteLength,1===i.length&&(r=ze(e.data.subarray(6,10)),r+=10),!(a<r)){for(t={data:new Uint8Array(r),frames:[],pts:i[0].pts,dts:i[0].dts},l=0;l<r;)t.data.set(i[0].data.subarray(0,r-l),l),l+=i[0].data.byteLength,a-=i[0].data.byteLength,i.shift();o=10,64&t.data[5]&&(o+=4,o+=ze(t.data.subarray(10,14)),r-=ze(t.data.subarray(16,20)));do{if((s=ze(t.data.subarray(o+4,o+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((u={id:String.fromCharCode(t.data[o],t.data[o+1],t.data[o+2],t.data[o+3]),data:t.data.subarray(o+10,o+s+10)}).key=u.id,We[u.id]&&(We[u.id](u),"com.apple.streaming.transportStreamTimestamp"===u.owner)){var c=u.data,d=(1&c[3])<<30|c[4]<<22|c[5]<<14|c[6]<<6|c[7]>>>2;d*=4,d+=3&c[7],u.timeStamp=d,void 0===t.pts&&void 0===t.dts&&(t.pts=u.timeStamp,t.dts=u.timeStamp),this.trigger("timestamp",u)}t.frames.push(u),o+=10,o+=s}while(o<r);this.trigger("data",t)}}}).prototype=new H;var qe,Ye,Ke,Xe=je,Qe=Ge,Ze=188;(qe=function(){var e=new Uint8Array(Ze),t=0;qe.prototype.init.call(this),this.push=function(n){var r,i=0,a=Ze;for(t?((r=new Uint8Array(n.byteLength+t)).set(e.subarray(0,t)),r.set(n,t),t=0):r=n;a<r.byteLength;)71!==r[i]||71!==r[a]?(i++,a++):(this.trigger("data",r.subarray(i,a)),i+=Ze,a+=Ze);i<r.byteLength&&(e.set(r.subarray(i),0),t=r.byteLength-i)},this.flush=function(){t===Ze&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){t=0,this.trigger("reset")}}).prototype=new H,(Ye=function(){var e,t,n,r;Ye.prototype.init.call(this),r=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,r){var i=0;r.payloadUnitStartIndicator&&(i+=e[i]+1),"pat"===r.type?t(e.subarray(i),r):n(e.subarray(i),r)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],r.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=r.pmtPid},n=function(e,t){var n,i;if(1&e[5]){for(r.programMapTable={video:null,audio:null,"timed-metadata":{}},n=3+((15&e[1])<<8|e[2])-4,i=12+((15&e[10])<<8|e[11]);i<n;){var a=e[i],o=(31&e[i+1])<<8|e[i+2];a===ke.H264_STREAM_TYPE&&null===r.programMapTable.video?r.programMapTable.video=o:a===ke.ADTS_STREAM_TYPE&&null===r.programMapTable.audio?r.programMapTable.audio=o:a===ke.METADATA_STREAM_TYPE&&(r.programMapTable["timed-metadata"][o]=a),i+=5+((15&e[i+3])<<8|e[i+4])}t.programMapTable=r.programMapTable}},this.push=function(t){var n={},r=4;if(n.payloadUnitStartIndicator=!!(64&t[1]),n.pid=31&t[1],n.pid<<=8,n.pid|=t[2],(48&t[3])>>>4>1&&(r+=t[r]+1),0===n.pid)n.type="pat",e(t.subarray(r),n),this.trigger("data",n);else if(n.pid===this.pmtPid)for(n.type="pmt",e(t.subarray(r),n),this.trigger("data",n);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,r,n]):this.processPes_(t,r,n)},this.processPes_=function(e,t,n){n.pid===this.programMapTable.video?n.streamType=ke.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=ke.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(t),this.trigger("data",n)}}).prototype=new H,Ye.STREAM_TYPES={h264:27,adts:15},(Ke=function(){var e,t=this,n={data:[],size:0},r={data:[],size:0},i={data:[],size:0},a=function(e,n,r){var i,a,o=new Uint8Array(e.size),s={type:n},u=0,l=0;if(e.data.length&&!(e.size<9)){for(s.trackId=e.data[0].pid,u=0;u<e.data.length;u++)a=e.data[u],o.set(a.data,l),l+=a.data.byteLength;var c,d,h;c=o,(d=s).packetLength=6+(c[4]<<8|c[5]),d.dataAlignmentIndicator=0!=(4&c[6]),192&(h=c[7])&&(d.pts=(14&c[9])<<27|(255&c[10])<<20|(254&c[11])<<12|(255&c[12])<<5|(254&c[13])>>>3,d.pts*=4,d.pts+=(6&c[13])>>>1,d.dts=d.pts,64&h&&(d.dts=(14&c[14])<<27|(255&c[15])<<20|(254&c[16])<<12|(255&c[17])<<5|(254&c[18])>>>3,d.dts*=4,d.dts+=(6&c[18])>>>1)),d.data=c.subarray(9+c[8]),i="video"===n||s.packetLength<=e.size,(r||i)&&(e.size=0,e.data.length=0),i&&t.trigger("data",s)}};Ke.prototype.init.call(this),this.push=function(o){({pat:function(){},pes:function(){var e,t;switch(o.streamType){case ke.H264_STREAM_TYPE:case ke.H264_STREAM_TYPE:e=n,t="video";break;case ke.ADTS_STREAM_TYPE:e=r,t="audio";break;case ke.METADATA_STREAM_TYPE:e=i,t="timed-metadata";break;default:return}o.payloadUnitStartIndicator&&a(e,t,!0),e.data.push(o),e.size+=o.data.byteLength},pmt:function(){var n={type:"metadata",tracks:[]};null!==(e=o.programMapTable).video&&n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.video,codec:"avc",type:"video"}),null!==e.audio&&n.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+e.audio,codec:"adts",type:"audio"}),t.trigger("data",n)}})[o.type]()},this.reset=function(){n.size=0,n.data.length=0,r.size=0,r.data.length=0,this.trigger("reset")},this.flushStreams_=function(){a(n,"video"),a(r,"audio"),a(i,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}}).prototype=new H;var Je={PAT_PID:0,MP2T_PACKET_LENGTH:Ze,TransportPacketStream:qe,TransportParseStream:Ye,ElementaryStream:Ke,TimestampRolloverStream:Qe,CaptionStream:Ne.CaptionStream,Cea608Stream:Ne.Cea608Stream,MetadataStream:Xe};for(var $e in ke)ke.hasOwnProperty($e)&&(Je[$e]=ke[$e]);var et,tt=Je,nt=fe,rt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(et=function(e){var t,n=0;et.prototype.init.call(this),this.push=function(r){var i,a,o,s,u,l,c=0;if(e||(n=0),"audio"===r.type)for(t?(s=t,(t=new Uint8Array(s.byteLength+r.data.byteLength)).set(s),t.set(r.data,s.byteLength)):t=r.data;c+5<t.length;)if(255===t[c]&&240==(246&t[c+1])){if(a=2*(1&~t[c+1]),i=(3&t[c+3])<<11|t[c+4]<<3|(224&t[c+5])>>5,l=(u=1024*(1+(3&t[c+6])))*nt/rt[(60&t[c+2])>>>2],o=c+i,t.byteLength<o)return;if(this.trigger("data",{pts:r.pts+n*l,dts:r.dts+n*l,sampleCount:u,audioobjecttype:1+(t[c+2]>>>6&3),channelcount:(1&t[c+2])<<2|(192&t[c+3])>>>6,samplerate:rt[(60&t[c+2])>>>2],samplingfrequencyindex:(60&t[c+2])>>>2,samplesize:16,data:t.subarray(c+7+a,o)}),n++,t.byteLength===o)return void(t=void 0);t=t.subarray(o)}else c++},this.flush=function(){n=0,this.trigger("done")},this.reset=function(){t=void 0,this.trigger("reset")},this.endTimeline=function(){t=void 0,this.trigger("endedtimeline")}}).prototype=new H;var it,at,ot,st=et,ut=function(e){var t=e.byteLength,n=0,r=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+r},this.loadWord=function(){var i=e.byteLength-t,a=new Uint8Array(4),o=Math.min(4,t);if(0===o)throw new Error("no bytes available");a.set(e.subarray(i,i+o)),n=new DataView(a.buffer).getUint32(0),r=8*o,t-=o},this.skipBits=function(e){var i;r>e?(n<<=e,r-=e):(e-=r,e-=8*(i=Math.floor(e/8)),t-=i,this.loadWord(),n<<=e,r-=e)},this.readBits=function(e){var i=Math.min(r,e),a=n>>>32-i;return(r-=i)>0?n<<=i:t>0&&this.loadWord(),(i=e-i)>0?a<<i|this.readBits(i):a},this.skipLeadingZeros=function(){var e;for(e=0;e<r;++e)if(0!=(n&2147483648>>>e))return n<<=e,r-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(at=function(){var e,t,n=0;at.prototype.init.call(this),this.push=function(r){var i;t?((i=new Uint8Array(t.byteLength+r.data.byteLength)).set(t),i.set(r.data,t.byteLength),t=i):t=r.data;for(var a=t.byteLength;n<a-3;n++)if(1===t[n+2]){e=n+5;break}for(;e<a;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}n+3!==e-2&&this.trigger("data",t.subarray(n+3,e-2));do{e++}while(1!==t[e]&&e<a);n=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(n+3,e-2)),n=e-2,e+=3;break;default:e+=3}t=t.subarray(n),e-=n,n=0},this.reset=function(){t=null,n=0,this.trigger("reset")},this.flush=function(){t&&t.byteLength>3&&this.trigger("data",t.subarray(n+3)),t=null,n=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new H,ot={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(it=function(){var e,t,n,r,i,a,o,s=new at;it.prototype.init.call(this),e=this,this.push=function(e){"video"===e.type&&(t=e.trackId,n=e.pts,r=e.dts,s.push(e))},s.on("data",(function(o){var s={trackId:t,pts:n,dts:r,data:o};switch(31&o[0]){case 5:s.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:s.nalUnitType="sei_rbsp",s.escapedRBSP=i(o.subarray(1));break;case 7:s.nalUnitType="seq_parameter_set_rbsp",s.escapedRBSP=i(o.subarray(1)),s.config=a(s.escapedRBSP);break;case 8:s.nalUnitType="pic_parameter_set_rbsp";break;case 9:s.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",s)})),s.on("done",(function(){e.trigger("done")})),s.on("partialdone",(function(){e.trigger("partialdone")})),s.on("reset",(function(){e.trigger("reset")})),s.on("endedtimeline",(function(){e.trigger("endedtimeline")})),this.flush=function(){s.flush()},this.partialFlush=function(){s.partialFlush()},this.reset=function(){s.reset()},this.endTimeline=function(){s.endTimeline()},o=function(e,t){var n,r=8,i=8;for(n=0;n<e;n++)0!==i&&(i=(r+t.readExpGolomb()+256)%256),r=0===i?r:i},i=function(e){for(var t,n,r=e.byteLength,i=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n},a=function(e){var t,n,r,i,a,s,u,l,c,d,h,f,p,m=0,g=0,v=0,y=0,_=1;if(n=(t=new ut(e)).readUnsignedByte(),i=t.readUnsignedByte(),r=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),ot[n]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(h=3!==a?8:12,p=0;p<h;p++)t.readBoolean()&&o(p<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(s=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===s)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),u=t.readUnsignedExpGolomb(),p=0;p<u;p++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),l=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),0===(d=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(m=t.readUnsignedExpGolomb(),g=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:f=[1,1];break;case 2:f=[12,11];break;case 3:f=[10,11];break;case 4:f=[16,11];break;case 5:f=[40,33];break;case 6:f=[24,11];break;case 7:f=[20,11];break;case 8:f=[32,11];break;case 9:f=[80,33];break;case 10:f=[18,11];break;case 11:f=[15,11];break;case 12:f=[64,33];break;case 13:f=[160,99];break;case 14:f=[4,3];break;case 15:f=[3,2];break;case 16:f=[2,1];break;case 255:f=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}f&&(_=f[0]/f[1])}return{profileIdc:n,levelIdc:r,profileCompatibility:i,width:Math.ceil((16*(l+1)-2*m-2*g)*_),height:(2-d)*(c+1)*16-2*v-2*y,sarRatio:f}}}).prototype=new H;var lt,ct={H264Stream:it,NalByteStream:at},dt=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},ht=function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?n+20:n+10},ft=function(e,t){var n=(224&e[t+5])>>5,r=e[t+4]<<3;return 6144&e[t+3]|r|n};(lt=function(){var e=new Uint8Array,t=0;lt.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(n){var r,i,a,o,s=0,u=0;for(e.length?(o=e.length,(e=new Uint8Array(n.byteLength+o)).set(e.subarray(0,o)),e.set(n,o)):e=n;e.length-u>=3;)if(e[u]!=="I".charCodeAt(0)||e[u+1]!=="D".charCodeAt(0)||e[u+2]!=="3".charCodeAt(0))if(255!=(255&e[u])||240!=(240&e[u+1]))u++;else{if(e.length-u<7)break;if(u+(s=ft(e,u))>e.length)break;a={type:"audio",data:e.subarray(u,u+s),pts:t,dts:t},this.trigger("data",a),u+=s}else{if(e.length-u<10)break;if(u+(s=ht(e,u))>e.length)break;i={type:"timed-metadata",data:e.subarray(u,u+s)},this.trigger("data",i),u+=s}r=e.length-u,e=r>0?e.subarray(u):new Uint8Array},this.reset=function(){e=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){e=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new H;var pt,mt,gt,vt,yt=lt,_t=ct.H264Stream,bt=dt,Et=fe,Tt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],St=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],wt=function(e,t){var n;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},At=function(e,t,n,r,i,a){return{start:{dts:e,pts:e+(n-t)},end:{dts:e+(r-t),pts:e+(i-n)},prependedContentDuration:a,baseMediaDecodeTime:e}};(mt=function(e,t){var n=[],r=0,i=0,a=0,o=1/0;t=t||{},mt.prototype.init.call(this),this.push=function(t){we(e,t),e&&Tt.forEach((function(n){e[n]=t[n]})),n.push(t)},this.setEarliestDts=function(t){i=t-e.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){o=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var s,u,l,c,d;0!==n.length?(s=ye(n,e,i),e.baseMediaDecodeTime=Se(e,t.keepOriginalTimestamps),ve(e,s,a,o),e.samples=_e(s),l=J(be(s)),n=[],u=$(r,[e]),c=new Uint8Array(u.byteLength+l.byteLength),r++,c.set(u),c.set(l,u.byteLength),Te(e),d=Math.ceil(1024*Et/e.samplerate),s.length&&this.trigger("timingInfo",{start:s[0].pts,end:s[0].pts+s.length*d}),this.trigger("data",{track:e,boxes:c}),this.trigger("done","AudioSegmentStream")):this.trigger("done","AudioSegmentStream")},this.reset=function(){Te(e),n=[],this.trigger("reset")}}).prototype=new H,(pt=function(e,t){var n,r,i=0,a=[],o=[];t=t||{},pt.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){we(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.config,e.sps=[t.data],St.forEach((function(t){e[t]=n[t]}),this)),"pic_parameter_set_rbsp"!==t.nalUnitType||r||(r=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var n,r,s,u,l,c,d,h,f=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(n=ne(a),(s=re(n))[0][0].keyFrame||((r=this.getGopForFusion_(a[0],e))?(f=r.duration,s.unshift(r),s.byteLength+=r.byteLength,s.nalCount+=r.nalCount,s.pts=r.pts,s.dts=r.dts,s.duration+=r.duration):s=ie(s)),o.length){var p;if(!(p=t.alignGopsAtEnd?this.alignGopsAtEnd_(s):this.alignGopsAtStart_(s)))return this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Te(e),s=p}we(e,s),e.samples=ae(s),l=J(oe(s)),e.baseMediaDecodeTime=Se(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",s.map((function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}}))),d=s[0],h=s[s.length-1],this.trigger("segmentTimingInfo",At(e.baseMediaDecodeTime,d.dts,d.pts,h.dts+h.duration,h.pts+h.duration,f)),this.trigger("timingInfo",{start:s[0].pts,end:s[s.length-1].pts+s[s.length-1].duration}),this.gopCache_.unshift({gop:s.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),u=$(i,[e]),c=new Uint8Array(u.byteLength+l.byteLength),i++,c.set(u),c.set(l,u.byteLength),this.trigger("data",{track:e,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),a=[],this.gopCache_.length=0,o.length=0,this.trigger("reset")},this.resetStream_=function(){Te(e),n=void 0,r=void 0},this.getGopForFusion_=function(t){var n,r,i,a,o,s=1/0;for(o=0;o<this.gopCache_.length;o++)i=(a=this.gopCache_[o]).gop,e.pps&&wt(e.pps[0],a.pps[0])&&e.sps&&wt(e.sps[0],a.sps[0])&&(i.dts<e.timelineStartInfo.dts||(n=t.dts-i.dts-i.duration)>=-1e4&&n<=45e3&&(!r||s>n)&&(r=a,s=n));return r?r.gop:null},this.alignGopsAtStart_=function(e){var t,n,r,i,a,s,u,l;for(a=e.byteLength,s=e.nalCount,u=e.duration,t=n=0;t<o.length&&n<e.length&&(r=o[t],i=e[n],r.pts!==i.pts);)i.pts>r.pts?t++:(n++,a-=i.byteLength,s-=i.nalCount,u-=i.duration);return 0===n?e:n===e.length?null:((l=e.slice(n)).byteLength=a,l.duration=u,l.nalCount=s,l.pts=l[0].pts,l.dts=l[0].dts,l)},this.alignGopsAtEnd_=function(e){var t,n,r,i,a,s,u;for(t=o.length-1,n=e.length-1,a=null,s=!1;t>=0&&n>=0;){if(r=o[t],i=e[n],r.pts===i.pts){s=!0;break}r.pts>i.pts?t--:(t===o.length-1&&(a=n),n--)}if(!s&&null===a)return null;if(0===(u=s?n:a))return e;var l=e.slice(u),c=l.reduce((function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e}),{byteLength:0,duration:0,nalCount:0});return l.byteLength=c.byteLength,l.duration=c.duration,l.nalCount=c.nalCount,l.pts=l[0].pts,l.dts=l[0].dts,l},this.alignGopsWith=function(e){o=e}}).prototype=new H,(vt=function(e,t){this.numberOfTracks=0,this.metadataStream=t,void 0!==(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,vt.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}}).prototype=new H,vt.prototype.flush=function(e){var t,n,r,i,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,St.forEach((function(e){o.info[e]=this.videoTrack[e]}),this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,Tt.forEach((function(e){o.info[e]=this.audioTrack[e]}),this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,r=ee(this.pendingTracks),o.initSegment=new Uint8Array(r.byteLength),o.initSegment.set(r),o.data=new Uint8Array(this.pendingBytes),i=0;i<this.pendingBoxes.length;i++)o.data.set(this.pendingBoxes[i],a),a+=this.pendingBoxes[i].byteLength;for(i=0;i<this.pendingCaptions.length;i++)(t=this.pendingCaptions[i]).startTime=ge(t.startPts,s,this.keepOriginalTimestamps),t.endTime=ge(t.endPts,s,this.keepOriginalTimestamps),o.captionStreams[t.stream]=!0,o.captions.push(t);for(i=0;i<this.pendingMetadata.length;i++)(n=this.pendingMetadata[i]).cueTime=ge(n.pts,s,this.keepOriginalTimestamps),o.metadata.push(n);for(o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),i=0;i<o.captions.length;i++)t=o.captions[i],this.trigger("caption",t);for(i=0;i<o.metadata.length;i++)n=o.metadata[i],this.trigger("id3Frame",n)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},vt.prototype.setRemux=function(e){this.remuxTracks=e},(gt=function(e){var t,n,r=this,i=!0;gt.prototype.init.call(this),e=e||{},this.baseMediaDecodeTime=e.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var i={};this.transmuxPipeline_=i,i.type="aac",i.metadataStream=new tt.MetadataStream,i.aacStream=new yt,i.audioTimestampRolloverStream=new tt.TimestampRolloverStream("audio"),i.timedMetadataTimestampRolloverStream=new tt.TimestampRolloverStream("timed-metadata"),i.adtsStream=new st,i.coalesceStream=new vt(e,i.metadataStream),i.headOfPipeline=i.aacStream,i.aacStream.pipe(i.audioTimestampRolloverStream).pipe(i.adtsStream),i.aacStream.pipe(i.timedMetadataTimestampRolloverStream).pipe(i.metadataStream).pipe(i.coalesceStream),i.metadataStream.on("timestamp",(function(e){i.aacStream.setTimestamp(e.timeStamp)})),i.aacStream.on("data",(function(a){"timed-metadata"!==a.type||i.audioSegmentStream||(n=n||{timelineStartInfo:{baseMediaDecodeTime:r.baseMediaDecodeTime},codec:"adts",type:"audio"},i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new mt(n,e),i.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream)),r.trigger("trackinfo",{hasAudio:!!n,hasVideo:!!t})})),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var i={};this.transmuxPipeline_=i,i.type="ts",i.metadataStream=new tt.MetadataStream,i.packetStream=new tt.TransportPacketStream,i.parseStream=new tt.TransportParseStream,i.elementaryStream=new tt.ElementaryStream,i.timestampRolloverStream=new tt.TimestampRolloverStream,i.adtsStream=new st,i.h264Stream=new _t,i.captionStream=new tt.CaptionStream,i.coalesceStream=new vt(e,i.metadataStream),i.headOfPipeline=i.packetStream,i.packetStream.pipe(i.parseStream).pipe(i.elementaryStream).pipe(i.timestampRolloverStream),i.timestampRolloverStream.pipe(i.h264Stream),i.timestampRolloverStream.pipe(i.adtsStream),i.timestampRolloverStream.pipe(i.metadataStream).pipe(i.coalesceStream),i.h264Stream.pipe(i.captionStream).pipe(i.coalesceStream),i.elementaryStream.on("data",(function(a){var o;if("metadata"===a.type){for(o=a.tracks.length;o--;)t||"video"!==a.tracks[o].type?n||"audio"!==a.tracks[o].type||((n=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime):(t=a.tracks[o]).timelineStartInfo.baseMediaDecodeTime=r.baseMediaDecodeTime;t&&!i.videoSegmentStream&&(i.coalesceStream.numberOfTracks++,i.videoSegmentStream=new pt(t,e),i.videoSegmentStream.on("timelineStartInfo",(function(e){n&&(n.timelineStartInfo=e,i.audioSegmentStream.setEarliestDts(e.dts))})),i.videoSegmentStream.on("processedGopsInfo",r.trigger.bind(r,"gopInfo")),i.videoSegmentStream.on("segmentTimingInfo",r.trigger.bind(r,"videoSegmentTimingInfo")),i.videoSegmentStream.on("baseMediaDecodeTime",(function(e){n&&i.audioSegmentStream.setVideoBaseMediaDecodeTime(e)})),i.videoSegmentStream.on("timingInfo",r.trigger.bind(r,"videoTimingInfo")),i.h264Stream.pipe(i.videoSegmentStream).pipe(i.coalesceStream)),n&&!i.audioSegmentStream&&(i.coalesceStream.numberOfTracks++,i.audioSegmentStream=new mt(n,e),i.audioSegmentStream.on("timingInfo",r.trigger.bind(r,"audioTimingInfo")),i.adtsStream.pipe(i.audioSegmentStream).pipe(i.coalesceStream)),r.trigger("trackinfo",{hasAudio:!!n,hasVideo:!!t})}})),i.coalesceStream.on("data",this.trigger.bind(this,"data")),i.coalesceStream.on("id3Frame",(function(e){e.dispatchType=i.metadataStream.dispatchType,r.trigger("id3Frame",e)})),i.coalesceStream.on("caption",this.trigger.bind(this,"caption")),i.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(r){var i=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=r),n&&(n.timelineStartInfo.dts=void 0,n.timelineStartInfo.pts=void 0,Te(n),e.keepOriginalTimestamps||(n.timelineStartInfo.baseMediaDecodeTime=r),i.audioTimestampRolloverStream&&i.audioTimestampRolloverStream.discontinuity()),t&&(i.videoSegmentStream&&(i.videoSegmentStream.gopCache_=[]),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,Te(t),i.captionStream.reset(),e.keepOriginalTimestamps||(t.timelineStartInfo.baseMediaDecodeTime=r)),i.timestampRolloverStream&&i.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){n&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(t){var n=this.transmuxPipeline_;e.remux=t,n&&n.coalesceStream&&n.coalesceStream.setRemux(t)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(i){var t=bt(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),i=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){i=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new H;var xt={Transmuxer:gt,VideoSegmentStream:pt,AudioSegmentStream:mt,AUDIO_PROPERTIES:Tt,VIDEO_PROPERTIES:St,generateVideoSegmentTimingInfo:At},Mt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ct=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=n||{},this.self=t,this.init()}return Mt(e,[{key:"init",value:function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new xt.Transmuxer(this.options),function(e,t){t.on("data",(function(t){var n=t.initSegment;t.initSegment={data:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength};var r=t.data;t.data=r.buffer,e.postMessage({action:"data",segment:t,byteOffset:r.byteOffset,byteLength:r.byteLength},[t.data])})),t.captionStream&&t.captionStream.on("data",(function(t){e.postMessage({action:"caption",data:t})})),t.on("done",(function(t){e.postMessage({action:"done"})})),t.on("gopInfo",(function(t){e.postMessage({action:"gopInfo",gopInfo:t})})),t.on("videoSegmentTimingInfo",(function(t){e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}))}(this.self,this.transmuxer)}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*t))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(e){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]),e}();new function(e){e.onmessage=function(t){"init"===t.data.action&&t.data.options?this.messageHandlers=new Ct(e,t.data.options):(this.messageHandlers||(this.messageHandlers=new Ct(e)),t.data&&t.data.action&&"init"!==t.data.action&&this.messageHandlers[t.data.action]&&this.messageHandlers[t.data.action](t.data))}}(n)}()})),ls={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},cs=function(e){return e.map((function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,(function(e,t,n){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(n).toString(16)).slice(-2)}))}))},ds=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={codecCount:0},n=void 0;return t.codecCount=e.split(",").length,t.codecCount=t.codecCount||2,(n=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(e))&&(t.videoCodec=n[2],t.videoObjectTypeIndicator=n[3]),t.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(e),t.audioProfile=t.audioProfile&&t.audioProfile[2],t},hs=function(e,t,n){return e+"/"+t+'; codecs="'+n.filter((function(e){return!!e})).join(", ")+'"'},fs=function(e,t){var n=function(e){return e.segments&&e.segments.length&&e.segments[0].map?"mp4":"mp2t"}(t),r=function(e){var t=e.attributes||{};return t.CODECS?ds(t.CODECS):ls}(t),i=t.attributes||{},a=!0,o=!1;if(!t)return[];if(e.mediaGroups.AUDIO&&i.AUDIO){var s=e.mediaGroups.AUDIO[i.AUDIO];if(s)for(var u in o=!0,a=!1,s)if(!s[u].uri&&!s[u].playlists){a=!0;break}}o&&!r.audioProfile&&(a||(r.audioProfile=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var n=e.mediaGroups.AUDIO[t];if(!n)return null;for(var r in n){var i=n[r];if(i.default&&i.playlists)return ds(i.playlists[0].attributes.CODECS).audioProfile}return null}(e,i.AUDIO)),r.audioProfile||(Wa.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),r.audioProfile=ls.audioProfile));var l={};r.videoCodec&&(l.video=""+r.videoCodec+r.videoObjectTypeIndicator),r.audioProfile&&(l.audio="mp4a.40."+r.audioProfile);var c=hs("audio",n,[l.audio]),d=hs("video",n,[l.video]),h=hs("video",n,[l.video,l.audio]);return o?!a&&l.video?[d,c]:a||l.video?[h,c]:[c,c]:l.video?[h]:[c]},ps=function(e){var t={type:"",parameters:{}},n=e.trim().split(";");return t.type=n.shift().trim(),n.forEach((function(e){var n=e.trim().split("=");if(n.length>1){var r=n[0].replace(/"/g,"").trim(),i=n[1].replace(/"/g,"").trim();t.parameters[r]=i}})),t},ms=function(e){return/mp4a\.\d+.\d+/i.test(e)},gs=function(e){return/avc1\.[\da-f]+/i.test(e)},vs=function(e,t,n){if(null==t||!e.length)return[];var r=Math.ceil(9e4*(t-n+3)),i=void 0;for(i=0;i<e.length&&!(e[i].pts>r);i++);return e.slice(i)},ys=9e4,_s=function(e){function t(e,n){Qa(this,t);var r=$a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,Wa.EventTarget));r.timestampOffset_=0,r.pendingBuffers_=[],r.bufferUpdating_=!1,r.mediaSource_=e,r.codecs_=n,r.audioCodec_=null,r.videoCodec_=null,r.audioDisabled_=!1,r.appendAudioInitSegment_=!0,r.gopBuffer_=[],r.timeMapping_=0,r.safeAppend_=Wa.browser.IE_VERSION>=11;var i={remux:!1,alignGopsAtEnd:r.safeAppend_};return r.codecs_.forEach((function(e){ms(e)?r.audioCodec_=e:gs(e)&&(r.videoCodec_=e)})),r.transmuxer_=new us,r.transmuxer_.postMessage({action:"init",options:i}),r.transmuxer_.onmessage=function(e){return"data"===e.data.action?r.data_(e):"done"===e.data.action?r.done_(e):"gopInfo"===e.data.action?r.appendGopInfo_(e):"videoSegmentTimingInfo"===e.data.action?r.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo):void 0},Object.defineProperty(r,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&e>=0&&(this.timestampOffset_=e,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e}))}}),Object.defineProperty(r,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=e),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=e)}}),Object.defineProperty(r,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(r,"buffered",{get:function(){return function(e,t,n){var r=null,i=null,a=0,o=[],s=[];if(!e&&!t)return Wa.createTimeRange();if(!e)return t.buffered;if(!t)return e.buffered;if(n)return e.buffered;if(0===e.buffered.length&&0===t.buffered.length)return Wa.createTimeRange();for(var u=e.buffered,l=t.buffered,c=u.length;c--;)o.push({time:u.start(c),type:"start"}),o.push({time:u.end(c),type:"end"});for(c=l.length;c--;)o.push({time:l.start(c),type:"start"}),o.push({time:l.end(c),type:"end"});for(o.sort((function(e,t){return e.time-t.time})),c=0;c<o.length;c++)"start"===o[c].type?2==++a&&(r=o[c].time):"end"===o[c].type&&1==--a&&(i=o[c].time),null!==r&&null!==i&&(s.push([r,i]),r=null,i=null);return Wa.createTimeRanges(s)}(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),r}return Ja(t,e),Za(t,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),function(e,t,n){var r=t.player_;if(n.captions&&n.captions.length)for(var i in e.inbandTextTracks_||(e.inbandTextTracks_={}),n.captionStreams)if(!e.inbandTextTracks_[i]){r.tech_.trigger({type:"usage",name:"hls-608"});var a=r.textTracks().getTrackById(i);e.inbandTextTracks_[i]=a||r.addRemoteTextTrack({kind:"captions",id:i,label:i},!1).track}n.metadata&&n.metadata.length&&!e.metadataTrack_&&(e.metadataTrack_=r.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=n.metadata.dispatchType)}(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(e){"closed"!==this.mediaSource_.readyState?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"videoSegmentTimingInfo_",value:function(e){var t={start:{decode:e.start.dts/ys,presentation:e.start.pts/ys},end:{decode:e.end.dts/ys,presentation:e.end.pts/ys},baseMediaDecodeTime:e.baseMediaDecodeTime/ys};e.prependedContentDuration&&(t.prependedContentDuration=e.prependedContentDuration/ys),this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}},{key:"createRealSourceBuffers_",value:function(){var e=this,t=["audio","video"];t.forEach((function(n){if(e[n+"Codec_"]&&!e[n+"Buffer_"]){var r=null;if(e.mediaSource_[n+"Buffer_"])(r=e.mediaSource_[n+"Buffer_"]).updating=!1;else{var i=n+'/mp4;codecs="'+e[n+"Codec_"]+'"';r=function(e,t){var n=e.addSourceBuffer(t),r=Object.create(null);r.updating=!1,r.realBuffer_=n;var i=function(e){"function"==typeof n[e]?r[e]=function(){return n[e].apply(n,arguments)}:void 0===r[e]&&Object.defineProperty(r,e,{get:function(){return n[e]},set:function(t){return n[e]=t}})};for(var a in n)i(a);return r}(e.mediaSource_.nativeMediaSource_,i),e.mediaSource_[n+"Buffer_"]=r}e[n+"Buffer_"]=r,["update","updatestart","updateend"].forEach((function(i){r.addEventListener(i,(function(){if("audio"!==n||!e.audioDisabled_)return"updateend"===i&&(e[n+"Buffer_"].updating=!1),t.every((function(t){return!("audio"!==t||!e.audioDisabled_)||(n===t||!e[t+"Buffer_"]||!e[t+"Buffer_"].updating)}))?e.trigger(i):void 0}))}))}}))}},{key:"appendBuffer",value:function(e){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:vs(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=function(e,t,n){if(!t.length)return e;if(n)return t.slice();for(var r=t[0].pts,i=0;i<e.length&&!(e[i].pts>=r);i++);return e.slice(0,i).concat(t)}(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(e,t),this.gopBuffer_=function(e,t,n,r){for(var i=Math.ceil(9e4*(t-r)),a=Math.ceil(9e4*(n-r)),o=e.slice(),s=e.length;s--&&!(e[s].pts<=a););if(-1===s)return o;for(var u=s+1;u--&&!(e[u].pts<=i););return u=Math.max(u,0),o.splice(u,s-u+1),o}(this.gopBuffer_,e,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(e,t)),Xo(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var n in this.inbandTextTracks_)Xo(e,t,this.inbandTextTracks_[n])}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};if(!this.pendingBuffers_.length)return this.trigger("updateend"),void(this.bufferUpdating_=!1);e=this.pendingBuffers_.reduce((function(e,t){var n=t.type,r=t.data,i=t.initSegment;return e[n].segments.push(r),e[n].bytes+=r.byteLength,e[n].initSegment=i,t.captions&&(e.captions=e.captions.concat(t.captions)),t.info&&(e[n].info=t.info),t.metadata&&(e.metadata=e.metadata.concat(t.metadata)),e}),e),this.videoBuffer_||this.audioBuffer_||(0===e.video.bytes&&(this.videoCodec_=null),0===e.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),e.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info}),e.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:e.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(e.audio.segments.unshift(e.audio.initSegment),e.audio.bytes+=e.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var t=!1;this.videoBuffer_&&e.video.bytes?(e.video.segments.unshift(e.video.initSegment),e.video.bytes+=e.video.initSegment.byteLength,this.concatAndAppendSegments_(e.video,this.videoBuffer_)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(t=!0),Zo(this,e.captions,e.metadata),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(e.audio,this.audioBuffer_),this.pendingBuffers_.length=0,t&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var n=0,r=void 0;if(e.bytes){r=new Uint8Array(e.bytes),e.segments.forEach((function(e){r.set(e,n),n+=e.byteLength}));try{t.updating=!0,t.appendBuffer(r)}catch(e){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}},{key:"dispose",value:function(){this.transmuxer_&&this.transmuxer_.terminate(),this.trigger("dispose"),this.off()}}]),t}(Wa.EventTarget),bs=function(e){function t(){Qa(this,t);var e=$a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=void 0;for(n in e.nativeMediaSource_=new i.a.MediaSource,e.nativeMediaSource_)n in t.prototype||"function"!=typeof e.nativeMediaSource_[n]||(e[n]=e.nativeMediaSource_[n].bind(e.nativeMediaSource_));return e.duration_=NaN,Object.defineProperty(e,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(e){this.duration_=e,e===1/0||(this.nativeMediaSource_.duration=e)}}),Object.defineProperty(e,"seekable",{get:function(){return this.duration_===1/0?Wa.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(e,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(e,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),e.sourceBuffers=[],e.activeSourceBuffers_=[],e.updateActiveSourceBuffers_=function(){if(e.activeSourceBuffers_.length=0,1===e.sourceBuffers.length){var t=e.sourceBuffers[0];return t.appendAudioInitSegment_=!0,t.audioDisabled_=!t.audioCodec_,void e.activeSourceBuffers_.push(t)}for(var n=!1,r=!0,i=0;i<e.player_.audioTracks().length;i++){var a=e.player_.audioTracks()[i];if(a.enabled&&"main"!==a.kind){n=!0,r=!1;break}}e.sourceBuffers.forEach((function(t,i){if(t.appendAudioInitSegment_=!0,t.videoCodec_&&t.audioCodec_)t.audioDisabled_=n;else if(t.videoCodec_&&!t.audioCodec_)t.audioDisabled_=!0,r=!1;else if(!t.videoCodec_&&t.audioCodec_&&(t.audioDisabled_=i?r:!r,t.audioDisabled_))return;e.activeSourceBuffers_.push(t)}))},e.onPlayerMediachange_=function(){e.sourceBuffers.forEach((function(e){e.appendAudioInitSegment_=!0}))},e.onHlsReset_=function(){e.sourceBuffers.forEach((function(e){e.transmuxer_&&e.transmuxer_.postMessage({action:"resetCaptions"})}))},e.onHlsSegmentTimeMapping_=function(t){e.sourceBuffers.forEach((function(e){return e.timeMapping_=t.mapping}))},["sourceopen","sourceclose","sourceended"].forEach((function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))}),e),e.on("sourceopen",(function(t){var n=o.a.querySelector('[src="'+e.url_+'"]');n&&(e.player_=Wa(n.parentNode),e.player_&&(e.player_.tech_.on("hls-reset",e.onHlsReset_),e.player_.tech_.on("hls-segment-time-mapping",e.onHlsSegmentTimeMapping_),e.player_.audioTracks&&e.player_.audioTracks()&&(e.player_.audioTracks().on("change",e.updateActiveSourceBuffers_),e.player_.audioTracks().on("addtrack",e.updateActiveSourceBuffers_),e.player_.audioTracks().on("removetrack",e.updateActiveSourceBuffers_)),e.player_.on("mediachange",e.onPlayerMediachange_)))})),e.on("sourceended",(function(t){for(var n=Qo(e.duration),r=0;r<e.sourceBuffers.length;r++){var i=e.sourceBuffers[r],a=i.metadataTrack_&&i.metadataTrack_.cues;a&&a.length&&(a[a.length-1].endTime=n)}})),e.on("sourceclose",(function(e){this.sourceBuffers.forEach((function(e){e.transmuxer_&&e.transmuxer_.terminate()})),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_&&this.player_.tech_.el_&&(this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))})),e}return Ja(t,e),Za(t,[{key:"addSeekableRange_",value:function(e,t){var n=void 0;if(this.duration!==1/0)throw(n=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name="InvalidStateError",n.code=11,n;(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var t=void 0,n=ps(e);if(/^(video|audio)\/mp2t$/i.test(n.type)){var r=[];n.parameters&&n.parameters.codecs&&(r=n.parameters.codecs.split(","),r=(r=cs(r)).filter((function(e){return ms(e)||gs(e)}))),0===r.length&&(r=["avc1.4d400d","mp4a.40.2"]),t=new _s(this,r),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),t.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else t=this.nativeMediaSource_.addSourceBuffer(e);return this.sourceBuffers.push(t),t}},{key:"dispose",value:function(){this.trigger("dispose"),this.off(),this.sourceBuffers.forEach((function(e){e.dispose&&e.dispose()})),this.sourceBuffers.length=0}}]),t}(Wa.EventTarget),Es=0;Wa.mediaSources={};var Ts=function(e,t){var n=Wa.mediaSources[e];if(!n)throw new Error("Media Source not found (Video.js)");n.trigger({type:"sourceopen",swfId:t})},Ss=function(){return!!i.a.MediaSource&&!!i.a.MediaSource.isTypeSupported&&i.a.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')},ws=function(){if(this.MediaSource={open:Ts,supportsNativeMediaSources:Ss},Ss())return new bs;throw new Error("Cannot use create a virtual MediaSource for this video")};ws.open=Ts,ws.supportsNativeMediaSources=Ss;var As={createObjectURL:function(e){var t=void 0;return e instanceof bs?(t=i.a.URL.createObjectURL(e.nativeMediaSource_),e.url_=t,t):e instanceof bs?(t="blob:vjs-media-source/"+Es,Es++,Wa.mediaSources[t]=e,t):(t=i.a.URL.createObjectURL(e),e.url_=t,t)}};Wa.MediaSource=ws,Wa.URL=As;var xs=Wa.EventTarget,Ms=Wa.mergeOptions,Cs=function(e,t){for(var n=void 0,r=Ms(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),i=0;i<t.playlists.length;i++){var a=ao(r,t.playlists[i]);a?r=a:n=!0}return io(t,(function(e,t,i,a){if(e.playlists&&e.playlists.length){var o=e.playlists[0].id,s=ao(r,e.playlists[0]);s&&((r=s).mediaGroups[t][i][a].playlists[0]=r.playlists[o],n=!1)}})),n?null:r},Rs=function(e){var t=e.byterange.offset+e.byterange.length-1;return e.uri+"-"+e.byterange.offset+"-"+t},Is=function(e,t){return(Boolean(!e.map&&!t.map)||Boolean(e.map&&t.map&&e.map.byterange.offset===t.map.byterange.offset&&e.map.byterange.length===t.map.byterange.length))&&e.uri===t.uri&&e.byterange.offset===t.byterange.offset&&e.byterange.length===t.byterange.length},Os=function(e,t){var n={};for(var r in e){var i=e[r].sidx;if(i){var a=Rs(i);if(!t[a])break;var o=t[a].sidxInfo;Is(o,i)&&(n[a]=t[a])}}return n},Ds=function(e,t,n,r,i){var a={uri:Xa(r.handleManifestRedirects,e.resolvedUri),byterange:e.byterange,playlist:t};return n(Wa.mergeOptions(a,{responseType:"arraybuffer",headers:Oo(a)}),i)},Ps=function(e){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3];Qa(this,t);var a=$a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),o=r.withCredentials,s=void 0!==o&&o,u=r.handleManifestRedirects,l=void 0!==u&&u;if(a.hls_=n,a.withCredentials=s,a.handleManifestRedirects=l,!e)throw new Error("A non-empty playlist URL or playlist is required");return a.on("minimumUpdatePeriod",(function(){a.refreshXml_()})),a.on("mediaupdatetimeout",(function(){a.refreshMedia_(a.media().id)})),a.state="HAVE_NOTHING",a.loadedPlaylists_={},"string"==typeof e?(a.srcUrl=e,a.sidxMapping_={},$a(a)):(a.setupChildLoader(i,e),a)}return Ja(t,e),Za(t,[{key:"setupChildLoader",value:function(e,t){this.masterPlaylistLoader_=e,this.childPlaylist_=t}},{key:"dispose",value:function(){this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},i.a.clearTimeout(this.minimumUpdatePeriodTimeout_),i.a.clearTimeout(this.mediaRequest_),i.a.clearTimeout(this.mediaUpdateTimeout),this.off()}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"sidxRequestFinished_",value:function(e,t,n,r){var i=this;return function(a,o){if(i.request){if(i.request=null,a)return i.error={status:o.status,message:"DASH playlist request error at URL: "+e.uri,response:o.response,code:2},n&&(i.state=n),i.trigger("error"),r(t,null);var s=new Uint8Array(o.response),u=Me.a.parseSidx(s.subarray(8));return r(t,u)}}}},{key:"media",value:function(e){var t=this;if(!e)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var n=this.state;if("string"==typeof e){if(!this.master.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.master.playlists[e]}var r=!this.media_||e.id!==this.media_.id;if(r&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList)return this.state="HAVE_METADATA",this.media_=e,void(r&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(r)if(this.media_&&this.trigger("mediachanging"),e.sidx){var a=void 0,o=void 0;this.masterPlaylistLoader_?(a=this.masterPlaylistLoader_.master,o=this.masterPlaylistLoader_.sidxMapping_):(a=this.master,o=this.sidxMapping_);var s=Rs(e.sidx);o[s]={sidxInfo:e.sidx},this.request=Ds(e.sidx,e,this.hls_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(e,a,n,(function(r,i){if(!r||!i)throw new Error("failed to request sidx");o[s].sidx=i,t.haveMetadata({startingState:n,playlist:r.playlists[e.id]})})))}else this.mediaRequest_=i.a.setTimeout(this.haveMetadata.bind(this,{startingState:n,playlist:e}),0)}},{key:"haveMetadata",value:function(e){var t=e.startingState,n=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[n.id]=n,this.mediaRequest_=null,this.refreshMedia_(n.id),"HAVE_MASTER"===t?this.trigger("loadedmetadata"):this.trigger("mediachange")}},{key:"pause",value:function(){this.stopRequest(),i.a.clearTimeout(this.mediaUpdateTimeout),i.a.clearTimeout(this.minimumUpdatePeriodTimeout_),"HAVE_NOTHING"===this.state&&(this.started=!1)}},{key:"load",value:function(e){var t=this;i.a.clearTimeout(this.mediaUpdateTimeout),i.a.clearTimeout(this.minimumUpdatePeriodTimeout_);var n=this.media();if(e){var r=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=i.a.setTimeout((function(){return t.load()}),r)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"parseMasterXml",value:function(){var e=we(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_});e.uri=this.srcUrl;for(var t=0;t<e.playlists.length;t++){var n="placeholder-uri-"+t;e.playlists[t].uri=n}return io(e,(function(t,n,r,i){if(t.playlists&&t.playlists.length){var a="placeholder-uri-"+n+"-"+r+"-"+i,o=oo(0,a);t.playlists[0].uri=a,t.playlists[0].id=o,e.playlists[o]=t.playlists[0],e.playlists[a]=t.playlists[0]}})),so(e),uo(e),e}},{key:"start",value:function(){var e=this;this.started=!0,this.masterPlaylistLoader_?this.mediaRequest_=i.a.setTimeout(this.haveMaster_.bind(this),0):this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:n.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");e.masterXml_=n.responseText,n.responseHeaders&&n.responseHeaders.date?e.masterLoaded_=Date.parse(n.responseHeaders.date):e.masterLoaded_=Date.now(),e.srcUrl=Xa(e.handleManifestRedirects,e.srcUrl,n),e.syncClientServerClock_(e.onClientServerClockSync_.bind(e))}}))}},{key:"syncClientServerClock_",value:function(e){var t=this,n=Ae(this.masterXml_);return null===n?(this.clientOffset_=this.masterLoaded_-Date.now(),e()):"DIRECT"===n.method?(this.clientOffset_=n.value-Date.now(),e()):void(this.request=this.hls_.xhr({uri:Ka(this.srcUrl,n.value),method:n.method,withCredentials:this.withCredentials},(function(r,i){if(t.request){if(r)return t.clientOffset_=t.masterLoaded_-Date.now(),e();var a=void 0;a="HEAD"===n.method?i.responseHeaders&&i.responseHeaders.date?Date.parse(i.responseHeaders.date):t.masterLoaded_:Date.parse(i.responseText),t.clientOffset_=a-Date.now(),e()}})))}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.master=this.parseMasterXml(),this.trigger("loadedplaylist"))}},{key:"onClientServerClockSync_",value:function(){var e=this;this.haveMaster_(),this.hasPendingRequest()||this.media_||this.media(this.master.playlists[0]),this.master&&this.master.minimumUpdatePeriod&&(this.minimumUpdatePeriodTimeout_=i.a.setTimeout((function(){e.trigger("minimumUpdatePeriod")}),this.master.minimumUpdatePeriod))}},{key:"refreshXml_",value:function(){var e=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},(function(t,n){if(e.request){if(e.request=null,t)return e.error={status:n.status,message:"DASH playlist request error at URL: "+e.srcUrl,responseText:n.responseText,code:2},"HAVE_NOTHING"===e.state&&(e.started=!1),e.trigger("error");e.masterXml_=n.responseText,e.sidxMapping_=function(e,t,n,r){var i=we(e,{manifestUri:t,clientOffset:n}),a=Os(i.playlists,r);return io(i,(function(e,t,n,i){if(e.playlists&&e.playlists.length){var o=e.playlists;a=Ms(a,Os(o,r))}})),a}(e.masterXml_,e.srcUrl,e.clientOffset_,e.sidxMapping_);var r=e.parseMasterXml(),a=Cs(e.master,r),o=e.media().sidx;if(a)if(o){var s=Rs(o);if(!e.sidxMapping_[s]){var u=e.media();e.request=Ds(u.sidx,u,e.hls_.xhr,{handleManifestRedirects:e.handleManifestRedirects},e.sidxRequestFinished_(u,r,e.state,(function(t,n){if(!t||!n)throw new Error("failed to request sidx on minimumUpdatePeriod");e.sidxMapping_[s].sidx=n,e.minimumUpdatePeriodTimeout_=i.a.setTimeout((function(){e.trigger("minimumUpdatePeriod")}),e.master.minimumUpdatePeriod),e.refreshMedia_(e.media().id)})))}}else e.master=a;e.minimumUpdatePeriodTimeout_=i.a.setTimeout((function(){e.trigger("minimumUpdatePeriod")}),e.master.minimumUpdatePeriod)}}))}},{key:"refreshMedia_",value:function(e){var t=this;if(!e)throw new Error("refreshMedia_ must take a media id");var n=void 0,r=void 0;this.masterPlaylistLoader_?(n=this.masterPlaylistLoader_.master,r=this.masterPlaylistLoader_.parseMasterXml()):(n=this.master,r=this.parseMasterXml());var a=Cs(n,r);a?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=a:this.master=a,this.media_=a.playlists[e]):(this.media_=r.playlists[e],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=i.a.setTimeout((function(){t.trigger("mediaupdatetimeout")}),lo(this.media(),!!a))),this.trigger("loadedplaylist")}}]),t}(xs),Ls=function(e){return Wa.log.debug?Wa.log.debug.bind(Wa,"VHS:",e+" >"):function(){}};function Ns(){}var ks=function(){function e(t,n,r,i){Qa(this,e),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=t,this.processedAppend_=!1,this.type_=r,this.mimeType_=n,this.logger_=Ls("SourceUpdater["+r+"]["+n+"]"),"closed"===t.readyState?t.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,n,i)):this.createSourceBuffer_(n,i)}return Za(e,[{key:"createSourceBuffer_",value:function(e,t){var n=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(e),this.logger_("created SourceBuffer"),t&&(t.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)?t.on("sourcebufferadded",(function(){n.start_()})):this.start_()}},{key:"start_",value:function(){var e=this;this.started_=!0,this.onUpdateendCallback_=function(){var t=e.pendingCallback_;e.pendingCallback_=null,e.sourceBuffer_.removing=!1,e.logger_("buffered ["+Yo(e.buffered())+"]"),t&&t(),e.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(e){var t=this;this.processedAppend_&&this.queueCallback_((function(){t.sourceBuffer_.abort()}),e)}},{key:"appendBuffer",value:function(e,t){var n=this;this.processedAppend_=!0,this.queueCallback_((function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.addEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),n.sourceBuffer_.appendBuffer(e.bytes)}),(function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),t()}))}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:Wa.createTimeRanges()}},{key:"remove",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ns;this.processedAppend_&&this.queueCallback_((function(){n.logger_("remove ["+e+" => "+t+"]"),n.sourceBuffer_.removing=!0,n.sourceBuffer_.remove(e,t)}),r)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==Ns}},{key:"timestampOffset",value:function(e){var t=this;return void 0!==e&&(this.queueCallback_((function(){t.sourceBuffer_.timestampOffset=e,t.runCallback_()})),this.timestampOffset_=e),this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]),this.runCallback_()}},{key:"runCallback_",value:function(){var e=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(e=this.callbacks_.shift(),this.pendingCallback_=e[1],e[0]())}},{key:"dispose",value:function(){var e=this,t=function t(){e.sourceBuffer_&&"open"===e.mediaSource.readyState&&e.sourceBuffer_.abort(),e.sourceBuffer_.removeEventListener("updateend",t)};this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_.removing?this.sourceBuffer_.addEventListener("updateend",t):t()}}]),e}(),Fs={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},Bs=2,Us=-101,js=-102,Gs=function(e){e.forEach((function(e){e.abort()}))},Hs=function(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:Us,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:js,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:Bs,xhr:t}:null},Vs=function(e,t,n){var r=0,i=!1;return function(a,o){if(!i)return a?(i=!0,Gs(e),n(a,o)):(r+=1)===e.length?(o.endOfAllRequests=Date.now(),o.encryptedBytes?function(e,t,n){e.addEventListener("message",(function r(i){if(i.data.source===t.requestId){e.removeEventListener("message",r);var a=i.data.decrypted;return t.bytes=new Uint8Array(a.bytes,a.byteOffset,a.byteLength),n(null,t)}}));var r=void 0;r=t.key.bytes.slice?t.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(t.key.bytes)),e.postMessage(No({source:t.requestId,encrypted:t.encryptedBytes,key:r,iv:t.key.iv}),[t.encryptedBytes.buffer,r.buffer])}(t,o,n):n(null,o)):void 0}},zs=function(e,t){return function(n){var r,i,a;return e.stats=Wa.mergeOptions(e.stats,(i=(r=n).target,(a={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-i.requestTime||0}).bytesReceived=r.loaded,a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3),a)),!e.stats.firstBytesReceivedAt&&e.stats.bytesReceived&&(e.stats.firstBytesReceivedAt=Date.now()),t(n,e)}},Ws=function(e,t,n,r,i,a,o){var s=[],u=Vs(s,n,o);if(i.key&&!i.key.bytes){var l=e(Wa.mergeOptions(t,{uri:i.key.resolvedUri,responseType:"arraybuffer"}),function(e,t){return function(n,r){var i=r.response,a=Hs(n,r);if(a)return t(a,e);if(16!==i.byteLength)return t({status:r.status,message:"Invalid HLS key at URL: "+r.uri,code:Bs,xhr:r},e);var o=new DataView(i);return e.key.bytes=new Uint32Array([o.getUint32(0),o.getUint32(4),o.getUint32(8),o.getUint32(12)]),t(null,e)}}(i,u));s.push(l)}if(i.map&&!i.map.bytes){var c=e(Wa.mergeOptions(t,{uri:i.map.resolvedUri,responseType:"arraybuffer",headers:Oo(i.map)}),function(e,t,n){return function(r,i){var a=i.response,o=Hs(r,i);return o?n(o,e):0===a.byteLength?n({status:i.status,message:"Empty HLS segment content at URL: "+i.uri,code:Bs,xhr:i},e):(e.map.bytes=new Uint8Array(i.response),t&&!t.isInitialized()&&t.init(),e.map.timescales=Re.a.timescale(e.map.bytes),e.map.videoTrackIds=Re.a.videoTrackIds(e.map.bytes),n(null,e))}}(i,r,u));s.push(c)}var d=e(Wa.mergeOptions(t,{uri:i.resolvedUri,responseType:"arraybuffer",headers:Oo(i)}),function(e,t,n){return function(r,i){var a=i.response,o=Hs(r,i),s=void 0;return o?n(o,e):0===a.byteLength?n({status:i.status,message:"Empty HLS segment content at URL: "+i.uri,code:Bs,xhr:i},e):(e.stats=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}}(i),e.key?e.encryptedBytes=new Uint8Array(i.response):e.bytes=new Uint8Array(i.response),t&&e.map&&e.map.bytes&&(t.isInitialized()||t.init(),(s=t.parse(e.bytes,e.map.videoTrackIds,e.map.timescales))&&s.captions&&(e.captionStreams=s.captionStreams,e.fmp4Captions=s.captions)),n(null,e))}}(i,r,u));return d.addEventListener("progress",zs(i,a)),s.push(d),function(){return Gs(s)}},qs=function(e,t){var n;return e&&(n=i.a.getComputedStyle(e))?n[t]:""},Ys=function(e,t){var n=e.slice();e.sort((function(e,r){var i=t(e,r);return 0===i?n.indexOf(e)-n.indexOf(r):i}))},Ks=function(e,t){var n=void 0,r=void 0;return e.attributes.BANDWIDTH&&(n=e.attributes.BANDWIDTH),n=n||i.a.Number.MAX_VALUE,t.attributes.BANDWIDTH&&(r=t.attributes.BANDWIDTH),n-(r=r||i.a.Number.MAX_VALUE)},Xs=function(e,t,n){if(!e||!t)return!1;var r=n===e.segments.length;return e.endList&&"open"===t.readyState&&r},Qs=function(e){return"number"==typeof e&&isFinite(e)},Zs=function(e){function t(e){Qa(this,t);var n=$a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");return n.bandwidth=e.bandwidth,n.throughput={rate:0,count:0},n.roundTrip=NaN,n.resetStats_(),n.mediaIndex=null,n.hasPlayed_=e.hasPlayed,n.currentTime_=e.currentTime,n.seekable_=e.seekable,n.seeking_=e.seeking,n.duration_=e.duration,n.mediaSource_=e.mediaSource,n.hls_=e.hls,n.loaderType_=e.loaderType,n.startingMedia_=void 0,n.segmentMetadataTrack_=e.segmentMetadataTrack,n.goalBufferLength_=e.goalBufferLength,n.sourceType_=e.sourceType,n.inbandTextTracks_=e.inbandTextTracks,n.state_="INIT",n.checkBufferTimeout_=null,n.error_=void 0,n.currentTimeline_=-1,n.pendingSegment_=null,n.mimeType_=null,n.sourceUpdater_=null,n.xhrOptions_=null,n.activeInitSegmentId_=null,n.initSegments_={},n.cacheEncryptionKeys_=e.cacheEncryptionKeys,n.keyCache_={},"main"===n.loaderType_?n.captionParser_=new Oe.a:n.captionParser_=null,n.decrypter_=e.decrypter,n.syncController_=e.syncController,n.syncPoint_={segmentIndex:0,time:0},n.triggerSyncInfoUpdate_=function(){return n.trigger("syncinfoupdate")},n.syncController_.on("syncinfoupdate",n.triggerSyncInfoUpdate_),n.mediaSource_.addEventListener("sourceopen",(function(){return n.ended_=!1})),n.fetchAtBuffer_=!1,n.logger_=Ls("SegmentLoader["+n.loaderType_+"]"),Object.defineProperty(n,"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e)}}),n}return Ja(t,e),Za(t,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_(),this.captionParser_&&this.captionParser_.reset(),this.checkBufferTimeout_&&i.a.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}},{key:"abort",value:function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(e){return void 0!==e&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():Wa.createTimeRanges()}},{key:"initSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=ko(e),r=this.initSegments_[n];return t&&!r&&e.bytes&&(this.initSegments_[n]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,timescales:e.timescales,videoTrackIds:e.videoTrackIds}),r||e}},{key:"segmentKey",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=Fo(e),r=this.keyCache_[n];this.cacheEncryptionKeys_&&t&&!r&&e.bytes&&(this.keyCache_[n]=r={resolvedUri:e.resolvedUri,bytes:e.bytes});var i={resolvedUri:(r||e).resolvedUri};return r&&(i.bytes=r.bytes),i}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new ks(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var n=this.playlist_,r=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,"INIT"===this.state&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0});var i=null;if(n&&(n.id?i=n.id:n.uri&&(i=n.uri)),this.logger_("playlist update ["+i+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(n&&n.uri===e.uri){var a=e.mediaSequence-n.mediaSequence;this.logger_("live window shift ["+a+"]"),null!==this.mediaIndex&&(this.mediaIndex-=a),r&&(r.mediaIndex-=a,r.mediaIndex>=0&&(r.segment=e.segments[r.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(n,e)}else null!==this.mediaIndex&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(i.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e,t){this.mimeType_||(this.mimeType_=e,this.sourceBufferEmitter_=t,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(e){this.ended_=!1,this.resetLoader(),this.remove(0,1/0,e),this.captionParser_&&this.captionParser_.clearAllCaptions(),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(e,t,n){if(t===1/0&&(t=this.duration_()),this.sourceUpdater_&&this.sourceUpdater_.remove(e,t,n),Xo(e,t,this.segmentMetadataTrack_),this.inbandTextTracks_)for(var r in this.inbandTextTracks_)Xo(e,t,this.inbandTextTracks_[r])}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&i.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=i.a.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&i.a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=i.a.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);e&&(this.isEndOfStream_(e.mediaIndex)?this.endOfStream():(e.mediaIndex!==this.playlist_.segments.length-1||"ended"!==this.mediaSource_.readyState||this.seeking_())&&(e.timeline!==this.currentTimeline_&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment,this.captionParser_&&this.captionParser_.clearAllCaptions()),this.loadSegment_(e)))}}},{key:"isEndOfStream_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.playlist_;return Xs(t,this.mediaSource_,e)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(e,t,n,r,i,a){var o=0,s=void 0;e.length&&(o=e.end(e.length-1));var u=Math.max(0,o-i);if(!t.segments.length)return null;if(u>=this.goalBufferLength_())return null;if(!r&&u>=1)return null;if(null===a)return n=this.getSyncSegmentCandidate_(t),this.generateSegmentInfo_(t,n,null,!0);if(null!==n){t.segments[n];return s=o,this.generateSegmentInfo_(t,n+1,s,!1)}if(this.fetchAtBuffer_){var l=Mo.getMediaInfoForTime(t,o,a.segmentIndex,a.time);n=l.mediaIndex,s=l.startTime}else{var c=Mo.getMediaInfoForTime(t,i,a.segmentIndex,a.time);n=c.mediaIndex,s=c.startTime}return this.generateSegmentInfo_(t,n,s,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_)return 0;var n=e.segments.map((function(e,t){return{timeline:e.timeline,segmentIndex:t}})).filter((function(e){return e.timeline===t.currentTimeline_}));return n.length?n[Math.min(n.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,n,r){if(t<0||t>=e.segments.length)return null;var i=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:i.resolvedUri,mediaIndex:t,isSyncRequest:r,startOfSegment:n,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:i.timeline,duration:i.duration,segment:i}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),n=e.bandwidth,r=this.pendingSegment_.duration,i=Mo.estimateSegmentRequestTime(r,n,this.playlist_,e.bytesReceived),a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return((e.length?e.end(e.length-1):0)-t)/n}(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(i<=a)return!1;var o=function(e){var t=e.master,n=e.currentTime,r=e.bandwidth,i=e.duration,a=e.segmentDuration,o=e.timeUntilRebuffer,s=e.currentTimeline,u=e.syncController,l=t.playlists.filter((function(e){return!Mo.isIncompatible(e)})),c=l.filter(Mo.isEnabled);c.length||(c=l.filter((function(e){return!Mo.isDisabled(e)})));var d=c.filter(Mo.hasAttribute.bind(null,"BANDWIDTH")).map((function(e){var t=u.getSyncPoint(e,i,s,n)?1:2;return{playlist:e,rebufferingImpact:Mo.estimateSegmentRequestTime(a,r,e)*t-o}})),h=d.filter((function(e){return e.rebufferingImpact<=0}));return Ys(h,(function(e,t){return Ks(t.playlist,e.playlist)})),h.length?h[0]:(Ys(d,(function(e,t){return e.rebufferingImpact-t.rebufferingImpact})),d[0]||null)}({master:this.hls_.playlists.master,currentTime:t,bandwidth:n,duration:this.duration_(),segmentDuration:r,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(o){var s=i-a-o.rebufferingImpact,u=.5;return a<=Ho&&(u=1),!o.playlist||o.playlist.uri===this.playlist_.uri||s<u?!1:(this.bandwidth=o.playlist.attributes.BANDWIDTH*Fs.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),!0)}}},{key:"handleProgress_",value:function(e,t){this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(t.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),e.abortRequests=Ws(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(e){var t=function(e,t,n){var r=t-30;e.length&&(r=Math.max(r,e.start(0)));var i=t-n;return Math.min(i,r)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,n={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var r=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);n.key=this.segmentKey(t.key),n.key.iv=r}return t.map&&(n.map=this.initSegment(t.map)),n}},{key:"segmentRequestFinished_",value:function(e,t){if(this.mediaRequests+=1,t.stats&&(this.mediaBytesTransferred+=t.stats.bytesReceived,this.mediaTransferDuration+=t.stats.roundTripTime),this.pendingSegment_){if(t.requestId===this.pendingSegment_.requestId){if(e)return this.pendingSegment_=null,this.state="READY",e.code===js?void(this.mediaRequestsAborted+=1):(this.pause(),e.code===Us?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error")));this.bandwidth=t.stats.bandwidth,this.roundTrip=t.stats.roundTripTime,t.map&&(t.map=this.initSegment(t.map,!0)),t.key&&this.segmentKey(t.key,!0),this.processSegmentResponse_(t)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes,e.map&&(t.segment.map.bytes=e.map.bytes),t.endOfAllRequests=e.endOfAllRequests,e.fmp4Captions&&(!function(e,t,n){for(var r in n)if(!e[r]){t.trigger({type:"usage",name:"hls-608"});var i=t.textTracks().getTrackById(r);e[r]=i||t.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track}}(this.inbandTextTracks_,this.hls_.tech_,e.captionStreams),function(e){var t=e.inbandTextTracks,n=e.captionArray,r=e.timestampOffset;if(n){var i=window.WebKitDataCue||window.VTTCue;n.forEach((function(e){var n=e.stream,a=e.startTime,o=e.endTime;t[n]&&(a+=r,o+=r,t[n].addCue(new i(a,o,e.text)))}))}}({inbandTextTracks:this.inbandTextTracks_,captionArray:e.fmp4Captions,timestampOffset:0}),this.captionParser_&&this.captionParser_.clearParsedCaptions()),this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(this.pendingSegment_){var t=this.pendingSegment_,n=t.segment,r=this.syncController_.probeSegmentInfo(t);void 0===this.startingMedia_&&r&&(r.containsAudio||r.containsVideo)&&(this.startingMedia_={containsAudio:r.containsAudio,containsVideo:r.containsVideo});var i,a,o,s=(i=this.loaderType_,a=this.startingMedia_,o=r,"main"===i&&a&&o?o.containsAudio||o.containsVideo?a.containsVideo&&!o.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!a.containsVideo&&o.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null);if(s)return this.error({message:s,blacklistDuration:1/0}),void this.trigger("error");if(t.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");if(null!==t.timestampOffset&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()){if(r&&r.segmentTimestampInfo){var u=r.segmentTimestampInfo[0].ptsTime,l=r.segmentTimestampInfo[0].dtsTime;t.timestampOffset-=u-l}this.sourceUpdater_.timestampOffset(t.timestampOffset),this.trigger("timestampoffset")}var c=this.syncController_.mappingForTimeline(t.timeline);if(null!==c&&this.trigger({type:"segmenttimemapping",mapping:c}),this.state="APPENDING",n.map){var d=ko(n.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==d){var h=this.initSegment(n.map);this.sourceUpdater_.appendBuffer({bytes:h.bytes},(function(){e.activeInitSegmentId_=d}))}}t.byteLength=t.bytes.byteLength,"number"==typeof n.start&&"number"==typeof n.end?this.mediaSecondsLoaded+=n.end-n.start:this.mediaSecondsLoaded+=n.duration,this.logger_(function(e){var t=e.segment,n=t.start,r=t.end,i=e.playlist,a=i.mediaSequence,o=i.id,s=i.segments,u=void 0===s?[]:s,l=e.mediaIndex,c=e.timeline;return["appending ["+l+"] of ["+a+", "+(a+u.length)+"] from playlist ["+o+"]","["+n+" => "+r+"] in timeline ["+c+"]"].join(" ")}(t)),this.sourceUpdater_.appendBuffer({bytes:t.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,t.requestId)},this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleVideoSegmentTimingInfo_",value:function(e,t){if(this.pendingSegment_&&e===this.pendingSegment_.requestId){var n=this.pendingSegment_.segment;n.videoTimingInfo||(n.videoTimingInfo={}),n.videoTimingInfo.transmuxerPrependedSeconds=t.videoSegmentTimingInfo.prependedContentDuration||0,n.videoTimingInfo.transmuxedPresentationStart=t.videoSegmentTimingInfo.start.presentation,n.videoTimingInfo.transmuxedPresentationEnd=t.videoSegmentTimingInfo.end.presentation,n.videoTimingInfo.baseMediaDecodeTime=t.videoSegmentTimingInfo.baseMediaDecodeTime}}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_,t=e.segment,n=null!==this.mediaIndex;this.pendingSegment_=null,this.recordThroughput_(e),this.addSegmentMetadataCue_(e),this.state="READY",this.mediaIndex=e.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration?this.resetEverything():(n&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.isEndOfStream_(e.mediaIndex+1,e.playlist)&&this.endOfStream(),this.paused()||this.monitorBuffer_())}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,r=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(r-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(e){if(this.segmentMetadataTrack_){var t=e.segment,n=t.start,r=t.end;if(Qs(n)&&Qs(r)){Xo(n,r,this.segmentMetadataTrack_);var a=i.a.WebKitDataCue||i.a.VTTCue,o={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:n,end:r},s=new a(n,r,JSON.stringify(o));s.value=o,this.segmentMetadataTrack_.addCue(s)}}}}]),t}(Wa.EventTarget),Js=function(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))},$s=new Uint8Array("\n\n".split("").map((function(e){return e.charCodeAt(0)}))),eu=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qa(this,t);var r=$a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.mediaSource_=null,r.subtitlesTrack_=null,r.featuresNativeTextTracks_=e.featuresNativeTextTracks,r}return Ja(t,e),Za(t,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return Wa.createTimeRanges();var e=this.subtitlesTrack_.cues,t=e[0].startTime,n=e[e.length-1].startTime;return Wa.createTimeRanges([[t,n]])}},{key:"initSegment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return null;var n=ko(e),r=this.initSegments_[n];if(t&&!r&&e.bytes){var i=$s.byteLength+e.bytes.byteLength,a=new Uint8Array(i);a.set(e.bytes),a.set($s,e.bytes.byteLength),this.initSegments_[n]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return r||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(e){return void 0===e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}},{key:"remove",value:function(e,t){Xo(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t)){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline)){return this.syncController_.one("timestampoffset",(function(){e.state="READY",e.paused()||e.monitorBuffer_()})),void(this.state="WAITING_ON_TIMELINE")}this.loadSegment_(t)}}},{key:"skipEmptySegments_",value:function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e}},{key:"handleSegment_",value:function(){var e=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var t=this.pendingSegment_,n=t.segment;if("function"!=typeof i.a.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){var r=void 0,a=function(){e.subtitlesTrack_.tech_.off("vttjsloaded",r),e.error({message:"Error loading vtt.js"}),e.state="READY",e.pause(),e.trigger("error")};return r=function(){e.subtitlesTrack_.tech_.off("vttjserror",a),e.handleSegment_()},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",r),void this.subtitlesTrack_.tech_.one("vttjserror",a)}n.requested=!0;try{this.parseVTTCues_(t)}catch(e){return this.error({message:e.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(t,this.syncController_.timelines[t.timeline],this.playlist_),t.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");t.byteLength=t.bytes.byteLength,this.mediaSecondsLoaded+=n.duration,t.cues.length&&this.remove(t.cues[0].endTime,t.cues[t.cues.length-1].endTime),t.cues.forEach((function(t){e.subtitlesTrack_.addCue(e.featuresNativeTextTracks_?new i.a.VTTCue(t.startTime,t.endTime,t.text):t)})),this.handleUpdateEnd_()}else this.state="READY"}},{key:"parseVTTCues_",value:function(e){var t=void 0,n=!1;"function"==typeof i.a.TextDecoder?t=new i.a.TextDecoder("utf8"):(t=i.a.WebVTT.StringDecoder(),n=!0);var r=new i.a.WebVTT.Parser(i.a,i.a.vttjs,t);if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},r.oncue=e.cues.push.bind(e.cues),r.ontimestampmap=function(t){return e.timestampmap=t},r.onparsingerror=function(e){Wa.log.warn("Error encountered when parsing cues: "+e.message)},e.segment.map){var a=e.segment.map.bytes;n&&(a=Js(a)),r.parse(a)}var o=e.bytes;n&&(o=Js(o)),r.parse(o),r.flush()}},{key:"updateTimeMapping_",value:function(e,t,n){var r=e.segment;if(t)if(e.cues.length){var i=e.timestampmap,a=i.MPEGTS/9e4-i.LOCAL+t.mapping;if(e.cues.forEach((function(e){e.startTime+=a,e.endTime+=a})),!n.syncInfo){var o=e.cues[0].startTime,s=e.cues[e.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:Math.min(o,s-r.duration)}}}else r.empty=!0}}]),t}(Zs),tu=function(e,t){for(var n=e.cues,r=0;r<n.length;r++){var i=n[r];if(t>=i.adStartTime&&t<=i.adEndTime)return i}return null},nu=Pe.a.inspect,ru=[{name:"VOD",run:function(e,t,n,r,i){if(n!==1/0){return{time:0,segmentIndex:0}}return null}},{name:"ProgramDateTime",run:function(e,t,n,r,i){if(!e.datetimeToDisplayTime)return null;var a=t.segments||[],o=null,s=null;i=i||0;for(var u=0;u<a.length;u++){var l=a[u];if(l.dateTimeObject){var c=l.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,d=Math.abs(i-c);if(null!==s&&(0===d||s<d))break;s=d,o={time:c,segmentIndex:u}}}return o}},{name:"Segment",run:function(e,t,n,r,i){var a=t.segments||[],o=null,s=null;i=i||0;for(var u=0;u<a.length;u++){var l=a[u];if(l.timeline===r&&void 0!==l.start){var c=Math.abs(i-l.start);if(null!==s&&s<c)break;(!o||null===s||s>=c)&&(s=c,o={time:l.start,segmentIndex:u})}}return o}},{name:"Discontinuity",run:function(e,t,n,r,i){var a=null;if(i=i||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var o=null,s=0;s<t.discontinuityStarts.length;s++){var u=t.discontinuityStarts[s],l=t.discontinuitySequence+s+1,c=e.discontinuities[l];if(c){var d=Math.abs(i-c.time);if(null!==o&&o<d)break;(!a||null===o||o>=d)&&(o=d,a={time:c.time,segmentIndex:u})}}return a}},{name:"Playlist",run:function(e,t,n,r,i){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}],iu=function(e){function t(){Qa(this,t);var e=$a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.inspectCache_=void 0,e.timelines=[],e.discontinuities=[],e.datetimeToDisplayTime=null,e.logger_=Ls("SyncController"),e}return Ja(t,e),Za(t,[{key:"getSyncPoint",value:function(e,t,n,r){var i=this.runStrategies_(e,t,n,r);return i.length?this.selectSyncPoint_(i,{key:"time",value:r}):null}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments)return null;var n=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!n.length)return null;var r=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return r.segmentIndex>0&&(r.time*=-1),Math.abs(r.time+mo(e,r.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,n,r){for(var i=[],a=0;a<ru.length;a++){var o=ru[a],s=o.run(this,e,t,n,r);s&&(s.strategy=o.name,i.push({strategy:o.name,syncPoint:s}))}return i}},{key:"selectSyncPoint_",value:function(e,t){for(var n=e[0].syncPoint,r=Math.abs(e[0].syncPoint[t.key]-t.value),i=e[0].strategy,a=1;a<e.length;a++){var o=Math.abs(e[a].syncPoint[t.key]-t.value);o<r&&(r=o,n=e[a].syncPoint,i=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+i+"]: [time:"+n.time+", segmentIndex:"+n.segmentIndex+"]"),n}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var n=t.mediaSequence-e.mediaSequence-1;n>=0;n--){var r=e.segments[n];if(r&&void 0!==r.start){t.syncInfo={mediaSequence:e.mediaSequence+n,time:r.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t=e.segment,n=e.playlist,r=void 0;return(r=t.map?this.probeMp4Segment_(e):this.probeTsSegment_(e))&&this.calculateSegmentTimeMapping_(e,r)&&(this.saveDiscontinuitySyncInfo_(e),n.syncInfo||(n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:t.start})),r}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,n=Re.a.timescale(t.map.bytes),r=Re.a.compositionStartTime(n,e.bytes);return null!==e.timestampOffset&&(e.timestampOffset-=r),{start:r,end:r+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=nu(e.bytes,this.inspectCache_),n=void 0,r=void 0,i=void 0;return t?(t.video&&2===t.video.length?(this.inspectCache_=t.video[1].dts,n=t.video[0].dtsTime,r=t.video[1].dtsTime,i=t.video):t.audio&&2===t.audio.length&&(this.inspectCache_=t.audio[1].dts,n=t.audio[0].dtsTime,r=t.audio[1].dtsTime,i=t.audio),{segmentTimestampInfo:i,start:n,end:r,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length}):null}},{key:"timestampOffsetForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var n=e.segment,r=this.timelines[e.timeline];if(null!==e.timestampOffset)r={time:e.startOfSegment,mapping:e.startOfSegment-t.start},this.timelines[e.timeline]=r,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+r.time+"] [mapping: "+r.mapping+"]"),n.start=e.startOfSegment,n.end=t.end+r.mapping;else{if(!r)return!1;n.start=t.start+r.mapping,n.end=t.end+r.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var r=0;r<t.discontinuityStarts.length;r++){var i=t.discontinuityStarts[r],a=t.discontinuitySequence+r+1,o=i-e.mediaIndex,s=Math.abs(o);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>s){var u=void 0;u=o<0?n.start-mo(t,e.mediaIndex,i):n.end+mo(t,e.mediaIndex+1,i),this.discontinuities[a]={time:u,accuracy:s}}}}},{key:"dispose",value:function(){this.trigger("dispose"),this.off()}}]),t}(Wa.EventTarget),au=new rs("./decrypter-worker.worker.js",(function(e,t){var n=this;!function(){var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=null,i=function(){function t(n){e(this,t),r||(r=function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],r=t[4],i=n[4],a=void 0,o=void 0,s=void 0,u=[],l=[],c=void 0,d=void 0,h=void 0,f=void 0,p=void 0;for(a=0;a<256;a++)l[(u[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!r[o];o^=c||1,s=l[s]||1)for(h=(h=s^s<<1^s<<2^s<<3^s<<4)>>8^255&h^99,r[o]=h,i[h]=o,p=16843009*u[d=u[c=u[o]]]^65537*d^257*c^16843008*o,f=257*u[h]^16843008*h,a=0;a<4;a++)t[a][o]=f=f<<24^f>>>8,n[a][h]=p=p<<24^p>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e}()),this._tables=[[r[0][0].slice(),r[0][1].slice(),r[0][2].slice(),r[0][3].slice(),r[0][4].slice()],[r[1][0].slice(),r[1][1].slice(),r[1][2].slice(),r[1][3].slice(),r[1][4].slice()]];var i=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=this._tables[0][4],c=this._tables[1],d=n.length,h=1;if(4!==d&&6!==d&&8!==d)throw new Error("Invalid aes key size");for(s=n.slice(0),u=[],this._key=[s,u],i=d;i<4*d+28;i++)o=s[i-1],(i%d==0||8===d&&i%d==4)&&(o=l[o>>>24]<<24^l[o>>16&255]<<16^l[o>>8&255]<<8^l[255&o],i%d==0&&(o=o<<8^o>>>24^h<<24,h=h<<1^283*(h>>7))),s[i]=s[i-d]^o;for(a=0;i;a++,i--)o=s[3&a?i:i-4],u[a]=i<=4||a<4?o:c[0][l[o>>>24]]^c[1][l[o>>16&255]]^c[2][l[o>>8&255]]^c[3][l[255&o]]}return t.prototype.decrypt=function(e,t,n,r,i,a){var o=this._key[1],s=e^o[0],u=r^o[1],l=n^o[2],c=t^o[3],d=void 0,h=void 0,f=void 0,p=o.length/4-2,m=void 0,g=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],E=v[3],T=v[4];for(m=0;m<p;m++)d=y[s>>>24]^_[u>>16&255]^b[l>>8&255]^E[255&c]^o[g],h=y[u>>>24]^_[l>>16&255]^b[c>>8&255]^E[255&s]^o[g+1],f=y[l>>>24]^_[c>>16&255]^b[s>>8&255]^E[255&u]^o[g+2],c=y[c>>>24]^_[s>>16&255]^b[u>>8&255]^E[255&l]^o[g+3],g+=4,s=d,u=h,l=f;for(m=0;m<4;m++)i[(3&-m)+a]=T[s>>>24]<<24^T[u>>16&255]<<16^T[l>>8&255]<<8^T[255&c]^o[g++],d=s,s=u,u=l,l=c,c=d},t}(),a=function(){function t(){e(this,t),this.listeners={}}return t.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),n>-1},t.prototype.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var n=t.length,r=0;r<n;++r)t[r].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),a=t.length,o=0;o<a;++o)t[o].apply(this,i)},t.prototype.dispose=function(){this.listeners={}},t.prototype.pipe=function(e){this.on("data",(function(t){e.push(t)}))},t}(),o=function(t){function n(){e(this,n);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,t.call(this,a));return r.jobs=[],r.delay=1,r.timeout_=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),n.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},n.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},n}(a),s=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},u=function(){function n(t,r,i,a){e(this,n);var u=n.STEP,l=new Int32Array(t.buffer),c=new Uint8Array(t.byteLength),d=0;for(this.asyncStream_=new o,this.asyncStream_.push(this.decryptChunk_(l.subarray(d,d+u),r,i,c)),d=u;d<l.length;d+=u)i=new Uint32Array([s(l[d-4]),s(l[d-3]),s(l[d-2]),s(l[d-1])]),this.asyncStream_.push(this.decryptChunk_(l.subarray(d,d+u),r,i,c));this.asyncStream_.push((function(){var e;a(null,(e=c).subarray(0,e.byteLength-e[e.byteLength-1]))}))}return n.prototype.decryptChunk_=function(e,t,n,r){return function(){var a=function(e,t,n){var r=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),a=new i(Array.prototype.slice.call(t)),o=new Uint8Array(e.byteLength),u=new Int32Array(o.buffer),l=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;for(l=n[0],c=n[1],d=n[2],h=n[3],v=0;v<r.length;v+=4)f=s(r[v]),p=s(r[v+1]),m=s(r[v+2]),g=s(r[v+3]),a.decrypt(f,p,m,g,u,v),u[v]=s(u[v]^l),u[v+1]=s(u[v+1]^c),u[v+2]=s(u[v+2]^d),u[v+3]=s(u[v+3]^h),l=f,c=p,d=m,h=g;return o}(e,t,n);r.set(a,e.byteOffset)}},t(n,null,[{key:"STEP",get:function(){return 32e3}}]),n}();new function(e){e.onmessage=function(t){var n=t.data,r=new Uint8Array(n.encrypted.bytes,n.encrypted.byteOffset,n.encrypted.byteLength),i=new Uint32Array(n.key.bytes,n.key.byteOffset,n.key.byteLength/4),a=new Uint32Array(n.iv.bytes,n.iv.byteOffset,n.iv.byteLength/4);new u(r,i,a,(function(t,r){var i,a;e.postMessage((i={source:n.source,decrypted:r},a={},Object.keys(i).forEach((function(e){var t=i[e];ArrayBuffer.isView(t)?a[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:a[e]=t})),a),[r.buffer])}))}}(n)}()})),ou=function(e){var t=e.default?"main":"alternative";return e.characteristics&&e.characteristics.indexOf("public.accessibility.describes-video")>=0&&(t="main-desc"),t},su=function(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},uu=function(e,t){t.activePlaylistLoader=e,e.load()},lu={AUDIO:function(e,t){return function(){var n=t.segmentLoaders[e],r=t.mediaTypes[e],i=t.blacklistCurrentPlaylist;su(n,r);var a=r.activeTrack(),o=r.activeGroup(),s=(o.filter((function(e){return e.default}))[0]||o[0]).id,u=r.tracks[s];if(a!==u){for(var l in Wa.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),r.tracks)r.tracks[l].enabled=r.tracks[l]===u;r.onTrackChanged()}else i({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(e,t){return function(){var n=t.segmentLoaders[e],r=t.mediaTypes[e];Wa.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),su(n,r);var i=r.activeTrack();i&&(i.mode="disabled"),r.onTrackChanged()}}},cu={AUDIO:function(e,t,n){if(t){var r=n.tech,i=n.requestOptions,a=n.segmentLoaders[e];t.on("loadedmetadata",(function(){var e=t.media();a.playlist(e,i),(!r.paused()||e.endList&&"none"!==r.preload())&&a.load()})),t.on("loadedplaylist",(function(){a.playlist(t.media(),i),r.paused()||a.load()})),t.on("error",lu[e](e,n))}},SUBTITLES:function(e,t,n){var r=n.tech,i=n.requestOptions,a=n.segmentLoaders[e],o=n.mediaTypes[e];t.on("loadedmetadata",(function(){var e=t.media();a.playlist(e,i),a.track(o.activeTrack()),(!r.paused()||e.endList&&"none"!==r.preload())&&a.load()})),t.on("loadedplaylist",(function(){a.playlist(t.media(),i),r.paused()||a.load()})),t.on("error",lu[e](e,n))}},du={AUDIO:function(e,t){var n=t.hls,r=t.sourceType,i=t.segmentLoaders[e],a=t.requestOptions,o=t.master.mediaGroups,s=t.mediaTypes[e],u=s.groups,l=s.tracks,c=t.masterPlaylistLoader;for(var d in o[e]&&0!==Object.keys(o[e]).length||(o[e]={main:{default:{default:!0}}}),o[e])for(var h in u[d]||(u[d]=[]),o[e][d]){var f=o[e][d][h],p=void 0;if(p=f.resolvedUri?new co(f.resolvedUri,n,a):f.playlists&&"dash"===r?new Ps(f.playlists[0],n,a,c):null,f=Wa.mergeOptions({id:h,playlistLoader:p},f),cu[e](e,f.playlistLoader,t),u[d].push(f),void 0===l[h]){var m=new Wa.AudioTrack({id:h,kind:ou(f),enabled:!1,language:f.language,default:f.default,label:h});l[h]=m}}i.on("error",lu[e](e,t))},SUBTITLES:function(e,t){var n=t.tech,r=t.hls,i=t.sourceType,a=t.segmentLoaders[e],o=t.requestOptions,s=t.master.mediaGroups,u=t.mediaTypes[e],l=u.groups,c=u.tracks,d=t.masterPlaylistLoader;for(var h in s[e])for(var f in l[h]||(l[h]=[]),s[e][h])if(!s[e][h][f].forced){var p=s[e][h][f],m=void 0;if("hls"===i?m=new co(p.resolvedUri,r,o):"dash"===i&&(m=new Ps(p.playlists[0],r,o,d)),p=Wa.mergeOptions({id:f,playlistLoader:m},p),cu[e](e,p.playlistLoader,t),l[h].push(p),void 0===c[f]){var g=n.addRemoteTextTrack({id:f,kind:"subtitles",default:p.default&&p.autoselect,language:p.language,label:f},!1).track;c[f]=g}}a.on("error",lu[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var n=t.tech,r=t.master.mediaGroups,i=t.mediaTypes[e],a=i.groups,o=i.tracks;for(var s in r[e])for(var u in a[s]||(a[s]=[]),r[e][s]){var l=r[e][s][u];if(l.instreamId.match(/CC\d/)&&(a[s].push(Wa.mergeOptions({id:u},l)),void 0===o[u])){var c=n.addRemoteTextTrack({id:l.instreamId,kind:"captions",default:l.default&&l.autoselect,language:l.language,label:u},!1).track;o[u]=c}}}},hu={AUDIO:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var r in n)if(n[r].enabled)return n[r];return null}},SUBTITLES:function(e,t){return function(){var n=t.mediaTypes[e].tracks;for(var r in n)if("showing"===n[r].mode||"hidden"===n[r].mode)return n[r];return null}}},fu=function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(t){du[t](t,e)}));var t=e.mediaTypes,n=e.masterPlaylistLoader,r=e.tech,i=e.hls;["AUDIO","SUBTITLES"].forEach((function(n){t[n].activeGroup=function(e,t){return function(n){var r=t.masterPlaylistLoader,i=t.mediaTypes[e].groups,a=r.media();if(!a)return null;var o=null;return a.attributes[e]&&(o=i[a.attributes[e]]),o=o||i.main,void 0===n?o:null===n?null:o.filter((function(e){return e.id===n.id}))[0]||null}}(n,e),t[n].activeTrack=hu[n](n,e),t[n].onGroupChanged=function(e,t){return function(){var n=t.segmentLoaders,r=n[e],i=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.activeGroup(o),u=a.activePlaylistLoader;su(r,a),s&&(s.playlistLoader?(r.resyncLoader(),uu(s.playlistLoader,a)):u&&i.resetEverything())}}(n,e),t[n].onTrackChanged=function(e,t){return function(){var n=t.segmentLoaders,r=n[e],i=n.main,a=t.mediaTypes[e],o=a.activeTrack(),s=a.activeGroup(o),u=a.activePlaylistLoader;su(r,a),s&&(s.playlistLoader?u!==s.playlistLoader?(r.track&&r.track(o),r.resetEverything(),uu(s.playlistLoader,a)):uu(s.playlistLoader,a):i.resetEverything())}}(n,e)}));var a=t.AUDIO.activeGroup(),o=(a.filter((function(e){return e.default}))[0]||a[0]).id;t.AUDIO.tracks[o].enabled=!0,t.AUDIO.onTrackChanged(),n.on("mediachange",(function(){["AUDIO","SUBTITLES"].forEach((function(e){return t[e].onGroupChanged()}))}));var s=function(){t.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"hls-audio-change"})};for(var u in r.audioTracks().addEventListener("change",s),r.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),i.on("dispose",(function(){r.audioTracks().removeEventListener("change",s),r.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)})),r.clearTracks("audio"),t.AUDIO.tracks)r.audioTracks().addTrack(t.AUDIO.tracks[u])},pu=void 0,mu=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],gu=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]},vu=function(e){function t(e){Qa(this,t);var n,r=$a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),i=e.url,a=e.handleManifestRedirects,o=e.withCredentials,s=e.tech,u=e.bandwidth,l=e.externHls,c=e.useCueTags,d=e.blacklistDuration,h=e.enableLowInitialPlaylist,f=e.cacheEncryptionKeys,p=e.sourceType;if(!i)throw new Error("A non-empty playlist URL is required");pu=l,r.withCredentials=o,r.tech_=s,r.hls_=s.hls,r.sourceType_=p,r.useCueTags_=c,r.blacklistDuration=d,r.enableLowInitialPlaylist=h,r.useCueTags_&&(r.cueTagsTrack_=r.tech_.addTextTrack("metadata","ad-cues"),r.cueTagsTrack_.inBandMetadataTrackDispatchType=""),r.requestOptions_={withCredentials:o,handleManifestRedirects:a,timeout:null},r.mediaTypes_=(n={},["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(e){n[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Ns,activeTrack:Ns,onGroupChanged:Ns,onTrackChanged:Ns}})),n),r.mediaSource=new Wa.MediaSource,r.mediaSource.addEventListener("sourceopen",r.handleSourceOpen_.bind(r)),r.seekable_=Wa.createTimeRanges(),r.hasPlayed_=!1,r.syncController_=new iu(e),r.segmentMetadataTrack_=s.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,r.decrypter_=new au,r.inbandTextTracks_={};var m={hls:r.hls_,mediaSource:r.mediaSource,currentTime:r.tech_.currentTime.bind(r.tech_),seekable:function(){return r.seekable()},seeking:function(){return r.tech_.seeking()},duration:function(){return r.mediaSource.duration},hasPlayed:function(){return r.hasPlayed_},goalBufferLength:function(){return r.goalBufferLength()},bandwidth:u,syncController:r.syncController_,decrypter:r.decrypter_,sourceType:r.sourceType_,inbandTextTracks:r.inbandTextTracks_,cacheEncryptionKeys:f};return r.masterPlaylistLoader_="dash"===r.sourceType_?new Ps(i,r.hls_,r.requestOptions_):new co(i,r.hls_,r.requestOptions_),r.setupMasterPlaylistLoaderListeners_(),r.mainSegmentLoader_=new Zs(Wa.mergeOptions(m,{segmentMetadataTrack:r.segmentMetadataTrack_,loaderType:"main"}),e),r.audioSegmentLoader_=new Zs(Wa.mergeOptions(m,{loaderType:"audio"}),e),r.subtitleSegmentLoader_=new eu(Wa.mergeOptions(m,{loaderType:"vtt",featuresNativeTextTracks:r.tech_.featuresNativeTextTracks}),e),r.setupSegmentLoaderListeners_(),mu.forEach((function(e){r[e+"_"]=gu.bind(r,e)})),r.logger_=Ls("MPC"),r.masterPlaylistLoader_.load(),r}return Ja(t,e),Za(t,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",(function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;xo(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,t.endList&&"none"!==e.tech_.preload()&&(e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load()),fu({sourceType:e.sourceType_,segmentLoaders:{AUDIO:e.audioSegmentLoader_,SUBTITLES:e.subtitleSegmentLoader_,main:e.mainSegmentLoader_},tech:e.tech_,requestOptions:e.requestOptions_,masterPlaylistLoader:e.masterPlaylistLoader_,hls:e.hls_,master:e.master(),mediaTypes:e.mediaTypes_,blacklistCurrentPlaylist:e.blacklistCurrentPlaylist.bind(e)}),e.triggerPresenceUsage_(e.master(),t);try{e.setupSourceBuffers_()}catch(t){return Wa.log.warn("Failed to create SourceBuffers",t),e.mediaSource.endOfStream("decode")}e.setupFirstPlay(),!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media()?e.trigger("selectedinitialmedia"):e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",(function(){e.trigger("selectedinitialmedia")}))})),this.masterPlaylistLoader_.on("loadedplaylist",(function(){var t=e.masterPlaylistLoader_.media();if(!t){e.excludeUnsupportedVariants_();var n=void 0;return e.enableLowInitialPlaylist&&(n=e.selectInitialPlaylist()),n||(n=e.selectPlaylist()),e.initialMedia_=n,void e.masterPlaylistLoader_.media(e.initialMedia_)}if(e.useCueTags_&&e.updateAdCues_(t),e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.updateDuration(),e.tech_.paused()||(e.mainSegmentLoader_.load(),e.audioSegmentLoader_&&e.audioSegmentLoader_.load()),!t.endList){var r=function(){var t=e.seekable();0!==t.length&&e.mediaSource.addSeekableRange_(t.start(0),t.end(0))};if(e.duration()!==1/0){e.tech_.one("durationchange",(function t(){e.duration()===1/0?r():e.tech_.one("durationchange",t)}))}else r()}})),this.masterPlaylistLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)})),this.masterPlaylistLoader_.on("mediachanging",(function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()})),this.masterPlaylistLoader_.on("mediachange",(function(){var t=e.masterPlaylistLoader_.media(),n=1.5*t.targetDuration*1e3;xo(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?e.requestOptions_.timeout=0:e.requestOptions_.timeout=n,e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load(),e.tech_.trigger({type:"mediachange",bubbles:!0})})),this.masterPlaylistLoader_.on("playlistunchanged",(function(){var t=e.masterPlaylistLoader_.media();e.stuckAtPlaylistEnd_(t)&&(e.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),e.tech_.trigger("playliststuck"))})),this.masterPlaylistLoader_.on("renditiondisabled",(function(){e.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})})),this.masterPlaylistLoader_.on("renditionenabled",(function(){e.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})}))}},{key:"triggerPresenceUsage_",value:function(e,t){var n=e.mediaGroups||{},r=!0,i=Object.keys(n.AUDIO);for(var a in n.AUDIO)for(var o in n.AUDIO[a]){n.AUDIO[a][o].uri||(r=!1)}r&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),pu.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),pu.Playlist.isFmp4(t)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),i.length&&Object.keys(n.AUDIO[i[0]]).length>1&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var e=this;this.mainSegmentLoader_.on("bandwidthupdate",(function(){var t=e.selectPlaylist(),n=e.masterPlaylistLoader_.media(),r=e.tech_.buffered();(function(e){var t=e.currentPlaylist,n=e.nextPlaylist,r=e.forwardBuffer,i=e.bufferLowWaterLine,a=e.duration;return e.log,n?!t.endList||a<Fs.MAX_BUFFER_LOW_WATER_LINE||n.attributes.BANDWIDTH<t.attributes.BANDWIDTH||r>=i:(Wa.log.warn("We received no playlist to switch to. Please check your stream."),!1)})({currentPlaylist:n,nextPlaylist:t,forwardBuffer:r.length?r.end(r.length-1)-e.tech_.currentTime():0,bufferLowWaterLine:e.bufferLowWaterLine(),duration:e.duration(),log:e.logger_})&&e.masterPlaylistLoader_.media(t),e.tech_.trigger("bandwidthupdate")})),this.mainSegmentLoader_.on("progress",(function(){e.trigger("progress")})),this.mainSegmentLoader_.on("error",(function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())})),this.mainSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("timestampoffset",(function(){e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})})),this.audioSegmentLoader_.on("syncinfoupdate",(function(){e.onSyncInfoUpdate_()})),this.mainSegmentLoader_.on("ended",(function(){e.onEndOfStream()})),this.mainSegmentLoader_.on("earlyabort",(function(){e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)})),this.mainSegmentLoader_.on("reseteverything",(function(){e.tech_.trigger("hls-reset")})),this.mainSegmentLoader_.on("segmenttimemapping",(function(t){e.tech_.trigger({type:"hls-segment-time-mapping",mapping:t.mapping})})),this.audioSegmentLoader_.on("ended",(function(){e.onEndOfStream()}))}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"smoothQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())}},{key:"fastQualityChange_",value:function(){var e=this,t=this.selectPlaylist();t!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.resetEverything((function(){Wa.browser.IE_VERSION||Wa.browser.IS_EDGE?e.tech_.setCurrentTime(e.tech_.currentTime()+.04):e.tech_.setCurrentTime(e.tech_.currentTime())})))}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.tech_.setCurrentTime(e.end(e.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_)return!1;if(!t.endList){var n=this.seekable();if(!n.length)return!1;if(Wa.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",(function(){e.trigger("firstplay"),e.tech_.setCurrentTime(n.end(0)),e.hasPlayed_=!0})),!1;this.trigger("firstplay"),this.tech_.setCurrentTime(n.end(0))}return this.hasPlayed_=!0,this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(e){return Wa.log.warn("Failed to create Source Buffers",e),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();void 0!==e&&"function"==typeof e.then&&e.then(null,(function(e){}))}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e){this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(e){Wa.log.warn("Failed to call media source endOfStream",e)}}}},{key:"stuckAtPlaylistEnd_",value:function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===t)return!1;var n=pu.Playlist.playlistEnd(e,t),r=this.tech_.currentTime(),i=this.tech_.buffered();if(!i.length)return n-r<=Vo;var a=i.end(i.length-1);return a-r<=Vo&&n-a<=Vo}},{key:"blacklistCurrentPlaylist",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=void 0,r=void 0;if(n=e.playlist||this.masterPlaylistLoader_.media(),t=t||e.blacklistDuration||this.blacklistDuration,!n){this.error=e;try{return this.mediaSource.endOfStream("network")}catch(e){return this.trigger("error")}}var i=1===this.masterPlaylistLoader_.master.playlists.filter(wo).length,a=this.masterPlaylistLoader_.master.playlists;return 1===a.length?(Wa.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(i)):(i&&(Wa.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."),a.forEach((function(e){e.excludeUntil!==1/0&&delete e.excludeUntil})),this.tech_.trigger("retryplaylist")),n.excludeUntil=Date.now()+1e3*t,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),r=this.selectPlaylist(),Wa.log.warn("Problem encountered with the current HLS playlist."+(e.message?" "+e.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(r,i))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=Wo(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:pu.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0;if(this.masterPlaylistLoader_){var t=this.masterPlaylistLoader_.media();if(t){var n=this.syncController_.getExpiredTime(t,this.mediaSource.duration);if(null!==n){var r=this.masterPlaylistLoader_.master.suggestedPresentationDelay,i=pu.Playlist.seekable(t,n,r);if(0!==i.length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(t=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(n=this.syncController_.getExpiredTime(t,this.mediaSource.duration)))return;if(0===(e=pu.Playlist.seekable(t,n,r)).length)return}var a=void 0,o=void 0;this.seekable_&&this.seekable_.length&&(a=this.seekable_.end(0),o=this.seekable_.start(0)),e?e.start(0)>i.end(0)||i.start(0)>e.end(0)?this.seekable_=i:this.seekable_=Wa.createTimeRanges([[e.start(0)>i.start(0)?e.start(0):i.start(0),e.end(0)<i.end(0)?e.end(0):i.end(0)]]):this.seekable_=i,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===a&&this.seekable_.start(0)===o||(this.logger_("seekable updated ["+Yo(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}}},{key:"updateDuration",value:function(){var e=this,t=this.mediaSource.duration,n=pu.Playlist.duration(this.masterPlaylistLoader_.media()),r=this.tech_.buffered(),i=function t(){e.logger_("Setting duration from "+e.mediaSource.duration+" => "+n);try{e.mediaSource.duration=n}catch(e){Wa.log.warn("Failed to set media source duration",e)}e.tech_.trigger("durationchange"),e.mediaSource.removeEventListener("sourceopen",t)};r.length>0&&(n=Math.max(n,r.end(r.length-1))),t!==n&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",i):i())}},{key:"dispose",value:function(){var e=this;this.trigger("dispose"),this.decrypter_&&this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach((function(t){var n=e.mediaTypes_[t].groups;for(var r in n)n[r].forEach((function(e){e.playlistLoader&&e.playlistLoader.dispose()}))})),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.off(),this.mediaSource.dispose&&this.mediaSource.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e,t=this.masterPlaylistLoader_.media();if(t&&"open"===this.mediaSource.readyState){if((e=fs(this.masterPlaylistLoader_.master,t)).length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+t.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(e),this.excludeIncompatibleVariants_(t)}}},{key:"configureLoaderMimeTypes_",value:function(e){var t=e.length>1&&-1===e[0].indexOf(",")&&e[0]!==e[1]?new Wa.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],t),e[1]&&this.audioSegmentLoader_.mimeType(e[1],t)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach((function(e){var t;e.attributes.CODECS&&i.a.MediaSource&&i.a.MediaSource.isTypeSupported&&!i.a.MediaSource.isTypeSupported('video/mp4; codecs="'+(t=e.attributes.CODECS,t.replace(/avc1\.(\d+)\.(\d+)/i,(function(e){return cs([e])[0]}))+'"'))&&(e.excludeUntil=1/0)}))}},{key:"excludeIncompatibleVariants_",value:function(e){var t=2,n=null,r=void 0;e.attributes.CODECS&&(r=ds(e.attributes.CODECS),n=r.videoCodec,t=r.codecCount),this.master().playlists.forEach((function(e){var r={codecCount:2,videoCodec:null};e.attributes.CODECS&&(r=ds(e.attributes.CODECS)),r.codecCount!==t&&(e.excludeUntil=1/0),r.videoCodec!==n&&(e.excludeUntil=1/0)}))}},{key:"updateAdCues_",value:function(e){var t=0,n=this.seekable();n.length&&(t=n.start(0)),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e.segments)for(var r=n,a=void 0,o=0;o<e.segments.length;o++){var s=e.segments[o];if(a||(a=tu(t,r+s.duration/2)),a){if("cueIn"in s){a.endTime=r,a.adEndTime=r,r+=s.duration,a=null;continue}if(r<a.endTime){r+=s.duration;continue}a.endTime+=s.duration}else if("cueOut"in s&&((a=new i.a.VTTCue(r,r+s.duration,s.cueOut)).adStartTime=r,a.adEndTime=r+parseFloat(s.cueOut),t.addCue(a)),"cueOutCont"in s){var u=void 0,l=void 0,c=s.cueOutCont.split("/").map(parseFloat),d=eo(c,2);u=d[0],l=d[1],(a=new i.a.VTTCue(r,r+s.duration,"")).adStartTime=r-u,a.adEndTime=a.adStartTime+l,t.addCue(a)}r+=s.duration}}(e,this.cueTagsTrack_,t)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=Fs.GOAL_BUFFER_LENGTH,n=Fs.GOAL_BUFFER_LENGTH_RATE,r=Math.max(t,Fs.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*n,r)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=Fs.BUFFER_LOW_WATER_LINE,n=Fs.BUFFER_LOW_WATER_LINE_RATE,r=Math.max(t,Fs.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*n,r)}}]),t}(Wa.EventTarget),yu=function e(t,n,r){Qa(this,e);var i,a,o,s=t.masterPlaylistController_,u=s[(t.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(s);if(n.attributes.RESOLUTION){var l=n.attributes.RESOLUTION;this.width=l.width,this.height=l.height}this.bandwidth=n.attributes.BANDWIDTH,this.id=r,this.enabled=(i=t.playlists,a=n.id,o=u,function(e){var t=i.master.playlists[a],n=So(t),r=wo(t);return void 0===e?r:(e?delete t.disabled:t.disabled=!0,e===r||n||(o(),e?i.trigger("renditionenabled"):i.trigger("renditiondisabled")),e)})},_u=["seeking","seeked","pause","playing","error"],bu=function(){function e(t){var n=this;Qa(this,e),this.tech_=t.tech,this.seekable=t.seekable,this.allowSeeksWithinUnsafeLiveWindow=t.allowSeeksWithinUnsafeLiveWindow,this.media=t.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Ls("PlaybackWatcher"),this.logger_("initialize");var r=function(){return n.monitorCurrentTime_()},a=function(){return n.techWaiting_()},o=function(){return n.cancelTimer_()},s=function(){return n.fixesBadSeeks_()};this.tech_.on("seekablechanged",s),this.tech_.on("waiting",a),this.tech_.on(_u,o),this.tech_.on("canplay",r),this.dispose=function(){n.logger_("dispose"),n.tech_.off("seekablechanged",s),n.tech_.off("waiting",a),n.tech_.off(_u,o),n.tech_.off("canplay",r),n.checkCurrentTimeTimeout_&&i.a.clearTimeout(n.checkCurrentTimeTimeout_),n.cancelTimer_()}}return Za(e,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&i.a.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=i.a.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+Vo>=t.end(t.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){if(!this.tech_.seeking())return!1;var e=this.seekable(),t=this.tech_.currentTime(),n=void 0;this.afterSeekableWindow_(e,t,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(n=e.end(e.length-1));this.beforeSeekableWindow_(e,t)&&(n=e.start(0)+Vo);return void 0!==n&&(this.logger_("Trying to seek outside of seekable at time "+t+" with seekable range "+Yo(e)+". Seeking to "+n+"."),this.tech_.setCurrentTime(n),!0)}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=this.tech_.buffered(),n=Wo(t,e);return n.length&&e+3<=n.end(0)?(this.cancelTimer_(),this.tech_.setCurrentTime(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+n.start(0)+" -> "+n.end(0)+"]. Attempting to resume playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var n=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+n),this.cancelTimer_(),this.tech_.setCurrentTime(n),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var r=this.tech_.buffered(),i=qo(r,t);if(this.videoUnderflow_(i,r,t))return this.cancelTimer_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(i.length>0){var a=i.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+a+", seeking to "+i.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*a,t),!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e.length)return!1;var i=e.end(e.length-1)+Vo,a=!n.endList;return a&&r&&(i=e.end(e.length-1)+3*n.targetDuration),t>i}},{key:"beforeSeekableWindow_",value:function(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-Vo)}},{key:"videoUnderflow_",value:function(e,t,n){if(0===e.length){var r=this.gapFromVideoUnderflow_(t,n);if(r)return this.logger_("Encountered a gap in video from "+r.start+" to "+r.end+". Seeking to current time "+n),!0}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),n=this.tech_.currentTime(),r=qo(t,n);this.cancelTimer_(),0!==r.length&&n===e&&(this.logger_("skipTheGap_:","currentTime:",n,"scheduled currentTime:",e,"nextRange start:",r.start(0)),this.tech_.setCurrentTime(r.start(0)+Ho),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var n=function(e){if(e.length<2)return Wa.createTimeRanges();for(var t=[],n=1;n<e.length;n++){var r=e.end(n-1),i=e.start(n);t.push([r,i])}return Wa.createTimeRanges(t)}(e),r=0;r<n.length;r++){var i=n.start(r),a=n.end(r);if(t-i<4&&t-i>2)return{start:i,end:a}}return null}}]),e}(),Eu={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_)}},Tu=function(e){!function e(t,n){var r=0,i=0,a=Wa.mergeOptions(Eu,n);t.ready((function(){t.trigger({type:"usage",name:"hls-error-reload-initialized"})}));var o=function(){i&&t.currentTime(i)},s=function(e){null!=e&&(i=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",o),t.src(e),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())},u=function(){if(Date.now()-r<1e3*a.errorInterval)t.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(a.getSource&&"function"==typeof a.getSource)return r=Date.now(),a.getSource.call(t,s);Wa.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}},l=function e(){t.off("loadedmetadata",o),t.off("error",u),t.off("dispose",e)};t.on("error",u),t.on("dispose",l),t.reloadSourceOnError=function(n){l(),e(t,n)}}(this,e)},Su={PlaylistLoader:co,Playlist:Mo,Decrypter:He,AsyncStream:Ue,decrypt:Ge,utils:Uo,STANDARD_PLAYLIST_SELECTOR:function(){var e=this.useDevicePixelRatio&&i.a.devicePixelRatio||1;return function(e,t,n,r,a){var o=e.playlists.map((function(e){var t,n;return t=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,n=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height,{bandwidth:e.attributes.BANDWIDTH||i.a.Number.MAX_VALUE,width:t,height:n,playlist:e}}));Ys(o,(function(e,t){return e.bandwidth-t.bandwidth}));var s=(o=o.filter((function(e){return!Mo.isIncompatible(e.playlist)}))).filter((function(e){return Mo.isEnabled(e.playlist)}));s.length||(s=o.filter((function(e){return!Mo.isDisabled(e.playlist)})));var u=s.filter((function(e){return e.bandwidth*Fs.BANDWIDTH_VARIANCE<t})),l=u[u.length-1],c=u.filter((function(e){return e.bandwidth===l.bandwidth}))[0];if(!1===a){var d=c||s[0]||o[0];return d?d.playlist:null}var h=u.filter((function(e){return e.width&&e.height}));Ys(h,(function(e,t){return e.width-t.width}));var f=h.filter((function(e){return e.width===n&&e.height===r}));l=f[f.length-1];var p=f.filter((function(e){return e.bandwidth===l.bandwidth}))[0],m=void 0,g=void 0,v=void 0;p||(g=(m=h.filter((function(e){return e.width>n||e.height>r}))).filter((function(e){return e.width===m[0].width&&e.height===m[0].height})),l=g[g.length-1],v=g.filter((function(e){return e.bandwidth===l.bandwidth}))[0]);var y=v||p||c||s[0]||o[0];return y?y.playlist:null}(this.playlists.master,this.systemBandwidth,parseInt(qs(this.tech_.el(),"width"),10)*e,parseInt(qs(this.tech_.el(),"height"),10)*e,this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var e=this.playlists.master.playlists.filter(Mo.isEnabled);return Ys(e,(function(e,t){return Ks(e,t)})),e.filter((function(e){return ds(e.attributes.CODECS).videoCodec}))[0]||null},comparePlaylistBandwidth:Ks,comparePlaylistResolution:function(e,t){var n=void 0,r=void 0;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(n=e.attributes.RESOLUTION.width),n=n||i.a.Number.MAX_VALUE,t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(r=t.attributes.RESOLUTION.width),n===(r=r||i.a.Number.MAX_VALUE)&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:n-r},xhr:Io()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach((function(e){Object.defineProperty(Su,e,{get:function(){return Wa.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),Fs[e]},set:function(t){Wa.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),"number"!=typeof t||t<0?Wa.log.warn("value of Hls."+e+" must be greater than or equal to 0"):Fs[e]=t}})}));var wu="videojs-vhs",Au=function(e){if(/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e))return"hls";return/^application\/dash\+xml/i.test(e)?"dash":null},xu=function(e,t){for(var n=t.media(),r=-1,i=0;i<e.length;i++)if(e[i].id===n.id){r=i;break}e.selectedIndex_=r,e.trigger({selectedIndex:r,type:"change"})};Su.canPlaySource=function(){return Wa.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Mu=function(e){var t=e.masterPlaylistController_.mainSegmentLoader_,n=e.masterPlaylistController_.audioSegmentLoader_,r=Wa.players[e.tech_.options_.playerId];if(r.eme){var i=function(e,t,n){if(!e)return e;var r=void 0,i=void 0;if(n.mimeType_)r=t.mimeType_,i=n.mimeType_;else{var a=ps(t.mimeType_),o=a.parameters.codecs.split(","),s=void 0,u=void 0;o.forEach((function(e){e=e.trim(),ms(e)?s=e:gs(e)&&(u=e)})),r=a.type+'; codecs="'+u+'"',i=a.type.replace("video","audio")+'; codecs="'+s+'"'}var l={},c=t.playlist_;for(var d in e)l[d]={audioContentType:i,videoContentType:r},c.contentProtection&&c.contentProtection[d]&&c.contentProtection[d].pssh&&(l[d].pssh=c.contentProtection[d].pssh),"string"==typeof e[d]&&(l[d].url=e[d]);return Wa.mergeOptions(e,l)}(e.source_.keySystems,t,n);i&&(r.currentSource().keySystems=i,11!==Wa.browser.IE_VERSION&&r.eme.initializeMediaKeys&&r.eme.initializeMediaKeys())}},Cu=function(){if(!window.localStorage)return null;var e=window.localStorage.getItem(wu);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}};Su.supportsNativeHls=function(){var e=o.a.createElement("video");if(!Wa.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some((function(t){return/maybe|probably/i.test(e.canPlayType(t))}))}(),Su.supportsNativeDash=!!Wa.getTech("Html5").isSupported()&&/maybe|probably/i.test(o.a.createElement("video").canPlayType("application/dash+xml")),Su.supportsTypeNatively=function(e){return"hls"===e?Su.supportsNativeHls:"dash"===e&&Su.supportsNativeDash},Su.isSupported=function(){return Wa.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var Ru=function(e){function t(e,n,r){Qa(this,t);var i=$a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,r.hls));if(n.options_&&n.options_.playerId){var a=Wa(n.options_.playerId);a.hasOwnProperty("hls")||Object.defineProperty(a,"hls",{get:function(){return Wa.log.warn("player.hls is deprecated. Use player.tech().hls instead."),n.trigger({type:"usage",name:"hls-player-access"}),i},configurable:!0}),a.vhs=i,a.dash=i,i.player_=a}if(i.tech_=n,i.source_=e,i.stats={},i.ignoreNextSeekingEvent_=!1,i.setOptions_(),i.options_.overrideNative&&n.overrideNativeAudioTracks&&n.overrideNativeVideoTracks)n.overrideNativeAudioTracks(!0),n.overrideNativeVideoTracks(!0);else if(i.options_.overrideNative&&(n.featuresNativeVideoTracks||n.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return i.on(o.a,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],(function(e){var t=o.a.fullscreenElement||o.a.webkitFullscreenElement||o.a.mozFullScreenElement||o.a.msFullscreenElement;t&&t.contains(i.tech_.el())&&i.masterPlaylistController_.smoothQualityChange_()})),i.on(i.tech_,"seeking",(function(){this.ignoreNextSeekingEvent_?this.ignoreNextSeekingEvent_=!1:this.setCurrentTime(this.tech_.currentTime())})),i.on(i.tech_,"error",(function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()})),i.on(i.tech_,"play",i.play),i}return Ja(t,e),Za(t,[{key:"setOptions_",value:function(){var e=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var t=Cu();t&&t.bandwidth&&(this.options_.bandwidth=t.bandwidth,this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),t&&t.throughput&&(this.options_.throughput=t.throughput,this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=Fs.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Fs.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys"].forEach((function(t){void 0!==e.source_[t]&&(e.options_[t]=e.source_[t])})),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio}},{key:"src",value:function(e,t){var n=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=Su,this.options_.sourceType=Au(t),this.options_.seekTo=function(e){n.tech_.setCurrentTime(e)},this.masterPlaylistController_=new vu(this.options_),this.playbackWatcher_=new bu(Wa.mergeOptions(this.options_,{seekable:function(){return n.seekable()},media:function(){return n.masterPlaylistController_.media()}})),this.masterPlaylistController_.on("error",(function(){Wa.players[n.tech_.options_.playerId].error(n.masterPlaylistController_.error)})),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):Su.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=Su.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e=1/(this.bandwidth||1),t=void 0;return t=this.throughput>0?1/this.throughput:0,Math.floor(1/(e+t))},set:function(){Wa.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return n.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return n.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return n.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return n.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return n.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return n.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return n.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return n.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return Ko(n.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return n.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return n.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return n.tech_.name_},enumerable:!0},duration:{get:function(){return n.tech_.duration()},enumerable:!0},master:{get:function(){return n.playlists.master},enumerable:!0},playerDimensions:{get:function(){return n.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Ko(n.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return n.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",(function(){n.options_.useBandwidthFromLocalStorage&&function(e){if(!window.localStorage)return!1;var t=Cu();t=t?Wa.mergeOptions(t,e):e;try{window.localStorage.setItem(wu,JSON.stringify(t))}catch(e){return!1}}({bandwidth:n.bandwidth,throughput:Math.round(n.throughput)})})),this.masterPlaylistController_.on("selectedinitialmedia",(function(){var e,t;t=(e=n).playlists,e.representations=function(){return t&&t.master&&t.master.playlists?t.master.playlists.filter((function(e){return!So(e)})).map((function(t,n){return new yu(e,t,t.id)})):[]},Mu(n)})),this.on(this.masterPlaylistController_,"progress",(function(){this.tech_.trigger("progress")})),this.on(this.masterPlaylistController_,"firstplay",(function(){this.ignoreNextSeekingEvent_=!0})),this.setupQualityLevels_(),this.tech_.el()&&this.tech_.src(Wa.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var e=this,t=Wa.players[this.tech_.options_.playerId];t&&t.qualityLevels&&!this.qualityLevels_&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",(function(){var t,n;t=e.qualityLevels_,(n=e).representations().forEach((function(e){t.addQualityLevel(e)})),xu(t,n.playlists)})),this.playlists.on("mediachange",(function(){xu(e.qualityLevels_,e.playlists)})))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.hls&&delete this.tech_.hls,function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(e,t){return jo({playlist:this.masterPlaylistController_.media(),time:e,callback:t})}},{key:"seekToProgramTime",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;return Go({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:r,pauseAfterSeek:n,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}]),t}(Wa.getComponent("Component")),Iu={name:"videojs-http-streaming",VERSION:"1.13.2",canHandleSource:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Wa.mergeOptions(Wa.options,t);return Iu.canPlayType(e.type,n)},handleSource:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Wa.mergeOptions(Wa.options,n);return t.hls=new Ru(e,t,r),t.hls.xhr=Io(),t.hls.src(e.src,e.type),t.hls},canPlayType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Wa.mergeOptions(Wa.options,t),r=n.hls.overrideNative,i=Au(e),a=i&&(!Su.supportsTypeNatively(i)||r);return a?"maybe":""}};void 0!==Wa.MediaSource&&void 0!==Wa.URL||(Wa.MediaSource=ws,Wa.URL=As),ws.supportsNativeMediaSources()&&Wa.getTech("Html5").registerSourceHandler(Iu,0),Wa.HlsHandler=Ru,Wa.HlsSourceHandler=Iu,Wa.Hls=Su,Wa.use||Wa.registerComponent("Hls",Su),Wa.options.hls=Wa.options.hls||{},Wa.registerPlugin?Wa.registerPlugin("reloadSourceOnError",Tu):Wa.plugin("reloadSourceOnError",Tu);t.a=Wa},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return h})),n.d(t,"k",(function(){return f}));const r=new WeakSet,i=new WeakMap,a=new WeakMap,o=new WeakMap,s=new WeakMap,u=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap},function(e,t){function n(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return o[e];var n,a=String(e);return(n=r[a.toLowerCase()])?n:(n=i[a.toLowerCase()])||(1===a.length?a.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"==typeof e){var n=e.which||e.keyCode||e.charCode;if(null==n)return!1;if("string"==typeof t){var a;if(a=r[t.toLowerCase()])return a===n;if(a=i[t.toLowerCase()])return a===n}else if("number"==typeof t)return t===n;return!1}};var r=(t=e.exports=n).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=t.aliases={windows:91,"":16,"":18,"":17,"":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(a=97;a<123;a++)r[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)r[a-48]=a;for(a=1;a<13;a++)r["f"+a]=a+111;for(a=0;a<10;a++)r["numpad "+a]=a+96;var o=t.names=t.title={};for(a in r)o[r[a]]=a;for(var s in i)r[s]=i[s]},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer"}}]),e}());t.default=i},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(20);const i=(e,t)=>{Object(r.a)(e,t,"channelCount"),Object(r.a)(e,t,"channelCountMode"),Object(r.a)(e,t,"channelInterpretation")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.IMAGE="image",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.UTF8="utf-8",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)"}}]),e}());t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e={};function t(t,n,r){var i=-1;return e[t]?(e[t].some((function(e,t){if(e&&e.callback===n&&(!r||r===e.scope))return i=t,!0})),i):i}return{on:function(n,r,i){var a=arguments.length<=3||void 0===arguments[3]?0:arguments[3];if(!n)throw new Error("event type cannot be null or undefined");if(!r||"function"!=typeof r)throw new Error("listener must be a function: "+r);if(!(t(n,r,i)>=0)){e[n]=e[n]||[];var o={callback:r,scope:i,priority:a},s=e[n].some((function(t,r){if(t&&a>t.priority)return e[n].splice(r,0,o),!0}));s||e[n].push(o)}},off:function(n,r,i){if(n&&r&&e[n]){var a=t(n,r,i);a<0||(e[n][a]=null)}},trigger:function(t,n){if(t&&e[t]){if((n=n||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");n.type=t,e[t]=e[t].filter((function(e){return e})),e[t].forEach((function(e){return e&&e.callback.call(e.scope,n)}))}},reset:function(){e={}}}}o.__dashjs_factory_name="EventBus";var s=a.default.getSingletonFactory(o);s.EVENT_PRIORITY_LOW=0,s.EVENT_PRIORITY_HIGH=5e3,a.default.updateSingletonFactory(o.__dashjs_factory_name,s),t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(12)),a=r(n(14)),o=r(n(3)),s=1,u=2,l=3,c=4,d=5;function h(){var e,t=this.context,n=(0,i.default)(t).getInstance(),r=[],o=void 0,h=void 0,f=void 0,p=void 0;function m(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function g(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];E.apply(void 0,[s,this].concat(t))}function v(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];E.apply(void 0,[u,this].concat(t))}function y(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];E.apply(void 0,[l,this].concat(t))}function _(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];E.apply(void 0,[c,this].concat(t))}function b(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];E.apply(void 0,[d,this].concat(t))}function E(e,t){var i="",s=null;o&&(s=(new Date).getTime(),i+="["+(s-f)+"]"),h&&t&&t.getClassName&&(i+="["+t.getClassName()+"]",t.getType&&(i+="["+t.getType()+"]")),i.length>0&&(i+=" ");for(var u=arguments.length,l=Array(u>2?u-2:0),c=2;c<u;c++)l[c-2]=arguments[c];Array.apply(null,l).forEach((function(e){i+=e+" "})),r[e]&&p>=e&&r[e](i),n.trigger(a.default.LOG,{message:i,level:e})}return e={getLogger:function(e){return{fatal:g.bind(e),error:v.bind(e),warn:y.bind(e),info:_.bind(e),debug:b.bind(e)}},setLogTimestampVisible:function(e){o=e},setCalleeNameVisible:function(e){h=e},setLogToBrowserConsole:function(e){p=e?d:0},getLogToBrowserConsole:function(){return 0!==p},setLogLevel:function(e){p=e},getLogLevel:function(){return p}},o=!0,h=!0,p=l,f=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(r[s]=m(window.console.error),r[u]=m(window.console.error),r[l]=m(window.console.warn),r[c]=m(window.console.info),r[d]=m(window.console.debug)),e}h.__dashjs_factory_name="Debug";var f=o.default.getSingletonFactory(h);f.LOG_LEVEL_NONE=0,f.LOG_LEVEL_FATAL=s,f.LOG_LEVEL_ERROR=u,f.LOG_LEVEL_WARNING=l,f.LOG_LEVEL_INFO=c,f.LOG_LEVEL_DEBUG=d,o.default.updateSingletonFactory(h.__dashjs_factory_name,f),t.default=f,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}};function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a,o=n(1054),s=new(function(e){function t(){i(this,t),r(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((a=o)&&a.__esModule?a:{default:a}).default));t.default=s,e.exports=t.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r=-34028234663852886e22,i=-r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e={};function t(t,n,r){var i=-1;return e[t]?(e[t].some((function(e,t){if(e&&e.callback===n&&(!r||r===e.scope))return i=t,!0})),i):i}return{on:function(n,r,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!n)throw new Error("event type cannot be null or undefined");if(!r||"function"!=typeof r)throw new Error("listener must be a function: "+r);if(!(t(n,r,i)>=0)){e[n]=e[n]||[];var o={callback:r,scope:i,priority:a},s=e[n].some((function(t,r){if(t&&a>t.priority)return e[n].splice(r,0,o),!0}));s||e[n].push(o)}},off:function(n,r,i){if(n&&r&&e[n]){var a=t(n,r,i);a<0||(e[n][a]=null)}},trigger:function(t,n){if(t&&e[t]){if((n=n||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");n.type=t,e[t]=e[t].filter((function(e){return e})),e[t].forEach((function(e){return e&&e.callback.call(e.scope,n)}))}},reset:function(){e={}}}}o.__dashjs_factory_name="EventBus";var s=a.default.getSingletonFactory(o);s.EVENT_PRIORITY_LOW=0,s.EVENT_PRIORITY_HIGH=5e3,a.default.updateSingletonFactory(o.__dashjs_factory_name,s),t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(16)),i=o(n(18)),a=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}var s=1,u=2,l=3,c=4,d=5;function h(e){e=e||{};var t,n=this.context,a=(0,r.default)(n).getInstance(),o=e.settings,h=[],f=void 0,p=void 0,m=void 0;function g(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function v(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[s,this].concat(t))}function y(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[u,this].concat(t))}function _(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[l,this].concat(t))}function b(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[c,this].concat(t))}function E(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[d,this].concat(t))}function T(e,t){var n="",r=null;f&&(r=(new Date).getTime(),n+="["+(r-m)+"]"),p&&t&&t.getClassName&&(n+="["+t.getClassName()+"]",t.getType&&(n+="["+t.getType()+"]")),n.length>0&&(n+=" ");for(var s=arguments.length,u=Array(s>2?s-2:0),l=2;l<s;l++)u[l-2]=arguments[l];Array.apply(null,u).forEach((function(e){n+=e+" "})),h[e]&&o.get().debug.logLevel>=e&&h[e](n),a.trigger(i.default.LOG,{message:n,level:e})}return t={getLogger:function(e){return{fatal:v.bind(e),error:y.bind(e),warn:_.bind(e),info:b.bind(e),debug:E.bind(e)}},setLogTimestampVisible:function(e){f=e},setCalleeNameVisible:function(e){p=e}},f=!0,p=!0,m=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(h[s]=g(window.console.error),h[u]=g(window.console.error),h[l]=g(window.console.warn),h[c]=g(window.console.info),h[d]=g(window.console.debug)),t}h.__dashjs_factory_name="Debug";var f=a.default.getSingletonFactory(h);f.LOG_LEVEL_NONE=0,f.LOG_LEVEL_FATAL=s,f.LOG_LEVEL_ERROR=u,f.LOG_LEVEL_WARNING=l,f.LOG_LEVEL_INFO=c,f.LOG_LEVEL_DEBUG=d,a.default.updateSingletonFactory(h.__dashjs_factory_name,f),t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(879);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var s=new(function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=s},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>e.context===t},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n)=>{const r=t[n];void 0!==r&&r!==e[n]&&(e[n]=r)}},function(e,t,n){"use strict";n.r(t),n.d(t,"ACESFilmicToneMapping",(function(){return ne})),n.d(t,"AddEquation",(function(){return A})),n.d(t,"AddOperation",(function(){return Z})),n.d(t,"AdditiveAnimationBlendMode",(function(){return qt})),n.d(t,"AdditiveBlending",(function(){return E})),n.d(t,"AlphaFormat",(function(){return ke})),n.d(t,"AlwaysDepth",(function(){return H})),n.d(t,"AlwaysStencilFunc",(function(){return wn})),n.d(t,"AmbientLight",(function(){return bd})),n.d(t,"AmbientLightProbe",(function(){return Vd})),n.d(t,"AnimationClip",(function(){return Mc})),n.d(t,"AnimationLoader",(function(){return Nc})),n.d(t,"AnimationMixer",(function(){return Eh})),n.d(t,"AnimationObjectGroup",(function(){return _h})),n.d(t,"AnimationUtils",(function(){return pc})),n.d(t,"ArcCurve",(function(){return Vc})),n.d(t,"ArrayCamera",(function(){return Ds})),n.d(t,"ArrowHelper",(function(){return cf})),n.d(t,"Audio",(function(){return $d})),n.d(t,"AudioAnalyser",(function(){return ah})),n.d(t,"AudioContext",(function(){return jd})),n.d(t,"AudioListener",(function(){return Jd})),n.d(t,"AudioLoader",(function(){return Gd})),n.d(t,"AxesHelper",(function(){return df})),n.d(t,"AxisHelper",(function(){return sp})),n.d(t,"BackSide",(function(){return m})),n.d(t,"BasicDepthPacking",(function(){return an})),n.d(t,"BasicShadowMap",(function(){return c})),n.d(t,"BinaryTextureLoader",(function(){return hp})),n.d(t,"Bone",(function(){return fu})),n.d(t,"BooleanKeyframeTrack",(function(){return bc})),n.d(t,"BoundingBoxHelper",(function(){return up})),n.d(t,"Box2",(function(){return Ih})),n.d(t,"Box3",(function(){return Fr})),n.d(t,"Box3Helper",(function(){return af})),n.d(t,"BoxBufferGeometry",(function(){return ma})),n.d(t,"BoxGeometry",(function(){return pa})),n.d(t,"BoxHelper",(function(){return rf})),n.d(t,"BufferAttribute",(function(){return Si})),n.d(t,"BufferGeometry",(function(){return Hi})),n.d(t,"BufferGeometryLoader",(function(){return Cd})),n.d(t,"ByteType",(function(){return Ae})),n.d(t,"Cache",(function(){return Rc})),n.d(t,"Camera",(function(){return ba})),n.d(t,"CameraHelper",(function(){return ef})),n.d(t,"CanvasRenderer",(function(){return mp})),n.d(t,"CanvasTexture",(function(){return Uu})),n.d(t,"CatmullRomCurve3",(function(){return Xc})),n.d(t,"CineonToneMapping",(function(){return te})),n.d(t,"CircleBufferGeometry",(function(){return tc})),n.d(t,"CircleGeometry",(function(){return ec})),n.d(t,"ClampToEdgeWrapping",(function(){return he})),n.d(t,"Clock",(function(){return Yd})),n.d(t,"ClosedSplineCurve3",(function(){return ip})),n.d(t,"Color",(function(){return fi})),n.d(t,"ColorKeyframeTrack",(function(){return Ec})),n.d(t,"CompressedTexture",(function(){return Bu})),n.d(t,"CompressedTextureLoader",(function(){return kc})),n.d(t,"ConeBufferGeometry",(function(){return $l})),n.d(t,"ConeGeometry",(function(){return Jl})),n.d(t,"CubeCamera",(function(){return Sa})),n.d(t,"CubeGeometry",(function(){return pa})),n.d(t,"CubeReflectionMapping",(function(){return ae})),n.d(t,"CubeRefractionMapping",(function(){return oe})),n.d(t,"CubeTexture",(function(){return Xa})),n.d(t,"CubeTextureLoader",(function(){return Uc})),n.d(t,"CubeUVReflectionMapping",(function(){return le})),n.d(t,"CubeUVRefractionMapping",(function(){return ce})),n.d(t,"CubicBezierCurve",(function(){return $c})),n.d(t,"CubicBezierCurve3",(function(){return ed})),n.d(t,"CubicInterpolant",(function(){return gc})),n.d(t,"CullFaceBack",(function(){return s})),n.d(t,"CullFaceFront",(function(){return u})),n.d(t,"CullFaceFrontBack",(function(){return l})),n.d(t,"CullFaceNone",(function(){return o})),n.d(t,"Curve",(function(){return Gc})),n.d(t,"CurvePath",(function(){return sd})),n.d(t,"CustomBlending",(function(){return w})),n.d(t,"CustomToneMapping",(function(){return re})),n.d(t,"CylinderBufferGeometry",(function(){return Zl})),n.d(t,"CylinderGeometry",(function(){return Ql})),n.d(t,"Cylindrical",(function(){return Ch})),n.d(t,"DataTexture",(function(){return Aa})),n.d(t,"DataTexture2DArray",(function(){return Qa})),n.d(t,"DataTexture3D",(function(){return Za})),n.d(t,"DataTextureLoader",(function(){return Fc})),n.d(t,"DecrementStencilOp",(function(){return fn})),n.d(t,"DecrementWrapStencilOp",(function(){return mn})),n.d(t,"DefaultLoadingManager",(function(){return Oc})),n.d(t,"DepthFormat",(function(){return He})),n.d(t,"DepthStencilFormat",(function(){return Ve})),n.d(t,"DepthTexture",(function(){return ju})),n.d(t,"DirectionalLight",(function(){return _d})),n.d(t,"DirectionalLightHelper",(function(){return Zh})),n.d(t,"DirectionalLightShadow",(function(){return yd})),n.d(t,"DiscreteInterpolant",(function(){return yc})),n.d(t,"DodecahedronBufferGeometry",(function(){return $u})),n.d(t,"DodecahedronGeometry",(function(){return Ju})),n.d(t,"DoubleSide",(function(){return g})),n.d(t,"DstAlphaFactor",(function(){return k})),n.d(t,"DstColorFactor",(function(){return B})),n.d(t,"DynamicBufferAttribute",(function(){return Kf})),n.d(t,"DynamicCopyUsage",(function(){return Dn})),n.d(t,"DynamicDrawUsage",(function(){return xn})),n.d(t,"DynamicReadUsage",(function(){return Rn})),n.d(t,"EdgesGeometry",(function(){return Xl})),n.d(t,"EdgesHelper",(function(){return lp})),n.d(t,"EllipseCurve",(function(){return Hc})),n.d(t,"EqualDepth",(function(){return W})),n.d(t,"EqualStencilFunc",(function(){return _n})),n.d(t,"EquirectangularReflectionMapping",(function(){return se})),n.d(t,"EquirectangularRefractionMapping",(function(){return ue})),n.d(t,"Euler",(function(){return sr})),n.d(t,"EventDispatcher",(function(){return Ln})),n.d(t,"ExtrudeBufferGeometry",(function(){return Nl})),n.d(t,"ExtrudeGeometry",(function(){return Ll})),n.d(t,"Face3",(function(){return vi})),n.d(t,"Face4",(function(){return Pf})),n.d(t,"FaceColors",(function(){return Ff})),n.d(t,"FileLoader",(function(){return Lc})),n.d(t,"FlatShading",(function(){return v})),n.d(t,"Float32Attribute",(function(){return np})),n.d(t,"Float32BufferAttribute",(function(){return Oi})),n.d(t,"Float64Attribute",(function(){return rp})),n.d(t,"Float64BufferAttribute",(function(){return Di})),n.d(t,"FloatType",(function(){return Ie})),n.d(t,"Fog",(function(){return js})),n.d(t,"FogExp2",(function(){return Us})),n.d(t,"Font",(function(){return kd})),n.d(t,"FontLoader",(function(){return Bd})),n.d(t,"FrontSide",(function(){return p})),n.d(t,"Frustum",(function(){return Ca})),n.d(t,"GammaEncoding",(function(){return Jt})),n.d(t,"Geometry",(function(){return fa})),n.d(t,"GeometryUtils",(function(){return pp})),n.d(t,"GreaterDepth",(function(){return Y})),n.d(t,"GreaterEqualDepth",(function(){return q})),n.d(t,"GreaterEqualStencilFunc",(function(){return Sn})),n.d(t,"GreaterStencilFunc",(function(){return En})),n.d(t,"GridHelper",(function(){return qh})),n.d(t,"Group",(function(){return Ps})),n.d(t,"HalfFloatType",(function(){return Oe})),n.d(t,"HemisphereLight",(function(){return dd})),n.d(t,"HemisphereLightHelper",(function(){return Wh})),n.d(t,"HemisphereLightProbe",(function(){return Hd})),n.d(t,"IcosahedronBufferGeometry",(function(){return Zu})),n.d(t,"IcosahedronGeometry",(function(){return Qu})),n.d(t,"ImageBitmapLoader",(function(){return Ld})),n.d(t,"ImageLoader",(function(){return Bc})),n.d(t,"ImageUtils",(function(){return Gn})),n.d(t,"ImmediateRenderObject",(function(){return Lh})),n.d(t,"IncrementStencilOp",(function(){return hn})),n.d(t,"IncrementWrapStencilOp",(function(){return pn})),n.d(t,"InstancedBufferAttribute",(function(){return Md})),n.d(t,"InstancedBufferGeometry",(function(){return xd})),n.d(t,"InstancedInterleavedBuffer",(function(){return Sh})),n.d(t,"InstancedMesh",(function(){return yu})),n.d(t,"Int16Attribute",(function(){return Jf})),n.d(t,"Int16BufferAttribute",(function(){return Mi})),n.d(t,"Int32Attribute",(function(){return ep})),n.d(t,"Int32BufferAttribute",(function(){return Ri})),n.d(t,"Int8Attribute",(function(){return Xf})),n.d(t,"Int8BufferAttribute",(function(){return wi})),n.d(t,"IntType",(function(){return Ce})),n.d(t,"InterleavedBuffer",(function(){return Gs})),n.d(t,"InterleavedBufferAttribute",(function(){return Vs})),n.d(t,"Interpolant",(function(){return mc})),n.d(t,"InterpolateDiscrete",(function(){return Ut})),n.d(t,"InterpolateLinear",(function(){return jt})),n.d(t,"InterpolateSmooth",(function(){return Gt})),n.d(t,"InvertStencilOp",(function(){return gn})),n.d(t,"JSONLoader",(function(){return gp})),n.d(t,"KeepStencilOp",(function(){return cn})),n.d(t,"KeyframeTrack",(function(){return _c})),n.d(t,"LOD",(function(){return uu})),n.d(t,"LatheBufferGeometry",(function(){return Wl})),n.d(t,"LatheGeometry",(function(){return zl})),n.d(t,"Layers",(function(){return ur})),n.d(t,"LensFlare",(function(){return yp})),n.d(t,"LessDepth",(function(){return V})),n.d(t,"LessEqualDepth",(function(){return z})),n.d(t,"LessEqualStencilFunc",(function(){return bn})),n.d(t,"LessStencilFunc",(function(){return yn})),n.d(t,"Light",(function(){return cd})),n.d(t,"LightProbe",(function(){return Sd})),n.d(t,"LightShadow",(function(){return hd})),n.d(t,"Line",(function(){return Au})),n.d(t,"Line3",(function(){return Ph})),n.d(t,"LineBasicMaterial",(function(){return _u})),n.d(t,"LineCurve",(function(){return td})),n.d(t,"LineCurve3",(function(){return nd})),n.d(t,"LineDashedMaterial",(function(){return hc})),n.d(t,"LineLoop",(function(){return Ru})),n.d(t,"LinePieces",(function(){return Nf})),n.d(t,"LineSegments",(function(){return Cu})),n.d(t,"LineStrip",(function(){return Lf})),n.d(t,"LinearEncoding",(function(){return Qt})),n.d(t,"LinearFilter",(function(){return _e})),n.d(t,"LinearInterpolant",(function(){return vc})),n.d(t,"LinearMipMapLinearFilter",(function(){return Se})),n.d(t,"LinearMipMapNearestFilter",(function(){return Ee})),n.d(t,"LinearMipmapLinearFilter",(function(){return Te})),n.d(t,"LinearMipmapNearestFilter",(function(){return be})),n.d(t,"LinearToneMapping",(function(){return $})),n.d(t,"Loader",(function(){return Dc})),n.d(t,"LoaderUtils",(function(){return Ad})),n.d(t,"LoadingManager",(function(){return Ic})),n.d(t,"LogLuvEncoding",(function(){return en})),n.d(t,"LoopOnce",(function(){return kt})),n.d(t,"LoopPingPong",(function(){return Bt})),n.d(t,"LoopRepeat",(function(){return Ft})),n.d(t,"LuminanceAlphaFormat",(function(){return je})),n.d(t,"LuminanceFormat",(function(){return Ue})),n.d(t,"MOUSE",(function(){return i})),n.d(t,"Material",(function(){return _i})),n.d(t,"MaterialLoader",(function(){return wd})),n.d(t,"Math",(function(){return Fn})),n.d(t,"MathUtils",(function(){return Fn})),n.d(t,"Matrix3",(function(){return Un})),n.d(t,"Matrix4",(function(){return ir})),n.d(t,"MaxEquation",(function(){return R})),n.d(t,"Mesh",(function(){return oa})),n.d(t,"MeshBasicMaterial",(function(){return bi})),n.d(t,"MeshDepthMaterial",(function(){return xs})),n.d(t,"MeshDistanceMaterial",(function(){return Ms})),n.d(t,"MeshFaceMaterial",(function(){return Uf})),n.d(t,"MeshLambertMaterial",(function(){return cc})),n.d(t,"MeshMatcapMaterial",(function(){return dc})),n.d(t,"MeshNormalMaterial",(function(){return lc})),n.d(t,"MeshPhongMaterial",(function(){return sc})),n.d(t,"MeshPhysicalMaterial",(function(){return oc})),n.d(t,"MeshStandardMaterial",(function(){return ac})),n.d(t,"MeshToonMaterial",(function(){return uc})),n.d(t,"MinEquation",(function(){return C})),n.d(t,"MirroredRepeatWrapping",(function(){return fe})),n.d(t,"MixOperation",(function(){return Q})),n.d(t,"MultiMaterial",(function(){return jf})),n.d(t,"MultiplyBlending",(function(){return S})),n.d(t,"MultiplyOperation",(function(){return X})),n.d(t,"NearestFilter",(function(){return pe})),n.d(t,"NearestMipMapLinearFilter",(function(){return ye})),n.d(t,"NearestMipMapNearestFilter",(function(){return ge})),n.d(t,"NearestMipmapLinearFilter",(function(){return ve})),n.d(t,"NearestMipmapNearestFilter",(function(){return me})),n.d(t,"NeverDepth",(function(){return G})),n.d(t,"NeverStencilFunc",(function(){return vn})),n.d(t,"NoBlending",(function(){return _})),n.d(t,"NoColors",(function(){return kf})),n.d(t,"NoToneMapping",(function(){return J})),n.d(t,"NormalAnimationBlendMode",(function(){return Wt})),n.d(t,"NormalBlending",(function(){return b})),n.d(t,"NotEqualDepth",(function(){return K})),n.d(t,"NotEqualStencilFunc",(function(){return Tn})),n.d(t,"NumberKeyframeTrack",(function(){return Tc})),n.d(t,"Object3D",(function(){return Tr})),n.d(t,"ObjectLoader",(function(){return Id})),n.d(t,"ObjectSpaceNormalMap",(function(){return un})),n.d(t,"OctahedronBufferGeometry",(function(){return Xu})),n.d(t,"OctahedronGeometry",(function(){return Ku})),n.d(t,"OneFactor",(function(){return O})),n.d(t,"OneMinusDstAlphaFactor",(function(){return F})),n.d(t,"OneMinusDstColorFactor",(function(){return U})),n.d(t,"OneMinusSrcAlphaFactor",(function(){return N})),n.d(t,"OneMinusSrcColorFactor",(function(){return P})),n.d(t,"OrthographicCamera",(function(){return vd})),n.d(t,"PCFShadowMap",(function(){return d})),n.d(t,"PCFSoftShadowMap",(function(){return h})),n.d(t,"PMREMGenerator",(function(){return Af})),n.d(t,"ParametricBufferGeometry",(function(){return Vu})),n.d(t,"ParametricGeometry",(function(){return Hu})),n.d(t,"Particle",(function(){return Hf})),n.d(t,"ParticleBasicMaterial",(function(){return Wf})),n.d(t,"ParticleSystem",(function(){return Vf})),n.d(t,"ParticleSystemMaterial",(function(){return qf})),n.d(t,"Path",(function(){return ud})),n.d(t,"PerspectiveCamera",(function(){return Ea})),n.d(t,"Plane",(function(){return Jr})),n.d(t,"PlaneBufferGeometry",(function(){return Pa})),n.d(t,"PlaneGeometry",(function(){return Da})),n.d(t,"PlaneHelper",(function(){return of})),n.d(t,"PointCloud",(function(){return Gf})),n.d(t,"PointCloudMaterial",(function(){return zf})),n.d(t,"PointLight",(function(){return gd})),n.d(t,"PointLightHelper",(function(){return Gh})),n.d(t,"Points",(function(){return Nu})),n.d(t,"PointsMaterial",(function(){return Iu})),n.d(t,"PolarGridHelper",(function(){return Yh})),n.d(t,"PolyhedronBufferGeometry",(function(){return Wu})),n.d(t,"PolyhedronGeometry",(function(){return zu})),n.d(t,"PositionalAudio",(function(){return ih})),n.d(t,"PropertyBinding",(function(){return yh})),n.d(t,"PropertyMixer",(function(){return oh})),n.d(t,"QuadraticBezierCurve",(function(){return rd})),n.d(t,"QuadraticBezierCurve3",(function(){return id})),n.d(t,"Quaternion",(function(){return Yn})),n.d(t,"QuaternionKeyframeTrack",(function(){return wc})),n.d(t,"QuaternionLinearInterpolant",(function(){return Sc})),n.d(t,"REVISION",(function(){return r})),n.d(t,"RGBADepthPacking",(function(){return on})),n.d(t,"RGBAFormat",(function(){return Be})),n.d(t,"RGBAIntegerFormat",(function(){return Xe})),n.d(t,"RGBA_ASTC_10x10_Format",(function(){return yt})),n.d(t,"RGBA_ASTC_10x5_Format",(function(){return mt})),n.d(t,"RGBA_ASTC_10x6_Format",(function(){return gt})),n.d(t,"RGBA_ASTC_10x8_Format",(function(){return vt})),n.d(t,"RGBA_ASTC_12x10_Format",(function(){return _t})),n.d(t,"RGBA_ASTC_12x12_Format",(function(){return bt})),n.d(t,"RGBA_ASTC_4x4_Format",(function(){return st})),n.d(t,"RGBA_ASTC_5x4_Format",(function(){return ut})),n.d(t,"RGBA_ASTC_5x5_Format",(function(){return lt})),n.d(t,"RGBA_ASTC_6x5_Format",(function(){return ct})),n.d(t,"RGBA_ASTC_6x6_Format",(function(){return dt})),n.d(t,"RGBA_ASTC_8x5_Format",(function(){return ht})),n.d(t,"RGBA_ASTC_8x6_Format",(function(){return ft})),n.d(t,"RGBA_ASTC_8x8_Format",(function(){return pt})),n.d(t,"RGBA_BPTC_Format",(function(){return Et})),n.d(t,"RGBA_ETC2_EAC_Format",(function(){return ot})),n.d(t,"RGBA_PVRTC_2BPPV1_Format",(function(){return rt})),n.d(t,"RGBA_PVRTC_4BPPV1_Format",(function(){return nt})),n.d(t,"RGBA_S3TC_DXT1_Format",(function(){return Ze})),n.d(t,"RGBA_S3TC_DXT3_Format",(function(){return Je})),n.d(t,"RGBA_S3TC_DXT5_Format",(function(){return $e})),n.d(t,"RGBDEncoding",(function(){return rn})),n.d(t,"RGBEEncoding",(function(){return $t})),n.d(t,"RGBEFormat",(function(){return Ge})),n.d(t,"RGBFormat",(function(){return Fe})),n.d(t,"RGBIntegerFormat",(function(){return Ke})),n.d(t,"RGBM16Encoding",(function(){return nn})),n.d(t,"RGBM7Encoding",(function(){return tn})),n.d(t,"RGB_ETC1_Format",(function(){return it})),n.d(t,"RGB_ETC2_Format",(function(){return at})),n.d(t,"RGB_PVRTC_2BPPV1_Format",(function(){return tt})),n.d(t,"RGB_PVRTC_4BPPV1_Format",(function(){return et})),n.d(t,"RGB_S3TC_DXT1_Format",(function(){return Qe})),n.d(t,"RGFormat",(function(){return qe})),n.d(t,"RGIntegerFormat",(function(){return Ye})),n.d(t,"RawShaderMaterial",(function(){return ic})),n.d(t,"Ray",(function(){return Kr})),n.d(t,"Raycaster",(function(){return wh})),n.d(t,"RectAreaLight",(function(){return Ed})),n.d(t,"RedFormat",(function(){return ze})),n.d(t,"RedIntegerFormat",(function(){return We})),n.d(t,"ReinhardToneMapping",(function(){return ee})),n.d(t,"RepeatWrapping",(function(){return de})),n.d(t,"ReplaceStencilOp",(function(){return dn})),n.d(t,"ReverseSubtractEquation",(function(){return M})),n.d(t,"RingBufferGeometry",(function(){return Vl})),n.d(t,"RingGeometry",(function(){return Hl})),n.d(t,"SRGB8_ALPHA8_ASTC_10x10_Format",(function(){return Pt})),n.d(t,"SRGB8_ALPHA8_ASTC_10x5_Format",(function(){return It})),n.d(t,"SRGB8_ALPHA8_ASTC_10x6_Format",(function(){return Ot})),n.d(t,"SRGB8_ALPHA8_ASTC_10x8_Format",(function(){return Dt})),n.d(t,"SRGB8_ALPHA8_ASTC_12x10_Format",(function(){return Lt})),n.d(t,"SRGB8_ALPHA8_ASTC_12x12_Format",(function(){return Nt})),n.d(t,"SRGB8_ALPHA8_ASTC_4x4_Format",(function(){return Tt})),n.d(t,"SRGB8_ALPHA8_ASTC_5x4_Format",(function(){return St})),n.d(t,"SRGB8_ALPHA8_ASTC_5x5_Format",(function(){return wt})),n.d(t,"SRGB8_ALPHA8_ASTC_6x5_Format",(function(){return At})),n.d(t,"SRGB8_ALPHA8_ASTC_6x6_Format",(function(){return xt})),n.d(t,"SRGB8_ALPHA8_ASTC_8x5_Format",(function(){return Mt})),n.d(t,"SRGB8_ALPHA8_ASTC_8x6_Format",(function(){return Ct})),n.d(t,"SRGB8_ALPHA8_ASTC_8x8_Format",(function(){return Rt})),n.d(t,"Scene",(function(){return Sr})),n.d(t,"SceneUtils",(function(){return vp})),n.d(t,"ShaderChunk",(function(){return La})),n.d(t,"ShaderLib",(function(){return Na})),n.d(t,"ShaderMaterial",(function(){return _a})),n.d(t,"ShadowMaterial",(function(){return rc})),n.d(t,"Shape",(function(){return ld})),n.d(t,"ShapeBufferGeometry",(function(){return Yl})),n.d(t,"ShapeGeometry",(function(){return ql})),n.d(t,"ShapePath",(function(){return Nd})),n.d(t,"ShapeUtils",(function(){return Ol})),n.d(t,"ShortType",(function(){return xe})),n.d(t,"Skeleton",(function(){return hu})),n.d(t,"SkeletonHelper",(function(){return jh})),n.d(t,"SkinnedMesh",(function(){return lu})),n.d(t,"SmoothShading",(function(){return y})),n.d(t,"Sphere",(function(){return jr})),n.d(t,"SphereBufferGeometry",(function(){return Gl})),n.d(t,"SphereGeometry",(function(){return jl})),n.d(t,"Spherical",(function(){return Mh})),n.d(t,"SphericalHarmonics3",(function(){return Td})),n.d(t,"Spline",(function(){return op})),n.d(t,"SplineCurve",(function(){return ad})),n.d(t,"SplineCurve3",(function(){return ap})),n.d(t,"SpotLight",(function(){return pd})),n.d(t,"SpotLightHelper",(function(){return kh})),n.d(t,"SpotLightShadow",(function(){return fd})),n.d(t,"Sprite",(function(){return iu})),n.d(t,"SpriteMaterial",(function(){return zs})),n.d(t,"SrcAlphaFactor",(function(){return L})),n.d(t,"SrcAlphaSaturateFactor",(function(){return j})),n.d(t,"SrcColorFactor",(function(){return D})),n.d(t,"StaticCopyUsage",(function(){return On})),n.d(t,"StaticDrawUsage",(function(){return An})),n.d(t,"StaticReadUsage",(function(){return Cn})),n.d(t,"StereoCamera",(function(){return qd})),n.d(t,"StreamCopyUsage",(function(){return Pn})),n.d(t,"StreamDrawUsage",(function(){return Mn})),n.d(t,"StreamReadUsage",(function(){return In})),n.d(t,"StringKeyframeTrack",(function(){return Ac})),n.d(t,"SubtractEquation",(function(){return x})),n.d(t,"SubtractiveBlending",(function(){return T})),n.d(t,"TOUCH",(function(){return a})),n.d(t,"TangentSpaceNormalMap",(function(){return sn})),n.d(t,"TetrahedronBufferGeometry",(function(){return Yu})),n.d(t,"TetrahedronGeometry",(function(){return qu})),n.d(t,"TextBufferGeometry",(function(){return Ul})),n.d(t,"TextGeometry",(function(){return Bl})),n.d(t,"Texture",(function(){return Vn})),n.d(t,"TextureLoader",(function(){return jc})),n.d(t,"TorusBufferGeometry",(function(){return al})),n.d(t,"TorusGeometry",(function(){return il})),n.d(t,"TorusKnotBufferGeometry",(function(){return rl})),n.d(t,"TorusKnotGeometry",(function(){return nl})),n.d(t,"Triangle",(function(){return li})),n.d(t,"TriangleFanDrawMode",(function(){return Xt})),n.d(t,"TriangleStripDrawMode",(function(){return Kt})),n.d(t,"TrianglesDrawMode",(function(){return Yt})),n.d(t,"TubeBufferGeometry",(function(){return tl})),n.d(t,"TubeGeometry",(function(){return el})),n.d(t,"UVMapping",(function(){return ie})),n.d(t,"Uint16Attribute",(function(){return $f})),n.d(t,"Uint16BufferAttribute",(function(){return Ci})),n.d(t,"Uint32Attribute",(function(){return tp})),n.d(t,"Uint32BufferAttribute",(function(){return Ii})),n.d(t,"Uint8Attribute",(function(){return Qf})),n.d(t,"Uint8BufferAttribute",(function(){return Ai})),n.d(t,"Uint8ClampedAttribute",(function(){return Zf})),n.d(t,"Uint8ClampedBufferAttribute",(function(){return xi})),n.d(t,"Uniform",(function(){return Th})),n.d(t,"UniformsLib",(function(){return Ra})),n.d(t,"UniformsUtils",(function(){return ya})),n.d(t,"UnsignedByteType",(function(){return we})),n.d(t,"UnsignedInt248Type",(function(){return Ne})),n.d(t,"UnsignedIntType",(function(){return Re})),n.d(t,"UnsignedShort4444Type",(function(){return De})),n.d(t,"UnsignedShort5551Type",(function(){return Pe})),n.d(t,"UnsignedShort565Type",(function(){return Le})),n.d(t,"UnsignedShortType",(function(){return Me})),n.d(t,"VSMShadowMap",(function(){return f})),n.d(t,"Vector2",(function(){return Bn})),n.d(t,"Vector3",(function(){return Qn})),n.d(t,"Vector4",(function(){return zn})),n.d(t,"VectorKeyframeTrack",(function(){return xc})),n.d(t,"Vertex",(function(){return Yf})),n.d(t,"VertexColors",(function(){return Bf})),n.d(t,"VideoTexture",(function(){return Fu})),n.d(t,"WebGL1Renderer",(function(){return Bs})),n.d(t,"WebGLCubeRenderTarget",(function(){return wa})),n.d(t,"WebGLMultisampleRenderTarget",(function(){return qn})),n.d(t,"WebGLRenderTarget",(function(){return Wn})),n.d(t,"WebGLRenderTargetCube",(function(){return fp})),n.d(t,"WebGLRenderer",(function(){return Fs})),n.d(t,"WebGLUtils",(function(){return Os})),n.d(t,"WireframeGeometry",(function(){return Gu})),n.d(t,"WireframeHelper",(function(){return cp})),n.d(t,"WrapAroundEnding",(function(){return zt})),n.d(t,"XHRLoader",(function(){return dp})),n.d(t,"ZeroCurvatureEnding",(function(){return Ht})),n.d(t,"ZeroFactor",(function(){return I})),n.d(t,"ZeroSlopeEnding",(function(){return Vt})),n.d(t,"ZeroStencilOp",(function(){return ln})),n.d(t,"sRGBEncoding",(function(){return Zt})),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e);for(let e=1;e<arguments.length;e++){const n=arguments[e];if(null!=n)for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}return t});const r="119",i={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},a={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},o=0,s=1,u=2,l=3,c=0,d=1,h=2,f=3,p=0,m=1,g=2,v=1,y=2,_=0,b=1,E=2,T=3,S=4,w=5,A=100,x=101,M=102,C=103,R=104,I=200,O=201,D=202,P=203,L=204,N=205,k=206,F=207,B=208,U=209,j=210,G=0,H=1,V=2,z=3,W=4,q=5,Y=6,K=7,X=0,Q=1,Z=2,J=0,$=1,ee=2,te=3,ne=4,re=5,ie=300,ae=301,oe=302,se=303,ue=304,le=306,ce=307,de=1e3,he=1001,fe=1002,pe=1003,me=1004,ge=1004,ve=1005,ye=1005,_e=1006,be=1007,Ee=1007,Te=1008,Se=1008,we=1009,Ae=1010,xe=1011,Me=1012,Ce=1013,Re=1014,Ie=1015,Oe=1016,De=1017,Pe=1018,Le=1019,Ne=1020,ke=1021,Fe=1022,Be=1023,Ue=1024,je=1025,Ge=Be,He=1026,Ve=1027,ze=1028,We=1029,qe=1030,Ye=1031,Ke=1032,Xe=1033,Qe=33776,Ze=33777,Je=33778,$e=33779,et=35840,tt=35841,nt=35842,rt=35843,it=36196,at=37492,ot=37496,st=37808,ut=37809,lt=37810,ct=37811,dt=37812,ht=37813,ft=37814,pt=37815,mt=37816,gt=37817,vt=37818,yt=37819,_t=37820,bt=37821,Et=36492,Tt=37840,St=37841,wt=37842,At=37843,xt=37844,Mt=37845,Ct=37846,Rt=37847,It=37848,Ot=37849,Dt=37850,Pt=37851,Lt=37852,Nt=37853,kt=2200,Ft=2201,Bt=2202,Ut=2300,jt=2301,Gt=2302,Ht=2400,Vt=2401,zt=2402,Wt=2500,qt=2501,Yt=0,Kt=1,Xt=2,Qt=3e3,Zt=3001,Jt=3007,$t=3002,en=3003,tn=3004,nn=3005,rn=3006,an=3200,on=3201,sn=0,un=1,ln=0,cn=7680,dn=7681,hn=7682,fn=7683,pn=34055,mn=34056,gn=5386,vn=512,yn=513,_n=514,bn=515,En=516,Tn=517,Sn=518,wn=519,An=35044,xn=35048,Mn=35040,Cn=35045,Rn=35049,In=35041,On=35046,Dn=35050,Pn=35042;function Ln(){}Object.assign(Ln.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}},dispatchEvent:function(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,r=n.length;t<r;t++)n[t].call(this,e)}}});const Nn=[];for(let e=0;e<256;e++)Nn[e]=(e<16?"0":"")+e.toString(16);let kn=1234567;const Fn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Nn[255&e]+Nn[e>>8&255]+Nn[e>>16&255]+Nn[e>>24&255]+"-"+Nn[255&t]+Nn[t>>8&255]+"-"+Nn[t>>16&15|64]+Nn[t>>24&255]+"-"+Nn[63&n|128]+Nn[n>>8&255]+"-"+Nn[n>>16&255]+Nn[n>>24&255]+Nn[255&r]+Nn[r>>8&255]+Nn[r>>16&255]+Nn[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(kn=e%2147483647),kn=16807*kn%2147483647,(kn-1)/2147483646},degToRad:function(e){return e*Fn.DEG2RAD},radToDeg:function(e){return e*Fn.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){const a=Math.cos,o=Math.sin,s=a(n/2),u=o(n/2),l=a((t+r)/2),c=o((t+r)/2),d=a((t-r)/2),h=o((t-r)/2),f=a((r-t)/2),p=o((r-t)/2);switch(i){case"XYX":e.set(s*c,u*d,u*h,s*l);break;case"YZY":e.set(u*h,s*c,u*d,s*l);break;case"ZXZ":e.set(u*d,u*h,s*c,s*l);break;case"XZX":e.set(s*c,u*p,u*f,s*l);break;case"YXY":e.set(u*f,s*c,u*p,s*l);break;case"ZYZ":e.set(u*p,u*f,s*c,s*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};function Bn(e=0,t=0){this.x=e,this.y=t}function Un(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}let jn;Object.defineProperties(Bn.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Bn.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(Un.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,a,o,s,u){const l=this.elements;return l[0]=e,l[1]=r,l[2]=o,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=a,l[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},extractBasis:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],u=n[1],l=n[4],c=n[7],d=n[2],h=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],_=r[7],b=r[2],E=r[5],T=r[8];return i[0]=a*p+o*v+s*b,i[3]=a*m+o*y+s*E,i[6]=a*g+o*_+s*T,i[1]=u*p+l*v+c*b,i[4]=u*m+l*y+c*E,i[7]=u*g+l*_+c*T,i[2]=d*p+h*v+f*b,i[5]=d*m+h*y+f*E,i[8]=d*g+h*_+f*T,this},multiplyScalar:function(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*a*l-t*o*u-n*i*l+n*o*s+r*i*u-r*a*s},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const n=e.elements,r=this.elements,i=n[0],a=n[1],o=n[2],s=n[3],u=n[4],l=n[5],c=n[6],d=n[7],h=n[8],f=h*u-l*d,p=l*c-h*s,m=d*s-u*c,g=i*f+a*p+o*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);const v=1/g;return r[0]=f*v,r[1]=(o*d-h*a)*v,r[2]=(l*a-o*u)*v,r[3]=p*v,r[4]=(h*i-o*c)*v,r[5]=(o*s-l*i)*v,r[6]=m*v,r[7]=(a*c-d*i)*v,r[8]=(u*i-a*s)*v,this},transpose:function(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,a,o){const s=Math.cos(i),u=Math.sin(i);this.set(n*s,n*u,-n*(s*a+u*o)+a+e,-r*u,r*s,-r*(-u*a+s*o)+o+t,0,0,1)},scale:function(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){const t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],u=r[4],l=r[7];return r[0]=t*i+n*s,r[3]=t*a+n*u,r[6]=t*o+n*l,r[1]=-n*i+t*s,r[4]=-n*a+t*u,r[7]=-n*o+t*l,this},translate:function(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){const t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});const Gn={getDataURL:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===jn&&(jn=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),jn.width=e.width,jn.height=e.height;const n=jn.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=jn}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}};let Hn=0;function Vn(e,t,n,r,i,a,o,s,u,l){Object.defineProperty(this,"id",{value:Hn++}),this.uuid=Fn.generateUUID(),this.name="",this.image=void 0!==e?e:Vn.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Vn.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:he,this.wrapT=void 0!==r?r:he,this.magFilter=void 0!==i?i:_e,this.minFilter=void 0!==a?a:Te,this.anisotropy=void 0!==u?u:1,this.format=void 0!==o?o:Be,this.internalFormat=null,this.type=void 0!==s?s:we,this.offset=new Bn(0,0),this.repeat=new Bn(1,1),this.center=new Bn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Un,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:Qt,this.version=0,this.onUpdate=null}function zn(e=0,t=0,n=0,r=1){this.x=e,this.y=t,this.z=n,this.w=r}function Wn(e,t,n){this.width=e,this.height=t,this.scissor=new zn(0,0,e,t),this.scissorTest=!1,this.viewport=new zn(0,0,e,t),n=n||{},this.texture=new Vn(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:_e,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function qn(e,t,n){Wn.call(this,e,t,n),this.samples=4}function Yn(e=0,t=0,n=0,r=1){this._x=e,this._y=t,this._z=n,this._w=r}Vn.DEFAULT_IMAGE=void 0,Vn.DEFAULT_MAPPING=ie,Vn.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Vn,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const r=this.image;if(void 0===r.uuid&&(r.uuid=Fn.generateUUID()),!t&&void 0===e.images[r.uuid]){let t;if(Array.isArray(r)){t=[];for(let e=0,n=r.length;e<n;e++)t.push(Gn.getDataURL(r[e]))}else t=Gn.getDataURL(r);e.images[r.uuid]={uuid:r.uuid,url:t}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==ie)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case de:e.x=e.x-Math.floor(e.x);break;case he:e.x=e.x<0?0:1;break;case fe:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case de:e.y=e.y-Math.floor(e.y);break;case he:e.y=e.y<0?0:1;break;case fe:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Vn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.defineProperties(zn.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(zn.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){let t,n,r,i;const a=.01,o=.1,s=e.elements,u=s[0],l=s[4],c=s[8],d=s[1],h=s[5],f=s[9],p=s[2],m=s[6],g=s[10];if(Math.abs(l-d)<a&&Math.abs(c-p)<a&&Math.abs(f-m)<a){if(Math.abs(l+d)<o&&Math.abs(c+p)<o&&Math.abs(f+m)<o&&Math.abs(u+h+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(u+1)/2,s=(h+1)/2,v=(g+1)/2,y=(l+d)/4,_=(c+p)/4,b=(f+m)/4;return e>s&&e>v?e<a?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=y/n,i=_/n):s>v?s<a?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(s),n=y/r,i=b/r):v<a?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=_/i,r=b/i),this.set(n,r,i,t),this}let v=Math.sqrt((m-f)*(m-f)+(c-p)*(c-p)+(d-l)*(d-l));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(c-p)/v,this.z=(d-l)/v,this.w=Math.acos((u+h+g-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),Wn.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Wn,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),qn.prototype=Object.assign(Object.create(Wn.prototype),{constructor:qn,isWebGLMultisampleRenderTarget:!0,copy:function(e){return Wn.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign(Yn,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,a,o){let s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3];const d=i[a+0],h=i[a+1],f=i[a+2],p=i[a+3];if(c!==p||s!==d||u!==h||l!==f){let e=1-o,t=s*d+u*h+l*f+c*p,n=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){const i=Math.sqrt(r),a=Math.atan2(i,t*n);e=Math.sin(e*a)/i,o=Math.sin(o*a)/i}const i=o*n;if(s=s*e+d*i,u=u*e+h*i,l=l*e+f*i,c=c*e+p*i,e===1-o){const e=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=e,u*=e,l*=e,c*=e}}e[t]=s,e[t+1]=u,e[t+2]=l,e[t+3]=c},multiplyQuaternionsFlat:function(e,t,n,r,i,a){const o=n[r],s=n[r+1],u=n[r+2],l=n[r+3],c=i[a],d=i[a+1],h=i[a+2],f=i[a+3];return e[t]=o*f+l*c+s*h-u*d,e[t+1]=s*f+l*d+u*c-o*h,e[t+2]=u*f+l*h+o*d-s*c,e[t+3]=l*f-o*c-s*d-u*h,e}}),Object.defineProperties(Yn.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(Yn.prototype,{isQuaternion:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,r=e._y,i=e._z,a=e.order,o=Math.cos,s=Math.sin,u=o(n/2),l=o(r/2),c=o(i/2),d=s(n/2),h=s(r/2),f=s(i/2);switch(a){case"XYZ":this._x=d*l*c+u*h*f,this._y=u*h*c-d*l*f,this._z=u*l*f+d*h*c,this._w=u*l*c-d*h*f;break;case"YXZ":this._x=d*l*c+u*h*f,this._y=u*h*c-d*l*f,this._z=u*l*f-d*h*c,this._w=u*l*c+d*h*f;break;case"ZXY":this._x=d*l*c-u*h*f,this._y=u*h*c+d*l*f,this._z=u*l*f+d*h*c,this._w=u*l*c-d*h*f;break;case"ZYX":this._x=d*l*c-u*h*f,this._y=u*h*c+d*l*f,this._z=u*l*f-d*h*c,this._w=u*l*c+d*h*f;break;case"YZX":this._x=d*l*c+u*h*f,this._y=u*h*c+d*l*f,this._z=u*l*f-d*h*c,this._w=u*l*c-d*h*f;break;case"XZY":this._x=d*l*c-u*h*f,this._y=u*h*c-d*l*f,this._z=u*l*f+d*h*c,this._w=u*l*c+d*h*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],o=t[5],s=t[9],u=t[2],l=t[6],c=t[10],d=n+o+c;if(d>0){const e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(l-s)*e,this._y=(i-u)*e,this._z=(a-r)*e}else if(n>o&&n>c){const e=2*Math.sqrt(1+n-o-c);this._w=(l-s)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(i+u)/e}else if(o>c){const e=2*Math.sqrt(1+o-n-c);this._w=(i-u)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(s+l)/e}else{const e=2*Math.sqrt(1+c-n-o);this._w=(a-r)/e,this._x=(i+u)/e,this._y=(s+l)/e,this._z=.25*e}return this._onChangeCallback(),this},setFromUnitVectors:function(e,t){let n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Fn.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this},identity:function(){return this.set(0,0,0,1)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,u=t._z,l=t._w;return this._x=n*l+a*o+r*u-i*s,this._y=r*l+a*s+i*o-n*u,this._z=i*l+a*u+n*s-r*o,this._w=a*l-n*o-r*s-i*u,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,i=this._z,a=this._w;let o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;const s=1-o*o;if(s<=Number.EPSILON){const e=1-t;return this._w=e*a+t*this._w,this._x=e*n+t*this._x,this._y=e*r+t*this._y,this._z=e*i+t*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(s),l=Math.atan2(u,o),c=Math.sin((1-t)*l)/u,d=Math.sin(t*l)/u;return this._w=a*c+this._w*d,this._x=n*c+this._x*d,this._y=r*c+this._y*d,this._z=i*c+this._z*d,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},fromBufferAttribute:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});const Kn=new Qn,Xn=new Yn;function Qn(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}Object.assign(Qn.prototype,{isVector3:!0,set:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Xn.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(Xn.setFromAxisAngle(e,t))},applyMatrix3:function(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this},applyQuaternion:function(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,u=s*t+a*r-o*n,l=s*n+o*t-i*r,c=s*r+i*n-a*t,d=-i*t-a*n-o*r;return this.x=u*s+d*-i+l*-o-c*-a,this.y=l*s+d*-a+c*-i-u*-o,this.z=c*s+d*-o+u*-a-l*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this},projectOnVector:function(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)},projectOnPlane:function(e){return Kn.copy(this).projectOnVector(e),this.sub(Kn)},reflect:function(e){return this.sub(Kn.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Fn.clamp(n,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});const Zn=new Qn,Jn=new ir,$n=new Qn(0,0,0),er=new Qn(1,1,1),tr=new Qn,nr=new Qn,rr=new Qn;function ir(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(ir.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,a,o,s,u,l,c,d,h,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=u,g[6]=l,g[10]=c,g[14]=d,g[3]=h,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new ir).fromArray(this.elements)},copy:function(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(e){const t=this.elements,n=e.elements,r=1/Zn.setFromMatrixColumn(e,0).length(),i=1/Zn.setFromMatrixColumn(e,1).length(),a=1/Zn.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),u=Math.sin(r),l=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){const e=a*l,n=a*c,r=o*l,i=o*c;t[0]=s*l,t[4]=-s*c,t[8]=u,t[1]=n+r*u,t[5]=e-i*u,t[9]=-o*s,t[2]=i-e*u,t[6]=r+n*u,t[10]=a*s}else if("YXZ"===e.order){const e=s*l,n=s*c,r=u*l,i=u*c;t[0]=e+i*o,t[4]=r*o-n,t[8]=a*u,t[1]=a*c,t[5]=a*l,t[9]=-o,t[2]=n*o-r,t[6]=i+e*o,t[10]=a*s}else if("ZXY"===e.order){const e=s*l,n=s*c,r=u*l,i=u*c;t[0]=e-i*o,t[4]=-a*c,t[8]=r+n*o,t[1]=n+r*o,t[5]=a*l,t[9]=i-e*o,t[2]=-a*u,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){const e=a*l,n=a*c,r=o*l,i=o*c;t[0]=s*l,t[4]=r*u-n,t[8]=e*u+i,t[1]=s*c,t[5]=i*u+e,t[9]=n*u-r,t[2]=-u,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){const e=a*s,n=a*u,r=o*s,i=o*u;t[0]=s*l,t[4]=i-e*c,t[8]=r*c+n,t[1]=c,t[5]=a*l,t[9]=-o*l,t[2]=-u*l,t[6]=n*c+r,t[10]=e-i*c}else if("XZY"===e.order){const e=a*s,n=a*u,r=o*s,i=o*u;t[0]=s*l,t[4]=-c,t[8]=u*l,t[1]=e*c+i,t[5]=a*l,t[9]=n*c-r,t[2]=r*c-n,t[6]=o*l,t[10]=i*c+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose($n,e,er)},lookAt:function(e,t,n){const r=this.elements;return rr.subVectors(e,t),0===rr.lengthSq()&&(rr.z=1),rr.normalize(),tr.crossVectors(n,rr),0===tr.lengthSq()&&(1===Math.abs(n.z)?rr.x+=1e-4:rr.z+=1e-4,rr.normalize(),tr.crossVectors(n,rr)),tr.normalize(),nr.crossVectors(rr,tr),r[0]=tr.x,r[4]=nr.x,r[8]=rr.x,r[1]=tr.y,r[5]=nr.y,r[9]=rr.y,r[2]=tr.z,r[6]=nr.z,r[10]=rr.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],u=n[12],l=n[1],c=n[5],d=n[9],h=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],E=r[0],T=r[4],S=r[8],w=r[12],A=r[1],x=r[5],M=r[9],C=r[13],R=r[2],I=r[6],O=r[10],D=r[14],P=r[3],L=r[7],N=r[11],k=r[15];return i[0]=a*E+o*A+s*R+u*P,i[4]=a*T+o*x+s*I+u*L,i[8]=a*S+o*M+s*O+u*N,i[12]=a*w+o*C+s*D+u*k,i[1]=l*E+c*A+d*R+h*P,i[5]=l*T+c*x+d*I+h*L,i[9]=l*S+c*M+d*O+h*N,i[13]=l*w+c*C+d*D+h*k,i[2]=f*E+p*A+m*R+g*P,i[6]=f*T+p*x+m*I+g*L,i[10]=f*S+p*M+m*O+g*N,i[14]=f*w+p*C+m*D+g*k,i[3]=v*E+y*A+_*R+b*P,i[7]=v*T+y*x+_*I+b*L,i[11]=v*S+y*M+_*O+b*N,i[15]=v*w+y*C+_*D+b*k,this},multiplyScalar:function(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],u=e[13],l=e[2],c=e[6],d=e[10],h=e[14];return e[3]*(+i*s*c-r*u*c-i*o*d+n*u*d+r*o*h-n*s*h)+e[7]*(+t*s*h-t*u*d+i*a*d-r*a*h+r*u*l-i*s*l)+e[11]*(+t*u*c-t*o*h-i*a*c+n*a*h+i*o*l-n*u*l)+e[15]*(-r*o*l-t*s*c+t*o*d+r*a*c-n*a*d+n*s*l)},transpose:function(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},getInverse:function(e,t){void 0!==t&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const n=this.elements,r=e.elements,i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],l=r[5],c=r[6],d=r[7],h=r[8],f=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],_=r[15],b=f*y*d-v*p*d+v*c*m-l*y*m-f*c*_+l*p*_,E=g*p*d-h*y*d-g*c*m+u*y*m+h*c*_-u*p*_,T=h*v*d-g*f*d+g*l*m-u*v*m-h*l*_+u*f*_,S=g*f*c-h*v*c-g*l*p+u*v*p+h*l*y-u*f*y,w=i*b+a*E+o*T+s*S;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/w;return n[0]=b*A,n[1]=(v*p*s-f*y*s-v*o*m+a*y*m+f*o*_-a*p*_)*A,n[2]=(l*y*s-v*c*s+v*o*d-a*y*d-l*o*_+a*c*_)*A,n[3]=(f*c*s-l*p*s-f*o*d+a*p*d+l*o*m-a*c*m)*A,n[4]=E*A,n[5]=(h*y*s-g*p*s+g*o*m-i*y*m-h*o*_+i*p*_)*A,n[6]=(g*c*s-u*y*s-g*o*d+i*y*d+u*o*_-i*c*_)*A,n[7]=(u*p*s-h*c*s+h*o*d-i*p*d-u*o*m+i*c*m)*A,n[8]=T*A,n[9]=(g*f*s-h*v*s-g*a*m+i*v*m+h*a*_-i*f*_)*A,n[10]=(u*v*s-g*l*s+g*a*d-i*v*d-u*a*_+i*l*_)*A,n[11]=(h*l*s-u*f*s-h*a*d+i*f*d+u*a*m-i*l*m)*A,n[12]=S*A,n[13]=(h*v*o-g*f*o+g*a*p-i*v*p-h*a*y+i*f*y)*A,n[14]=(g*l*o-u*v*o-g*a*c+i*v*c+u*a*y-i*l*y)*A,n[15]=(u*f*o-h*l*o+h*a*c-i*f*c-u*a*p+i*l*p)*A,this},scale:function(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},getMaxScaleOnAxis:function(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,u=i*a,l=i*o;return this.set(u*a+n,u*o-r*s,u*s+r*o,0,u*o+r*s,l*o+n,l*s-r*a,0,u*s-r*o,l*s+r*a,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){const r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,u=i+i,l=a+a,c=o+o,d=i*u,h=i*l,f=i*c,p=a*l,m=a*c,g=o*c,v=s*u,y=s*l,_=s*c,b=n.x,E=n.y,T=n.z;return r[0]=(1-(p+g))*b,r[1]=(h+_)*b,r[2]=(f-y)*b,r[3]=0,r[4]=(h-_)*E,r[5]=(1-(d+g))*E,r[6]=(m+v)*E,r[7]=0,r[8]=(f+y)*T,r[9]=(m-v)*T,r[10]=(1-(d+p))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:function(e,t,n){const r=this.elements;let i=Zn.set(r[0],r[1],r[2]).length(),a=Zn.set(r[4],r[5],r[6]).length(),o=Zn.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],Jn.copy(this);const s=1/i,u=1/a,l=1/o;return Jn.elements[0]*=s,Jn.elements[1]*=s,Jn.elements[2]*=s,Jn.elements[4]*=u,Jn.elements[5]*=u,Jn.elements[6]*=u,Jn.elements[8]*=l,Jn.elements[9]*=l,Jn.elements[10]*=l,t.setFromRotationMatrix(Jn),n.x=i,n.y=a,n.z=o,this},makePerspective:function(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,s=2*i/(t-e),u=2*i/(n-r),l=(t+e)/(t-e),c=(n+r)/(n-r),d=-(a+i)/(a-i),h=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=u,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,n,r,i,a){const o=this.elements,s=1/(t-e),u=1/(n-r),l=1/(a-i),c=(t+e)*s,d=(n+r)*u,h=(a+i)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-h,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){const t=this.elements,n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});const ar=new ir,or=new Yn;function sr(e=0,t=0,n=0,r=sr.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=r}function ur(){this.mask=1}sr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],sr.DefaultOrder="XYZ",Object.defineProperties(sr.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(sr.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){const r=Fn.clamp,i=e.elements,a=i[0],o=i[4],s=i[8],u=i[1],l=i[5],c=i[9],d=i[2],h=i[6],f=i[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-d,a),this._z=0);break;case"ZXY":this._x=Math.asin(r(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(u,a));break;case"ZYX":this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,l));break;case"YZX":this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-d,a)):(this._x=0,this._y=Math.atan2(s,f));break;case"XZY":this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,n){return ar.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ar,t,n)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return or.setFromEuler(this),this.setFromQuaternion(or,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Qn(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(ur.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}});let lr=0;const cr=new Qn,dr=new Yn,hr=new ir,fr=new Qn,pr=new Qn,mr=new Qn,gr=new Yn,vr=new Qn(1,0,0),yr=new Qn(0,1,0),_r=new Qn(0,0,1),br={type:"added"},Er={type:"removed"};function Tr(){Object.defineProperty(this,"id",{value:lr++}),this.uuid=Fn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Tr.DefaultUp.clone();const e=new Qn,t=new sr,n=new Yn,r=new Qn(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ir},normalMatrix:{value:new Un}}),this.matrix=new ir,this.matrixWorld=new ir,this.matrixAutoUpdate=Tr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ur,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Sr(){Tr.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Tr.DefaultUp=new Qn(0,1,0),Tr.DefaultMatrixAutoUpdate=!0,Tr.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Tr,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return dr.setFromAxisAngle(e,t),this.quaternion.multiply(dr),this},rotateOnWorldAxis:function(e,t){return dr.setFromAxisAngle(e,t),this.quaternion.premultiply(dr),this},rotateX:function(e){return this.rotateOnAxis(vr,e)},rotateY:function(e){return this.rotateOnAxis(yr,e)},rotateZ:function(e){return this.rotateOnAxis(_r,e)},translateOnAxis:function(e,t){return cr.copy(e).applyQuaternion(this.quaternion),this.position.add(cr.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(vr,e)},translateY:function(e){return this.translateOnAxis(yr,e)},translateZ:function(e){return this.translateOnAxis(_r,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(hr.getInverse(this.matrixWorld))},lookAt:function(e,t,n){e.isVector3?fr.copy(e):fr.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),pr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?hr.lookAt(pr,fr,this.up):hr.lookAt(fr,pr,this.up),this.quaternion.setFromRotationMatrix(hr),r&&(hr.extractRotation(r.matrixWorld),dr.setFromRotationMatrix(hr),this.quaternion.premultiply(dr.inverse()))},add:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(br)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Er)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),hr.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),hr.multiply(e.parent.matrixWorld)),e.applyMatrix4(hr),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Qn),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Yn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(pr,e,mr),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Qn),this.updateMatrixWorld(!0),this.matrixWorld.decompose(pr,gr,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Qn),this.updateMatrixWorld(!0);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)},traverseAncestors:function(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)}},toJSON:function(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(t){const t=a(e.geometries),r=a(e.materials),i=a(e.textures),o=a(e.images),s=a(e.shapes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),o.length>0&&(n.images=o),s.length>0&&(n.shapes=s)}return n.object=r,n;function a(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const n=e.children[t];this.add(n.clone())}return this}}),Sr.prototype=Object.assign(Object.create(Tr.prototype),{constructor:Sr,isScene:!0,copy:function(e,t){return Tr.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){const t=Tr.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});const wr=[new Qn,new Qn,new Qn,new Qn,new Qn,new Qn,new Qn,new Qn],Ar=new Qn,xr=new Fr,Mr=new Qn,Cr=new Qn,Rr=new Qn,Ir=new Qn,Or=new Qn,Dr=new Qn,Pr=new Qn,Lr=new Qn,Nr=new Qn,kr=new Qn;function Fr(e,t){this.min=void 0!==e?e:new Qn(1/0,1/0,1/0),this.max=void 0!==t?t:new Qn(-1/0,-1/0,-1/0)}function Br(e,t,n,r,i){for(let a=0,o=e.length-3;a<=o;a+=3){kr.fromArray(e,a);const o=i.x*Math.abs(kr.x)+i.y*Math.abs(kr.y)+i.z*Math.abs(kr.z),s=t.dot(kr),u=n.dot(kr),l=r.dot(kr);if(Math.max(-Math.max(s,u,l),Math.min(s,u,l))>o)return!1}return!0}Object.assign(Fr.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){let t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0;for(let s=0,u=e.length;s<u;s+=3){const u=e[s],l=e[s+1],c=e[s+2];u<t&&(t=u),l<n&&(n=l),c<r&&(r=c),u>i&&(i=u),l>a&&(a=l),c>o&&(o=c)}return this.min.set(t,n,r),this.max.set(i,a,o),this},setFromBufferAttribute:function(e){let t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0;for(let s=0,u=e.count;s<u;s++){const u=e.getX(s),l=e.getY(s),c=e.getZ(s);u<t&&(t=u),l<n&&(n=l),c<r&&(r=c),u>i&&(i=u),l>a&&(a=l),c>o&&(o=c)}return this.min.set(t,n,r),this.max.set(i,a,o),this},setFromPoints:function(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){const n=Ar.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Qn),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Qn),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),xr.copy(t.boundingBox),xr.applyMatrix4(e.matrixWorld),this.union(xr));const n=e.children;for(let e=0,t=n.length;e<t;e++)this.expandByObject(n[e]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Qn),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,Ar),Ar.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(Pr),Lr.subVectors(this.max,Pr),Mr.subVectors(e.a,Pr),Cr.subVectors(e.b,Pr),Rr.subVectors(e.c,Pr),Ir.subVectors(Cr,Mr),Or.subVectors(Rr,Cr),Dr.subVectors(Mr,Rr);let t=[0,-Ir.z,Ir.y,0,-Or.z,Or.y,0,-Dr.z,Dr.y,Ir.z,0,-Ir.x,Or.z,0,-Or.x,Dr.z,0,-Dr.x,-Ir.y,Ir.x,0,-Or.y,Or.x,0,-Dr.y,Dr.x,0];return!!Br(t,Mr,Cr,Rr,Lr)&&(t=[1,0,0,0,1,0,0,0,1],!!Br(t,Mr,Cr,Rr,Lr)&&(Nr.crossVectors(Ir,Or),t=[Nr.x,Nr.y,Nr.z],Br(t,Mr,Cr,Rr,Lr)))},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Qn),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return Ar.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Ar).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()||(wr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),wr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),wr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),wr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),wr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),wr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),wr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),wr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(wr)),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});const Ur=new Fr;function jr(e,t){this.center=void 0!==e?e:new Qn,this.radius=void 0!==t?t:-1}Object.assign(jr.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){const n=this.center;void 0!==t?n.copy(t):Ur.setFromPoints(e).getCenter(n);let r=0;for(let t=0,i=e.length;t<i;t++)r=Math.max(r,n.distanceToSquared(e[t]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){const n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Qn),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Fr),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});const Gr=new Qn,Hr=new Qn,Vr=new Qn,zr=new Qn,Wr=new Qn,qr=new Qn,Yr=new Qn;function Kr(e,t){this.origin=void 0!==e?e:new Qn,this.direction=void 0!==t?t:new Qn(0,0,-1)}Object.assign(Kr.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Qn),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,Gr)),this},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Qn),t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){const t=Gr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Gr.copy(this.direction).multiplyScalar(t).add(this.origin),Gr.distanceToSquared(e))},distanceSqToSegment:function(e,t,n,r){Hr.copy(e).add(t).multiplyScalar(.5),Vr.copy(t).sub(e).normalize(),zr.copy(this.origin).sub(Hr);const i=.5*e.distanceTo(t),a=-this.direction.dot(Vr),o=zr.dot(this.direction),s=-zr.dot(Vr),u=zr.lengthSq(),l=Math.abs(1-a*a);let c,d,h,f;if(l>0)if(c=a*s-o,d=a*o-s,f=i*l,c>=0)if(d>=-f)if(d<=f){const e=1/l;c*=e,d*=e,h=c*(c+a*d+2*o)+d*(a*c+d+2*s)+u}else d=i,c=Math.max(0,-(a*d+o)),h=-c*c+d*(d+2*s)+u;else d=-i,c=Math.max(0,-(a*d+o)),h=-c*c+d*(d+2*s)+u;else d<=-f?(c=Math.max(0,-(-a*i+o)),d=c>0?-i:Math.min(Math.max(-i,-s),i),h=-c*c+d*(d+2*s)+u):d<=f?(c=0,d=Math.min(Math.max(-i,-s),i),h=d*(d+2*s)+u):(c=Math.max(0,-(a*i+o)),d=c>0?i:Math.min(Math.max(-i,-s),i),h=-c*c+d*(d+2*s)+u);else d=a>0?-i:i,c=Math.max(0,-(a*d+o)),h=-c*c+d*(d+2*s)+u;return n&&n.copy(this.direction).multiplyScalar(c).add(this.origin),r&&r.copy(Vr).multiplyScalar(d).add(Hr),h},intersectSphere:function(e,t){Gr.subVectors(e.center,this.origin);const n=Gr.dot(this.direction),r=Gr.dot(Gr)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){let n,r,i,a,o,s;const u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,d=this.origin;return u>=0?(n=(e.min.x-d.x)*u,r=(e.max.x-d.x)*u):(n=(e.max.x-d.x)*u,r=(e.min.x-d.x)*u),l>=0?(i=(e.min.y-d.y)*l,a=(e.max.y-d.y)*l):(i=(e.max.y-d.y)*l,a=(e.min.y-d.y)*l),n>a||i>r?null:((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),c>=0?(o=(e.min.z-d.z)*c,s=(e.max.z-d.z)*c):(o=(e.max.z-d.z)*c,s=(e.min.z-d.z)*c),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},intersectsBox:function(e){return null!==this.intersectBox(e,Gr)},intersectTriangle:function(e,t,n,r,i){Wr.subVectors(t,e),qr.subVectors(n,e),Yr.crossVectors(Wr,qr);let a,o=this.direction.dot(Yr);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}zr.subVectors(this.origin,e);const s=a*this.direction.dot(qr.crossVectors(zr,qr));if(s<0)return null;const u=a*this.direction.dot(Wr.cross(zr));if(u<0)return null;if(s+u>o)return null;const l=-a*zr.dot(Yr);return l<0?null:this.at(l/o,i)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});const Xr=new Qn,Qr=new Qn,Zr=new Un;function Jr(e,t){this.normal=void 0!==e?e:new Qn(1,0,0),this.constant=void 0!==t?t:0}Object.assign(Jr.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,n){const r=Xr.subVectors(n,t).cross(Qr.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Qn),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new Qn);const n=e.delta(Xr),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:t.copy(n).multiplyScalar(i).add(e.start)},intersectsLine:function(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Qn),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){const n=t||Zr.getNormalMatrix(e),r=this.coplanarPoint(Xr).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});const $r=new Qn,ei=new Qn,ti=new Qn,ni=new Qn,ri=new Qn,ii=new Qn,ai=new Qn,oi=new Qn,si=new Qn,ui=new Qn;function li(e,t,n){this.a=void 0!==e?e:new Qn,this.b=void 0!==t?t:new Qn,this.c=void 0!==n?n:new Qn}Object.assign(li,{getNormal:function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Qn),r.subVectors(n,t),$r.subVectors(e,t),r.cross($r);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},getBarycoord:function(e,t,n,r,i){$r.subVectors(r,t),ei.subVectors(n,t),ti.subVectors(e,t);const a=$r.dot($r),o=$r.dot(ei),s=$r.dot(ti),u=ei.dot(ei),l=ei.dot(ti),c=a*u-o*o;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Qn),0===c)return i.set(-2,-1,-1);const d=1/c,h=(u*s-o*l)*d,f=(a*l-o*s)*d;return i.set(1-h-f,f,h)},containsPoint:function(e,t,n,r){return li.getBarycoord(e,t,n,r,ni),ni.x>=0&&ni.y>=0&&ni.x+ni.y<=1},getUV:function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,ni),s.set(0,0),s.addScaledVector(i,ni.x),s.addScaledVector(a,ni.y),s.addScaledVector(o,ni.z),s},isFrontFacing:function(e,t,n,r){return $r.subVectors(n,t),ei.subVectors(e,t),$r.cross(ei).dot(r)<0}}),Object.assign(li.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return $r.subVectors(this.c,this.b),ei.subVectors(this.a,this.b),.5*$r.cross(ei).length()},getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Qn),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return li.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Jr),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return li.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,r,i){return li.getUV(e,this.a,this.b,this.c,t,n,r,i)},containsPoint:function(e){return li.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return li.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Qn);const n=this.a,r=this.b,i=this.c;let a,o;ri.subVectors(r,n),ii.subVectors(i,n),oi.subVectors(e,n);const s=ri.dot(oi),u=ii.dot(oi);if(s<=0&&u<=0)return t.copy(n);si.subVectors(e,r);const l=ri.dot(si),c=ii.dot(si);if(l>=0&&c<=l)return t.copy(r);const d=s*c-l*u;if(d<=0&&s>=0&&l<=0)return a=s/(s-l),t.copy(n).addScaledVector(ri,a);ui.subVectors(e,i);const h=ri.dot(ui),f=ii.dot(ui);if(f>=0&&h<=f)return t.copy(i);const p=h*u-s*f;if(p<=0&&u>=0&&f<=0)return o=u/(u-f),t.copy(n).addScaledVector(ii,o);const m=l*f-h*c;if(m<=0&&c-l>=0&&h-f>=0)return ai.subVectors(i,r),o=(c-l)/(c-l+(h-f)),t.copy(r).addScaledVector(ai,o);const g=1/(m+p+d);return a=p*g,o=d*g,t.copy(n).addScaledVector(ri,a).addScaledVector(ii,o)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});const ci={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},di={h:0,s:0,l:0},hi={h:0,s:0,l:0};function fi(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}function pi(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function mi(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function gi(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function vi(e,t,n,r,i,a){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new Qn,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new fi,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}Object.assign(fi.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(e=Fn.euclideanModulo(e,1),t=Fn.clamp(t,0,1),n=Fn.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=pi(i,r,e+1/3),this.g=pi(i,r,e),this.b=pi(i,r,e-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){let e;const r=n[1],i=n[2];switch(r){case"rgb":case"rgba":if(e=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,t(e[5]),this;if(e=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,t(e[5]),this;break;case"hsl":case"hsla":if(e=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i)){const n=parseFloat(e[1])/360,r=parseInt(e[2],10)/100,i=parseInt(e[3],10)/100;return t(e[5]),this.setHSL(n,r,i)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){const e=n[1],t=e.length;if(3===t)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,this;if(6===t)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){const t=ci[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);const n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=mi(e.r),this.g=mi(e.g),this.b=mi(e.b),this},copyLinearToSRGB:function(e){return this.r=gi(e.r),this.g=gi(e.g),this.b=gi(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});const t=this.r,n=this.g,r=this.b,i=Math.max(t,n,r),a=Math.min(t,n,r);let o,s;const u=(a+i)/2;if(a===i)o=0,s=0;else{const e=i-a;switch(s=u<=.5?e/(i+a):e/(2-i-a),i){case t:o=(n-r)/e+(n<r?6:0);break;case n:o=(r-t)/e+2;break;case r:o=(t-n)/e+4}o/=6}return e.h=o,e.s=s,e.l=u,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){return this.getHSL(di),di.h+=e,di.s+=t,di.l+=n,this.setHSL(di.h,di.s,di.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(di),e.getHSL(hi);const n=Fn.lerp(di.h,hi.h,t),r=Fn.lerp(di.s,hi.s,t),i=Fn.lerp(di.l,hi.l,t);return this.setHSL(n,r,i),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},fromBufferAttribute:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},toJSON:function(){return this.getHex()}}),fi.NAMES=ci,Object.assign(vi.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});let yi=0;function _i(){Object.defineProperty(this,"id",{value:yi++}),this.uuid=Fn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=b,this.side=p,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=L,this.blendDst=N,this.blendEquation=A,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=z,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=wn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=cn,this.stencilZFail=cn,this.stencilZPass=cn,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function bi(e){_i.call(this),this.type="MeshBasicMaterial",this.color=new fi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=X,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}_i.prototype=Object.assign(Object.create(Ln.prototype),{constructor:_i,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===v;continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}},toJSON:function(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==b&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==p&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(_i.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),bi.prototype=Object.create(_i.prototype),bi.prototype.constructor=bi,bi.prototype.isMeshBasicMaterial=!0,bi.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};const Ei=new Qn,Ti=new Bn;function Si(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=An,this.updateRange={offset:0,count:-1},this.version=0}function wi(e,t,n){Si.call(this,new Int8Array(e),t,n)}function Ai(e,t,n){Si.call(this,new Uint8Array(e),t,n)}function xi(e,t,n){Si.call(this,new Uint8ClampedArray(e),t,n)}function Mi(e,t,n){Si.call(this,new Int16Array(e),t,n)}function Ci(e,t,n){Si.call(this,new Uint16Array(e),t,n)}function Ri(e,t,n){Si.call(this,new Int32Array(e),t,n)}function Ii(e,t,n){Si.call(this,new Uint32Array(e),t,n)}function Oi(e,t,n){Si.call(this,new Float32Array(e),t,n)}function Di(e,t,n){Si.call(this,new Float64Array(e),t,n)}function Pi(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Li(e){if(0===e.length)return-1/0;let t=e[0];for(let n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty(Si.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Si.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new fi),t[n++]=i.r,t[n++]=i.g,t[n++]=i.b}return this},copyVector2sArray:function(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new Bn),t[n++]=i.x,t[n++]=i.y}return this},copyVector3sArray:function(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new Qn),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z}return this},copyVector4sArray:function(e){const t=this.array;let n=0;for(let r=0,i=e.length;r<i;r++){let i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new zn),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z,t[n++]=i.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Ti.fromBufferAttribute(this,t),Ti.applyMatrix3(e),this.setXY(t,Ti.x,Ti.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Ei.fromBufferAttribute(this,t),Ei.applyMatrix3(e),this.setXYZ(t,Ei.x,Ei.y,Ei.z);return this},applyMatrix4:function(e){for(let t=0,n=this.count;t<n;t++)Ei.x=this.getX(t),Ei.y=this.getY(t),Ei.z=this.getZ(t),Ei.applyMatrix4(e),this.setXYZ(t,Ei.x,Ei.y,Ei.z);return this},applyNormalMatrix:function(e){for(let t=0,n=this.count;t<n;t++)Ei.x=this.getX(t),Ei.y=this.getY(t),Ei.z=this.getZ(t),Ei.applyNormalMatrix(e),this.setXYZ(t,Ei.x,Ei.y,Ei.z);return this},transformDirection:function(e){for(let t=0,n=this.count;t<n;t++)Ei.x=this.getX(t),Ei.y=this.getY(t),Ei.z=this.getZ(t),Ei.transformDirection(e),this.setXYZ(t,Ei.x,Ei.y,Ei.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),wi.prototype=Object.create(Si.prototype),wi.prototype.constructor=wi,Ai.prototype=Object.create(Si.prototype),Ai.prototype.constructor=Ai,xi.prototype=Object.create(Si.prototype),xi.prototype.constructor=xi,Mi.prototype=Object.create(Si.prototype),Mi.prototype.constructor=Mi,Ci.prototype=Object.create(Si.prototype),Ci.prototype.constructor=Ci,Ri.prototype=Object.create(Si.prototype),Ri.prototype.constructor=Ri,Ii.prototype=Object.create(Si.prototype),Ii.prototype.constructor=Ii,Oi.prototype=Object.create(Si.prototype),Oi.prototype.constructor=Oi,Di.prototype=Object.create(Si.prototype),Di.prototype.constructor=Di,Object.assign(Pi.prototype,{computeGroups:function(e){const t=[];let n,r,i=void 0;const a=e.faces;for(r=0;r<a.length;r++){const e=a[r];e.materialIndex!==i&&(i=e.materialIndex,void 0!==n&&(n.count=3*r-n.start,t.push(n)),n={start:3*r,materialIndex:i})}void 0!==n&&(n.count=3*r-n.start,t.push(n)),this.groups=t},fromGeometry:function(e){const t=e.faces,n=e.vertices,r=e.faceVertexUvs,i=r[0]&&r[0].length>0,a=r[1]&&r[1].length>0,o=e.morphTargets,s=o.length;let u;if(s>0){u=[];for(let e=0;e<s;e++)u[e]={name:o[e].name,data:[]};this.morphTargets.position=u}const l=e.morphNormals,c=l.length;let d;if(c>0){d=[];for(let e=0;e<c;e++)d[e]={name:l[e].name,data:[]};this.morphTargets.normal=d}const h=e.skinIndices,f=e.skinWeights,p=h.length===n.length,m=f.length===n.length;n.length>0&&0===t.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let e=0;e<t.length;e++){const g=t[e];this.vertices.push(n[g.a],n[g.b],n[g.c]);const v=g.vertexNormals;if(3===v.length)this.normals.push(v[0],v[1],v[2]);else{const e=g.normal;this.normals.push(e,e,e)}const y=g.vertexColors;if(3===y.length)this.colors.push(y[0],y[1],y[2]);else{const e=g.color;this.colors.push(e,e,e)}if(!0===i){const t=r[0][e];void 0!==t?this.uvs.push(t[0],t[1],t[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",e),this.uvs.push(new Bn,new Bn,new Bn))}if(!0===a){const t=r[1][e];void 0!==t?this.uvs2.push(t[0],t[1],t[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",e),this.uvs2.push(new Bn,new Bn,new Bn))}for(let e=0;e<s;e++){const t=o[e].vertices;u[e].data.push(t[g.a],t[g.b],t[g.c])}for(let t=0;t<c;t++){const n=l[t].vertexNormals[e];d[t].data.push(n.a,n.b,n.c)}p&&this.skinIndices.push(h[g.a],h[g.b],h[g.c]),m&&this.skinWeights.push(f[g.a],f[g.b],f[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});let Ni=1;const ki=new ir,Fi=new Tr,Bi=new Qn,Ui=new Fr,ji=new Fr,Gi=new Qn;function Hi(){Object.defineProperty(this,"id",{value:Ni+=2}),this.uuid=Fn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Hi.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Hi,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Li(e)>65535?Ii:Ci)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new Un).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return ki.makeRotationX(e),this.applyMatrix4(ki),this},rotateY:function(e){return ki.makeRotationY(e),this.applyMatrix4(ki),this},rotateZ:function(e){return ki.makeRotationZ(e),this.applyMatrix4(ki),this},translate:function(e,t,n){return ki.makeTranslation(e,t,n),this.applyMatrix4(ki),this},scale:function(e,t,n){return ki.makeScale(e,t,n),this.applyMatrix4(ki),this},lookAt:function(e){return Fi.lookAt(e),Fi.updateMatrix(),this.applyMatrix4(Fi.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Bi).negate(),this.translate(Bi.x,Bi.y,Bi.z),this},setFromObject:function(e){const t=e.geometry;if(e.isPoints||e.isLine){const e=new Oi(3*t.vertices.length,3),n=new Oi(3*t.colors.length,3);if(this.setAttribute("position",e.copyVector3sArray(t.vertices)),this.setAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){const e=new Oi(t.lineDistances.length,1);this.setAttribute("lineDistance",e.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Oi(t,3)),this},updateFromObject:function(e){let t=e.geometry;if(e.isMesh){let e=t.__directGeometry;if(!0===t.elementsNeedUpdate&&(e=void 0,t.elementsNeedUpdate=!1),void 0===e)return this.fromGeometry(t);e.verticesNeedUpdate=t.verticesNeedUpdate,e.normalsNeedUpdate=t.normalsNeedUpdate,e.colorsNeedUpdate=t.colorsNeedUpdate,e.uvsNeedUpdate=t.uvsNeedUpdate,e.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=e}if(!0===t.verticesNeedUpdate){const e=this.attributes.position;void 0!==e&&(e.copyVector3sArray(t.vertices),e.needsUpdate=!0),t.verticesNeedUpdate=!1}if(!0===t.normalsNeedUpdate){const e=this.attributes.normal;void 0!==e&&(e.copyVector3sArray(t.normals),e.needsUpdate=!0),t.normalsNeedUpdate=!1}if(!0===t.colorsNeedUpdate){const e=this.attributes.color;void 0!==e&&(e.copyColorsArray(t.colors),e.needsUpdate=!0),t.colorsNeedUpdate=!1}if(t.uvsNeedUpdate){const e=this.attributes.uv;void 0!==e&&(e.copyVector2sArray(t.uvs),e.needsUpdate=!0),t.uvsNeedUpdate=!1}if(t.lineDistancesNeedUpdate){const e=this.attributes.lineDistance;void 0!==e&&(e.copyArray(t.lineDistances),e.needsUpdate=!0),t.lineDistancesNeedUpdate=!1}return t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Pi).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){const t=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new Si(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){const t=new Float32Array(3*e.normals.length);this.setAttribute("normal",new Si(t,3).copyVector3sArray(e.normals))}if(e.colors.length>0){const t=new Float32Array(3*e.colors.length);this.setAttribute("color",new Si(t,3).copyColorsArray(e.colors))}if(e.uvs.length>0){const t=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new Si(t,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){const t=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new Si(t,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(const t in e.morphTargets){const n=[],r=e.morphTargets[t];for(let e=0,t=r.length;e<t;e++){const t=r[e],i=new Oi(3*t.data.length,3);i.name=t.name,n.push(i.copyVector3sArray(t.data))}this.morphAttributes[t]=n}if(e.skinIndices.length>0){const t=new Oi(4*e.skinIndices.length,4);this.setAttribute("skinIndex",t.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){const t=new Oi(4*e.skinWeights.length,4);this.setAttribute("skinWeight",t.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Fr);const e=this.attributes.position,t=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];Ui.setFromBufferAttribute(n),this.morphTargetsRelative?(Gi.addVectors(this.boundingBox.min,Ui.min),this.boundingBox.expandByPoint(Gi),Gi.addVectors(this.boundingBox.max,Ui.max),this.boundingBox.expandByPoint(Gi)):(this.boundingBox.expandByPoint(Ui.min),this.boundingBox.expandByPoint(Ui.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new jr);const e=this.attributes.position,t=this.morphAttributes.position;if(e){const n=this.boundingSphere.center;if(Ui.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];ji.setFromBufferAttribute(n),this.morphTargetsRelative?(Gi.addVectors(Ui.min,ji.min),Ui.expandByPoint(Gi),Gi.addVectors(Ui.max,ji.max),Ui.expandByPoint(Gi)):(Ui.expandByPoint(ji.min),Ui.expandByPoint(ji.max))}Ui.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)Gi.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(Gi));if(t)for(let i=0,a=t.length;i<a;i++){const a=t[i],o=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)Gi.fromBufferAttribute(a,t),o&&(Bi.fromBufferAttribute(e,t),Gi.add(Bi)),r=Math.max(r,n.distanceToSquared(Gi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Si(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new Qn,i=new Qn,a=new Qn,o=new Qn,s=new Qn,u=new Qn,l=new Qn,c=new Qn;if(e)for(let d=0,h=e.count;d<h;d+=3){const h=e.getX(d+0),f=e.getX(d+1),p=e.getX(d+2);r.fromBufferAttribute(t,h),i.fromBufferAttribute(t,f),a.fromBufferAttribute(t,p),l.subVectors(a,i),c.subVectors(r,i),l.cross(c),o.fromBufferAttribute(n,h),s.fromBufferAttribute(n,f),u.fromBufferAttribute(n,p),o.add(l),s.add(l),u.add(l),n.setXYZ(h,o.x,o.y,o.z),n.setXYZ(f,s.x,s.y,s.z),n.setXYZ(p,u.x,u.y,u.z)}else for(let e=0,o=t.count;e<o;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),l.subVectors(a,i),c.subVectors(r,i),l.cross(c),n.setXYZ(e+0,l.x,l.y,l.z),n.setXYZ(e+1,l.x,l.y,l.z),n.setXYZ(e+2,l.x,l.y,l.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===e.attributes[r])continue;const i=n[r].array,a=e.attributes[r],o=a.array,s=a.itemSize*t,u=Math.min(o.length,i.length-s);for(let e=0,t=s;e<u;e++,t++)i[t]=o[e]}return this},normalizeNormals:function(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Gi.fromBufferAttribute(e,t),Gi.normalize(),e.setXYZ(t,Gi.x,Gi.y,Gi.z)},toNonIndexed:function(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r);let o=0,s=0;for(let e=0,i=t.length;e<i;e++){o=t[e]*r;for(let e=0;e<r;e++)a[s++]=n[o++]}return new Si(a,r,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const t=new Hi,n=this.index.array,r=this.attributes;for(const i in r){const a=e(r[i],n);t.setAttribute(i,a)}const i=this.morphAttributes;for(const r in i){const a=[],o=i[r];for(let t=0,r=o.length;t<r;t++){const r=e(o[t],n);a.push(r)}t.morphAttributes[r]=a}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let e=0,n=a.length;e<n;e++){const n=a[e];t.addGroup(n.start,n.count,n.materialIndex)}return t},toJSON:function(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const t in n){const r=n[t],i=r.toJSON(e.data);""!==r.name&&(i.name=r.name),e.data.attributes[t]=i}const r={};let i=!1;for(const t in this.morphAttributes){const n=this.morphAttributes[t],a=[];for(let t=0,r=n.length;t<r;t++){const r=n[t],i=r.toJSON(e.data);""!==r.name&&(i.name=r.name),a.push(i)}a.length>0&&(r[t]=a,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e},clone:function(){return(new Hi).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const e in r){const n=r[e];this.setAttribute(e,n.clone(t))}const i=e.morphAttributes;for(const e in i){const n=[],r=i[e];for(let e=0,i=r.length;e<i;e++)n.push(r[e].clone(t));this.morphAttributes[e]=n}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let e=0,t=a.length;e<t;e++){const t=a[e];this.addGroup(t.start,t.count,t.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Vi=new ir,zi=new Kr,Wi=new jr,qi=new Qn,Yi=new Qn,Ki=new Qn,Xi=new Qn,Qi=new Qn,Zi=new Qn,Ji=new Qn,$i=new Qn,ea=new Qn,ta=new Bn,na=new Bn,ra=new Bn,ia=new Qn,aa=new Qn;function oa(e,t){Tr.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Hi,this.material=void 0!==t?t:new bi,this.updateMorphTargets()}function sa(e,t,n,r,i,a,o,s){let u;if(u=t.side===m?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side!==g,s),null===u)return null;aa.copy(s),aa.applyMatrix4(e.matrixWorld);const l=n.ray.origin.distanceTo(aa);return l<n.near||l>n.far?null:{distance:l,point:aa.clone(),object:e}}function ua(e,t,n,r,i,a,o,s,u,l,c,d){qi.fromBufferAttribute(i,l),Yi.fromBufferAttribute(i,c),Ki.fromBufferAttribute(i,d);const h=e.morphTargetInfluences;if(t.morphTargets&&a&&h){Ji.set(0,0,0),$i.set(0,0,0),ea.set(0,0,0);for(let e=0,t=a.length;e<t;e++){const t=h[e],n=a[e];0!==t&&(Xi.fromBufferAttribute(n,l),Qi.fromBufferAttribute(n,c),Zi.fromBufferAttribute(n,d),o?(Ji.addScaledVector(Xi,t),$i.addScaledVector(Qi,t),ea.addScaledVector(Zi,t)):(Ji.addScaledVector(Xi.sub(qi),t),$i.addScaledVector(Qi.sub(Yi),t),ea.addScaledVector(Zi.sub(Ki),t)))}qi.add(Ji),Yi.add($i),Ki.add(ea)}e.isSkinnedMesh&&(e.boneTransform(l,qi),e.boneTransform(c,Yi),e.boneTransform(d,Ki));const f=sa(e,t,n,r,qi,Yi,Ki,ia);if(f){s&&(ta.fromBufferAttribute(s,l),na.fromBufferAttribute(s,c),ra.fromBufferAttribute(s,d),f.uv=li.getUV(ia,qi,Yi,Ki,ta,na,ra,new Bn)),u&&(ta.fromBufferAttribute(u,l),na.fromBufferAttribute(u,c),ra.fromBufferAttribute(u,d),f.uv2=li.getUV(ia,qi,Yi,Ki,ta,na,ra,new Bn));const e=new vi(l,c,d);li.getNormal(qi,Yi,Ki,e.normal),f.face=e}return f}oa.prototype=Object.assign(Object.create(Tr.prototype),{constructor:oa,isMesh:!0,copy:function(e){return Tr.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0===r)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),Wi.copy(n.boundingSphere),Wi.applyMatrix4(i),!1===e.ray.intersectsSphere(Wi))return;if(Vi.getInverse(i),zi.copy(e.ray).applyMatrix4(Vi),null!==n.boundingBox&&!1===zi.intersectsBox(n.boundingBox))return;let a;if(n.isBufferGeometry){const i=n.index,o=n.attributes.position,s=n.morphAttributes.position,u=n.morphTargetsRelative,l=n.attributes.uv,c=n.attributes.uv2,d=n.groups,h=n.drawRange;if(null!==i)if(Array.isArray(r))for(let n=0,f=d.length;n<f;n++){const f=d[n],p=r[f.materialIndex];for(let n=Math.max(f.start,h.start),r=Math.min(f.start+f.count,h.start+h.count);n<r;n+=3){const r=i.getX(n),d=i.getX(n+1),h=i.getX(n+2);a=ua(this,p,e,zi,o,s,u,l,c,r,d,h),a&&(a.faceIndex=Math.floor(n/3),a.face.materialIndex=f.materialIndex,t.push(a))}}else{for(let n=Math.max(0,h.start),d=Math.min(i.count,h.start+h.count);n<d;n+=3){const d=i.getX(n),h=i.getX(n+1),f=i.getX(n+2);a=ua(this,r,e,zi,o,s,u,l,c,d,h,f),a&&(a.faceIndex=Math.floor(n/3),t.push(a))}}else if(void 0!==o)if(Array.isArray(r))for(let n=0,i=d.length;n<i;n++){const i=d[n],f=r[i.materialIndex];for(let n=Math.max(i.start,h.start),r=Math.min(i.start+i.count,h.start+h.count);n<r;n+=3){a=ua(this,f,e,zi,o,s,u,l,c,n,n+1,n+2),a&&(a.faceIndex=Math.floor(n/3),a.face.materialIndex=i.materialIndex,t.push(a))}}else{for(let n=Math.max(0,h.start),i=Math.min(o.count,h.start+h.count);n<i;n+=3){a=ua(this,r,e,zi,o,s,u,l,c,n,n+1,n+2),a&&(a.faceIndex=Math.floor(n/3),t.push(a))}}}else if(n.isGeometry){const i=Array.isArray(r),o=n.vertices,s=n.faces;let u;const l=n.faceVertexUvs[0];l.length>0&&(u=l);for(let n=0,l=s.length;n<l;n++){const l=s[n],c=i?r[l.materialIndex]:r;if(void 0===c)continue;const d=o[l.a],h=o[l.b],f=o[l.c];if(a=sa(this,c,e,zi,d,h,f,ia),a){if(u&&u[n]){const e=u[n];ta.copy(e[0]),na.copy(e[1]),ra.copy(e[2]),a.uv=li.getUV(ia,d,h,f,ta,na,ra,new Bn)}a.face=l,a.faceIndex=n,t.push(a)}}}}});let la=0;const ca=new ir,da=new Tr,ha=new Qn;function fa(){Object.defineProperty(this,"id",{value:la+=2}),this.uuid=Fn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}fa.prototype=Object.assign(Object.create(Ln.prototype),{constructor:fa,isGeometry:!0,applyMatrix4:function(e){const t=(new Un).getNormalMatrix(e);for(let t=0,n=this.vertices.length;t<n;t++){this.vertices[t].applyMatrix4(e)}for(let e=0,n=this.faces.length;e<n;e++){const n=this.faces[e];n.normal.applyMatrix3(t).normalize();for(let e=0,r=n.vertexNormals.length;e<r;e++)n.vertexNormals[e].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return ca.makeRotationX(e),this.applyMatrix4(ca),this},rotateY:function(e){return ca.makeRotationY(e),this.applyMatrix4(ca),this},rotateZ:function(e){return ca.makeRotationZ(e),this.applyMatrix4(ca),this},translate:function(e,t,n){return ca.makeTranslation(e,t,n),this.applyMatrix4(ca),this},scale:function(e,t,n){return ca.makeScale(e,t,n),this.applyMatrix4(ca),this},lookAt:function(e){return da.lookAt(e),da.updateMatrix(),this.applyMatrix4(da.matrix),this},fromBufferGeometry:function(e){const t=this,n=null!==e.index?e.index:void 0,r=e.attributes;if(void 0===r.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const i=r.position,a=r.normal,o=r.color,s=r.uv,u=r.uv2;void 0!==u&&(this.faceVertexUvs[1]=[]);for(let e=0;e<i.count;e++)t.vertices.push((new Qn).fromBufferAttribute(i,e)),void 0!==o&&t.colors.push((new fi).fromBufferAttribute(o,e));function l(e,n,r,i){const l=void 0===o?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[r].clone()],c=new vi(e,n,r,void 0===a?[]:[(new Qn).fromBufferAttribute(a,e),(new Qn).fromBufferAttribute(a,n),(new Qn).fromBufferAttribute(a,r)],l,i);t.faces.push(c),void 0!==s&&t.faceVertexUvs[0].push([(new Bn).fromBufferAttribute(s,e),(new Bn).fromBufferAttribute(s,n),(new Bn).fromBufferAttribute(s,r)]),void 0!==u&&t.faceVertexUvs[1].push([(new Bn).fromBufferAttribute(u,e),(new Bn).fromBufferAttribute(u,n),(new Bn).fromBufferAttribute(u,r)])}const c=e.groups;if(c.length>0)for(let e=0;e<c.length;e++){const t=c[e],r=t.start;for(let e=r,i=r+t.count;e<i;e+=3)void 0!==n?l(n.getX(e),n.getX(e+1),n.getX(e+2),t.materialIndex):l(e,e+1,e+2,t.materialIndex)}else if(void 0!==n)for(let e=0;e<n.count;e+=3)l(n.getX(e),n.getX(e+1),n.getX(e+2));else for(let e=0;e<i.count;e+=3)l(e,e+1,e+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ha).negate(),this.translate(ha.x,ha.y,ha.z),this},normalize:function(){this.computeBoundingSphere();const e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,r=new ir;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){const e=new Qn,t=new Qn;for(let n=0,r=this.faces.length;n<r;n++){const r=this.faces[n],i=this.vertices[r.a],a=this.vertices[r.b],o=this.vertices[r.c];e.subVectors(o,a),t.subVectors(i,a),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){void 0===e&&(e=!0);const t=new Array(this.vertices.length);for(let e=0,n=this.vertices.length;e<n;e++)t[e]=new Qn;if(e){const e=new Qn,n=new Qn;for(let r=0,i=this.faces.length;r<i;r++){const i=this.faces[r],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,o),n.subVectors(a,o),e.cross(n),t[i.a].add(e),t[i.b].add(e),t[i.c].add(e)}}else{this.computeFaceNormals();for(let e=0,n=this.faces.length;e<n;e++){const n=this.faces[e];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let e=0,n=this.vertices.length;e<n;e++)t[e].normalize();for(let e=0,n=this.faces.length;e<n;e++){const n=this.faces[e],r=n.vertexNormals;3===r.length?(r[0].copy(t[n.a]),r[1].copy(t[n.b]),r[2].copy(t[n.c])):(r[0]=t[n.a].clone(),r[1]=t[n.b].clone(),r[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e],n=t.vertexNormals;3===n.length?(n[0].copy(t.normal),n[1].copy(t.normal),n[2].copy(t.normal)):(n[0]=t.normal.clone(),n[1]=t.normal.clone(),n[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e];t.__originalFaceNormal?t.__originalFaceNormal.copy(t.normal):t.__originalFaceNormal=t.normal.clone(),t.__originalVertexNormals||(t.__originalVertexNormals=[]);for(let e=0,n=t.vertexNormals.length;e<n;e++)t.__originalVertexNormals[e]?t.__originalVertexNormals[e].copy(t.vertexNormals[e]):t.__originalVertexNormals[e]=t.vertexNormals[e].clone()}const e=new fa;e.faces=this.faces;for(let t=0,n=this.morphTargets.length;t<n;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];const e=this.morphNormals[t].faceNormals,n=this.morphNormals[t].vertexNormals;for(let t=0,r=this.faces.length;t<r;t++){const t=new Qn,r={a:new Qn,b:new Qn,c:new Qn};e.push(t),n.push(r)}}const n=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e],r=n.faceNormals[e],i=n.vertexNormals[e];r.copy(t.normal),i.a.copy(t.vertexNormals[0]),i.b.copy(t.vertexNormals[1]),i.c.copy(t.vertexNormals[2])}}for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e];t.normal=t.__originalFaceNormal,t.vertexNormals=t.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Fr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new jr),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(!e||!e.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);let r,i=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,u=e.faces,l=this.colors,c=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new Un).getNormalMatrix(t));for(let e=0,n=o.length;e<n;e++){const n=o[e].clone();void 0!==t&&n.applyMatrix4(t),a.push(n)}for(let e=0,t=c.length;e<t;e++)l.push(c[e].clone());for(let e=0,t=u.length;e<t;e++){let t,a,o,l=u[e],c=l.vertexNormals,d=l.vertexColors;t=new vi(l.a+i,l.b+i,l.c+i),t.normal.copy(l.normal),void 0!==r&&t.normal.applyMatrix3(r).normalize();for(let e=0,n=c.length;e<n;e++)a=c[e].clone(),void 0!==r&&a.applyMatrix3(r).normalize(),t.vertexNormals.push(a);t.color.copy(l.color);for(let e=0,n=d.length;e<n;e++)o=d[e],t.vertexColors.push(o.clone());t.materialIndex=l.materialIndex+n,s.push(t)}for(let t=0,n=e.faceVertexUvs.length;t<n;t++){const n=e.faceVertexUvs[t];void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]);for(let e=0,r=n.length;e<r;e++){const r=n[e],i=[];for(let e=0,t=r.length;e<t;e++)i.push(r[e].clone());this.faceVertexUvs[t].push(i)}}},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){const e={},t=[],n=[],r=Math.pow(10,4);for(let i=0,a=this.vertices.length;i<a;i++){const a=this.vertices[i],o=Math.round(a.x*r)+"_"+Math.round(a.y*r)+"_"+Math.round(a.z*r);void 0===e[o]?(e[o]=i,t.push(this.vertices[i]),n[i]=t.length-1):n[i]=n[e[o]]}const i=[];for(let e=0,t=this.faces.length;e<t;e++){const t=this.faces[e];t.a=n[t.a],t.b=n[t.b],t.c=n[t.c];const r=[t.a,t.b,t.c];for(let t=0;t<3;t++)if(r[t]===r[(t+1)%3]){i.push(e);break}}for(let e=i.length-1;e>=0;e--){const t=i[e];this.faces.splice(t,1);for(let e=0,n=this.faceVertexUvs.length;e<n;e++)this.faceVertexUvs[e].splice(t,1)}const a=this.vertices.length-t.length;return this.vertices=t,a},setFromPoints:function(e){this.vertices=[];for(let t=0,n=e.length;t<n;t++){const n=e[t];this.vertices.push(new Qn(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){const e=this.faces,t=e.length;for(let n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));const n=this.faceVertexUvs[0],r=this.faceVertexUvs[1];let i,a;n&&n.length===t&&(i=[]),r&&r.length===t&&(a=[]);for(let o=0;o<t;o++){const t=e[o]._id;i&&i.push(n[t]),a&&a.push(r[t])}i&&(this.faceVertexUvs[0]=i),a&&(this.faceVertexUvs[1]=a)},toJSON:function(){const e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}const t=[];for(let e=0;e<this.vertices.length;e++){const n=this.vertices[e];t.push(n.x,n.y,n.z)}const n=[],r=[],i={},a=[],o={},s=[],u={};for(let e=0;e<this.faces.length;e++){const t=this.faces[e],r=!0,i=!1,a=void 0!==this.faceVertexUvs[0][e],o=t.normal.length()>0,s=t.vertexNormals.length>0,u=1!==t.color.r||1!==t.color.g||1!==t.color.b,f=t.vertexColors.length>0;let p=0;if(p=l(p,0,0),p=l(p,1,r),p=l(p,2,i),p=l(p,3,a),p=l(p,4,o),p=l(p,5,s),p=l(p,6,u),p=l(p,7,f),n.push(p),n.push(t.a,t.b,t.c),n.push(t.materialIndex),a){const t=this.faceVertexUvs[0][e];n.push(h(t[0]),h(t[1]),h(t[2]))}if(o&&n.push(c(t.normal)),s){const e=t.vertexNormals;n.push(c(e[0]),c(e[1]),c(e[2]))}if(u&&n.push(d(t.color)),f){const e=t.vertexColors;n.push(d(e[0]),d(e[1]),d(e[2]))}}function l(e,t,n){return n?e|1<<t:e&~(1<<t)}function c(e){const t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==i[t]||(i[t]=r.length/3,r.push(e.x,e.y,e.z)),i[t]}function d(e){const t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==o[t]||(o[t]=a.length,a.push(e.getHex())),o[t]}function h(e){const t=e.x.toString()+e.y.toString();return void 0!==u[t]||(u[t]=s.length/2,s.push(e.x,e.y)),u[t]}return e.data={},e.data.vertices=t,e.data.normals=r,a.length>0&&(e.data.colors=a),s.length>0&&(e.data.uvs=[s]),e.data.faces=n,e},clone:function(){return(new fa).copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;const t=e.vertices;for(let e=0,n=t.length;e<n;e++)this.vertices.push(t[e].clone());const n=e.colors;for(let e=0,t=n.length;e<t;e++)this.colors.push(n[e].clone());const r=e.faces;for(let e=0,t=r.length;e<t;e++)this.faces.push(r[e].clone());for(let t=0,n=e.faceVertexUvs.length;t<n;t++){const n=e.faceVertexUvs[t];void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]);for(let e=0,r=n.length;e<r;e++){const r=n[e],i=[];for(let e=0,t=r.length;e<t;e++){const t=r[e];i.push(t.clone())}this.faceVertexUvs[t].push(i)}}const i=e.morphTargets;for(let e=0,t=i.length;e<t;e++){const t={};if(t.name=i[e].name,void 0!==i[e].vertices){t.vertices=[];for(let n=0,r=i[e].vertices.length;n<r;n++)t.vertices.push(i[e].vertices[n].clone())}if(void 0!==i[e].normals){t.normals=[];for(let n=0,r=i[e].normals.length;n<r;n++)t.normals.push(i[e].normals[n].clone())}this.morphTargets.push(t)}const a=e.morphNormals;for(let e=0,t=a.length;e<t;e++){const t={};if(void 0!==a[e].vertexNormals){t.vertexNormals=[];for(let n=0,r=a[e].vertexNormals.length;n<r;n++){const r=a[e].vertexNormals[n],i={};i.a=r.a.clone(),i.b=r.b.clone(),i.c=r.c.clone(),t.vertexNormals.push(i)}}if(void 0!==a[e].faceNormals){t.faceNormals=[];for(let n=0,r=a[e].faceNormals.length;n<r;n++)t.faceNormals.push(a[e].faceNormals[n].clone())}this.morphNormals.push(t)}const o=e.skinWeights;for(let e=0,t=o.length;e<t;e++)this.skinWeights.push(o[e].clone());const s=e.skinIndices;for(let e=0,t=s.length;e<t;e++)this.skinIndices.push(s[e].clone());const u=e.lineDistances;for(let e=0,t=u.length;e<t;e++)this.lineDistances.push(u[e]);const l=e.boundingBox;null!==l&&(this.boundingBox=l.clone());const c=e.boundingSphere;return null!==c&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class pa extends fa{constructor(e,t,n,r,i,a){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new ma(e,t,n,r,i,a)),this.mergeVertices()}}class ma extends Hi{constructor(e=1,t=1,n=1,r=1,i=1,a=1){super(),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const o=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const s=[],u=[],l=[],c=[];let d=0,h=0;function f(e,t,n,r,i,a,f,p,m,g,v){const y=a/m,_=f/g,b=a/2,E=f/2,T=p/2,S=m+1,w=g+1;let A=0,x=0;const M=new Qn;for(let a=0;a<w;a++){const o=a*_-E;for(let s=0;s<S;s++){const d=s*y-b;M[e]=d*r,M[t]=o*i,M[n]=T,u.push(M.x,M.y,M.z),M[e]=0,M[t]=0,M[n]=p>0?1:-1,l.push(M.x,M.y,M.z),c.push(s/m),c.push(1-a/g),A+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const n=d+t+S*e,r=d+t+S*(e+1),i=d+(t+1)+S*(e+1),a=d+(t+1)+S*e;s.push(n,r,a),s.push(r,i,a),x+=6}o.addGroup(h,x,v),h+=x,d+=A}f("z","y","x",-1,-1,n,t,e,a,i,0),f("z","y","x",1,-1,n,t,-e,a,i,1),f("x","z","y",1,1,e,n,t,r,a,2),f("x","z","y",1,-1,e,n,-t,r,a,3),f("x","y","z",1,-1,e,t,n,r,i,4),f("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new Oi(u,3)),this.setAttribute("normal",new Oi(l,3)),this.setAttribute("uv",new Oi(c,2))}}function ga(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function va(e){const t={};for(let n=0;n<e.length;n++){const r=ga(e[n]);for(const e in r)t[e]=r[e]}return t}const ya={clone:ga,merge:va};function _a(e){_i.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function ba(){Tr.call(this),this.type="Camera",this.matrixWorldInverse=new ir,this.projectionMatrix=new ir,this.projectionMatrixInverse=new ir}function Ea(e,t,n,r){ba.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}_a.prototype=Object.create(_i.prototype),_a.prototype.constructor=_a,_a.prototype.isShaderMaterial=!0,_a.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ga(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this},_a.prototype.toJSON=function(e){const t=_i.prototype.toJSON.call(this,e);t.uniforms={};for(const n in this.uniforms){const r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const e in this.extensions)!0===this.extensions[e]&&(n[e]=!0);return Object.keys(n).length>0&&(t.extensions=n),t},ba.prototype=Object.assign(Object.create(Tr.prototype),{constructor:ba,isCamera:!0,copy:function(e,t){return Tr.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Qn),this.updateMatrixWorld(!0);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Tr.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){Tr.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Ea.prototype=Object.assign(Object.create(ba.prototype),{constructor:Ea,isPerspectiveCamera:!0,copy:function(e,t){return ba.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Fn.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){const e=Math.tan(.5*Fn.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Fn.RAD2DEG*Math.atan(Math.tan(.5*Fn.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){let e=this.near,t=e*Math.tan(.5*Fn.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){const e=a.fullWidth,o=a.fullHeight;i+=a.offsetX*r/e,t-=a.offsetY*n/o,r*=a.width/e,n*=a.height/o}const o=this.filmOffset;0!==o&&(i+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){const t=Tr.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});const Ta=90;function Sa(e,t,n){if(Tr.call(this),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new Ea(Ta,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Qn(1,0,0)),this.add(r);const i=new Ea(Ta,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Qn(-1,0,0)),this.add(i);const a=new Ea(Ta,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new Qn(0,1,0)),this.add(a);const o=new Ea(Ta,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new Qn(0,-1,0)),this.add(o);const s=new Ea(Ta,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Qn(0,0,1)),this.add(s);const u=new Ea(Ta,1,e,t);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new Qn(0,0,-1)),this.add(u),this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();const l=e.xr.enabled,c=e.getRenderTarget();e.xr.enabled=!1;const d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,o),e.setRenderTarget(n,4),e.render(t,s),n.texture.generateMipmaps=d,e.setRenderTarget(n,5),e.render(t,u),e.setRenderTarget(c),e.xr.enabled=l},this.clear=function(e,t,r,i){const a=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(n,a),e.clear(t,r,i);e.setRenderTarget(a)}}function wa(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),Wn.call(this,e,e,t)}function Aa(e,t,n,r,i,a,o,s,u,l,c,d){Vn.call(this,null,a,o,s,u,l,r,i,c,d),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=void 0!==u?u:pe,this.minFilter=void 0!==l?l:pe,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Sa.prototype=Object.create(Tr.prototype),Sa.prototype.constructor=Sa,wa.prototype=Object.create(Wn.prototype),wa.prototype.constructor=wa,wa.prototype.isWebGLCubeRenderTarget=!0,wa.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=Be,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n=new Sr,r={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t",fragmentShader:"\n\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t"},i=new _a({name:"CubemapFromEquirect",uniforms:ga(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:m,blending:_});i.uniforms.tEquirect.value=t;const a=new oa(new ma(5,5,5),i);n.add(a);return new Sa(1,10,this).update(e,n),a.geometry.dispose(),a.material.dispose(),this},Aa.prototype=Object.create(Vn.prototype),Aa.prototype.constructor=Aa,Aa.prototype.isDataTexture=!0;const xa=new jr,Ma=new Qn;function Ca(e,t,n,r,i,a){this.planes=[void 0!==e?e:new Jr,void 0!==t?t:new Jr,void 0!==n?n:new Jr,void 0!==r?r:new Jr,void 0!==i?i:new Jr,void 0!==a?a:new Jr]}Object.assign(Ca.prototype,{set:function(e,t,n,r,i,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromProjectionMatrix:function(e){const t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],l=n[6],c=n[7],d=n[8],h=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(o-r,c-s,p-d,y-m).normalize(),t[1].setComponents(o+r,c+s,p+d,y+m).normalize(),t[2].setComponents(o+i,c+u,p+h,y+g).normalize(),t[3].setComponents(o-i,c-u,p-h,y-g).normalize(),t[4].setComponents(o-a,c-l,p-f,y-v).normalize(),t[5].setComponents(o+a,c+l,p+f,y+v).normalize(),this},intersectsObject:function(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),xa.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(xa)},intersectsSprite:function(e){return xa.center.set(0,0,0),xa.radius=.7071067811865476,xa.applyMatrix4(e.matrixWorld),this.intersectsSphere(xa)},intersectsSphere:function(e){const t=this.planes,n=e.center,r=-e.radius;for(let e=0;e<6;e++){if(t[e].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(Ma.x=r.normal.x>0?e.max.x:e.min.x,Ma.y=r.normal.y>0?e.max.y:e.min.y,Ma.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Ma)<0)return!1}return!0},containsPoint:function(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});const Ra={common:{diffuse:{value:new fi(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Un},uv2Transform:{value:new Un},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Bn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new fi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new fi(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Un}},sprite:{diffuse:{value:new fi(15658734)},opacity:{value:1},center:{value:new Bn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Un}}};function Ia(){let e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Oa(e,t){const n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){t.isInterleavedBufferAttribute&&(t=t.data);const a=r.get(t);void 0===a?r.set(t,function(t,n){const r=t.array,i=t.usage,a=e.createBuffer();e.bindBuffer(n,a),e.bufferData(n,r,i),t.onUploadCallback();let o=5126;return r instanceof Float32Array?o=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?o=5123:r instanceof Int16Array?o=5122:r instanceof Uint32Array?o=5125:r instanceof Int32Array?o=5124:r instanceof Int8Array?o=5120:r instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(t,i)):a.version<t.version&&(!function(t,r,i){const a=r.array,o=r.updateRange;e.bindBuffer(i,t),-1===o.count?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(a.buffer,t,i),a.version=t.version)}}}function Da(e,t,n,r){fa.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Pa(e,t,n,r)),this.mergeVertices()}function Pa(e,t,n,r){Hi.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=(e=e||1)/2,a=(t=t||1)/2,o=Math.floor(n)||1,s=Math.floor(r)||1,u=o+1,l=s+1,c=e/o,d=t/s,h=[],f=[],p=[],m=[];for(let e=0;e<l;e++){const t=e*d-a;for(let n=0;n<u;n++){const r=n*c-i;f.push(r,-t,0),p.push(0,0,1),m.push(n/o),m.push(1-e/s)}}for(let e=0;e<s;e++)for(let t=0;t<o;t++){const n=t+u*e,r=t+u*(e+1),i=t+1+u*(e+1),a=t+1+u*e;h.push(n,r,a),h.push(r,i,a)}this.setIndex(h),this.setAttribute("position",new Oi(f,3)),this.setAttribute("normal",new Oi(p,3)),this.setAttribute("uv",new Oi(m,2))}Da.prototype=Object.create(fa.prototype),Da.prototype.constructor=Da,Pa.prototype=Object.create(Hi.prototype),Pa.prototype.constructor=Pa;const La={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Na={basic:{uniforms:va([Ra.common,Ra.specularmap,Ra.envmap,Ra.aomap,Ra.lightmap,Ra.fog]),vertexShader:La.meshbasic_vert,fragmentShader:La.meshbasic_frag},lambert:{uniforms:va([Ra.common,Ra.specularmap,Ra.envmap,Ra.aomap,Ra.lightmap,Ra.emissivemap,Ra.fog,Ra.lights,{emissive:{value:new fi(0)}}]),vertexShader:La.meshlambert_vert,fragmentShader:La.meshlambert_frag},phong:{uniforms:va([Ra.common,Ra.specularmap,Ra.envmap,Ra.aomap,Ra.lightmap,Ra.emissivemap,Ra.bumpmap,Ra.normalmap,Ra.displacementmap,Ra.fog,Ra.lights,{emissive:{value:new fi(0)},specular:{value:new fi(1118481)},shininess:{value:30}}]),vertexShader:La.meshphong_vert,fragmentShader:La.meshphong_frag},standard:{uniforms:va([Ra.common,Ra.envmap,Ra.aomap,Ra.lightmap,Ra.emissivemap,Ra.bumpmap,Ra.normalmap,Ra.displacementmap,Ra.roughnessmap,Ra.metalnessmap,Ra.fog,Ra.lights,{emissive:{value:new fi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:La.meshphysical_vert,fragmentShader:La.meshphysical_frag},toon:{uniforms:va([Ra.common,Ra.aomap,Ra.lightmap,Ra.emissivemap,Ra.bumpmap,Ra.normalmap,Ra.displacementmap,Ra.gradientmap,Ra.fog,Ra.lights,{emissive:{value:new fi(0)}}]),vertexShader:La.meshtoon_vert,fragmentShader:La.meshtoon_frag},matcap:{uniforms:va([Ra.common,Ra.bumpmap,Ra.normalmap,Ra.displacementmap,Ra.fog,{matcap:{value:null}}]),vertexShader:La.meshmatcap_vert,fragmentShader:La.meshmatcap_frag},points:{uniforms:va([Ra.points,Ra.fog]),vertexShader:La.points_vert,fragmentShader:La.points_frag},dashed:{uniforms:va([Ra.common,Ra.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:La.linedashed_vert,fragmentShader:La.linedashed_frag},depth:{uniforms:va([Ra.common,Ra.displacementmap]),vertexShader:La.depth_vert,fragmentShader:La.depth_frag},normal:{uniforms:va([Ra.common,Ra.bumpmap,Ra.normalmap,Ra.displacementmap,{opacity:{value:1}}]),vertexShader:La.normal_vert,fragmentShader:La.normal_frag},sprite:{uniforms:va([Ra.sprite,Ra.fog]),vertexShader:La.sprite_vert,fragmentShader:La.sprite_frag},background:{uniforms:{uvTransform:{value:new Un},t2D:{value:null}},vertexShader:La.background_vert,fragmentShader:La.background_frag},cube:{uniforms:va([Ra.envmap,{opacity:{value:1}}]),vertexShader:La.cube_vert,fragmentShader:La.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:La.equirect_vert,fragmentShader:La.equirect_frag},distanceRGBA:{uniforms:va([Ra.common,Ra.displacementmap,{referencePosition:{value:new Qn},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:La.distanceRGBA_vert,fragmentShader:La.distanceRGBA_frag},shadow:{uniforms:va([Ra.lights,Ra.fog,{color:{value:new fi(0)},opacity:{value:1}}]),vertexShader:La.shadow_vert,fragmentShader:La.shadow_frag}};function ka(e,t,n,r){const i=new fi(0);let a,o,s=0,u=null,l=0,c=null;function d(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,r)}return{getClearColor:function(){return i},setClearColor:function(e,t){i.set(e),s=void 0!==t?t:1,d(i,s)},getClearAlpha:function(){return s},setClearAlpha:function(e){s=e,d(i,s)},render:function(t,r,h,f){let g=!0===r.isScene?r.background:null;const v=e.xr,y=v.getSession&&v.getSession();if(y&&"additive"===y.environmentBlendMode&&(g=null),null===g?d(i,s):g&&g.isColor&&(d(g,1),f=!0),(e.autoClear||f)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),g&&(g.isCubeTexture||g.isWebGLCubeRenderTarget||g.mapping===le)){void 0===o&&(o=new oa(new ma(1,1,1),new _a({name:"BackgroundCubeMaterial",uniforms:ga(Na.cube.uniforms),vertexShader:Na.cube.vertexShader,fragmentShader:Na.cube.fragmentShader,side:m,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(o));const r=g.isWebGLCubeRenderTarget?g.texture:g;o.material.uniforms.envMap.value=r,o.material.uniforms.flipEnvMap.value=r.isCubeTexture?-1:1,u===g&&l===r.version&&c===e.toneMapping||(o.material.needsUpdate=!0,u=g,l=r.version,c=e.toneMapping),t.unshift(o,o.geometry,o.material,0,0,null)}else g&&g.isTexture&&(void 0===a&&(a=new oa(new Pa(2,2),new _a({name:"BackgroundMaterial",uniforms:ga(Na.background.uniforms),vertexShader:Na.background.vertexShader,fragmentShader:Na.background.fragmentShader,side:p,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(a)),a.material.uniforms.t2D.value=g,!0===g.matrixAutoUpdate&&g.updateMatrix(),a.material.uniforms.uvTransform.value.copy(g.matrix),u===g&&l===g.version&&c===e.toneMapping||(a.material.needsUpdate=!0,u=g,l=g.version,c=e.toneMapping),t.unshift(a,a.geometry,a.material,0,0,null))}}}function Fa(e,t,n,r){const i=e.getParameter(34921),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==a,s={},u=h(null);let l=u;function c(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function d(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function h(e){const t=[],n=[],r=[];for(let e=0;e<i;e++)t[e]=0,n[e]=0,r[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{}}}function f(){const e=l.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function p(e){m(e,0)}function m(n,i){const a=l.newAttributes,o=l.enabledAttributes,s=l.attributeDivisors;if(a[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==i){(r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),s[n]=i}}function g(){const t=l.newAttributes,n=l.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function v(t,n,i,a,o,s){!0!==r.isWebGL2||5124!==i&&5125!==i?e.vertexAttribPointer(t,n,i,a,o,s):e.vertexAttribIPointer(t,n,i,o,s)}function y(){_(),l!==u&&(l=u,c(l.object))}function _(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:function(i,u,d,y,_){let b=!1;if(o){const t=function(t,n,i){const o=!0===i.wireframe;let u=s[t.id];void 0===u&&(u={},s[t.id]=u);let l=u[n.id];void 0===l&&(l={},u[n.id]=l);let c=l[o];void 0===c&&(c=h(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),l[o]=c);return c}(y,d,u);l!==t&&(l=t,c(l.object)),b=function(e){const t=l.attributes,n=e.attributes;if(Object.keys(t).length!==Object.keys(n).length)return!0;for(const e in n){const r=t[e],i=n[e];if(r.attribute!==i)return!0;if(r.data!==i.data)return!0}return!1}(y),b&&function(e){const t={},n=e.attributes;for(const e in n){const r=n[e],i={};i.attribute=r,r.data&&(i.data=r.data),t[e]=i}l.attributes=t}(y)}else{const e=!0===u.wireframe;l.geometry===y.id&&l.program===d.id&&l.wireframe===e||(l.geometry=y.id,l.program=d.id,l.wireframe=e,b=!0)}!0===i.isInstancedMesh&&(b=!0),null!==_&&n.update(_,34963),b&&(!function(i,a,o,s){if(!1===r.isWebGL2&&(i.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();const u=s.attributes,l=o.getAttributes(),c=a.defaultAttributeValues;for(const t in l){const r=l[t];if(r>=0){const a=u[t];if(void 0!==a){const t=a.normalized,i=a.itemSize,o=n.get(a);if(void 0===o)continue;const u=o.buffer,l=o.type,c=o.bytesPerElement;if(a.isInterleavedBufferAttribute){const n=a.data,o=n.stride,d=a.offset;n&&n.isInstancedInterleavedBuffer?(m(r,n.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=n.meshPerAttribute*n.count)):p(r),e.bindBuffer(34962,u),v(r,i,l,t,o*c,d*c)}else a.isInstancedBufferAttribute?(m(r,a.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=a.meshPerAttribute*a.count)):p(r),e.bindBuffer(34962,u),v(r,i,l,t,0,0)}else if("instanceMatrix"===t){const t=n.get(i.instanceMatrix);if(void 0===t)continue;const a=t.buffer,o=t.type;m(r+0,1),m(r+1,1),m(r+2,1),m(r+3,1),e.bindBuffer(34962,a),e.vertexAttribPointer(r+0,4,o,!1,64,0),e.vertexAttribPointer(r+1,4,o,!1,64,16),e.vertexAttribPointer(r+2,4,o,!1,64,32),e.vertexAttribPointer(r+3,4,o,!1,64,48)}else if(void 0!==c){const n=c[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(r,n);break;case 3:e.vertexAttrib3fv(r,n);break;case 4:e.vertexAttrib4fv(r,n);break;default:e.vertexAttrib1fv(r,n)}}}}g()}(i,u,d,y),null!==_&&e.bindBuffer(34963,n.get(_).buffer))},reset:y,resetDefaultState:_,dispose:function(){y();for(const e in s){const t=s[e];for(const e in t){const n=t[e];for(const e in n)d(n[e].object),delete n[e];delete t[e]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0===s[e.id])return;const t=s[e.id];for(const e in t){const n=t[e];for(const e in n)d(n[e].object),delete n[e];delete t[e]}delete s[e.id]},releaseStatesOfProgram:function(e){for(const t in s){const n=s[t];if(void 0===n[e.id])continue;const r=n[e.id];for(const e in r)d(r[e].object),delete r[e];delete n[e.id]}},initAttributes:f,enableAttribute:p,disableUnusedAttributes:g}}function Ba(e,t,n,r){const i=r.isWebGL2;let a;this.setMode=function(e){a=e},this.render=function(t,r){e.drawArrays(a,t,r),n.update(r,a,1)},this.renderInstances=function(r,o,s){if(0===s)return;let u,l;if(i)u=e,l="drawArraysInstanced";else if(u=t.get("ANGLE_instanced_arrays"),l="drawArraysInstancedANGLE",null===u)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[l](a,r,o,s),n.update(o,a,s)}}function Ua(e,t,n){let r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext;let o=void 0!==n.precision?n.precision:"highp";const s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);const u=!0===n.logarithmicDepthBuffer,l=e.getParameter(34930),c=e.getParameter(35660),d=e.getParameter(3379),h=e.getParameter(34076),f=e.getParameter(34921),p=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),v=c>0,y=a||!!t.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==r)return r;const n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,r},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:u,maxTextures:l,maxVertexTextures:c,maxTextureSize:d,maxCubemapSize:h,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?e.getParameter(36183):0}}function ja(){const e=this;let t=null,n=0,r=!1,i=!1;const a=new Jr,o=new Un,s={value:null,needsUpdate:!1};function u(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function l(t,n,r,i){let u=null!==t?t.length:0,l=null;if(0!==u){if(l=s.value,!0!==i||null===l){const e=r+4*u,i=n.matrixWorldInverse;o.getNormalMatrix(i),(null===l||l.length<e)&&(l=new Float32Array(e));for(let e=0,n=r;e!==u;++e,n+=4)a.copy(t[e]).applyMatrix4(i,o),a.normal.toArray(l,n),l[n+3]=a.constant}s.value=l,s.needsUpdate=!0}return e.numPlanes=u,e.numIntersection=0,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,a){const o=0!==e.length||i||0!==n||r;return r=i,t=l(e,a,0),n=e.length,o},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,u()},this.setState=function(e,a,o,c,d,h){if(!r||null===e||0===e.length||i&&!o)i?l(null):u();else{const r=i?0:n,o=4*r;let u=d.clippingState||null;s.value=u,u=l(e,c,o,h);for(let e=0;e!==o;++e)u[e]=t[e];d.clippingState=u,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=r}}}function Ga(e){const t={};return{has:function(n){if(void 0!==t[n])return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,!!r},get:function(e){return this.has(e)||console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t[e]}}}function Ha(e,t,n,r){const i=new WeakMap,a=new WeakMap;function o(e){const s=e.target,u=i.get(s);null!==u.index&&t.remove(u.index);for(const e in u.attributes)t.remove(u.attributes[e]);s.removeEventListener("dispose",o),i.delete(s);const l=a.get(u);l&&(t.remove(l),a.delete(u)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){const n=[],r=e.index,i=e.attributes.position;let o=0;if(null!==r){const e=r.array;o=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],a=e[t+2];n.push(r,i,i,a,a,r)}}else{const e=i.array;o=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}const s=new(Li(n)>65535?Ii:Ci)(n,1);s.version=o;const u=a.get(e);u&&t.remove(u),a.set(e,s)}return{get:function(e,t){let r=i.get(t);return r||(t.addEventListener("dispose",o),t.isBufferGeometry?r=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Hi).setFromObject(e)),r=t._bufferGeometry),i.set(t,r),n.memory.geometries++,r)},update:function(e){const n=e.attributes;for(const e in n)t.update(n[e],34962);const r=e.morphAttributes;for(const e in r){const n=r[e];for(let e=0,r=n.length;e<r;e++)t.update(n[e],34962)}},getWireframeAttribute:function(e){const t=a.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return a.get(e)}}}function Va(e,t,n,r){const i=r.isWebGL2;let a,o,s;this.setMode=function(e){a=e},this.setIndex=function(e){o=e.type,s=e.bytesPerElement},this.render=function(t,r){e.drawElements(a,r,o,t*s),n.update(r,a,1)},this.renderInstances=function(r,u,l){if(0===l)return;let c,d;if(i)c=e,d="drawElementsInstanced";else if(c=t.get("ANGLE_instanced_arrays"),d="drawElementsInstancedANGLE",null===c)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[d](a,u,o,r*s,l),n.update(u,a,l)}}function za(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Wa(e,t){return e[0]-t[0]}function qa(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Ya(e){const t={},n=new Float32Array(8),r=[];for(let e=0;e<8;e++)r[e]=[e,0];return{update:function(i,a,o,s){const u=i.morphTargetInfluences,l=void 0===u?0:u.length;let c=t[a.id];if(void 0===c){c=[];for(let e=0;e<l;e++)c[e]=[e,0];t[a.id]=c}for(let e=0;e<l;e++){const t=c[e];t[0]=e,t[1]=u[e]}c.sort(qa);for(let e=0;e<8;e++)e<l&&c[e][1]?(r[e][0]=c[e][0],r[e][1]=c[e][1]):(r[e][0]=Number.MAX_SAFE_INTEGER,r[e][1]=0);r.sort(Wa);const d=o.morphTargets&&a.morphAttributes.position,h=o.morphNormals&&a.morphAttributes.normal;let f=0;for(let e=0;e<8;e++){const t=r[e],i=t[0],o=t[1];i!==Number.MAX_SAFE_INTEGER&&o?(d&&a.getAttribute("morphTarget"+e)!==d[i]&&a.setAttribute("morphTarget"+e,d[i]),h&&a.getAttribute("morphNormal"+e)!==h[i]&&a.setAttribute("morphNormal"+e,h[i]),n[e]=o,f+=o):(d&&void 0!==a.getAttribute("morphTarget"+e)&&a.deleteAttribute("morphTarget"+e),h&&void 0!==a.getAttribute("morphNormal"+e)&&a.deleteAttribute("morphNormal"+e),n[e]=0)}const p=a.morphTargetsRelative?1:1-f;s.getUniforms().setValue(e,"morphTargetBaseInfluence",p),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function Ka(e,t,n,r){let i=new WeakMap;return{update:function(e){const a=r.render.frame,o=e.geometry,s=t.get(e,o);return i.get(s)!==a&&(o.isGeometry&&s.updateFromObject(e),t.update(s),i.set(s,a)),e.isInstancedMesh&&n.update(e.instanceMatrix,34962),s},dispose:function(){i=new WeakMap}}}function Xa(e,t,n,r,i,a,o,s,u,l){e=void 0!==e?e:[],t=void 0!==t?t:ae,o=void 0!==o?o:Fe,Vn.call(this,e,t,n,r,i,a,o,s,u,l),this.flipY=!1}function Qa(e,t,n,r){Vn.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:r||1},this.magFilter=pe,this.minFilter=pe,this.wrapR=he,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Za(e,t,n,r){Vn.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:r||1},this.magFilter=pe,this.minFilter=pe,this.wrapR=he,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Na.physical={uniforms:va([Na.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Bn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new fi(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:La.meshphysical_vert,fragmentShader:La.meshphysical_frag},Xa.prototype=Object.create(Vn.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isCubeTexture=!0,Object.defineProperty(Xa.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),Qa.prototype=Object.create(Vn.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isDataTexture2DArray=!0,Za.prototype=Object.create(Vn.prototype),Za.prototype.constructor=Za,Za.prototype.isDataTexture3D=!0;const Ja=new Vn,$a=new Qa,eo=new Za,to=new Xa,no=[],ro=[],io=new Float32Array(16),ao=new Float32Array(9),oo=new Float32Array(4);function so(e,t,n){const r=e[0];if(r<=0||r>0)return e;let i=t*n,a=no[i];if(void 0===a&&(a=new Float32Array(i),no[i]=a),0!==t){r.toArray(a,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(a,i)}return a}function uo(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function lo(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function co(e,t){let n=ro[t];void 0===n&&(n=new Int32Array(t),ro[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function ho(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function fo(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(uo(n,t))return;e.uniform2fv(this.addr,t),lo(n,t)}}function po(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(uo(n,t))return;e.uniform3fv(this.addr,t),lo(n,t)}}function mo(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(uo(n,t))return;e.uniform4fv(this.addr,t),lo(n,t)}}function go(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(uo(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),lo(n,t)}else{if(uo(n,r))return;oo.set(r),e.uniformMatrix2fv(this.addr,!1,oo),lo(n,r)}}function vo(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(uo(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),lo(n,t)}else{if(uo(n,r))return;ao.set(r),e.uniformMatrix3fv(this.addr,!1,ao),lo(n,r)}}function yo(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(uo(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),lo(n,t)}else{if(uo(n,r))return;io.set(r),e.uniformMatrix4fv(this.addr,!1,io),lo(n,r)}}function _o(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||Ja,i)}function bo(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||$a,i)}function Eo(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||eo,i)}function To(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||to,i)}function So(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function wo(e,t){const n=this.cache;uo(n,t)||(e.uniform2iv(this.addr,t),lo(n,t))}function Ao(e,t){const n=this.cache;uo(n,t)||(e.uniform3iv(this.addr,t),lo(n,t))}function xo(e,t){const n=this.cache;uo(n,t)||(e.uniform4iv(this.addr,t),lo(n,t))}function Mo(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Co(e,t){e.uniform1fv(this.addr,t)}function Ro(e,t){e.uniform1iv(this.addr,t)}function Io(e,t){e.uniform2iv(this.addr,t)}function Oo(e,t){e.uniform3iv(this.addr,t)}function Do(e,t){e.uniform4iv(this.addr,t)}function Po(e,t){const n=so(t,this.size,2);e.uniform2fv(this.addr,n)}function Lo(e,t){const n=so(t,this.size,3);e.uniform3fv(this.addr,n)}function No(e,t){const n=so(t,this.size,4);e.uniform4fv(this.addr,n)}function ko(e,t){const n=so(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Fo(e,t){const n=so(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Bo(e,t){const n=so(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Uo(e,t,n){const r=t.length,i=co(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.safeSetTexture2D(t[e]||Ja,i[e])}function jo(e,t,n){const r=t.length,i=co(n,r);e.uniform1iv(this.addr,i);for(let e=0;e!==r;++e)n.safeSetTextureCube(t[e]||to,i[e])}function Go(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return ho;case 35664:return fo;case 35665:return po;case 35666:return mo;case 35674:return go;case 35675:return vo;case 35676:return yo;case 5124:case 35670:return So;case 35667:case 35671:return wo;case 35668:case 35672:return Ao;case 35669:case 35673:return xo;case 5125:return Mo;case 35678:case 36198:case 36298:case 36306:case 35682:return _o;case 35679:case 36299:case 36307:return Eo;case 35680:case 36300:case 36308:case 36293:return To;case 36289:case 36303:case 36311:case 36292:return bo}}(t.type)}function Ho(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Co;case 35664:return Po;case 35665:return Lo;case 35666:return No;case 35674:return ko;case 35675:return Fo;case 35676:return Bo;case 5124:case 35670:return Ro;case 35667:case 35671:return Io;case 35668:case 35672:return Oo;case 35669:case 35673:return Do;case 35678:case 36198:case 36298:case 36306:case 35682:return Uo;case 35680:case 36300:case 36308:case 36293:return jo}}(t.type)}function Vo(e){this.id=e,this.seq=[],this.map={}}Ho.prototype.updateCache=function(e){let t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),lo(t,e)},Vo.prototype.setValue=function(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const a=r[i];a.setValue(e,t[a.id],n)}};const zo=/([\w\d_]+)(\])?(\[|\.)?/g;function Wo(e,t){e.seq.push(t),e.map[t.id]=t}function qo(e,t,n){const r=e.name,i=r.length;for(zo.lastIndex=0;;){const a=zo.exec(r),o=zo.lastIndex;let s=a[1],u="]"===a[2],l=a[3];if(u&&(s|=0),void 0===l||"["===l&&o+2===i){Wo(n,void 0===l?new Go(s,e,t):new Ho(s,e,t));break}{let e=n.map[s];void 0===e&&(e=new Vo(s),Wo(n,e)),n=e}}}function Yo(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const n=e.getActiveUniform(t,r);qo(n,e.getUniformLocation(t,n.name),this)}}function Ko(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}Yo.prototype.setValue=function(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)},Yo.prototype.setOptional=function(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)},Yo.upload=function(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const a=t[i],o=n[a.id];!1!==o.needsUpdate&&a.setValue(e,o.value,r)}},Yo.seqWithValue=function(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n};let Xo=0;function Qo(e){switch(e){case Qt:return["Linear","( value )"];case Zt:return["sRGB","( value )"];case $t:return["RGBE","( value )"];case tn:return["RGBM","( value, 7.0 )"];case nn:return["RGBM","( value, 16.0 )"];case rn:return["RGBD","( value, 256.0 )"];case Jt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case en:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function Zo(e,t,n){const r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();if(r&&""===i)return"";return"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){const t=e.split("\n");for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(e.getShaderSource(t))}function Jo(e,t){const n=Qo(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function $o(e,t){const n=Qo(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function es(e,t){let n;switch(t){case $:n="Linear";break;case ee:n="Reinhard";break;case te:n="OptimizedCineon";break;case ne:n="ACESFilmic";break;case re:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function ts(e){return""!==e}function ns(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function rs(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const is=/^[ \t]*#include +<([\w\d./]+)>/gm;function as(e){return e.replace(is,os)}function os(e,t){const n=La[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return as(n)}const ss=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,us=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function ls(e){return e.replace(us,ds).replace(ss,cs)}function cs(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),ds(e,t,n,r)}function ds(e,t,n,r){let i="";for(let e=parseInt(t);e<parseInt(n);e++)i+=r.replace(/\[ i \]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function hs(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function fs(e,t,n,r){const i=e.getContext(),a=n.defines;let o=n.vertexShader,s=n.fragmentShader;const u=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===d?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===h?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===f&&(t="SHADOWMAP_TYPE_VSM"),t}(n),l=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case ae:case oe:t="ENVMAP_TYPE_CUBE";break;case le:case ce:t="ENVMAP_TYPE_CUBE_UV";break;case se:case ue:t="ENVMAP_TYPE_EQUIREC"}return t}(n),c=function(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case oe:case ue:case ce:t="ENVMAP_MODE_REFRACTION"}return t}(n),p=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case X:t="ENVMAP_BLENDING_MULTIPLY";break;case Q:t="ENVMAP_BLENDING_MIX";break;case Z:t="ENVMAP_BLENDING_ADD"}return t}(n),m=e.gammaFactor>0?e.gammaFactor:1,g=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ts).join("\n")}(n),v=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(a),y=i.createProgram();let _,b;n.isRawShaderMaterial?(_=[v].filter(ts).join("\n"),_.length>0&&(_+="\n"),b=[g,v].filter(ts).join("\n"),b.length>0&&(b+="\n")):(_=[hs(n),"#define SHADER_NAME "+n.shaderName,v,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+m,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ts).join("\n"),b=[g,hs(n),"#define SHADER_NAME "+n.shaderName,v,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+c:"",n.envMap?"#define "+p:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==J?"#define TONE_MAPPING":"",n.toneMapping!==J?La.tonemapping_pars_fragment:"",n.toneMapping!==J?es("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",La.encodings_pars_fragment,n.map?Jo("mapTexelToLinear",n.mapEncoding):"",n.matcap?Jo("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?Jo("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?Jo("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?Jo("lightMapTexelToLinear",n.lightMapEncoding):"",$o("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(ts).join("\n")),o=as(o),o=ns(o,n),o=rs(o,n),s=as(s),s=ns(s,n),s=rs(s,n),o=ls(o),s=ls(s),n.isWebGL2&&!n.isRawShaderMaterial&&(_=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+_,b=["#version 300 es\n","#define varying in","out highp vec4 pc_fragColor;","#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+b);const E=b+s,T=Ko(i,35633,_+o),S=Ko(i,35632,E);if(i.attachShader(y,T),i.attachShader(y,S),void 0!==n.index0AttributeName?i.bindAttribLocation(y,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(y,0,"position"),i.linkProgram(y),e.debug.checkShaderErrors){const e=i.getProgramInfoLog(y).trim(),t=i.getShaderInfoLog(T).trim(),n=i.getShaderInfoLog(S).trim();let r=!0,a=!0;if(!1===i.getProgramParameter(y,35714)){r=!1;const t=Zo(i,T,"vertex"),n=Zo(i,S,"fragment");console.error("THREE.WebGLProgram: shader error: ",i.getError(),"35715",i.getProgramParameter(y,35715),"gl.getProgramInfoLog",e,t,n)}else""!==e?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",e):""!==t&&""!==n||(a=!1);a&&(this.diagnostics={runnable:r,programLog:e,vertexShader:{log:t,prefix:_},fragmentShader:{log:n,prefix:b}})}let w,A;return i.deleteShader(T),i.deleteShader(S),this.getUniforms=function(){return void 0===w&&(w=new Yo(i,y)),w},this.getAttributes=function(){return void 0===A&&(A=function(e,t){const n={},r=e.getProgramParameter(t,35721);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i).name;n[r]=e.getAttribLocation(t,r)}return n}(i,y)),A},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(y),this.program=void 0},this.name=n.shaderName,this.id=Xo++,this.cacheKey=t,this.usedTimes=1,this.program=y,this.vertexShader=T,this.fragmentShader=S,this}function ps(e,t,n,r){const i=[],a=n.isWebGL2,o=n.logarithmicDepthBuffer,s=n.floatVertexTextures,u=n.maxVertexUniforms,l=n.vertexTextures;let c=n.precision;const d={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},h=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function f(e){let t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=Qt,t}return{getParameters:function(r,i,h,p,v,y,_){const b=p.fog,E=r.isMeshStandardMaterial?p.environment:null,T=r.envMap||E,S=d[r.type],w=_.isSkinnedMesh?function(e){const t=e.skeleton.bones;if(s)return 1024;{const e=u,n=Math.floor((e-20)/4),r=Math.min(n,t.length);return r<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+r+"."),0):r}}(_):0;let A,x;if(null!==r.precision&&(c=n.getMaxPrecision(r.precision),c!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",c,"instead.")),S){const e=Na[S];A=e.vertexShader,x=e.fragmentShader}else A=r.vertexShader,x=r.fragmentShader;const M=e.getRenderTarget();return{isWebGL2:a,shaderID:S,shaderName:r.type,vertexShader:A,fragmentShader:x,defines:r.defines,isRawShaderMaterial:r.isRawShaderMaterial,isShaderMaterial:r.isShaderMaterial,precision:c,instancing:!0===_.isInstancedMesh,supportsVertexTextures:l,outputEncoding:null!==M?f(M.texture):e.outputEncoding,map:!!r.map,mapEncoding:f(r.map),matcap:!!r.matcap,matcapEncoding:f(r.matcap),envMap:!!T,envMapMode:T&&T.mapping,envMapEncoding:f(T),envMapCubeUV:!!T&&(T.mapping===le||T.mapping===ce),lightMap:!!r.lightMap,lightMapEncoding:f(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:f(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:r.normalMapType===un,tangentSpaceNormalMap:r.normalMapType===sn,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,transmissionMap:!!r.transmissionMap,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap||r.transmissionMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||r.transmissionMap||!r.displacementMap),fog:!!b,useFog:r.fog,fogExp2:b&&b.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:o,skinning:r.skinning&&w>0,maxBones:w,useVertexTexture:s,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:i.directional.length,numPointLights:i.point.length,numSpotLights:i.spot.length,numRectAreaLights:i.rectArea.length,numHemiLights:i.hemi.length,numDirLightShadows:i.directionalShadowMap.length,numPointLightShadows:i.pointShadowMap.length,numSpotLightShadows:i.spotShadowMap.length,numClippingPlanes:v,numClipIntersection:y,dithering:r.dithering,shadowMapEnabled:e.shadowMap.enabled&&h.length>0,shadowMapType:e.shadowMap.type,toneMapping:r.toneMapped?e.toneMapping:J,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:r.side===g,flipSided:r.side===m,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||null!==t.get("EXT_frag_depth"),rendererExtensionDrawBuffers:a||null!==t.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||null!==t.get("EXT_shader_texture_lod"),customProgramCacheKey:r.customProgramCacheKey()}},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);if(void 0===t.isRawShaderMaterial){for(let e=0;e<h.length;e++)n.push(t[h[e]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=d[e.type];let n;if(t){const e=Na[t];n=ya.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let a;for(let e=0,t=i.length;e<t;e++){const t=i[e];if(t.cacheKey===n){a=t,++a.usedTimes;break}}return void 0===a&&(a=new fs(e,n,t,r),i.push(a)),a},releaseProgram:function(e){if(0==--e.usedTimes){const t=i.indexOf(e);i[t]=i[i.length-1],i.pop(),e.destroy()}},programs:i}}function ms(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function gs(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function vs(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function ys(e){const t=[];let n=0;const r=[],i=[],a={id:-1};function o(r,i,o,s,u,l){let c=t[n];const d=e.get(o);return void 0===c?(c={id:r.id,object:r,geometry:i,material:o,program:d.program||a,groupOrder:s,renderOrder:r.renderOrder,z:u,group:l},t[n]=c):(c.id=r.id,c.object=r,c.geometry=i,c.material=o,c.program=d.program||a,c.groupOrder=s,c.renderOrder=r.renderOrder,c.z=u,c.group=l),n++,c}return{opaque:r,transparent:i,init:function(){n=0,r.length=0,i.length=0},push:function(e,t,n,a,s,u){const l=o(e,t,n,a,s,u);(!0===n.transparent?i:r).push(l)},unshift:function(e,t,n,a,s,u){const l=o(e,t,n,a,s,u);(!0===n.transparent?i:r).unshift(l)},finish:function(){for(let e=n,r=t.length;e<r;e++){const n=t[e];if(null===n.id)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.program=null,n.group=null}},sort:function(e,t){r.length>1&&r.sort(e||gs),i.length>1&&i.sort(t||vs)}}}function _s(e){let t=new WeakMap;function n(e){const r=e.target;r.removeEventListener("dispose",n),t.delete(r)}return{get:function(r,i){const a=t.get(r);let o;return void 0===a?(o=new ys(e),t.set(r,new WeakMap),t.get(r).set(i,o),r.addEventListener("dispose",n)):(o=a.get(i),void 0===o&&(o=new ys(e),a.set(i,o))),o},dispose:function(){t=new WeakMap}}}function bs(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new Qn,color:new fi};break;case"SpotLight":n={position:new Qn,direction:new Qn,color:new fi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Qn,color:new fi,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Qn,skyColor:new fi,groundColor:new fi};break;case"RectAreaLight":n={color:new fi,position:new Qn,halfWidth:new Qn,halfHeight:new Qn}}return e[t.id]=n,n}}}let Es=0;function Ts(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Ss(){const e=new bs,t=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Bn};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Bn,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let e=0;e<9;e++)n.probe.push(new Qn);const r=new Qn,i=new ir,a=new ir;return{setup:function(o,s,u){let l=0,c=0,d=0;for(let e=0;e<9;e++)n.probe[e].set(0,0,0);let h=0,f=0,p=0,m=0,g=0,v=0,y=0,_=0;const b=u.matrixWorldInverse;o.sort(Ts);for(let s=0,u=o.length;s<u;s++){const u=o[s],E=u.color,T=u.intensity,S=u.distance,w=u.shadow&&u.shadow.map?u.shadow.map.texture:null;if(u.isAmbientLight)l+=E.r*T,c+=E.g*T,d+=E.b*T;else if(u.isLightProbe)for(let e=0;e<9;e++)n.probe[e].addScaledVector(u.sh.coefficients[e],T);else if(u.isDirectionalLight){const i=e.get(u);if(i.color.copy(u.color).multiplyScalar(u.intensity),i.direction.setFromMatrixPosition(u.matrixWorld),r.setFromMatrixPosition(u.target.matrixWorld),i.direction.sub(r),i.direction.transformDirection(b),u.castShadow){const e=u.shadow,r=t.get(u);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,n.directionalShadow[h]=r,n.directionalShadowMap[h]=w,n.directionalShadowMatrix[h]=u.shadow.matrix,v++}n.directional[h]=i,h++}else if(u.isSpotLight){const i=e.get(u);if(i.position.setFromMatrixPosition(u.matrixWorld),i.position.applyMatrix4(b),i.color.copy(E).multiplyScalar(T),i.distance=S,i.direction.setFromMatrixPosition(u.matrixWorld),r.setFromMatrixPosition(u.target.matrixWorld),i.direction.sub(r),i.direction.transformDirection(b),i.coneCos=Math.cos(u.angle),i.penumbraCos=Math.cos(u.angle*(1-u.penumbra)),i.decay=u.decay,u.castShadow){const e=u.shadow,r=t.get(u);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,n.spotShadow[p]=r,n.spotShadowMap[p]=w,n.spotShadowMatrix[p]=u.shadow.matrix,_++}n.spot[p]=i,p++}else if(u.isRectAreaLight){const t=e.get(u);t.color.copy(E).multiplyScalar(T),t.position.setFromMatrixPosition(u.matrixWorld),t.position.applyMatrix4(b),a.identity(),i.copy(u.matrixWorld),i.premultiply(b),a.extractRotation(i),t.halfWidth.set(.5*u.width,0,0),t.halfHeight.set(0,.5*u.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),n.rectArea[m]=t,m++}else if(u.isPointLight){const r=e.get(u);if(r.position.setFromMatrixPosition(u.matrixWorld),r.position.applyMatrix4(b),r.color.copy(u.color).multiplyScalar(u.intensity),r.distance=u.distance,r.decay=u.decay,u.castShadow){const e=u.shadow,r=t.get(u);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,r.shadowCameraNear=e.camera.near,r.shadowCameraFar=e.camera.far,n.pointShadow[f]=r,n.pointShadowMap[f]=w,n.pointShadowMatrix[f]=u.shadow.matrix,y++}n.point[f]=r,f++}else if(u.isHemisphereLight){const t=e.get(u);t.direction.setFromMatrixPosition(u.matrixWorld),t.direction.transformDirection(b),t.direction.normalize(),t.skyColor.copy(u.color).multiplyScalar(T),t.groundColor.copy(u.groundColor).multiplyScalar(T),n.hemi[g]=t,g++}}n.ambient[0]=l,n.ambient[1]=c,n.ambient[2]=d;const E=n.hash;E.directionalLength===h&&E.pointLength===f&&E.spotLength===p&&E.rectAreaLength===m&&E.hemiLength===g&&E.numDirectionalShadows===v&&E.numPointShadows===y&&E.numSpotShadows===_||(n.directional.length=h,n.spot.length=p,n.rectArea.length=m,n.point.length=f,n.hemi.length=g,n.directionalShadow.length=v,n.directionalShadowMap.length=v,n.pointShadow.length=y,n.pointShadowMap.length=y,n.spotShadow.length=_,n.spotShadowMap.length=_,n.directionalShadowMatrix.length=v,n.pointShadowMatrix.length=y,n.spotShadowMatrix.length=_,E.directionalLength=h,E.pointLength=f,E.spotLength=p,E.rectAreaLength=m,E.hemiLength=g,E.numDirectionalShadows=v,E.numPointShadows=y,E.numSpotShadows=_,n.version=Es++)},state:n}}function ws(){const e=new Ss,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(r){e.setup(t,n,r)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function As(){let e=new WeakMap;function t(n){const r=n.target;r.removeEventListener("dispose",t),e.delete(r)}return{get:function(n,r){let i;return!1===e.has(n)?(i=new ws,e.set(n,new WeakMap),e.get(n).set(r,i),n.addEventListener("dispose",t)):!1===e.get(n).has(r)?(i=new ws,e.get(n).set(r,i)):i=e.get(n).get(r),i},dispose:function(){e=new WeakMap}}}function xs(e){_i.call(this),this.type="MeshDepthMaterial",this.depthPacking=an,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function Ms(e){_i.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Qn,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}xs.prototype=Object.create(_i.prototype),xs.prototype.constructor=xs,xs.prototype.isMeshDepthMaterial=!0,xs.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Ms.prototype=Object.create(_i.prototype),Ms.prototype.constructor=Ms,Ms.prototype.isMeshDistanceMaterial=!0,Ms.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function Cs(e,t,n){let r=new Ca;const i=new Bn,a=new Bn,o=new zn,s=[],u=[],l={},c={0:m,1:p,2:g},h=new _a({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Bn},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),v=h.clone();v.defines.HORIZONAL_PASS=1;const y=new Hi;y.setAttribute("position",new Si(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new oa(y,h),E=this;function T(n,r){const i=t.update(b);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,h,b,null),v.uniforms.shadow_pass.value=n.mapPass.texture,v.uniforms.resolution.value=n.mapSize,v.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,v,b,null)}function S(e,t,n){const r=e<<0|t<<1|n<<2;let i=s[r];return void 0===i&&(i=new xs({depthPacking:on,morphTargets:e,skinning:t}),s[r]=i),i}function w(e,t,n){const r=e<<0|t<<1|n<<2;let i=u[r];return void 0===i&&(i=new Ms({morphTargets:e,skinning:t}),u[r]=i),i}function A(t,n,r,i,a,o,s){let u=null,d=S,h=t.customDepthMaterial;if(!0===i.isPointLight&&(d=w,h=t.customDistanceMaterial),void 0===h){let e=!1;!0===r.morphTargets&&(e=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);let i=!1;!0===t.isSkinnedMesh&&(!0===r.skinning?i=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t));u=d(e,i,!0===t.isInstancedMesh)}else u=h;if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){const e=u.uuid,t=r.uuid;let n=l[e];void 0===n&&(n={},l[e]=n);let i=n[t];void 0===i&&(i=u.clone(),n[t]=i),u=i}return u.visible=r.visible,u.wireframe=r.wireframe,u.side=s===f?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:c[r.side],u.clipShadows=r.clipShadows,u.clippingPlanes=r.clippingPlanes,u.clipIntersection=r.clipIntersection,u.wireframeLinewidth=r.wireframeLinewidth,u.linewidth=r.linewidth,!0===i.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(i.matrixWorld),u.nearDistance=a,u.farDistance=o),u}function x(n,i,a,o,s){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===f)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);const r=t.update(n),i=n.material;if(Array.isArray(i)){const t=r.groups;for(let u=0,l=t.length;u<l;u++){const l=t[u],c=i[l.materialIndex];if(c&&c.visible){const t=A(n,r,c,o,a.near,a.far,s);e.renderBufferDirect(a,null,r,t,n,l)}}}else if(i.visible){const t=A(n,r,i,o,a.near,a.far,s);e.renderBufferDirect(a,null,r,t,n,null)}}const u=n.children;for(let e=0,t=u.length;e<t;e++)x(u[e],i,a,o,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=d,this.render=function(t,s,u){if(!1===E.enabled)return;if(!1===E.autoUpdate&&!1===E.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(_),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);for(let l=0,c=t.length;l<c;l++){const c=t[l],d=c.shadow;if(!1===d.autoUpdate&&!1===d.needsUpdate)continue;if(void 0===d){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}i.copy(d.mapSize);const p=d.getFrameExtents();if(i.multiply(p),a.copy(d.mapSize),(i.x>n||i.y>n)&&(i.x>n&&(a.x=Math.floor(n/p.x),i.x=a.x*p.x,d.mapSize.x=a.x),i.y>n&&(a.y=Math.floor(n/p.y),i.y=a.y*p.y,d.mapSize.y=a.y)),null===d.map&&!d.isPointLightShadow&&this.type===f){const e={minFilter:_e,magFilter:_e,format:Be,stencilBuffer:!1};d.map=new Wn(i.x,i.y,e),d.map.texture.name=c.name+".shadowMap",d.mapPass=new Wn(i.x,i.y,e),d.camera.updateProjectionMatrix()}if(null===d.map){const e={minFilter:pe,magFilter:pe,format:Be,stencilBuffer:!1};d.map=new Wn(i.x,i.y,e),d.map.texture.name=c.name+".shadowMap",d.camera.updateProjectionMatrix()}e.setRenderTarget(d.map),e.clear();const m=d.getViewportCount();for(let e=0;e<m;e++){const t=d.getViewport(e);o.set(a.x*t.x,a.y*t.y,a.x*t.z,a.y*t.w),h.viewport(o),d.updateMatrices(c,e),r=d.getFrustum(),x(s,u,d.camera,c,this.type)}d.isPointLightShadow||this.type!==f||T(d,u),d.needsUpdate=!1}E.needsUpdate=!1,e.setRenderTarget(l,c,d)}}function Rs(e,t,n){const r=n.isWebGL2;const i=new function(){let t=!1;const n=new zn;let r=null;const i=new zn(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},a=new function(){let t=!1,n=null,r=null,i=null;return{setTest:function(e){e?pe(2929):me(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case G:e.depthFunc(512);break;case H:e.depthFunc(519);break;case V:e.depthFunc(513);break;case z:e.depthFunc(515);break;case W:e.depthFunc(514);break;case q:e.depthFunc(518);break;case Y:e.depthFunc(516);break;case K:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},l=new function(){let t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null;return{setTest:function(e){t||(e?pe(2960):me(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&u===r||(e.stencilOp(t,n,r),o=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null}}};let c={},d=null,h=null,f=null,p=null,v=null,y=null,X=null,Q=null,Z=null,J=!1,$=null,ee=null,te=null,ne=null,re=null;const ie=e.getParameter(35661);let ae=!1,oe=0;const se=e.getParameter(7938);-1!==se.indexOf("WebGL")?(oe=parseFloat(/^WebGL\ ([0-9])/.exec(se)[1]),ae=oe>=1):-1!==se.indexOf("OpenGL ES")&&(oe=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(se)[1]),ae=oe>=2);let ue=null,le={};const ce=new zn,de=new zn;function he(t,n,r){const i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let t=0;t<r;t++)e.texImage2D(n+t,0,6408,1,1,0,6408,5121,i);return a}const fe={};function pe(t){!0!==c[t]&&(e.enable(t),c[t]=!0)}function me(t){!1!==c[t]&&(e.disable(t),c[t]=!1)}fe[3553]=he(3553,3553,1),fe[34067]=he(34067,34069,6),i.setClear(0,0,0,1),a.setClear(1),l.setClear(0),pe(2929),a.setFunc(z),_e(!1),be(s),pe(2884),ye(_);const ge={[A]:32774,[x]:32778,[M]:32779};if(r)ge[C]=32775,ge[R]=32776;else{const e=t.get("EXT_blend_minmax");null!==e&&(ge[C]=e.MIN_EXT,ge[R]=e.MAX_EXT)}const ve={[I]:0,[O]:1,[D]:768,[L]:770,[j]:776,[B]:774,[k]:772,[P]:769,[N]:771,[U]:775,[F]:773};function ye(t,n,r,i,a,o,s,u){if(t!==_){if(h||(pe(3042),h=!0),t===w)a=a||n,o=o||r,s=s||i,n===p&&a===X||(e.blendEquationSeparate(ge[n],ge[a]),p=n,X=a),r===v&&i===y&&o===Q&&s===Z||(e.blendFuncSeparate(ve[r],ve[i],ve[o],ve[s]),v=r,y=i,Q=o,Z=s),f=t,J=null;else if(t!==f||u!==J){if(p===A&&X===A||(e.blendEquation(32774),p=A,X=A),u)switch(t){case b:e.blendFuncSeparate(1,771,1,771);break;case E:e.blendFunc(1,1);break;case T:e.blendFuncSeparate(0,0,769,771);break;case S:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case b:e.blendFuncSeparate(770,771,1,771);break;case E:e.blendFunc(770,1);break;case T:e.blendFunc(0,769);break;case S:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}v=null,y=null,Q=null,Z=null,f=t,J=u}}else h&&(me(3042),h=!1)}function _e(t){$!==t&&(t?e.frontFace(2304):e.frontFace(2305),$=t)}function be(t){t!==o?(pe(2884),t!==ee&&(t===s?e.cullFace(1029):t===u?e.cullFace(1028):e.cullFace(1032))):me(2884),ee=t}function Ee(t,n,r){t?(pe(32823),ne===n&&re===r||(e.polygonOffset(n,r),ne=n,re=r)):me(32823)}function Te(t){void 0===t&&(t=33984+ie-1),ue!==t&&(e.activeTexture(t),ue=t)}return{buffers:{color:i,depth:a,stencil:l},enable:pe,disable:me,useProgram:function(t){return d!==t&&(e.useProgram(t),d=t,!0)},setBlending:ye,setMaterial:function(e,t){e.side===g?me(2884):pe(2884);let n=e.side===m;t&&(n=!n),_e(n),e.blending===b&&!1===e.transparent?ye(_):ye(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),i.setMask(e.colorWrite);const r=e.stencilWrite;l.setTest(r),r&&(l.setMask(e.stencilWriteMask),l.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),l.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Ee(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:_e,setCullFace:be,setLineWidth:function(t){t!==te&&(ae&&e.lineWidth(t),te=t)},setPolygonOffset:Ee,setScissorTest:function(e){e?pe(3089):me(3089)},activeTexture:Te,bindTexture:function(t,n){null===ue&&Te();let r=le[ue];void 0===r&&(r={type:void 0,texture:void 0},le[ue]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||fe[t]),r.type=t,r.texture=n)},unbindTexture:function(){const t=le[ue];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===ce.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),ce.copy(t))},viewport:function(t){!1===de.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),de.copy(t))},reset:function(){c={},ue=null,le={},d=null,f=null,$=null,ee=null,i.reset(),a.reset(),l.reset()}}}function Is(e,t,n,r,i,a,o){const s=i.isWebGL2,u=i.maxTextures,l=i.maxCubemapSize,c=i.maxTextureSize,d=i.maxSamples,h=new WeakMap;let f,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function m(e,t){return p?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(e,t,n,r){let i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const r=t?Fn.floorPowerOfTwo:Math.floor,a=r(i*e.width),o=r(i*e.height);void 0===f&&(f=m(a,o));const s=n?m(a,o):f;s.width=a,s.height=o;return s.getContext("2d").drawImage(e,0,0,a,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+o+")."),s}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function v(e){return Fn.isPowerOfTwo(e.width)&&Fn.isPowerOfTwo(e.height)}function y(e,t){return e.generateMipmaps&&t&&e.minFilter!==pe&&e.minFilter!==_e}function _(t,n,i,a){e.generateMipmap(t);r.get(n).__maxMipLevel=Math.log(Math.max(i,a))*Math.LOG2E}function b(n,r,i){if(!1===s)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let a=r;return 6403===r&&(5126===i&&(a=33326),5131===i&&(a=33325),5121===i&&(a=33321)),6407===r&&(5126===i&&(a=34837),5131===i&&(a=34843),5121===i&&(a=32849)),6408===r&&(5126===i&&(a=34836),5131===i&&(a=34842),5121===i&&(a=32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||t.get("EXT_color_buffer_float"),a}function E(e){return e===pe||e===me||e===ve?9728:9729}function T(t){const n=t.target;n.removeEventListener("dispose",T),function(t){const n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&h.delete(n),o.memory.textures--}function S(t){const n=t.target;n.removeEventListener("dispose",S),function(t){const n=r.get(t),i=r.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&e.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer);r.remove(t.texture),r.remove(t)}(n),o.memory.textures--}let w=0;function A(e,t){const i=r.get(e);if(e.isVideoTexture&&function(e){const t=o.render.frame;h.get(e)!==t&&(h.set(e,t),e.update())}(e),e.version>0&&i.__version!==e.version){const n=e.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==n.complete)return void D(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function x(t,i){if(6!==t.image.length)return;const o=r.get(t);if(t.version>0&&o.__version!==t.version){O(o,t),n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture),e.pixelStorei(37440,t.flipY);const r=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture),u=t.image[0]&&t.image[0].isDataTexture,c=[];for(let e=0;e<6;e++)c[e]=r||u?u?t.image[e].image:t.image[e]:g(t.image[e],!1,!0,l);const d=c[0],h=v(d)||s,f=a.convert(t.format),p=a.convert(t.type),m=b(t.internalFormat,f,p);let E;if(I(34067,t,h),r){for(let e=0;e<6;e++){E=c[e].mipmaps;for(let r=0;r<E.length;r++){const i=E[r];t.format!==Be&&t.format!==Fe?null!==f?n.compressedTexImage2D(34069+e,r,m,i.width,i.height,0,i.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+e,r,m,i.width,i.height,0,f,p,i.data)}}o.__maxMipLevel=E.length-1}else{E=t.mipmaps;for(let e=0;e<6;e++)if(u){n.texImage2D(34069+e,0,m,c[e].width,c[e].height,0,f,p,c[e].data);for(let t=0;t<E.length;t++){const r=E[t].image[e].image;n.texImage2D(34069+e,t+1,m,r.width,r.height,0,f,p,r.data)}}else{n.texImage2D(34069+e,0,m,f,p,c[e]);for(let t=0;t<E.length;t++){const r=E[t];n.texImage2D(34069+e,t+1,m,f,p,r.image[e])}}o.__maxMipLevel=E.length}y(t,h)&&_(34067,t,d.width,d.height),o.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture)}function M(e,t){n.activeTexture(33984+t),n.bindTexture(34067,r.get(e).__webglTexture)}const C={[de]:10497,[he]:33071,[fe]:33648},R={[pe]:9728,[me]:9984,[ve]:9986,[_e]:9729,[be]:9985,[Te]:9987};function I(n,a,o){o?(e.texParameteri(n,10242,C[a.wrapS]),e.texParameteri(n,10243,C[a.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,C[a.wrapR]),e.texParameteri(n,10240,R[a.magFilter]),e.texParameteri(n,10241,R[a.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),a.wrapS===he&&a.wrapT===he||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,E(a.magFilter)),e.texParameteri(n,10241,E(a.minFilter)),a.minFilter!==pe&&a.minFilter!==_e&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const u=t.get("EXT_texture_filter_anisotropic");if(u){if(a.type===Ie&&null===t.get("OES_texture_float_linear"))return;if(a.type===Oe&&null===(s||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function O(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",T),t.__webglTexture=e.createTexture(),o.memory.textures++)}function D(t,r,i){let o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),O(t,r),n.activeTexture(33984+i),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment);const u=function(e){return!s&&(e.wrapS!==he||e.wrapT!==he||e.minFilter!==pe&&e.minFilter!==_e)}(r)&&!1===v(r.image),l=g(r.image,u,!1,c),d=v(l)||s,h=a.convert(r.format);let f,p=a.convert(r.type),m=b(r.internalFormat,h,p);I(o,r,d);const E=r.mipmaps;if(r.isDepthTexture)m=6402,s?m=r.type===Ie?36012:r.type===Re?33190:r.type===Ne?35056:33189:r.type===Ie&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===He&&6402===m&&r.type!==Me&&r.type!==Re&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Me,p=a.convert(r.type)),r.format===Ve&&6402===m&&(m=34041,r.type!==Ne&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Ne,p=a.convert(r.type))),n.texImage2D(3553,0,m,l.width,l.height,0,h,p,null);else if(r.isDataTexture)if(E.length>0&&d){for(let e=0,t=E.length;e<t;e++)f=E[e],n.texImage2D(3553,e,m,f.width,f.height,0,h,p,f.data);r.generateMipmaps=!1,t.__maxMipLevel=E.length-1}else n.texImage2D(3553,0,m,l.width,l.height,0,h,p,l.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(let e=0,t=E.length;e<t;e++)f=E[e],r.format!==Be&&r.format!==Fe?null!==h?n.compressedTexImage2D(3553,e,m,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,e,m,f.width,f.height,0,h,p,f.data);t.__maxMipLevel=E.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,m,l.width,l.height,l.depth,0,h,p,l.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,m,l.width,l.height,l.depth,0,h,p,l.data),t.__maxMipLevel=0;else if(E.length>0&&d){for(let e=0,t=E.length;e<t;e++)f=E[e],n.texImage2D(3553,e,m,h,p,f);r.generateMipmaps=!1,t.__maxMipLevel=E.length-1}else n.texImage2D(3553,0,m,h,p,l),t.__maxMipLevel=0;y(r,d)&&_(o,r,l.width,l.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function P(t,i,o,s){const u=a.convert(i.texture.format),l=a.convert(i.texture.type),c=b(i.texture.internalFormat,u,l);n.texImage2D(s,0,c,i.width,i.height,0,u,l,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function L(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let i=33189;if(r){const t=n.depthTexture;t&&t.isDepthTexture&&(t.type===Ie?i=36012:t.type===Re&&(i=33190));const r=k(n);e.renderbufferStorageMultisample(36161,r,i,n.width,n.height)}else e.renderbufferStorage(36161,i,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){const t=k(n);e.renderbufferStorageMultisample(36161,t,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=a.convert(n.texture.format),i=a.convert(n.texture.type),o=b(n.texture.internalFormat,t,i);if(r){const t=k(n);e.renderbufferStorageMultisample(36161,t,o,n.width,n.height)}else e.renderbufferStorage(36161,o,n.width,n.height)}e.bindRenderbuffer(36161,null)}function N(t){const n=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),A(n.depthTexture,0);const i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===He)e.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==Ve)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(let r=0;r<6;r++)e.bindFramebuffer(36160,n.__webglFramebuffer[r]),n.__webglDepthbuffer[r]=e.createRenderbuffer(),L(n.__webglDepthbuffer[r],t,!1)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),L(n.__webglDepthbuffer,t,!1);e.bindFramebuffer(36160,null)}function k(e){return s&&e.isWebGLMultisampleRenderTarget?Math.min(d,e.samples):0}let F=!1,B=!1;this.allocateTextureUnit=function(){const e=w;return e>=u&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+u),w+=1,e},this.resetTextureUnits=function(){w=0},this.setTexture2D=A,this.setTexture2DArray=function(e,t){const i=r.get(e);e.version>0&&i.__version!==e.version?D(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){const i=r.get(e);e.version>0&&i.__version!==e.version?D(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=x,this.setTextureCubeDynamic=M,this.setupRenderTarget=function(t){const i=r.get(t),u=r.get(t.texture);t.addEventListener("dispose",S),u.__webglTexture=e.createTexture(),o.memory.textures++;const l=!0===t.isWebGLCubeRenderTarget,c=!0===t.isWebGLMultisampleRenderTarget,d=v(t)||s;if(!s||t.texture.format!==Fe||t.texture.type!==Ie&&t.texture.type!==Oe||(t.texture.format=Be,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),l){i.__webglFramebuffer=[];for(let t=0;t<6;t++)i.__webglFramebuffer[t]=e.createFramebuffer()}else if(i.__webglFramebuffer=e.createFramebuffer(),c)if(s){i.__webglMultisampledFramebuffer=e.createFramebuffer(),i.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,i.__webglColorRenderbuffer);const n=a.convert(t.texture.format),r=a.convert(t.texture.type),o=b(t.texture.internalFormat,n,r),s=k(t);e.renderbufferStorageMultisample(36161,s,o,t.width,t.height),e.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(i.__webglDepthRenderbuffer=e.createRenderbuffer(),L(i.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(l){n.bindTexture(34067,u.__webglTexture),I(34067,t.texture,d);for(let e=0;e<6;e++)P(i.__webglFramebuffer[e],t,36064,34069+e);y(t.texture,d)&&_(34067,t.texture,t.width,t.height),n.bindTexture(34067,null)}else n.bindTexture(3553,u.__webglTexture),I(3553,t.texture,d),P(i.__webglFramebuffer,t,36064,3553),y(t.texture,d)&&_(3553,t.texture,t.width,t.height),n.bindTexture(3553,null);t.depthBuffer&&N(t)},this.updateRenderTargetMipmap=function(e){const t=e.texture;if(y(t,v(e)||s)){const i=e.isWebGLCubeRenderTarget?34067:3553,a=r.get(t).__webglTexture;n.bindTexture(i,a),_(i,t,e.width,e.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(s){const n=r.get(t);e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer);const i=t.width,a=t.height;let o=16384;t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024),e.blitFramebuffer(0,0,i,a,0,0,i,a,o,9728),e.bindFramebuffer(36160,n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),F=!0),e=e.texture),A(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===B&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),B=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?x(e,t):M(e,t)}}function Os(e,t,n){const r=n.isWebGL2;return{convert:function(e){let n;if(e===we)return 5121;if(e===De)return 32819;if(e===Pe)return 32820;if(e===Le)return 33635;if(e===Ae)return 5120;if(e===xe)return 5122;if(e===Me)return 5123;if(e===Ce)return 5124;if(e===Re)return 5125;if(e===Ie)return 5126;if(e===Oe)return r?5131:(n=t.get("OES_texture_half_float"),null!==n?n.HALF_FLOAT_OES:null);if(e===ke)return 6406;if(e===Fe)return 6407;if(e===Be)return 6408;if(e===Ue)return 6409;if(e===je)return 6410;if(e===He)return 6402;if(e===Ve)return 34041;if(e===ze)return 6403;if(e===We)return 36244;if(e===qe)return 33319;if(e===Ye)return 33320;if(e===Ke)return 36248;if(e===Xe)return 36249;if(e===Qe||e===Ze||e===Je||e===$e){if(n=t.get("WEBGL_compressed_texture_s3tc"),null===n)return null;if(e===Qe)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Ze)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Je)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===$e)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===et||e===tt||e===nt||e===rt){if(n=t.get("WEBGL_compressed_texture_pvrtc"),null===n)return null;if(e===et)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===tt)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===nt)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===rt)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===it)return n=t.get("WEBGL_compressed_texture_etc1"),null!==n?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===at||e===ot)&&(n=t.get("WEBGL_compressed_texture_etc"),null!==n)){if(e===at)return n.COMPRESSED_RGB8_ETC2;if(e===ot)return n.COMPRESSED_RGBA8_ETC2_EAC}return e===st||e===ut||e===lt||e===ct||e===dt||e===ht||e===ft||e===pt||e===mt||e===gt||e===vt||e===yt||e===_t||e===bt||e===Tt||e===St||e===wt||e===At||e===xt||e===Mt||e===Ct||e===Rt||e===It||e===Ot||e===Dt||e===Pt||e===Lt||e===Nt?(n=t.get("WEBGL_compressed_texture_astc"),null!==n?e:null):e===Et?(n=t.get("EXT_texture_compression_bptc"),null!==n?e:null):e===Ne?r?34042:(n=t.get("WEBGL_depth_texture"),null!==n?n.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function Ds(e){Ea.call(this),this.cameras=e||[]}function Ps(){Tr.call(this),this.type="Group"}function Ls(){this._targetRay=null,this._grip=null,this._hand=null}function Ns(e,t){const n=this;let r=null,i=1,a=null,o="local-floor",s=null;const u=[],l=new Map,c=new Ea;c.layers.enable(1),c.viewport=new zn;const d=new Ea;d.layers.enable(2),d.viewport=new zn;const h=[c,d],f=new Ds;f.layers.enable(1),f.layers.enable(2);let p=null,m=null;function g(e){const t=l.get(e.inputSource);t&&t.dispatchEvent({type:e.type})}function v(){l.forEach((function(e,t){e.disconnect(t)})),l.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),w.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function y(e){a=e,w.setContext(r),w.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function _(e){const t=r.inputSources;for(let e=0;e<u.length;e++)l.set(t[e],u[e]);for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=l.get(n);r&&(r.dispatchEvent({type:"disconnected",data:n}),l.delete(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t],r=l.get(n);r&&r.dispatchEvent({type:"connected",data:n})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=u[e];return void 0===t&&(t=new Ls,u[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=u[e];return void 0===t&&(t=new Ls,u[e]=t),t.getGripSpace()},this.getHand=function(e){let t=u[e];return void 0===t&&(t=new Ls,u[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getSession=function(){return r},this.setSession=function(e){if(r=e,null!==r){r.addEventListener("select",g),r.addEventListener("selectstart",g),r.addEventListener("selectend",g),r.addEventListener("squeeze",g),r.addEventListener("squeezestart",g),r.addEventListener("squeezeend",g),r.addEventListener("end",v);const e=t.getContextAttributes();!0!==e.xrCompatible&&t.makeXRCompatible();const n={antialias:e.antialias,alpha:e.alpha,depth:e.depth,stencil:e.stencil,framebufferScaleFactor:i},a=new XRWebGLLayer(r,t,n);r.updateRenderState({baseLayer:a}),r.requestReferenceSpace(o).then(y),r.addEventListener("inputsourceschange",_)}};const b=new Qn,E=new Qn;function T(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){f.near=d.near=c.near=e.near,f.far=d.far=c.far=e.far,p===f.near&&m===f.far||(r.updateRenderState({depthNear:f.near,depthFar:f.far}),p=f.near,m=f.far);const t=e.parent,n=f.cameras;T(f,t);for(let e=0;e<n.length;e++)T(n[e],t);e.matrixWorld.copy(f.matrixWorld);const i=e.children;for(let e=0,t=i.length;e<t;e++)i[e].updateMatrixWorld(!0);return 2===n.length?function(e,t,n){b.setFromMatrixPosition(t.matrixWorld),E.setFromMatrixPosition(n.matrixWorld);const r=b.distanceTo(E),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],c=(i[8]-1)/i[0],d=(a[8]+1)/a[0],h=o*c,f=o*d,p=r/(-c+d),m=p*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);const g=o+p,v=s+p,y=h-m,_=f+(r-m),T=u*s/v*g,S=l*s/v*g;e.projectionMatrix.makePerspective(y,_,T,S,g,v)}(f,c,d):f.projectionMatrix.copy(c.projectionMatrix),f};let S=null;const w=new Ia;w.setAnimationLoop((function(t,n){if(s=n.getViewerPose(a),null!==s){const t=s.views,n=r.renderState.baseLayer;e.setFramebuffer(n.framebuffer);let i=!1;t.length!==f.cameras.length&&(f.cameras.length=0,i=!0);for(let e=0;e<t.length;e++){const r=t[e],a=n.getViewport(r),o=h[e];o.matrix.fromArray(r.transform.matrix),o.projectionMatrix.fromArray(r.projectionMatrix),o.viewport.set(a.x,a.y,a.width,a.height),0===e&&f.matrix.copy(o.matrix),!0===i&&f.cameras.push(o)}}const i=r.inputSources;for(let e=0;e<u.length;e++){const t=u[e],r=i[e];t.update(r,n,a)}S&&S(t,n)})),this.setAnimationLoop=function(e){S=e},this.dispose=function(){}}function ks(e){function t(t,n,r){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);const i=n.envMap||r;if(i){t.envMap.value=i,t.flipEnvMap.value=i.isCubeTexture?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;var a=e.get(i).__maxMipLevel;void 0!==a&&(t.maxMipLevel.value=a)}let o,s;n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?o=n.map:n.specularMap?o=n.specularMap:n.displacementMap?o=n.displacementMap:n.normalMap?o=n.normalMap:n.bumpMap?o=n.bumpMap:n.roughnessMap?o=n.roughnessMap:n.metalnessMap?o=n.metalnessMap:n.alphaMap?o=n.alphaMap:n.emissiveMap&&(o=n.emissiveMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),t.uvTransform.value.copy(o.matrix)),n.aoMap?s=n.aoMap:n.lightMap&&(s=n.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),t.uv2Transform.value.copy(s.matrix))}function n(e,t,n){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),(t.envMap||n)&&(e.envMapIntensity.value=t.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,i,a,o){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r,i),r.isMeshPhysicalMaterial?function(e,t,r){n(e,t,r),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap);t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===m&&e.clearcoatNormalScale.value.negate());e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap)}(e,r,i):n(e,r,i)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);let i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(e,r,a,o):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);let n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Fs(e){const t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let d=null,h=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Qt,this.physicallyCorrectLights=!1,this.toneMapping=J,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const f=this;let p=!1,m=null,g=0,v=0,y=null,_=null,b=-1,E=null,T=null;const S=new zn,w=new zn;let A=null,x=t.width,M=t.height,C=1,R=null,I=null;const O=new zn(0,0,x,M),D=new zn(0,0,x,M);let P=!1;const L=new Ca,N=new ja;let k=!1,F=!1;const B=new ir,U=new Qn,j={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function G(){return null===y?C:1}let H,V,z,W,q,Y,K,X,Q,Z,$,ee,te,ne,re,ie,ae,oe,se,ue=n;function le(e,n){for(let r=0;r<e.length;r++){const i=e[r],a=t.getContext(i,n);if(null!==a)return a}return null}try{const e={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:c};if(t.addEventListener("webglcontextlost",fe,!1),t.addEventListener("webglcontextrestored",pe,!1),null===ue){const t=["webgl2","webgl","experimental-webgl"];if(!0===f.isWebGL1Renderer&&t.shift(),ue=le(t,e),null===ue)throw le(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ue.getShaderPrecisionFormat&&(ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function ce(){H=new Ga(ue),V=new Ua(ue,H,e),!1===V.isWebGL2&&(H.get("WEBGL_depth_texture"),H.get("OES_texture_float"),H.get("OES_texture_half_float"),H.get("OES_texture_half_float_linear"),H.get("OES_standard_derivatives"),H.get("OES_element_index_uint"),H.get("OES_vertex_array_object"),H.get("ANGLE_instanced_arrays")),H.get("OES_texture_float_linear"),oe=new Os(ue,H,V),z=new Rs(ue,H,V),z.scissor(w.copy(D).multiplyScalar(C).floor()),z.viewport(S.copy(O).multiplyScalar(C).floor()),W=new za(ue),q=new ms,Y=new Is(ue,H,z,q,V,oe,W),K=new Oa(ue,V),se=new Fa(ue,H,K,V),X=new Ha(ue,K,W,se),Q=new Ka(ue,X,K,W),re=new Ya(ue),Z=new ps(f,H,V,se),$=new ks(q),ee=new _s(q),te=new As,ne=new ka(f,z,Q,s),ie=new Ba(ue,H,W,V),ae=new Va(ue,H,W,V),W.programs=Z.programs,f.capabilities=V,f.extensions=H,f.properties=q,f.renderLists=ee,f.state=z,f.info=W}ce();const de=new Ns(f,ue);this.xr=de;const he=new Cs(f,Q,V.maxTextureSize);function fe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),p=!0}function pe(){console.log("THREE.WebGLRenderer: Context Restored."),p=!1,ce()}function me(e){const t=e.target;t.removeEventListener("dispose",me),function(e){ge(e),q.remove(e)}(t)}function ge(e){const t=q.get(e).program;void 0!==t&&Z.releaseProgram(t)}this.shadowMap=he,this.getContext=function(){return ue},this.getContextAttributes=function(){return ue.getContextAttributes()},this.forceContextLoss=function(){const e=H.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=H.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(e){void 0!==e&&(C=e,this.setSize(x,M,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Bn),e.set(x,M)},this.setSize=function(e,n,r){de.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(x=e,M=n,t.width=Math.floor(e*C),t.height=Math.floor(n*C),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Bn),e.set(x*C,M*C).floor()},this.setDrawingBufferSize=function(e,n,r){x=e,M=n,C=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new zn),e.copy(S)},this.getViewport=function(e){return e.copy(O)},this.setViewport=function(e,t,n,r){e.isVector4?O.set(e.x,e.y,e.z,e.w):O.set(e,t,n,r),z.viewport(S.copy(O).multiplyScalar(C).floor())},this.getScissor=function(e){return e.copy(D)},this.setScissor=function(e,t,n,r){e.isVector4?D.set(e.x,e.y,e.z,e.w):D.set(e,t,n,r),z.scissor(w.copy(D).multiplyScalar(C).floor())},this.getScissorTest=function(){return P},this.setScissorTest=function(e){z.setScissorTest(P=e)},this.setOpaqueSort=function(e){R=e},this.setTransparentSort=function(e){I=e},this.getClearColor=function(){return ne.getClearColor()},this.setClearColor=function(){ne.setClearColor.apply(ne,arguments)},this.getClearAlpha=function(){return ne.getClearAlpha()},this.setClearAlpha=function(){ne.setClearAlpha.apply(ne,arguments)},this.clear=function(e,t,n){let r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),ue.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",fe,!1),t.removeEventListener("webglcontextrestored",pe,!1),ee.dispose(),te.dispose(),q.dispose(),Q.dispose(),se.dispose(),de.dispose(),ye.stop()},this.renderBufferImmediate=function(e,t){se.initAttributes();const n=q.get(e);e.hasPositions&&!n.position&&(n.position=ue.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=ue.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=ue.createBuffer()),e.hasColors&&!n.color&&(n.color=ue.createBuffer());const r=t.getAttributes();e.hasPositions&&(ue.bindBuffer(34962,n.position),ue.bufferData(34962,e.positionArray,35048),se.enableAttribute(r.position),ue.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(ue.bindBuffer(34962,n.normal),ue.bufferData(34962,e.normalArray,35048),se.enableAttribute(r.normal),ue.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(ue.bindBuffer(34962,n.uv),ue.bufferData(34962,e.uvArray,35048),se.enableAttribute(r.uv),ue.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(ue.bindBuffer(34962,n.color),ue.bufferData(34962,e.colorArray,35048),se.enableAttribute(r.color),ue.vertexAttribPointer(r.color,3,5126,!1,0,0)),se.disableUnusedAttributes(),ue.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=j);const o=i.isMesh&&i.matrixWorld.determinant()<0,s=Se(e,t,r,i);z.setMaterial(r,o);let u=n.index;const l=n.attributes.position;if(null===u){if(void 0===l||0===l.count)return}else if(0===u.count)return;let c,d=1;!0===r.wireframe&&(u=X.getWireframeAttribute(n),d=2),(r.morphTargets||r.morphNormals)&&re.update(i,n,r,s),se.setup(i,r,s,n,u);let h=ie;null!==u&&(c=K.get(u),h=ae,h.setIndex(c));const f=null!==u?u.count:l.count,p=n.drawRange.start*d,m=n.drawRange.count*d,g=null!==a?a.start*d:0,v=null!==a?a.count*d:1/0,y=Math.max(p,g),_=Math.min(f,p+m,g+v)-1,b=Math.max(0,_-y+1);if(0!==b){if(i.isMesh)!0===r.wireframe?(z.setLineWidth(r.wireframeLinewidth*G()),h.setMode(1)):h.setMode(4);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),z.setLineWidth(e*G()),i.isLineSegments?h.setMode(1):i.isLineLoop?h.setMode(2):h.setMode(3)}else i.isPoints?h.setMode(0):i.isSprite&&h.setMode(4);if(i.isInstancedMesh)h.renderInstances(y,b,i.count);else if(n.isInstancedBufferGeometry){const e=Math.min(n.instanceCount,n._maxInstanceCount);h.renderInstances(y,b,e)}else h.render(y,b)}},this.compile=function(e,t){h=te.get(e,t),h.init(),e.traverse((function(e){e.isLight&&(h.pushLight(e),e.castShadow&&h.pushShadow(e))})),h.setupLights(t);const n=new WeakMap;e.traverse((function(t){let r=t.material;if(r)if(Array.isArray(r))for(let i=0;i<r.length;i++){let a=r[i];!1===n.has(a)&&(Te(a,e,t),n.set(a))}else!1===n.has(r)&&(Te(r,e,t),n.set(r))}))};let ve=null;const ye=new Ia;function _e(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)h.pushLight(e),e.castShadow&&h.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||L.intersectsSprite(e)){r&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);const t=Q.update(e),i=e.material;i.visible&&d.push(e,t,i,n,U.z,null)}}else if(e.isImmediateRenderObject)r&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B),d.push(e,null,e.material,n,U.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==W.render.frame&&(e.skeleton.update(),e.skeleton.frame=W.render.frame),!e.frustumCulled||L.intersectsObject(e))){r&&U.setFromMatrixPosition(e.matrixWorld).applyMatrix4(B);const t=Q.update(e),i=e.material;if(Array.isArray(i)){const r=t.groups;for(let a=0,o=r.length;a<o;a++){const o=r[a],s=i[o.materialIndex];s&&s.visible&&d.push(e,t,s,n,U.z,o)}}else i.visible&&d.push(e,t,i,n,U.z,null)}const i=e.children;for(let e=0,a=i.length;e<a;e++)_e(i[e],t,n,r)}function be(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){const a=e[i],o=a.object,s=a.geometry,u=null===r?a.material:r,l=a.group;if(n.isArrayCamera){T=n;const e=n.cameras;for(let n=0,r=e.length;n<r;n++){const r=e[n];o.layers.test(r.layers)&&(z.viewport(S.copy(r.viewport)),h.setupLights(r),Ee(o,t,r,s,u,l))}}else T=null,Ee(o,t,n,s,u,l)}}function Ee(e,t,n,r,i,a){if(e.onBeforeRender(f,t,n,r,i,a),h=te.get(t,T||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){const r=Se(n,t,i,e);z.setMaterial(i),se.reset(),function(e,t){e.render((function(e){f.renderBufferImmediate(e,t)}))}(e,r)}else f.renderBufferDirect(n,t,r,i,e,a);e.onAfterRender(f,t,n,r,i,a),h=te.get(t,T||n)}function Te(e,t,n){!0!==t.isScene&&(t=j);const r=q.get(e),i=h.state.lights,a=h.state.shadowsArray,o=i.state.version,s=Z.getParameters(e,i.state,a,t,N.numPlanes,N.numIntersection,n),u=Z.getProgramCacheKey(s);let l=r.program,c=!0;if(void 0===l)e.addEventListener("dispose",me);else if(l.cacheKey!==u)ge(e);else if(r.lightsStateVersion!==o)r.lightsStateVersion=o,c=!1;else{if(void 0!==s.shaderID)return;c=!1}c&&(s.uniforms=Z.getUniforms(e,s),e.onBeforeCompile(s,f),l=Z.acquireProgram(s,u),r.program=l,r.uniforms=s.uniforms,r.outputEncoding=s.outputEncoding);const d=l.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(let t=0;t<f.maxMorphTargets;t++)d["morphTarget"+t]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(let t=0;t<f.maxMorphNormals;t++)d["morphNormal"+t]>=0&&e.numSupportedMorphNormals++}const p=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=N.numPlanes,r.numIntersection=N.numIntersection,p.clippingPlanes=N.uniform),r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(p.ambientLightColor.value=i.state.ambient,p.lightProbe.value=i.state.probe,p.directionalLights.value=i.state.directional,p.directionalLightShadows.value=i.state.directionalShadow,p.spotLights.value=i.state.spot,p.spotLightShadows.value=i.state.spotShadow,p.rectAreaLights.value=i.state.rectArea,p.pointLights.value=i.state.point,p.pointLightShadows.value=i.state.pointShadow,p.hemisphereLights.value=i.state.hemi,p.directionalShadowMap.value=i.state.directionalShadowMap,p.directionalShadowMatrix.value=i.state.directionalShadowMatrix,p.spotShadowMap.value=i.state.spotShadowMap,p.spotShadowMatrix.value=i.state.spotShadowMatrix,p.pointShadowMap.value=i.state.pointShadowMap,p.pointShadowMatrix.value=i.state.pointShadowMatrix);const m=r.program.getUniforms(),g=Yo.seqWithValue(m.seq,p);r.uniformsList=g}function Se(e,t,n,r){!0!==t.isScene&&(t=j),Y.resetTextureUnits();const i=t.fog,a=n.isMeshStandardMaterial?t.environment:null,o=null===y?f.outputEncoding:y.texture.encoding,s=q.get(n),u=h.state.lights;if(!0===k&&(!0===F||e!==E)){const t=e===E&&n.id===b;N.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,s,t)}n.version===s.__version?void 0===s.program||n.fog&&s.fog!==i||s.environment!==a||s.needsLights&&s.lightsStateVersion!==u.state.version?Te(n,t,r):void 0===s.numClippingPlanes||s.numClippingPlanes===N.numPlanes&&s.numIntersection===N.numIntersection?s.outputEncoding!==o&&Te(n,t,r):Te(n,t,r):(Te(n,t,r),s.__version=n.version);let l=!1,c=!1,d=!1;const p=s.program,m=p.getUniforms(),g=s.uniforms;if(z.useProgram(p.program)&&(l=!0,c=!0,d=!0),n.id!==b&&(b=n.id,c=!0),l||E!==e){if(m.setValue(ue,"projectionMatrix",e.projectionMatrix),V.logarithmicDepthBuffer&&m.setValue(ue,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),E!==e&&(E=e,c=!0,d=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const t=m.map.cameraPosition;void 0!==t&&t.setValue(ue,U.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&m.setValue(ue,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&m.setValue(ue,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){m.setOptional(ue,r,"bindMatrix"),m.setOptional(ue,r,"bindMatrixInverse");const e=r.skeleton;if(e){const t=e.bones;if(V.floatVertexTextures){if(void 0===e.boneTexture){let n=Math.sqrt(4*t.length);n=Fn.ceilPowerOfTwo(n),n=Math.max(n,4);const r=new Float32Array(n*n*4);r.set(e.boneMatrices);const i=new Aa(r,n,n,Be,Ie);e.boneMatrices=r,e.boneTexture=i,e.boneTextureSize=n}m.setValue(ue,"boneTexture",e.boneTexture,Y),m.setValue(ue,"boneTextureSize",e.boneTextureSize)}else m.setOptional(ue,e,"boneMatrices")}}var v,_;return(c||s.receiveShadow!==r.receiveShadow)&&(s.receiveShadow=r.receiveShadow,m.setValue(ue,"receiveShadow",r.receiveShadow)),c&&(m.setValue(ue,"toneMappingExposure",f.toneMappingExposure),s.needsLights&&(_=d,(v=g).ambientLightColor.needsUpdate=_,v.lightProbe.needsUpdate=_,v.directionalLights.needsUpdate=_,v.directionalLightShadows.needsUpdate=_,v.pointLights.needsUpdate=_,v.pointLightShadows.needsUpdate=_,v.spotLights.needsUpdate=_,v.spotLightShadows.needsUpdate=_,v.rectAreaLights.needsUpdate=_,v.hemisphereLights.needsUpdate=_),i&&n.fog&&$.refreshFogUniforms(g,i),$.refreshMaterialUniforms(g,n,a,C,M),void 0!==g.ltc_1&&(g.ltc_1.value=Ra.LTC_1),void 0!==g.ltc_2&&(g.ltc_2.value=Ra.LTC_2),Yo.upload(ue,s.uniformsList,g,Y)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Yo.upload(ue,s.uniformsList,g,Y),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&m.setValue(ue,"center",r.center),m.setValue(ue,"modelViewMatrix",r.modelViewMatrix),m.setValue(ue,"normalMatrix",r.normalMatrix),m.setValue(ue,"modelMatrix",r.matrixWorld),p}ye.setAnimationLoop((function(e){de.isPresenting||ve&&ve(e)})),"undefined"!=typeof window&&ye.setContext(window),this.setAnimationLoop=function(e){ve=e,de.setAnimationLoop(e),null===e?ye.stop():ye.start()},this.render=function(e,t){let n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===p)return;se.resetDefaultState(),b=-1,E=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===de.enabled&&!0===de.isPresenting&&(t=de.getCamera(t)),!0===e.isScene&&e.onBeforeRender(f,e,t,n||y),h=te.get(e,t),h.init(),B.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),L.setFromProjectionMatrix(B),F=this.localClippingEnabled,k=N.init(this.clippingPlanes,F,t),d=ee.get(e,t),d.init(),_e(e,t,0,f.sortObjects),d.finish(),!0===f.sortObjects&&d.sort(R,I),!0===k&&N.beginShadows();const i=h.state.shadowsArray;he.render(i,e,t),h.setupLights(t),!0===k&&N.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),ne.render(d,e,t,r);const a=d.opaque,o=d.transparent;a.length>0&&be(a,e,t),o.length>0&&be(o,e,t),!0===e.isScene&&e.onAfterRender(f,e,t),null!==y&&(Y.updateRenderTargetMipmap(y),Y.updateMultisampleRenderTarget(y)),z.buffers.depth.setTest(!0),z.buffers.depth.setMask(!0),z.buffers.color.setMask(!0),z.setPolygonOffset(!1),d=null,h=null},this.setFramebuffer=function(e){m!==e&&null===y&&ue.bindFramebuffer(36160,e),m=e},this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return y},this.setRenderTarget=function(e,t,n){y=e,g=t,v=n,e&&void 0===q.get(e).__webglFramebuffer&&Y.setupRenderTarget(e);let r=m,i=!1;if(e){const n=q.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=n[t||0],i=!0):r=e.isWebGLMultisampleRenderTarget?q.get(e).__webglMultisampledFramebuffer:n,S.copy(e.viewport),w.copy(e.scissor),A=e.scissorTest}else S.copy(O).multiplyScalar(C).floor(),w.copy(D).multiplyScalar(C).floor(),A=P;if(_!==r&&(ue.bindFramebuffer(36160,r),_=r),z.viewport(S),z.scissor(w),z.setScissorTest(A),i){const r=q.get(e.texture);ue.framebufferTexture2D(36160,36064,34069+(t||0),r.__webglTexture,n||0)}},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=q.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){let o=!1;s!==_&&(ue.bindFramebuffer(36160,s),o=!0);try{const s=e.texture,u=s.format,l=s.type;if(u!==Be&&oe.convert(u)!==ue.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(l===we||oe.convert(l)===ue.getParameter(35738)||l===Ie&&(V.isWebGL2||H.get("OES_texture_float")||H.get("WEBGL_color_buffer_float"))||l===Oe&&(V.isWebGL2?H.get("EXT_color_buffer_float"):H.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ue.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&ue.readPixels(t,n,r,i,oe.convert(u),oe.convert(l),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{o&&ue.bindFramebuffer(36160,_)}}},this.copyFramebufferToTexture=function(e,t,n){void 0===n&&(n=0);const r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r),o=oe.convert(t.format);Y.setTexture2D(t,0),ue.copyTexImage2D(3553,n,o,e.x,e.y,i,a,0),z.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r){void 0===r&&(r=0);const i=t.image.width,a=t.image.height,o=oe.convert(n.format),s=oe.convert(n.type);Y.setTexture2D(n,0),ue.pixelStorei(37440,n.flipY),ue.pixelStorei(37441,n.premultiplyAlpha),ue.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?ue.texSubImage2D(3553,r,e.x,e.y,i,a,o,s,t.image.data):t.isCompressedTexture?ue.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ue.texSubImage2D(3553,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&ue.generateMipmap(3553),z.unbindTexture()},this.initTexture=function(e){Y.setTexture2D(e,0),z.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Bs(e){Fs.call(this,e)}function Us(e,t){this.name="",this.color=new fi(e),this.density=void 0!==t?t:25e-5}function js(e,t,n){this.name="",this.color=new fi(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function Gs(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=An,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Fn.generateUUID()}Ds.prototype=Object.assign(Object.create(Ea.prototype),{constructor:Ds,isArrayCamera:!0}),Ps.prototype=Object.assign(Object.create(Tr.prototype),{constructor:Ps,isGroup:!0}),Object.assign(Ls.prototype,{constructor:Ls,getHandSpace:function(){if(null===this._hand&&(this._hand=new Ps,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let e=0;e<=window.XRHand.LITTLE_PHALANX_TIP;e++){let e=new Ps;e.matrixAutoUpdate=!1,e.visible=!1,this._hand.joints.push(e),this._hand.add(e)}return this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Ps,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Ps,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(e,t,n){let r=null,i=null,a=null;const o=this._targetRay,s=this._grip,u=this._hand;if(e)if(e.hand){a=!0;for(let r=0;r<=window.XRHand.LITTLE_PHALANX_TIP;r++)if(e.hand[r]){let i=t.getJointPose(e.hand[r],n);const a=u.joints[r];null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.jointRadius=i.radius),a.visible=null!==i;const o=u.joints[window.XRHand.INDEX_PHALANX_TIP],s=u.joints[window.XRHand.THUMB_PHALANX_TIP],l=o.position.distanceTo(s.position),c=.02,d=.005;u.inputState.pinching&&l>c+d?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&l<=c-d&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}}else null!==o&&(r=t.getPose(e.targetRaySpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale))),null!==s&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale)));return null!==o&&(o.visible=null!==r),null!==s&&(s.visible=null!==i),null!==u&&(u.visible=null!==a),this}}),Object.assign(Ns.prototype,Ln.prototype),Bs.prototype=Object.assign(Object.create(Fs.prototype),{constructor:Bs,isWebGL1Renderer:!0}),Object.assign(Us.prototype,{isFogExp2:!0,clone:function(){return new Us(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(js.prototype,{isFog:!0,clone:function(){return new js(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Gs.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Gs.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Fn.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new Gs(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Fn.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const Hs=new Qn;function Vs(e,t,n,r){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function zs(e){_i.call(this),this.type="SpriteMaterial",this.color=new fi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}let Ws;Object.defineProperties(Vs.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(Vs.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(let t=0,n=this.data.count;t<n;t++)Hs.x=this.getX(t),Hs.y=this.getY(t),Hs.z=this.getZ(t),Hs.applyMatrix4(e),this.setXYZ(t,Hs.x,Hs.y,Hs.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this},clone:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new Si(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Vs(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),zs.prototype=Object.create(_i.prototype),zs.prototype.constructor=zs,zs.prototype.isSpriteMaterial=!0,zs.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};const qs=new Qn,Ys=new Qn,Ks=new Qn,Xs=new Bn,Qs=new Bn,Zs=new ir,Js=new Qn,$s=new Qn,eu=new Qn,tu=new Bn,nu=new Bn,ru=new Bn;function iu(e){if(Tr.call(this),this.type="Sprite",void 0===Ws){Ws=new Hi;const e=new Gs(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Ws.setIndex([0,1,2,0,2,3]),Ws.setAttribute("position",new Vs(e,3,0,!1)),Ws.setAttribute("uv",new Vs(e,2,3,!1))}this.geometry=Ws,this.material=void 0!==e?e:new zs,this.center=new Bn(.5,.5)}function au(e,t,n,r,i,a){Xs.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(Qs.x=a*Xs.x-i*Xs.y,Qs.y=i*Xs.x+a*Xs.y):Qs.copy(Xs),e.copy(t),e.x+=Qs.x,e.y+=Qs.y,e.applyMatrix4(Zs)}iu.prototype=Object.assign(Object.create(Tr.prototype),{constructor:iu,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ys.setFromMatrixScale(this.matrixWorld),Zs.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ks.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ys.multiplyScalar(-Ks.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const a=this.center;au(Js.set(-.5,-.5,0),Ks,a,Ys,r,i),au($s.set(.5,-.5,0),Ks,a,Ys,r,i),au(eu.set(.5,.5,0),Ks,a,Ys,r,i),tu.set(0,0),nu.set(1,0),ru.set(1,1);let o=e.ray.intersectTriangle(Js,$s,eu,!1,qs);if(null===o&&(au($s.set(-.5,.5,0),Ks,a,Ys,r,i),nu.set(0,1),o=e.ray.intersectTriangle(Js,eu,$s,!1,qs),null===o))return;const s=e.ray.origin.distanceTo(qs);s<e.near||s>e.far||t.push({distance:s,point:qs.clone(),uv:li.getUV(qs,Js,$s,eu,tu,nu,ru,new Bn),face:null,object:this})},copy:function(e){return Tr.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}});const ou=new Qn,su=new Qn;function uu(){Tr.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function lu(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),oa.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ir,this.bindMatrixInverse=new ir}uu.prototype=Object.assign(Object.create(Tr.prototype),{constructor:uu,isLOD:!0,copy:function(e){Tr.prototype.copy.call(this,e,!1);const t=e.levels;for(let e=0,n=t.length;e<n;e++){const n=t[e];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);const n=this.levels;let r;for(r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null},raycast:function(e,t){if(this.levels.length>0){ou.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(ou);this.getObjectForDistance(n).raycast(e,t)}},update:function(e){const t=this.levels;if(t.length>1){ou.setFromMatrixPosition(e.matrixWorld),su.setFromMatrixPosition(this.matrixWorld);const n=ou.distanceTo(su)/e.zoom;let r,i;for(t[0].object.visible=!0,r=1,i=t.length;r<i&&n>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}},toJSON:function(e){const t=Tr.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let e=0,r=n.length;e<r;e++){const r=n[e];t.object.levels.push({object:r.object.uuid,distance:r.distance})}return t}}),lu.prototype=Object.assign(Object.create(oa.prototype),{constructor:lu,isSkinnedMesh:!0,copy:function(e){return oa.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const e=new zn,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){oa.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const e=new Qn,t=new zn,n=new zn,r=new Qn,i=new ir;return function(a,o){const s=this.skeleton,u=this.geometry;t.fromBufferAttribute(u.attributes.skinIndex,a),n.fromBufferAttribute(u.attributes.skinWeight,a),e.fromBufferAttribute(u.attributes.position,a).applyMatrix4(this.bindMatrix),o.set(0,0,0);for(let a=0;a<4;a++){const u=n.getComponent(a);if(0!==u){const n=t.getComponent(a);i.multiplyMatrices(s.bones[n].matrixWorld,s.boneInverses[n]),o.addScaledVector(r.copy(e).applyMatrix4(i),u)}}return o.applyMatrix4(this.bindMatrixInverse)}}()});const cu=new ir,du=new ir;function hu(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new ir)}}function fu(){Tr.call(this),this.type="Bone"}Object.assign(hu.prototype,{calculateInverses:function(){this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++){const t=new ir;this.bones[e]&&t.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(t)}},pose:function(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.getInverse(this.boneInverses[e])}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}},update:function(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let r=0,i=e.length;r<i;r++){const i=e[r]?e[r].matrixWorld:du;cu.multiplyMatrices(i,t[r]),cu.toArray(n,16*r)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new hu(this.bones,this.boneInverses)},getBoneByName:function(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),fu.prototype=Object.assign(Object.create(Tr.prototype),{constructor:fu,isBone:!0});const pu=new ir,mu=new ir,gu=[],vu=new oa;function yu(e,t,n){oa.call(this,e,t),this.instanceMatrix=new Si(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function _u(e){_i.call(this),this.type="LineBasicMaterial",this.color=new fi(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}yu.prototype=Object.assign(Object.create(oa.prototype),{constructor:yu,isInstancedMesh:!0,copy:function(e){return oa.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),this.count=e.count,this},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){const n=this.matrixWorld,r=this.count;if(vu.geometry=this.geometry,vu.material=this.material,void 0!==vu.material)for(let i=0;i<r;i++){this.getMatrixAt(i,pu),mu.multiplyMatrices(n,pu),vu.matrixWorld=mu,vu.raycast(e,gu);for(let e=0,n=gu.length;e<n;e++){const n=gu[e];n.instanceId=i,n.object=this,t.push(n)}gu.length=0}},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),_u.prototype=Object.create(_i.prototype),_u.prototype.constructor=_u,_u.prototype.isLineBasicMaterial=!0,_u.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};const bu=new Qn,Eu=new Qn,Tu=new ir,Su=new Kr,wu=new jr;function Au(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Tr.call(this),this.type="Line",this.geometry=void 0!==e?e:new Hi,this.material=void 0!==t?t:new _u,this.updateMorphTargets()}Au.prototype=Object.assign(Object.create(Tr.prototype),{constructor:Au,isLine:!0,copy:function(e){return Tr.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)bu.fromBufferAttribute(t,e-1),Eu.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=bu.distanceTo(Eu);e.setAttribute("lineDistance",new Oi(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){const t=e.vertices,n=e.lineDistances;n[0]=0;for(let e=1,r=t.length;e<r;e++)n[e]=n[e-1],n[e]+=t[e-1].distanceTo(t[e])}return this},raycast:function(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),wu.copy(n.boundingSphere),wu.applyMatrix4(r),wu.radius+=i,!1===e.ray.intersectsSphere(wu))return;Tu.getInverse(r),Su.copy(e.ray).applyMatrix4(Tu);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new Qn,u=new Qn,l=new Qn,c=new Qn,d=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){const r=n.index,i=n.attributes.position.array;if(null!==r){const n=r.array;for(let r=0,a=n.length-1;r<a;r+=d){const a=n[r],d=n[r+1];s.fromArray(i,3*a),u.fromArray(i,3*d);if(Su.distanceSqToSegment(s,u,c,l)>o)continue;c.applyMatrix4(this.matrixWorld);const h=e.ray.origin.distanceTo(c);h<e.near||h>e.far||t.push({distance:h,point:l.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else for(let n=0,r=i.length/3-1;n<r;n+=d){s.fromArray(i,3*n),u.fromArray(i,3*n+3);if(Su.distanceSqToSegment(s,u,c,l)>o)continue;c.applyMatrix4(this.matrixWorld);const r=e.ray.origin.distanceTo(c);r<e.near||r>e.far||t.push({distance:r,point:l.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){const r=n.vertices,i=r.length;for(let n=0;n<i-1;n+=d){if(Su.distanceSqToSegment(r[n],r[n+1],c,l)>o)continue;c.applyMatrix4(this.matrixWorld);const i=e.ray.origin.distanceTo(c);i<e.near||i>e.far||t.push({distance:i,point:l.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const xu=new Qn,Mu=new Qn;function Cu(e,t){Au.call(this,e,t),this.type="LineSegments"}function Ru(e,t){Au.call(this,e,t),this.type="LineLoop"}function Iu(e){_i.call(this),this.type="PointsMaterial",this.color=new fi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}Cu.prototype=Object.assign(Object.create(Au.prototype),{constructor:Cu,isLineSegments:!0,computeLineDistances:function(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)xu.fromBufferAttribute(t,e),Mu.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+xu.distanceTo(Mu);e.setAttribute("lineDistance",new Oi(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){const t=e.vertices,n=e.lineDistances;for(let e=0,r=t.length;e<r;e+=2)xu.copy(t[e]),Mu.copy(t[e+1]),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+xu.distanceTo(Mu)}return this}}),Ru.prototype=Object.assign(Object.create(Au.prototype),{constructor:Ru,isLineLoop:!0}),Iu.prototype=Object.create(_i.prototype),Iu.prototype.constructor=Iu,Iu.prototype.isPointsMaterial=!0,Iu.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};const Ou=new ir,Du=new Kr,Pu=new jr,Lu=new Qn;function Nu(e,t){Tr.call(this),this.type="Points",this.geometry=void 0!==e?e:new Hi,this.material=void 0!==t?t:new Iu,this.updateMorphTargets()}function ku(e,t,n,r,i,a,o){const s=Du.distanceSqToPoint(e);if(s<n){const n=new Qn;Du.closestPointToPoint(e,n),n.applyMatrix4(r);const u=i.ray.origin.distanceTo(n);if(u<i.near||u>i.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:n,index:t,face:null,object:o})}}function Fu(e,t,n,r,i,a,o,s,u){Vn.call(this,e,t,n,r,i,a,o,s,u),this.format=void 0!==o?o:Fe,this.minFilter=void 0!==a?a:_e,this.magFilter=void 0!==i?i:_e,this.generateMipmaps=!1;const l=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){l.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}function Bu(e,t,n,r,i,a,o,s,u,l,c,d){Vn.call(this,null,a,o,s,u,l,r,i,c,d),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Uu(e,t,n,r,i,a,o,s,u){Vn.call(this,e,t,n,r,i,a,o,s,u),this.needsUpdate=!0}function ju(e,t,n,r,i,a,o,s,u,l){if((l=void 0!==l?l:He)!==He&&l!==Ve)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===He&&(n=Me),void 0===n&&l===Ve&&(n=Ne),Vn.call(this,null,r,i,a,o,s,l,n,u),this.image={width:e,height:t},this.magFilter=void 0!==o?o:pe,this.minFilter=void 0!==s?s:pe,this.flipY=!1,this.generateMipmaps=!1}function Gu(e){Hi.call(this),this.type="WireframeGeometry";const t=[],n=[0,0],r={},i=["a","b","c"];if(e&&e.isGeometry){const a=e.faces;for(let e=0,t=a.length;e<t;e++){const t=a[e];for(let e=0;e<3;e++){const a=t[i[e]],o=t[i[(e+1)%3]];n[0]=Math.min(a,o),n[1]=Math.max(a,o);const s=n[0]+","+n[1];void 0===r[s]&&(r[s]={index1:n[0],index2:n[1]})}}for(const n in r){const i=r[n];let a=e.vertices[i.index1];t.push(a.x,a.y,a.z),a=e.vertices[i.index2],t.push(a.x,a.y,a.z)}}else if(e&&e.isBufferGeometry){let i=new Qn;if(null!==e.index){const a=e.attributes.position,o=e.index;let s=e.groups;0===s.length&&(s=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,t=s.length;e<t;++e){const t=s[e],i=t.start;for(let e=i,a=i+t.count;e<a;e+=3)for(let t=0;t<3;t++){const i=o.getX(e+t),a=o.getX(e+(t+1)%3);n[0]=Math.min(i,a),n[1]=Math.max(i,a);const s=n[0]+","+n[1];void 0===r[s]&&(r[s]={index1:n[0],index2:n[1]})}}for(const e in r){const n=r[e];i.fromBufferAttribute(a,n.index1),t.push(i.x,i.y,i.z),i.fromBufferAttribute(a,n.index2),t.push(i.x,i.y,i.z)}}else{const n=e.attributes.position;for(let e=0,r=n.count/3;e<r;e++)for(let r=0;r<3;r++){const a=3*e+r;i.fromBufferAttribute(n,a),t.push(i.x,i.y,i.z);const o=3*e+(r+1)%3;i.fromBufferAttribute(n,o),t.push(i.x,i.y,i.z)}}}this.setAttribute("position",new Oi(t,3))}function Hu(e,t,n){fa.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new Vu(e,t,n)),this.mergeVertices()}function Vu(e,t,n){Hi.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};const r=[],i=[],a=[],o=[],s=1e-5,u=new Qn,l=new Qn,c=new Qn,d=new Qn,h=new Qn;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const f=t+1;for(let r=0;r<=n;r++){const f=r/n;for(let n=0;n<=t;n++){const r=n/t;e(r,f,l),i.push(l.x,l.y,l.z),r-s>=0?(e(r-s,f,c),d.subVectors(l,c)):(e(r+s,f,c),d.subVectors(c,l)),f-s>=0?(e(r,f-s,c),h.subVectors(l,c)):(e(r,f+s,c),h.subVectors(c,l)),u.crossVectors(d,h).normalize(),a.push(u.x,u.y,u.z),o.push(r,f)}}for(let e=0;e<n;e++)for(let n=0;n<t;n++){const t=e*f+n,i=e*f+n+1,a=(e+1)*f+n+1,o=(e+1)*f+n;r.push(t,i,o),r.push(i,a,o)}this.setIndex(r),this.setAttribute("position",new Oi(i,3)),this.setAttribute("normal",new Oi(a,3)),this.setAttribute("uv",new Oi(o,2))}function zu(e,t,n,r){fa.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new Wu(e,t,n,r)),this.mergeVertices()}function Wu(e,t,n,r){Hi.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},n=n||1;const i=[],a=[];function o(e,t,n,r){const i=Math.pow(2,r),a=[];for(let r=0;r<=i;r++){a[r]=[];const o=e.clone().lerp(n,r/i),s=t.clone().lerp(n,r/i),u=i-r;for(let e=0;e<=u;e++)a[r][e]=0===e&&r===i?o:o.clone().lerp(s,e/u)}for(let e=0;e<i;e++)for(let t=0;t<2*(i-e)-1;t++){const n=Math.floor(t/2);t%2==0?(s(a[e][n+1]),s(a[e+1][n]),s(a[e][n])):(s(a[e][n+1]),s(a[e+1][n+1]),s(a[e+1][n]))}}function s(e){i.push(e.x,e.y,e.z)}function u(t,n){const r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function l(e,t,n,r){r<0&&1===e.x&&(a[t]=e.x-1),0===n.x&&0===n.z&&(a[t]=r/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}!function(e){const n=new Qn,r=new Qn,i=new Qn;for(let a=0;a<t.length;a+=3)u(t[a+0],n),u(t[a+1],r),u(t[a+2],i),o(n,r,i,e)}(r=r||0),function(e){const t=new Qn;for(let n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){const e=new Qn;for(let n=0;n<i.length;n+=3){e.x=i[n+0],e.y=i[n+1],e.z=i[n+2];const r=c(e)/2/Math.PI+.5,o=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);a.push(r,1-o)}var t;(function(){const e=new Qn,t=new Qn,n=new Qn,r=new Qn,o=new Bn,s=new Bn,u=new Bn;for(let d=0,h=0;d<i.length;d+=9,h+=6){e.set(i[d+0],i[d+1],i[d+2]),t.set(i[d+3],i[d+4],i[d+5]),n.set(i[d+6],i[d+7],i[d+8]),o.set(a[h+0],a[h+1]),s.set(a[h+2],a[h+3]),u.set(a[h+4],a[h+5]),r.copy(e).add(t).add(n).divideScalar(3);const f=c(r);l(o,h+0,e,f),l(s,h+2,t,f),l(u,h+4,n,f)}})(),function(){for(let e=0;e<a.length;e+=6){const t=a[e+0],n=a[e+2],r=a[e+4],i=Math.max(t,n,r),o=Math.min(t,n,r);i>.9&&o<.1&&(t<.2&&(a[e+0]+=1),n<.2&&(a[e+2]+=1),r<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new Oi(i,3)),this.setAttribute("normal",new Oi(i.slice(),3)),this.setAttribute("uv",new Oi(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function qu(e,t){fa.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Yu(e,t)),this.mergeVertices()}function Yu(e,t){Wu.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ku(e,t){fa.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Xu(e,t)),this.mergeVertices()}function Xu(e,t){Wu.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Qu(e,t){fa.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Zu(e,t)),this.mergeVertices()}function Zu(e,t){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Wu.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ju(e,t){fa.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new $u(e,t)),this.mergeVertices()}function $u(e,t){const n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Wu.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function el(e,t,n,r,i,a){fa.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");const o=new tl(e,t,n,r,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function tl(e,t,n,r,i){Hi.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},t=t||64,n=n||1,r=r||8,i=i||!1;const a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new Qn,s=new Qn,u=new Bn;let l=new Qn;const c=[],d=[],h=[],f=[];function p(i){l=e.getPointAt(i/t,l);const u=a.normals[i],h=a.binormals[i];for(let e=0;e<=r;e++){const t=e/r*Math.PI*2,i=Math.sin(t),a=-Math.cos(t);s.x=a*u.x+i*h.x,s.y=a*u.y+i*h.y,s.z=a*u.z+i*h.z,s.normalize(),d.push(s.x,s.y,s.z),o.x=l.x+n*s.x,o.y=l.y+n*s.y,o.z=l.z+n*s.z,c.push(o.x,o.y,o.z)}}!function(){for(let e=0;e<t;e++)p(e);p(!1===i?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++)u.x=e/t,u.y=n/r,h.push(u.x,u.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),a=(r+1)*e+t,o=(r+1)*(e-1)+t;f.push(n,i,o),f.push(i,a,o)}}()}(),this.setIndex(f),this.setAttribute("position",new Oi(c,3)),this.setAttribute("normal",new Oi(d,3)),this.setAttribute("uv",new Oi(h,2))}function nl(e,t,n,r,i,a,o){fa.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new rl(e,t,n,r,i,a)),this.mergeVertices()}function rl(e,t,n,r,i,a){Hi.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,a=a||3;const o=[],s=[],u=[],l=[],c=new Qn,d=new Qn,h=new Qn,f=new Qn,p=new Qn,m=new Qn,g=new Qn;for(let o=0;o<=n;++o){const y=o/n*i*Math.PI*2;v(y,i,a,e,h),v(y+.01,i,a,e,f),m.subVectors(f,h),g.addVectors(f,h),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let e=0;e<=r;++e){const i=e/r*Math.PI*2,a=-t*Math.cos(i),f=t*Math.sin(i);c.x=h.x+(a*g.x+f*p.x),c.y=h.y+(a*g.y+f*p.y),c.z=h.z+(a*g.z+f*p.z),s.push(c.x,c.y,c.z),d.subVectors(c,h).normalize(),u.push(d.x,d.y,d.z),l.push(o/n),l.push(e/r)}}for(let e=1;e<=n;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),a=(r+1)*e+t,s=(r+1)*(e-1)+t;o.push(n,i,s),o.push(i,a,s)}function v(e,t,n,r,i){const a=Math.cos(e),o=Math.sin(e),s=n/t*e,u=Math.cos(s);i.x=r*(2+u)*.5*a,i.y=r*(2+u)*o*.5,i.z=r*Math.sin(s)*.5}this.setIndex(o),this.setAttribute("position",new Oi(s,3)),this.setAttribute("normal",new Oi(u,3)),this.setAttribute("uv",new Oi(l,2))}function il(e,t,n,r,i){fa.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new al(e,t,n,r,i)),this.mergeVertices()}function al(e,t,n,r,i){Hi.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;const a=[],o=[],s=[],u=[],l=new Qn,c=new Qn,d=new Qn;for(let a=0;a<=n;a++)for(let h=0;h<=r;h++){const f=h/r*i,p=a/n*Math.PI*2;c.x=(e+t*Math.cos(p))*Math.cos(f),c.y=(e+t*Math.cos(p))*Math.sin(f),c.z=t*Math.sin(p),o.push(c.x,c.y,c.z),l.x=e*Math.cos(f),l.y=e*Math.sin(f),d.subVectors(c,l).normalize(),s.push(d.x,d.y,d.z),u.push(h/r),u.push(a/n)}for(let e=1;e<=n;e++)for(let t=1;t<=r;t++){const n=(r+1)*e+t-1,i=(r+1)*(e-1)+t-1,o=(r+1)*(e-1)+t,s=(r+1)*e+t;a.push(n,i,s),a.push(i,o,s)}this.setIndex(a),this.setAttribute("position",new Oi(o,3)),this.setAttribute("normal",new Oi(s,3)),this.setAttribute("uv",new Oi(u,2))}Nu.prototype=Object.assign(Object.create(Tr.prototype),{constructor:Nu,isPoints:!0,copy:function(e){return Tr.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),Pu.copy(n.boundingSphere),Pu.applyMatrix4(r),Pu.radius+=i,!1===e.ray.intersectsSphere(Pu))return;Ou.getInverse(r),Du.copy(e.ray).applyMatrix4(Ou);const a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(n.isBufferGeometry){const i=n.index,a=n.attributes.position.array;if(null!==i){const n=i.array;for(let i=0,s=n.length;i<s;i++){const s=n[i];Lu.fromArray(a,3*s),ku(Lu,s,o,r,e,t,this)}}else for(let n=0,i=a.length/3;n<i;n++)Lu.fromArray(a,3*n),ku(Lu,n,o,r,e,t,this)}else{const i=n.vertices;for(let n=0,a=i.length;n<a;n++)ku(i[n],n,o,r,e,t,this)}},updateMorphTargets:function(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),Fu.prototype=Object.assign(Object.create(Vn.prototype),{constructor:Fu,isVideoTexture:!0,update:function(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Bu.prototype=Object.create(Vn.prototype),Bu.prototype.constructor=Bu,Bu.prototype.isCompressedTexture=!0,Uu.prototype=Object.create(Vn.prototype),Uu.prototype.constructor=Uu,Uu.prototype.isCanvasTexture=!0,ju.prototype=Object.create(Vn.prototype),ju.prototype.constructor=ju,ju.prototype.isDepthTexture=!0,Gu.prototype=Object.create(Hi.prototype),Gu.prototype.constructor=Gu,Hu.prototype=Object.create(fa.prototype),Hu.prototype.constructor=Hu,Vu.prototype=Object.create(Hi.prototype),Vu.prototype.constructor=Vu,zu.prototype=Object.create(fa.prototype),zu.prototype.constructor=zu,Wu.prototype=Object.create(Hi.prototype),Wu.prototype.constructor=Wu,qu.prototype=Object.create(fa.prototype),qu.prototype.constructor=qu,Yu.prototype=Object.create(Wu.prototype),Yu.prototype.constructor=Yu,Ku.prototype=Object.create(fa.prototype),Ku.prototype.constructor=Ku,Xu.prototype=Object.create(Wu.prototype),Xu.prototype.constructor=Xu,Qu.prototype=Object.create(fa.prototype),Qu.prototype.constructor=Qu,Zu.prototype=Object.create(Wu.prototype),Zu.prototype.constructor=Zu,Ju.prototype=Object.create(fa.prototype),Ju.prototype.constructor=Ju,$u.prototype=Object.create(Wu.prototype),$u.prototype.constructor=$u,el.prototype=Object.create(fa.prototype),el.prototype.constructor=el,tl.prototype=Object.create(Hi.prototype),tl.prototype.constructor=tl,tl.prototype.toJSON=function(){const e=Hi.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},nl.prototype=Object.create(fa.prototype),nl.prototype.constructor=nl,rl.prototype=Object.create(Hi.prototype),rl.prototype.constructor=rl,il.prototype=Object.create(fa.prototype),il.prototype.constructor=il,al.prototype=Object.create(Hi.prototype),al.prototype.constructor=al;const ol=function(e,t,n){n=n||2;let r,i,a,o,s,u,l,c=t&&t.length,d=c?t[0]*n:e.length,h=sl(e,0,d,n,!0),f=[];if(!h||h.next===h.prev)return f;if(c&&(h=function(e,t,n,r){let i,a,o,s,u,l=[];for(i=0,a=t.length;i<a;i++)o=t[i]*r,s=i<a-1?t[i+1]*r:e.length,u=sl(e,o,s,r,!1),u===u.next&&(u.steiner=!0),l.push(yl(u));for(l.sort(pl),i=0;i<l.length;i++)ml(l[i],n),n=ul(n,n.next);return n}(e,t,h,n)),e.length>80*n){r=a=e[0],i=o=e[1];for(let t=n;t<d;t+=n)s=e[t],u=e[t+1],s<r&&(r=s),u<i&&(i=u),s>a&&(a=s),u>o&&(o=u);l=Math.max(a-r,o-i),l=0!==l?1/l:0}return ll(h,f,n,r,i,l),f};function sl(e,t,n,r,i){let a,o;if(i===function(e,t,n,r){let i=0;for(let a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(a=t;a<n;a+=r)o=Cl(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=Cl(a,e[a],e[a+1],o);return o&&Tl(o,o.next)&&(Rl(o),o=o.next),o}function ul(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!Tl(r,r.next)&&0!==El(r.prev,r,r.next))r=r.next;else{if(Rl(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function ll(e,t,n,r,i,a,o){if(!e)return;!o&&a&&function(e,t,n,r){let i=e;do{null===i.z&&(i.z=vl(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,n,r,i,a,o,s,u,l=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ,r);t++);for(u=l;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1)}(i)}(e,r,i,a);let s,u,l=e;for(;e.prev!==e.next;)if(s=e.prev,u=e.next,a?dl(e,r,i,a):cl(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),Rl(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?ll(e=hl(ul(e),t,n),t,n,r,i,a,2):2===o&&fl(e,t,n,r,i,a):ll(ul(e),t,n,r,i,a,1);break}}function cl(e){let t=e.prev,n=e,r=e.next;if(El(t,n,r)>=0)return!1;let i=e.next.next;for(;i!==e.prev;){if(_l(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&El(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function dl(e,t,n,r){let i=e.prev,a=e,o=e.next;if(El(i,a,o)>=0)return!1;let s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,d=vl(s,u,t,n,r),h=vl(l,c,t,n,r),f=e.prevZ,p=e.nextZ;for(;f&&f.z>=d&&p&&p.z<=h;){if(f!==e.prev&&f!==e.next&&_l(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&El(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&_l(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&El(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=d;){if(f!==e.prev&&f!==e.next&&_l(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&El(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&_l(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&El(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function hl(e,t,n){let r=e;do{let i=r.prev,a=r.next.next;!Tl(i,a)&&Sl(i,r,r.next,a)&&xl(i,a)&&xl(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),Rl(r),Rl(r.next),r=e=a),r=r.next}while(r!==e);return ul(r)}function fl(e,t,n,r,i,a){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&bl(o,e)){let s=Ml(o,e);return o=ul(o,o.next),s=ul(s,s.next),ll(o,t,n,r,i,a),void ll(s,t,n,r,i,a)}e=e.next}o=o.next}while(o!==e)}function pl(e,t){return e.x-t.x}function ml(e,t){if(t=function(e,t){let n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){let e=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=i&&e>o){if(o=e,e===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n;let s,u=n,l=n.x,c=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&_l(a<c?i:o,a,l,c,a<c?o:i,a,r.x,r.y)&&(s=Math.abs(a-r.y)/(i-r.x),xl(r,e)&&(s<d||s===d&&(r.x>n.x||r.x===n.x&&gl(n,r)))&&(n=r,d=s)),r=r.next}while(r!==u);return n}(e,t)){const n=Ml(t,e);ul(t,t.next),ul(n,n.next)}}function gl(e,t){return El(e.prev,e,t.prev)<0&&El(t.next,e,e.next)<0}function vl(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function yl(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function _l(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function bl(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Sl(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(xl(e,t)&&xl(t,e)&&function(e,t){let n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(El(e.prev,e,t.prev)||El(e,t.prev,t))||Tl(e,t)&&El(e.prev,e,e.next)>0&&El(t.prev,t,t.next)>0)}function El(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Tl(e,t){return e.x===t.x&&e.y===t.y}function Sl(e,t,n,r){const i=Al(El(e,t,n)),a=Al(El(e,t,r)),o=Al(El(n,r,e)),s=Al(El(n,r,t));return i!==a&&o!==s||(!(0!==i||!wl(e,n,t))||(!(0!==a||!wl(e,r,t))||(!(0!==o||!wl(n,e,r))||!(0!==s||!wl(n,t,r)))))}function wl(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Al(e){return e>0?1:e<0?-1:0}function xl(e,t){return El(e.prev,e,e.next)<0?El(e,t,e.next)>=0&&El(e,e.prev,t)>=0:El(e,t,e.prev)<0||El(e,e.next,t)<0}function Ml(e,t){let n=new Il(e.i,e.x,e.y),r=new Il(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function Cl(e,t,n,r){const i=new Il(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Rl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Il(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}const Ol={area:function(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return Ol.area(e)<0},triangulateShape:function(e,t){const n=[],r=[],i=[];Dl(e),Pl(n,e);let a=e.length;t.forEach(Dl);for(let e=0;e<t.length;e++)r.push(a),a+=t[e].length,Pl(n,t[e]);const o=ol(n,r);for(let e=0;e<o.length;e+=3)i.push(o.slice(e,e+3));return i}};function Dl(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Pl(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function Ll(e,t){fa.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Nl(e,t)),this.mergeVertices()}function Nl(e,t){Hi.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],i=[];for(let t=0,n=e.length;t<n;t++){a(e[t])}function a(e){const a=[],o=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1;let u=void 0!==t.depth?t.depth:100,l=void 0===t.bevelEnabled||t.bevelEnabled,c=void 0!==t.bevelThickness?t.bevelThickness:6,d=void 0!==t.bevelSize?t.bevelSize:c-2,h=void 0!==t.bevelOffset?t.bevelOffset:0,f=void 0!==t.bevelSegments?t.bevelSegments:3;const p=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:kl;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=t.amount);let g,v,y,_,b,E=!1;p&&(g=p.getSpacedPoints(s),E=!0,l=!1,v=p.computeFrenetFrames(s,!1),y=new Qn,_=new Qn,b=new Qn),l||(f=0,c=0,d=0,h=0);const T=e.extractPoints(o);let S=T.shape;const w=T.holes;if(!Ol.isClockWise(S)){S=S.reverse();for(let e=0,t=w.length;e<t;e++){const t=w[e];Ol.isClockWise(t)&&(w[e]=t.reverse())}}const A=Ol.triangulateShape(S,w),x=S;for(let e=0,t=w.length;e<t;e++){const t=w[e];S=S.concat(t)}function M(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}const C=S.length,R=A.length;function I(e,t,n){let r,i,a;const o=e.x-t.x,s=e.y-t.y,u=n.x-e.x,l=n.y-e.y,c=o*o+s*s,d=o*l-s*u;if(Math.abs(d)>Number.EPSILON){const d=Math.sqrt(c),h=Math.sqrt(u*u+l*l),f=t.x-s/d,p=t.y+o/d,m=((n.x-l/h-f)*l-(n.y+u/h-p)*u)/(o*l-s*u);r=f+o*m-e.x,i=p+s*m-e.y;const g=r*r+i*i;if(g<=2)return new Bn(r,i);a=Math.sqrt(g/2)}else{let e=!1;o>Number.EPSILON?u>Number.EPSILON&&(e=!0):o<-Number.EPSILON?u<-Number.EPSILON&&(e=!0):Math.sign(s)===Math.sign(l)&&(e=!0),e?(r=-s,i=o,a=Math.sqrt(c)):(r=o,i=s,a=Math.sqrt(c/2))}return new Bn(r/a,i/a)}const O=[];for(let e=0,t=x.length,n=t-1,r=e+1;e<t;e++,n++,r++)n===t&&(n=0),r===t&&(r=0),O[e]=I(x[e],x[n],x[r]);const D=[];let P,L=O.concat();for(let e=0,t=w.length;e<t;e++){const t=w[e];P=[];for(let e=0,n=t.length,r=n-1,i=e+1;e<n;e++,r++,i++)r===n&&(r=0),i===n&&(i=0),P[e]=I(t[e],t[r],t[i]);D.push(P),L=L.concat(P)}for(let e=0;e<f;e++){const t=e/f,n=c*Math.cos(t*Math.PI/2),r=d*Math.sin(t*Math.PI/2)+h;for(let e=0,t=x.length;e<t;e++){const t=M(x[e],O[e],r);F(t.x,t.y,-n)}for(let e=0,t=w.length;e<t;e++){const t=w[e];P=D[e];for(let e=0,i=t.length;e<i;e++){const i=M(t[e],P[e],r);F(i.x,i.y,-n)}}}const N=d+h;for(let e=0;e<C;e++){const t=l?M(S[e],L[e],N):S[e];E?(_.copy(v.normals[0]).multiplyScalar(t.x),y.copy(v.binormals[0]).multiplyScalar(t.y),b.copy(g[0]).add(_).add(y),F(b.x,b.y,b.z)):F(t.x,t.y,0)}for(let e=1;e<=s;e++)for(let t=0;t<C;t++){const n=l?M(S[t],L[t],N):S[t];E?(_.copy(v.normals[e]).multiplyScalar(n.x),y.copy(v.binormals[e]).multiplyScalar(n.y),b.copy(g[e]).add(_).add(y),F(b.x,b.y,b.z)):F(n.x,n.y,u/s*e)}for(let e=f-1;e>=0;e--){const t=e/f,n=c*Math.cos(t*Math.PI/2),r=d*Math.sin(t*Math.PI/2)+h;for(let e=0,t=x.length;e<t;e++){const t=M(x[e],O[e],r);F(t.x,t.y,u+n)}for(let e=0,t=w.length;e<t;e++){const t=w[e];P=D[e];for(let e=0,i=t.length;e<i;e++){const i=M(t[e],P[e],r);E?F(i.x,i.y+g[s-1].y,g[s-1].x+n):F(i.x,i.y,u+n)}}}function k(e,t){let n=e.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=e.length-1);for(let e=0,n=s+2*f;e<n;e++){const n=C*e,a=C*(e+1);U(t+r+n,t+i+n,t+i+a,t+r+a)}}}function F(e,t,n){a.push(e),a.push(t),a.push(n)}function B(e,t,i){j(e),j(t),j(i);const a=r.length/3,o=m.generateTopUV(n,r,a-3,a-2,a-1);G(o[0]),G(o[1]),G(o[2])}function U(e,t,i,a){j(e),j(t),j(a),j(t),j(i),j(a);const o=r.length/3,s=m.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);G(s[0]),G(s[1]),G(s[3]),G(s[1]),G(s[2]),G(s[3])}function j(e){r.push(a[3*e+0]),r.push(a[3*e+1]),r.push(a[3*e+2])}function G(e){i.push(e.x),i.push(e.y)}!function(){const e=r.length/3;if(l){let e=0,t=C*e;for(let e=0;e<R;e++){const n=A[e];B(n[2]+t,n[1]+t,n[0]+t)}e=s+2*f,t=C*e;for(let e=0;e<R;e++){const n=A[e];B(n[0]+t,n[1]+t,n[2]+t)}}else{for(let e=0;e<R;e++){const t=A[e];B(t[2],t[1],t[0])}for(let e=0;e<R;e++){const t=A[e];B(t[0]+C*s,t[1]+C*s,t[2]+C*s)}}n.addGroup(e,r.length/3-e,0)}(),function(){const e=r.length/3;let t=0;k(x,t),t+=x.length;for(let e=0,n=w.length;e<n;e++){const n=w[e];k(n,t),t+=n.length}n.addGroup(e,r.length/3-e,1)}()}this.setAttribute("position",new Oi(r,3)),this.setAttribute("uv",new Oi(i,2)),this.computeVertexNormals()}Ll.prototype=Object.create(fa.prototype),Ll.prototype.constructor=Ll,Ll.prototype.toJSON=function(){const e=fa.prototype.toJSON.call(this);return Fl(this.parameters.shapes,this.parameters.options,e)},Nl.prototype=Object.create(Hi.prototype),Nl.prototype.constructor=Nl,Nl.prototype.toJSON=function(){const e=Hi.prototype.toJSON.call(this);return Fl(this.parameters.shapes,this.parameters.options,e)};const kl={generateTopUV:function(e,t,n,r,i){const a=t[3*n],o=t[3*n+1],s=t[3*r],u=t[3*r+1],l=t[3*i],c=t[3*i+1];return[new Bn(a,o),new Bn(s,u),new Bn(l,c)]},generateSideWallUV:function(e,t,n,r,i,a){const o=t[3*n],s=t[3*n+1],u=t[3*n+2],l=t[3*r],c=t[3*r+1],d=t[3*r+2],h=t[3*i],f=t[3*i+1],p=t[3*i+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(s-c)<.01?[new Bn(o,1-u),new Bn(l,1-d),new Bn(h,1-p),new Bn(m,1-v)]:[new Bn(s,1-u),new Bn(c,1-d),new Bn(f,1-p),new Bn(g,1-v)]}};function Fl(e,t,n){if(n.shapes=[],Array.isArray(e))for(let t=0,r=e.length;t<r;t++){const r=e[t];n.shapes.push(r.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function Bl(e,t){fa.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Ul(e,t)),this.mergeVertices()}function Ul(e,t){const n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new fa;const r=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Nl.call(this,r,t),this.type="TextBufferGeometry"}function jl(e,t,n,r,i,a,o){fa.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Gl(e,t,n,r,i,a,o)),this.mergeVertices()}function Gl(e,t,n,r,i,a,o){Hi.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;const s=Math.min(a+o,Math.PI);let u=0;const l=[],c=new Qn,d=new Qn,h=[],f=[],p=[],m=[];for(let h=0;h<=n;h++){const g=[],v=h/n;let y=0;0==h&&0==a?y=.5/t:h==n&&s==Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const s=n/t;c.x=-e*Math.cos(r+s*i)*Math.sin(a+v*o),c.y=e*Math.cos(a+v*o),c.z=e*Math.sin(r+s*i)*Math.sin(a+v*o),f.push(c.x,c.y,c.z),d.copy(c).normalize(),p.push(d.x,d.y,d.z),m.push(s+y,1-v),g.push(u++)}l.push(g)}for(let e=0;e<n;e++)for(let r=0;r<t;r++){const t=l[e][r+1],i=l[e][r],o=l[e+1][r],u=l[e+1][r+1];(0!==e||a>0)&&h.push(t,i,u),(e!==n-1||s<Math.PI)&&h.push(i,o,u)}this.setIndex(h),this.setAttribute("position",new Oi(f,3)),this.setAttribute("normal",new Oi(p,3)),this.setAttribute("uv",new Oi(m,2))}function Hl(e,t,n,r,i,a){fa.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new Vl(e,t,n,r,i,a)),this.mergeVertices()}function Vl(e,t,n,r,i,a){Hi.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},e=e||.5,t=t||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;const o=[],s=[],u=[],l=[];let c=e;const d=(t-e)/(r=void 0!==r?Math.max(1,r):1),h=new Qn,f=new Bn;for(let e=0;e<=r;e++){for(let e=0;e<=n;e++){const r=i+e/n*a;h.x=c*Math.cos(r),h.y=c*Math.sin(r),s.push(h.x,h.y,h.z),u.push(0,0,1),f.x=(h.x/t+1)/2,f.y=(h.y/t+1)/2,l.push(f.x,f.y)}c+=d}for(let e=0;e<r;e++){const t=e*(n+1);for(let e=0;e<n;e++){const r=e+t,i=r,a=r+n+1,s=r+n+2,u=r+1;o.push(i,a,u),o.push(a,s,u)}}this.setIndex(o),this.setAttribute("position",new Oi(s,3)),this.setAttribute("normal",new Oi(u,3)),this.setAttribute("uv",new Oi(l,2))}function zl(e,t,n,r){fa.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new Wl(e,t,n,r)),this.mergeVertices()}function Wl(e,t,n,r){Hi.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||2*Math.PI,r=Fn.clamp(r,0,2*Math.PI);const i=[],a=[],o=[],s=1/t,u=new Qn,l=new Bn;for(let i=0;i<=t;i++){const c=n+i*s*r,d=Math.sin(c),h=Math.cos(c);for(let n=0;n<=e.length-1;n++)u.x=e[n].x*d,u.y=e[n].y,u.z=e[n].x*h,a.push(u.x,u.y,u.z),l.x=i/t,l.y=n/(e.length-1),o.push(l.x,l.y)}for(let n=0;n<t;n++)for(let t=0;t<e.length-1;t++){const r=t+n*e.length,a=r,o=r+e.length,s=r+e.length+1,u=r+1;i.push(a,o,u),i.push(o,s,u)}if(this.setIndex(i),this.setAttribute("position",new Oi(a,3)),this.setAttribute("uv",new Oi(o,2)),this.computeVertexNormals(),r===2*Math.PI){const n=this.attributes.normal.array,r=new Qn,i=new Qn,a=new Qn,o=t*e.length*3;for(let t=0,s=0;t<e.length;t++,s+=3)r.x=n[s+0],r.y=n[s+1],r.z=n[s+2],i.x=n[o+s+0],i.y=n[o+s+1],i.z=n[o+s+2],a.addVectors(r,i).normalize(),n[s+0]=n[o+s+0]=a.x,n[s+1]=n[o+s+1]=a.y,n[s+2]=n[o+s+2]=a.z}}function ql(e,t){fa.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Yl(e,t)),this.mergeVertices()}function Yl(e,t){Hi.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;const n=[],r=[],i=[],a=[];let o=0,s=0;if(!1===Array.isArray(e))u(e);else for(let t=0;t<e.length;t++)u(e[t]),this.addGroup(o,s,t),o+=s,s=0;function u(e){const o=r.length/3,u=e.extractPoints(t);let l=u.shape;const c=u.holes;!1===Ol.isClockWise(l)&&(l=l.reverse());for(let e=0,t=c.length;e<t;e++){const t=c[e];!0===Ol.isClockWise(t)&&(c[e]=t.reverse())}const d=Ol.triangulateShape(l,c);for(let e=0,t=c.length;e<t;e++){const t=c[e];l=l.concat(t)}for(let e=0,t=l.length;e<t;e++){const t=l[e];r.push(t.x,t.y,0),i.push(0,0,1),a.push(t.x,t.y)}for(let e=0,t=d.length;e<t;e++){const t=d[e],r=t[0]+o,i=t[1]+o,a=t[2]+o;n.push(r,i,a),s+=3}}this.setIndex(n),this.setAttribute("position",new Oi(r,3)),this.setAttribute("normal",new Oi(i,3)),this.setAttribute("uv",new Oi(a,2))}function Kl(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,r=e.length;n<r;n++){const r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}function Xl(e,t){Hi.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;const n=[],r=Math.cos(Fn.DEG2RAD*t),i=[0,0],a={};let o,s,u;const l=["a","b","c"];let c;e.isBufferGeometry?(c=new fa,c.fromBufferGeometry(e)):c=e.clone(),c.mergeVertices(),c.computeFaceNormals();const d=c.vertices,h=c.faces;for(let e=0,t=h.length;e<t;e++){const t=h[e];for(let n=0;n<3;n++)o=t[l[n]],s=t[l[(n+1)%3]],i[0]=Math.min(o,s),i[1]=Math.max(o,s),u=i[0]+","+i[1],void 0===a[u]?a[u]={index1:i[0],index2:i[1],face1:e,face2:void 0}:a[u].face2=e}for(u in a){const e=a[u];if(void 0===e.face2||h[e.face1].normal.dot(h[e.face2].normal)<=r){let t=d[e.index1];n.push(t.x,t.y,t.z),t=d[e.index2],n.push(t.x,t.y,t.z)}}this.setAttribute("position",new Oi(n,3))}function Ql(e,t,n,r,i,a,o,s){fa.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Zl(e,t,n,r,i,a,o,s)),this.mergeVertices()}function Zl(e,t,n,r,i,a,o,s){Hi.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};const u=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;const l=[],c=[],d=[],h=[];let f=0;const p=[],m=n/2;let g=0;function v(n){let i,a;const p=new Bn,v=new Qn;let y=0;const _=!0===n?e:t,b=!0===n?1:-1;i=f;for(let e=1;e<=r;e++)c.push(0,m*b,0),d.push(0,b,0),h.push(.5,.5),f++;a=f;for(let e=0;e<=r;e++){const t=e/r*s+o,n=Math.cos(t),i=Math.sin(t);v.x=_*i,v.y=m*b,v.z=_*n,c.push(v.x,v.y,v.z),d.push(0,b,0),p.x=.5*n+.5,p.y=.5*i*b+.5,h.push(p.x,p.y),f++}for(let e=0;e<r;e++){const t=i+e,r=a+e;!0===n?l.push(r,r+1,t):l.push(r+1,r,t),y+=3}u.addGroup(g,y,!0===n?1:2),g+=y}!function(){const a=new Qn,v=new Qn;let y=0;const _=(t-e)/n;for(let u=0;u<=i;u++){const l=[],g=u/i,y=g*(t-e)+e;for(let e=0;e<=r;e++){const t=e/r,i=t*s+o,u=Math.sin(i),p=Math.cos(i);v.x=y*u,v.y=-g*n+m,v.z=y*p,c.push(v.x,v.y,v.z),a.set(u,_,p).normalize(),d.push(a.x,a.y,a.z),h.push(t,1-g),l.push(f++)}p.push(l)}for(let e=0;e<r;e++)for(let t=0;t<i;t++){const n=p[t][e],r=p[t+1][e],i=p[t+1][e+1],a=p[t][e+1];l.push(n,r,a),l.push(r,i,a),y+=6}u.addGroup(g,y,0),g+=y}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(l),this.setAttribute("position",new Oi(c,3)),this.setAttribute("normal",new Oi(d,3)),this.setAttribute("uv",new Oi(h,2))}function Jl(e,t,n,r,i,a,o){Ql.call(this,0,e,t,n,r,i,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function $l(e,t,n,r,i,a,o){Zl.call(this,0,e,t,n,r,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function ec(e,t,n,r){fa.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new tc(e,t,n,r)),this.mergeVertices()}function tc(e,t,n,r){Hi.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;const i=[],a=[],o=[],s=[],u=new Qn,l=new Bn;a.push(0,0,0),o.push(0,0,1),s.push(.5,.5);for(let i=0,c=3;i<=t;i++,c+=3){const d=n+i/t*r;u.x=e*Math.cos(d),u.y=e*Math.sin(d),a.push(u.x,u.y,u.z),o.push(0,0,1),l.x=(a[c]/e+1)/2,l.y=(a[c+1]/e+1)/2,s.push(l.x,l.y)}for(let e=1;e<=t;e++)i.push(e,e+1,0);this.setIndex(i),this.setAttribute("position",new Oi(a,3)),this.setAttribute("normal",new Oi(o,3)),this.setAttribute("uv",new Oi(s,2))}Bl.prototype=Object.create(fa.prototype),Bl.prototype.constructor=Bl,Ul.prototype=Object.create(Nl.prototype),Ul.prototype.constructor=Ul,jl.prototype=Object.create(fa.prototype),jl.prototype.constructor=jl,Gl.prototype=Object.create(Hi.prototype),Gl.prototype.constructor=Gl,Hl.prototype=Object.create(fa.prototype),Hl.prototype.constructor=Hl,Vl.prototype=Object.create(Hi.prototype),Vl.prototype.constructor=Vl,zl.prototype=Object.create(fa.prototype),zl.prototype.constructor=zl,Wl.prototype=Object.create(Hi.prototype),Wl.prototype.constructor=Wl,ql.prototype=Object.create(fa.prototype),ql.prototype.constructor=ql,ql.prototype.toJSON=function(){const e=fa.prototype.toJSON.call(this);return Kl(this.parameters.shapes,e)},Yl.prototype=Object.create(Hi.prototype),Yl.prototype.constructor=Yl,Yl.prototype.toJSON=function(){const e=Hi.prototype.toJSON.call(this);return Kl(this.parameters.shapes,e)},Xl.prototype=Object.create(Hi.prototype),Xl.prototype.constructor=Xl,Ql.prototype=Object.create(fa.prototype),Ql.prototype.constructor=Ql,Zl.prototype=Object.create(Hi.prototype),Zl.prototype.constructor=Zl,Jl.prototype=Object.create(Ql.prototype),Jl.prototype.constructor=Jl,$l.prototype=Object.create(Zl.prototype),$l.prototype.constructor=$l,ec.prototype=Object.create(fa.prototype),ec.prototype.constructor=ec,tc.prototype=Object.create(Hi.prototype),tc.prototype.constructor=tc;var nc=Object.freeze({__proto__:null,WireframeGeometry:Gu,ParametricGeometry:Hu,ParametricBufferGeometry:Vu,TetrahedronGeometry:qu,TetrahedronBufferGeometry:Yu,OctahedronGeometry:Ku,OctahedronBufferGeometry:Xu,IcosahedronGeometry:Qu,IcosahedronBufferGeometry:Zu,DodecahedronGeometry:Ju,DodecahedronBufferGeometry:$u,PolyhedronGeometry:zu,PolyhedronBufferGeometry:Wu,TubeGeometry:el,TubeBufferGeometry:tl,TorusKnotGeometry:nl,TorusKnotBufferGeometry:rl,TorusGeometry:il,TorusBufferGeometry:al,TextGeometry:Bl,TextBufferGeometry:Ul,SphereGeometry:jl,SphereBufferGeometry:Gl,RingGeometry:Hl,RingBufferGeometry:Vl,PlaneGeometry:Da,PlaneBufferGeometry:Pa,LatheGeometry:zl,LatheBufferGeometry:Wl,ShapeGeometry:ql,ShapeBufferGeometry:Yl,ExtrudeGeometry:Ll,ExtrudeBufferGeometry:Nl,EdgesGeometry:Xl,ConeGeometry:Jl,ConeBufferGeometry:$l,CylinderGeometry:Ql,CylinderBufferGeometry:Zl,CircleGeometry:ec,CircleBufferGeometry:tc,BoxGeometry:pa,BoxBufferGeometry:ma});function rc(e){_i.call(this),this.type="ShadowMaterial",this.color=new fi(0),this.transparent=!0,this.setValues(e)}function ic(e){_a.call(this,e),this.type="RawShaderMaterial"}function ac(e){_i.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new fi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sn,this.normalScale=new Bn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}function oc(e){ac.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Bn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}function sc(e){_i.call(this),this.type="MeshPhongMaterial",this.color=new fi(16777215),this.specular=new fi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sn,this.normalScale=new Bn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=X,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function uc(e){_i.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new fi(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sn,this.normalScale=new Bn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function lc(e){_i.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sn,this.normalScale=new Bn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function cc(e){_i.call(this),this.type="MeshLambertMaterial",this.color=new fi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=X,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function dc(e){_i.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new fi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sn,this.normalScale=new Bn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function hc(e){_u.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}rc.prototype=Object.create(_i.prototype),rc.prototype.constructor=rc,rc.prototype.isShadowMaterial=!0,rc.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.color.copy(e.color),this},ic.prototype=Object.create(_a.prototype),ic.prototype.constructor=ic,ic.prototype.isRawShaderMaterial=!0,ac.prototype=Object.create(_i.prototype),ac.prototype.constructor=ac,ac.prototype.isMeshStandardMaterial=!0,ac.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},oc.prototype=Object.create(ac.prototype),oc.prototype.constructor=oc,oc.prototype.isMeshPhysicalMaterial=!0,oc.prototype.copy=function(e){return ac.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new fi).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this},sc.prototype=Object.create(_i.prototype),sc.prototype.constructor=sc,sc.prototype.isMeshPhongMaterial=!0,sc.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},uc.prototype=Object.create(_i.prototype),uc.prototype.constructor=uc,uc.prototype.isMeshToonMaterial=!0,uc.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},lc.prototype=Object.create(_i.prototype),lc.prototype.constructor=lc,lc.prototype.isMeshNormalMaterial=!0,lc.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},cc.prototype=Object.create(_i.prototype),cc.prototype.constructor=cc,cc.prototype.isMeshLambertMaterial=!0,cc.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},dc.prototype=Object.create(_i.prototype),dc.prototype.constructor=dc,dc.prototype.isMeshMatcapMaterial=!0,dc.prototype.copy=function(e){return _i.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},hc.prototype=Object.create(_u.prototype),hc.prototype.constructor=hc,hc.prototype.isLineDashedMaterial=!0,hc.prototype.copy=function(e){return _u.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var fc=Object.freeze({__proto__:null,ShadowMaterial:rc,SpriteMaterial:zs,RawShaderMaterial:ic,ShaderMaterial:_a,PointsMaterial:Iu,MeshPhysicalMaterial:oc,MeshStandardMaterial:ac,MeshPhongMaterial:sc,MeshToonMaterial:uc,MeshNormalMaterial:lc,MeshLambertMaterial:cc,MeshDepthMaterial:xs,MeshDistanceMaterial:Ms,MeshBasicMaterial:bi,MeshMatcapMaterial:dc,LineDashedMaterial:hc,LineBasicMaterial:_u,Material:_i});const pc={arraySlice:function(e,t,n){return pc.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){const t=e.length,n=new Array(t);for(let e=0;e!==t;++e)n[e]=e;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){const r=e.length,i=new e.constructor(r);for(let a=0,o=0;o!==r;++a){const r=n[a]*t;for(let n=0;n!==t;++n)i[o++]=e[r+n]}return i},flattenJSON:function(e,t,n,r){let i=1,a=e[0];for(;void 0!==a&&void 0===a[r];)a=e[i++];if(void 0===a)return;let o=a[r];if(void 0!==o)if(Array.isArray(o))do{o=a[r],void 0!==o&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{o=a[r],void 0!==o&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{o=a[r],void 0!==o&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)},subclip:function(e,t,n,r,i){i=i||30;const a=e.clone();a.name=t;const o=[];for(let e=0;e<a.tracks.length;++e){const t=a.tracks[e],s=t.getValueSize(),u=[],l=[];for(let e=0;e<t.times.length;++e){const a=t.times[e]*i;if(!(a<n||a>=r)){u.push(t.times[e]);for(let n=0;n<s;++n)l.push(t.values[e*s+n])}}0!==u.length&&(t.times=pc.convertArray(u,t.times.constructor),t.values=pc.convertArray(l,t.values.constructor),o.push(t))}a.tracks=o;let s=1/0;for(let e=0;e<a.tracks.length;++e)s>a.tracks[e].times[0]&&(s=a.tracks[e].times[0]);for(let e=0;e<a.tracks.length;++e)a.tracks[e].shift(-1*s);return a.resetDuration(),a},makeClipAdditive:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=e),(void 0===r||r<=0)&&(r=30);const i=e.tracks.length,a=t/r;for(let t=0;t<i;++t){const r=n.tracks[t],i=r.ValueTypeName;if("bool"===i||"string"===i)continue;const o=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===i}));if(void 0===o)continue;const s=r.getValueSize(),u=r.times.length-1;let l;if(a<=r.times[0])l=pc.arraySlice(r.values,0,r.valueSize);else if(a>=r.times[u]){const e=u*s;l=pc.arraySlice(r.values,e)}else{const e=r.createInterpolant();e.evaluate(a),l=e.resultBuffer}if("quaternion"===i){new Yn(l[0],l[1],l[2],l[3]).normalize().conjugate().toArray(l)}const c=o.times.length;for(let e=0;e<c;++e){const t=e*s;if("quaternion"===i)Yn.multiplyQuaternionsFlat(o.values,t,l,0,o.values,t);else for(let e=0;e<s;++e)o.values[t+e]-=l[e]}}return e.blendMode=qt,e}};function mc(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function gc(e,t,n,r){mc.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function vc(e,t,n,r){mc.call(this,e,t,n,r)}function yc(e,t,n,r){mc.call(this,e,t,n,r)}function _c(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=pc.convertArray(t,this.TimeBufferType),this.values=pc.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function bc(e,t,n){_c.call(this,e,t,n)}function Ec(e,t,n,r){_c.call(this,e,t,n,r)}function Tc(e,t,n,r){_c.call(this,e,t,n,r)}function Sc(e,t,n,r){mc.call(this,e,t,n,r)}function wc(e,t,n,r){_c.call(this,e,t,n,r)}function Ac(e,t,n,r){_c.call(this,e,t,n,r)}function xc(e,t,n,r){_c.call(this,e,t,n,r)}function Mc(e,t,n,r){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.blendMode=void 0!==r?r:Wt,this.uuid=Fn.generateUUID(),this.duration<0&&this.resetDuration()}function Cc(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Tc;case"vector":case"vector2":case"vector3":case"vector4":return xc;case"color":return Ec;case"quaternion":return wc;case"bool":case"boolean":return bc;case"string":return Ac}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];pc.flattenJSON(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(mc.prototype,{evaluate:function(e){let t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===a)break;if(i=r,r=t[++n],e<r)break t}a=t.length;break n}if(e>=i)break e;{const o=t[1];e<o&&(n=2,i=o);for(let a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===a)break;if(r=i,i=t[--n-1],e>=i)break t}a=n,n=0}}for(;n<a;){const r=n+a>>>1;e<t[r]?a=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let e=0;e!==r;++e)t[e]=n[i+e];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(mc.prototype,{beforeStart_:mc.prototype.copySampleValue_,afterEnd_:mc.prototype.copySampleValue_}),gc.prototype=Object.assign(Object.create(mc.prototype),{constructor:gc,DefaultSettings_:{endingStart:Ht,endingEnd:Ht},intervalChanged_:function(e,t,n){let r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case Vt:i=e,o=2*t-n;break;case zt:i=r.length-2,o=t+r[i]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Vt:a=e,s=2*n-t;break;case zt:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}const u=.5*(n-t),l=this.valueSize;this._weightPrev=u/(t-o),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=a*l},interpolate_:function(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=this._offsetPrev,c=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,g=-d*m+2*d*p-d*f,v=(1+d)*m+(-1.5-2*d)*p+(-.5+d)*f+1,y=(-1-h)*m+(1.5+h)*p+.5*f,_=h*m-h*p;for(let e=0;e!==o;++e)i[e]=g*a[l+e]+v*a[u+e]+y*a[s+e]+_*a[c+e];return i}}),vc.prototype=Object.assign(Object.create(mc.prototype),{constructor:vc,interpolate_:function(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=(n-t)/(r-t),c=1-l;for(let e=0;e!==o;++e)i[e]=a[u+e]*c+a[s+e]*l;return i}}),yc.prototype=Object.assign(Object.create(mc.prototype),{constructor:yc,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(_c,{toJSON:function(e){const t=e.constructor;let n;if(void 0!==t.toJSON)n=t.toJSON(e);else{n={name:e.name,times:pc.convertArray(e.times,Array),values:pc.convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}}),Object.assign(_c.prototype,{constructor:_c,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:jt,InterpolantFactoryMethodDiscrete:function(e){return new yc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new vc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new gc(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){let t;switch(e){case Ut:t=this.InterpolantFactoryMethodDiscrete;break;case jt:t=this.InterpolantFactoryMethodLinear;break;case Gt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ut;case this.InterpolantFactoryMethodLinear:return jt;case this.InterpolantFactoryMethodSmooth:return Gt}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this},scale:function(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this},trim:function(e,t){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const e=this.getValueSize();this.times=pc.arraySlice(n,i,a),this.values=pc.arraySlice(this.values,i*e,a*e)}return this},validate:function(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let t=0;t!==i;t++){const r=n[t];if("number"==typeof r&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,r),e=!1;break}if(null!==a&&a>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,r,a),e=!1;break}a=r}if(void 0!==r&&pc.isTypedArray(r))for(let t=0,n=r.length;t!==n;++t){const n=r[t];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,n),e=!1;break}}return e},optimize:function(){const e=pc.arraySlice(this.times),t=pc.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===Gt,i=e.length-1;let a=1;for(let o=1;o<i;++o){let i=!1;const s=e[o];if(s!==e[o+1]&&(1!==o||s!==s[0]))if(r)i=!0;else{const e=o*n,r=e-n,a=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[r+o]||n!==t[a+o]){i=!0;break}}}if(i){if(o!==a){e[a]=e[o];const r=o*n,i=a*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++a}}if(i>0){e[a]=e[i];for(let e=i*n,r=a*n,o=0;o!==n;++o)t[r+o]=t[e+o];++a}return a!==e.length?(this.times=pc.arraySlice(e,0,a),this.values=pc.arraySlice(t,0,a*n)):(this.times=e,this.values=t),this},clone:function(){const e=pc.arraySlice(this.times,0),t=pc.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),bc.prototype=Object.assign(Object.create(_c.prototype),{constructor:bc,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Ut,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ec.prototype=Object.assign(Object.create(_c.prototype),{constructor:Ec,ValueTypeName:"color"}),Tc.prototype=Object.assign(Object.create(_c.prototype),{constructor:Tc,ValueTypeName:"number"}),Sc.prototype=Object.assign(Object.create(mc.prototype),{constructor:Sc,interpolate_:function(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t);let u=e*o;for(let e=u+o;u!==e;u+=4)Yn.slerpFlat(i,0,a,u-o,a,u,s);return i}}),wc.prototype=Object.assign(Object.create(_c.prototype),{constructor:wc,ValueTypeName:"quaternion",DefaultInterpolation:jt,InterpolantFactoryMethodLinear:function(e){return new Sc(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Ac.prototype=Object.assign(Object.create(_c.prototype),{constructor:Ac,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Ut,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),xc.prototype=Object.assign(Object.create(_c.prototype),{constructor:xc,ValueTypeName:"vector"}),Object.assign(Mc,{parse:function(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let e=0,i=n.length;e!==i;++e)t.push(Cc(n[e]).scale(r));return new Mc(e.name,e.duration,t,e.blendMode)},toJSON:function(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,r=n.length;e!==r;++e)t.push(_c.toJSON(n[e]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){const i=t.length,a=[];for(let e=0;e<i;e++){let o=[],s=[];o.push((e+i-1)%i,e,(e+1)%i),s.push(0,1,0);const u=pc.getKeyframeOrder(o);o=pc.sortedArray(o,1,u),s=pc.sortedArray(s,1,u),r||0!==o[0]||(o.push(i),s.push(s[0])),a.push(new Tc(".morphTargetInfluences["+t[e].name+"]",o,s).scale(1/n))}return new Mc(e,-1,a)},findByName:function(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<n.length;e++)if(n[e].name===t)return n[e];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let t=0,n=e.length;t<n;t++){const n=e[t],a=n.name.match(i);if(a&&a.length>1){const e=a[1];let t=r[e];t||(r[e]=t=[]),t.push(n)}}const a=[];for(const e in r)a.push(Mc.CreateFromMorphTargetSequence(e,r[e],t,n));return a},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,r,i){if(0!==n.length){const a=[],o=[];pc.flattenJSON(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.fps||30,o=e.blendMode;let s=e.length||-1;const u=e.hierarchy||[];for(let e=0;e<u.length;e++){const i=u[e].keys;if(i&&0!==i.length)if(i[0].morphTargets){const e={};let t;for(t=0;t<i.length;t++)if(i[t].morphTargets)for(let n=0;n<i[t].morphTargets.length;n++)e[i[t].morphTargets[n]]=-1;for(const n in e){const e=[],a=[];for(let r=0;r!==i[t].morphTargets.length;++r){const r=i[t];e.push(r.time),a.push(r.morphTarget===n?1:0)}r.push(new Tc(".morphTargetInfluence["+n+"]",e,a))}s=e.length*(a||1)}else{const a=".bones["+t[e].name+"]";n(xc,a+".position",i,"pos",r),n(wc,a+".quaternion",i,"rot",r),n(xc,a+".scale",i,"scl",r)}}if(0===r.length)return null;return new Mc(i,s,r,o)}}),Object.assign(Mc.prototype,{resetDuration:function(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this},trim:function(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Mc(this.name,this.duration,e,this.blendMode)}});const Rc={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Ic(e,t,n){const r=this;let i=!1,a=0,o=0,s=void 0;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===i&&void 0!==r.onStart&&r.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return u.push(e,t),this},this.removeHandler=function(e){const t=u.indexOf(e);return-1!==t&&u.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=u.length;t<n;t+=2){const n=u[t],r=u[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null}}const Oc=new Ic;function Dc(e){this.manager=void 0!==e?e:Oc,this.crossOrigin="anonymous",this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Dc.prototype,{load:function(){},loadAsync:function(e,t){const n=this;return new Promise((function(r,i){n.load(e,r,t,i)}))},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});const Pc={};function Lc(e){Dc.call(this,e)}function Nc(e){Dc.call(this,e)}function kc(e){Dc.call(this,e)}function Fc(e){Dc.call(this,e)}function Bc(e){Dc.call(this,e)}function Uc(e){Dc.call(this,e)}function jc(e){Dc.call(this,e)}function Gc(){this.type="Curve",this.arcLengthDivisions=200}function Hc(e,t,n,r,i,a,o,s){Gc.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function Vc(e,t,n,r,i,a){Hc.call(this,e,t,n,n,r,i,a),this.type="ArcCurve"}function zc(){let e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){let u=(t-e)/a-(n-e)/(a+o)+(n-t)/o,l=(n-t)/o-(r-t)/(o+s)+(r-n)/s;u*=o,l*=o,i(t,n,u,l)},calc:function(i){const a=i*i;return e+t*i+n*a+r*(a*i)}}}Lc.prototype=Object.assign(Object.create(Dc.prototype),{constructor:Lc,load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=Rc.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0!==Pc[e])return void Pc[e].push({onLoad:t,onProgress:n,onError:r});const o=e.match(/^data:(.*?)(;base64)?,(.*)$/);let s;if(o){const n=o[1],a=!!o[2];let s=o[3];s=decodeURIComponent(s),a&&(s=atob(s));try{let r;const a=(this.responseType||"").toLowerCase();switch(a){case"arraybuffer":case"blob":const e=new Uint8Array(s.length);for(let t=0;t<s.length;t++)e[t]=s.charCodeAt(t);r="blob"===a?new Blob([e.buffer],{type:n}):e.buffer;break;case"document":const t=new DOMParser;r=t.parseFromString(s,n);break;case"json":r=JSON.parse(s);break;default:r=s}setTimeout((function(){t&&t(r),i.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{Pc[e]=[],Pc[e].push({onLoad:t,onProgress:n,onError:r}),s=new XMLHttpRequest,s.open("GET",e,!0),s.addEventListener("load",(function(t){const n=this.response,r=Pc[e];if(delete Pc[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Rc.add(e,n);for(let e=0,t=r.length;e<t;e++){const t=r[e];t.onLoad&&t.onLoad(n)}i.manager.itemEnd(e)}else{for(let e=0,n=r.length;e<n;e++){const n=r[e];n.onError&&n.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),s.addEventListener("progress",(function(t){const n=Pc[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onProgress&&r.onProgress(t)}}),!1),s.addEventListener("error",(function(t){const n=Pc[e];delete Pc[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),s.addEventListener("abort",(function(t){const n=Pc[e];delete Pc[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(s.responseType=this.responseType),void 0!==this.withCredentials&&(s.withCredentials=this.withCredentials),s.overrideMimeType&&s.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const e in this.requestHeader)s.setRequestHeader(e,this.requestHeader[e]);s.send(null)}return i.manager.itemStart(e),s},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this}}),Nc.prototype=Object.assign(Object.create(Dc.prototype),{constructor:Nc,load:function(e,t,n,r){const i=this,a=new Lc(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},parse:function(e){const t=[];for(let n=0;n<e.length;n++){const r=Mc.parse(e[n]);t.push(r)}return t}}),kc.prototype=Object.assign(Object.create(Dc.prototype),{constructor:kc,load:function(e,t,n,r){const i=this,a=[],o=new Bu;o.image=a;const s=new Lc(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader);let u=0;function l(l){s.load(e[l],(function(e){const n=i.parse(e,!0);a[l]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},u+=1,6===u&&(1===n.mipmapCount&&(o.minFilter=_e),o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(Array.isArray(e))for(let t=0,n=e.length;t<n;++t)l(t);else s.load(e,(function(e){const n=i.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){a[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)a[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),a[t].format=n.format,a[t].width=n.width,a[t].height=n.height}}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=_e),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}}),Fc.prototype=Object.assign(Object.create(Dc.prototype),{constructor:Fc,load:function(e,t,n,r){const i=this,a=new Aa,o=new Lc(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.load(e,(function(e){const n=i.parse(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:he,a.wrapT=void 0!==n.wrapT?n.wrapT:he,a.magFilter=void 0!==n.magFilter?n.magFilter:_e,a.minFilter=void 0!==n.minFilter?n.minFilter:_e,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=Te),1===n.mipmapCount&&(a.minFilter=_e),a.needsUpdate=!0,t&&t(a,n))}),n,r),a}}),Bc.prototype=Object.assign(Object.create(Dc.prototype),{constructor:Bc,load:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=Rc.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;const o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1),Rc.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",u,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}),Uc.prototype=Object.assign(Object.create(Dc.prototype),{constructor:Uc,load:function(e,t,n,r){const i=new Xa,a=new Bc(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function s(n){a.load(e[n],(function(e){i.images[n]=e,o++,6===o&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(let t=0;t<e.length;++t)s(t);return i}}),jc.prototype=Object.assign(Object.create(Dc.prototype),{constructor:jc,load:function(e,t,n,r){const i=new Vn,a=new Bc(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(n){i.image=n;const r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?Fe:Be,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}),Object.assign(Gc.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){const e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){const n=this.getLengths();let r,i=0,a=n.length;r=t||e*n[a-1];let o,s=0,u=a-1;for(;s<=u;)if(i=Math.floor(s+(u-s)/2),o=n[i]-r,o<0)s=i+1;else{if(!(o>0)){u=i;break}u=i-1}if(i=u,n[i]===r)return i/(a-1);const l=n[i];return(i+(r-l)/(n[i+1]-l))/(a-1)},getTangent:function(e,t){const n=1e-4;let r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);const a=this.getPoint(r),o=this.getPoint(i),s=t||(a.isVector2?new Bn:new Qn);return s.copy(o).sub(a).normalize(),s},getTangentAt:function(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)},computeFrenetFrames:function(e,t){const n=new Qn,r=[],i=[],a=[],o=new Qn,s=new ir;for(let t=0;t<=e;t++){const n=t/e;r[t]=this.getTangentAt(n,new Qn),r[t].normalize()}i[0]=new Qn,a[0]=new Qn;let u=Number.MAX_VALUE;const l=Math.abs(r[0].x),c=Math.abs(r[0].y),d=Math.abs(r[0].z);l<=u&&(u=l,n.set(1,0,0)),c<=u&&(u=c,n.set(0,1,0)),d<=u&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],o),a[0].crossVectors(r[0],i[0]);for(let t=1;t<=e;t++){if(i[t]=i[t-1].clone(),a[t]=a[t-1].clone(),o.crossVectors(r[t-1],r[t]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(Fn.clamp(r[t-1].dot(r[t]),-1,1));i[t].applyMatrix4(s.makeRotationAxis(o,e))}a[t].crossVectors(r[t],i[t])}if(!0===t){let t=Math.acos(Fn.clamp(i[0].dot(i[e]),-1,1));t/=e,r[0].dot(o.crossVectors(i[0],i[e]))>0&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(s.makeRotationAxis(r[n],t*n)),a[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),Hc.prototype=Object.create(Gc.prototype),Hc.prototype.constructor=Hc,Hc.prototype.isEllipseCurve=!0,Hc.prototype.getPoint=function(e,t){const n=t||new Bn,r=2*Math.PI;let i=this.aEndAngle-this.aStartAngle;const a=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);const o=this.aStartAngle+e*i;let s=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=s-this.aX,r=u-this.aY;s=n*e-r*t+this.aX,u=n*t+r*e+this.aY}return n.set(s,u)},Hc.prototype.copy=function(e){return Gc.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Hc.prototype.toJSON=function(){const e=Gc.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Hc.prototype.fromJSON=function(e){return Gc.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Vc.prototype=Object.create(Hc.prototype),Vc.prototype.constructor=Vc,Vc.prototype.isArcCurve=!0;const Wc=new Qn,qc=new zc,Yc=new zc,Kc=new zc;function Xc(e,t,n,r){Gc.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=void 0!==r?r:.5}function Qc(e,t,n,r,i){const a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function Zc(e,t,n,r){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function Jc(e,t,n,r,i){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function $c(e,t,n,r){Gc.call(this),this.type="CubicBezierCurve",this.v0=e||new Bn,this.v1=t||new Bn,this.v2=n||new Bn,this.v3=r||new Bn}function ed(e,t,n,r){Gc.call(this),this.type="CubicBezierCurve3",this.v0=e||new Qn,this.v1=t||new Qn,this.v2=n||new Qn,this.v3=r||new Qn}function td(e,t){Gc.call(this),this.type="LineCurve",this.v1=e||new Bn,this.v2=t||new Bn}function nd(e,t){Gc.call(this),this.type="LineCurve3",this.v1=e||new Qn,this.v2=t||new Qn}function rd(e,t,n){Gc.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Bn,this.v1=t||new Bn,this.v2=n||new Bn}function id(e,t,n){Gc.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Qn,this.v1=t||new Qn,this.v2=n||new Qn}function ad(e){Gc.call(this),this.type="SplineCurve",this.points=e||[]}Xc.prototype=Object.create(Gc.prototype),Xc.prototype.constructor=Xc,Xc.prototype.isCatmullRomCurve3=!0,Xc.prototype.getPoint=function(e,t){const n=t||new Qn,r=this.points,i=r.length,a=(i-(this.closed?0:1))*e;let o,s,u,l,c=Math.floor(a),d=a-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/i)+1)*i:0===d&&c===i-1&&(c=i-2,d=1),this.closed||c>0?o=r[(c-1)%i]:(Wc.subVectors(r[0],r[1]).add(r[0]),o=Wc),s=r[c%i],u=r[(c+1)%i],this.closed||c+2<i?l=r[(c+2)%i]:(Wc.subVectors(r[i-1],r[i-2]).add(r[i-1]),l=Wc),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(o.distanceToSquared(s),e),n=Math.pow(s.distanceToSquared(u),e),r=Math.pow(u.distanceToSquared(l),e);n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),qc.initNonuniformCatmullRom(o.x,s.x,u.x,l.x,t,n,r),Yc.initNonuniformCatmullRom(o.y,s.y,u.y,l.y,t,n,r),Kc.initNonuniformCatmullRom(o.z,s.z,u.z,l.z,t,n,r)}else"catmullrom"===this.curveType&&(qc.initCatmullRom(o.x,s.x,u.x,l.x,this.tension),Yc.initCatmullRom(o.y,s.y,u.y,l.y,this.tension),Kc.initCatmullRom(o.z,s.z,u.z,l.z,this.tension));return n.set(qc.calc(d),Yc.calc(d),Kc.calc(d)),n},Xc.prototype.copy=function(e){Gc.prototype.copy.call(this,e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Xc.prototype.toJSON=function(){const e=Gc.prototype.toJSON.call(this);e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Xc.prototype.fromJSON=function(e){Gc.prototype.fromJSON.call(this,e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Qn).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},$c.prototype=Object.create(Gc.prototype),$c.prototype.constructor=$c,$c.prototype.isCubicBezierCurve=!0,$c.prototype.getPoint=function(e,t){const n=t||new Bn,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(Jc(e,r.x,i.x,a.x,o.x),Jc(e,r.y,i.y,a.y,o.y)),n},$c.prototype.copy=function(e){return Gc.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},$c.prototype.toJSON=function(){const e=Gc.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},$c.prototype.fromJSON=function(e){return Gc.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},ed.prototype=Object.create(Gc.prototype),ed.prototype.constructor=ed,ed.prototype.isCubicBezierCurve3=!0,ed.prototype.getPoint=function(e,t){const n=t||new Qn,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(Jc(e,r.x,i.x,a.x,o.x),Jc(e,r.y,i.y,a.y,o.y),Jc(e,r.z,i.z,a.z,o.z)),n},ed.prototype.copy=function(e){return Gc.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},ed.prototype.toJSON=function(){const e=Gc.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},ed.prototype.fromJSON=function(e){return Gc.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},td.prototype=Object.create(Gc.prototype),td.prototype.constructor=td,td.prototype.isLineCurve=!0,td.prototype.getPoint=function(e,t){const n=t||new Bn;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},td.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},td.prototype.getTangent=function(e,t){const n=t||new Bn;return n.copy(this.v2).sub(this.v1).normalize(),n},td.prototype.copy=function(e){return Gc.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},td.prototype.toJSON=function(){const e=Gc.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},td.prototype.fromJSON=function(e){return Gc.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},nd.prototype=Object.create(Gc.prototype),nd.prototype.constructor=nd,nd.prototype.isLineCurve3=!0,nd.prototype.getPoint=function(e,t){const n=t||new Qn;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},nd.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},nd.prototype.copy=function(e){return Gc.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},nd.prototype.toJSON=function(){const e=Gc.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},nd.prototype.fromJSON=function(e){return Gc.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},rd.prototype=Object.create(Gc.prototype),rd.prototype.constructor=rd,rd.prototype.isQuadraticBezierCurve=!0,rd.prototype.getPoint=function(e,t){const n=t||new Bn,r=this.v0,i=this.v1,a=this.v2;return n.set(Zc(e,r.x,i.x,a.x),Zc(e,r.y,i.y,a.y)),n},rd.prototype.copy=function(e){return Gc.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},rd.prototype.toJSON=function(){const e=Gc.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},rd.prototype.fromJSON=function(e){return Gc.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},id.prototype=Object.create(Gc.prototype),id.prototype.constructor=id,id.prototype.isQuadraticBezierCurve3=!0,id.prototype.getPoint=function(e,t){const n=t||new Qn,r=this.v0,i=this.v1,a=this.v2;return n.set(Zc(e,r.x,i.x,a.x),Zc(e,r.y,i.y,a.y),Zc(e,r.z,i.z,a.z)),n},id.prototype.copy=function(e){return Gc.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},id.prototype.toJSON=function(){const e=Gc.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},id.prototype.fromJSON=function(e){return Gc.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},ad.prototype=Object.create(Gc.prototype),ad.prototype.constructor=ad,ad.prototype.isSplineCurve=!0,ad.prototype.getPoint=function(e,t){const n=t||new Bn,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],u=r[a],l=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return n.set(Qc(o,s.x,u.x,l.x,c.x),Qc(o,s.y,u.y,l.y,c.y)),n},ad.prototype.copy=function(e){Gc.prototype.copy.call(this,e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this},ad.prototype.toJSON=function(){const e=Gc.prototype.toJSON.call(this);e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e},ad.prototype.fromJSON=function(e){Gc.prototype.fromJSON.call(this,e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Bn).fromArray(n))}return this};var od=Object.freeze({__proto__:null,ArcCurve:Vc,CatmullRomCurve3:Xc,CubicBezierCurve:$c,CubicBezierCurve3:ed,EllipseCurve:Hc,LineCurve:td,LineCurve3:nd,QuadraticBezierCurve:rd,QuadraticBezierCurve3:id,SplineCurve:ad});function sd(){Gc.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function ud(e){sd.call(this),this.type="Path",this.currentPoint=new Bn,e&&this.setFromPoints(e)}function ld(e){ud.call(this,e),this.uuid=Fn.generateUUID(),this.type="Shape",this.holes=[]}function cd(e,t){Tr.call(this),this.type="Light",this.color=new fi(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function dd(e,t,n){cd.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Tr.DefaultUp),this.updateMatrix(),this.groundColor=new fi(t)}function hd(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Bn(512,512),this.map=null,this.mapPass=null,this.matrix=new ir,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ca,this._frameExtents=new Bn(1,1),this._viewportCount=1,this._viewports=[new zn(0,0,1,1)]}function fd(){hd.call(this,new Ea(50,1,.5,500))}function pd(e,t,n,r,i,a){cd.call(this,e,t),this.type="SpotLight",this.position.copy(Tr.DefaultUp),this.updateMatrix(),this.target=new Tr,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new fd}function md(){hd.call(this,new Ea(90,1,.5,500)),this._frameExtents=new Bn(4,2),this._viewportCount=6,this._viewports=[new zn(2,1,1,1),new zn(0,1,1,1),new zn(3,1,1,1),new zn(1,1,1,1),new zn(3,0,1,1),new zn(1,0,1,1)],this._cubeDirections=[new Qn(1,0,0),new Qn(-1,0,0),new Qn(0,0,1),new Qn(0,0,-1),new Qn(0,1,0),new Qn(0,-1,0)],this._cubeUps=[new Qn(0,1,0),new Qn(0,1,0),new Qn(0,1,0),new Qn(0,1,0),new Qn(0,0,1),new Qn(0,0,-1)]}function gd(e,t,n,r){cd.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new md}function vd(e,t,n,r,i,a){ba.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function yd(){hd.call(this,new vd(-5,5,5,-5,.5,500))}function _d(e,t){cd.call(this,e,t),this.type="DirectionalLight",this.position.copy(Tr.DefaultUp),this.updateMatrix(),this.target=new Tr,this.shadow=new yd}function bd(e,t){cd.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Ed(e,t,n,r){cd.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function Td(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Qn)}function Sd(e,t){cd.call(this,void 0,t),this.type="LightProbe",this.sh=void 0!==e?e:new Td}function wd(e){Dc.call(this,e),this.textures={}}sd.prototype=Object.assign(Object.create(Gc.prototype),{constructor:sd,add:function(e){this.curves.push(e)},closePath:function(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new td(t,e))},getPoint:function(e){const t=e*this.getLength(),n=this.getCurveLengths();let r=0;for(;r<n.length;){if(n[r]>=t){const e=n[r]-t,i=this.curves[r],a=i.getLength(),o=0===a?0:1-e/a;return i.getPointAt(o)}r++}return null},getLength:function(){const e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;const t=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const a=i[r],o=a&&a.isEllipseCurve?2*e:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o);for(let e=0;e<s.length;e++){const r=s[e];n&&n.equals(r)||(t.push(r),n=r)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t},copy:function(e){Gc.prototype.copy.call(this,e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){const e=Gc.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e},fromJSON:function(e){Gc.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new od[n.type]).fromJSON(n))}return this}}),ud.prototype=Object.assign(Object.create(sd.prototype),{constructor:ud,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){const n=new td(this.currentPoint.clone(),new Bn(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,n,r){const i=new rd(this.currentPoint.clone(),new Bn(e,t),new Bn(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(e,t,n,r,i,a){const o=new $c(this.currentPoint.clone(),new Bn(e,t),new Bn(n,r),new Bn(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this},splineThru:function(e){const t=new ad([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,n,r,i,a){const o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this},absarc:function(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this},ellipse:function(e,t,n,r,i,a,o,s){const u=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(e+u,t+l,n,r,i,a,o,s),this},absellipse:function(e,t,n,r,i,a,o,s){const u=new Hc(e,t,n,r,i,a,o,s);if(this.curves.length>0){const e=u.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(u);const l=u.getPoint(1);return this.currentPoint.copy(l),this},copy:function(e){return sd.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){const e=sd.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return sd.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),ld.prototype=Object.assign(Object.create(ud.prototype),{constructor:ld,getPointsHoles:function(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){ud.prototype.copy.call(this,e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this},toJSON:function(){const e=ud.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e},fromJSON:function(e){ud.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new ud).fromJSON(n))}return this}}),cd.prototype=Object.assign(Object.create(Tr.prototype),{constructor:cd,isLight:!0,copy:function(e){return Tr.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){const t=Tr.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),dd.prototype=Object.assign(Object.create(cd.prototype),{constructor:dd,isHemisphereLight:!0,copy:function(e){return cd.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(hd.prototype,{_projScreenMatrix:new ir,_lightPositionWorld:new Qn,_lookTarget:new Qn,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){const t=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(e.matrixWorld),t.position.copy(a),i.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(i),t.updateMatrixWorld(),r.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),fd.prototype=Object.assign(Object.create(hd.prototype),{constructor:fd,isSpotLightShadow:!0,updateMatrices:function(e){const t=this.camera,n=2*Fn.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),hd.prototype.updateMatrices.call(this,e)}}),pd.prototype=Object.assign(Object.create(cd.prototype),{constructor:pd,isSpotLight:!0,copy:function(e){return cd.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),md.prototype=Object.assign(Object.create(hd.prototype),{constructor:md,isPointLightShadow:!0,updateMatrices:function(e,t){void 0===t&&(t=0);const n=this.camera,r=this.matrix,i=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;i.setFromMatrixPosition(e.matrixWorld),n.position.copy(i),a.copy(n.position),a.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(a),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),o.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),gd.prototype=Object.assign(Object.create(cd.prototype),{constructor:gd,isPointLight:!0,copy:function(e){return cd.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),vd.prototype=Object.assign(Object.create(ba.prototype),{constructor:vd,isOrthographicCamera:!0,copy:function(e,t){return ba.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,o-=t*this.view.offsetY,s=o-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){const t=Tr.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),yd.prototype=Object.assign(Object.create(hd.prototype),{constructor:yd,isDirectionalLightShadow:!0,updateMatrices:function(e){hd.prototype.updateMatrices.call(this,e)}}),_d.prototype=Object.assign(Object.create(cd.prototype),{constructor:_d,isDirectionalLight:!0,copy:function(e){return cd.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),bd.prototype=Object.assign(Object.create(cd.prototype),{constructor:bd,isAmbientLight:!0}),Ed.prototype=Object.assign(Object.create(cd.prototype),{constructor:Ed,isRectAreaLight:!0,copy:function(e){return cd.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){const t=cd.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Object.assign(Td.prototype,{isSphericalHarmonics3:!0,set:function(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t},getIrradianceAt:function(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t},add:function(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},addScaledSH:function(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this},scale:function(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},equals:function(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e,t){void 0===t&&(t=0);const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}),Object.assign(Td,{getBasisAt:function(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}),Sd.prototype=Object.assign(Object.create(cd.prototype),{constructor:Sd,isLightProbe:!0,copy:function(e){return cd.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){const t=cd.prototype.toJSON.call(this,e);return t.object.sh=this.sh.toArray(),t}}),wd.prototype=Object.assign(Object.create(Dc.prototype),{constructor:wd,load:function(e,t,n,r){const i=this,a=new Lc(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},parse:function(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const r=new fc[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=(new fi).setHex(e.sheen)),void 0!==e.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(r.morphNormals=e.morphNormals),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.vertexTangents&&(r.vertexTangents=e.vertexTangents),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const t in e.uniforms){const i=e.uniforms[t];switch(r.uniforms[t]={},i.type){case"t":r.uniforms[t].value=n(i.value);break;case"c":r.uniforms[t].value=(new fi).setHex(i.value);break;case"v2":r.uniforms[t].value=(new Bn).fromArray(i.value);break;case"v3":r.uniforms[t].value=(new Qn).fromArray(i.value);break;case"v4":r.uniforms[t].value=(new zn).fromArray(i.value);break;case"m3":r.uniforms[t].value=(new Un).fromArray(i.value);case"m4":r.uniforms[t].value=(new ir).fromArray(i.value);break;default:r.uniforms[t].value=i.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const t in e.extensions)r.extensions[t]=e.extensions[t];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),r.normalScale=(new Bn).fromArray(t)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Bn).fromArray(e.clearcoatNormalScale)),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),r},setTextures:function(e){return this.textures=e,this}});const Ad={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}},extractUrlBase:function(e){const t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function xd(){Hi.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Md(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Si.call(this,e,t,n),this.meshPerAttribute=r||1}function Cd(e){Dc.call(this,e)}xd.prototype=Object.assign(Object.create(Hi.prototype),{constructor:xd,isInstancedBufferGeometry:!0,copy:function(e){return Hi.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const e=Hi.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),Md.prototype=Object.assign(Object.create(Si.prototype),{constructor:Md,isInstancedBufferAttribute:!0,copy:function(e){return Si.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){const e=Si.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Cd.prototype=Object.assign(Object.create(Dc.prototype),{constructor:Cd,load:function(e,t,n,r){const i=this,a=new Lc(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.load(e,(function(n){try{t(i.parse(JSON.parse(n)))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)},parse:function(e){const t={},n={};function r(e,r){if(void 0!==t[r])return t[r];const i=e.interleavedBuffers[r],a=function(e,t){if(void 0!==n[t])return n[t];const r=e.arrayBuffers[t],i=new Uint32Array(r).buffer;return n[t]=i,i}(e,i.buffer),o=new Gs(new Rd[i.type](a),i.stride);return o.uuid=i.uuid,t[r]=o,o}const i=e.isInstancedBufferGeometry?new xd:new Hi,a=e.data.index;if(void 0!==a){const e=new Rd[a.type](a.array);i.setIndex(new Si(e,1))}const o=e.data.attributes;for(const t in o){const n=o[t];let a;if(n.isInterleavedBufferAttribute){a=new Vs(r(e.data,n.data),n.itemSize,n.offset,n.normalized)}else{const e=new Rd[n.type](n.array);a=new(n.isInstancedBufferAttribute?Md:Si)(e,n.itemSize,n.normalized)}void 0!==n.name&&(a.name=n.name),i.setAttribute(t,a)}const s=e.data.morphAttributes;if(s)for(const t in s){const n=s[t],a=[];for(let t=0,i=n.length;t<i;t++){const i=n[t];let o;if(i.isInterleavedBufferAttribute){o=new Vs(r(e.data,i.data),i.itemSize,i.offset,i.normalized)}else{o=new Si(new Rd[i.type](i.array),i.itemSize,i.normalized)}void 0!==i.name&&(o.name=i.name),a.push(o)}i.morphAttributes[t]=a}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const u=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==u)for(let e=0,t=u.length;e!==t;++e){const t=u[e];i.addGroup(t.start,t.count,t.materialIndex)}const l=e.data.boundingSphere;if(void 0!==l){const e=new Qn;void 0!==l.center&&e.fromArray(l.center),i.boundingSphere=new jr(e,l.radius)}return e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}});const Rd={Int8Array,Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Id(e){Dc.call(this,e)}Id.prototype=Object.assign(Object.create(Dc.prototype),{constructor:Id,load:function(e,t,n,r){const i=this,a=""===this.path?Ad.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new Lc(i.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.load(e,(function(n){let a=null;try{a=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}const o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)},parse:function(e,t){const n=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,n),i=this.parseImages(e.images,(function(){void 0!==t&&t(s)})),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,r,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const r=(new ld).fromJSON(e[n]);t[r.uuid]=r}return t},parseGeometries:function(e,t){const n={};let r;if(void 0!==e){const i=new Cd;for(let a=0,o=e.length;a<o;a++){let o;const s=e[a];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new nc[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new nc[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new nc[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new nc[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new nc[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new nc[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new nc[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new nc[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new nc[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new nc[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new nc[s.type]((new od[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new nc[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new nc[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":r=[];for(let e=0,n=s.shapes.length;e<n;e++){const n=t[s.shapes[e]];r.push(n)}o=new nc[s.type](r,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":r=[];for(let e=0,n=s.shapes.length;e<n;e++){const n=t[s.shapes[e]];r.push(n)}const e=s.options.extrudePath;void 0!==e&&(s.options.extrudePath=(new od[e.type]).fromJSON(e)),o=new nc[s.type](r,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}}return n},parseMaterials:function(e,t){const n={},r={};if(void 0!==e){const i=new wd;i.setTextures(t);for(let t=0,a=e.length;t<a;t++){const a=e[t];if("MultiMaterial"===a.type){const e=[];for(let t=0;t<a.materials.length;t++){const r=a.materials[t];void 0===n[r.uuid]&&(n[r.uuid]=i.parse(r)),e.push(n[r.uuid])}r[a.uuid]=e}else void 0===n[a.uuid]&&(n[a.uuid]=i.parse(a)),r[a.uuid]=n[a.uuid]}}return r},parseAnimations:function(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n],i=Mc.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),t.push(i)}return t},parseImages:function(e,t){const n=this,r={};let i;function a(e){return n.manager.itemStart(e),i.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}if(void 0!==e&&e.length>0){const o=new Ic(t);i=new Bc(o),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const i=e[t],o=i.url;if(Array.isArray(o)){r[i.uuid]=[];for(let e=0,t=o.length;e<t;e++){const t=o[e],s=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t;r[i.uuid].push(a(s))}}else{const e=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(i.url)?i.url:n.resourcePath+i.url;r[i.uuid]=a(e)}}}return r},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const r={};if(void 0!==e)for(let i=0,a=e.length;i<a;i++){const a=e[i];let o;void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image),o=Array.isArray(t[a.image])?new Xa(t[a.image]):new Vn(t[a.image]),o.needsUpdate=!0,o.uuid=a.uuid,void 0!==a.name&&(o.name=a.name),void 0!==a.mapping&&(o.mapping=n(a.mapping,Od)),void 0!==a.offset&&o.offset.fromArray(a.offset),void 0!==a.repeat&&o.repeat.fromArray(a.repeat),void 0!==a.center&&o.center.fromArray(a.center),void 0!==a.rotation&&(o.rotation=a.rotation),void 0!==a.wrap&&(o.wrapS=n(a.wrap[0],Dd),o.wrapT=n(a.wrap[1],Dd)),void 0!==a.format&&(o.format=a.format),void 0!==a.type&&(o.type=a.type),void 0!==a.encoding&&(o.encoding=a.encoding),void 0!==a.minFilter&&(o.minFilter=n(a.minFilter,Pd)),void 0!==a.magFilter&&(o.magFilter=n(a.magFilter,Pd)),void 0!==a.anisotropy&&(o.anisotropy=a.anisotropy),void 0!==a.flipY&&(o.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(o.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(o.unpackAlignment=a.unpackAlignment),r[a.uuid]=o}return r},parseObject:function(e,t,n){let r,i,a;function o(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function s(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(n[i])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":r=new Sr,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new fi(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new js(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new Us(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new Ea(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new vd(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new bd(e.color,e.intensity);break;case"DirectionalLight":r=new _d(e.color,e.intensity);break;case"PointLight":r=new gd(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new Ed(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new pd(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new dd(e.color,e.groundColor,e.intensity);break;case"LightProbe":r=(new Sd).fromJSON(e);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":i=o(e.geometry),a=s(e.material),r=new oa(i,a);break;case"InstancedMesh":i=o(e.geometry),a=s(e.material);const t=e.count,n=e.instanceMatrix;r=new yu(i,a,t),r.instanceMatrix=new Si(new Float32Array(n.array),16);break;case"LOD":r=new uu;break;case"Line":r=new Au(o(e.geometry),s(e.material),e.mode);break;case"LineLoop":r=new Ru(o(e.geometry),s(e.material));break;case"LineSegments":r=new Cu(o(e.geometry),s(e.material));break;case"PointCloud":case"Points":r=new Nu(o(e.geometry),s(e.material));break;case"Sprite":r=new iu(s(e.material));break;case"Group":r=new Ps;break;default:r=new Tr}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(r.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children){const i=e.children;for(let e=0;e<i.length;e++)r.add(this.parseObject(i[e],t,n))}if("LOD"===e.type){void 0!==e.autoUpdate&&(r.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],i=r.getObjectByProperty("uuid",n.object);void 0!==i&&r.addLevel(i,n.distance)}}return r}});const Od={UVMapping:ie,CubeReflectionMapping:ae,CubeRefractionMapping:oe,EquirectangularReflectionMapping:se,EquirectangularRefractionMapping:ue,CubeUVReflectionMapping:le,CubeUVRefractionMapping:ce},Dd={RepeatWrapping:de,ClampToEdgeWrapping:he,MirroredRepeatWrapping:fe},Pd={NearestFilter:pe,NearestMipmapNearestFilter:me,NearestMipmapLinearFilter:ve,LinearFilter:_e,LinearMipmapNearestFilter:be,LinearMipmapLinearFilter:Te};function Ld(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Dc.call(this,e),this.options={premultiplyAlpha:"none"}}function Nd(){this.type="ShapePath",this.color=new fi,this.subPaths=[],this.currentPath=null}function kd(e){this.type="Font",this.data=e}function Fd(e,t,n,r,i){const a=i.glyphs[e]||i.glyphs["?"];if(!a)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".");const o=new Nd;let s,u,l,c,d,h,f,p;if(a.o){const e=a._cachedOutline||(a._cachedOutline=a.o.split(" "));for(let i=0,a=e.length;i<a;){switch(e[i++]){case"m":s=e[i++]*t+n,u=e[i++]*t+r,o.moveTo(s,u);break;case"l":s=e[i++]*t+n,u=e[i++]*t+r,o.lineTo(s,u);break;case"q":l=e[i++]*t+n,c=e[i++]*t+r,d=e[i++]*t+n,h=e[i++]*t+r,o.quadraticCurveTo(d,h,l,c);break;case"b":l=e[i++]*t+n,c=e[i++]*t+r,d=e[i++]*t+n,h=e[i++]*t+r,f=e[i++]*t+n,p=e[i++]*t+r,o.bezierCurveTo(d,h,f,p,l,c)}}}return{offsetX:a.ha*t,path:o}}function Bd(e){Dc.call(this,e)}let Ud;Ld.prototype=Object.assign(Object.create(Dc.prototype),{constructor:Ld,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=Rc.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;fetch(e).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,i.options)})).then((function(n){Rc.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}),Object.assign(Nd.prototype,{moveTo:function(e,t){return this.currentPath=new ud,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this},bezierCurveTo:function(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function n(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n],i=new ld;i.curves=r.curves,t.push(i)}return t}function r(e,t){const n=t.length;let r=!1;for(let i=n-1,a=0;a<n;i=a++){let n=t[i],o=t[a],s=o.x-n.x,u=o.y-n.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(n=t[a],s=-s,o=t[i],u=-u),e.y<n.y||e.y>o.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=u*(e.x-n.x)-s*(e.y-n.y);if(0===t)return!0;if(t<0)continue;r=!r}}else{if(e.y!==n.y)continue;if(o.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=o.x)return!0}}return r}const i=Ol.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return n(a);let o,s,u,l=[];if(1===a.length)return s=a[0],u=new ld,u.curves=s.curves,l.push(u),l;let c=!i(a[0].getPoints());c=e?!c:c;const d=[],h=[];let f,p,m=[],g=0;h[g]=void 0,m[g]=[];for(let t=0,n=a.length;t<n;t++)s=a[t],f=s.getPoints(),o=i(f),o=e?!o:o,o?(!c&&h[g]&&g++,h[g]={s:new ld,p:f},h[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:f[0]});if(!h[0])return n(a);if(h.length>1){let e=!1;const t=[];for(let e=0,t=h.length;e<t;e++)d[e]=[];for(let n=0,i=h.length;n<i;n++){const i=m[n];for(let a=0;a<i.length;a++){const o=i[a];let s=!0;for(let i=0;i<h.length;i++)r(o.p,h[i].p)&&(n!==i&&t.push({froms:n,tos:i,hole:a}),s?(s=!1,d[i].push(o)):e=!0);s&&d[n].push(o)}}t.length>0&&(e||(m=d))}for(let e=0,t=h.length;e<t;e++){u=h[e].s,l.push(u),p=m[e];for(let e=0,t=p.length;e<t;e++)u.holes.push(p[e].h)}return l}}),Object.assign(kd.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);const n=[],r=function(e,t,n){const r=Array.from?Array.from(e):String(e).split(""),i=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[];let s=0,u=0;for(let e=0;e<r.length;e++){const t=r[e];if("\n"===t)s=0,u-=a;else{const e=Fd(t,i,s,u,n);s+=e.offsetX,o.push(e.path)}}return o}(e,t,this.data);for(let e=0,t=r.length;e<t;e++)Array.prototype.push.apply(n,r[e].toShapes());return n}}),Bd.prototype=Object.assign(Object.create(Dc.prototype),{constructor:Bd,load:function(e,t,n,r){const i=this,a=new Lc(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.load(e,(function(e){let n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}const r=i.parse(n);t&&t(r)}),n,r)},parse:function(e){return new kd(e)}});const jd={getContext:function(){return void 0===Ud&&(Ud=new(window.AudioContext||window.webkitAudioContext)),Ud},setContext:function(e){Ud=e}};function Gd(e){Dc.call(this,e)}function Hd(e,t,n){Sd.call(this,void 0,n);const r=(new fi).set(e),i=(new fi).set(t),a=new Qn(r.r,r.g,r.b),o=new Qn(i.r,i.g,i.b),s=Math.sqrt(Math.PI),u=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(u)}function Vd(e,t){Sd.call(this,void 0,t);const n=(new fi).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}Gd.prototype=Object.assign(Object.create(Dc.prototype),{constructor:Gd,load:function(e,t,n,r){const i=this,a=new Lc(i.manager);a.setResponseType("arraybuffer"),a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.load(e,(function(n){try{const e=n.slice(0);jd.getContext().decodeAudioData(e,(function(e){t(e)}))}catch(t){r?r(t):console.error(t),i.manager.itemError(e)}}),n,r)}}),Hd.prototype=Object.assign(Object.create(Sd.prototype),{constructor:Hd,isHemisphereLightProbe:!0,copy:function(e){return Sd.prototype.copy.call(this,e),this},toJSON:function(e){return Sd.prototype.toJSON.call(this,e)}}),Vd.prototype=Object.assign(Object.create(Sd.prototype),{constructor:Vd,isAmbientLightProbe:!0,copy:function(e){return Sd.prototype.copy.call(this,e),this},toJSON:function(e){return Sd.prototype.toJSON.call(this,e)}});const zd=new ir,Wd=new ir;function qd(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ea,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ea,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function Yd(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(qd.prototype,{update:function(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;const n=e.projectionMatrix.clone(),r=t.eyeSep/2,i=r*t.near/t.focus,a=t.near*Math.tan(Fn.DEG2RAD*t.fov*.5)/t.zoom;let o,s;Wd.elements[12]=-r,zd.elements[12]=r,o=-a*t.aspect+i,s=a*t.aspect+i,n.elements[0]=2*t.near/(s-o),n.elements[8]=(s+o)/(s-o),this.cameraL.projectionMatrix.copy(n),o=-a*t.aspect-i,s=a*t.aspect-i,n.elements[0]=2*t.near/(s-o),n.elements[8]=(s+o)/(s-o),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Wd),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(zd)}}),Object.assign(Yd.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});const Kd=new Qn,Xd=new Yn,Qd=new Qn,Zd=new Qn;function Jd(){Tr.call(this),this.type="AudioListener",this.context=jd.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Yd}function $d(e){Tr.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}Jd.prototype=Object.assign(Object.create(Tr.prototype),{constructor:Jd,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){Tr.prototype.updateMatrixWorld.call(this,e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Kd,Xd,Qd),Zd.set(0,0,-1).applyQuaternion(Xd),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Kd.x,e),t.positionY.linearRampToValueAtTime(Kd.y,e),t.positionZ.linearRampToValueAtTime(Kd.z,e),t.forwardX.linearRampToValueAtTime(Zd.x,e),t.forwardY.linearRampToValueAtTime(Zd.y,e),t.forwardZ.linearRampToValueAtTime(Zd.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(Kd.x,Kd.y,Kd.z),t.setOrientation(Zd.x,Zd.y,Zd.z,n.x,n.y,n.z)}}),$d.prototype=Object.assign(Object.create(Tr.prototype),{constructor:$d,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(void 0===e&&(e=0),!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});const eh=new Qn,th=new Yn,nh=new Qn,rh=new Qn;function ih(e){$d.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function ah(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function oh(e,t,n){let r,i,a;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}ih.prototype=Object.assign(Object.create($d.prototype),{constructor:ih,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(e){if(Tr.prototype.updateMatrixWorld.call(this,e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(eh,th,nh),rh.set(0,0,1).applyQuaternion(th);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(eh.x,e),t.positionY.linearRampToValueAtTime(eh.y,e),t.positionZ.linearRampToValueAtTime(eh.z,e),t.orientationX.linearRampToValueAtTime(rh.x,e),t.orientationY.linearRampToValueAtTime(rh.y,e),t.orientationZ.linearRampToValueAtTime(rh.z,e)}else t.setPosition(eh.x,eh.y,eh.z),t.setOrientation(rh.x,rh.y,rh.z)}}),Object.assign(ah.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(oh.prototype,{accumulate:function(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let a=this.cumulativeWeight;if(0===a){for(let e=0;e!==r;++e)n[i+e]=n[e];a=t}else{a+=t;const e=t/a;this._mixBufferRegion(n,i,0,e,r)}this.cumulativeWeight=a},accumulateAdditive:function(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e},apply:function(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let e=t,i=t+t;e!==i;++e)if(n[e]!==n[e+t]){o.setValue(n,r);break}},saveOriginalState:function(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let e=n,i=r;e!==i;++e)t[e]=t[r+e%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_setAdditiveIdentityNumeric:function(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]},_select:function(e,t,n,r,i){if(r>=.5)for(let r=0;r!==i;++r)e[t+r]=e[n+r]},_slerp:function(e,t,n,r){Yn.slerpFlat(e,t,e,t,e,n,r)},_slerpAdditive:function(e,t,n,r,i){const a=this._workIndex*i;Yn.multiplyQuaternionsFlat(e,a,e,t,e,n),Yn.slerpFlat(e,t,e,t,e,a,r)},_lerp:function(e,t,n,r,i){const a=1-r;for(let o=0;o!==i;++o){const i=t+o;e[i]=e[i]*a+e[n+o]*r}},_lerpAdditive:function(e,t,n,r,i){for(let a=0;a!==i;++a){const i=t+a;e[i]=e[i]+e[n+a]*r}}});const sh="\\[\\]\\.:\\/",uh=new RegExp("[\\[\\]\\.:\\/]","g"),lh="[^\\[\\]\\.:\\/]",ch="[^"+sh.replace("\\.","")+"]",dh=/((?:WC+[\/:])*)/.source.replace("WC",lh),hh=/(WCOD+)?/.source.replace("WCOD",ch),fh=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",lh),ph=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",lh),mh=new RegExp("^"+dh+hh+fh+ph+"$"),gh=["material","materials","bones"];function vh(e,t,n){const r=n||yh.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function yh(e,t,n){this.path=t,this.parsedPath=n||yh.parseTrackName(t),this.node=yh.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function _h(){this.uuid=Fn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}function bh(e,t,n,r){this._mixer=e,this._clip=t,this._localRoot=n||null,this.blendMode=r||t.blendMode;const i=t.tracks,a=i.length,o=new Array(a),s={endingStart:Ht,endingEnd:Ht};for(let e=0;e!==a;++e){const t=i[e].createInterpolant(null);o[e]=t,t.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ft,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Eh(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Th(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Sh(e,t,n){Gs.call(this,e,t),this.meshPerAttribute=n||1}function wh(e,t,n,r){this.ray=new Kr(e,t),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new ur,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Ah(e,t){return e.distance-t.distance}function xh(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r){const r=e.children;for(let e=0,i=r.length;e<i;e++)xh(r[e],t,n,!0)}}Object.assign(vh.prototype,{getValue:function(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(yh,{Composite:vh,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new yh.Composite(e,t,n):new yh(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(uh,"")},parseTrackName:function(e){const t=mh.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==gh.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const a=n(i.children);if(a)return a}return null},r=n(e.children);if(r)return r}return null}}),Object.assign(yh.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){let e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=yh.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const a=e[r];if(void 0===a){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+r+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(yh.prototype,{_getValue_unbound:yh.prototype.getValue,_setValue_unbound:yh.prototype.setValue}),Object.assign(_h.prototype,{isAnimationObjectGroup:!0,add:function(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length;let o=void 0,s=e.length,u=this.nCachedObjects_;for(let l=0,c=arguments.length;l!==c;++l){const c=arguments[l],d=c.uuid;let h=t[d];if(void 0===h){h=s++,t[d]=h,e.push(c);for(let e=0,t=a;e!==t;++e)i[e].push(new yh(c,n[e],r[e]))}else if(h<u){o=e[h];const s=--u,l=e[s];t[l.uuid]=h,e[h]=l,t[d]=s,e[s]=c;for(let e=0,t=a;e!==t;++e){const t=i[e],a=t[s];let o=t[h];t[h]=a,void 0===o&&(o=new yh(c,n[e],r[e])),t[s]=o}}else e[h]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u},remove:function(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const o=arguments[a],s=o.uuid,u=t[s];if(void 0!==u&&u>=i){const a=i++,l=e[a];t[l.uuid]=u,e[u]=l,t[s]=a,e[a]=o;for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[a],i=t[u];t[u]=r,t[a]=i}}}this.nCachedObjects_=i},uncache:function(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,a=e.length;for(let o=0,s=arguments.length;o!==s;++o){const s=arguments[o].uuid,u=t[s];if(void 0!==u)if(delete t[s],u<i){const o=--i,s=e[o],l=--a,c=e[l];t[s.uuid]=u,e[u]=s,t[c.uuid]=o,e[o]=c,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[o],i=t[l];t[u]=r,t[o]=i,t.pop()}}else{const i=--a,o=e[i];t[o.uuid]=u,e[u]=o,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e];t[u]=t[i],t.pop()}}}this.nCachedObjects_=i},subscribe_:function(e,t){let n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];const a=this._paths,o=this._parsedPaths,s=this._objects,u=s.length,l=this.nCachedObjects_,c=new Array(u);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(c);for(let n=l,r=s.length;n!==r;++n){const r=s[n];c[n]=new yh(r,e,t)}return c},unsubscribe_:function(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}),Object.assign(bh.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const n=this._clip.duration,r=e._clip.duration,i=r/n,a=n/r;e.warp(1,i,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){const r=this._mixer,i=r.time,a=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const s=o.parameterPositions,u=o.sampleValues;return s[0]=i,s[1]=i+n,u[0]=e/a,u[1]=t/a,this},stopWarping:function(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(null!==i){const r=(e-i)*n;if(r<0||0===n)return;this._startTime=null,t=n*r}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const e=this._interpolants,t=this._propertyBindings;switch(this.blendMode){case qt:for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(a),t[n].accumulateAdditive(o);break;case Wt:default:for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(a),t[n].accumulate(r,o)}}},_updateWeight:function(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t},_updateTime:function(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const a=n===Bt;if(0===e)return-1===i?r:a&&1==(1&i)?t-r:r;if(n===kt){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){const n=Math.floor(r/t);r-=t*n,i+=Math.abs(n);const o=this.repetitions-i;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){const t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(a&&1==(1&i))return t-r}return r},_setEndings:function(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=Vt,r.endingEnd=Vt):(r.endingStart=e?this.zeroSlopeAtStart?Vt:Ht:zt,r.endingEnd=t?this.zeroSlopeAtEnd?Vt:Ht:zt)},_scheduleFading:function(e,t,n){const r=this._mixer,i=r.time;let a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}),Eh.prototype=Object.assign(Object.create(Ln.prototype),{constructor:Eh,_bindAction:function(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,u=this._bindingsByRootAndName;let l=u[s];void 0===l&&(l={},u[s]=l);for(let e=0;e!==i;++e){const i=r[e],u=i.name;let c=l[u];if(void 0!==c)a[e]=c;else{if(c=a[e],void 0!==c){null===c._cacheIndex&&(++c.referenceCount,this._addInactiveBinding(c,s,u));continue}const r=t&&t._propertyBindings[e].binding.parsedPath;c=new oh(yh.create(n,u,r),i.ValueTypeName,i.getValueSize()),++c.referenceCount,this._addInactiveBinding(c,s,u),a[e]=c}o[e].resultBuffer=c.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){const r=this._actions,i=this._actionsByClip;let a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{const t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e},_removeInactiveAction:function(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,u=s[s.length-1],l=e._byClipCacheIndex;u._byClipCacheIndex=l,s[l]=u,s.pop(),e._byClipCacheIndex=null;delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}},_lendAction:function(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackAction:function(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_addInactiveBinding:function(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)},_removeInactiveBinding:function(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u,t[u]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]},_lendBinding:function(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackBinding:function(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_lendControlInterpolant:function(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new vc(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t,n){const r=t||this._root,i=r.uuid;let a="string"==typeof e?Mc.findByName(r,e):e;const o=null!==a?a.uuid:e;let s=this._actionsByClip[o],u=null;if(void 0===n&&(n=null!==a?a.blendMode:Wt),void 0!==s){const e=s.actionByRoot[i];if(void 0!==e&&e.blendMode===n)return e;u=s.knownActions[0],null===a&&(a=u._clip)}if(null===a)return null;const l=new bh(this,a,t,n);return this._bindAction(l,u),this._addInactiveAction(l,o,i),l},existingAction:function(e,t){const n=t||this._root,r=n.uuid,i="string"==typeof e?Mc.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this},update:function(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let o=0;o!==n;++o){t[o]._update(r,e,i,a)}const o=this._bindings,s=this._nActiveBindings;for(let e=0;e!==s;++e)o[e].apply(a);return this},setTime:function(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const e=i.knownActions;for(let n=0,r=e.length;n!==r;++n){const r=e[n];this._deactivateAction(r);const i=r._cacheIndex,a=t[t.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,a._cacheIndex=i,t[i]=a,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}},uncacheRoot:function(e){const t=e.uuid,n=this._actionsByClip;for(const e in n){const r=n[e].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}const r=this._bindingsByRootAndName[t];if(void 0!==r)for(const e in r){const t=r[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}},uncacheAction:function(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Th.prototype.clone=function(){return new Th(void 0===this.value.clone?this.value:this.value.clone())},Sh.prototype=Object.assign(Object.create(Gs.prototype),{constructor:Sh,isInstancedInterleavedBuffer:!0,copy:function(e){return Gs.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){const t=Gs.prototype.clone.call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(e){const t=Gs.prototype.toJSON.call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.assign(wh.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){const r=n||[];return xh(e,this,r,t),r.sort(Ah),r},intersectObjects:function(e,t,n){const r=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(let n=0,i=e.length;n<i;n++)xh(e[n],this,r,t);return r.sort(Ah),r}});class Mh{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}clone(){return(new this.constructor).copy(this)}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Fn.clamp(t/this.radius,-1,1))),this}}function Ch(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}Object.assign(Ch.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}});const Rh=new Bn;function Ih(e,t){this.min=void 0!==e?e:new Bn(1/0,1/0),this.max=void 0!==t?t:new Bn(-1/0,-1/0)}Object.assign(Ih.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){const n=Rh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Bn),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Bn),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Bn),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Bn),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return Rh.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});const Oh=new Qn,Dh=new Qn;function Ph(e,t){this.start=void 0!==e?e:new Qn,this.end=void 0!==t?t:new Qn}function Lh(e){Tr.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Object.assign(Ph.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Qn),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Qn),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Qn),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){Oh.subVectors(e,this.start),Dh.subVectors(this.end,this.start);const n=Dh.dot(Dh);let r=Dh.dot(Oh)/n;return t&&(r=Fn.clamp(r,0,1)),r},closestPointToPoint:function(e,t,n){const r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Qn),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Lh.prototype=Object.create(Tr.prototype),Lh.prototype.constructor=Lh,Lh.prototype.isImmediateRenderObject=!0;const Nh=new Qn;function kh(e,t){Tr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new Hi,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1,n=32;e<n;e++,t++){const i=e/n*Math.PI*2,a=t/n*Math.PI*2;r.push(Math.cos(i),Math.sin(i),1,Math.cos(a),Math.sin(a),1)}n.setAttribute("position",new Oi(r,3));const i=new _u({fog:!1,toneMapped:!1});this.cone=new Cu(n,i),this.add(this.cone),this.update()}kh.prototype=Object.create(Tr.prototype),kh.prototype.constructor=kh,kh.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},kh.prototype.update=function(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Nh.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Nh),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};const Fh=new Qn,Bh=new ir,Uh=new ir;function jh(e){const t=function e(t){const n=[];t&&t.isBone&&n.push(t);for(let r=0;r<t.children.length;r++)n.push.apply(n,e(t.children[r]));return n}(e),n=new Hi,r=[],i=[],a=new fi(0,0,1),o=new fi(0,1,0);for(let e=0;e<t.length;e++){const n=t[e];n.parent&&n.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.setAttribute("position",new Oi(r,3)),n.setAttribute("color",new Oi(i,3));const s=new _u({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Cu.call(this,n,s),this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Gh(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;const r=new Gl(t,4,2),i=new bi({wireframe:!0,fog:!1,toneMapped:!1});oa.call(this,r,i),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}jh.prototype=Object.create(Cu.prototype),jh.prototype.constructor=jh,jh.prototype.isSkeletonHelper=!0,jh.prototype.updateMatrixWorld=function(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");Uh.getInverse(this.root.matrixWorld);for(let e=0,n=0;e<t.length;e++){const i=t[e];i.parent&&i.parent.isBone&&(Bh.multiplyMatrices(Uh,i.matrixWorld),Fh.setFromMatrixPosition(Bh),r.setXYZ(n,Fh.x,Fh.y,Fh.z),Bh.multiplyMatrices(Uh,i.parent.matrixWorld),Fh.setFromMatrixPosition(Bh),r.setXYZ(n+1,Fh.x,Fh.y,Fh.z),n+=2)}n.getAttribute("position").needsUpdate=!0,Tr.prototype.updateMatrixWorld.call(this,e)},Gh.prototype=Object.create(oa.prototype),Gh.prototype.constructor=Gh,Gh.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Gh.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};const Hh=new Qn,Vh=new fi,zh=new fi;function Wh(e,t,n){Tr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const r=new Xu(t);r.rotateY(.5*Math.PI),this.material=new bi({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.setAttribute("color",new Si(a,3)),this.add(new oa(r,this.material)),this.update()}function qh(e,t,n,r){e=e||10,t=t||10,n=new fi(void 0!==n?n:4473924),r=new fi(void 0!==r?r:8947848);const i=t/2,a=e/t,o=e/2,s=[],u=[];for(let e=0,l=0,c=-o;e<=t;e++,c+=a){s.push(-o,0,c,o,0,c),s.push(c,0,-o,c,0,o);const t=e===i?n:r;t.toArray(u,l),l+=3,t.toArray(u,l),l+=3,t.toArray(u,l),l+=3,t.toArray(u,l),l+=3}const l=new Hi;l.setAttribute("position",new Oi(s,3)),l.setAttribute("color",new Oi(u,3));const c=new _u({vertexColors:!0,toneMapped:!1});Cu.call(this,l,c),this.type="GridHelper"}function Yh(e,t,n,r,i,a){e=e||10,t=t||16,n=n||8,r=r||64,i=new fi(void 0!==i?i:4473924),a=new fi(void 0!==a?a:8947848);const o=[],s=[];for(let n=0;n<=t;n++){const r=n/t*(2*Math.PI),u=Math.sin(r)*e,l=Math.cos(r)*e;o.push(0,0,0),o.push(u,0,l);const c=1&n?i:a;s.push(c.r,c.g,c.b),s.push(c.r,c.g,c.b)}for(let t=0;t<=n;t++){const u=1&t?i:a,l=e-e/n*t;for(let e=0;e<r;e++){let t=e/r*(2*Math.PI),n=Math.sin(t)*l,i=Math.cos(t)*l;o.push(n,0,i),s.push(u.r,u.g,u.b),t=(e+1)/r*(2*Math.PI),n=Math.sin(t)*l,i=Math.cos(t)*l,o.push(n,0,i),s.push(u.r,u.g,u.b)}}const u=new Hi;u.setAttribute("position",new Oi(o,3)),u.setAttribute("color",new Oi(s,3));const l=new _u({vertexColors:!0,toneMapped:!1});Cu.call(this,u,l),this.type="PolarGridHelper"}Wh.prototype=Object.create(Tr.prototype),Wh.prototype.constructor=Wh,Wh.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Wh.prototype.update=function(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Vh.copy(this.light.color),zh.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const r=e<n/2?Vh:zh;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(Hh.setFromMatrixPosition(this.light.matrixWorld).negate())},qh.prototype=Object.create(Cu.prototype),qh.prototype.constructor=qh,Yh.prototype=Object.create(Cu.prototype),Yh.prototype.constructor=Yh;const Kh=new Qn,Xh=new Qn,Qh=new Qn;function Zh(e,t,n){Tr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);let r=new Hi;r.setAttribute("position",new Oi([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new _u({fog:!1,toneMapped:!1});this.lightPlane=new Au(r,i),this.add(this.lightPlane),r=new Hi,r.setAttribute("position",new Oi([0,0,0,0,0,1],3)),this.targetLine=new Au(r,i),this.add(this.targetLine),this.update()}Zh.prototype=Object.create(Tr.prototype),Zh.prototype.constructor=Zh,Zh.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Zh.prototype.update=function(){Kh.setFromMatrixPosition(this.light.matrixWorld),Xh.setFromMatrixPosition(this.light.target.matrixWorld),Qh.subVectors(Xh,Kh),this.lightPlane.lookAt(Xh),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Xh),this.targetLine.scale.z=Qh.length()};const Jh=new Qn,$h=new ba;function ef(e){const t=new Hi,n=new _u({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],a={},o=new fi(16755200),s=new fi(16711680),u=new fi(43775),l=new fi(16777215),c=new fi(3355443);function d(e,t,n){h(e,n),h(t,n)}function h(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(r.length/3-1)}d("n1","n2",o),d("n2","n4",o),d("n4","n3",o),d("n3","n1",o),d("f1","f2",o),d("f2","f4",o),d("f4","f3",o),d("f3","f1",o),d("n1","f1",o),d("n2","f2",o),d("n3","f3",o),d("n4","f4",o),d("p","n1",s),d("p","n2",s),d("p","n3",s),d("p","n4",s),d("u1","u2",u),d("u2","u3",u),d("u3","u1",u),d("c","t",l),d("p","c",c),d("cn1","cn2",c),d("cn3","cn4",c),d("cf1","cf2",c),d("cf3","cf4",c),t.setAttribute("position",new Oi(r,3)),t.setAttribute("color",new Oi(i,3)),Cu.call(this,t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function tf(e,t,n,r,i,a,o){Jh.set(i,a,o).unproject(r);const s=t[e];if(void 0!==s){const e=n.getAttribute("position");for(let t=0,n=s.length;t<n;t++)e.setXYZ(s[t],Jh.x,Jh.y,Jh.z)}}ef.prototype=Object.create(Cu.prototype),ef.prototype.constructor=ef,ef.prototype.update=function(){const e=this.geometry,t=this.pointMap;$h.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),tf("c",t,e,$h,0,0,-1),tf("t",t,e,$h,0,0,1),tf("n1",t,e,$h,-1,-1,-1),tf("n2",t,e,$h,1,-1,-1),tf("n3",t,e,$h,-1,1,-1),tf("n4",t,e,$h,1,1,-1),tf("f1",t,e,$h,-1,-1,1),tf("f2",t,e,$h,1,-1,1),tf("f3",t,e,$h,-1,1,1),tf("f4",t,e,$h,1,1,1),tf("u1",t,e,$h,.7,1.1,-1),tf("u2",t,e,$h,-.7,1.1,-1),tf("u3",t,e,$h,0,2,-1),tf("cf1",t,e,$h,-1,0,1),tf("cf2",t,e,$h,1,0,1),tf("cf3",t,e,$h,0,-1,1),tf("cf4",t,e,$h,0,1,1),tf("cn1",t,e,$h,-1,0,-1),tf("cn2",t,e,$h,1,0,-1),tf("cn3",t,e,$h,0,-1,-1),tf("cn4",t,e,$h,0,1,-1),e.getAttribute("position").needsUpdate=!0};const nf=new Fr;function rf(e,t){this.object=e,void 0===t&&(t=16776960);const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Hi;i.setIndex(new Si(n,1)),i.setAttribute("position",new Si(r,3)),Cu.call(this,i,new _u({color:t,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function af(e,t){this.type="Box3Helper",this.box=e,void 0===t&&(t=16776960);const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Hi;r.setIndex(new Si(n,1)),r.setAttribute("position",new Oi([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Cu.call(this,r,new _u({color:t,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function of(e,t,n){this.plane=e,this.size=void 0===t?1:t;const r=void 0!==n?n:16776960,i=new Hi;i.setAttribute("position",new Oi([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Au.call(this,i,new _u({color:r,toneMapped:!1})),this.type="PlaneHelper";const a=new Hi;a.setAttribute("position",new Oi([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new oa(a,new bi({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}rf.prototype=Object.create(Cu.prototype),rf.prototype.constructor=rf,rf.prototype.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&nf.setFromObject(this.object),nf.isEmpty())return;const t=nf.min,n=nf.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()},rf.prototype.setFromObject=function(e){return this.object=e,this.update(),this},rf.prototype.copy=function(e){return Cu.prototype.copy.call(this,e),this.object=e.object,this},af.prototype=Object.create(Cu.prototype),af.prototype.constructor=af,af.prototype.updateMatrixWorld=function(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Tr.prototype.updateMatrixWorld.call(this,e))},of.prototype=Object.create(Au.prototype),of.prototype.constructor=of,of.prototype.updateMatrixWorld=function(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?m:p,this.lookAt(this.plane.normal),Tr.prototype.updateMatrixWorld.call(this,e)};const sf=new Qn;let uf,lf;function cf(e,t,n,r,i,a){Tr.call(this),this.type="ArrowHelper",void 0===e&&(e=new Qn(0,0,1)),void 0===t&&(t=new Qn(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===a&&(a=.2*i),void 0===uf&&(uf=new Hi,uf.setAttribute("position",new Oi([0,0,0,0,1,0],3)),lf=new Zl(0,.5,1,5,1),lf.translate(0,-.5,0)),this.position.copy(t),this.line=new Au(uf,new _u({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new oa(lf,new bi({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,a)}function df(e){const t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Hi;n.setAttribute("position",new Oi(t,3)),n.setAttribute("color",new Oi([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));const r=new _u({vertexColors:!0,toneMapped:!1});Cu.call(this,n,r),this.type="AxesHelper"}cf.prototype=Object.create(Tr.prototype),cf.prototype.constructor=cf,cf.prototype.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{sf.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(sf,t)}},cf.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},cf.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},cf.prototype.copy=function(e){return Tr.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},df.prototype=Object.create(Cu.prototype),df.prototype.constructor=df;const hf=Math.pow(2,8),ff=[.125,.215,.35,.446,.526,.582],pf=5+ff.length,mf=20,gf={[Qt]:0,[Zt]:1,[$t]:2,[tn]:3,[nn]:4,[rn]:5,[Jt]:6},vf=new vd,{_lodPlanes:yf,_sizeLods:_f,_sigmas:bf}=function(){const e=[],t=[],n=[];let r=8;for(let i=0;i<pf;i++){const a=Math.pow(2,r);t.push(a);let o=1/a;i>4?o=ff[i-8+4-1]:0==i&&(o=0),n.push(o);const s=1/(a-1),u=-s/2,l=1+s/2,c=[u,u,l,u,l,l,u,u,l,l,u,l],d=6,h=6,f=3,p=2,m=1,g=new Float32Array(f*h*d),v=new Float32Array(p*h*d),y=new Float32Array(m*h*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];g.set(r,f*h*e),v.set(c,p*h*e);const i=[e,e,e,e,e,e];y.set(i,m*h*e)}const _=new Hi;_.setAttribute("position",new Si(g,f)),_.setAttribute("uv",new Si(v,p)),_.setAttribute("faceIndex",new Si(y,m)),e.push(_),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}();let Ef=null;const Tf=(1+Math.sqrt(5))/2,Sf=1/Tf,wf=[new Qn(1,1,1),new Qn(-1,1,1),new Qn(1,1,-1),new Qn(-1,1,-1),new Qn(0,Tf,Sf),new Qn(0,Tf,-Sf),new Qn(Sf,0,Tf),new Qn(-Sf,0,Tf),new Qn(Tf,Sf,0),new Qn(-Tf,Sf,0)];function Af(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(e){const t=new Float32Array(e),n=new Qn(0,1,0);return new ic({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:gf[Qt]},outputEncoding:{value:gf[Qt]}},vertexShader:Of(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t${Df()}\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:_,depthTest:!1,depthWrite:!1})}(mf),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function xf(e){return void 0!==e&&e.type===we&&(e.encoding===Qt||e.encoding===Zt||e.encoding===Jt)}function Mf(e){const t=new Wn(3*hf,3*hf,e);return t.texture.mapping=le,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Cf(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function Rf(){return new ic({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new Bn(1,1)},inputEncoding:{value:gf[Qt]},outputEncoding:{value:gf[Qt]}},vertexShader:Of(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t${Df()}\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:_,depthTest:!1,depthWrite:!1})}function If(){return new ic({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:gf[Qt]},outputEncoding:{value:gf[Qt]}},vertexShader:Of(),fragmentShader:`\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t${Df()}\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t`,blending:_,depthTest:!1,depthWrite:!1})}function Of(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function Df(){return"\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t"}function Pf(e,t,n,r,i,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new vi(e,t,n,i,a,o)}Af.prototype={constructor:Af,fromScene:function(e,t=0,n=.1,r=100){Ef=this._renderer.getRenderTarget();const i=this._allocateTargets();return this._sceneToCubeUV(e,n,r,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i},fromEquirectangular:function(e){return this._fromTexture(e)},fromCubemap:function(e){return this._fromTexture(e)},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=If(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=Rf(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<yf.length;e++)yf[e].dispose()},_cleanup:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Ef),e.scissorTest=!1,Cf(e,0,0,e.width,e.height)},_fromTexture:function(e){Ef=this._renderer.getRenderTarget();const t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t},_allocateTargets:function(e){const t={magFilter:pe,minFilter:pe,generateMipmaps:!1,type:we,format:Ge,encoding:xf(e)?e.encoding:$t,depthBuffer:!1,stencilBuffer:!1},n=Mf(t);return n.depthBuffer=!e,this._pingPongRenderTarget=Mf(t),n},_compileMaterial:function(e){const t=new oa(yf[0],e);this._renderer.compile(t,vf)},_sceneToCubeUV:function(e,t,n,r){const i=new Ea(90,1,t,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,u=s.outputEncoding,l=s.toneMapping,c=s.getClearColor(),d=s.getClearAlpha();s.toneMapping=J,s.outputEncoding=Qt;let h=e.background;if(h&&h.isColor){h.convertSRGBToLinear();const t=Math.max(h.r,h.g,h.b),n=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);h=h.multiplyScalar(Math.pow(2,-n));const r=(n+128)/255;s.setClearColor(h,r),e.background=null}for(let t=0;t<6;t++){const n=t%3;0==n?(i.up.set(0,a[t],0),i.lookAt(o[t],0,0)):1==n?(i.up.set(0,0,a[t]),i.lookAt(0,o[t],0)):(i.up.set(0,a[t],0),i.lookAt(0,0,o[t])),Cf(r,n*hf,t>2?hf:0,hf,hf),s.setRenderTarget(r),s.render(e,i)}s.toneMapping=l,s.outputEncoding=u,s.setClearColor(c,d)},_textureToCubeUV:function(e,t){const n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=If()):null==this._equirectShader&&(this._equirectShader=Rf());const r=e.isCubeTexture?this._cubemapShader:this._equirectShader,i=new oa(yf[0],r),a=r.uniforms;a.envMap.value=e,e.isCubeTexture||a.texelSize.value.set(1/e.image.width,1/e.image.height),a.inputEncoding.value=gf[e.encoding],a.outputEncoding.value=gf[t.texture.encoding],Cf(t,0,0,3*hf,2*hf),n.setRenderTarget(t),n.render(i,vf)},_applyPMREM:function(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let t=1;t<pf;t++){const n=Math.sqrt(bf[t]*bf[t]-bf[t-1]*bf[t-1]),r=wf[(t-1)%wf.length];this._blur(e,t-1,t,n,r)}t.autoClear=n},_blur:function(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)},_halfBlur:function(e,t,n,r,i,a,o){const s=this._renderer,u=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const l=new oa(yf[r],u),c=u.uniforms,d=_f[n]-1,h=isFinite(i)?Math.PI/(2*d):2*Math.PI/39,f=i/h,p=isFinite(i)?1+Math.floor(3*f):mf;p>mf&&console.warn(`sigmaRadians, ${i}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);const m=[];let g=0;for(let e=0;e<mf;++e){const t=e/f,n=Math.exp(-t*t/2);m.push(n),0==e?g+=n:e<p&&(g+=2*n)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;c.envMap.value=e.texture,c.samples.value=p,c.weights.value=m,c.latitudinal.value="latitudinal"===a,o&&(c.poleAxis.value=o),c.dTheta.value=h,c.mipInt.value=8-n,c.inputEncoding.value=gf[e.texture.encoding],c.outputEncoding.value=gf[e.texture.encoding];const v=_f[r];Cf(t,3*Math.max(0,hf-2*v),(0===r?0:2*hf)+2*v*(r>4?r-8+4:0),3*v,2*v),s.setRenderTarget(t),s.render(l,vf)}};const Lf=0,Nf=1,kf=0,Ff=1,Bf=2;function Uf(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function jf(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function Gf(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Nu(e,t)}function Hf(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new iu(e)}function Vf(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Nu(e,t)}function zf(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Iu(e)}function Wf(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Iu(e)}function qf(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Iu(e)}function Yf(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Qn(e,t,n)}function Kf(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Si(e,t).setUsage(xn)}function Xf(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new wi(e,t)}function Qf(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Ai(e,t)}function Zf(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new xi(e,t)}function Jf(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Mi(e,t)}function $f(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Ci(e,t)}function ep(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Ri(e,t)}function tp(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Ii(e,t)}function np(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Oi(e,t)}function rp(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Di(e,t)}function ip(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Xc.call(this,e),this.type="catmullrom",this.closed=!0}function ap(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Xc.call(this,e),this.type="catmullrom"}function op(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Xc.call(this,e),this.type="catmullrom"}function sp(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new df(e)}function up(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new rf(e,t)}function lp(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Cu(new Xl(e.geometry),new _u({color:void 0!==t?t:16777215}))}function cp(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Cu(new Gu(e.geometry),new _u({color:void 0!==t?t:16777215}))}function dp(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Lc(e)}function hp(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Fc(e)}function fp(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new wa(e,n)}Gc.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Gc.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(sd.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const t=new fa;for(let n=0,r=e.length;n<r;n++){const r=e[n];t.vertices.push(new Qn(r.x,r.y,r.z||0))}return t}}),Object.assign(ud.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),ip.prototype=Object.create(Xc.prototype),ap.prototype=Object.create(Xc.prototype),op.prototype=Object.create(Xc.prototype),Object.assign(op.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),qh.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},jh.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Dc.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Ad.extractUrlBase(e)}}),Dc.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Id.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(Ih.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Fr.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(jr.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Ca.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},Ph.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Fn,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Fn.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Fn.ceilPowerOfTwo(e)}}),Object.assign(Un.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(ir.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Qn).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)}}),Jr.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Yn.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Kr.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(li.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(li,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),li.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),li.getNormal(e,t,n,r)}}),Object.assign(ld.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ll(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ql(this,e)}}),Object.assign(Bn.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Qn.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(zn.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(fa.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(Tr.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Tr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(oa.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(oa.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Yt},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(uu.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(hu.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),lu.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Gc.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ea.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(cd.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Si.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===xn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(xn)}}}),Object.assign(Si.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?xn:An),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Hi.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new Si(arguments[1],arguments[2])))},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Hi.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(xd.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(wh.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(Gs.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===xn},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(Gs.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?xn:An),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Nl.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Th.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(_i.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new fi}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===v}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(sc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(oc.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(_a.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(Fs.prototype,{clearTarget:function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(Fs.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?Zt:Qt}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Cs.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Wn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties($d.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return(new Gd).load(e,(function(e){t.setBuffer(e)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),ah.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Sa.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};const pp={merge:function(e,t,n){let r;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,t=t.geometry),e.merge(t,r,n)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}};function mp(){console.error("THREE.CanvasRenderer has been removed")}function gp(){console.error("THREE.JSONLoader has been removed.")}Gn.crossOrigin=void 0,Gn.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const i=new jc;i.setCrossOrigin(this.crossOrigin);const a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},Gn.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const i=new Uc;i.setCrossOrigin(this.crossOrigin);const a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},Gn.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Gn.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const vp={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function yp(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:r}}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n)=>{const r=t[n];void 0!==r&&r!==e[n].value&&(e[n].value=r)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6),i=n(30);const a=e=>Object(i.a)(r.c,e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>{try{return new DOMException("","InvalidStateError")}catch(e){return e.code=11,e.name="InvalidStateError",e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=n||null,this.data=r||null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=n||null,this.data=r||null},e.exports=t.default},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6),i=n(30);const a=e=>Object(i.a)(r.b,e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(210),a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,this.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,this.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,this.SEGMENTS_UPDATE_FAILED_ERROR_CODE=13,this.SEGMENTS_UNAVAILABLE_ERROR_CODE=14,this.SEGMENT_BASE_LOADER_ERROR_CODE=15,this.TIME_SYNC_FAILED_ERROR_CODE=16,this.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,this.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,this.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,this.APPEND_ERROR_CODE=20,this.REMOVE_ERROR_CODE=21,this.DATA_UPDATE_FAILED_ERROR_CODE=22,this.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,this.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,this.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,this.DOWNLOAD_ERROR_ID_MANIFEST="manifest",this.DOWNLOAD_ERROR_ID_SIDX_CODE=26,this.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,this.DOWNLOAD_ERROR_ID_CONTENT="content",this.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,this.DOWNLOAD_ERROR_ID_INITIALIZATION="initialization",this.DOWNLOAD_ERROR_ID_XLINK_CODE=29,this.DOWNLOAD_ERROR_ID_XLINK="xlink",this.MANIFEST_ERROR_ID_CODEC_CODE=30,this.MANIFEST_ERROR_ID_PARSE_CODE=31,this.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,this.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,this.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,this.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,this.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",this.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",this.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",this.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",this.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",this.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segments",this.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize time",this.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",this.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",this.APPEND_ERROR_MESSAGE="chunk is not defined",this.REMOVE_ERROR_MESSAGE="buffer is not defined",this.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",this.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",this.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",this.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",this.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : "}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=a,e.exports=t.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>{const n=e.get(t);if(void 0===n)throw new Error("A value with the given key could not be found.");return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>{try{return new DOMException("","NotSupportedError")}catch(e){return e.code=9,e.name="NotSupportedError",e}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._responseHeaders=null,this._serviceLocation=null};i.GET="GET",i.HEAD="HEAD",i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.OTHER_TYPE="other",t.HTTPRequest=i,t.HTTPRequestTrace=function e(){r(this,e),this.s=null,this.d=null,this.b=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate"}}]),e}());t.default=i},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null};i.GET="GET",i.HEAD="HEAD",i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.OTHER_TYPE="other",t.HTTPRequest=i,t.HTTPRequestTrace=function e(){r(this,e),this.s=null,this.d=null,this.b=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(182);var a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENTS_UPDATE_FAILED_ERROR_CODE=13,e.SEGMENTS_UNAVAILABLE_ERROR_CODE=14,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.MANIFEST_ERROR_ID_CODEC_CODE=30,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segments",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="buffer is not defined",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors"}}]),e}());t.default=i},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1052),a=r(n(1153)),o=r(n(1172)),s=r(n(1187)),u=r(n(13));dashjs.Protection=o.default,dashjs.MetricsReporting=a.default,dashjs.MediaPlayerFactory=s.default,dashjs.Debug=u.default,t.default=dashjs,t.MediaPlayer=i.MediaPlayer,t.Protection=o.default,t.MetricsReporting=a.default,t.MediaPlayerFactory=s.default,t.Debug=u.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight"}}]),e}());t.default=i,e.exports=t.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>"inputs"in e},function(e,t,n){"use strict";n.d(t,"AudioContext",(function(){return ci})),n.d(t,"AudioWorkletNode",(function(){return bi})),n.d(t,"OfflineAudioContext",(function(){return Si})),n.d(t,"isAnyAudioContext",(function(){return wi})),n.d(t,"isAnyAudioNode",(function(){return Ai})),n.d(t,"isAnyAudioParam",(function(){return xi})),n.d(t,"isAnyOfflineAudioContext",(function(){return Mi}));var r=n(49),i=n(707),a=n(708),o=n(709),s=n(865),u=n(710),l=n(711),c=n(712),d=n(713),h=n(714),f=n(715),p=n(716),m=n(717),g=n(718),v=n(719),y=n(720),_=n(863),b=n(721),E=n(722),T=n(723),S=n(868),w=n(724),A=n(725),x=n(726),M=n(727),C=n(728),R=n(729),I=n(730),O=n(731),D=n(732),P=n(733),L=n(734),N=n(735),k=n(736),F=n(737),B=n(738),U=n(739),j=n(740),G=n(741),H=n(869),V=n(742),z=n(743),W=n(744),q=n(745),Y=n(870),K=n(746),X=n(747),Q=n(748),Z=n(749),J=n(750),$=n(751),ee=n(752),te=n(753),ne=n(754),re=n(755),ie=n(756),ae=n(757),oe=n(758),se=n(759),ue=n(760),le=n(871),ce=n(761),de=n(762),he=n(44),fe=n(88),pe=n(24),me=n(763),ge=n(764),ve=n(765),ye=n(766),_e=n(767),be=n(768),Ee=n(769),Te=n(770),Se=n(771),we=n(772),Ae=(n(773),n(774)),xe=n(775),Me=n(776),Ce=n(777),Re=n(778),Ie=n(779),Oe=n(780),De=n(781),Pe=n(866),Le=n(782),Ne=n(867),ke=n(783),Fe=n(784),Be=n(785),Ue=n(786),je=n(872),Ge=n(864),He=n(787),Ve=n(788),ze=n(873),We=n(789),qe=n(790),Ye=n(791),Ke=n(792),Xe=n(793),Qe=n(794),Ze=n(795),Je=n(796),$e=n(797),et=n(798),tt=n(799),nt=n(800),rt=n(801),it=n(802),at=n(803),ot=n(804),st=n(805),ut=n(806),lt=n(807),ct=n(808),dt=n(809),ht=n(810),ft=n(811),pt=n(31),mt=n(812),gt=n(813),vt=n(814),yt=n(815),_t=n(816),bt=n(817),Et=n(818),Tt=n(819),St=n(820),wt=n(821),At=n(822),xt=n(823),Mt=n(824),Ct=n(825),Rt=(n(826),n(827)),It=n(828),Ot=n(829),Dt=n(830),Pt=(n(831),n(832),n(833),n(834),n(835)),Lt=n(836),Nt=n(837),kt=(n(838),n(839),n(840),n(841),n(842),n(843),n(844)),Ft=(n(845),n(171)),Bt=n(846),Ut=n(847),jt=n(848),Gt=n(849),Ht=n(850),Vt=n(851),zt=n(852),Wt=n(853),qt=n(6),Yt=n(84),Kt=n(85),Xt=n(28),Qt=n(68),Zt=n(23),Jt=n(69),$t=n(30),en=n(45),tn=n(58),nn=n(172),rn=n(50),an=n(100),on=n(83),sn=n(43),un=(n(854),n(855)),ln=n(70);n(229),n(313);const cn=Object(M.a)(new Map,new WeakMap),dn=Object(jt.a)(),hn=Object(it.a)(dn),fn=Object(Se.a)(hn),pn=Object(ke.a)(dn),mn=Object(oe.a)(fn,pn,hn),gn=Object(Be.a)(mn),vn=Object(Pe.a)(cn,he.a,gn),yn=Object(ie.a)(Xt.a),_n=Object(Tt.a)(Xt.a,yn,rn.a),bn=Object(d.a)(vn,Zt.a,_n),En=new WeakMap,Tn=Object(se.a)(qt.g),Sn=new WeakMap,wn=Object($.a)(ln.a),An=Object(_e.a)(pn),xn=Object(be.a)(dn),Mn=Object(Ee.a)(dn),Cn=Object(_.a)(Object(a.a)(qt.b),En,cn,Object(de.a)(qt.h,Kt.a,Xt.a,Zt.a,Jt.a,tn.a),he.a,fe.a,pt.a,Object(V.a)(Yt.a,qt.h,Xt.a,Zt.a,Jt.a,Tn,tn.a,fn),Object(Y.a)(Sn,Xt.a,$t.a),wn,Tn,An,xn,Mn,fn),Rn=Object(c.a)(Cn,bn,he.a,vn,Tn,fn),In=new WeakSet,On=Object(Le.a)(dn),Dn=Object(F.a)(new Uint32Array(1)),Pn=Object(Gt.a)(Dn,he.a),Ln=Object(Ht.a)(Dn),Nn=Object(h.a)(In,cn,pt.a,On,hn,Object(Ct.a)(On),Pn,Ln),kn=Object(Ze.a)(gn),Fn=Object(u.a)(kn),Bn=Object(Pt.a)(gn),Un=Object(Lt.a)(gn),jn=Object(Nt.a)(gn),Gn=Object(zt.a)(gn),Hn=Object(St.a)(yn,Qt.a,rn.a),Vn=Object(D.a)(Hn),zn=Object(Ne.a)(Fn,cn,gn,Object(Rt.a)(gn),Object(It.a)(hn),Object(Ot.a)(gn),Object(Dt.a)(gn),Bn,Un,jn,un.a,Object(Vt.a)(an.a),Gn),Wn=Object(Et.a)(Object(ae.a)(Qt.a),Hn),qn=Object(p.a)(Vn,zn,Zt.a,Wn,_n),Yn=Object(b.a)(Object(o.a)(qt.d),Sn,qt.e,E.a,r.createCancelAndHoldAutomationEvent,r.createCancelScheduledValuesAutomationEvent,r.createExponentialRampToValueAutomationEvent,r.createLinearRampToValueAutomationEvent,r.createSetTargetAutomationEvent,r.createSetValueAutomationEvent,r.createSetValueCurveAutomationEvent,pn),Kn=Object(f.a)(Cn,qn,Yn,pe.a,zn,Tn,fn,ln.a),Xn=Object(g.a)(Cn,v.a,he.a,pe.a,Object(Fe.a)(kn,an.a),Tn,fn,_n),Qn=Object(He.a)(gn),Zn=Object(x.a)(Vn,Qn,Zt.a,Wn,_n),Jn=Object(A.a)(Cn,Yn,Zn,fe.a,Qn,Tn,fn),$n=Object(De.a)(en.a,xn),er=Object(Wt.a)(pe.a,gn,$n),tr=Object(Ve.a)(gn,er),nr=Object(R.a)(tr,Zt.a,_n),rr=Object(C.a)(Cn,nr,tr,Tn,fn),ir=Object(ze.a)(gn),ar=Object(O.a)(ir,Zt.a,_n),or=Object(I.a)(Cn,ar,ir,Tn,fn),sr=Object(qe.a)(Fn,zn,kn,$n),ur=Object(We.a)(Fn,cn,gn,sr,Bn,jn),lr=Object(k.a)(Vn,ur,Zt.a,Wn,_n),cr=Object(N.a)(Cn,Yn,lr,ur,Tn,fn,ln.a),dr=Object(Ke.a)(gn,kn,$n),hr=Object(Ye.a)(gn,dr,pt.a,an.a),fr=Object(U.a)(hr,Zt.a,_n),pr=Object(B.a)(Cn,fr,hr,Tn,fn),mr=Object(Xe.a)(gn),gr=Object(W.a)(Vn,mr,Zt.a,Wn,_n),vr=Object(z.a)(Cn,Yn,gr,mr,Tn,fn),yr=Object(Qe.a)(gn,pt.a),_r=Object(Q.a)(Vn,yr,Zt.a,Wn,_n),br=Object(X.a)(Cn,Yn,_r,yr,pt.a,Tn,fn),Er=Object(re.a)(Vn,kn,Zt.a,Wn,_n),Tr=Object(ne.a)(Cn,Yn,Er,kn,Tn,fn),Sr=Object(lt.a)(gn),wr=Object($e.a)(fe.a,pe.a,Sr,pt.a),Ar=Object(wt.a)(cn,kn,Sr,Object(kt.a)(kn,hn)),xr=Object(ce.a)(zn,gn,Zt.a,hn,_n,Ar),Mr=Object(Je.a)(gn,wr),Cr=Object(le.a)(Cn,Mr,xr,Tn,fn),Rr=Object(y.a)(Yn,tr,ur,Sr,fn),Ir=new WeakMap,Or=Object(Ie.a)(Xn,Rr,wn,fn,Ir,ln.a),Dr=Object(at.a)(Fn,cn,gn,Bn,Un,jn,Gn),Pr=Object(vt.a)(Vn,Dr,Zt.a,Wn,_n),Lr=Object(gt.a)(Cn,Yn,pe.a,Dr,Pr,Tn,fn,ln.a),Nr=Object(L.a)(zn),kr=Object(ft.a)(Nr,pe.a,gn,kn,nn.a,$n),Fr=Object(ht.a)(Nr,pe.a,gn,kr,nn.a,$n,an.a),Br=Object(st.a)(Yt.a,pe.a,gn,tr,kn,Sr,Fr,pt.a,Kt.a,$n),Ur=Object(ot.a)(gn,Br),jr=Object(_t.a)(Vn,tr,ur,kn,Ur,Zt.a,hn,Wn,_n,Ar),Gr=Object(yt.a)(Cn,Yn,Ur,jr,Tn,fn),Hr=Object(ut.a)(mn),Vr=Object(bt.a)(Hr,Tn,new WeakSet),zr=Object(dt.a)(tr,ir,kn,Fr,pt.a,$n),Wr=Object(ct.a)(gn,zr,pt.a),qr=Object(Mt.a)(Vn,Wr,Zt.a,Wn,_n),Yr=Object(xt.a)(Cn,Yn,Wr,qr,Tn,fn),Kr=Object(Ut.a)(Fr,Zt.a,_n),Xr=Object(Bt.a)(Cn,pe.a,Fr,Kr,Tn,fn),Qr=Object(we.a)(dn),Zr=Object(ee.a)(dn),Jr=Qr?Object(s.a)(pt.a,Object(J.a)(dn),Zr,Object(te.a)(i.a),mn,Tn,new WeakMap,new WeakMap,dn):void 0,$r=Object(Te.a)(An,fn),ei=Object(H.a)(In,cn,G.a,Z.a,new WeakSet,Tn,$r,fn,hn,on.a,sn.a,Pn,Ln),ti=Object(w.a)(Jr,Rn,Nn,Kn,Jn,rr,or,cr,pr,ei,vr,br,Tr,Cr,Or,Lr,Gr,Vr,Yr,Xr),ni=Object(et.a)(gn),ri=Object(Ae.a)(Cn,ni,Tn,fn),ii=Object(tt.a)(gn,pt.a),ai=Object(xe.a)(Cn,ii,Tn,fn),oi=Object(nt.a)(gn),si=Object(Me.a)(Cn,oi,Tn,fn),ui=Object(rt.a)(pe.a,gn,fn),li=Object(Ce.a)(Cn,ui,Tn),ci=Object(m.a)(ti,pe.a,pt.a,Ft.a,ri,ai,si,li,pn),di=Object(ue.a)(Ir),hi=Object(l.a)(di),fi=Object(P.a)(he.a),pi=Object(q.a)(di),mi=Object(K.a)(he.a),gi=Object(Ge.a)(En,fi,he.a,pe.a,tr,ir,ur,kn,Sr,pt.a,mi,Zr,$n),vi=Object(je.a)(pe.a,gn,gi,kn,pt.a,$n),yi=Object(Ue.a)(dn),_i=Object(S.a)(Vn,fi,zn,tr,ir,ur,kn,pi,mi,Zr,Zt.a,yi,hn,Wn,_n,Ar),bi=Qr?Object(T.a)(hi,Cn,Yn,_i,vi,Tn,fn,yi,ln.a):void 0,Ei=(Object(Re.a)(pe.a,pt.a,Ft.a,Or,pn),Object(j.a)(pt.a,hn)),Ti=Object(At.a)(In,cn,yn,di,Ar,on.a,Pn,Ln),Si=(Object(Oe.a)(cn,pe.a,Ei,Or,Ti),Object(mt.a)(ti,cn,pe.a,Ei,Ti)),wi=Object(me.a)(qt.g,An),Ai=Object(ge.a)(qt.c,xn),xi=Object(ve.a)(qt.e,Mn),Mi=Object(ye.a)(qt.g,fn)},function(e,t,n){"use strict";const r="14.7.39";var i=n(41);function a(e,t){if(!e)throw new Error(t)}function o(e,t,n=1/0){if(!(t<=e&&e<=n))throw new RangeError(`Value must be within [${t}, ${n}], got: ${e}`)}function s(e){e.isOffline||"running"===e.state||l('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let u=console;function l(...e){u.warn(...e)}function c(e){return void 0===e}function d(e){return!c(e)}function h(e){return"number"==typeof e}function f(e){return"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object}function p(e){return"boolean"==typeof e}function m(e){return Array.isArray(e)}function g(e){return"string"==typeof e}function v(e){return g(e)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(e)}const y="object"==typeof self?self:null,_=y&&(y.hasOwnProperty("AudioContext")||y.hasOwnProperty("webkitAudioContext"));function b(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}function E(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))}class T{constructor(e,t,n){this._callback=e,this._type=t,this._updateInterval=n,this._createClock()}_createWorker(){const e=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(e){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){this._updateInterval=Math.max(e,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*e,1))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function S(e){return Object(i.isAnyAudioParam)(e)}function w(e){return Object(i.isAnyAudioNode)(e)}function A(e){return Object(i.isAnyOfflineAudioContext)(e)}function x(e){return Object(i.isAnyAudioContext)(e)}function M(e){return e instanceof AudioBuffer}function C(e,t){return"value"===e||S(t)||w(t)||M(t)}function R(e,...t){if(!t.length)return e;const n=t.shift();if(f(e)&&f(n))for(const t in n)C(t,n[t])?e[t]=n[t]:f(n[t])?(e[t]||Object.assign(e,{[t]:{}}),R(e[t],n[t])):Object.assign(e,{[t]:n[t]});return R(e,...t)}function I(e,t,n=[],r){const i={},a=Array.from(t);if(f(a[0])&&r&&!Reflect.has(a[0],r)){Object.keys(a[0]).some(t=>Reflect.has(e,t))||(R(i,{[r]:a[0]}),n.splice(n.indexOf(r),1),a.shift())}if(1===a.length&&f(a[0]))R(i,a[0]);else for(let e=0;e<n.length;e++)d(a[e])&&(i[n[e]]=a[e]);return R(e,i)}function O(e,t){return c(e)?t:e}function D(e,t){return t.forEach(t=>{Reflect.has(e,t)&&delete e[t]}),e}class P{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||y&&this.toString()===y.TONE_DEBUG_CLASS)&&function(...e){u.log(...e)}(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}P.version=r;const L=1e-6;function N(e,t){return e>t+L}function k(e,t){return N(e,t)||B(e,t)}function F(e,t){return e+L<t}function B(e,t){return Math.abs(e-t)<L}function U(e,t,n){return Math.max(Math.min(e,n),t)}class j extends P{constructor(){super(),this.name="Timeline",this._timeline=[];const e=I(j.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(a(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];a(k(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(e){const t=this._timeline.indexOf(e);return-1!==t&&this._timeline.splice(t,1),this}get(e,t="time"){const n=this._search(e,t);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const n=this._search(e,t);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const n=this._search(e);return n-1>=0?this._timeline[n-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(B(this._timeline[t].time,e)){for(let n=t;n>=0&&B(this._timeline[n].time,e);n--)t=n;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else 1===this._timeline.length&&k(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(0===this._timeline.length)return-1;let n=0;const r=this._timeline.length;let i=r;if(r>0&&this._timeline[r-1][t]<=e)return r-1;for(;n<i;){let r=Math.floor(n+(i-n)/2);const a=this._timeline[r],o=this._timeline[r+1];if(B(a[t],e)){for(let n=r;n<this._timeline.length;n++){if(!B(this._timeline[n][t],e))break;r=n}return r}if(F(a[t],e)&&N(o[t],e))return r;N(a[t],e)?i=r:n=r+1}return-1}_iterate(e,t=0,n=this._timeline.length-1){this._timeline.slice(t,n+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const n=this._search(e);return-1!==n&&this._iterate(t,0,n),this}forEachAfter(e,t){const n=this._search(e);return this._iterate(t,n+1),this}forEachBetween(e,t,n){let r=this._search(e),i=this._search(t);return-1!==r&&-1!==i?(this._timeline[r].time!==e&&(r+=1),this._timeline[i].time===t&&(i-=1),this._iterate(n,r,i)):-1===r&&this._iterate(n,0,i),this}forEachFrom(e,t){let n=this._search(e);for(;n>=0&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this}forEachAtTime(e,t){const n=this._search(e);if(-1!==n&&B(this._timeline[n].time,e)){let r=n;for(let t=n;t>=0&&B(this._timeline[t].time,e);t--)r=t;this._iterate(e=>{t(e)},r,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const G=[];function H(e){G.push(e)}const V=[];function z(e){V.push(e)}class W extends P{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(e=>{c(this._events)&&(this._events={}),this._events.hasOwnProperty(e)||(this._events[e]=[]),this._events[e].push(t)}),this}once(e,t){const n=(...r)=>{t(...r),this.off(e,n)};return this.on(e,n),this}off(e,t){return e.split(/\W+/).forEach(n=>{if(c(this._events)&&(this._events={}),this._events.hasOwnProperty(e))if(c(t))this._events[e]=[];else{const n=this._events[e];for(let e=0;e<n.length;e++)n[e]===t&&n.splice(e,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const n=this._events[e].slice(0);for(let e=0,r=n.length;e<r;e++)n[e].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const n=Object.getOwnPropertyDescriptor(W.prototype,t);Object.defineProperty(e.prototype,t,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class q extends W{constructor(){super(...arguments),this.isOffline=!1}}class Y extends q{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new j,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const e=I(Y.getDefaults(),arguments,["context"]);e.context?this._context=e.context:this._context=function(e){return new i.AudioContext(e)}({latencyHint:e.latencyHint}),this._ticker=new T(this.emit.bind(this,"tick"),e.clockSource,e.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(e.latencyHint),this.lookAhead=e.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var e;return this._initialized||(e=this,G.forEach(t=>t(e)),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,n){return this._context.createBuffer(e,t,n)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,n){return this._context.createPeriodicWave(e,t,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){a(x(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamSource(e)}createMediaStreamDestination(){a(x(this._context),"Not available if OfflineAudioContext");return this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){a(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){a(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){a(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){a(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return function(e,t,n){return a(d(i.AudioWorkletNode),"This node only works in a secure context (https or localhost)"),new i.AudioWorkletNode(e,t,n)}(this.rawContext,e,t)}addAudioWorkletModule(e,t){return E(this,void 0,void 0,(function*(){a(d(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(t)||this._workletModules.set(t,this.rawContext.audioWorklet.addModule(e)),yield this._workletModules.get(t)}))}workletsAreReady(){return E(this,void 0,void 0,(function*(){const e=[];this._workletModules.forEach(t=>e.push(t)),yield Promise.all(e)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get latencyHint(){return this._latencyHint}_setLatencyHint(e){let t=0;if(this._latencyHint=e,g(e))switch(e){case"interactive":t=.1;break;case"playback":t=.5;break;case"balanced":t=.25}this.lookAhead=t,this.updateInterval=t/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return"suspended"===this._context.state&&x(this._context)?this._context.resume():Promise.resolve()}close(){return E(this,void 0,void 0,(function*(){var e;x(this._context)&&(yield this._context.close()),this._initialized&&(e=this,V.forEach(t=>t(e)))}))}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),n=t.getChannelData(0);for(let t=0;t<n.length;t++)n[t]=e;const r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=t,r.loop=!0,r.start(0),this._constants.set(e,r),r}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this}_timeoutLoop(){const e=this.now();let t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:n+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const n=++this._timeoutIds,r=()=>{const i=this.now();this._timeouts.add({callback:()=>{e(),r()},id:n,time:i+t})};return r(),n}}function K(e,t){m(t)?t.forEach(t=>K(e,t)):Object.defineProperty(e,t,{enumerable:!0,writable:!1})}function X(e,t){m(t)?t.forEach(t=>X(e,t)):Object.defineProperty(e,t,{writable:!0})}const Q=()=>{};class Z extends P{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Q;const e=I(Z.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,e.url&&M(e.url)||e.url instanceof Z?this.set(e.url):g(e.url)&&this.load(e.url).catch(e.onerror)}static getDefaults(){return{onerror:Q,onload:Q,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:te().sampleRate}set(e){return e instanceof Z?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return E(this,void 0,void 0,(function*(){const t=Z.load(e).then(e=>{this.set(e),this.onload(this)});Z.downloads.push(t);try{yield t}finally{const e=Z.downloads.indexOf(t);Z.downloads.splice(e,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=m(e)&&e[0].length>0,n=t?e.length:1,r=t?e[0].length:e.length,i=te(),a=i.createBuffer(n,r,i.sampleRate),o=t||1!==n?e:[e];for(let e=0;e<n;e++)a.copyToChannel(o[e],e);return this._buffer=a,this}toMono(e){if(h(e))this.fromArray(this.toArray(e));else{let e=new Float32Array(this.length);const t=this.numberOfChannels;for(let n=0;n<t;n++){const t=this.toArray(n);for(let n=0;n<t.length;n++)e[n]+=t[n]}e=e.map(e=>e/t),this.fromArray(e)}return this}toArray(e){if(h(e))return this.getChannelData(e);if(1===this.numberOfChannels)return this.toArray(0);{const e=[];for(let t=0;t<this.numberOfChannels;t++)e[t]=this.getChannelData(t);return e}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){const n=Math.floor(e*this.sampleRate),r=Math.floor(t*this.sampleRate);a(n<r,"The start time must be less than the end time");const i=r-n,o=te().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let e=0;e<this.numberOfChannels;e++)o.copyToChannel(this.getChannelData(e).subarray(n,r),e);return new Z(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return(new Z).fromArray(e)}static fromUrl(e){return E(this,void 0,void 0,(function*(){const t=new Z;return yield t.load(e)}))}static load(e){return E(this,void 0,void 0,(function*(){const t=e.match(/\[(.+\|?)+\]$/);if(t){const n=t[1].split("|");let r=n[0];for(const e of n)if(Z.supportsType(e)){r=e;break}e=e.replace(t[0],r)}const n=""===Z.baseUrl||Z.baseUrl.endsWith("/")?Z.baseUrl:Z.baseUrl+"/",r=yield fetch(n+e);if(!r.ok)throw new Error("could not load url: "+e);const i=yield r.arrayBuffer();return yield te().decodeAudioData(i)}))}static supportsType(e){const t=e.split("."),n=t[t.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return E(this,void 0,void 0,(function*(){for(yield Promise.resolve();Z.downloads.length;)yield Z.downloads[0]}))}}Z.baseUrl="",Z.downloads=[];class J extends Y{constructor(){var e,t,n;super({clockSource:"offline",context:A(arguments[0])?arguments[0]:(e=arguments[0],t=arguments[1]*arguments[2],n=arguments[2],new i.OfflineAudioContext(e,t,n)),lookAhead:0,updateInterval:A(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=A(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return E(this,void 0,void 0,(function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const n=Math.floor(this.sampleRate/128);e&&t%n==0&&(yield new Promise(e=>setTimeout(e,1)))}}))}render(e=!0){return E(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new Z(t)}))}close(){return Promise.resolve()}}const $=new class extends q{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,n){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e,t){return E(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}};let ee=$;function te(){return ee===$&&_&&ne(new Y),ee}function ne(e){ee=x(e)?new Y(e):A(e)?new J(e):e}if(y&&!y.TONE_SILENCE_LOGGING){let e="v";0;const t=` * Tone.js ${e}14.7.39 * `;console.log("%c"+t,"background: #000; color: #fff")}function re(e){return Math.pow(10,e/20)}function ie(e){return Math.log(e)/Math.LN10*20}function ae(e){return Math.pow(2,e/12)}let oe=440;function se(e){return Math.round(ue(e))}function ue(e){return 69+12*Math.log2(e/oe)}function le(e){return oe*Math.pow(2,(e-69)/12)}class ce extends P{constructor(e,t,n){super(),this.defaultUnits="s",this._val=t,this._units=n,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const n=parseInt(e,10),r="."===t?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*r:this._beatsToUnits(4/n)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(3*Math.floor(t)))},regexp:/^(\d+)t$/i},tr:{method:(e,t,n)=>{let r=0;return e&&"0"!==e&&(r+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(r+=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(r+=this._beatsToUnits(parseFloat(n)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof ce&&this.fromType(this._val),c(this._val))return this._noArg();if(g(this._val)&&c(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(f(this._val)){let e=0;for(const t in this._val)if(d(this._val[t])){const n=this._val[t];e+=new this.constructor(this.context,t).valueOf()*n}return e}if(d(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}return g(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class de extends ce{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new de(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const n=new this.constructor(this.context,e).valueOf(),r=this.valueOf();return r+(Math.round(r/n)*n-r)*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let e=1;e<9;e++){const n=Math.pow(2,e);t.push(n+"n."),t.push(n+"n"),t.push(n+"t")}t.push("0");let n=t[0],r=new de(this.context,t[0]).toSeconds();return t.forEach(t=>{const i=new de(this.context,t).toSeconds();Math.abs(i-e)<Math.abs(r-e)&&(n=t,r=i)}),n}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const n=Math.floor(t/this._getTimeSignature());let r=t%1*4;t=Math.floor(t)%this._getTimeSignature();const i=r.toString();i.length>3&&(r=parseFloat(parseFloat(i).toFixed(3)));return[n,t,r].join(":")}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.round(t*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return se(this.toFrequency())}_now(){return this.context.now()}}class he extends de{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return oe}static set A4(e){!function(e){oe=e}(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return"midi"===this.defaultUnits?e:he.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(e,t){const n=fe[e.toLowerCase()]+12*(parseInt(t,10)+1);return"midi"===this.defaultUnits?n:he.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,n){let r=1;return e&&"0"!==e&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(r*=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(r*=this._beatsToUnits(parseFloat(n)/4)),r}}})}transpose(e){return new he(this.context,this.valueOf()*ae(e))}harmonize(e){return e.map(e=>this.transpose(e))}toMidi(){return se(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/he.A4);let n=Math.round(12*t)+57;const r=Math.floor(n/12);r<0&&(n+=-12*r);return pe[n%12]+r.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(60*e/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return le(e)}static ftom(e){return se(e)}}const fe={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},pe=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class me extends de{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class ge extends P{constructor(){super();const e=I(ge.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:te()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return new de(this.context,e).toSeconds()}toFrequency(e){return new he(this.context,e).toFrequency()}toTicks(e){return new me(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(n=>{c(e[n])&&delete t[n]}),t}get(){const e=this.constructor.getDefaults();return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const n=this[t];d(n)&&d(n.value)&&d(n.setValueAtTime)?e[t]=n.value:n instanceof ge?e[t]=n._getPartialProperties(e[t]):m(n)||h(n)||g(n)||p(n)?e[t]=n:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&d(this[t])&&(this[t]&&d(this[t].value)&&d(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof ge?this[t].set(e[t]):this[t]=e[t])}),this}}class ve extends j{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return null!==t?t.state:this._initial}setStateAtTime(e,t,n){return o(t,0),this.add(Object.assign({},n,{state:e,time:t})),this}getLastState(e,t){for(let n=this._search(t);n>=0;n--){const t=this._timeline[n];if(t.state===e)return t}}getNextState(e,t){const n=this._search(t);if(-1!==n)for(let t=n;t<this._timeline.length;t++){const n=this._timeline[t];if(n.state===e)return n}}}class ye extends ge{constructor(){super(I(ye.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const e=I(ye.getDefaults(),arguments,["param","units","convert"]);for(a(d(e.param)&&(S(e.param)||e.param instanceof ye),"param must be an AudioParam");!S(e.param);)e.param=e.param._param;this._swappable=!!d(e.swappable)&&e.swappable,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new j(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,d(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ge.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return d(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return d(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return d(this.maxValue)&&d(this.minValue)&&o(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?re(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&"decibels"===this.units?ie(e):e}setValueAtTime(e,t){const n=this.toSeconds(t),r=this._fromType(e);return a(isFinite(r)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(r),this.log(this.units,"setValueAtTime",e,n),this._events.add({time:n,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,n),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),n=this._events.getAfter(t),r=this._events.get(t);let i=this._initialValue;if(null===r)i=this._initialValue;else if("setTargetAtTime"!==r.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)i=r.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let e=r.value;if("setTargetAtTime"===r.type){const t=this._events.getBefore(r.time);e=null===t?this._initialValue:t.value}i="linearRampToValueAtTime"===n.type?this._linearInterpolate(r.time,e,n.time,n.value,t):this._exponentialInterpolate(r.time,e,n.time,n.value,t)}else i=r.value;else{const e=this._events.getBefore(r.time);let n;n=null===e?this._initialValue:e.value,"setTargetAtTime"===r.type&&(i=this._exponentialApproach(r.time,n,r.value,r.constant,t))}return this._toType(i)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),0===this._fromType(t)&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const n=this._fromType(e),r=this.toSeconds(t);return a(isFinite(n)&&isFinite(r),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(n),this._events.add({time:r,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(n,r),this}exponentialRampToValueAtTime(e,t){let n=this._fromType(e);n=Math.max(this._minOutput,n),this._assertRange(n);const r=this.toSeconds(t);return a(isFinite(n)&&isFinite(r),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(n,r),this}exponentialRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this}linearRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this}targetRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(e,n,t),this}exponentialApproachValueAtTime(e,t,n){t=this.toSeconds(t),n=this.toSeconds(n);const r=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(e,t,r),this.cancelAndHoldAtTime(t+.9*n),this.linearRampToValueAtTime(e,t+n),this}setTargetAtTime(e,t,n){const r=this._fromType(e);a(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(t);return this._assertRange(r),a(isFinite(r)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:n,time:i,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,i,n),this._param.setTargetAtTime(r,i,n),this}setValueCurveAtTime(e,t,n,r=1){n=this.toSeconds(n),t=this.toSeconds(t);const i=this._fromType(e[0])*r;this.setValueAtTime(this._toType(i),t);const a=n/(e.length-1);for(let n=1;n<e.length;n++){const i=this._fromType(e[n])*r;this.linearRampToValueAtTime(this._toType(i),t+n*a)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return a(isFinite(t),"Invalid argument to cancelScheduledValues: "+JSON.stringify(e)),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),n=this._fromType(this.getValueAtTime(t));a(isFinite(t),"Invalid argument to cancelAndHoldAtTime: "+JSON.stringify(e)),this.log(this.units,"cancelAndHoldAtTime",t,"value="+n);const r=this._events.get(t),i=this._events.getAfter(t);return r&&B(r.time,t)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),"linearRampToValueAtTime"===i.type?this.linearRampToValueAtTime(this._toType(n),t):"exponentialRampToValueAtTime"===i.type&&this.exponentialRampToValueAtTime(this._toType(n),t)),this._events.add({time:t,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,t),this}rampTo(e,t=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(e,t,n):this.linearRampTo(e,t,n),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const n=this._events.get(t);if(n&&"setTargetAtTime"===n.type){const r=this._events.getAfter(n.time),i=r?r.time:t+2,a=(i-t)/10;for(let n=t;n<i;n+=a)e.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,t=>{"cancelScheduledValues"===t.type?e.cancelScheduledValues(t.time):"setTargetAtTime"===t.type?e.setTargetAtTime(t.value,t.time,t.constant):e[t.type](t.value,t.time)}),this}setParam(e){a(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,n,r,i){return n+(t-n)*Math.exp(-(i-e)/r)}_linearInterpolate(e,t,n,r,i){return t+(i-e)/(n-e)*(r-t)}_exponentialInterpolate(e,t,n,r,i){return t*Math.pow(r/t,(i-e)/(n-e))}}class _e extends ge{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return d(this.input)?S(this.input)||this.input instanceof ye?1:this.input.numberOfInputs:0}get numberOfOutputs(){return d(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return d(e)&&(e instanceof _e||w(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(t=>{t.channelCount=e.channelCount,t.channelCountMode=e.channelCountMode,t.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();a(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,n=0){return Ee(this,e,t,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return l("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,n=0){return Te(this,e,t,n),this}chain(...e){return be(this,...e),this}fan(...e){return e.forEach(e=>this.connect(e)),this}dispose(){return super.dispose(),d(this.input)&&(this.input instanceof _e?this.input.dispose():w(this.input)&&this.input.disconnect()),d(this.output)&&(this.output instanceof _e?this.output.dispose():w(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function be(...e){const t=e.shift();e.reduce((e,t)=>(e instanceof _e?e.connect(t):w(e)&&Ee(e,t),t),t)}function Ee(e,t,n=0,r=0){for(a(d(e),"Cannot connect from undefined node"),a(d(t),"Cannot connect to undefined node"),(t instanceof _e||w(t))&&a(t.numberOfInputs>0,"Cannot connect to node with no inputs"),a(e.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof _e||t instanceof ye;)d(t.input)&&(t=t.input);for(;e instanceof _e;)d(e.output)&&(e=e.output);S(t)?e.connect(t,n):e.connect(t,n,r)}function Te(e,t,n=0,r=0){if(d(t))for(;t instanceof _e;)t=t.input;for(;!w(e);)d(e.output)&&(e=e.output);S(t)?e.disconnect(t,n):w(t)?e.disconnect(t,n,r):e.disconnect()}class Se extends _e{constructor(){super(I(Se.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const e=I(Se.getDefaults(),arguments,["gain","units"]);this.gain=new ye({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),K(this,"gain")}static getDefaults(){return Object.assign(_e.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class we extends _e{constructor(e){super(e),this.onended=Q,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Se({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){const t=this.toSeconds(e);return-1!==this._startTime&&t>=this._startTime&&(-1===this._stopTime||t<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(_e.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Q})}_startGain(e,t=1){a(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=e+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,e),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(t,e+n):this._gainNode.gain.exponentialApproachValueAtTime(t,e,n)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){a(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.context.currentTime),t>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const e="exponential"===this._curve?2*t:0;this._stopSource(this.now()+e),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Q&&(this.onended(this),this.onended=Q,!this.context.isOffline)){const e=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),a(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class Ae extends we{constructor(){super(I(Ae.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const e=I(Ae.getDefaults(),arguments,["offset"]);Ee(this._source,this._gainNode),this.offset=new ye({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(we.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class xe extends _e{constructor(){super(I(xe.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const e=I(xe.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Ae({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(_e.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,n=0){return Me(this,e,t,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,n){return this._param.exponentialRampTo(e,t,n),this}linearRampTo(e,t,n){return this._param.linearRampTo(e,t,n),this}targetRampTo(e,t,n){return this._param.targetRampTo(e,t,n),this}exponentialApproachValueAtTime(e,t,n){return this._param.exponentialApproachValueAtTime(e,t,n),this}setTargetAtTime(e,t,n){return this._param.setTargetAtTime(e,t,n),this}setValueCurveAtTime(e,t,n,r){return this._param.setValueCurveAtTime(e,t,n,r),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,n){return this._param.rampTo(e,t,n),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function Me(e,t,n,r){(t instanceof ye||S(t)||t instanceof xe&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof xe&&(t.overridden=!0)),Ee(e,t,n,r)}class Ce extends ye{constructor(){super(I(Ce.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new j(1/0),this._multiplier=1;const e=I(Ce.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(ye.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,n){t=this.toSeconds(t),this.setRampPoint(t);const r=this._fromType(e),i=this._events.get(t),a=Math.round(Math.max(1/n,1));for(let e=0;e<=a;e++){const a=n*e+t,o=this._exponentialApproach(i.time,i.value,r,n,a);this.linearRampToValueAtTime(this._toType(o),a)}return this}setValueAtTime(e,t){const n=this.toSeconds(t);super.setValueAtTime(e,t);const r=this._events.get(n),i=this._events.previousEvent(r),a=this._getTicksUntilEvent(i,n);return r.ticks=Math.max(a,0),this}linearRampToValueAtTime(e,t){const n=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const r=this._events.get(n),i=this._events.previousEvent(r),a=this._getTicksUntilEvent(i,n);return r.ticks=Math.max(a,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const n=this._fromType(e),r=this._events.get(t),i=Math.round(Math.max(10*(t-r.time),1)),a=(t-r.time)/i;for(let e=0;e<=i;e++){const i=a*e+r.time,o=this._exponentialInterpolate(r.time,r.value,t,n,i);this.linearRampToValueAtTime(this._toType(o),i)}return this}_getTicksUntilEvent(e,t){if(null===e)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(c(e.ticks)){const t=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(t,e.time)}const n=this._fromType(this.getValueAtTime(e.time));let r=this._fromType(this.getValueAtTime(t));const i=this._events.get(t);return i&&i.time===t&&"setValueAtTime"===i.type&&(r=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(n+r)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),n=this._events.get(t);return Math.max(this._getTicksUntilEvent(n,t),0)}getDurationOfTicks(e,t){const n=this.toSeconds(t),r=this.getTicksAtTime(t);return this.getTimeOfTick(r+e)-n}getTimeOfTick(e){const t=this._events.get(e,"ticks"),n=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&n&&"linearRampToValueAtTime"===n.type&&t.value!==n.value){const r=this._fromType(this.getValueAtTime(t.time)),i=(this._fromType(this.getValueAtTime(n.time))-r)/(n.time-t.time),a=Math.sqrt(Math.pow(r,2)-2*i*(t.ticks-e)),o=(-r+a)/i,s=(-r-a)/i;return(o>0?o:s)+t.time}return t?0===t.value?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const n=this.toSeconds(t),r=this.toSeconds(e),i=this.getTicksAtTime(n);return this.getTicksAtTime(n+r)-i}_fromType(e){return"bpm"===this.units&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return"bpm"===this.units&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class Re extends xe{constructor(){super(I(Re.getDefaults(),arguments,["value"])),this.name="TickSignal";const e=I(Re.getDefaults(),arguments,["value"]);this.input=this._param=new Ce({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(xe.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class Ie extends ge{constructor(){super(I(Ie.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new ve,this._tickOffset=new j;const e=I(Ie.getDefaults(),arguments,["frequency"]);this.frequency=new Re({context:this.context,units:e.units,value:e.frequency}),K(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},ge.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const n=this.toSeconds(e);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),d(t)&&this.setTicksAtTime(t,n)),this}stop(e){const t=this.toSeconds(e);if("stopped"===this._state.getValueAtTime(t)){const e=this._state.get(t);e&&e.time>0&&(this._tickOffset.cancel(e.time),this._state.cancel(e.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this}pause(e){const t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&this._state.setStateAtTime("paused",t),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),n=this._state.getLastState("stopped",t),r={state:"paused",time:t};this._state.add(r);let i=n,a=0;return this._state.forEachBetween(n.time,t+this.sampleTime,e=>{let t=i.time;const n=this._tickOffset.get(e.time);n&&n.time>=i.time&&(a=n.ticks,t=n.time),"started"===i.state&&"started"!==e.state&&(a+=this.frequency.getTicksAtTime(e.time)-this.frequency.getTicksAtTime(t)),i=e}),this._state.remove(r),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),n=this.frequency.timeToTicks(e,t);this.setTicksAtTime(n,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);let r=t,i=0;return this._state.forEachBetween(t.time,e+this.sampleTime,e=>{let t=r.time;const n=this._tickOffset.get(e.time);n&&n.time>=r.time&&(i=n.seconds,t=n.time),"started"===r.state&&"started"!==e.state&&(i+=e.time-t),r=e}),this._state.remove(n),i}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const n=this._tickOffset.get(t),r=this._state.get(t),i=Math.max(n.time,r.time),a=this.frequency.getTicksAtTime(i)+e-n.ticks;return this.frequency.getTimeOfTick(a)}forEachTickBetween(e,t,n){let r=this._state.get(e);this._state.forEachBetween(e,t,t=>{r&&"started"===r.state&&"started"!==t.state&&this.forEachTickBetween(Math.max(r.time,e),t.time-this.sampleTime,n),r=t});let i=null;if(r&&"started"===r.state){const a=Math.max(r.time,e),o=this.frequency.getTicksAtTime(a),s=o-this.frequency.getTicksAtTime(r.time);let u=Math.ceil(s)-s;u=B(u,1)?0:u;let l=this.frequency.getTimeOfTick(o+u);for(;l<t;){try{n(l,Math.round(this.getTicksAtTime(l)))}catch(e){i=e;break}l+=this.frequency.getDurationOfTicks(1,l)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class Oe extends ge{constructor(){super(I(Oe.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Q,this._lastUpdate=0,this._state=new ve("stopped"),this._boundLoop=this._loop.bind(this);const e=I(Oe.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new Ie({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,K(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(ge.getDefaults(),{callback:Q,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){s(this.context);const n=this.toSeconds(e);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,t),n<this._lastUpdate&&this.emit("start",n,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const n=this.toSeconds(t),r=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(r+e,n)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,e=>{switch(e.state){case"started":const t=this._tickSource.getTicksAtTime(e.time);this.emit("start",e.time,t);break;case"stopped":0!==e.time&&this.emit("stop",e.time);break;case"paused":this.emit("pause",e.time)}}),this._tickSource.forEachTickBetween(e,t,(e,t)=>{this.callback(e,t)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}W.mixin(Oe);class De extends P{constructor(e){super(),this.name="TimelineValue",this._timeline=new j({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class Pe extends me{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class Le extends P{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){a(d(e.time),"Events must have a time property"),a(d(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new Ne(e.time,e.time+e.duration,e);for(null===this._root?this._root=t:this._root.insert(t),this._length++;null!==t;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(null!==this._root){const t=[];this._root.search(e.time,t);for(const n of t)if(n.event===e){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,e=>this.remove(e)),this}_setRoot(e){this._root=e,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(e,t){null!==e.parent?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(null===e.left&&null===e.right)this._replaceNodeInParent(e,null);else if(null===e.right)this._replaceNodeInParent(e,e.left);else if(null===e.left)this._replaceNodeInParent(e,e.right);else{let t,n=null;if(e.getBalance()>0)if(null===e.left.right)t=e.left,t.right=e.right,n=t;else{for(t=e.left.right;null!==t.right;)t=t.right;t.parent&&(t.parent.right=t.left,n=t.parent,t.left=e.left,t.right=e.right)}else if(null===e.right.left)t=e.right,t.left=e.left,n=t;else{for(t=e.right.left;null!==t.left;)t=t.left;t.parent&&(t.parent.left=t.right,n=t.parent,t.left=e.left,t.right=e.right)}null!==e.parent?e.isLeftChild()?e.parent.left=t:e.parent.right=t:this._setRoot(t),n&&this._rebalance(n)}e.dispose()}_rotateLeft(e){const t=e.parent,n=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),null!==t?n?t.left=r:t.right=r:this._setRoot(r)}_rotateRight(e){const t=e.parent,n=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),null!==t?n?t.left=r:t.right=r:this._setRoot(r)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(null!==this._root){const t=[];if(this._root.search(e,t),t.length>0){let e=t[0];for(let n=1;n<t.length;n++)t[n].low>e.low&&(e=t[n]);return e.event}}return null}forEach(e){if(null!==this._root){const t=[];this._root.traverse(e=>t.push(e)),t.forEach(t=>{t.event&&e(t.event)})}return this}forEachAtTime(e,t){if(null!==this._root){const n=[];this._root.search(e,n),n.forEach(e=>{e.event&&t(e.event)})}return this}forEachFrom(e,t){if(null!==this._root){const n=[];this._root.searchAfter(e,n),n.forEach(e=>{e.event&&t(e.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class Ne{constructor(e,t,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?null===this.left?this.left=e:this.left.insert(e):null===this.right?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(null!==this.left&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),this.low>e||null!==this.right&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),null!==this.left&&this.left.searchAfter(e,t)),null!==this.right&&this.right.searchAfter(e,t)}traverse(e){e(this),null!==this.left&&this.left.traverse(e),null!==this.right&&this.right.traverse(e)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return null!==this.left&&null!==this.right?e=this.left.height-this.right.height:null!==this.left?e=this.left.height+1:null!==this.right&&(e=-(this.right.height+1)),e}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class ke{constructor(e,t){this.id=ke._eventId++;const n=Object.assign(ke.getDefaults(),t);this.transport=e,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:Q,once:!1,time:0}}invoke(e){this.callback&&(this.callback(e),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}ke._eventId=0;class Fe extends ke{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(Fe.getDefaults(),t);this.duration=new Pe(e.context,n.duration).valueOf(),this._interval=new Pe(e.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},ke.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvents(e){const t=this.transport.getTicksAtTime(e);t>=this.time&&t>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Pe(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const t=this.transport.getTicksAtTime(e);t>this.time&&(this._nextTick=this.time+Math.ceil((t-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Pe(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Pe(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class Be extends ge{constructor(){super(I(Be.getDefaults(),arguments)),this.name="Transport",this._loop=new De(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new j,this._repeatedEvents=new Le,this._syncedSignals=[],this._swingAmount=0;const e=I(Be.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new Oe({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),K(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(ge.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._swingAmount>0&&t%this._ppq!=0&&t%(2*this._swingTicks)!=0){const n=t%(2*this._swingTicks)/(2*this._swingTicks),r=Math.sin(n*Math.PI)*this._swingAmount;e+=new Pe(this.context,2*this._swingTicks/3).toSeconds()*r}this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._timeline.forEachAtTime(t,t=>t.invoke(e))}schedule(e,t){const n=new ke(this,{callback:e,time:new me(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(e,t,n,r=1/0){const i=new Fe(this,{callback:e,duration:new de(this.context,r).toTicks(),interval:new de(this.context,t).toTicks(),time:new me(this.context,n).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(e,t){const n=new ke(this,{callback:e,once:!0,time:new me(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,e=>this.clear(e.id)),this._repeatedEvents.forEachFrom(t,e=>this.clear(e.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new Pe(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){let n;return d(t)&&(n=this.toTicks(t)),this._clock.start(e,n),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),"started"!==this._clock.getStateAtTime(e)?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){m(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new de(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new de(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new Pe(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new Pe(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),n=this._clock.frequency.timeToTicks(e,t);this.ticks=n}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(t),r=this._clock.getTimeOfTick(Math.ceil(n));this.emit("stop",r),this._clock.setTicksAtTime(e,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return Math.round(this._clock.getTicksAtTime(e))}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),"started"!==this.state)return 0;{const t=this.now(),n=e-this.getTicksAtTime(t)%e;return this._clock.nextTickTime(n,t)}}syncSignal(e,t){if(!t){const n=this.now();if(0!==e.getValueAtTime(n)){const r=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);t=e.getValueAtTime(n)/r}else t=0}const n=new Se(t);return this.bpm.connect(n),n.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:n,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const n=this._syncedSignals[t];n.signal===e&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),X(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}W.mixin(Be),H(e=>{e.transport=new Be({context:e})}),z(e=>{e.transport.dispose()});class Ue extends _e{constructor(){super(I(Ue.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const e=I(Ue.getDefaults(),arguments,["delayTime","maxDelay"]),t=this.toSeconds(e.maxDelay);this._maxDelay=Math.max(t,this.toSeconds(e.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(t),this.delayTime=new ye({context:this.context,param:this._delayNode.delayTime,units:"time",value:e.delayTime,minValue:0,maxValue:this.maxDelay}),K(this,"delayTime")}static getDefaults(){return Object.assign(_e.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class je extends _e{constructor(){super(I(je.getDefaults(),arguments,["volume"])),this.name="Volume";const e=I(je.getDefaults(),arguments,["volume"]);this.input=this.output=new Se({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,K(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(_e.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Ge extends _e{constructor(){super(I(Ge.getDefaults(),arguments)),this.name="Destination",this.input=new je({context:this.context}),this.output=new Se({context:this.context}),this.volume=this.input.volume;const e=I(Ge.getDefaults(),arguments);be(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(_e.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),be(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}H(e=>{e.destination=new Ge({context:e})}),z(e=>{e.destination.dispose()});class He extends P{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=I(He.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const n=e.urls[t];this.add(t,n,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Q,onload:Q,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return a(this.has(e),"ToneAudioBuffers has no buffer named: "+e),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,0===this._loadingCount&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,n=Q,r=Q){return g(t)?this._buffers.set(e.toString(),new Z(this.baseUrl+t,n,r)):this._buffers.set(e.toString(),new Z(t,n,r)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class Ve extends ge{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new j,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){const t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}H(e=>{e.draw=new Ve({context:e})}),z(e=>{e.draw.dispose()});n(698);class ze extends _e{constructor(e){super(e),this.input=void 0,this._state=new ve("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Q,this._syncedStop=Q,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new je({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,K(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(_e.getDefaults(),{mute:!1,onstop:Q,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,n){let r=c(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(r=this._clampToCurrentTime(r),this._synced||"started"!==this._state.getValueAtTime(r))if(this.log("start",r),this._state.setStateAtTime("started",r),this._synced){const e=this._state.get(r);e&&(e.offset=this.toSeconds(O(t,0)),e.duration=n?this.toSeconds(n):void 0);const i=this.context.transport.schedule(e=>{this._start(e,t,n)},r);this._scheduled.push(i),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>r&&this._syncedStart(this.now(),this.context.transport.seconds)}else s(this.context),this._start(r,t,n);else a(N(r,this._state.get(r).time),"Start time must be strictly greater than previous start time"),this._state.cancel(r),this._state.setStateAtTime("started",r),this.log("restart",r),this.restart(r,t,n);return this}stop(e){let t=c(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),"started"===this._state.getValueAtTime(t)||d(this._state.getNextState("started",t))){if(this.log("stop",t),this._synced){const e=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(e)}else this._stop(t);this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,n){return e=this.toSeconds(e),"started"===this._state.getValueAtTime(e)&&(this._state.cancel(e),this._restart(e,t,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(t>0){const n=this._state.get(t);if(n&&"started"===n.state&&n.time!==t){const r=t-this.toSeconds(n.time);let i;n.duration&&(i=this.toSeconds(n.duration)-r),this._start(e,this.toSeconds(n.offset)+r,i)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));"started"===this._state.getValueAtTime(t)&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Q,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class We extends we{constructor(){super(I(We.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const e=I(We.getDefaults(),arguments,["url","onload"]);Ee(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new ye({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Z(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(we.getDefaults(),{url:new Z,loop:!1,loopEnd:0,loopStart:0,onload:Q,onerror:Q,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,n,r=1){a(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(e);this._startGain(i,r),t=this.loop?O(t,this.loopStart):O(t,0);let o=Math.max(this.toSeconds(t),0);if(this.loop){const e=this.toSeconds(this.loopEnd)||this.buffer.duration,t=this.toSeconds(this.loopStart),n=e-t;k(o,e)&&(o=(o-t)%n+t),B(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,F(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),d(n)){let e=this.toSeconds(n);e=Math.max(e,0),this.stop(i+e)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class qe extends ze{constructor(){super(I(qe.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const e=I(qe.getDefaults(),arguments,["type"]);this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(ze.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(a(e in Xe,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,"started"===this.state)){const e=this.now();this._stop(e),this._start(e)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const t=Xe[this._type];this._source=new We({url:t,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(t.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const Ye=220500,Ke={brown:null,pink:null,white:null},Xe={get brown(){if(!Ke.brown){const e=[];for(let t=0;t<2;t++){const n=new Float32Array(Ye);e[t]=n;let r=0;for(let e=0;e<Ye;e++){const t=2*Math.random()-1;n[e]=(r+.02*t)/1.02,r=n[e],n[e]*=3.5}}Ke.brown=(new Z).fromArray(e)}return Ke.brown},get pink(){if(!Ke.pink){const e=[];for(let t=0;t<2;t++){const n=new Float32Array(Ye);let r,i,a,o,s,u,l;e[t]=n,r=i=a=o=s=u=l=0;for(let e=0;e<Ye;e++){const t=2*Math.random()-1;r=.99886*r+.0555179*t,i=.99332*i+.0750759*t,a=.969*a+.153852*t,o=.8665*o+.3104856*t,s=.55*s+.5329522*t,u=-.7616*u-.016898*t,n[e]=r+i+a+o+s+u+l+.5362*t,n[e]*=.11,l=.115926*t}}Ke.pink=(new Z).fromArray(e)}return Ke.pink},get white(){if(!Ke.white){const e=[];for(let t=0;t<2;t++){const n=new Float32Array(Ye);e[t]=n;for(let e=0;e<Ye;e++)n[e]=2*Math.random()-1}Ke.white=(new Z).fromArray(e)}return Ke.white}};function Qe(e,t){return E(this,void 0,void 0,(function*(){const n=t/e.context.sampleRate,r=new J(1,n,e.context.sampleRate);new e.constructor(Object.assign(e.get(),{frequency:2/n,detune:0,context:r})).toDestination().start(0);return(yield r.render()).getChannelData(0)}))}class Ze extends we{constructor(){super(I(Ze.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const e=I(Ze.getDefaults(),arguments,["frequency","type"]);Ee(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new ye({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new ye({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),K(this,["frequency","detune"])}static getDefaults(){return Object.assign(we.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Je extends ze{constructor(){super(I(Je.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const e=I(Je.getDefaults(),arguments,["frequency","type"]);this.frequency=new xe({context:this.context,units:"frequency",value:e.frequency}),K(this,"frequency"),this.detune=new xe({context:this.context,units:"cents",value:e.detune}),K(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&"custom"!==e.type&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(ze.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),n=new Ze({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type){return Je._periodicWaveCache.find(e=>{return e.phase===this._phase&&(t=e.partials,n=this._partials,t.length===n.length&&t.every((e,t)=>n[t]===e));var t,n})}{const e=Je._periodicWaveCache.find(e=>e.type===this._type&&e.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=-1!==["sine","square","sawtooth","triangle"].indexOf(e);if(0===this._phase&&t)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=e);else{const t=this._getCachedPeriodicWave();if(d(t)){const{partials:e,wave:n}=t;this._wave=n,this._partials=e,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[t,n]=this._getRealImaginary(e,this._phase),r=this.context.createPeriodicWave(t,n);this._wave=r,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),Je._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:t,type:this._type,wave:this._wave}),Je._periodicWaveCache.length>100&&Je._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&"custom"!==this._type&&"custom"!==e?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){o(e,0);let t=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(t=n[1]),"custom"!==this._type)this.type=0===e?t:t+e.toString();else{const t=new Float32Array(e);this._partials.forEach((e,n)=>t[n]=e),this._partials=Array.from(t),this.type=this._type}}_getRealImaginary(e,t){let n=2048;const r=new Float32Array(n),i=new Float32Array(n);let a=1;if("custom"===e){if(a=this._partials.length+1,this._partialCount=this._partials.length,n=a,0===this._partials.length)return[r,i]}else{const t=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);t?(a=parseInt(t[2],10)+1,this._partialCount=parseInt(t[2],10),e=t[1],a=Math.max(a,2),n=a):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let s;switch(e){case"sine":s=o<=a?1:0,this._partials[o-1]=s;break;case"square":s=1&o?2*n:0,this._partials[o-1]=s;break;case"sawtooth":s=n*(1&o?1:-1),this._partials[o-1]=s;break;case"triangle":s=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=s;break;case"custom":s=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}0!==s?(r[o]=-s*Math.sin(t*o),i[o]=s*Math.cos(t*o)):(r[o]=0,i[o]=0)}return[r,i]}_inverseFFT(e,t,n){let r=0;const i=e.length;for(let a=0;a<i;a++)r+=e[a]*Math.cos(a*n)+t[a]*Math.sin(a*n);return r}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let n=0;const r=2*Math.PI;for(let i=0;i<32;i++)n=Math.max(this._inverseFFT(e,t,i/32*r),n);return U(-this._inverseFFT(e,t,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return E(this,void 0,void 0,(function*(){return Qe(this,e)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Je._periodicWaveCache=[];class $e extends _e{constructor(){super(Object.assign(I($e.getDefaults(),arguments,["context"])))}connect(e,t=0,n=0){return Me(this,e,t,n),this}}class et extends $e{constructor(){super(Object.assign(I(et.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const e=I(et.getDefaults(),arguments,["mapping","length"]);m(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):"function"==typeof e.mapping&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(xe.getDefaults(),{length:1024})}setMap(e,t=1024){const n=new Float32Array(t);for(let r=0,i=t;r<i;r++){const t=r/(i-1)*2-1;n[r]=e(t,r)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){a(["none","2x","4x"].some(t=>t.includes(e)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class tt extends $e{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new et({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class nt extends xe{constructor(){super(Object.assign(I(nt.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const e=I(nt.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Se({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(xe.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class rt extends ze{constructor(){super(I(rt.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new tt({context:this.context}),this._modulationNode=new Se({context:this.context});const e=I(rt.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Je({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Je({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new nt({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),K(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Je.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return E(this,void 0,void 0,(function*(){return Qe(this,e)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class it extends ze{constructor(){super(I(it.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Se({context:this.context,gain:0});const e=I(it.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Je({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new xe({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Je({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new nt({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new nt({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),K(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Je.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return E(this,void 0,void 0,(function*(){return Qe(this,e)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class at extends ze{constructor(){super(I(at.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Se({context:this.context,gain:0}),this._thresh=new et({context:this.context,mapping:e=>e<=0?-1:1});const e=I(at.getDefaults(),arguments,["frequency","width"]);this.width=new xe({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Je({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),K(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(ze.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return E(this,void 0,void 0,(function*(){return Qe(this,e)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class ot extends ze{constructor(){super(I(ot.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const e=I(ot.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new xe({context:this.context,units:"frequency",value:e.frequency}),this.detune=new xe({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,K(this,["frequency","detune"])}static getDefaults(){return Object.assign(Je.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,n=e/(this._oscillators.length-1);this._forEach((e,r)=>e.detune.value=t+n*r)}}get count(){return this._oscillators.length}set count(e){if(o(e,1),this._oscillators.length!==e){this._forEach(e=>e.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const n=new Je({context:this.context,volume:-6-1.1*e,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:0===t?()=>this.onstop(this):Q});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[t]=n}this.spread=this._spread,"started"===this.state&&this._forEach(e=>e.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach(t=>t.phase=e)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return E(this,void 0,void 0,(function*(){return Qe(this,e)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class st extends ze{constructor(){super(I(st.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new nt({context:this.context,value:2});const e=I(st.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new at({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Je({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),K(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(ze.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return E(this,void 0,void 0,(function*(){return Qe(this,e)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const ut={am:rt,fat:ot,fm:it,oscillator:Je,pulse:at,pwm:st};class lt extends ze{constructor(){super(I(lt.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const e=I(lt.getDefaults(),arguments,["frequency","type"]);this.frequency=new xe({context:this.context,units:"frequency",value:e.frequency}),this.detune=new xe({context:this.context,units:"cents",value:e.detune}),K(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Je.getDefaults(),it.getDefaults(),rt.getDefaults(),ot.getDefaults(),at.getDefaults(),st.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(e=>this._sourceType===e)&&(e=this._sourceType),e+this._oscillator.type}set type(e){"fm"===e.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"am"===e.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"fat"===e.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):"pwm"===e?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===e?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=ut[e],n=this.now();if(this._oscillator){const e=this._oscillator;e.stop(n),this.context.setTimeout(()=>e.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(t=this._oscillator.type),"fm"===e?this.type="fm"+t:"am"===e?this.type="am"+t:"fat"===e?this.type="fat"+t:"oscillator"===e?this.type=t:"pulse"===e?this.type="pulse":"pwm"===e&&(this.type="pwm")}_getOscType(e,t){return e instanceof ut[t]}get baseType(){return this._oscillator.baseType}set baseType(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===e||"pwm"===e||(this._oscillator.baseType=e)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(e){this._getOscType(this._oscillator,"fat")&&h(e)&&(this._oscillator.count=e)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(e){this._getOscType(this._oscillator,"fat")&&h(e)&&(this._oscillator.spread=e)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&g(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(e=1024){return E(this,void 0,void 0,(function*(){return Qe(this,e)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class ct extends xe{constructor(){super(Object.assign(I(ct.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new Se({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,be(this._constantSource,this._sum)}static getDefaults(){return Object.assign(xe.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class dt extends $e{constructor(){super(Object.assign(I(dt.getDefaults(),arguments,["min","max"]))),this.name="Scale";const e=I(dt.getDefaults(),arguments,["min","max"]);this._mult=this.input=new nt({context:this.context,value:e.max-e.min}),this._add=this.output=new ct({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign($e.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class ht extends $e{constructor(){super(Object.assign(I(ht.getDefaults(),arguments))),this.name="Zero",this._gain=new Se({context:this.context}),this.output=this._gain,this.input=void 0,Ee(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),Te(this.context.getConstant(0),this._gain),this}}class ft extends _e{constructor(){super(I(ft.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=ye.prototype._fromType,this._toType=ye.prototype._toType,this._is=ye.prototype._is,this._clampValue=ye.prototype._clampValue;const e=I(ft.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new Je({context:this.context,frequency:e.frequency,type:e.type}),this.frequency=this._oscillator.frequency,this._amplitudeGain=new Se({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new xe({context:this.context,units:"audioRange",value:0}),this._zeros=new ht({context:this.context}),this._a2g=new tt({context:this.context}),this._scaler=this.output=new dt({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._a2g,this._amplitudeGain,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),K(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(_e.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,phase:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get units(){return this._units}set units(e){const t=this.min,n=this.max;this._units=e,this.min=t,this.max=n}get state(){return this._oscillator.state}connect(e,t,n){return(e instanceof ye||e instanceof xe)&&(this.convert=e.convert,this.units=e.units),Me(this,e,t,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function pt(e,t=1/0){const n=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(r){o(r,e,t),n.set(this,r)}})}}function mt(e,t=1/0){const n=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(r){o(this.toSeconds(r),e,t),n.set(this,r)}})}}class gt extends ze{constructor(){super(I(gt.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const e=I(gt.getDefaults(),arguments,["url","onload"]);this._buffer=new Z({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(ze.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Q,onerror:Q,playbackRate:1,reverse:!1})}load(e){return E(this,void 0,void 0,(function*(){return yield this._buffer.load(e),this._onload(),this}))}_onload(e=Q){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||this._state.setStateAtTime("stopped",this.now())}start(e,t,n){return super.start(e,t,n),this}_start(e,t,n){t=this._loop?O(t,this._loopStart):O(t,0);let r=this.toSeconds(t);this._synced&&(r*=this._playbackRate);const i=n;n=O(n,Math.max(this._buffer.duration-r,0));let a=this.toSeconds(n);a/=this._playbackRate,e=this.toSeconds(e);const o=new We({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(e+a),this._state.setStateAtTime("stopped",e+a,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&c(i)?o.start(e,r):o.start(e,r,a-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(e=>e.stop(t))}restart(e,t,n){return super.restart(e,t,n),this}_restart(e,t,n){this._stop(e),this._start(e,t,n)}seek(e,t){const n=this.toSeconds(t);if("started"===this._state.getValueAtTime(n)){const t=this.toSeconds(e);this._stop(n),this._start(n,t)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&o(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&o(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),n=this._state.getNextState("stopped",t);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(e=>e.cancelStop())),this._activeSources.forEach(n=>{n.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}b([mt(0)],gt.prototype,"fadeIn",void 0),b([mt(0)],gt.prototype,"fadeOut",void 0);class vt extends ze{constructor(){super(I(vt.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];const e=I(vt.getDefaults(),arguments,["url","onload"]);this.buffer=new Z({onload:e.onload,onerror:e.onerror,reverse:e.reverse,url:e.url}),this._clock=new Oe({context:this.context,callback:this._tick.bind(this),frequency:1/e.grainSize}),this._playbackRate=e.playbackRate,this._grainSize=e.grainSize,this._overlap=e.overlap,this.detune=e.detune,this.overlap=e.overlap,this.loop=e.loop,this.playbackRate=e.playbackRate,this.grainSize=e.grainSize,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.reverse=e.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(ze.getDefaults(),{onload:Q,onerror:Q,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(e,t,n){t=O(t,0),t=this.toSeconds(t),e=this.toSeconds(e);const r=1/this._clock.frequency.getValueAtTime(e);this._clock.start(e,t/r),n&&this.stop(e+this.toSeconds(n))}restart(e,t,n){return super.restart(e,t,n),this}_restart(e,t,n){this._stop(e),this._start(e,t,n)}_stop(e){this._clock.stop(e)}_onstop(e){this._activeSources.forEach(t=>{t.fadeOut=0,t.stop(e)}),this.onstop(this)}_tick(e){const t=this._clock.getTicksAtTime(e),n=t*this._grainSize;if(this.log("offset",n),!this.loop&&n>this.buffer.duration)return void this.stop(e);const r=n<this._overlap?0:this._overlap,i=new We({context:this.context,url:this.buffer,fadeIn:r,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:ae(this.detune/100)}).connect(this.output);i.start(e,this._grainSize*t),i.stop(e+this._grainSize/this.playbackRate),this._activeSources.push(i),i.onended=()=>{const e=this._activeSources.indexOf(i);-1!==e&&this._activeSources.splice(e,1)}}get playbackRate(){return this._playbackRate}set playbackRate(e){o(e,.001),this._playbackRate=e,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(e){this.buffer.loaded&&o(this.toSeconds(e),0,this.buffer.duration),this._loopStart=this.toSeconds(e)}get loopEnd(){return this._loopEnd}set loopEnd(e){this.buffer.loaded&&o(this.toSeconds(e),0,this.buffer.duration),this._loopEnd=this.toSeconds(e)}get reverse(){return this.buffer.reverse}set reverse(e){this.buffer.reverse=e}get grainSize(){return this._grainSize}set grainSize(e){this._grainSize=this.toSeconds(e),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(e){const t=this.toSeconds(e);o(t,0),this._overlap=t}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach(e=>e.dispose()),this}}class yt extends $e{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new et({context:this.context,mapping:e=>2*Math.abs(e)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class _t extends _e{constructor(){super(I(_t.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new xe({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const e=I(_t.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(_e.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(g(e))return e;{let n;for(n in bt)if(bt[n][t]===e)return n;return e}}_setCurve(e,t,n){if(g(n)&&Reflect.has(bt,n)){const r=bt[n];f(r)?"_decayCurve"!==e&&(this[e]=r[t]):this[e]=r}else{if(!m(n)||"_decayCurve"===e)throw new Error("Envelope: invalid curve: "+n);this[e]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._decayCurve}set decayCurve(e){a(["linear","exponential"].some(t=>t===e),"Invalid envelope curve: "+e),this._decayCurve=e}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let n=this.toSeconds(this.attack);const r=this.toSeconds(this.decay),i=this.getValueAtTime(e);if(i>0){n=(1-i)/(1/n)}if(n<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if("linear"===this._attackCurve)this._sig.linearRampTo(t,n,e);else if("exponential"===this._attackCurve)this._sig.targetRampTo(t,n,e);else{this._sig.cancelAndHoldAtTime(e);let r=this._attackCurve;for(let e=1;e<r.length;e++)if(r[e-1]<=i&&i<=r[e]){r=this._attackCurve.slice(e),r[0]=i;break}this._sig.setValueCurveAtTime(r,e,n,t)}if(r&&this.sustain<1){const i=t*this.sustain,a=e+n;this.log("decay",a),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(i,r+a):this._sig.exponentialApproachValueAtTime(i,a,r)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,e):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,e):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,e):(a(m(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,n,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,n=1){return t=this.toSeconds(t),this.triggerAttack(t,n),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,n=0){return Me(this,e,t,n),this}asArray(e=1024){return E(this,void 0,void 0,(function*(){const t=e/this.context.sampleRate,n=new J(1,t,this.context.sampleRate),r=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=r+this.toSeconds(this.release),a=.1*i,o=i+a,s=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/o,decay:t*this.toSeconds(this.decay)/o,release:t*this.toSeconds(this.release)/o,context:n}));s._sig.toDestination(),s.triggerAttackRelease(t*(r+a)/o,0);return(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}b([mt(0)],_t.prototype,"attack",void 0),b([mt(0)],_t.prototype,"decay",void 0),b([pt(0,1)],_t.prototype,"sustain",void 0),b([mt(0)],_t.prototype,"release",void 0);const bt=(()=>{const e=128;let t,n;const r=[];for(t=0;t<e;t++)r[t]=Math.sin(t/127*(Math.PI/2));const i=[];for(t=0;t<127;t++){n=t/127;const e=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;i[t]=e/10+.83*n}i[127]=1;const a=[];for(t=0;t<e;t++)a[t]=Math.ceil(t/127*5)/5;const o=[];for(t=0;t<e;t++)n=t/127,o[t]=.5*(1-Math.cos(Math.PI*n));const s=[];for(t=0;t<e;t++){n=t/127;const e=4*Math.pow(n,3)+.2,r=Math.cos(e*Math.PI*2*n);s[t]=Math.abs(r*(1-n))}function u(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=1-e[n];return t}return{bounce:{In:u(s),Out:s},cosine:{In:r,Out:(l=r,l.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:i,Out:u(i)},sine:{In:o,Out:u(o)},step:{In:a,Out:u(a)}};var l})();class Et extends _e{constructor(){super(I(Et.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const e=I(Et.getDefaults(),arguments);this._volume=this.output=new je({context:this.context,volume:e.volume}),this.volume=this._volume.volume,K(this,"volume")}static getDefaults(){return Object.assign(_e.getDefaults(),{volume:0})}sync(){return this._synced||(this._synced=!0,this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncMethod(e,t){const n=this["_original_"+e]=this[e];this[e]=(...e)=>{const r=e[t],i=this.context.transport.schedule(r=>{e[t]=r,n.apply(this,e)},r);this._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(e,t,n,r){const i=this.toSeconds(n),a=this.toSeconds(t);return this.triggerAttack(e,i,r),this.triggerRelease(i+a),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Tt extends Et{constructor(){super(I(Tt.getDefaults(),arguments));const e=I(Tt.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(Et.getDefaults(),{detune:0,onsilence:Q,portamento:0})}triggerAttack(e,t,n=1){this.log("triggerAttack",e,t,n);const r=this.toSeconds(t);return this._triggerEnvelopeAttack(r,n),this.setNote(e,r),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const n=this.toSeconds(t),r=e instanceof he?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const e=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,e,n)}else this.frequency.setValueAtTime(r,n);return this}}b([mt(0)],Tt.prototype,"portamento",void 0);class St extends _t{constructor(){super(I(St.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Se({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class wt extends Tt{constructor(){super(I(wt.getDefaults(),arguments)),this.name="Synth";const e=I(wt.getDefaults(),arguments);this.oscillator=new lt(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new St(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),K(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Tt.getDefaults(),{envelope:Object.assign(D(_t.getDefaults(),Object.keys(_e.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(D(lt.getDefaults(),[...Object.keys(ze.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),0===this.envelope.sustain){const t=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+t+n)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class At extends wt{constructor(){super(I(At.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const e=I(At.getDefaults(),arguments);this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,K(this,["oscillator","envelope"])}static getDefaults(){return R(Tt.getDefaults(),wt.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const n=this.toSeconds(t),r=this.toFrequency(e instanceof he?e.toFrequency():e),i=r*this.octaves;return this.oscillator.frequency.setValueAtTime(i,n),this.oscillator.frequency.exponentialRampToValueAtTime(r,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}b([pt(0)],At.prototype,"octaves",void 0),b([mt(0)],At.prototype,"pitchDecay",void 0);const xt=new Set;function Mt(e){xt.add(e)}function Ct(e,t){const n=`registerProcessor("${e}", ${t})`;xt.add(n)}Mt('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n');Mt("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n");Mt("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");const Rt="feedback-comb-filter";Ct(Rt,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class It extends Et{constructor(){super(I(It.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const e=I(It.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach(n=>{const r=parseInt(n,10);if(a(v(n)||h(r)&&isFinite(r),"url key is neither a note or midi pitch: "+n),v(n)){const r=new he(this.context,n).toMidi();t[r]=e.urls[n]}else h(r)&&isFinite(r)&&(t[r]=e.urls[r])}),this._buffers=new He({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(Et.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Q,onerror:Q,release:.1,urls:{}})}_findClosest(e){let t=0;for(;t<96;){if(this._buffers.has(e+t))return-t;if(this._buffers.has(e-t))return t;t++}throw new Error("No available buffers for note: "+e)}triggerAttack(e,t,n=1){return this.log("triggerAttack",e,t,n),Array.isArray(e)||(e=[e]),e.forEach(e=>{const r=ue(new he(this.context,e).toFrequency()),i=Math.round(r),a=r-i,o=this._findClosest(i),s=i-o,u=this._buffers.get(s),l=ae(o+a),c=new We({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:l}).connect(this.output);c.start(t,0,u.duration/l,n),m(this._activeSources.get(i))||this._activeSources.set(i,[]),this._activeSources.get(i).push(c),c.onended=()=>{if(this._activeSources&&this._activeSources.has(i)){const e=this._activeSources.get(i),t=e.indexOf(c);-1!==t&&e.splice(t,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(e=>{const n=new he(this.context,e).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const e=this._activeSources.get(n);t=this.toSeconds(t),e.forEach(e=>{e.stop(t)}),this._activeSources.set(n,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(e=>{for(;e.length;){e.shift().stop(t)}}),this}sync(){return this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this}triggerAttackRelease(e,t,n,r=1){const i=this.toSeconds(n);return this.triggerAttack(e,i,r),m(t)?(a(m(e),"notes must be an array when duration is array"),e.forEach((e,n)=>{const r=t[Math.min(n,t.length-1)];this.triggerRelease(e,i+this.toSeconds(r))})):this.triggerRelease(e,i+this.toSeconds(t)),this}add(e,t,n){if(a(v(e)||isFinite(e),"note must be a pitch or midi: "+e),v(e)){const r=new he(this.context,e).toMidi();this._buffers.add(r,t,n)}else this._buffers.add(e,t,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(e=>e.dispose())}),this._activeSources.clear(),this}}b([mt(0)],It.prototype,"attack",void 0),b([mt(0)],It.prototype,"release",void 0);class Ot extends _e{constructor(){super(Object.assign(I(Ot.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new yt({context:this.context}),this.a=new Se({context:this.context,gain:0}),this.b=new Se({context:this.context,gain:0}),this.output=new Se({context:this.context}),this._internalChannels=[this.a,this.b];const e=I(Ot.getDefaults(),arguments,["fade"]);this.fade=new xe({context:this.context,units:"normalRange",value:e.fade}),K(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Ee(this._split,this.a.gain,0),Ee(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(_e.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class Dt extends _e{constructor(e){super(e),this.name="Effect",this._dryWet=new Ot({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Se({context:this.context}),this.effectReturn=new Se({context:this.context}),this.input=new Se({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],K(this,"wet")}static getDefaults(){return Object.assign(_e.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class Pt extends _e{constructor(){super(Object.assign(I(Pt.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const e=I(Pt.getDefaults(),arguments,["pan"]);this.pan=new ye({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",K(this,"pan")}static getDefaults(){return Object.assign(_e.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const Lt="bit-crusher";Ct(Lt,"\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class Nt extends Dt{constructor(){super(I(Nt.getDefaults(),arguments,["order"])),this.name="Chebyshev";const e=I(Nt.getDefaults(),arguments,["order"]);this._shaper=new et({context:this.context,length:4096}),this._order=e.order,this.connectEffect(this._shaper),this.order=e.order,this.oversample=e.oversample}static getDefaults(){return Object.assign(Dt.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(e,t,n){return n.has(t)||(0===t?n.set(t,0):1===t?n.set(t,e):n.set(t,2*e*this._getCoefficient(e,t-1,n)-this._getCoefficient(e,t-2,n))),n.get(t)}get order(){return this._order}set order(e){this._order=e,this._shaper.setMap(t=>this._getCoefficient(t,e,new Map))}get oversample(){return this._shaper.oversample}set oversample(e){this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.dispose(),this}}class kt extends _e{constructor(){super(I(kt.getDefaults(),arguments,["channels"])),this.name="Split";const e=I(kt.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(_e.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class Ft extends _e{constructor(){super(I(Ft.getDefaults(),arguments,["channels"])),this.name="Merge";const e=I(Ft.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(_e.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class Bt extends _e{constructor(e){super(e),this.name="StereoEffect",this.input=new Se({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new Ot({context:this.context,fade:e.wet}),this.wet=this._dryWet.fade,this._split=new kt({context:this.context,channels:2}),this._merge=new Ft({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),K(this,["wet"])}connectEffectLeft(...e){this._split.connect(e[0],0,0),be(...e),Ee(e[e.length-1],this._merge,0,0)}connectEffectRight(...e){this._split.connect(e[0],1,0),be(...e),Ee(e[e.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(_e.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Ut extends Bt{constructor(e){super(e),this.feedback=new xe({context:this.context,value:e.feedback,units:"normalRange"}),this._feedbackL=new Se({context:this.context}),this._feedbackR=new Se({context:this.context}),this._feedbackSplit=new kt({context:this.context,channels:2}),this._feedbackMerge=new Ft({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),K(this,["feedback"])}static getDefaults(){return Object.assign(Bt.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class jt extends Ut{constructor(){super(I(jt.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";const e=I(jt.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=e.depth,this._delayTime=e.delayTime/1e3,this._lfoL=new ft({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new ft({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._delayNodeL=new Ue({context:this.context}),this._delayNodeR=new Ue({context:this.context}),this.frequency=this._lfoL.frequency,K(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=e.type,this.spread=e.spread}static getDefaults(){return Object.assign(Ut.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(e){this._depth=e;const t=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-t,0),this._lfoL.max=this._delayTime+t,this._lfoR.min=Math.max(this._delayTime-t,0),this._lfoR.max=this._delayTime+t}get delayTime(){return 1e3*this._delayTime}set delayTime(e){this._delayTime=e/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(e){this._lfoL.type=e,this._lfoR.type=e}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}start(e){return this._lfoL.start(e),this._lfoR.start(e),this}stop(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class Gt extends Dt{constructor(){super(I(Gt.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const e=I(Gt.getDefaults(),arguments,["decay"]);this._decay=e.decay,this._preDelay=e.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Dt.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){o(e=this.toSeconds(e),.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){o(e=this.toSeconds(e),0),this._preDelay=e,this.generate()}generate(){return E(this,void 0,void 0,(function*(){const e=this.ready,t=new J(2,this._decay+this._preDelay,this.context.sampleRate),n=new qe({context:t}),r=new qe({context:t}),i=new Ft({context:t});n.connect(i,0,0),r.connect(i,0,1);const a=new Se({context:t}).toDestination();i.connect(a),n.start(0),r.start(0),a.gain.setValueAtTime(0,0),a.gain.setValueAtTime(1,this._preDelay),a.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=t.render();return this.ready=o.then(Q),yield e,this._convolver.buffer=(yield o).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class Ht extends _e{constructor(){super(I(Ht.getDefaults(),arguments,["solo"])),this.name="Solo";const e=I(Ht.getDefaults(),arguments,["solo"]);this.input=this.output=new Se({context:this.context}),Ht._allSolos.has(this.context)||Ht._allSolos.set(this.context,new Set),Ht._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(_e.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),Ht._allSolos.get(this.context).forEach(e=>e._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){Ht._soloed.has(this.context)||Ht._soloed.set(this.context,new Set),Ht._soloed.get(this.context).add(this)}_removeSolo(){Ht._soloed.has(this.context)&&Ht._soloed.get(this.context).delete(this)}_isSoloed(){return Ht._soloed.has(this.context)&&Ht._soloed.get(this.context).has(this)}_noSolos(){return!Ht._soloed.has(this.context)||Ht._soloed.has(this.context)&&0===Ht._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Ht._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Ht._allSolos=new Map,Ht._soloed=new Map;class Vt extends _e{constructor(){super(I(Vt.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const e=I(Vt.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Pt({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new je({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,K(this,["pan","volume"])}static getDefaults(){return Object.assign(_e.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class zt extends _e{constructor(){super(I(zt.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const e=I(zt.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Ht({solo:e.solo,context:this.context}),this._panVol=this.output=new Vt({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),K(this,["pan","volume"])}static getDefaults(){return Object.assign(_e.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return zt.buses.has(e)||zt.buses.set(e,new Se({context:this.context})),zt.buses.get(e)}send(e,t=0){const n=this._getBus(e),r=new Se({context:this.context,units:"decibels",gain:t});return this.connect(r),r.connect(n),r}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}zt.buses=new Map;class Wt extends _e{constructor(){super(...arguments),this.name="Listener",this.positionX=new ye({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new ye({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new ye({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new ye({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new ye({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new ye({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new ye({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new ye({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new ye({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(_e.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}H(e=>{e.listener=new Wt({context:e})}),z(e=>{e.listener.dispose()});n.d(t,"g",(function(){return ne})),n.d(t,"d",(function(){return Y})),n.d(t,"e",(function(){return vt})),n.d(t,"b",(function(){return Nt})),n.d(t,"c",(function(){return jt})),n.d(t,"f",(function(){return Gt})),n.d(t,"a",(function(){return zt}));te().transport;te().destination,te().destination;te().listener;te().draw;te()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=e.decodeAudioData(t.buffer,()=>{});return void 0!==n&&(n.catch(()=>{}),!0)}catch{}return!1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>{try{return new DOMException("","IndexSizeError")}catch(e){return e.code=1,e.name="IndexSizeError",e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n,r)=>{for(const t of e)if(n(t)){if(r)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(933));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0,t=[],n=this.context;function r(n,r,i){var a=function(n){var r=void 0;for(r=0;r<t.length;r++)if(t[r].regex.test(n))return t[r].utils;return e}(i||r);return a&&"function"==typeof a[n]?a[n](r,i):e[n](r,i)}return e=(0,i.default)(n).getInstance(),{registerUrlRegex:function(e,n){t.push({regex:e,utils:n})},parseBaseUrl:function(e){return r("parseBaseUrl",e)},parseOrigin:function(e){return r("parseOrigin",e)},parseScheme:function(e){return r("parseScheme",e)},isRelative:function(e){return r("isRelative",e)},isPathAbsolute:function(e){return r("isPathAbsolute",e)},isSchemeRelative:function(e){return r("isSchemeRelative",e)},isHTTPURL:function(e){return r("isHTTPURL",e)},isHTTPS:function(e){return r("isHTTPS",e)},removeHostname:function(e){return r("removeHostname",e)},resolve:function(e,t){return r("resolve",e,t)}}}o.__dashjs_factory_name="URLUtils";var s=r.default.getSingletonFactory(o);t.default=s},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6),i=n(53);const a=e=>{if(r.a.has(e))throw new Error("The AudioNode is already stored.");r.a.add(e),Object(i.a)(e).forEach(e=>e(!0))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Debug=t.MediaPlayerFactory=t.MetricsReporting=t.Protection=t.MediaPlayer=void 0;var r=n(877),i=u(n(1001)),a=u(n(1020)),o=u(n(1035)),s=u(n(17));function u(e){return e&&e.__esModule?e:{default:e}}dashjs.Protection=a.default,dashjs.MetricsReporting=i.default,dashjs.MediaPlayerFactory=o.default,dashjs.Debug=s.default,t.default=dashjs,t.MediaPlayer=r.MediaPlayer,t.Protection=a.default,t.MetricsReporting=i.default,t.MediaPlayerFactory=o.default,t.Debug=s.default},function(e,t,n){!function(e,t,n,r){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=i(t),o=i(n),s=i(r),u=function(e,t,n){return{endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}},l=function(e,t,n){return{endTime:t,insertTime:n,type:"linearRampToValue",value:e}},c=function(e,t){return{startTime:t,type:"setValue",value:e}},d=function(e,t,n){return{duration:n,startTime:t,type:"setValueCurve",values:e}},h=function(e,t,n){var r=n.startTime,i=n.target,a=n.timeConstant;return i+(t-i)*Math.exp((r-e)/a)},f=function(e){return"exponentialRampToValue"===e.type},p=function(e){return"linearRampToValue"===e.type},m=function(e){return f(e)||p(e)},g=function(e){return"setValue"===e.type},v=function(e){return"setValueCurve"===e.type},y=function e(t,n,r,i){var a=t[n];return void 0===a?i:m(a)||g(a)?a.value:v(a)?a.values[a.values.length-1]:h(r,e(t,n-1,a.startTime,i),a)},_=function(e,t,n,r,i){return void 0===n?[r.insertTime,i]:m(n)?[n.endTime,n.value]:g(n)?[n.startTime,n.value]:v(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,y(e,t-1,n.startTime,i)]},b=function(e){return"cancelAndHold"===e.type},E=function(e){return"cancelScheduledValues"===e.type},T=function(e){return b(e)||E(e)?e.cancelTime:f(e)||p(e)?e.endTime:e.startTime},S=function(e,t,n,r){var i=r.endTime,a=r.value;return n===a?a:0<n&&0<a||n<0&&a<0?n*Math.pow(a/n,(e-t)/(i-t)):0},w=function(e,t,n,r){return n+(e-t)/(r.endTime-t)*(r.value-n)},A=function(e,t){var n=Math.floor(t),r=Math.ceil(t);return n===r?e[n]:(1-(t-n))*e[n]+(1-(r-t))*e[r]},x=function(e,t){var n=t.duration,r=t.startTime,i=t.values,a=(e-r)/n*(i.length-1);return A(i,a)},M=function(e){return"setTarget"===e.type},C=function(){function e(t){o.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return s.default(e,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(e){var t=T(e);if(b(e)||E(e)){var n=this._automationEvents.findIndex((function(e){return T(e)>=t})),r=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),b(e)){var i=this._automationEvents[this._automationEvents.length-1];if(void 0!==r&&m(r)){if(M(i))throw new Error("The internal list is malformed.");var a=v(i)?i.startTime+i.duration:T(i),o=v(i)?i.values[i.values.length-1]:i.value,s=f(r)?S(t,a,o,r):w(t,a,o,r),h=f(r)?u(s,t,this._currenTime):l(s,t,this._currenTime);this._automationEvents.push(h)}void 0!==i&&M(i)&&this._automationEvents.push(c(this.getValue(t),t)),void 0!==i&&v(i)&&i.startTime+i.duration>t&&(this._automationEvents[this._automationEvents.length-1]=d(new Float32Array([6,7]),i.startTime,t-i.startTime))}}else{var g=this._automationEvents.findIndex((function(e){return T(e)>t})),y=-1===g?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[g-1];if(void 0!==y&&v(y)&&T(y)+y.duration>t)return!1;var _=f(e)?u(e.value,e.endTime,this._currenTime):p(e)?l(e.value,t,this._currenTime):e;if(-1===g)this._automationEvents.push(_);else{if(v(e)&&t+e.duration>T(this._automationEvents[g]))return!1;this._automationEvents.splice(g,0,_)}}return!0}},{key:"flush",value:function(e){var t=this._automationEvents.findIndex((function(t){return T(t)>e}));if(t>1){var n=this._automationEvents.slice(t-1),r=n[0];M(r)&&n.unshift(c(y(this._automationEvents,t-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(e){if(0===this._automationEvents.length)return this._defaultValue;var t=this._automationEvents[this._automationEvents.length-1],n=this._automationEvents.findIndex((function(t){return T(t)>e})),r=this._automationEvents[n],i=T(t)<=e?t:this._automationEvents[n-1];if(void 0!==i&&M(i)&&(void 0===r||!m(r)||r.insertTime>e))return h(e,y(this._automationEvents,n-2,i.startTime,this._defaultValue),i);if(void 0!==i&&g(i)&&(void 0===r||!m(r)))return i.value;if(void 0!==i&&v(i)&&(void 0===r||!m(r)||i.startTime+i.duration>e))return e<i.startTime+i.duration?x(e,i):i.values[i.values.length-1];if(void 0!==i&&m(i)&&(void 0===r||!m(r)))return i.value;if(void 0!==r&&f(r)){var o=_(this._automationEvents,n-1,i,r,this._defaultValue),s=a.default(o,2),u=s[0],l=s[1];return S(e,u,l,r)}if(void 0!==r&&p(r)){var c=_(this._automationEvents,n-1,i,r,this._defaultValue),d=a.default(c,2),b=d[0],E=d[1];return w(e,b,E,r)}return this._defaultValue}}]),e}(),R=function(e){return{cancelTime:e,type:"cancelAndHold"}},I=function(e){return{cancelTime:e,type:"cancelScheduledValues"}},O=function(e,t){return{endTime:t,type:"exponentialRampToValue",value:e}},D=function(e,t){return{endTime:t,type:"linearRampToValue",value:e}},P=function(e,t,n){return{startTime:t,target:e,timeConstant:n,type:"setTarget"}};e.AutomationEventList=C,e.createCancelAndHoldAutomationEvent=R,e.createCancelScheduledValuesAutomationEvent=I,e.createExponentialRampToValueAutomationEvent=O,e.createLinearRampToValueAutomationEvent=D,e.createSetTargetAutomationEvent=P,e.createSetValueAutomationEvent=c,e.createSetValueCurveAutomationEvent=d,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1191),n(1197),n(1198))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(6);const i=e=>r.h.has(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};var o={DEFAULT:.5,STRONG:1,WEAK:0};function s(e,t,n){return{quality:void 0===e?-1:e,reason:void 0===t?null:t,priority:function(e){var t=o.DEFAULT;return e!==o.DEFAULT&&e!==o.STRONG&&e!==o.WEAK||(t=e),t}(n)}}s.__dashjs_factory_name="SwitchRequest";var u=a.default.getClassFactory(s);u.NO_CHANGE=-1,u.PRIORITY=o,a.default.updateClassFactory(s.__dashjs_factory_name,u),t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r},o={DEFAULT:.5,STRONG:1,WEAK:0};function s(e,t,n){return{quality:void 0===e?-1:e,reason:void 0===t?null:t,priority:function(e){var t=o.DEFAULT;return e!==o.DEFAULT&&e!==o.STRONG&&e!==o.WEAK||(t=e),t}(n)}}s.__dashjs_factory_name="SwitchRequest";var u=a.default.getClassFactory(s);u.NO_CHANGE=-1,u.PRIORITY=o,a.default.updateClassFactory(s.__dashjs_factory_name,u),t.default=u,e.exports=t.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6),i=n(30);const a=e=>Object(i.a)(r.i,e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.checkParameterType=function(e,t){if((void 0===e?"undefined":r(e))!==t)throw o.default.BAD_ARGUMENT_ERROR},t.checkInteger=function(e){if(null===e||isNaN(e)||e%1!=0)throw o.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"},t.checkRange=function(e,t,n){if(e<t||e>n)throw o.default.BAD_ARGUMENT_ERROR+" : argument out of range"},t.checkIsVideoOrAudioType=function(e){if("string"!=typeof e||e!==o.default.AUDIO&&e!==o.default.VIDEO)throw o.default.BAD_ARGUMENT_ERROR};var i,a=n(9),o=(i=a)&&i.__esModule?i:{default:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e=void 0,t=/^[a-z][a-z0-9+\-.]*:/i,n=/^https?:\/\//i,r=/^https:\/\//i,i=/^([a-z][a-z0-9+\-.]*:\/\/[^\/]+)\/?/i,a=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},o=function(e,t){var n=s;if(!t)return e;if(!c(e))return e;d(e)&&(n=u),h(e)&&(n=l);var r=n(t),i="/"!==r.charAt(r.length-1)&&"/"!==e.charAt(0)?"/":"";return[r,e].join(i)};function s(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function u(e){var t=e.match(i);return t?t[1]:""}function l(e){var n=e.match(t);return n?n[0]:""}function c(e){return!t.test(e)}function d(e){return c(e)&&"/"===e.charAt(0)}function h(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y");e=a}catch(e){}finally{e=e||o}}(),{parseBaseUrl:s,parseOrigin:u,parseScheme:l,isRelative:c,isPathAbsolute:d,isSchemeRelative:h,isHTTPURL:function(e){return n.test(e)},isHTTPS:function(e){return r.test(e)},resolve:function(t,n){return e(t,n)}}}o.__dashjs_factory_name="URLUtils",t.default=a.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6),i=n(53);const a=e=>{if(!r.a.has(e))throw new Error("The AudioNode is not stored.");r.a.delete(e),Object(i.a)(e).forEach(e=>e(!1))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(66);const i=e=>Object(r.a)(e[0])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(6);const i=e=>r.a.has(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(34);var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=t||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}return r(e,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===i.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?i.HTTPRequest.INIT_SEGMENT_TYPE:i.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null}}]),e}();a.ACTION_DOWNLOAD="download",a.ACTION_COMPLETE="complete",t.default=a},function(e,t,n){"use strict";var r=n(108),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=d;var a=n(92);a.inherits=n(72);var o=n(178),s=n(135);a.inherits(d,o);for(var u=i(s.prototype),l=0;l<u.length;l++){var c=u[l];d.prototype[c]||(d.prototype[c]=s.prototype[c])}function d(e){if(!(this instanceof d))return new d(e);o.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready"}}]),e}());t.default=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(113)),o=r(n(207)),s=r(n(1063)),u=r(n(115)),l=r(n(157)),c=r(n(12)),d=r(n(14)),h=r(n(95)),f=r(n(3)),p=r(n(13)),m=r(n(158)),g=r(n(26)),v=r(n(29)),y=n(32),_="bufferLoaded",b="bufferStalled",E=.5,T=.5,S=.01,w="BufferController";function A(e){e=e||{};var t=this.context,n=(0,c.default)(t).getInstance(),r=e.metricsModel,f=e.mediaPlayerModel,A=e.errHandler,x=e.streamController,M=e.mediaController,C=e.adapter,R=e.textController,I=e.abrController,O=e.playbackController,D=e.type,P=e.streamProcessor,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0,V=void 0,z=void 0,W=void 0,q=void 0,Y=void 0,K=void 0,X=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0;function te(e,n){if(!X||!e||!P)return null;if(j)try{"function"==typeof(V=n&&n[D]?(0,o.default)(t).create(j,e,oe.bind(this),n[D]):(0,o.default)(t).create(j,e,oe.bind(this))).getBuffer().initialize&&V.getBuffer().initialize(D,P)}catch(e){N.fatal("Caught error on create SourceBuffer: "+e),A.mediaSourceError("Error creating "+D+" source buffer."),A.error(new g.default(v.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,v.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+D))}else V=(0,s.default)(t).create(oe.bind(this));return we(P.getRepresentationInfo(k).MSETimeOffset),V}function ne(e){e.fragmentModel===P.getFragmentModel()&&(N.info("Init fragment finished loading saving to",D+"'s init cache"),X.save(e.chunk),N.debug("Append Init fragment",D," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),ie(e.chunk))}function re(e){if(e.fragmentModel===P.getFragmentModel()){var n=e.chunk,r=n.bytes,i=n.quality,o=P.getRepresentationInfo(i),s=C.getEventsFor(o.mediaInfo,P),u=C.getEventsFor(o,P);if(s&&s.length>0||u&&u.length>0){var l=function(e,n,r,i){for(var a=Math.max(!n||isNaN(n.startTime)?0:n.startTime,0),o=[],s=[],u=r.concat(i),l=0,c=u.length;l<c;l++)o[u[l].schemeIdUri+"/"+u[l].value]=u[l];var d=(0,h.default)(t).getInstance().parse(e).getBoxes("emsg");for(l=0,c=d.length;l<c;l++){var f=C.getEvent(d[l],o,a);f&&s.push(f)}return s}(r,P.getFragmentModel().getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,quality:i,index:n.index})[0],s,u);P.addInbandEvents(l)}if($){ee=n;var c=V&&V.getAllBufferRanges();c&&c.length>0&&O.getTimeToStreamEnd()>E&&(N.debug("Clearing buffer because track changed - "+(c.end(c.length-1)+.5)),Ee([{start:0,end:c.end(c.length-1)+.5,force:!0}]))}else ie(n)}}function ie(e){V.append(e),e.mediaInfo.type===i.default.VIDEO&&n.trigger(d.default.VIDEO_CHUNK_RECEIVED,{chunk:e})}function ae(e){if(e&&e.length>0)for(var t=0,n=e.length;t<n;t++)N.debug("Buffered Range for type:",D,":",e.start(t)," - ",e.end(t)," currentTime = ",O.getTime())}function oe(e){if(e.error){if(22===e.error.code&&(U=.8*Oe(),N.warn("Quota exceeded for type: "+D+", Critical Buffer: "+U),U>0)){var t=Math.max(.2*U,1),r=U-t;f.setBufferToKeep(parseFloat(t.toFixed(5))),f.setBufferAheadToKeep(parseFloat(r.toFixed(5)))}22!==e.error.code&&De()||(N.warn("Clearing playback buffer to overcome quota exceed situation for type: "+D),n.trigger(d.default.QUOTA_EXCEEDED,{sender:L,criticalBufferLevel:U}),ce())}else{(q=e.chunk)&&!isNaN(q.index)&&(G=Math.max(q.index,G),ve());var i=V.getAllBufferRanges();if(q.segmentType===y.HTTPRequest.MEDIA_SEGMENT_TYPE)ae(i),de();else if($){var a=O.getTime();N.debug("AppendToBuffer seek target should be "+a),P.getScheduleController().setSeekTarget(a),C.setIndexHandlerTime(P,a)}var o={sender:L,quality:q.quality,startTime:q.start,index:q.index,bufferedRanges:i};q&&!q.endFragment?n.trigger(d.default.BYTES_APPENDED,o):q&&n.trigger(d.default.BYTES_APPENDED_END_FRAGMENT,o)}}function se(e){k!==e.newQuality&&D===e.mediaType&&P.getStreamInfo().id===e.streamInfo.id&&(we(P.getRepresentationInfo(e.newQuality).MSETimeOffset),k=e.newQuality)}function ue(){F&&(Z=!0,F=!1,H=Number.POSITIVE_INFINITY),D!==i.default.FRAGMENTED_TEXT?ce():de()}function le(){Q=void 0}function ce(){var e=function(){var e=[],t=V.getAllBufferRanges();if(!t||0===t.length)return e;var n=O.getTime(),r=t.end(t.length-1)+T,i=P.getFragmentModel().getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:S})[0];if(i){var o={start:0,end:i.startTime-E},s=P.getFragmentModel().getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:i.startTime-i.duration/2,threshold:S})[0];s&&s.startTime!=i.startTime&&(o.end=s.startTime),o.start<o.end&&o.end>t.start(0)&&e.push(o);var u={start:i.startTime+i.duration+E,end:r},l=P.getFragmentModel().getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:i.startTime+i.duration+E,threshold:S})[0];l&&l.startTime!==i.startTime&&(u.start=l.startTime+l.duration+E),u.start<u.end&&u.start<r&&e.push(u)}else N.debug("getAllRangesWithSafetyFactor for",D,"- No request found in current time position, removing full buffer 0 -",r),e.push({start:0,end:r});return e}();e&&0!==e.length||de(),Ee(e)}function de(){(!$||D===i.default.FRAGMENTED_TEXT&&R.isTextEnabled())&&(me(),ge())}function he(){ye()}function fe(){ye()}function pe(e,t){var n=V.getAllBufferRanges(),r=0,i=0,a=null,o=null,s=0,u=void 0,l=void 0,c=t||.15;if(null!=n){for(l=0,u=n.length;l<u;l++)if(r=n.start(l),i=n.end(l),null===a)s=Math.abs(r-e),(e>=r&&e<i||s<=c)&&(a=r,o=i);else{if(!((s=r-o)<=c))break;o=i}if(null!==a)return{start:a,end:o}}return null}function me(){var e,t,r;O&&(e=function(){var e=O.getTime();if(Q){var t=V.getAllBufferRanges();t&&t.length&&(e=Math.max(t.start(0),Q))}return e}()||0,B=null===(r=pe(e,t))?0:r.end-e,n.trigger(d.default.BUFFER_LEVEL_UPDATED,{sender:L,bufferLevel:B}),ye())}function ge(){P&&x&&P.getStreamInfo()&&(r.addBufferState(D,W,P.getScheduleController().getBufferTarget()),r.addBufferLevel(D,new Date,1e3*B))}function ve(){G>=H-1&&!F&&void 0===V.discharge&&(F=!0,N.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED"),n.trigger(d.default.BUFFERING_COMPLETED,{sender:L,streamInfo:P.getStreamInfo()}))}function ye(){"audio"!==D&&"video"!==D||(Z&&!F&&O&&O.getTimeToStreamEnd()-B<E&&(Z=!1,F=!0,N.debug("checkIfSufficientBuffer trigger BUFFERING_COMPLETED"),n.trigger(d.default.BUFFERING_COMPLETED,{sender:L,streamInfo:P.getStreamInfo()})),(!f.getLowLatencyEnabled()&&B<E||0===B)&&!F?_e(b):(F||B>=f.getStableBufferTime())&&_e(_))}function _e(e){W===e||e===b&&0===O.getTime()||D===i.default.FRAGMENTED_TEXT&&!R.isTextEnabled()||(W=e,ge(),n.trigger(d.default.BUFFER_LEVEL_STATE_CHANGED,{sender:L,state:e,mediaType:D,streamInfo:P.getStreamInfo()}),n.trigger(e===_?d.default.BUFFER_LOADED:d.default.BUFFER_EMPTY,{mediaType:D}),N.debug(e===_?"Got enough buffer to start for "+D:"Waiting for more buffer before starting playback for "+D))}function be(){V&&D!==i.default.FRAGMENTED_TEXT&&(F||Ee(function(){var e=[],t=V.getAllBufferRanges();if(!t||0===t.length)return e;var n=O.getTime(),r={start:Math.max(0,n-f.getBufferToKeep()),end:n+f.getBufferAheadToKeep()},i=P.getFragmentModel().getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:S})[0];if(i)r.start=Math.min(i.startTime,r.start),r.end=Math.max(i.startTime+i.duration,r.end);else if(0===n&&O.getIsDynamic())return[];if(t.start(0)<=r.start){for(var o={start:0,end:r.start},s=0;s<t.length&&t.end(s)<=r.start;s++)o.end=t.end(s);o.start<o.end&&e.push(o)}if(t.end(t.length-1)>=r.end){var u={start:r.end,end:t.end(t.length-1)+S};u.start<u.end&&e.push(u)}return e}()))}function Ee(e){e&&V&&0!==e.length&&(J.push.apply(J,e),K||Te())}function Te(){if(0===J.length||!V)return N.debug("Nothing to prune, halt pruning"),J=[],void(K=!1);var e=V.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return N.debug("SourceBuffer is empty (or does not exist), halt pruning"),J=[],void(K=!1);var t=J.shift();N.debug("Removing",D,"buffer from:",t.start,"to",t.end),K=!0;var n=O.getTime();n<t.end&&(F=!1,G=0,$||(P.getScheduleController().setSeekTarget(n),C.setIndexHandlerTime(P,n))),V.remove(t.start,t.end,t.force)}function Se(e){V===e.buffer&&(N.debug("onRemoved buffer from:",e.from,"to",e.to),ae(V.getAllBufferRanges()),0===J.length&&(K=!1),e.unintended&&(N.warn("Detected unintended removal from:",e.from,"to",e.to,"setting index handler time to",e.from),C.setIndexHandlerTime(P,e.from)),K?Te():($?($=!1,ee&&ie(ee)):(N.debug("onRemoved : call updateBufferLevel"),me()),n.trigger(d.default.BUFFER_CLEARED,{sender:L,from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:De()})))}function we(e){V&&V.updateTimestampOffset&&V.updateTimestampOffset(e)}function Ae(e){e.sender.getStreamProcessor()!==P||e.error||we(e.currentRepresentation.MSETimeOffset)}function xe(e){e.fragmentModel===P.getFragmentModel()&&(H=e.request.index,ve())}function Me(e){var t=V&&V.getAllBufferRanges();t&&e.newMediaInfo.type===D&&e.newMediaInfo.streamInfo.id===P.getStreamInfo().id&&(N.info("Track change asked"),M.getSwitchMode(D)===l.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&t&&t.length>0&&O.getTimeToStreamEnd()>E&&(F=!1,H=Number.POSITIVE_INFINITY))}function Ce(){++Y*(f.getWallclockTimeUpdateInterval()/1e3)>=f.getBufferPruningInterval()&&(Y=0,be())}function Re(){ye()}function Ie(e,t){j=e,V&&t&&"function"==typeof V.discharge&&(z=V,te(t))}function Oe(){var e,t=V.getAllBufferRanges(),n=0,r=void 0;if(!t)return n;for(r=0,e=t.length;r<e;r++)n+=t.end(r)-t.start(r);return n}function De(){return Oe()<U}function Pe(e,t){U=Number.POSITIVE_INFINITY,W=void 0,k=u.default.QUALITY_DEFAULT,H=Number.POSITIVE_INFINITY,G=0,q=null,F=!1,K=!1,Z=!1,B=0,Y=0,J=[],V&&(e||V.abort(),V.reset(t),V=null),$=!1}return L={getBufferControllerType:function(){return w},initialize:function(e){Ie(e),k=I.getQualityFor(D,P.getStreamInfo()),n.on(d.default.DATA_UPDATE_COMPLETED,Ae,this),n.on(d.default.INIT_FRAGMENT_LOADED,ne,this),n.on(d.default.MEDIA_FRAGMENT_LOADED,re,this),n.on(d.default.QUALITY_CHANGE_REQUESTED,se,this),n.on(d.default.STREAM_COMPLETED,xe,this),n.on(d.default.PLAYBACK_PLAYING,fe,this),n.on(d.default.PLAYBACK_PROGRESS,de,this),n.on(d.default.PLAYBACK_TIME_UPDATED,de,this),n.on(d.default.PLAYBACK_RATE_CHANGED,Re,this),n.on(d.default.PLAYBACK_SEEKING,ue,this),n.on(d.default.PLAYBACK_SEEKED,le,this),n.on(d.default.PLAYBACK_STALLED,he,this),n.on(d.default.WALLCLOCK_TIME_UPDATED,Ce,this),n.on(d.default.CURRENT_TRACK_CHANGED,Me,this,c.default.EVENT_PRIORITY_HIGH),n.on(d.default.SOURCEBUFFER_REMOVE_COMPLETED,Se,this)},createBuffer:te,dischargePreBuffer:function(){if(V&&z&&"function"==typeof z.discharge){var e=z.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+D+"PreBuffer discharge, adding buffer for:",n=0;n<e.length;n++)t+=" start: "+e.start(n)+", end: "+e.end(n)+";";N.debug(t)}else N.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");for(var r=z.discharge(),i=null,a=0;a<r.length;a++){var o=r[a],s=X.extract(o.streamId,o.representationId);s&&(i!==s&&(V.append(s),i=s),V.append(o))}z.reset(),z=null}},getType:function(){return D},getStreamProcessor:function(){return P},setSeekStartTime:function(e){Q=e},getBuffer:function(){return V},setBuffer:function(e){V=e},getBufferLevel:function(){return B},getRangeAt:pe,setMediaSource:Ie,getMediaSource:function(){return j},getIsBufferingCompleted:function(){return F},switchInitData:function(e,t,r){var i=X.extract(e,t);$=!0===r&&r,i?(N.info("Append Init fragment",D," with representationId:",i.representationId," and quality:",i.quality,", data size:",i.bytes.byteLength),ie(i)):n.trigger(d.default.INIT_REQUESTED,{sender:L})},getIsPruningInProgress:function(){return K},reset:function(e,t){n.off(d.default.DATA_UPDATE_COMPLETED,Ae,this),n.off(d.default.QUALITY_CHANGE_REQUESTED,se,this),n.off(d.default.INIT_FRAGMENT_LOADED,ne,this),n.off(d.default.MEDIA_FRAGMENT_LOADED,re,this),n.off(d.default.STREAM_COMPLETED,xe,this),n.off(d.default.CURRENT_TRACK_CHANGED,Me,this),n.off(d.default.PLAYBACK_PLAYING,fe,this),n.off(d.default.PLAYBACK_PROGRESS,de,this),n.off(d.default.PLAYBACK_TIME_UPDATED,de,this),n.off(d.default.PLAYBACK_RATE_CHANGED,Re,this),n.off(d.default.PLAYBACK_SEEKING,ue,this),n.off(d.default.PLAYBACK_SEEKED,le,this),n.off(d.default.PLAYBACK_STALLED,he,this),n.off(d.default.WALLCLOCK_TIME_UPDATED,Ce,this),n.off(d.default.SOURCEBUFFER_REMOVE_COMPLETED,Se,this),Pe(e,t)}},N=(0,p.default)(t).getInstance().getLogger(L),X=(0,m.default)(t).getInstance(),Pe(),L}A.__dashjs_factory_name=w;var x=f.default.getClassFactory(A);x.BUFFER_LOADED=_,x.BUFFER_EMPTY=b,f.default.updateClassFactory(A.__dashjs_factory_name,x),t.default=x,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null};r.ACTION_DOWNLOAD="download",r.ACTION_COMPLETE="complete",t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unescapeDollarsInTemplate=function(e){return e?e.split("$$").join("$"):e},t.replaceIDForTemplate=function(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)},t.replaceTokenForTemplate=u,t.getIndexBasedSegment=function(e,t,n,r){var i,o,u=void 0,l=void 0;l=n.segmentDuration,isNaN(l)&&(l=n.adaptation.period.duration);return i=parseFloat((n.adaptation.period.start+r*l).toFixed(5)),o=parseFloat((i+l).toFixed(5)),(u=new a.default).representation=n,u.duration=l,u.presentationStartTime=i,u.mediaStartTime=e.calcMediaTimeFromPresentationTime(u.presentationStartTime,n),u.availabilityStartTime=e.calcAvailabilityStartTimeFromPresentationTime(u.presentationStartTime,n.adaptation.period.mpd,t),u.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(o,n.adaptation.period.mpd,t),u.wallStartTime=e.calcWallTimeForSegment(u,t),u.replacementNumber=s(u,r),u.availabilityIdx=r,u},t.getTimeBasedSegment=function(e,t,n,r,i,o,l,c,d,h){var f,p,m=r/o,g=Math.min(i/o,n.adaptation.period.mpd.maxSegmentDuration),v=void 0;return f=e.calcPresentationTimeFromMediaTime(m,n),p=f+g,(v=new a.default).representation=n,v.duration=g,v.mediaStartTime=m,v.presentationStartTime=f,v.availabilityStartTime=n.adaptation.period.mpd.manifest.loadedTime,v.availabilityEndTime=e.calcAvailabilityEndTimeFromPresentationTime(p,n.adaptation.period.mpd,t),v.wallStartTime=e.calcWallTimeForSegment(v,t),v.replacementTime=h||r,v.replacementNumber=s(v,d),l=u(l,"Number",v.replacementNumber),l=u(l,"Time",v.replacementTime),v.media=l,v.mediaRange=c,v.availabilityIdx=d,v},t.getSegmentByIndex=l,t.decideSegmentListRangeForTemplate=function(e,t,n,r,i,a){var o=n.segmentDuration,s=n.adaptation.period.mpd.manifest.minBufferTime,u=n.segmentAvailabilityRange,c={start:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,u?u.start:NaN),end:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,u?u.end:NaN)},d=n.segments,h=2*o,f=a||Math.max(2*s,10*o),p=NaN,m=null,g=void 0,v=void 0;if(c.start=Math.max(c.start,0),t&&!e.isTimeSyncCompleted())return g=Math.floor(c.start/o),v=Math.floor(c.end/o),{start:g,end:v};d&&d.length>0?(m=l(i,n),p=m?e.calcPeriodRelativeTimeFromMpdRelativeTime(n,m.presentationStartTime):i>0?i*o:e.calcPeriodRelativeTimeFromMpdRelativeTime(n,r)):p=i>0?i*o:t?c.end:c.start;return g=Math.floor(Math.max(p-h,c.start)/o),v=Math.floor(Math.min(g+f/o,c.end/o)),{start:g,end:v}};var r,i=n(159),a=(r=i)&&r.__esModule?r:{default:r};function o(e,t){for(;e.length<t;)e="0"+e;return e}function s(e,t){return e.representation.startNumber+t}function u(e,t,n){var r=void 0,i=void 0,a=void 0,s=void 0,u=void 0,l=void 0,c=t.length,d="%0".length;if(!e)return e;for(;;){if((r=e.indexOf("$"+t))<0)return e;if((i=e.indexOf("$",r+c))<0)return e;if((a=e.indexOf("%0",r+c))>r&&a<i)switch(s=e.charAt(i-1),u=parseInt(e.substring(a+d,i-1),10),s){case"d":case"i":case"u":l=o(n.toString(),u);break;case"x":l=o(n.toString(16),u);break;case"X":l=o(n.toString(16),u).toUpperCase();break;case"o":l=o(n.toString(8),u);break;default:return e}else l=n;e=e.substring(0,r)+l+e.substring(i+1)}}function l(e,t){if(!t||!t.segments)return null;var n=t.segments.length,r=void 0,i=void 0;if(e<n&&(r=t.segments[e])&&r.availabilityIdx===e)return r;for(i=0;i<n;i++)if((r=t.segments[i])&&r.availabilityIdx===e)return r;return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready"}}]),e}());t.default=i,e.exports=t.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>"context"in e},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>"context"in e},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6),i=n(30);const a=e=>Object(i.a)(r.d,e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(6),i=n(30);const a=e=>Object(i.a)(r.e,e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>n=>{const r={value:e};return Object.defineProperties(n,{currentTarget:r,target:r}),"function"==typeof t?t.call(e,n):t.handleEvent.call(e,n)}},function(e,t,n){var r={parseBuffer:function(e){return new i(e).parse()},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(a.prototype._boxProcessors[e]=t)},createFile:function(){return new i},createBox:function(e,t,n){var r=a.create(e);return t&&t.append(r,n),r},createFullBox:function(e,t,n){var i=r.createBox(e,t,n);return i.version=0,i.flags=0,i},Utils:{}};r.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var r=[],i=0;if("utf-8"===n)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(i++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++)):(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++))),r.push(String.fromCharCode(a))}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("")},r.Utils.utf8ToByteArray=function(e){var t,n;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},r.Utils.appendBox=function(e,t,n){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==n)if(null!=n){var r,i=-1;if("number"==typeof n)i=n;else{if("string"==typeof n)r=n;else{if("object"!=typeof n||!n.type)return void e.boxes.push(t);r=n.type}for(var a=0;a<e.boxes.length;a++)if(r===e.boxes[a].type){i=a+1;break}}e.boxes.splice(i,0,t)}else e.boxes.push(t)},t.parseBuffer=r.parseBuffer,t.addBoxProcessor=r.addBoxProcessor,t.createFile=r.createFile,t.createBox=r.createBox,t.createFullBox=r.createFullBox,t.Utils=r.Utils,r.Cursor=function(e){this.offset=void 0===e?0:e};var i=function(e){this._cursor=new r.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};i.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},i.prototype.fetchAll=function(e,t){var n=[];return i._sweep.call(this,e,n,t),n},i.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=a.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},i._sweep=function(e,t,n){for(var r in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&n)return;i._sweep.call(this.boxes[r],e,t,n)}},i.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var n=new Uint8Array(t);for(this._rawo=new DataView(n.buffer),this.bytes=n,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return n.buffer},i.prototype.append=function(e,t){r.Utils.appendBox(this,e,t)};var a=function(){this._cursor=new r.Cursor};a.parse=function(e){var t=new a;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},a.create=function(e){var t=new a;return t.type=e,t.boxes=[],t},a.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],a.prototype._boxProcessors={},a.prototype._procField=function(e,t,n){this._parsing?this[e]=this._readField(t,n):this._writeField(t,n,this[e])},a.prototype._procFieldArray=function(e,t,n,r){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(n,r);else for(i=0;i<this[e].length;i++)this._writeField(n,r,this[e][i])},a.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},a.prototype._procEntries=function(e,t,n){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push({}),n.call(this,this[e][r]);else for(r=0;r<t;r++)n.call(this,this[e][r])},a.prototype._procSubEntries=function(e,t,n,r){var i;if(this._parsing)for(e[t]=[],i=0;i<n;i++)e[t].push({}),r.call(this,e[t][i]);else for(i=0;i<n;i++)r.call(this,e[t][i])},a.prototype._procEntryField=function(e,t,n,r){this._parsing?e[t]=this._readField(n,r):this._writeField(n,r,e[t])},a.prototype._procSubBoxes=function(e,t){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push(a.parse(this));else for(n=0;n<t;n++)this._rawo?this[e][n].write():this.size+=this[e][n].getLength()},a.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},a.prototype._readInt=function(e){var t=null,n=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(n);break;case 16:t=this._raw.getInt16(n);break;case 32:t=this._raw.getInt32(n);break;case 64:var r=this._raw.getInt32(n),i=this._raw.getInt32(n+4);t=r*Math.pow(2,32)+i}return this._cursor.offset+=e>>3,t},a.prototype._readUint=function(e){var t,n,r=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:r=this._raw.getUint8(i);break;case 16:r=this._raw.getUint16(i);break;case 24:r=((t=this._raw.getUint16(i))<<8)+(n=this._raw.getUint8(i+2));break;case 32:r=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),n=this._raw.getUint32(i+4),r=t*Math.pow(2,32)+n}return this._cursor.offset+=e>>3,r},a.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var r=this._readUint(8);t+=String.fromCharCode(r)}return t},a.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},a.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},a.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var n=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,n}return null},a.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?r.Utils.dataViewToString(t):t},a.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},a.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},a.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(a.parse(this))},a.prototype.append=function(e,t){r.Utils.appendBox(this,e,t)},a.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},a.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},a.prototype._writeInt=function(e,t){if(this._rawo){var n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(n,t);break;case 16:this._rawo.setInt16(n,t);break;case 32:this._rawo.setInt32(n,t);break;case 64:var r=Math.floor(t/Math.pow(2,32)),i=t-r*Math.pow(2,32);this._rawo.setUint32(n,r),this._rawo.setUint32(n+4,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},a.prototype._writeUint=function(e,t){if(this._rawo){var n,r,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:n=(16776960&t)>>8,r=255&t,this._rawo.setUint16(i,n),this._rawo.setUint8(i+2,r);break;case 32:this._rawo.setUint32(i,t);break;case 64:r=t-(n=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,n),this._rawo.setUint32(i+4,r)}this._cursor.offset+=e>>3}else this.size+=e>>3},a.prototype._writeString=function(e,t){for(var n=0;n<e;n++)this._writeUint(8,t.charCodeAt(n))},a.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},a.prototype._writeTemplate=function(e,t){var n=Math.floor(t),r=(t-n)*Math.pow(2,e/2);this._writeUint(e/2,n),this._writeUint(e/2,r)},a.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,n=0;n<e.length;n++)this._rawo.setInt8(t+n,e[n]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},a.prototype._writeUTF8String=function(e){var t=r.Utils.utf8ToByteArray(e);if(this._rawo)for(var n=new DataView(this._rawo.buffer,this._cursor.offset,t.length),i=0;i<t.length;i++)n.setUint8(i,t[i]);else this.size+=t.length},a.prototype._writeField=function(e,t,n){switch(e){case"uint":this._writeUint(t,n);break;case"int":this._writeInt(t,n);break;case"template":this._writeTemplate(t,n);break;case"string":-1==t?this._writeTerminatedString(n):this._writeString(t,n);break;case"data":this._writeData(n);break;case"utf8":this._writeUTF8String(n)}},a.prototype._boxProcessors.avc1=a.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},a.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},a.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)}))},a.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},a.prototype._boxProcessors.free=a.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},a.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},a.prototype._boxProcessors.ftyp=a.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},a.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},a.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},a.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},a.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},a.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},a.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},a.prototype._boxProcessors.mp4a=a.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},a.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},a.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},a.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},a.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},a.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},a.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,(function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)}))},a.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},a.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,(function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,(function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)}))}))},a.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},a.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,(function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)}))}))},a.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},a.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},a.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},a.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,(function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))}))},a.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},a.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},a.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,(function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)}))},a.prototype._boxProcessors["url "]=a.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},a.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},a.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},a.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},a.prototype._boxProcessors.vtte=function(){}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unescapeDollarsInTemplate=function(e){return e?e.split("$$").join("$"):e},t.replaceIDForTemplate=function(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)},t.replaceTokenForTemplate=s,t.getIndexBasedSegment=function(e,t,n,r){var i,a,o=void 0;o=n.segmentDuration,isNaN(o)&&(o=n.adaptation.period.duration);i=parseFloat((n.adaptation.period.start+r*o).toFixed(5)),a=parseFloat((i+o).toFixed(5));var s=u(n,o,i,e.calcMediaTimeFromPresentationTime(i,n),e.calcAvailabilityStartTimeFromPresentationTime(i,n.adaptation.period.mpd,t),e,a,t,r);if(!l(e,n,s,t))return null;return s},t.getTimeBasedSegment=function(e,t,n,r,i,a,o,c,d,h){var f,p,m=r/a,g=Math.min(i/a,n.adaptation.period.mpd.maxSegmentDuration),v=void 0;if(f=e.calcPresentationTimeFromMediaTime(m,n),p=f+g,v=u(n,g,f,m,n.adaptation.period.mpd.manifest.loadedTime,e,p,t,d),!l(e,n,v,t))return null;return v.replacementTime=h||r,o=s(o,"Number",v.replacementNumber),o=s(o,"Time",v.replacementTime),v.media=o,v.mediaRange=c,v};var r,i=n(139),a=(r=i)&&r.__esModule?r:{default:r};function o(e,t){for(;e.length<t;)e="0"+e;return e}function s(e,t,n){var r=void 0,i=void 0,a=void 0,s=void 0,u=void 0,l=void 0,c=t.length,d="%0".length;if(!e)return e;for(;;){if((r=e.indexOf("$"+t))<0)return e;if((i=e.indexOf("$",r+c))<0)return e;if((a=e.indexOf("%0",r+c))>r&&a<i)switch(s=e.charAt(i-1),u=parseInt(e.substring(a+d,i-1),10),s){case"d":case"i":case"u":l=o(n.toString(),u);break;case"x":l=o(n.toString(16),u);break;case"X":l=o(n.toString(16),u).toUpperCase();break;case"o":l=o(n.toString(8),u);break;default:return e}else l=n;e=e.substring(0,r)+l+e.substring(i+1)}}function u(e,t,n,r,i,o,s,u,l){var c,d=new a.default;return d.representation=e,d.duration=t,d.presentationStartTime=n,d.mediaStartTime=r,d.availabilityStartTime=i,d.availabilityEndTime=o.calcAvailabilityEndTimeFromPresentationTime(s,e.adaptation.period.mpd,u),d.wallStartTime=o.calcWallTimeForSegment(d,u),d.replacementNumber=(c=l,d.representation.startNumber+c),d.availabilityIdx=l,d}function l(e,t,n,r){var i=e.getPeriodEnd(t,r),a=e.calcPeriodRelativeTimeFromMpdRelativeTime(t,i);if(e.calcPeriodRelativeTimeFromMpdRelativeTime(t,n.presentationStartTime)>=a){if(!r)return!1;if(t.segmentAvailabilityRange&&n.presentationStartTime>=t.segmentAvailabilityRange.end)return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"===r.schemeIdUri.toLowerCase()&&"cenc"===r.value.toLowerCase()&&(t=r)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,n){var r=e.parsePSSHList(n);return t&&r.hasOwnProperty(t.uuid.toLowerCase())?r[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(e){if(null==e)return[];for(var t=new DataView(e.buffer||e),n={},r=0;;){var i,a,o=void 0,s=r;if(r>=t.buffer.byteLength)break;if(i=r+t.getUint32(r),r+=4,1886614376===t.getUint32(r))if(r+=4,0===(a=t.getUint8(r))||1===a){r++,r+=3,o="";var u=void 0,l=void 0;for(u=0;u<4;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=4,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<6;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;r+=6,o=o.toLowerCase(),t.getUint32(r),r+=4,n[o]=t.buffer.slice(s,i),r=i}else r=i;else r=i}return n}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return r(e,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors"}}]),e}());t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkParameterType=function(e,t){if(typeof e!==t)throw a.default.BAD_ARGUMENT_ERROR},t.checkInteger=function(e){if(null===e||isNaN(e)||e%1!=0)throw a.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"},t.checkRange=function(e,t,n){if(e<t||e>n)throw a.default.BAD_ARGUMENT_ERROR+" : argument out of range"},t.checkIsVideoOrAudioType=function(e){if("string"!=typeof e||e!==a.default.AUDIO&&e!==a.default.VIDEO)throw a.default.BAD_ARGUMENT_ERROR};var r,i=n(11),a=(r=i)&&r.__esModule?r:{default:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"===r.schemeIdUri.toLowerCase()&&"cenc"===r.value.toLowerCase()&&(t=r)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,r>0&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,n){var r=e.parsePSSHList(n);return r.hasOwnProperty(t.uuid.toLowerCase())?r[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?t.decodeArray(e.pssh.__text).buffer:null}},{key:"parsePSSHList",value:function(e){if(null===e)return[];for(var t=new DataView(e.buffer||e),n={},r=0;;){var i,a,o=void 0,s=r;if(r>=t.buffer.byteLength)break;if(i=r+t.getUint32(r),r+=4,1886614376===t.getUint32(r))if(r+=4,0===(a=t.getUint8(r))||1===a){r++,r+=3,o="";var u=void 0,l=void 0;for(u=0;u<4;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=4,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<2;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;for(r+=2,o+="-",u=0;u<6;u++)o+=1===(l=t.getUint8(r+u).toString(16)).length?"0"+l:l;r+=6,o=o.toLowerCase(),t.getUint32(r),r+=4,n[o]=t.buffer.slice(s,i),r=i}else r=i;else r=i}return n}}]),e}();t.default=i,e.exports=t.default},function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;void 0!==global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,t){var n,r,i;for(void 0===t&&(t=15),r=.5,n=new Date;;){for(i=r*=2;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;if(new Date-n>t)break}for(i=r;i>3;i-=4)e(),e(),e(),e();for(;i>0;)e(),i--;return 1e3*(3*r-1)/(new Date-n)},numeric._myIndexOf=function(e){var t,n=this.length;for(t=0;t<n;++t)if(this[t]===e)return t;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){var t=[];return function e(n){var r;if(void 0===n)return t.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof n)return t.push('"'+n+'"'),!1;if("boolean"==typeof n)return t.push(n.toString()),!1;if("number"==typeof n){var i=function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var n=Math.floor(Math.log(t)/Math.log(10)),r=t/Math.pow(10,n),i=r.toPrecision(numeric.precision);return 10===parseFloat(i)&&(n++,i=(r=1).toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+n.toString()}return"Infinity"}(n),a=n.toPrecision(numeric.precision),o=parseFloat(n.toString()).toString(),s=[i,a,o,parseFloat(a).toString(),parseFloat(o).toString()];for(r=1;r<s.length;r++)s[r].length<i.length&&(i=s[r]);return t.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===n)return t.push("null"),!1;if("function"==typeof n){t.push(n.toString());var u=!1;for(r in n)n.hasOwnProperty(r)&&(u?t.push(",\n"):t.push("\n{"),u=!0,t.push(r),t.push(": \n"),e(n[r]));return u&&t.push("}\n"),!0}if(n instanceof Array){if(n.length>numeric.largeArray)return t.push("...Large Array..."),!0;u=!1;for(t.push("["),r=0;r<n.length;r++)r>0&&(t.push(","),u&&t.push("\n ")),u=e(n[r]);return t.push("]"),!0}for(r in t.push("{"),u=!1,n)n.hasOwnProperty(r)&&(u&&t.push(",\n"),u=!0,t.push(r),t.push(": \n"),e(n[r]));return t.push("}"),!0}(e),t.join("")},numeric.parseDate=function(e){return function e(t){if("string"==typeof t)return Date.parse(t.replace(/-/g,"/"));if(!(t instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,r=[];for(n=0;n<t.length;n++)r[n]=e(t[n]);return r}(e)},numeric.parseFloat=function(e){return function e(t){if("string"==typeof t)return parseFloat(t);if(!(t instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,r=[];for(n=0;n<t.length;n++)r[n]=e(t[n]);return r}(e)},numeric.parseCSV=function(e){var t,n,r,i=e.split("\n"),a=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,u=0;for(n=0;n<i.length;n++){var l,c=(i[n]+",").match(o);if(c.length>0){for(a[u]=[],t=0;t<c.length;t++)l=(r=c[t]).substr(0,r.length-1),s.test(l)?a[u][t]=parseFloat(l):a[u][t]=l;u++}}return a},numeric.toCSV=function(e){var t,n,r,i,a,o=numeric.dim(e);for(r=o[0],o[1],a=[],t=0;t<r;t++){for(i=[],n=0;n<r;n++)i[n]=e[t][n].toString();a[t]=i.join(", ")}return a.join("\n")+"\n"},numeric.getURL=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t},numeric.imageURL=function(e){function t(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.length);var r,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],a=-1;e.length;for(r=t;r<n;r++)a=a>>>8^i[255&(a^e[r])];return-1^a}var n,r,i,a,o,s,u,l,c,d,h=e[0].length,f=e[0][0].length,p=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,h>>24&255,h>>16&255,h>>8&255,255&h,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(d=t(p,12,29),p[29]=d>>24&255,p[30]=d>>16&255,p[31]=d>>8&255,p[32]=255&d,n=1,r=0,u=0;u<h;u++){for(u<h-1?p.push(0):p.push(1),o=3*f+1+(0===u)&255,s=3*f+1+(0===u)>>8&255,p.push(o),p.push(s),p.push(255&~o),p.push(255&~s),0===u&&p.push(0),l=0;l<f;l++)for(i=0;i<3;i++)r=(r+(n=(n+(o=(o=e[i][u][l])>255?255:o<0?0:Math.round(o)))%65521))%65521,p.push(o);p.push(0)}return c=(r<<16)+n,p.push(c>>24&255),p.push(c>>16&255),p.push(c>>8&255),p.push(255&c),a=p.length-41,p[33]=a>>24&255,p[34]=a>>16&255,p[35]=a>>8&255,p[36]=255&a,d=t(p,37),p.push(d>>24&255),p.push(d>>16&255),p.push(d>>8&255),p.push(255&d),p.push(0),p.push(0),p.push(0),p.push(0),p.push(73),p.push(69),p.push(78),p.push(68),p.push(174),p.push(66),p.push(96),p.push(130),"data:image/png;base64,"+function(e){var t,n,r,i,a,o,s,u=e.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(t=0;t<u;t+=3)a=((3&(n=e[t]))<<4)+((r=e[t+1])>>4),o=((15&r)<<2)+((i=e[t+2])>>6),s=63&i,t+1>=u?o=s=64:t+2>=u&&(s=64),c+=l.charAt(n>>2)+l.charAt(a)+l.charAt(o)+l.charAt(s);return c}(p)},numeric._dim=function(e){for(var t=[];"object"==typeof e;)t.push(e.length),e=e[0];return t},numeric.dim=function(e){var t;return"object"==typeof e?"object"==typeof(t=e[0])?"object"==typeof t[0]?numeric._dim(e):[e.length,t.length]:[e.length]:[]},numeric.mapreduce=function(e,t){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+t+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,t){return Function("x","var n = x.length;\nvar i,xi;\n"+t+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(t,n){var r,i;if(!(t instanceof Array&&n instanceof Array))return!1;if((i=t.length)!==n.length)return!1;for(r=0;r<i;r++)if(t[r]!==n[r]){if("object"!=typeof t[r])return!1;if(!e(t[r],n[r]))return!1}return!0},numeric.rep=function(e,t,n){void 0===n&&(n=0);var r,i=e[n],a=Array(i);if(n===e.length-1){for(r=i-2;r>=0;r-=2)a[r+1]=t,a[r]=t;return-1===r&&(a[0]=t),a}for(r=i-1;r>=0;r--)a[r]=numeric.rep(e,t,n+1);return a},numeric.dotMMsmall=function(e,t){var n,r,i,a,o,s,u,l,c,d,h;for(a=e.length,o=t.length,s=t[0].length,u=Array(a),n=a-1;n>=0;n--){for(l=Array(s),c=e[n],i=s-1;i>=0;i--){for(d=c[o-1]*t[o-1][i],r=o-2;r>=1;r-=2)h=r-1,d+=c[r]*t[r][i]+c[h]*t[h][i];0===r&&(d+=c[0]*t[0][i]),l[i]=d}u[n]=l}return u},numeric._getCol=function(e,t,n){var r;for(r=e.length-1;r>0;--r)n[r]=e[r][t],n[--r]=e[r][t];0===r&&(n[0]=e[0][t])},numeric.dotMMbig=function(e,t){var n,r,i,a=numeric._getCol,o=t.length,s=Array(o),u=e.length,l=t[0].length,c=new Array(u),d=numeric.dotVV;for(--o,r=--u;-1!==r;--r)c[r]=Array(l);for(r=--l;-1!==r;--r)for(a(t,r,s),i=u;-1!==i;--i)0,n=e[i],c[i][r]=d(n,s);return c},numeric.dotMV=function(e,t){var n,r=e.length,i=(t.length,Array(r)),a=numeric.dotVV;for(n=r-1;n>=0;n--)i[n]=a(e[n],t);return i},numeric.dotVM=function(e,t){var n,r,i,a,o,s,u;for(i=e.length,a=t[0].length,o=Array(a),r=a-1;r>=0;r--){for(s=e[i-1]*t[i-1][r],n=i-2;n>=1;n-=2)u=n-1,s+=e[n]*t[n][r]+e[u]*t[u][r];0===n&&(s+=e[0]*t[0][r]),o[r]=s}return o},numeric.dotVV=function(e,t){var n,r,i=e.length,a=e[i-1]*t[i-1];for(n=i-2;n>=1;n-=2)r=n-1,a+=e[n]*t[n]+e[r]*t[r];return 0===n&&(a+=e[0]*t[0]),a},numeric.dot=function(e,t){var n=numeric.dim;switch(1e3*n(e).length+n(t).length){case 2002:return t.length<10?numeric.dotMMsmall(e,t):numeric.dotMMbig(e,t);case 2001:return numeric.dotMV(e,t);case 1002:return numeric.dotVM(e,t);case 1001:return numeric.dotVV(e,t);case 1e3:return numeric.mulVS(e,t);case 1:return numeric.mulSV(e,t);case 0:return e*t;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var t,n,r,i,a=e.length,o=Array(a);for(t=a-1;t>=0;t--){for(i=Array(a),n=t+2,r=a-1;r>=n;r-=2)i[r]=0,i[r-1]=0;for(r>t&&(i[r]=0),i[t]=e[t],r=t-1;r>=1;r-=2)i[r]=0,i[r-1]=0;0===r&&(i[0]=0),o[t]=i}return o},numeric.getDiag=function(e){var t,n=Math.min(e.length,e[0].length),r=Array(n);for(t=n-1;t>=1;--t)r[t]=e[t][t],r[--t]=e[t][t];return 0===t&&(r[0]=e[0][0]),r},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,t,n){void 0===n&&(n="");var r,i,a=[],o=/\[i\]$/,s="",u=!1;for(r=0;r<e.length;r++)o.test(e[r])?s=i=e[r].substring(0,e[r].length-3):i=e[r],"ret"===i&&(u=!0),a.push(i);return a[e.length]="_s",a[e.length+1]="_k",a[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+t+"\n}\nreturn ret;",Function.apply(null,a)},numeric.pointwise2=function(e,t,n){void 0===n&&(n="");var r,i,a=[],o=/\[i\]$/,s="",u=!1;for(r=0;r<e.length;r++)o.test(e[r])?s=i=e[r].substring(0,e[r].length-3):i=e[r],"ret"===i&&(u=!0),a.push(i);return a[e.length]="var _n = "+s+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+t+"\n}\nreturn ret;",Function.apply(null,a)},numeric._biforeach=function e(t,n,r,i,a){var o;if(i!==r.length-1)for(o=r[i]-1;o>=0;o--)e("object"==typeof t?t[o]:t,"object"==typeof n?n[o]:n,r,i+1,a);else a(t,n)},numeric._biforeach2=function e(t,n,r,i,a){if(i===r.length-1)return a(t,n);var o,s=r[i],u=Array(s);for(o=s-1;o>=0;--o)u[o]=e("object"==typeof t?t[o]:t,"object"==typeof n?n[o]:n,r,i+1,a);return u},numeric._foreach=function e(t,n,r,i){var a;if(r!==n.length-1)for(a=n[r]-1;a>=0;a--)e(t[a],n,r+1,i);else i(t)},numeric._foreach2=function e(t,n,r,i){if(r===n.length-1)return i(t);var a,o=n[r],s=Array(o);for(a=o-1;a>=0;a--)s[a]=e(t[a],n,r+1,i);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,t;for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],numeric.ops2[t]=t;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){t=numeric.ops2[e];var n,r,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(i="var "+t+" = Math."+t+";\n",n=function(e,n,r){return e+" = "+t+"("+n+","+r+")"},r=function(e,n){return e+" = "+t+"("+e+","+n+")"}):(n=function(e,n,r){return e+" = "+n+" "+t+" "+r},r=numeric.opseq.hasOwnProperty(e+"eq")?function(e,n){return e+" "+t+"= "+n}:function(e,n){return e+" = "+e+" "+t+" "+n}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),i),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),i),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),i),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),numeric[t]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),i),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),i),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)t=numeric.mathfuns2[e],delete numeric.ops2[t];for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],numeric.ops1[t]=t;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(i="",t=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(t)&&(i="var "+t+" = Math."+t+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",i),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+t+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",i),numeric[e]=Function("x",'if(typeof x !== "object") return '+t+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)t=numeric.mathfuns[e],delete numeric.ops1[t];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(t=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(t[0],t[1]),numeric[e]=Function("x","s","k",t[1]+'if(typeof x !== "object") {    xi = x;\n'+t[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+t[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,t){return"object"==typeof e?"object"==typeof t?numeric.truncVV(e,t):numeric.truncVS(e,t):"object"==typeof t?numeric.truncSV(e,t):Math.round(e/t)*t},numeric.inv=function(e){var t,n,r,i,a,o,s,u=numeric.dim(e),l=Math.abs,c=u[0],d=u[1],h=numeric.clone(e),f=numeric.identity(c);for(o=0;o<d;++o){var p=-1,m=-1;for(a=o;a!==c;++a)(s=l(h[a][o]))>m&&(p=a,m=s);for(n=h[p],h[p]=h[o],h[o]=n,i=f[p],f[p]=f[o],f[o]=i,e=n[o],s=o;s!==d;++s)n[s]/=e;for(s=d-1;-1!==s;--s)i[s]/=e;for(a=c-1;-1!==a;--a)if(a!==o){for(t=h[a],r=f[a],e=t[o],s=o+1;s!==d;++s)t[s]-=n[s]*e;for(s=d-1;s>0;--s)r[s]-=i[s]*e,r[--s]-=i[s]*e;0===s&&(r[0]-=i[0]*e)}}return f},numeric.det=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: det() only works on square matrices");var n,r,i,a,o,s,u,l,c=t[0],d=1,h=numeric.clone(e);for(r=0;r<c-1;r++){for(i=r,n=r+1;n<c;n++)Math.abs(h[n][r])>Math.abs(h[i][r])&&(i=n);for(i!==r&&(u=h[i],h[i]=h[r],h[r]=u,d*=-1),a=h[r],n=r+1;n<c;n++){for(s=(o=h[n])[r]/a[r],i=r+1;i<c-1;i+=2)l=i+1,o[i]-=a[i]*s,o[l]-=a[l]*s;i!==c&&(o[i]-=a[i]*s)}if(0===a[r])return 0;d*=a[r]}return d*h[r][r]},numeric.transpose=function(e){var t,n,r,i,a,o=e.length,s=e[0].length,u=Array(s);for(n=0;n<s;n++)u[n]=Array(o);for(t=o-1;t>=1;t-=2){for(i=e[t],r=e[t-1],n=s-1;n>=1;--n)(a=u[n])[t]=i[n],a[t-1]=r[n],(a=u[--n])[t]=i[n],a[t-1]=r[n];0===n&&((a=u[0])[t]=i[0],a[t-1]=r[0])}if(0===t){for(r=e[0],n=s-1;n>=1;--n)u[n][0]=r[n],u[--n][0]=r[n];0===n&&(u[0][0]=r[0])}return u},numeric.negtranspose=function(e){var t,n,r,i,a,o=e.length,s=e[0].length,u=Array(s);for(n=0;n<s;n++)u[n]=Array(o);for(t=o-1;t>=1;t-=2){for(i=e[t],r=e[t-1],n=s-1;n>=1;--n)(a=u[n])[t]=-i[n],a[t-1]=-r[n],(a=u[--n])[t]=-i[n],a[t-1]=-r[n];0===n&&((a=u[0])[t]=-i[0],a[t-1]=-r[0])}if(0===t){for(r=e[0],n=s-1;n>=1;--n)u[n][0]=-r[n],u[--n][0]=-r[n];0===n&&(u[0][0]=-r[0])}return u},numeric._random=function e(t,n){var r,i,a=t[n],o=Array(a);if(n===t.length-1){for(i=Math.random,r=a-1;r>=1;r-=2)o[r]=i(),o[r-1]=i();return 0===r&&(o[0]=i()),o}for(r=a-1;r>=0;r--)o[r]=e(t,n+1);return o},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,t,n){if(void 0===n&&(n=Math.max(Math.round(t-e)+1,1)),n<2)return 1===n?[e]:[];var r,i=Array(n);for(r=--n;r>=0;r--)i[r]=(r*t+(n-r)*e)/n;return i},numeric.getBlock=function(e,t,n){var r=numeric.dim(e);return function e(i,a){var o,s=t[a],u=n[a]-s,l=Array(u);if(a===r.length-1){for(o=u;o>=0;o--)l[o]=i[o+s];return l}for(o=u;o>=0;o--)l[o]=e(i[o+s],a+1);return l}(e,0)},numeric.setBlock=function(e,t,n,r){var i=numeric.dim(e);return function e(r,a,o){var s,u=t[o],l=n[o]-u;if(o===i.length-1)for(s=l;s>=0;s--)r[s+u]=a[s];for(s=l;s>=0;s--)e(r[s+u],a[s],o+1)}(e,r,0),e},numeric.getRange=function(e,t,n){var r,i,a,o,s=t.length,u=n.length,l=Array(s);for(r=s-1;-1!==r;--r)for(l[r]=Array(u),a=l[r],o=e[t[r]],i=u-1;-1!==i;--i)a[i]=o[n[i]];return l},numeric.blockMatrix=function(e){var t=numeric.dim(e);if(t.length<4)return numeric.blockMatrix([e]);var n,r,i,a,o,s=t[0],u=t[1];for(n=0,r=0,i=0;i<s;++i)n+=e[i][0].length;for(a=0;a<u;++a)r+=e[0][a][0].length;var l=Array(n);for(i=0;i<n;++i)l[i]=Array(r);var c,d,h,f,p,m=0;for(i=0;i<s;++i){for(c=r,a=u-1;-1!==a;--a)for(c-=(o=e[i][a])[0].length,h=o.length-1;-1!==h;--h)for(p=o[h],d=l[m+h],f=p.length-1;-1!==f;--f)d[c+f]=p[f];m+=e[i][0].length}return l},numeric.tensor=function(e,t){if("number"==typeof e||"number"==typeof t)return numeric.mul(e,t);var n=numeric.dim(e),r=numeric.dim(t);if(1!==n.length||1!==r.length)throw new Error("numeric: tensor product is only defined for vectors");var i,a,o,s,u=n[0],l=r[0],c=Array(u);for(a=u-1;a>=0;a--){for(i=Array(l),s=e[a],o=l-1;o>=3;--o)i[o]=s*t[o],i[--o]=s*t[o],i[--o]=s*t[o],i[--o]=s*t[o];for(;o>=0;)i[o]=s*t[o],--o;c[a]=i}return c},numeric.T=function(e,t){this.x=e,this.y=t},numeric.t=function(e,t){return new numeric.T(e,t)},numeric.Tbinop=function(e,t,n,r,i){var a;numeric.indexOf;if("string"!=typeof i)for(a in i="",numeric)numeric.hasOwnProperty(a)&&(e.indexOf(a)>=0||t.indexOf(a)>=0||n.indexOf(a)>=0||r.indexOf(a)>=0)&&a.length>1&&(i+="var "+a+" = numeric."+a+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+r+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+t+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,t=numeric.div;if(this.y){var n=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(t(this.x,n),t(numeric.neg(this.y),n))}return new T(t(1,this.x))},numeric.T.prototype.div=function(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var t=numeric.div;return this.y?new numeric.T(t(this.x,e.x),t(this.y,e.x)):new numeric.T(t(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),e(n)):new numeric.T(e(t))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,t=this.x,n=this.y;return n?new numeric.T(e(t),numeric.negtranspose(n)):new numeric.T(e(t))},numeric.Tunop=function(e,t,n){return"string"!=typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+t+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if(void 0===e.y)return new numeric.T(numeric.inv(e.x));var t,n,r,i,a,o,s,u,l,c,d,h,f,p,m,g,v,y,_=e.x.length,b=numeric.identity(_),E=numeric.rep([_,_],0),T=numeric.clone(e.x),S=numeric.clone(e.y);for(l=0;l<_;l++){for(h=(p=T[l][l])*p+(m=S[l][l])*m,d=l,c=l+1;c<_;c++)(f=(p=T[c][l])*p+(m=S[c][l])*m)>h&&(d=c,h=f);for(d!==l&&(y=T[l],T[l]=T[d],T[d]=y,y=S[l],S[l]=S[d],S[d]=y,y=b[l],b[l]=b[d],b[d]=y,y=E[l],E[l]=E[d],E[d]=y),t=T[l],n=S[l],a=b[l],o=E[l],p=t[l],m=n[l],c=l+1;c<_;c++)g=t[c],v=n[c],t[c]=(g*p+v*m)/h,n[c]=(v*p-g*m)/h;for(c=0;c<_;c++)g=a[c],v=o[c],a[c]=(g*p+v*m)/h,o[c]=(v*p-g*m)/h;for(c=l+1;c<_;c++){for(r=T[c],i=S[c],s=b[c],u=E[c],p=r[l],m=i[l],d=l+1;d<_;d++)g=t[d],v=n[d],r[d]-=g*p-v*m,i[d]-=v*p+g*m;for(d=0;d<_;d++)g=a[d],v=o[d],s[d]-=g*p-v*m,u[d]-=v*p+g*m}}for(l=_-1;l>0;l--)for(a=b[l],o=E[l],c=l-1;c>=0;c--)for(s=b[c],u=E[c],p=T[c][l],m=S[c][l],d=_-1;d>=0;d--)g=a[d],v=o[d],s[d]-=p*g-m*v,u[d]-=p*v+m*g;return new numeric.T(b,E)},numeric.T.prototype.get=function(e){var t,n=this.x,r=this.y,i=0,a=e.length;if(r){for(;i<a;)n=n[t=e[i]],r=r[t],i++;return new numeric.T(n,r)}for(;i<a;)n=n[t=e[i]],i++;return new numeric.T(n)},numeric.T.prototype.set=function(e,t){var n,r=this.x,i=this.y,a=0,o=e.length,s=t.x,u=t.y;if(0===o)return u?this.y=u:i&&(this.y=void 0),this.x=r,this;if(u){for(i||(i=numeric.rep(numeric.dim(r),0),this.y=i);a<o-1;)r=r[n=e[a]],i=i[n],a++;return r[n=e[a]]=s,i[n]=u,this}if(i){for(;a<o-1;)r=r[n=e[a]],i=i[n],a++;return r[n=e[a]]=s,i[n]=s instanceof Array?numeric.rep(numeric.dim(s),0):0,this}for(;a<o-1;)r=r[n=e[a]],a++;return r[n=e[a]]=s,this},numeric.T.prototype.getRows=function(e,t){var n,r,i=t-e+1,a=Array(i),o=this.x,s=this.y;for(n=e;n<=t;n++)a[n-e]=o[n];if(s){for(r=Array(i),n=e;n<=t;n++)r[n-e]=s[n];return new numeric.T(a,r)}return new numeric.T(a)},numeric.T.prototype.setRows=function(e,t,n){var r,i=this.x,a=this.y,o=n.x,s=n.y;for(r=e;r<=t;r++)i[r]=o[r-e];if(s)for(a||(a=numeric.rep(numeric.dim(i),0),this.y=a),r=e;r<=t;r++)a[r]=s[r-e];else if(a)for(r=e;r<=t;r++)a[r]=numeric.rep([o[r-e].length],0);return this},numeric.T.prototype.getRow=function(e){var t=this.x,n=this.y;return n?new numeric.T(t[e],n[e]):new numeric.T(t[e])},numeric.T.prototype.setRow=function(e,t){var n=this.x,r=this.y,i=t.x,a=t.y;return n[e]=i,a?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[e]=a):r&&(r=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(e,t){var n=this.x,r=this.y,i=numeric.getBlock;return r?new numeric.T(i(n,e,t),i(r,e,t)):new numeric.T(i(n,e,t))},numeric.T.prototype.setBlock=function(e,t,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,i=this.y,a=numeric.setBlock,o=n.x,s=n.y;if(s)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),a(r,e,t,o),a(i,e,t,s),this;a(r,e,t,o),i&&a(i,e,t,numeric.rep(numeric.dim(o),0))},numeric.T.rep=function(e,t){var n=numeric.T;t instanceof n||(t=new n(t));var r=t.x,i=t.y,a=numeric.rep;return i?new n(a(e,r),a(e,i)):new n(a(e,r))},numeric.T.diag=function(e){e instanceof numeric.T||(e=new numeric.T(e));var t=e.x,n=e.y,r=numeric.diag;return n?new numeric.T(r(t),r(n)):new numeric.T(r(t))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,t=this.x,n=this.y;return n?new e.T(e.getDiag(t),e.getDiag(n)):new e.T(e.getDiag(t))},numeric.house=function(e){var t=numeric.clone(e),n=(e[0]>=0?1:-1)*numeric.norm2(e);t[0]+=n;var r=numeric.norm2(t);if(0===r)throw new Error("eig: internal error");return numeric.div(t,r)},numeric.toUpperHessenberg=function(e){var t=numeric.dim(e);if(2!==t.length||t[0]!==t[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,r,i,a,o,s,u,l,c,d,h=t[0],f=numeric.clone(e),p=numeric.identity(h);for(r=0;r<h-2;r++){for(a=Array(h-r-1),n=r+1;n<h;n++)a[n-r-1]=f[n][r];if(numeric.norm2(a)>0){for(o=numeric.house(a),s=numeric.getBlock(f,[r+1,r],[h-1,h-1]),u=numeric.tensor(o,numeric.dot(o,s)),n=r+1;n<h;n++)for(l=f[n],c=u[n-r-1],i=r;i<h;i++)l[i]-=2*c[i-r];for(s=numeric.getBlock(f,[0,r+1],[h-1,h-1]),u=numeric.tensor(numeric.dot(s,o),o),n=0;n<h;n++)for(l=f[n],c=u[n],i=r+1;i<h;i++)l[i]-=2*c[i-r-1];for(s=Array(h-r-1),n=r+1;n<h;n++)s[n-r-1]=p[n];for(u=numeric.tensor(o,numeric.dot(o,s)),n=r+1;n<h;n++)for(d=p[n],c=u[n-r-1],i=0;i<h;i++)d[i]-=2*c[i]}}return{H:f,Q:p}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(e,t){void 0===t&&(t=1e4),e=numeric.clone(e);numeric.clone(e);var n,r,i,a,o,s,u,l,c,d,h,f,p,m,g,v,y,_,b=numeric.dim(e)[0],E=numeric.identity(b);if(b<3)return{Q:E,B:[[0,b-1]]};var T=numeric.epsilon;for(_=0;_<t;_++){for(v=0;v<b-1;v++)if(Math.abs(e[v+1][v])<T*(Math.abs(e[v][v])+Math.abs(e[v+1][v+1]))){var S=numeric.QRFrancis(numeric.getBlock(e,[0,0],[v,v]),t),w=numeric.QRFrancis(numeric.getBlock(e,[v+1,v+1],[b-1,b-1]),t);for(f=Array(v+1),g=0;g<=v;g++)f[g]=E[g];for(p=numeric.dot(S.Q,f),g=0;g<=v;g++)E[g]=p[g];for(f=Array(b-v-1),g=v+1;g<b;g++)f[g-v-1]=E[g];for(p=numeric.dot(w.Q,f),g=v+1;g<b;g++)E[g]=p[g-v-1];return{Q:E,B:S.B.concat(numeric.add(w.B,v+1))}}var A,x,M;if(i=e[b-2][b-2],a=e[b-2][b-1],o=e[b-1][b-2],l=i+(s=e[b-1][b-1]),u=i*s-a*o,c=numeric.getBlock(e,[0,0],[2,2]),l*l>=4*u)A=.5*(l+Math.sqrt(l*l-4*u)),x=.5*(l-Math.sqrt(l*l-4*u)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,A+x)),numeric.diag(numeric.rep([3],A*x)));else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,l)),numeric.diag(numeric.rep([3],u)));for(n=[c[0][0],c[1][0],c[2][0]],r=numeric.house(n),f=[e[0],e[1],e[2]],p=numeric.tensor(r,numeric.dot(r,f)),g=0;g<3;g++)for(h=e[g],m=p[g],y=0;y<b;y++)h[y]-=2*m[y];for(f=numeric.getBlock(e,[0,0],[b-1,2]),p=numeric.tensor(numeric.dot(f,r),r),g=0;g<b;g++)for(h=e[g],m=p[g],y=0;y<3;y++)h[y]-=2*m[y];for(f=[E[0],E[1],E[2]],p=numeric.tensor(r,numeric.dot(r,f)),g=0;g<3;g++)for(d=E[g],m=p[g],y=0;y<b;y++)d[y]-=2*m[y];for(v=0;v<b-2;v++){for(y=v;y<=v+1;y++)if(Math.abs(e[y+1][y])<T*(Math.abs(e[y][y])+Math.abs(e[y+1][y+1]))){S=numeric.QRFrancis(numeric.getBlock(e,[0,0],[y,y]),t),w=numeric.QRFrancis(numeric.getBlock(e,[y+1,y+1],[b-1,b-1]),t);for(f=Array(y+1),g=0;g<=y;g++)f[g]=E[g];for(p=numeric.dot(S.Q,f),g=0;g<=y;g++)E[g]=p[g];for(f=Array(b-y-1),g=y+1;g<b;g++)f[g-y-1]=E[g];for(p=numeric.dot(w.Q,f),g=y+1;g<b;g++)E[g]=p[g-y-1];return{Q:E,B:S.B.concat(numeric.add(w.B,y+1))}}for(M=Math.min(b-1,v+3),n=Array(M-v),g=v+1;g<=M;g++)n[g-v-1]=e[g][v];for(r=numeric.house(n),f=numeric.getBlock(e,[v+1,v],[M,b-1]),p=numeric.tensor(r,numeric.dot(r,f)),g=v+1;g<=M;g++)for(h=e[g],m=p[g-v-1],y=v;y<b;y++)h[y]-=2*m[y-v];for(f=numeric.getBlock(e,[0,v+1],[b-1,M]),p=numeric.tensor(numeric.dot(f,r),r),g=0;g<b;g++)for(h=e[g],m=p[g],y=v+1;y<=M;y++)h[y]-=2*m[y-v-1];for(f=Array(M-v),g=v+1;g<=M;g++)f[g-v-1]=E[g];for(p=numeric.tensor(r,numeric.dot(r,f)),g=v+1;g<=M;g++)for(d=E[g],m=p[g-v-1],y=0;y<b;y++)d[y]-=2*m[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,t){var n,r,i,a,o,s,u,l,c,d,h,f,p,m,g,v,y=numeric.toUpperHessenberg(e),_=numeric.QRFrancis(y.H,t),b=numeric.T,E=e.length,T=_.B,S=numeric.dot(_.Q,numeric.dot(y.H,numeric.transpose(_.Q))),w=new b(numeric.dot(_.Q,y.Q)),A=T.length,x=Math.sqrt;for(r=0;r<A;r++)if((n=T[r][0])===T[r][1]);else{if(a=n+1,o=S[n][n],s=S[n][a],u=S[a][n],l=S[a][a],0===s&&0===u)continue;(d=(c=-o-l)*c-4*(o*l-s*u))>=0?((g=(o-(h=c<0?-.5*(c-x(d)):-.5*(c+x(d))))*(o-h)+s*s)>(v=u*u+(l-h)*(l-h))?(p=(o-h)/(g=x(g)),m=s/g):(p=u/(v=x(v)),m=(l-h)/v),i=new b([[m,-p],[p,m]]),w.setRows(n,a,i.dot(w.getRows(n,a)))):(h=-.5*c,f=.5*x(-d),(g=(o-h)*(o-h)+s*s)>(v=u*u+(l-h)*(l-h))?(p=(o-h)/(g=x(g+f*f)),m=s/g,h=0,f/=g):(p=u/(v=x(v+f*f)),m=(l-h)/v,h=f/v,f=0),i=new b([[m,-p],[p,m]],[[h,f],[f,-h]]),w.setRows(n,a,i.dot(w.getRows(n,a))))}var M=w.dot(e).dot(w.transjugate()),C=(E=e.length,numeric.T.identity(E));for(a=0;a<E;a++)if(a>0)for(r=a-1;r>=0;r--){var R=M.get([r,r]),I=M.get([a,a]);numeric.neq(R.x,I.x)||numeric.neq(R.y,I.y)?(h=M.getRow(r).getBlock([r],[a-1]),f=C.getRow(a).getBlock([r],[a-1]),C.set([a,r],M.get([r,a]).neg().sub(h.dot(f)).div(R.sub(I)))):C.setRow(a,C.getRow(r))}for(a=0;a<E;a++)h=C.getRow(a),C.setRow(a,h.div(h.norm2()));return C=C.transpose(),C=w.transjugate().dot(C),{lambda:M.getDiag(),E:C}},numeric.ccsSparse=function(e){var t,n,r,i=e.length,a=[];for(n=i-1;-1!==n;--n)for(r in t=e[n]){for(r=parseInt(r);r>=a.length;)a[a.length]=0;0!==t[r]&&a[r]++}var o=a.length,s=Array(o+1);for(s[0]=0,n=0;n<o;++n)s[n+1]=s[n]+a[n];var u=Array(s[o]),l=Array(s[o]);for(n=i-1;-1!==n;--n)for(r in t=e[n])0!==t[r]&&(a[r]--,u[s[r]+a[r]]=n,l[s[r]+a[r]]=t[r]);return[s,u,l]},numeric.ccsFull=function(e){var t,n,r,i,a=e[0],o=e[1],s=e[2],u=numeric.ccsDim(e),l=u[0],c=u[1],d=numeric.rep([l,c],0);for(t=0;t<c;t++)for(r=a[t],i=a[t+1],n=r;n<i;++n)d[o[n]][t]=s[n];return d},numeric.ccsTSolve=function(e,t,n,r,i){var a,o,s,u,l,c,d,h=e[0],f=e[1],p=e[2],m=h.length-1,g=Math.max,v=0;function y(e){var t;if(0===n[e]){for(n[e]=1,t=h[e];t<h[e+1];++t)y(f[t]);i[v]=e,++v}}for(void 0===r&&(n=numeric.rep([m],0)),void 0===r&&(r=numeric.linspace(0,n.length-1)),void 0===i&&(i=[]),a=r.length-1;-1!==a;--a)y(r[a]);for(i.length=v,a=i.length-1;-1!==a;--a)n[i[a]]=0;for(a=r.length-1;-1!==a;--a)o=r[a],n[o]=t[o];for(a=i.length-1;-1!==a;--a){for(o=i[a],s=h[o],u=g(h[o+1],s),l=s;l!==u;++l)if(f[l]===o){n[o]/=p[l];break}for(d=n[o],l=s;l!==u;++l)(c=f[l])!==o&&(n[c]-=d*p[l])}return n},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,t,n,r,i,a){var o,s,u,l=0,c=i.length,d=this.k,h=this.k1,f=this.j;if(0===r[e])for(r[e]=1,f[0]=e,d[0]=s=t[e],h[0]=u=t[e+1];;)if(s>=u){if(i[c]=f[l],0===l)return;++c,s=d[--l],u=h[l]}else 0===r[o=a[n[s]]]?(r[o]=1,d[l]=s,f[++l]=o,s=t[o],h[l]=u=t[o+1]):++s},numeric.ccsLPSolve=function(e,t,n,r,i,a,o){var s,u,l,c,d,h,f,p,m,g=e[0],v=e[1],y=e[2],_=(g.length,t[0]),b=t[1],E=t[2];for(u=_[i],l=_[i+1],r.length=0,s=u;s<l;++s)o.dfs(a[b[s]],g,v,n,r,a);for(s=r.length-1;-1!==s;--s)n[r[s]]=0;for(s=u;s!==l;++s)n[c=a[b[s]]]=E[s];for(s=r.length-1;-1!==s;--s){for(d=g[c=r[s]],h=g[c+1],f=d;f<h;++f)if(a[v[f]]===c){n[c]/=y[f];break}for(m=n[c],f=d;f<h;++f)(p=a[v[f]])!==c&&(n[p]-=m*y[f])}return n},numeric.ccsLUP1=function(e,t){var n,r,i,a,o,s,u,l=e[0].length-1,c=[numeric.rep([l+1],0),[],[]],d=[numeric.rep([l+1],0),[],[]],h=c[0],f=c[1],p=c[2],m=d[0],g=d[1],v=d[2],y=numeric.rep([l],0),_=numeric.rep([l],0),b=numeric.ccsLPSolve,E=(Math.max,Math.abs),T=numeric.linspace(0,l-1),S=numeric.linspace(0,l-1),w=new numeric.ccsDFS(l);for(void 0===t&&(t=1),n=0;n<l;++n){for(b(c,e,y,_,n,S,w),a=-1,o=-1,r=_.length-1;-1!==r;--r)(i=_[r])<=n||(s=E(y[i]))>a&&(o=i,a=s);for(E(y[n])<t*a&&(r=T[n],a=T[o],T[n]=a,S[a]=n,T[o]=r,S[r]=o,a=y[n],y[n]=y[o],y[o]=a),a=h[n],o=m[n],u=y[n],f[a]=T[n],p[a]=1,++a,r=_.length-1;-1!==r;--r)s=y[i=_[r]],_[r]=0,y[i]=0,i<=n?(g[o]=i,v[o]=s,++o):(f[a]=T[i],p[a]=s/u,++a);h[n+1]=a,m[n+1]=o}for(r=f.length-1;-1!==r;--r)f[r]=S[f[r]];return{L:c,U:d,P:T,Pinv:S}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,t,n,r,i,a,o){var s,u,l,c=0,d=i.length,h=this.k,f=this.k1,p=this.j;if(0===r[e])for(r[e]=1,p[0]=e,h[0]=u=t[a[e]],f[0]=l=t[a[e]+1];;){if(isNaN(u))throw new Error("Ow!");if(u>=l){if(i[d]=a[p[c]],0===c)return;++d,u=h[--c],l=f[c]}else 0===r[s=n[u]]?(r[s]=1,h[c]=u,p[++c]=s,u=t[s=a[s]],f[c]=l=t[s+1]):++u}},numeric.ccsLPSolve0=function(e,t,n,r,i,a,o,s){var u,l,c,d,h,f,p,m,g,v=e[0],y=e[1],_=e[2],b=(v.length,t[0]),E=t[1],T=t[2];for(l=b[i],c=b[i+1],r.length=0,u=l;u<c;++u)s.dfs(E[u],v,y,n,r,a,o);for(u=r.length-1;-1!==u;--u)n[o[d=r[u]]]=0;for(u=l;u!==c;++u)n[d=E[u]]=T[u];for(u=r.length-1;-1!==u;--u){for(m=o[d=r[u]],h=v[d],f=v[d+1],p=h;p<f;++p)if(y[p]===m){n[m]/=_[p];break}for(g=n[m],p=h;p<f;++p)n[y[p]]-=g*_[p];n[m]=g}},numeric.ccsLUP0=function(e,t){var n,r,i,a,o,s,u,l=e[0].length-1,c=[numeric.rep([l+1],0),[],[]],d=[numeric.rep([l+1],0),[],[]],h=c[0],f=c[1],p=c[2],m=d[0],g=d[1],v=d[2],y=numeric.rep([l],0),_=numeric.rep([l],0),b=numeric.ccsLPSolve0,E=(Math.max,Math.abs),T=numeric.linspace(0,l-1),S=numeric.linspace(0,l-1),w=new numeric.ccsDFS0(l);for(void 0===t&&(t=1),n=0;n<l;++n){for(b(c,e,y,_,n,S,T,w),a=-1,o=-1,r=_.length-1;-1!==r;--r)(i=_[r])<=n||(s=E(y[T[i]]))>a&&(o=i,a=s);for(E(y[T[n]])<t*a&&(r=T[n],a=T[o],T[n]=a,S[a]=n,T[o]=r,S[r]=o),a=h[n],o=m[n],u=y[T[n]],f[a]=T[n],p[a]=1,++a,r=_.length-1;-1!==r;--r)s=y[T[i=_[r]]],_[r]=0,y[T[i]]=0,i<=n?(g[o]=i,v[o]=s,++o):(f[a]=T[i],p[a]=s/u,++a);h[n+1]=a,m[n+1]=o}for(r=f.length-1;-1!==r;--r)f[r]=S[f[r]];return{L:c,U:d,P:T,Pinv:S}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,t,n){var r=numeric.ccsDim(e),i=r[0],a=r[1];void 0===t?t=numeric.linspace(0,i-1):"number"==typeof t&&(t=[t]),void 0===n?n=numeric.linspace(0,a-1):"number"==typeof n&&(n=[n]);var o,s,u,l,c=t.length,d=n.length,h=numeric.rep([a],0),f=[],p=[],m=[h,f,p],g=e[0],v=e[1],y=e[2],_=numeric.rep([i],0),b=0,E=numeric.rep([i],0);for(s=0;s<d;++s){var T=g[l=n[s]],S=g[l+1];for(o=T;o<S;++o)E[u=v[o]]=1,_[u]=y[o];for(o=0;o<c;++o)E[t[o]]&&(f[b]=o,p[b]=_[t[o]],++b);for(o=T;o<S;++o)E[u=v[o]]=0;h[s+1]=b}return m},numeric.ccsDot=function(e,t){var n,r,i,a,o,s,u,l,c,d,h,f=e[0],p=e[1],m=e[2],g=t[0],v=t[1],y=t[2],_=numeric.ccsDim(e),b=numeric.ccsDim(t),E=_[0],T=(_[1],b[1]),S=numeric.rep([E],0),w=numeric.rep([E],0),A=Array(E),x=numeric.rep([T],0),M=[],C=[],R=[x,M,C];for(i=0;i!==T;++i){for(a=g[i],o=g[i+1],c=0,r=a;r<o;++r)for(d=v[r],h=y[r],s=f[d],u=f[d+1],n=s;n<u;++n)0===w[l=p[n]]&&(A[c]=l,w[l]=1,c+=1),S[l]=S[l]+m[n]*h;for(o=(a=x[i])+c,x[i+1]=o,r=c-1;-1!==r;--r)h=a+r,n=A[r],M[h]=n,C[h]=S[n],w[n]=0,S[n]=0;x[i+1]=x[i]+c}return R},numeric.ccsLUPSolve=function(e,t){var n=e.L,r=e.U,i=(e.P,t[0]),a=!1;"object"!=typeof i&&(i=(t=[[0,t.length],numeric.linspace(0,t.length-1),t])[0],a=!0);var o,s,u,l,c,d,h=t[1],f=t[2],p=n[0].length-1,m=i.length-1,g=numeric.rep([p],0),v=Array(p),y=numeric.rep([p],0),_=Array(p),b=numeric.rep([m+1],0),E=[],T=[],S=numeric.ccsTSolve,w=0;for(o=0;o<m;++o){for(c=0,u=i[o],l=i[o+1],s=u;s<l;++s)d=e.Pinv[h[s]],_[c]=d,y[d]=f[s],++c;for(_.length=c,S(n,y,g,_,v),s=_.length-1;-1!==s;--s)y[_[s]]=0;if(S(r,g,y,v,_),a)return y;for(s=v.length-1;-1!==s;--s)g[v[s]]=0;for(s=_.length-1;-1!==s;--s)d=_[s],E[w]=d,T[w]=y[d],y[d]=0,++w;b[o+1]=w}return[b,E,T]},numeric.ccsbinop=function(e,t){return void 0===t&&(t=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+t+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var t,n=e[0],r=e[1],i=e[2],a=numeric.sup(r)+1,o=n.length,s=numeric.rep([a],0),u=Array(o),l=Array(o),c=numeric.rep([a],0);for(t=0;t<o;++t)c[r[t]]++;for(t=0;t<a;++t)s[t+1]=s[t]+c[t];var d,h,f=s.slice(0);for(t=0;t<o;++t)u[d=f[h=r[t]]]=n[t],l[d]=i[t],f[h]=f[h]+1;return[s,u,l]},numeric.ccsGather=function(e){var t,n,r,i,a,o=e[0],s=e[1],u=e[2],l=o.length-1,c=s.length,d=Array(c),h=Array(c),f=Array(c);for(a=0,t=0;t<l;++t)for(r=o[t],i=o[t+1],n=r;n!==i;++n)h[a]=t,d[a]=s[n],f[a]=u[n],++a;return[d,h,f]},numeric.sdim=function e(t,n,r){if(void 0===n&&(n=[]),"object"!=typeof t)return n;var i;for(i in void 0===r&&(r=0),r in n||(n[r]=0),t.length>n[r]&&(n[r]=t.length),t)t.hasOwnProperty(i)&&e(t[i],n,r+1);return n},numeric.sclone=function e(t,n,r){void 0===n&&(n=0),void 0===r&&(r=numeric.sdim(t).length);var i,a=Array(t.length);if(n===r-1){for(i in t)t.hasOwnProperty(i)&&(a[i]=t[i]);return a}for(i in t)t.hasOwnProperty(i)&&(a[i]=e(t[i],n+1,r));return a},numeric.sdiag=function(e){var t,n,r=e.length,i=Array(r);for(t=r-1;t>=1;t-=2)n=t-1,i[t]=[],i[t][t]=e[t],i[n]=[],i[n][n]=e[n];return 0===t&&(i[0]=[],i[0][0]=e[t]),i},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t,n,r,i=[];e.length;for(t in e)if(e.hasOwnProperty(t))for(n in r=e[t])r.hasOwnProperty(n)&&("object"!=typeof i[n]&&(i[n]=[]),i[n][t]=r[n]);return i},numeric.sLUP=function(e,t){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,t){var n,r,i,a,o,s,u,l=e.length,c=(t.length,numeric.stranspose(t)),d=c.length,h=Array(l);for(i=l-1;i>=0;i--){for(u=[],n=e[i],o=d-1;o>=0;o--){for(a in s=0,r=c[o],n)n.hasOwnProperty(a)&&a in r&&(s+=n[a]*r[a]);s&&(u[o]=s)}h[i]=u}return h},numeric.sdotMV=function(e,t){var n,r,i,a,o=e.length,s=Array(o);for(r=o-1;r>=0;r--){for(i in a=0,n=e[r])n.hasOwnProperty(i)&&t[i]&&(a+=n[i]*t[i]);a&&(s[r]=a)}return s},numeric.sdotVM=function(e,t){var n,r,i,a,o=[];for(n in e)if(e.hasOwnProperty(n))for(r in i=t[n],a=e[n],i)i.hasOwnProperty(r)&&(o[r]||(o[r]=0),o[r]+=a*i[r]);return o},numeric.sdotVV=function(e,t){var n,r=0;for(n in e)e[n]&&t[n]&&(r+=e[n]*t[n]);return r},numeric.sdot=function(e,t){var n=numeric.sdim(e).length,r=numeric.sdim(t).length;switch(1e3*n+r){case 0:return e*t;case 1001:return numeric.sdotVV(e,t);case 2001:return numeric.sdotMV(e,t);case 1002:return numeric.sdotVM(e,t);case 2002:return numeric.sdotMM(e,t);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}},numeric.sscatter=function(e){var t,n,r,i,a=e[0].length,o=e.length,s=[];for(n=a-1;n>=0;--n)if(e[o-1][n]){for(i=s,r=0;r<o-2;r++)i[t=e[r][n]]||(i[t]=[]),i=i[t];i[e[r][n]]=e[r+1][n]}return s},numeric.sgather=function e(t,n,r){var i,a,o;for(a in void 0===n&&(n=[]),void 0===r&&(r=[]),i=r.length,t)if(t.hasOwnProperty(a))if(r[i]=parseInt(a),"number"==typeof(o=t[a])){if(o){if(0===n.length)for(a=i+1;a>=0;--a)n[a]=[];for(a=i;a>=0;--a)n[a].push(r[a]);n[i+1].push(o)}}else e(o,n,r);return r.length>i&&r.pop(),n},numeric.cLU=function(e){var t,n,r,i,a,o,s=e[0],u=e[1],l=e[2],c=s.length,d=0;for(t=0;t<c;t++)s[t]>d&&(d=s[t]);d++;var h,f=Array(d),p=Array(d),m=numeric.rep([d],1/0),g=numeric.rep([d],-1/0);for(r=0;r<c;r++)t=s[r],(n=u[r])<m[t]&&(m[t]=n),n>g[t]&&(g[t]=n);for(t=0;t<d-1;t++)g[t]>g[t+1]&&(g[t+1]=g[t]);for(t=d-1;t>=1;t--)m[t]<m[t-1]&&(m[t-1]=m[t]);for(t=0;t<d;t++)p[t]=numeric.rep([g[t]-m[t]+1],0),f[t]=numeric.rep([t-m[t]],0),t-m[t]+1,g[t]-t+1;for(r=0;r<c;r++)p[t=s[r]][u[r]-m[t]]=l[r];for(t=0;t<d-1;t++)for(i=t-m[t],_=p[t],n=t+1;m[n]<=t&&n<d;n++)if(a=t-m[n],o=g[t]-t,h=(b=p[n])[a]/_[i]){for(r=1;r<=o;r++)b[r+a]-=h*_[r+i];f[n][t-m[n]]=h}var v,y,_=[],b=[],E=[],T=[],S=[],w=[];for(c=0,v=0,t=0;t<d;t++){for(i=m[t],a=g[t],y=p[t],n=t;n<=a;n++)y[n-i]&&(_[c]=t,b[c]=n,E[c]=y[n-i],c++);for(y=f[t],n=i;n<t;n++)y[n-i]&&(T[v]=t,S[v]=n,w[v]=y[n-i],v++);T[v]=t,S[v]=t,w[v]=1,v++}return{U:[_,b,E],L:[T,S,w]}},numeric.cLUsolve=function(e,t){var n,r,i=e.L,a=e.U,o=numeric.clone(t),s=i[0],u=i[1],l=i[2],c=a[0],d=a[1],h=a[2],f=c.length,p=(s.length,o.length);for(r=0,n=0;n<p;n++){for(;u[r]<n;)o[n]-=l[r]*o[u[r]],r++;r++}for(r=f-1,n=p-1;n>=0;n--){for(;d[r]>n;)o[n]-=h[r]*o[d[r]],r--;o[n]/=h[r],r--}return o},numeric.cgrid=function(e,t){"number"==typeof e&&(e=[e,e]);var n,r,i,a=numeric.rep(e,-1);if("function"!=typeof t)switch(t){case"L":t=function(t,n){return t>=e[0]/2||n<e[1]/2};break;default:t=function(e,t){return!0}}for(i=0,n=1;n<e[0]-1;n++)for(r=1;r<e[1]-1;r++)t(n,r)&&(a[n][r]=i,i++);return a},numeric.cdelsq=function(e){var t,n,r,i,a,o=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(e),u=s[0],l=s[1],c=[],d=[],h=[];for(t=1;t<u-1;t++)for(n=1;n<l-1;n++)if(!(e[t][n]<0)){for(r=0;r<4;r++)i=t+o[r][0],a=n+o[r][1],e[i][a]<0||(c.push(e[t][n]),d.push(e[i][a]),h.push(-1));c.push(e[t][n]),d.push(e[t][n]),h.push(4)}return[c,d,h]},numeric.cdotMV=function(e,t){var n,r,i,a=e[0],o=e[1],s=e[2],u=a.length;for(i=0,r=0;r<u;r++)a[r]>i&&(i=a[r]);for(i++,n=numeric.rep([i],0),r=0;r<u;r++)n[a[r]]+=s[r]*t[o[r]];return n},numeric.Spline=function(e,t,n,r,i){this.x=e,this.yl=t,this.yr=n,this.kl=r,this.kr=i},numeric.Spline.prototype._at=function(e,t){var n,r,i,a=this.x,o=this.yl,s=this.yr,u=this.kl,l=this.kr,c=numeric.add,d=numeric.sub,h=numeric.mul;n=d(h(u[t],a[t+1]-a[t]),d(s[t+1],o[t])),r=c(h(l[t+1],a[t]-a[t+1]),d(s[t+1],o[t]));var f=(i=(e-a[t])/(a[t+1]-a[t]))*(1-i);return c(c(c(h(1-i,o[t]),h(i,s[t+1])),h(n,f*(1-i))),h(r,f*i))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,n,r,i=this.x,a=i.length,o=Math.floor;for(t=0,n=a-1;n-t>1;)i[r=o((t+n)/2)]<=e?t=r:n=r;return this._at(e,t)}a=e.length;var s,u=Array(a);for(s=a-1;-1!==s;--s)u[s]=this.at(e[s]);return u},numeric.Spline.prototype.diff=function(){var e,t,n,r=this.x,i=this.yl,a=this.yr,o=this.kl,s=this.kr,u=i.length,l=o,c=s,d=Array(u),h=Array(u),f=numeric.add,p=numeric.mul,m=numeric.div,g=numeric.sub;for(e=u-1;-1!==e;--e)t=r[e+1]-r[e],n=g(a[e+1],i[e]),d[e]=m(f(p(n,6),p(o[e],-4*t),p(s[e+1],-2*t)),t*t),h[e+1]=m(f(p(n,-6),p(o[e],2*t),p(s[e+1],4*t)),t*t);return new numeric.Spline(r,l,c,d,h)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var t=[],n=this.x,r=this.yl,i=this.yr,a=this.kl,o=this.kr;"number"==typeof r[0]&&(r=[r],i=[i],a=[a],o=[o]);var s,u,l,c,d,h,f,p,m,g,v,y,_,b,E,T,S,w,A,x,M,C,R,I=r.length,O=n.length-1,D=(t=Array(I),Math.sqrt);for(s=0;s!==I;++s){for(c=r[s],d=i[s],h=a[s],f=o[s],p=[],u=0;u!==O;u++){for(u>0&&d[u]*c[u]<0&&p.push(n[u]),T=n[u+1]-n[u],n[u],v=c[u],y=d[u+1],m=h[u]/T,_=(g=f[u+1]/T)+3*v+2*m-3*y,b=3*(g+m+2*(v-y)),(E=e(m-g+3*(v-y))+12*g*v)<=0?S=(w=_/b)>n[u]&&w<n[u+1]?[n[u],w,n[u+1]]:[n[u],n[u+1]]:(w=(_-D(E))/b,A=(_+D(E))/b,S=[n[u]],w>n[u]&&w<n[u+1]&&S.push(w),A>n[u]&&A<n[u+1]&&S.push(A),S.push(n[u+1])),M=S[0],w=this._at(M,u),l=0;l<S.length-1;l++)if(C=S[l+1],A=this._at(C,u),0!==w)if(0===A||w*A>0)M=C,w=A;else{for(var P=0;!((R=(w*C-A*M)/(w-A))<=M||R>=C);)if((x=this._at(R,u))*A>0)C=R,A=x,-1===P&&(w*=.5),P=-1;else{if(!(x*w>0))break;M=R,w=x,1===P&&(A*=.5),P=1}p.push(R),M=S[l+1],w=this._at(M,u)}else p.push(M),M=C,w=A;0===A&&p.push(C)}t[s]=p}return"number"==typeof this.yl[0]?t[0]:t},numeric.spline=function(e,t,n,r){var i,a=e.length,o=[],s=[],u=[],l=numeric.sub,c=numeric.mul,d=numeric.add;for(i=a-2;i>=0;i--)s[i]=e[i+1]-e[i],u[i]=l(t[i+1],t[i]);"string"!=typeof n&&"string"!=typeof r||(n=r="periodic");var h=[[],[],[]];switch(typeof n){case"undefined":o[0]=c(3/(s[0]*s[0]),u[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/s[0],1/s[0]);break;case"string":o[0]=d(c(3/(s[a-2]*s[a-2]),u[a-2]),c(3/(s[0]*s[0]),u[0])),h[0].push(0,0,0),h[1].push(a-2,0,1),h[2].push(1/s[a-2],2/s[a-2]+2/s[0],1/s[0]);break;default:o[0]=n,h[0].push(0),h[1].push(0),h[2].push(1)}for(i=1;i<a-1;i++)o[i]=d(c(3/(s[i-1]*s[i-1]),u[i-1]),c(3/(s[i]*s[i]),u[i])),h[0].push(i,i,i),h[1].push(i-1,i,i+1),h[2].push(1/s[i-1],2/s[i-1]+2/s[i],1/s[i]);switch(typeof r){case"undefined":o[a-1]=c(3/(s[a-2]*s[a-2]),u[a-2]),h[0].push(a-1,a-1),h[1].push(a-2,a-1),h[2].push(1/s[a-2],2/s[a-2]);break;case"string":h[1][h[1].length-1]=0;break;default:o[a-1]=r,h[0].push(a-1),h[1].push(a-1),h[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var f=Array(o.length);if("string"==typeof n)for(i=f.length-1;-1!==i;--i)f[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),o[i]),f[i][a-1]=f[i][0];else for(i=f.length-1;-1!==i;--i)f[i]=numeric.cLUsolve(numeric.cLU(h),o[i]);return f="number"==typeof t[0]?f[0]:numeric.transpose(f),new numeric.Spline(e,t,t,f,f)},numeric.fftpow2=function e(t,n){var r=t.length;if(1!==r){var i,a,o=Math.cos,s=Math.sin,u=Array(r/2),l=Array(r/2),c=Array(r/2),d=Array(r/2);for(a=r/2,i=r-1;-1!==i;--i)c[--a]=t[i],d[a]=n[i],--i,u[a]=t[i],l[a]=n[i];e(u,l),e(c,d),a=r/2;var h,f,p,m=-6.283185307179586/r;for(i=r-1;-1!==i;--i)-1===--a&&(a=r/2-1),f=o(h=m*i),p=s(h),t[i]=u[a]+f*c[a]-p*d[a],n[i]=l[a]+f*d[a]+p*c[a]}},numeric._ifftpow2=function e(t,n){var r=t.length;if(1!==r){var i,a,o=Math.cos,s=Math.sin,u=Array(r/2),l=Array(r/2),c=Array(r/2),d=Array(r/2);for(a=r/2,i=r-1;-1!==i;--i)c[--a]=t[i],d[a]=n[i],--i,u[a]=t[i],l[a]=n[i];e(u,l),e(c,d),a=r/2;var h,f,p,m=6.283185307179586/r;for(i=r-1;-1!==i;--i)-1===--a&&(a=r/2-1),f=o(h=m*i),p=s(h),t[i]=u[a]+f*c[a]-p*d[a],n[i]=l[a]+f*d[a]+p*c[a]}},numeric.ifftpow2=function(e,t){numeric._ifftpow2(e,t),numeric.diveq(e,e.length),numeric.diveq(t,t.length)},numeric.convpow2=function(e,t,n,r){var i,a,o,s,u;for(numeric.fftpow2(e,t),numeric.fftpow2(n,r),i=e.length-1;-1!==i;--i)a=e[i],s=t[i],o=n[i],u=r[i],e[i]=a*o-s*u,t[i]=a*u+s*o;numeric.ifftpow2(e,t)},numeric.T.prototype.fft=function(){var e,t,n=this.x,r=this.y,i=n.length,a=Math.log,o=a(2),s=Math.ceil(a(2*i-1)/o),u=Math.pow(2,s),l=numeric.rep([u],0),c=numeric.rep([u],0),d=Math.cos,h=Math.sin,f=-3.141592653589793/i,p=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(i/2);for(e=0;e<i;e++)p[e]=n[e];if(void 0!==r)for(e=0;e<i;e++)m[e]=r[e];for(l[0]=1,e=1;e<=u/2;e++)t=f*e*e,l[e]=d(t),c[e]=h(t),l[u-e]=d(t),c[u-e]=h(t);var g=new numeric.T(p,m),v=new numeric.T(l,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){var e,t,n=this.x,r=this.y,i=n.length,a=Math.log,o=a(2),s=Math.ceil(a(2*i-1)/o),u=Math.pow(2,s),l=numeric.rep([u],0),c=numeric.rep([u],0),d=Math.cos,h=Math.sin,f=3.141592653589793/i,p=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(i/2);for(e=0;e<i;e++)p[e]=n[e];if(void 0!==r)for(e=0;e<i;e++)m[e]=r[e];for(l[0]=1,e=1;e<=u/2;e++)t=f*e*e,l[e]=d(t),c[e]=h(t),l[u-e]=d(t),c[u-e]=h(t);var g=new numeric.T(p,m),v=new numeric.T(l,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),(g=g.mul(v)).x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(e,t){var n=t.length,r=e(t);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var i,a,o,s,u,l,c,d,h,f=Math.max,p=numeric.clone(t),m=Array(n),g=(numeric.div,numeric.sub,f=Math.max,Math.abs),v=Math.min,y=0;for(i=0;i<n;i++)for(var _=f(1e-6*r,1e-8);;){if(++y>20)throw new Error("Numerical gradient fails");if(p[i]=t[i]+_,a=e(p),p[i]=t[i]-_,o=e(p),p[i]=t[i],isNaN(a)||isNaN(o))_/=16;else{if(m[i]=(a-o)/(2*_),s=t[i]-_,u=t[i],l=t[i]+_,c=(a-r)/_,d=(r-o)/_,h=f(g(m[i]),g(r),g(a),g(o),g(s),g(u),g(l),1e-8),!(v(f(g(c-m[i]),g(d-m[i]),g(c-d))/h,_/h)>.001))break;_/=16}}return m},numeric.uncmin=function(e,t,n,r,i,a,o){var s=numeric.gradient;void 0===o&&(o={}),void 0===n&&(n=1e-8),void 0===r&&(r=function(t){return s(e,t)}),void 0===i&&(i=1e3);var u,l,c=(t=numeric.clone(t)).length,d=e(t);if(isNaN(d))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,f=numeric.norm2;n=h(n,numeric.epsilon);var p,m,g,v,y,_,b,E,T,S,w=o.Hinv||numeric.identity(c),A=numeric.dot,x=(numeric.inv,numeric.sub),M=numeric.add,C=numeric.tensor,R=numeric.div,I=numeric.mul,O=numeric.all,D=numeric.isFinite,P=numeric.neg,L=0,N="";for(m=r(t);L<i;){if("function"==typeof a&&a(L,t,d,m,w)){N="Callback returned true";break}if(!O(D(m))){N="Gradient has Infinity or NaN";break}if(!O(D(p=P(A(w,m))))){N="Search direction has Infinity or NaN";break}if((S=f(p))<n){N="Newton step smaller than tol";break}for(T=1,l=A(m,p),y=t;L<i&&!(T*S<n)&&(y=M(t,v=I(p,T)),(u=e(y))-d>=.1*T*l||isNaN(u));)T*=.5,++L;if(T*S<n){N="Line search step size smaller than tol";break}if(L===i){N="maxit reached during line search";break}E=A(_=x(g=r(y),m),v),b=A(w,_),w=x(M(w,I((E+A(_,b))/(E*E),C(v,v))),R(M(C(b,v),C(v,b)),E)),t=y,d=u,m=g,++L}return{solution:t,f:d,gradient:m,invHessian:w,iterations:L,message:N}},numeric.Dopri=function(e,t,n,r,i,a,o){this.x=e,this.y=t,this.f=n,this.ymid=r,this.iterations=i,this.events=o,this.message=a},numeric.Dopri.prototype._at=function(e,t){function n(e){return e*e}var r,i,a,o,s,u,l,c,d,h=this,f=h.x,p=h.y,m=h.f,g=h.ymid,v=(f.length,Math.floor,numeric.add),y=numeric.mul,_=numeric.sub;return r=f[t],i=f[t+1],o=p[t],s=p[t+1],a=r+.5*(i-r),u=g[t],l=_(m[t],y(o,1/(r-a)+2/(r-i))),c=_(m[t+1],y(s,1/(i-a)+2/(i-r))),v(v(v(v(y(o,(d=[n(e-i)*(e-a)/n(r-i)/(r-a),n(e-r)*n(e-i)/n(r-a)/n(i-a),n(e-r)*(e-a)/n(i-r)/(i-a),(e-r)*n(e-i)*(e-a)/n(r-i)/(r-a),(e-i)*n(e-r)*(e-a)/n(r-i)/(i-a)])[0]),y(u,d[1])),y(s,d[2])),y(l,d[3])),y(c,d[4]))},numeric.Dopri.prototype.at=function(e){var t,n,r,i=Math.floor;if("number"!=typeof e){var a=e.length,o=Array(a);for(t=a-1;-1!==t;--t)o[t]=this.at(e[t]);return o}var s=this.x;for(t=0,n=s.length-1;n-t>1;)s[r=i(.5*(t+n))]<=e?t=r:n=r;return this._at(e,t)},numeric.dopri=function(e,t,n,r,i,a,o){void 0===i&&(i=1e-6),void 0===a&&(a=1e3);var s,u,l,c,d,h,f,p,m,g,v,y,_,b=[e],E=[n],T=[r(e,n)],S=[],w=[3/40,9/40],A=[44/45,-56/15,32/9],x=[19372/6561,-25360/2187,64448/6561,-212/729],M=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],C=[35/384,0,500/1113,125/192,-2187/6784,11/84],R=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],I=[.2,.3,.8,8/9,1,1],O=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],D=0,P=(t-e)/10,L=0,N=numeric.add,k=numeric.mul,F=(Math.max,Math.min),B=Math.abs,U=numeric.norminf,j=Math.pow,G=numeric.any,H=numeric.lt,V=numeric.and,z=(numeric.sub,new numeric.Dopri(b,E,T,S,-1,""));for("function"==typeof o&&(v=o(e,n));e<t&&L<a;)if(++L,e+P>t&&(P=t-e),s=r(e+I[0]*P,N(n,k(.2*P,T[D]))),u=r(e+I[1]*P,N(N(n,k(w[0]*P,T[D])),k(w[1]*P,s))),l=r(e+I[2]*P,N(N(N(n,k(A[0]*P,T[D])),k(A[1]*P,s)),k(A[2]*P,u))),c=r(e+I[3]*P,N(N(N(N(n,k(x[0]*P,T[D])),k(x[1]*P,s)),k(x[2]*P,u)),k(x[3]*P,l))),d=r(e+I[4]*P,N(N(N(N(N(n,k(M[0]*P,T[D])),k(M[1]*P,s)),k(M[2]*P,u)),k(M[3]*P,l)),k(M[4]*P,c))),h=r(e+P,m=N(N(N(N(N(n,k(T[D],P*C[0])),k(u,P*C[2])),k(l,P*C[3])),k(c,P*C[4])),k(d,P*C[5]))),(g="number"==typeof(f=N(N(N(N(N(k(T[D],P*O[0]),k(u,P*O[2])),k(l,P*O[3])),k(c,P*O[4])),k(d,P*O[5])),k(h,P*O[6])))?B(f):U(f))>i){if(e+(P=.2*P*j(i/g,.25))===e){z.msg="Step size became too small";break}}else{if(S[D]=N(N(N(N(N(N(n,k(T[D],P*R[0])),k(u,P*R[2])),k(l,P*R[3])),k(c,P*R[4])),k(d,P*R[5])),k(h,P*R[6])),b[++D]=e+P,E[D]=m,T[D]=h,"function"==typeof o){var W,q,Y=e,K=e+.5*P;if(y=o(K,S[D-1]),G(_=V(H(v,0),H(0,y)))||(Y=K,v=y,y=o(K=e+P,m),_=V(H(v,0),H(0,y))),G(_)){for(var X,Q,Z=0,J=1,$=1;;){if("number"==typeof v)q=($*y*Y-J*v*K)/($*y-J*v);else for(q=K,p=v.length-1;-1!==p;--p)v[p]<0&&y[p]>0&&(q=F(q,($*y[p]*Y-J*v[p]*K)/($*y[p]-J*v[p])));if(q<=Y||q>=K)break;Q=o(q,W=z._at(q,D-1)),G(X=V(H(v,0),H(0,Q)))?(K=q,y=Q,_=X,$=1,-1===Z?J*=.5:J=1,Z=-1):(Y=q,v=Q,J=1,1===Z?$*=.5:$=1,Z=1)}return m=z._at(.5*(e+q),D-1),z.f[D]=r(q,W),z.x[D]=q,z.y[D]=W,z.ymid[D-1]=m,z.events=_,z.iterations=L,z}}e+=P,n=m,v=y,P=F(.8*P*j(i/g,.25),4*P)}return z.iterations=L,z},numeric.LU=function(e,t){t=t||!1;var n,r,i,a,o,s,u,l,c,d=Math.abs,h=e.length,f=h-1,p=new Array(h);for(t||(e=numeric.clone(e)),i=0;i<h;++i){for(u=i,c=d((s=e[i])[i]),r=i+1;r<h;++r)c<(a=d(e[r][i]))&&(c=a,u=r);for(p[i]=u,u!=i&&(e[i]=e[u],e[u]=s,s=e[i]),o=s[i],n=i+1;n<h;++n)e[n][i]/=o;for(n=i+1;n<h;++n){for(l=e[n],r=i+1;r<f;++r)l[r]-=l[i]*s[r],l[++r]-=l[i]*s[r];r===f&&(l[r]-=l[i]*s[r])}}return{LU:e,P:p}},numeric.LUsolve=function(e,t){var n,r,i,a,o,s=e.LU,u=s.length,l=numeric.clone(t),c=e.P;for(n=u-1;-1!==n;--n)l[n]=t[n];for(n=0;n<u;++n)for(i=c[n],c[n]!==n&&(o=l[n],l[n]=l[i],l[i]=o),a=s[n],r=0;r<n;++r)l[n]-=l[r]*a[r];for(n=u-1;n>=0;--n){for(a=s[n],r=n+1;r<u;++r)l[n]-=l[r]*a[r];l[n]/=a[n]}return l},numeric.solve=function(e,t,n){return numeric.LUsolve(numeric.LU(e,n),t)},numeric.echelonize=function(e){var t,n,r,i,a,o,s,u,l=numeric.dim(e),c=l[0],d=l[1],h=numeric.identity(c),f=Array(c),p=Math.abs,m=numeric.diveq;for(e=numeric.clone(e),t=0;t<c;++t){for(r=0,a=e[t],o=h[t],n=1;n<d;++n)p(a[r])<p(a[n])&&(r=n);for(f[t]=r,m(o,a[r]),m(a,a[r]),n=0;n<c;++n)if(n!==t){for(u=(s=e[n])[r],i=d-1;-1!==i;--i)s[i]-=a[i]*u;for(s=h[n],i=c-1;-1!==i;--i)s[i]-=o[i]*u}}return{I:h,A:e,P:f}},numeric.__solveLP=function(e,t,n,r,i,a,o){var s,u,l,c,d=numeric.sum,h=(numeric.log,numeric.mul),f=numeric.sub,p=numeric.dot,m=numeric.div,g=numeric.add,v=e.length,y=n.length,_=!1,b=1,E=(numeric.transpose(t),numeric.svd,numeric.transpose),T=(numeric.leq,Math.sqrt),S=Math.abs,w=(numeric.muleq,numeric.norminf,numeric.any,Math.min),A=numeric.all,x=numeric.gt,M=Array(v),C=Array(y),R=(numeric.rep([y],1),numeric.solve),I=f(n,p(t,a)),O=p(e,e);for(l=0;l<i;++l){var D,P;for(D=y-1;-1!==D;--D)C[D]=m(t[D],I[D]);var L=E(C);for(D=v-1;-1!==D;--D)M[D]=d(L[D]);b=.25*S(O/p(e,M));var N=100*T(O/p(M,M));for((!isFinite(b)||b>N)&&(b=N),c=g(e,h(b,M)),u=p(L,C),D=v-1;-1!==D;--D)u[D][D]+=1;P=R(u,m(c,b),!0);var k=m(I,p(t,P)),F=1;for(D=y-1;-1!==D;--D)k[D]<0&&(F=w(F,-.999*k[D]));if(s=f(a,h(P,F)),!A(x(I=f(n,p(t,s)),0)))return{solution:a,message:"",iterations:l};if(a=s,b<r)return{solution:s,message:"",iterations:l};if(o){var B=p(e,c),U=p(t,c);for(_=!0,D=y-1;-1!==D;--D)if(B*U[D]<0){_=!1;break}}else _=!(a[v-1]>=0);if(_)return{solution:s,message:"Unbounded",iterations:l}}return{solution:a,message:"maximum iteration count exceeded",iterations:l}},numeric._solveLP=function(e,t,n,r,i){var a=e.length,o=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),u=numeric.dot,l=(numeric.div,numeric.add,numeric.rep([a],0).concat([1])),c=numeric.rep([o,1],-1),d=numeric.blockMatrix([[t,c]]),h=n,f=numeric.rep([a],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),p=numeric.__solveLP(l,d,h,r,i,f,!1),m=numeric.clone(p.solution);if(m.length=a,numeric.inf(s(n,u(t,m)))<0)return{solution:NaN,message:"Infeasible",iterations:p.iterations};var g=numeric.__solveLP(e,t,n,r,i-p.iterations,m,!0);return g.iterations+=p.iterations,g},numeric.solveLP=function(e,t,n,r,i,a,o){if(void 0===o&&(o=1e3),void 0===a&&(a=numeric.epsilon),void 0===r)return numeric._solveLP(e,t,n,a,o);var s,u=r.length,l=r[0].length,c=t.length,d=numeric.echelonize(r),h=numeric.rep([l],0),f=d.P,p=[];for(s=f.length-1;-1!==s;--s)h[f[s]]=1;for(s=l-1;-1!==s;--s)0===h[s]&&p.push(s);var m=numeric.getRange,g=numeric.linspace(0,u-1),v=numeric.linspace(0,c-1),y=m(r,g,p),_=m(t,v,f),b=m(t,v,p),E=numeric.dot,T=numeric.sub,S=E(_,d.I),w=T(b,E(S,y)),A=T(n,E(S,i)),x=Array(f.length),M=Array(p.length);for(s=f.length-1;-1!==s;--s)x[s]=e[f[s]];for(s=p.length-1;-1!==s;--s)M[s]=e[p[s]];var C=T(M,E(x,E(d.I,y))),R=numeric._solveLP(C,w,A,a,o),I=R.solution;if(I!=I)return R;var O=E(d.I,T(i,E(y,I))),D=Array(e.length);for(s=f.length-1;-1!==s;--s)D[f[s]]=O[s];for(s=p.length-1;-1!==s;--s)D[p[s]]=I[s];return{solution:D,message:R.message,iterations:R.iterations}},numeric.MPStoLP=function(e){e instanceof String&&e.split("\n");var t,n,r,i,a=0,o=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=e.length,u=0,l={},c=[],d=0,h={},f=0,p=[],m=[],g=[];function v(n){throw new Error("MPStoLP: "+n+"\nLine "+t+": "+e[t]+"\nCurrent state: "+o[a]+"\n")}for(t=0;t<s;++t){var y=(r=e[t]).match(/\S*/g),_=[];for(n=0;n<y.length;++n)""!==y[n]&&_.push(y[n]);if(0!==_.length){for(n=0;n<o.length&&r.substr(0,o[n].length)!==o[n];++n);if(n<o.length){if(a=n,1===n&&(i=_[1]),6===n)return{name:i,c:p,A:numeric.transpose(m),b:g,rows:l,vars:h}}else switch(a){case 0:case 1:v("Unexpected line");case 2:switch(_[0]){case"N":0===u?u=_[1]:v("Two or more N rows");break;case"L":l[_[1]]=d,c[d]=1,g[d]=0,++d;break;case"G":l[_[1]]=d,c[d]=-1,g[d]=0,++d;break;case"E":l[_[1]]=d,c[d]=0,g[d]=0,++d;break;default:v("Parse error "+numeric.prettyPrint(_))}break;case 3:h.hasOwnProperty(_[0])||(h[_[0]]=f,p[f]=0,m[f]=numeric.rep([d],0),++f);var b=h[_[0]];for(n=1;n<_.length;n+=2)if(_[n]!==u){var E=l[_[n]];m[b][E]=(c[E]<0?-1:1)*parseFloat(_[n+1])}else p[b]=parseFloat(_[n+1]);break;case 4:for(n=1;n<_.length;n+=2)g[l[_[n]]]=(c[l[_[n]]]<0?-1:1)*parseFloat(_[n+1]);break;case 5:break;case 6:v("Internal error")}}}v("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,t,n,r,i,a,o){function s(e){var t,r,i=this,a=e.length,o=0,s=i.i=i.j=i.m=0;for(i.S=[],i.c=[],a||(e=[a++]);o<n;)i.S[o]=o++;for(o=0;o<n;o++)s=c(s+(t=i.S[o])+e[o%a]),r=i.S[s],i.S[o]=r,i.S[s]=t;i.g=function(e){var t=i.S,r=c(i.i+1),a=t[r],o=c(i.j+a),s=t[o];t[r]=s,t[o]=a;for(var u=t[c(a+s)];--e;)r=c(r+1),s=t[o=c(o+(a=t[r]))],t[r]=s,t[o]=a,u=u*n+t[c(a+s)];return i.i=r,i.j=o,u},i.g(n)}function u(e,t,n,r,i){if(n=[],i=typeof e,t&&"object"==i)for(r in e)if(r.indexOf("S")<5)try{n.push(u(e[r],t-1))}catch(e){}return n.length?n:e+("string"!=i?"\0":"")}function l(e,t,n,r){for(e+="",n=0,r=0;r<e.length;r++)t[c(r)]=c((n^=19*t[c(r)])+e.charCodeAt(r));for(r in e="",t)e+=String.fromCharCode(t[r]);return e}function c(e){return 255&e}t.seedrandom=function(r,c){var d,h=[];return r=l(u(c?[r,e]:arguments.length?r:[(new Date).getTime(),e,window],3),h),l((d=new s(h)).S,e),t.random=function(){for(var e=d.g(6),t=o,r=0;e<i;)e=(e+r)*n,t*=n,r=d.g(1);for(;e>=a;)e/=2,t/=2,r>>>=1;return(e+r)/t},r},o=t.pow(n,6),i=t.pow(2,i),a=2*i,l(t.random(),e)}([],numeric.seedrandom,256,0,52),function(e){function t(e){if("object"!=typeof e)return e;var n,r=[],i=e.length;for(n=0;n<i;n++)r[n+1]=t(e[n]);return r}function n(e){if("object"!=typeof e)return e;var t,r=[],i=e.length;for(t=1;t<i;t++)r[t-1]=n(e[t]);return r}function r(e,t,n,r,i,a,o,s,u,l,c,d,h,f,p,m){var g,v,y,_,b,E,T,S,w,A,x,M,C,R,I,O,D,P,L,N,k,F,B,U,j,G,H;C=Math.min(r,l),y=2*r+C*(C+5)/2+2*l+1,U=1e-60;do{j=1+.1*(U+=U),G=1+.2*U}while(j<=1||G<=1);for(g=1;g<=r;g+=1)p[g]=t[g];for(g=r+1;g<=y;g+=1)p[g]=0;for(g=1;g<=l;g+=1)d[g]=0;if(b=[],0===m[1]){if(function(e,t,n,r){var i,a,o,s,u,l;for(a=1;a<=n;a+=1){if(r[1]=a,l=0,(o=a-1)<1){if((l=e[a][a]-l)<=0)break;e[a][a]=Math.sqrt(l)}else{for(s=1;s<=o;s+=1){for(u=e[s][a],i=1;i<s;i+=1)u-=e[i][a]*e[i][s];u/=e[s][s],e[s][a]=u,l+=u*u}if((l=e[a][a]-l)<=0)break;e[a][a]=Math.sqrt(l)}r[1]=0}}(e,0,r,b),0!==b[1])return void(m[1]=2);!function(e,t,n,r){var i,a,o,s;for(a=1;a<=n;a+=1){for(s=0,i=1;i<a;i+=1)s+=e[i][a]*r[i];r[a]=(r[a]-s)/e[a][a]}for(o=1;o<=n;o+=1)for(r[a=n+1-o]=r[a]/e[a][a],s=-r[a],i=1;i<a;i+=1)r[i]=r[i]+s*e[i][a]}(e,0,r,t),function(e,t,n){var r,i,a,o,s;for(a=1;a<=n;a+=1){for(e[a][a]=1/e[a][a],s=-e[a][a],r=1;r<a;r+=1)e[r][a]=s*e[r][a];if(n<(o=a+1))break;for(i=o;i<=n;i+=1)for(s=e[a][i],e[a][i]=0,r=1;r<=a;r+=1)e[r][i]=e[r][i]+s*e[r][a]}}(e,0,r)}else{for(v=1;v<=r;v+=1)for(i[v]=0,g=1;g<=v;g+=1)i[v]=i[v]+e[g][v]*t[g];for(v=1;v<=r;v+=1)for(t[v]=0,g=v;g<=r;g+=1)t[v]=t[v]+e[v][g]*i[g]}for(a[1]=0,v=1;v<=r;v+=1)for(i[v]=t[v],a[1]=a[1]+p[v]*i[v],p[v]=0,g=v+1;g<=r;g+=1)e[g][v]=0;for(a[1]=-a[1]/2,m[1]=0,R=(A=(w=(x=(S=(T=r)+r)+C)+C+1)+C*(C+1)/2)+l,g=1;g<=l;g+=1){for(O=0,v=1;v<=r;v+=1)O+=o[v][g]*o[v][g];p[R+g]=Math.sqrt(O)}function V(){for(f[1]=f[1]+1,y=A,g=1;g<=l;g+=1){for(y+=1,O=-s[g],v=1;v<=r;v+=1)O+=o[v][g]*i[v];if(Math.abs(O)<U&&(O=0),g>c)p[y]=O;else if(p[y]=-Math.abs(O),O>0){for(v=1;v<=r;v+=1)o[v][g]=-o[v][g];s[g]=-s[g]}}for(g=1;g<=h;g+=1)p[A+d[g]]=0;for(M=0,I=0,g=1;g<=l;g+=1)p[A+g]<I*p[R+g]&&(M=g,I=p[A+g]/p[R+g]);return 0===M?999:0}function z(){for(g=1;g<=r;g+=1){for(O=0,v=1;v<=r;v+=1)O+=e[v][g]*o[v][M];p[g]=O}for(_=T,g=1;g<=r;g+=1)p[_+g]=0;for(v=h+1;v<=r;v+=1)for(g=1;g<=r;g+=1)p[_+g]=p[_+g]+e[g][v]*p[v];for(F=!0,g=h;g>=1;g-=1){for(O=p[g],_=(y=w+g*(g+3)/2)-g,v=g+1;v<=h;v+=1)O-=p[y]*p[S+v],y+=v;if(O/=p[_],p[S+g]=O,d[g]<c)break;if(O<0)break;F=!1,E=g}if(!F)for(D=p[x+E]/p[S+E],g=1;g<=h&&!(d[g]<c)&&!(p[S+g]<0);g+=1)(I=p[x+g]/p[S+g])<D&&(D=I,E=g);for(O=0,g=T+1;g<=T+r;g+=1)O+=p[g]*p[g];if(Math.abs(O)<=U){if(F)return m[1]=1,999;for(g=1;g<=h;g+=1)p[x+g]=p[x+g]-D*p[S+g];return p[x+h+1]=p[x+h+1]+D,700}for(O=0,g=1;g<=r;g+=1)O+=p[T+g]*o[g][M];for(P=-p[A+M]/O,B=!0,F||D<P&&(P=D,B=!1),g=1;g<=r;g+=1)i[g]=i[g]+P*p[T+g],Math.abs(i[g])<U&&(i[g]=0);for(a[1]=a[1]+P*O*(P/2+p[x+h+1]),g=1;g<=h;g+=1)p[x+g]=p[x+g]-P*p[S+g];if(p[x+h+1]=p[x+h+1]+P,!B){for(O=-s[M],v=1;v<=r;v+=1)O+=i[v]*o[v][M];if(M>c)p[A+M]=O;else if(p[A+M]=-Math.abs(O),O>0){for(v=1;v<=r;v+=1)o[v][M]=-o[v][M];s[M]=-s[M]}return 700}for(d[h+=1]=M,y=w+(h-1)*h/2+1,g=1;g<=h-1;g+=1)p[y]=p[g],y+=1;if(h===r)p[y]=p[r];else{for(g=r;g>=h+1&&0!==p[g]&&(L=Math.max(Math.abs(p[g-1]),Math.abs(p[g])),N=Math.min(Math.abs(p[g-1]),Math.abs(p[g])),I=p[g-1]>=0?Math.abs(L*Math.sqrt(1+N*N/(L*L))):-Math.abs(L*Math.sqrt(1+N*N/(L*L))),L=p[g-1]/I,N=p[g]/I,1!==L);g-=1)if(0===L)for(p[g-1]=N*I,v=1;v<=r;v+=1)I=e[v][g-1],e[v][g-1]=e[v][g],e[v][g]=I;else for(p[g-1]=I,k=N/(1+L),v=1;v<=r;v+=1)I=L*e[v][g-1]+N*e[v][g],e[v][g]=k*(e[v][g-1]+I)-e[v][g],e[v][g-1]=I;p[y]=p[h]}return 0}function W(){if(0===p[_=(y=w+E*(E+1)/2+1)+E])return 798;if(L=Math.max(Math.abs(p[_-1]),Math.abs(p[_])),N=Math.min(Math.abs(p[_-1]),Math.abs(p[_])),I=p[_-1]>=0?Math.abs(L*Math.sqrt(1+N*N/(L*L))):-Math.abs(L*Math.sqrt(1+N*N/(L*L))),L=p[_-1]/I,N=p[_]/I,1===L)return 798;if(0===L){for(g=E+1;g<=h;g+=1)I=p[_-1],p[_-1]=p[_],p[_]=I,_+=g;for(g=1;g<=r;g+=1)I=e[g][E],e[g][E]=e[g][E+1],e[g][E+1]=I}else{for(k=N/(1+L),g=E+1;g<=h;g+=1)I=L*p[_-1]+N*p[_],p[_]=k*(p[_-1]+I)-p[_],p[_-1]=I,_+=g;for(g=1;g<=r;g+=1)I=L*e[g][E]+N*e[g][E+1],e[g][E+1]=k*(e[g][E]+I)-e[g][E+1],e[g][E]=I}return 0}function q(){for(_=y-E,g=1;g<=E;g+=1)p[_]=p[y],y+=1,_+=1;return p[x+E]=p[x+E+1],d[E]=d[E+1],(E+=1)<h?797:0}function Y(){return p[x+h]=p[x+h+1],p[x+h+1]=0,d[h]=0,h-=1,f[2]=f[2]+1,0}for(h=0,f[1]=0,f[2]=0,H=0;;){if(999===(H=V()))return;for(;0!==(H=z());){if(999===H)return;if(700===H)if(E===h)Y();else{for(;W(),797===(H=q()););Y()}}}}e.solveQP=function(e,i,a,o,s,u){e=t(e),i=t(i),a=t(a);var l,c,d,h,f,p=[],m=[],g=[],v=[],y=[];if(s=s||0,u=u?t(u):[void 0,0],o=o?t(o):[],c=e.length-1,d=a[1].length-1,!o)for(l=1;l<=d;l+=1)o[l]=0;for(l=1;l<=d;l+=1)m[l]=0;for(0,h=Math.min(c,d),l=1;l<=c;l+=1)g[l]=0;for(p[1]=0,l=1;l<=2*c+h*(h+5)/2+2*d+1;l+=1)v[l]=0;for(l=1;l<=2;l+=1)y[l]=0;return r(e,i,0,c,g,p,a,o,0,d,s,m,0,y,v,u),f="",1===u[1]&&(f="constraints are inconsistent, no solution!"),2===u[1]&&(f="matrix D in quadratic function is not positive definite!"),{solution:n(g),value:n(p),unconstrained_solution:n(i),iterations:n(y),iact:n(m),message:f}}}(numeric),numeric.svd=function(e){var t,n=numeric.epsilon,r=1e-64/n,i=0,a=0,o=0,s=0,u=0,l=numeric.clone(e),c=l.length,d=l[0].length;if(c<d)throw"Need more rows than columns";var h=new Array(d),f=new Array(d);for(a=0;a<d;a++)h[a]=f[a]=0;var p=numeric.rep([d,d],0);function m(e,t){return(e=Math.abs(e))>(t=Math.abs(t))?e*Math.sqrt(1+t*t/e/e):0==t?e:t*Math.sqrt(1+e*e/t/t)}var g=0,v=0,y=0,_=0,b=0,E=0,T=0;for(a=0;a<d;a++){for(h[a]=v,T=0,u=a+1,o=a;o<c;o++)T+=l[o][a]*l[o][a];if(T<=r)v=0;else for(g=l[a][a],v=Math.sqrt(T),g>=0&&(v=-v),y=g*v-T,l[a][a]=g-v,o=u;o<d;o++){for(T=0,s=a;s<c;s++)T+=l[s][a]*l[s][o];for(g=T/y,s=a;s<c;s++)l[s][o]+=g*l[s][a]}for(f[a]=v,T=0,o=u;o<d;o++)T+=l[a][o]*l[a][o];if(T<=r)v=0;else{for(g=l[a][a+1],v=Math.sqrt(T),g>=0&&(v=-v),y=g*v-T,l[a][a+1]=g-v,o=u;o<d;o++)h[o]=l[a][o]/y;for(o=u;o<c;o++){for(T=0,s=u;s<d;s++)T+=l[o][s]*l[a][s];for(s=u;s<d;s++)l[o][s]+=T*h[s]}}(b=Math.abs(f[a])+Math.abs(h[a]))>_&&(_=b)}for(a=d-1;-1!=a;a+=-1){if(0!=v){for(y=v*l[a][a+1],o=u;o<d;o++)p[o][a]=l[a][o]/y;for(o=u;o<d;o++){for(T=0,s=u;s<d;s++)T+=l[a][s]*p[s][o];for(s=u;s<d;s++)p[s][o]+=T*p[s][a]}}for(o=u;o<d;o++)p[a][o]=0,p[o][a]=0;p[a][a]=1,v=h[a],u=a}for(a=d-1;-1!=a;a+=-1){for(u=a+1,v=f[a],o=u;o<d;o++)l[a][o]=0;if(0!=v){for(y=l[a][a]*v,o=u;o<d;o++){for(T=0,s=u;s<c;s++)T+=l[s][a]*l[s][o];for(g=T/y,s=a;s<c;s++)l[s][o]+=g*l[s][a]}for(o=a;o<c;o++)l[o][a]=l[o][a]/v}else for(o=a;o<c;o++)l[o][a]=0;l[a][a]+=1}for(n*=_,s=d-1;-1!=s;s+=-1)for(var S=0;S<50;S++){var w=!1;for(u=s;-1!=u;u+=-1){if(Math.abs(h[u])<=n){w=!0;break}if(Math.abs(f[u-1])<=n)break}if(!w){i=0,T=1;var A=u-1;for(a=u;a<s+1&&(g=T*h[a],h[a]=i*h[a],!(Math.abs(g)<=n));a++)for(y=m(g,v=f[a]),f[a]=y,i=v/y,T=-g/y,o=0;o<c;o++)b=l[o][A],E=l[o][a],l[o][A]=b*i+E*T,l[o][a]=-b*T+E*i}if(E=f[s],u==s){if(E<0)for(f[s]=-E,o=0;o<d;o++)p[o][s]=-p[o][s];break}if(S>=49)throw"Error: no convergence.";for(_=f[u],v=m(g=(((b=f[s-1])-E)*(b+E)+((v=h[s-1])-(y=h[s]))*(v+y))/(2*y*b),1),g=g<0?((_-E)*(_+E)+y*(b/(g-v)-y))/_:((_-E)*(_+E)+y*(b/(g+v)-y))/_,i=1,T=1,a=u+1;a<s+1;a++){for(v=h[a],b=f[a],y=T*v,v*=i,E=m(g,y),h[a-1]=E,g=_*(i=g/E)+v*(T=y/E),v=-_*T+v*i,y=b*T,b*=i,o=0;o<d;o++)_=p[o][a-1],E=p[o][a],p[o][a-1]=_*i+E*T,p[o][a]=-_*T+E*i;for(E=m(g,y),f[a-1]=E,g=(i=g/E)*v+(T=y/E)*b,_=-T*v+i*b,o=0;o<c;o++)b=l[o][a-1],E=l[o][a],l[o][a-1]=b*i+E*T,l[o][a]=-b*T+E*i}h[u]=0,h[s]=g,f[s]=_}for(a=0;a<f.length;a++)f[a]<n&&(f[a]=0);for(a=0;a<d;a++)for(o=a-1;o>=0;o--)if(f[o]<f[a]){for(i=f[o],f[o]=f[a],f[a]=i,s=0;s<l.length;s++)t=l[s][a],l[s][a]=l[s][o],l[s][o]=t;for(s=0;s<p.length;s++)t=p[s][a],p[s][a]=p[s][o],p[s][o]=t;a=o}return{U:l,S:f,V:p}}}).call(this,__webpack_require__(27))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(44);const i=e=>{var t;e.getChannelData=(t=e.getChannelData,n=>{try{return t.call(e,n)}catch(e){if(12===e.code)throw Object(r.a)();throw e}})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>{var t;e.start=(t=e.start,(n=0,r=0,i)=>{if("number"==typeof i&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,r,i)})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>{var t;e.stop=(t=e.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})}},function(e,t,n){"use strict";var r,i,a,o,s,u=n(154).toUnsigned,l=n(154).toHexString,c=n(120);r=function(e){return c.findBox(e,["moov","trak"]).reduce((function(e,t){var n,r,i,a,o;return(n=c.findBox(t,["tkhd"])[0])?(r=n[0],a=u(n[i=0===r?12:20]<<24|n[i+1]<<16|n[i+2]<<8|n[i+3]),(o=c.findBox(t,["mdia","mdhd"])[0])?(i=0===(r=o[0])?12:20,e[a]=u(o[i]<<24|o[i+1]<<16|o[i+2]<<8|o[i+3]),e):null):null}),{})},i=function(e,t){var n,r,i;return n=c.findBox(t,["moof","traf"]),r=[].concat.apply([],n.map((function(t){return c.findBox(t,["tfhd"]).map((function(n){var r,i;return r=u(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),i=e[r]||9e4,(c.findBox(t,["tfdt"]).map((function(e){var t,n;return t=e[0],n=u(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(n*=Math.pow(2,32),n+=u(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),n}))[0]||1/0)/i}))}))),i=Math.min.apply(null,r),isFinite(i)?i:0},a=function(e,t){var n,r=c.findBox(t,["moof","traf"]),i=0,a=0;if(r&&r.length)for(var o=c.parseTraf(r[0]),s=0;s<o.boxes.length;s++)"tfhd"===o.boxes[s].type?n=o.boxes[s].trackId:"tfdt"===o.boxes[s].type?i=o.boxes[s].baseMediaDecodeTime:"trun"===o.boxes[s].type&&o.boxes[s].samples.length&&(a=o.boxes[s].samples[0].compositionTimeOffset||0);return(i+a)/(e[n]||9e4)},o=function(e){var t=c.findBox(e,["moov","trak"]),n=[];return t.forEach((function(e){var t=c.findBox(e,["mdia","hdlr"]),r=c.findBox(e,["tkhd"]);t.forEach((function(e,t){var i,a,o=c.parseType(e.subarray(8,12)),s=r[t];"vide"===o&&(a=0===(i=new DataView(s.buffer,s.byteOffset,s.byteLength)).getUint8(0)?i.getUint32(12):i.getUint32(20),n.push(a))}))})),n},s=function(e){var t=c.findBox(e,["moov","trak"]),n=[];return t.forEach((function(e){var t,r,i={},a=c.findBox(e,["tkhd"])[0];a&&(r=(t=new DataView(a.buffer,a.byteOffset,a.byteLength)).getUint8(0),i.id=0===r?t.getUint32(12):t.getUint32(20));var o=c.findBox(e,["mdia","hdlr"])[0];if(o){var s=c.parseType(o.subarray(8,12));i.type="vide"===s?"video":"soun"===s?"audio":s}var d=c.findBox(e,["mdia","minf","stbl","stsd"])[0];if(d){var h=d.subarray(8);i.codec=c.parseType(h.subarray(4,8));var f,p=c.findBox(h,[i.codec])[0];p&&(/^[a-z]vc[1-9]$/i.test(i.codec)?(f=p.subarray(78),"avcC"===c.parseType(f.subarray(4,8))&&f.length>11?(i.codec+=".",i.codec+=l(f[9]),i.codec+=l(f[10]),i.codec+=l(f[11])):i.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(i.codec)&&(f=p.subarray(28),"esds"===c.parseType(f.subarray(4,8))&&f.length>20&&0!==f[19]?(i.codec+="."+l(f[19]),i.codec+="."+l(f[20]>>>2&63).replace(/^0/,"")):i.codec="mp4a.40.2"))}var m=c.findBox(e,["mdia","mdhd"])[0];if(m&&a){var g=0===r?12:20;i.timescale=u(m[g]<<24|m[g+1]<<16|m[g+2]<<8|m[g+3])}n.push(i)})),n},e.exports={findBox:c.findBox,parseType:c.parseType,timescale:r,startTime:i,compositionStartTime:a,videoTrackIds:o,tracks:s}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(40);const i=(e,t,n,i)=>{if(Object(r.a)(t)){const r=t.inputs[i];return e.connect(r,n,0),[r,n,0]}return e.connect(t,n,i),[t,n,i]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(40);const i=(e,t,n,i)=>{Object(r.a)(t)?e.disconnect(t.inputs[i],n,0):e.disconnect(t,n,i)}},function(e,t,n){"use strict";function r(e,t,n,r,i){if("function"==typeof e.copyFromChannel)0===t[n].byteLength&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],r,i);else{const a=e.getChannelData(r);if(0===t[n].byteLength)t[n]=a.slice(i,i+128);else{const e=new Float32Array(a.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(e)}}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>{const n=[];for(let r=0;r<e;r+=1){const e=[],i="number"==typeof t?t:t[r];for(let t=0;t<i;t+=1)e.push(new Float32Array(128));n.push(e)}return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>{try{return new DOMException("","InvalidAccessError")}catch(e){return e.code=15,e.name="InvalidAccessError",e}}},function(e,t,n){"use strict";function r(e,t){return Math.floor(Math.random()*(t-e))+e}function i(e,t){return Math.random()*(t-e)+e}function a(e,t,n){return Math.min(Math.max(t,e),n)}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(59));function a(e){return e&&e.__esModule?e:{default:e}}var o="loading",s="executed",u="failed";function l(e){var t=(e=e||{}).eventBus,n=e.events,r=e.dashMetrics,a=e.fragmentLoader,l=e.debug,c=e.streamId,d=void 0,h=void 0,f=void 0,p=void 0;function m(e){var t;return!!e&&(t=!1,f.some((function(n){if(r=e,a=n,!isNaN(r.index)&&r.startTime===a.startTime&&r.adaptationIndex===a.adaptationIndex&&r.type===a.type||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(e,n)||function(e,t){return e.action===i.default.ACTION_COMPLETE&&e.action===t.action}(e,n))return t=!0;var r,a})),t)}function g(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function v(e){f=f.filter((function(t){var n=g(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-n}))}function y(e,t){t<=e+.5||(f=f.filter((function(n){var r=g(n);return isNaN(n.startTime)||n.startTime>=t-r||isNaN(n.duration)||n.startTime+n.duration<=e+r})))}function _(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r],a=i.startTime,o=a+i.duration;if(n=isNaN(n)?g(i):n,!isNaN(a)&&!isNaN(o)&&t+n>=a&&t-n<o||isNaN(a)&&isNaN(t))return i}return null}function b(e,t){r.addSchedulingInfo(e,t),r.addRequestsQueue(e.mediaType,p,f)}function E(e){e.sender===a&&(p.splice(p.indexOf(e.request),1),e.response&&!e.error&&f.push(e.request),b(e.request,e.error?u:s),t.trigger(n.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}))}function T(e){e.sender===a&&t.trigger(n.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this})}function S(e){e.sender===a&&t.trigger(n.FRAGMENT_LOADING_ABANDONED,{streamId:c,request:e.request,mediaType:e.mediaType})}function w(){f=[],p=[]}return d={getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],n=[];return t.forEach((function(t){var r=function(e){var t=void 0;switch(e){case o:t=p;break;case s:t=f;break;default:t=[]}return t}(t);n=n.concat(function(e,t){if(t.hasOwnProperty("time"))return[_(e,t.time,t.threshold)];return e.filter((function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return!1;return!0}))}(r,e))})),n},isFragmentLoaded:m,isFragmentLoadedOrPending:function(e){var t=!1,n=0,r=void 0;if(!(t=m(e)))for(n=0;n<p.length;n++)r=p[n],e.url===r.url&&e.startTime===r.startTime&&(t=!0);return t},removeExecutedRequestsBeforeTime:v,removeExecutedRequestsAfterTime:function(e){f=f.filter((function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime<e}))},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var n=0,r=0,i=e.length;r<i;r++)y(n,e.start(r)),n=e.end(r);t>0&&y(n,t)}else v()},abortRequests:function(){a.abort(),p=[]},executeRequest:function(e){switch(e.action){case i.default.ACTION_COMPLETE:f.push(e),b(e,s),h.debug("STREAM_COMPLETED"),t.trigger(n.STREAM_COMPLETED,{request:e});break;case i.default.ACTION_DOWNLOAD:b(e,o),p.push(e),function(e){t.trigger(n.FRAGMENT_LOADING_STARTED,{streamId:c,request:e}),a.load(e)}(e);break;default:h.warn("Unknown request action.")}},reset:function(){t.off(n.LOADING_COMPLETED,E,this),t.off(n.LOADING_DATA_PROGRESS,T,this),t.off(n.LOADING_ABANDONED,S,this),a&&a.reset(),w()},addExecutedRequest:function(e){f.push(e)}},h=l.getLogger(d),w(),t.on(n.LOADING_COMPLETED,E,d),t.on(n.LOADING_DATA_PROGRESS,T,d),t.on(n.LOADING_ABANDONED,S,d),d}l.__dashjs_factory_name="FragmentModel";var c=r.default.getClassFactory(l);c.FRAGMENT_MODEL_LOADING=o,c.FRAGMENT_MODEL_EXECUTED=s,c.FRAGMENT_MODEL_CANCELED="canceled",c.FRAGMENT_MODEL_FAILED=u,r.default.updateClassFactory(l.__dashjs_factory_name,c),t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(17)),i=u(n(885)),a=u(n(2)),o=u(n(71)),s=u(n(887));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e=void 0,t=void 0,n=this.context;function a(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=o.default.parseBuffer(e),r=(0,i.default)(n).create();return r.setData(t),r}function u(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function l(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return t={parse:a,findLastTopIsoBoxCompleted:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new s.default(0,!1);for(var r=t instanceof ArrayBuffer?new Uint8Array(t):t,i=void 0,a=0;n<r.byteLength;){var o=u(r,n),c=l(r,n+4);if(0===o)break;n+o<=r.byteLength&&(e.indexOf(c)>=0?i=new s.default(n,!0,o):a=n+o),n+=o}return i||new s.default(a,!1)},getMediaTimescaleFromMoov:function(e){var t=a(e),n=t?t.getBox("mdhd"):void 0;return n?n.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,n,r=a(e),i=r.getBoxes("moof"),o=r.getBoxes("mfhd"),s=void 0,u=void 0,l=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0;n=r.getBoxes("moof").length,t=o[o.length-1].sequence_number,u=0,d=[];var E=-1,T=-1;for(g=0;g<i.length;g++){var S=i[g],w=S.getChildBoxes("traf");for(p=0;p<w.length;p++){var A=w[p],x=A.getChildBox("tfhd"),M=A.getChildBox("tfdt");c=M.baseMediaDecodeTime;var C=A.getChildBoxes("trun"),R=A.getChildBoxes("subs");for(m=0;m<C.length;m++){var I=C[m];for(u=I.sample_count,_=(x.base_data_offset||0)+(I.data_offset||0),f=0;f<u;f++){s=void 0!==(h=I.samples[f]).sample_duration?h.sample_duration:x.default_sample_duration,l=void 0!==h.sample_size?h.sample_size:x.default_sample_size;var O={dts:c,cts:c+(void 0!==h.sample_composition_time_offset?h.sample_composition_time_offset:0),duration:s,offset:S.offset+_,size:l,subSizes:[l]};if(R)for(v=0;v<R.length;v++){var D=R[v];if(E<D.entry_count-1&&f>T&&(E++,T+=D.entries[E].sample_delta),f==T){O.subSizes=[];var P=D.entries[E];for(y=0;y<P.subsample_count;y++)O.subSizes.push(P.subsamples[y].subsample_size)}}d.push(O),_+=l,c+=s}}b=c-M.baseMediaDecodeTime}}return{sampleList:d,lastSequenceNumber:t,totalDuration:b,numSequences:n}},findInitRange:function(t){var n=null,r=a(t);if(!r)return n;var i=r.getBox("ftyp"),o=r.getBox("moov");return e.debug("Searching for initialization."),o&&o.isComplete&&(n=(i?i.offset:o.offset)+"-"+(o.offset+o.size-1),e.debug("Found the initialization.  Range: "+n)),n}},e=(0,r.default)(n).getInstance().getLogger(t),t}l.__dashjs_factory_name="BoxParser",t.default=a.default.getSingletonFactory(l)},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,n(106).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(187));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=this.context,n=void 0,r=void 0;return n=(0,i.default)(t).getInstance(),{load:function(i){var a=n.getLoader(i&&i.request?i.request.url:null);(r=a(t).create({errHandler:e.errHandler,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.useFetch||null,dashMetrics:e.dashMetrics,boxParser:e.boxParser?e.boxParser:null,constants:e.constants?e.constants:null,dashConstants:e.dashConstants?e.dashConstants:null,urlUtils:e.urlUtils?e.urlUtils:null,errors:e.errors})).load(i)},abort:function(){r&&r.abort()}}}o.__dashjs_factory_name="URLLoader";var s=r.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(182);var a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(13)),a=r(n(1057)),o=r(n(3)),s=r(n(71)),u=r(n(1059));function l(){var e=void 0,t=void 0,n=this.context;function r(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=s.default.parseBuffer(e),r=(0,a.default)(n).create();return r.setData(t),r}function o(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function l(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return t={parse:r,findLastTopIsoBoxCompleted:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new u.default(0,!1);for(var r=t instanceof ArrayBuffer?new Uint8Array(t):t,i=void 0,a=0;n<r.byteLength;){var s=o(r,n),c=l(r,n+4);if(0===s)break;n+s<=r.byteLength&&(e.indexOf(c)>=0?i=new u.default(n,!0,s):a=n+s),n+=s}return i||new u.default(a,!1)},getMediaTimescaleFromMoov:function(e){var t=r(e),n=t?t.getBox("mdhd"):void 0;return n?n.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,n,i=r(e),a=i.getBoxes("moof"),o=i.getBoxes("mfhd"),s=void 0,u=void 0,l=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0;n=i.getBoxes("moof").length,t=o[o.length-1].sequence_number,u=0,d=[];var E=-1,T=-1;for(g=0;g<a.length;g++){var S=a[g],w=S.getChildBoxes("traf");for(p=0;p<w.length;p++){var A=w[p],x=A.getChildBox("tfhd"),M=A.getChildBox("tfdt");c=M.baseMediaDecodeTime;var C=A.getChildBoxes("trun"),R=A.getChildBoxes("subs");for(m=0;m<C.length;m++){var I=C[m];for(u=I.sample_count,_=(x.base_data_offset||0)+(I.data_offset||0),f=0;f<u;f++){s=void 0!==(h=I.samples[f]).sample_duration?h.sample_duration:x.default_sample_duration,l=void 0!==h.sample_size?h.sample_size:x.default_sample_size;var O={dts:c,cts:c+(void 0!==h.sample_composition_time_offset?h.sample_composition_time_offset:0),duration:s,offset:S.offset+_,size:l,subSizes:[l]};if(R)for(v=0;v<R.length;v++){var D=R[v];if(E<D.entry_count-1&&f>T&&(E++,T+=D.entries[E].sample_delta),f==T){O.subSizes=[];var P=D.entries[E];for(y=0;y<P.subsample_count;y++)O.subSizes.push(P.subsamples[y].subsample_size)}}d.push(O),_+=l,c+=s}}b=c-M.baseMediaDecodeTime}}return{sampleList:d,lastSequenceNumber:t,totalDuration:b,numSequences:n}},findInitRange:function(t){var n=null,i=r(t);if(!i)return n;var a=i.getBox("ftyp"),o=i.getBox("moov");return e.debug("Searching for initialization."),o&&o.isComplete&&(n=(a?a.offset:o.offset)+"-"+(o.offset+o.size-1),e.debug("Found the initialization.  Range: "+n)),n}},e=(0,i.default)(n).getInstance().getLogger(t),t}l.__dashjs_factory_name="BoxParser",t.default=o.default.getSingletonFactory(l),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(161)),o=r(n(1089)),s=n(32),u=r(n(3)),l=r(n(29)),c=r(n(26));function d(e){e=e||{};var t,n,r,u=this.context,d=e.errHandler,h=e.metricsModel,f=e.mediaPlayerModel,p=e.requestModifier,m=e.boxParser,g=e.useFetch||!1,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0;return t={load:function(e){e.request&&function e(t,n){var r=t.request,i=[],l=!0,T=!0,S=new Date,w=S,A=0,x=void 0;if(!p||!h||!d)throw new Error("config object is not correct or missing");var M=function(e){T=!1,r.requestStartDate=S,r.requestEndDate=new Date,r.firstByteDate=r.firstByteDate||S,r.checkExistenceOnly||(h.addHttpRequest(r.mediaType,null,r.type,r.url,x.response?x.response.responseURL:null,r.serviceLocation||null,r.range||null,r.requestStartDate,r.firstByteDate,r.requestEndDate,x.response?x.response.status:null,r.duration,x.response&&x.response.getAllResponseHeaders?x.response.getAllResponseHeaders():x.response?x.response.responseHeaders:[],e?i:null),r.type===s.HTTPRequest.MPD_TYPE&&h.addManifestUpdate("stream",r.type,r.requestStartDate,r.requestEndDate))},C=function(){-1!==v.indexOf(x)&&(v.splice(v.indexOf(x),1),T&&(M(!1),n>0?function(){n--;var i={config:t};_.push(i),i.timeout=setTimeout((function(){-1!==_.indexOf(i)&&(_.splice(_.indexOf(i),1),e(t,n))}),f.getRetryIntervalForType(r.type))}():(d.downloadError(b[r.type],r.url,r),d.error(new c.default(E[r.type],r.url+" is not available",{request:r,response:x.response})),t.error&&t.error(r,"error",x.response.statusText),t.complete&&t.complete(r,x.response.statusText))))},R=void 0;R=g&&window.fetch&&"arraybuffer"===r.responseType&&r.type===s.HTTPRequest.MEDIA_SEGMENT_TYPE?(0,o.default)(u).create({requestModifier:p,boxParser:m}):(0,a.default)(u).create({requestModifier:p,boxParser:m});var I=p.modifyRequestURL(r.url),O=r.checkExistenceOnly?s.HTTPRequest.HEAD:s.HTTPRequest.GET,D=f.getXHRWithCredentialsForType(r.type);x={url:I,method:O,withCredentials:D,request:r,onload:function(){x.response.status>=200&&x.response.status<=299&&(M(!0),t.success&&t.success(x.response.response,x.response.statusText,x.response.responseURL),t.complete&&t.complete(r,x.response.statusText))},onend:C,onerror:C,progress:function(e){var n=new Date;l&&(l=!1,(!e.lengthComputable||e.lengthComputable&&e.total!==e.loaded)&&(r.firstByteDate=n)),e.lengthComputable&&(r.bytesLoaded=e.loaded,r.bytesTotal=e.total),e.noTrace||(i.push({s:w,d:e.time?e.time:n.getTime()-w.getTime(),b:[e.loaded?e.loaded-A:0]}),w=n,A=e.loaded),t.progress&&e&&t.progress(e)},onabort:function(){t.abort&&t.abort(r)},loader:R};var P,L=(new Date).getTime();isNaN(r.delayLoadingTime)||L>=r.delayLoadingTime?(v.push(x),R.load(x)):(P={httpRequest:x},y.push(P),P.delayTimeout=setTimeout((function(){if(-1!==y.indexOf(P)){y.splice(y.indexOf(P),1);try{S=new Date,w=S,v.push(P.httpRequest),R.load(P.httpRequest)}catch(e){P.httpRequest.onerror()}}}),r.delayLoadingTime-L))}(e,f.getRetryAttemptsForType(e.request.type))},abort:function(){_.forEach((function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)})),_=[],y.forEach((function(e){return clearTimeout(e.delayTimeout)})),y=[],v.forEach((function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e),e.onabort()})),v=[]}},v=[],y=[],_=[],i(n={},s.HTTPRequest.MPD_TYPE,l.default.DOWNLOAD_ERROR_ID_MANIFEST),i(n,s.HTTPRequest.XLINK_EXPANSION_TYPE,l.default.DOWNLOAD_ERROR_ID_XLINK),i(n,s.HTTPRequest.INIT_SEGMENT_TYPE,l.default.DOWNLOAD_ERROR_ID_INITIALIZATION),i(n,s.HTTPRequest.MEDIA_SEGMENT_TYPE,l.default.DOWNLOAD_ERROR_ID_CONTENT),i(n,s.HTTPRequest.INDEX_SEGMENT_TYPE,l.default.DOWNLOAD_ERROR_ID_CONTENT),i(n,s.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,l.default.DOWNLOAD_ERROR_ID_CONTENT),i(n,s.HTTPRequest.OTHER_TYPE,l.default.DOWNLOAD_ERROR_ID_CONTENT),b=n,i(r={},s.HTTPRequest.MPD_TYPE,l.default.DOWNLOAD_ERROR_ID_MANIFEST_CODE),i(r,s.HTTPRequest.XLINK_EXPANSION_TYPE,l.default.DOWNLOAD_ERROR_ID_XLINK_CODE),i(r,s.HTTPRequest.INIT_SEGMENT_TYPE,l.default.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),i(r,s.HTTPRequest.MEDIA_SEGMENT_TYPE,l.default.DOWNLOAD_ERROR_ID_CONTENT_CODE),i(r,s.HTTPRequest.INDEX_SEGMENT_TYPE,l.default.DOWNLOAD_ERROR_ID_CONTENT_CODE),i(r,s.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,l.default.DOWNLOAD_ERROR_ID_CONTENT_CODE),i(r,s.HTTPRequest.OTHER_TYPE,l.default.DOWNLOAD_ERROR_ID_CONTENT_CODE),E=r,t}d.__dashjs_factory_name="HTTPLoader";var h=u.default.getClassFactory(d);t.default=h,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(210),a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.MEDIA_KEYERR_CODE=100,this.MEDIA_KEYERR_UNKNOWN_CODE=101,this.MEDIA_KEYERR_CLIENT_CODE=102,this.MEDIA_KEYERR_SERVICE_CODE=103,this.MEDIA_KEYERR_OUTPUT_CODE=104,this.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,this.MEDIA_KEYERR_DOMAIN_CODE=106,this.MEDIA_KEY_MESSAGE_ERROR_CODE=107,this.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,this.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,this.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,this.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,this.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,this.KEY_SESSION_CREATED_ERROR_CODE=113,this.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,this.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",this.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",this.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",this.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",this.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",this.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",this.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",this.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",this.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",this.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",this.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",this.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",this.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",this.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --"}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=a,e.exports=t.default},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(this,n(27))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n,r)=>{let i=Object.getPrototypeOf(e);for(;!i.hasOwnProperty(t);)i=Object.getPrototypeOf(i);const{get:a,set:o}=Object.getOwnPropertyDescriptor(i,t);Object.defineProperty(e,t,{get:n(a),set:r(o)})}},function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var r=function(t){return{targets:t.gazeTarget.cube.position,easing:"linear",keyframes:[{x:-70,y:30,z:25,delay:2e3,duration:5e3},{x:-40,y:50,z:-25,delay:0,duration:4e3},{x:-30,y:60,z:-55,delay:0,duration:4e3},{x:10,y:30,z:-55,delay:0,duration:5e3},{x:70,y:20,z:0,delay:0,duration:7e3},{x:80,y:0,z:0,delay:0,duration:1500},{x:90,y:0,z:0,delay:0,duration:1e3}],update:function(n){var r=e.gazeSystem.camera.position;t.gazeTarget.cube.lookAt(r.x,r.y,r.z)},begin:function(e){},complete:function(n){e.binMan.Destroy(t.name)}}},i=function(t){return{targets:t.gazeTarget.cube.position,easing:"linear",keyframes:[{x:-30,y:-7.8,z:-100},{x:-30,y:-7.8,z:-90}],duration:3e3,begin:function(e){},complete:function(n){e.binMan.Destroy(t.name)}}},a=function(t){return{targets:t.gazeTarget.cube.position,easing:"linear",keyframes:[{x:-121,y:-7.8,z:-10},{x:-121,y:-7.8,z:-10}],duration:7e3,begin:function(e){},complete:function(n){e.binMan.Destroy(t.name)}}},o=function(t){return{targets:t.gazeTarget.cube.position,easing:"linear",keyframes:[{x:98,y:0,z:30},{x:100,y:0,z:30}],duration:24e3,begin:function(e){},complete:function(n){e.binMan.Destroy(t.name)}}}}).call(this,n(27))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=i},function(e,t,n){t.generateISD=n(888).generateISD,t.fromXML=n(889).fromXML,t.renderHTML=n(907).render},function(e,t,n){!function(e){e.ns_tt="http://www.w3.org/ns/ttml",e.ns_tts="http://www.w3.org/ns/ttml#styling",e.ns_ttp="http://www.w3.org/ns/ttml#parameter",e.ns_xml="http://www.w3.org/XML/1998/namespace",e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",e.ns_ebutts="urn:ebu:tt:style"}(t)},function(e,t,n){!function(e){var t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,n=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var a,o=null,s=i[e.toLowerCase()];return void 0!==s?o=s:null!==(a=t.exec(e))?o=[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),void 0!==a[4]?parseInt(a[4],16):255]:null!==(a=n.exec(e))?o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),255]:null!==(a=r.exec(e))&&(o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),parseInt(a[4])]),o};var a=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;e.parseLength=function(e){var t,n=null;return null!==(t=a.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n},e.parseTextShadow=function(t){var n=t.split(","),r=[];for(var i in n){var a=n[i].split(" ");if(1===a.length&&"none"===a[0])return"none";if(a.length>1&&a.length<5){var o=[null,null,null,null],s=e.parseLength(a.shift());if(null===s)return null;if(o[0]=s,null===(s=e.parseLength(a.shift())))return null;if(o[1]=s,0===a.length){r.push(o);continue}if(null!==(s=e.parseLength(a[0]))&&(o[2]=s,a.shift()),0===a.length){r.push(o);continue}var u=e.parseColor(a[0]);if(null===u)return null;o[3]=u,r.push(o)}}return r},e.parsePosition=function(t){var n=t.split(" "),r=function(e){return"center"===e||"left"===e||"top"===e||"bottom"===e||"right"===e};if(n.length>4)return null;for(var i in n)if(!r(n[i])){var a=e.parseLength(n[i]);if(null===a)return null;n[i]=a}for(var o={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},s=0;s<n.length;){var u=n[s++];if(r(u)){var l={value:0,unit:"%"};2!==n.length&&s<n.length&&!r(n[s])&&(l=n[s++]),"right"===u?(o.h.edge=u,o.h.offset=l):"bottom"===u?(o.v.edge=u,o.v.offset=l):"left"===u?o.h.offset=l:"top"===u&&(o.v.offset=l)}else{if(1!==n.length&&2!==n.length)return null;1===s?o.h.offset=u:o.v.offset=u}}return o},e.ComputedLength=function(e,t){this.rw=e,this.rh=t},e.ComputedLength.prototype.toUsedLength=function(e,t){return e*this.rw+t*this.rh},e.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh},e.toComputedLength=function(t,n,r,i,a,o){return"%"===n&&i?new e.ComputedLength(i.rw*t/100,i.rh*t/100):"em"===n&&r?new e.ComputedLength(r.rw*t,r.rh*t):"c"===n&&a?new e.ComputedLength(t*a.rw,t*a.rh):"px"===n&&o?new e.ComputedLength(t*o.rw,t*o.rh):"rh"===n?new e.ComputedLength(0,t/100):"rw"===n?new e.ComputedLength(t/100,0):null}}(t)},function(e,t,n){"use strict";(function(e){var r=n(891),i=n(892),a=n(893);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=s(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|f(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):h(e,t);if("Buffer"===t.type&&a(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(c(t),e=s(e,t<0?0:0|f(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|f(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(r)return G(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,n);case"utf8":case"utf-8":return x(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return A(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var a,o=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var c=-1;for(a=n;a<s;a++)if(l(e,a)===l(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===u)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var d=!0,h=0;h<u;h++)if(l(e,a+h)!==l(t,h)){d=!1;break}if(d)return a}return-1}function _(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function b(e,t,n,r){return V(G(t,e.length-n),e,n,r)}function E(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function T(e,t,n,r){return E(e,t,n,r)}function S(e,t,n,r){return V(H(t),e,n,r)}function w(e,t,n,r){return V(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function A(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function x(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,u,l=e[i],c=null,d=l>239?4:l>223?3:l>191?2:1;if(i+d<=n)switch(d){case 1:l<128&&(c=l);break;case 2:128==(192&(a=e[i+1]))&&(u=(31&l)<<6|63&a)>127&&(c=u);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&(u=(15&l)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(c=u)}null===c?(c=65533,d=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=d}return function(e){var t=e.length;if(t<=M)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=M));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return l(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return c(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return d(null,e)},u.allocUnsafeSlow=function(e){return d(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?x(this,0,e):m.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),l=this.slice(r,i),c=e.slice(t,n),d=0;d<s;++d)if(l[d]!==c[d]){a=l[d],o=c[d];break}return a<o?-1:o<a?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return E(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function R(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function I(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=j(e[a]);return i}function O(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function D(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,n,r,i,a){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function L(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function N(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function k(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,a){return a||k(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,a){return a||k(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},u.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||P(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);P(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);P(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=u.isBuffer(e)?e:G(new u(e,r).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function G(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function H(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(27))},function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var u,l=[],c=!1,d=-1;function h(){c&&u&&(c=!1,u.length?l=u.concat(l):d=-1,l.length&&f())}function f(){if(!c){var e=s(h);c=!0;for(var t=l.length;t;){for(u=l,l=[];++d<t;)u&&u[d].run();d=-1,t=l.length}u=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";(function(t){!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var a,o,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,r)}));case 4:return t.nextTick((function(){e.call(null,n,r,i)}));default:for(a=new Array(s-1),o=0;o<a.length;)a[o++]=arguments[o];return t.nextTick((function(){e.apply(null,a)}))}}}:e.exports=t}).call(this,n(107))},function(e,t,n){var r=n(106),i=r.Buffer;function a(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=o),a(i,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._test=t,this._converter=n}return r(e,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(102);var a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(74)),i=f(n(1023)),a=f(n(1024)),o=f(n(1025)),s=f(n(1026)),u=f(n(1027)),l=f(n(1028)),c=f(n(1029)),d=f(n(1030)),h=f(n(61));function f(e){return e&&e.__esModule?e:{default:e}}function p(){var e=this.context,t=void 0,n=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;return t={initialize:function(){p=[];var t=void 0;t=(0,s.default)(e).getInstance({BASE64:m}),p.push(t),t=(0,o.default)(e).getInstance({BASE64:m}),p.push(t),t=(0,i.default)(e).getInstance({BASE64:m}),p.push(t),g=t,t=(0,a.default)(e).getInstance({BASE64:m,debug:n}),p.push(t),v=t},setProtectionData:function(e){for(var t,n,r=0;r<p.length;r++){var i=p[r];i.hasOwnProperty("init")&&i.init((t=i.systemString,n=void 0,n=null,e&&(n=t in e?e[t]:null),n))}},isClearKey:function(e){return e===g||e===v},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}return!1},getKeySystems:function(){return p},setKeySystems:function(e){p=e},getKeySystemBySystemString:function(e){for(var t=0;t<p.length;t++)if(p[t].systemString===e)return p[t];return null},getSupportedKeySystemsFromContentProtection:function(e){var t=void 0,n=void 0,r=void 0,i=void 0,a=[];if(e)for(r=0;r<p.length;++r)for(n=p[r],i=0;i<e.length;++i)if((t=e[i]).schemeIdUri.toLowerCase()===n.schemeIdURI){var o=n.getInitData(t);a.push({ks:p[r],initData:o,cdmData:n.getCDMData(),sessionId:n.getSessionId(t)})}return a},getSupportedKeySystems:function(e,t){for(var n=[],i=r.default.parsePSSHList(e),a=void 0,o=void 0,s=void 0,u=0;u<p.length;++u)o=(a=p[u]).systemString,s=!t||o in t,a.uuid in i&&s&&n.push({ks:a,initData:i[a.uuid],cdmData:a.getCDMData(),sessionId:a.getSessionId()});return n},getLicenseServer:function(t,n,r){if("license-release"===r||"individualization-request"===r)return null;var i=null;return n&&n.hasOwnProperty("drmtoday")?i=(0,u.default)(e).getInstance({BASE64:m}):t.systemString===h.default.WIDEVINE_KEYSTEM_STRING?i=(0,c.default)(e).getInstance():t.systemString===h.default.PLAYREADY_KEYSTEM_STRING?i=(0,l.default)(e).getInstance():t.systemString===h.default.CLEARKEY_KEYSTEM_STRING&&(i=(0,d.default)(e).getInstance()),i},processClearKeyLicenseRequest:function(e,t,n){try{return e.getClearKeysFromProtectionData(t,n)}catch(e){return f.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(e){e&&(e.debug&&(n=e.debug,f=n.getLogger(t)),e.BASE64&&(m=e.BASE64))}}}p.__dashjs_factory_name="ProtectionKeyController",t.default=dashjs.FactoryMaker.getSingletonFactory(p)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(12)),a=r(n(14)),o=r(n(3)),s=r(n(63)),u=r(n(13)),l="loading",c="executed",d="failed";function h(e){e=e||{};var t=this.context,n=(0,i.default)(t).getInstance(),r=e.metricsModel,o=e.fragmentLoader,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0;function v(e){var t;return!!e&&(t=!1,m.some((function(n){if(r=e,i=n,!isNaN(r.index)&&r.startTime===i.startTime&&r.adaptationIndex===i.adaptationIndex&&r.type===i.type||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(e,n)||function(e,t){return e.action===s.default.ACTION_COMPLETE&&e.action===t.action}(e,n))return t=!0;var r,i})),t)}function y(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function _(e){m=m.filter((function(t){var n=y(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-n}))}function b(e,t){t<=e+.5||(m=m.filter((function(n){var r=y(n);return isNaN(n.startTime)||n.startTime>=t-r||isNaN(n.duration)||n.startTime+n.duration<=e+r})))}function E(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r],a=i.startTime,o=a+i.duration;if(n=isNaN(n)?y(i):n,!isNaN(a)&&!isNaN(o)&&t+n>=a&&t-n<o||isNaN(a)&&isNaN(t))return i}return null}function T(e,t){r.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t),r.addRequestsQueue(e.mediaType,g,m)}function S(e){e.sender===o&&(g.splice(g.indexOf(e.request),1),e.response&&!e.error&&m.push(e.request),T(e.request,e.error?d:c),n.trigger(a.default.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this}))}function w(e){e.sender===o&&n.trigger(a.default.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this})}function A(e){e.sender===o&&n.trigger(a.default.FRAGMENT_LOADING_ABANDONED,{streamProcessor:this.getStreamProcessor(),request:e.request,mediaType:e.mediaType})}function x(){m=[],g=[]}return h={setStreamProcessor:function(e){p=e},getStreamProcessor:function(){return p},getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],n=[];return t.forEach((function(t){var r=function(e){var t=void 0;switch(e){case l:t=g;break;case c:t=m;break;default:t=[]}return t}(t);n=n.concat(function(e,t){if(t.hasOwnProperty("time"))return[E(e,t.time,t.threshold)];return e.filter((function(e){for(var n in t)if("state"!==n&&t.hasOwnProperty(n)&&e[n]!=t[n])return!1;return!0}))}(r,e))})),n},isFragmentLoaded:v,isFragmentLoadedOrPending:function(e){var t=!1,n=0,r=void 0;if(!(t=v(e)))for(n=0;n<g.length;n++)r=g[n],e.url===r.url&&e.startTime===r.startTime&&(t=!0);return t},removeExecutedRequestsBeforeTime:_,removeExecutedRequestsAfterTime:function(e){m=m.filter((function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime+t.duration<e}))},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var n=0,r=0,i=e.length;r<i;r++)b(n,e.start(r)),n=e.end(r);t>0&&b(n,t)}else _()},abortRequests:function(){o.abort(),g=[]},executeRequest:function(e){switch(e.action){case s.default.ACTION_COMPLETE:m.push(e),T(e,c),f.debug("executeRequest trigger STREAM_COMPLETED"),n.trigger(a.default.STREAM_COMPLETED,{request:e,fragmentModel:this});break;case s.default.ACTION_DOWNLOAD:T(e,l),g.push(e),function(e){n.trigger(a.default.FRAGMENT_LOADING_STARTED,{sender:h,request:e}),o.load(e)}(e);break;default:f.warn("Unknown request action.")}},reset:function(){n.off(a.default.LOADING_COMPLETED,S,this),n.off(a.default.LOADING_DATA_PROGRESS,w,this),n.off(a.default.LOADING_ABANDONED,A,this),o&&o.reset(),x()},addExecutedRequest:function(e){m.push(e)}},f=(0,u.default)(t).getInstance().getLogger(h),x(),n.on(a.default.LOADING_COMPLETED,S,h),n.on(a.default.LOADING_DATA_PROGRESS,w,h),n.on(a.default.LOADING_ABANDONED,A,h),h}h.__dashjs_factory_name="FragmentModel";var f=o.default.getClassFactory(h);f.FRAGMENT_MODEL_LOADING=l,f.FRAGMENT_MODEL_EXECUTED=c,f.FRAGMENT_MODEL_CANCELED="canceled",f.FRAGMENT_MODEL_FAILED=d,o.default.updateClassFactory(h.__dashjs_factory_name,f),t.default=f,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(211)),a=r(n(11)),o=r(n(75)),s=r(n(212)),u=r(n(113)),l=r(n(12)),c=r(n(14)),d=r(n(3)),h=r(n(1070)),f=r(n(52)),p=r(n(1071)),m=r(n(1072)),g=r(n(1073)),v=n(32),y=r(n(13)),_=n(76),b="abandonload",E="allowload";function T(){var e=this.context,t=(0,y.default)(e).getInstance(),n=(0,l.default)(e).getInstance(),r=void 0,d=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0,V=void 0,z=void 0,W=void 0,q=void 0,Y=void 0,K=void 0,X=void 0;function Q(){(T=(0,i.default)(e).create({metricsModel:Y,dashMetrics:K,mediaPlayerModel:j,adapter:B})).initialize()}function Z(){w={video:!0,audio:!0},A={},x={},M={},C={},I={},R={},V={},q={},D=!1,X=!0,P=!1,void 0===L&&(L=!1),H=void 0,z=void 0,W=void 0,clearTimeout(O),O=null}function J(e){e.mediaType===a.default.VIDEO&&(H=e.oldQuality,z.push(H,U.getPlaybackQuality()))}function $(e){e.metric!==o.default.HTTP_REQUEST||!e.value||e.value.type!==v.HTTPRequest.MEDIA_SEGMENT_TYPE||e.mediaType!==a.default.AUDIO&&e.mediaType!==a.default.VIDEO||W.push(e.mediaType,e.value,X),e.metric!==o.default.BUFFER_LEVEL||e.mediaType!==a.default.AUDIO&&e.mediaType!==a.default.VIDEO||function(e,t){var n=j.getABRStrategy();if(n===a.default.ABR_STRATEGY_BOLA)return void(q[e]=!0);if(n===a.default.ABR_STRATEGY_THROUGHPUT)return void(q[e]=!1);var r=j.getStableBufferTime(),i=r,o=.5*r,s=q[e],u=t>(s?o:i);q[e]=u,u!==s&&(u?d.info("AbrController ("+e+") switching from throughput to buffer occupancy ABR rule (buffer: "+t.toFixed(3)+")."):d.info("AbrController ("+e+") switching from buffer occupancy to throughput ABR rule (buffer: "+t.toFixed(3)+")."))}(e.mediaType,.001*e.value.level)}function ee(e,t){return A[t]=A[t]||{},A[t].hasOwnProperty(e)||(A[t][e]=0),function(e,t){if(t!==a.default.VIDEO||!D||!R[t])return e;L||pe();var n=F.getValue(),r=B.getAdaptationForType(n,0,t).Representation,i=e;if(N>0&&k>0){for(;i>0&&r[i]&&N<r[i].width&&N-r[i-1].width<r[i].width-N;)i-=1;r.length-2>=i&&r[i].width===r[i+1].width&&(i=Math.min(e,i+1))}return i}(function(e,t,n){var r=ae(t);if(isNaN(r)||r>=1||r<0)return e;return Math.min(e,Math.round(n*r))}(function(e,t){var n=e;if(!R[t])return n;var r=ie(t);void 0!==r&&(n=Math.max(e,r));var i=re(t);void 0!==i&&(n=Math.min(n,i));return n}(A[t][e],e),e,A[t][e]),e)}function te(e){return M.hasOwnProperty("max")&&M.max.hasOwnProperty(e)?M.max[e]:NaN}function ne(e){return M.hasOwnProperty("min")&&M.min.hasOwnProperty(e)?M.min[e]:NaN}function re(e){var t=te(e);return t?ce(R[e].getMediaInfo(),t):void 0}function ie(e){var t=ne(e);if(t){var n=R[e].getMediaInfo(),r=de(n),i=ce(n,t);return r[i]&&i<r.length-1&&r[i].bitrate<1e3*t&&i++,i}}function ae(e){return C.hasOwnProperty("max")&&C.max.hasOwnProperty(e)?C.max[e]:1}function oe(e){return w[e]}function se(e,t,n,r){var i=t.id,a=fe(e);(0,_.checkInteger)(n);var o=ee(e,i);n!==a&&n>=0&&n<=o&&ue(e,a,n,o,r)}function ue(e,r,i,a,o){if(e&&R[e]){var s=R[e].getStreamInfo(),u=s?s.id:null;if(t.getLogToBrowserConsole()){var l=K.getCurrentBufferLevel(Y.getReadOnlyMetricsFor(e));d.info("AbrController ("+e+") switch from "+r+" to "+i+"/"+a+" (buffer: "+l+") "+(o?JSON.stringify(o):"."))}!function(e,t,n){x[t]=x[t]||{},x[t][e]=n}(e,u,i),n.trigger(c.default.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:s,oldQuality:r,newQuality:i,reason:o})}}function le(e,t){I[e].state=t}function ce(e,t,n){var r=e&&e.type?R[e.type].getRepresentationInfo():null;if(X&&n&&r&&r.fragmentDuration){n/=1e3;var i=r.fragmentDuration;if(n>i)return 0;t*=1-n/i}for(var a=de(e),o=a.length-1;o>=0;o--){if(1e3*t>=a[o].bitrate)return o}return 0}function de(e){var t=[];if(!e||!e.bitrateList)return t;for(var n=e.bitrateList,r=e.type,i=void 0,a=0,o=n.length;a<o;a++)(i=new s.default).mediaType=r,i.qualityIndex=a,i.bitrate=n[a].bandwidth,i.width=n[a].width,i.height=n[a].height,i.scanType=n[a].scanType,t.push(i);return t}function he(e){return q[e]}function fe(e){if(e&&R[e]){var t=R[e].getStreamInfo(),n=t?t.id:null;if(n)return x[n]=x[n]||{},x[n].hasOwnProperty(e)||(x[n][e]=0),x[n][e]}return 0}function pe(){if(U){var e=P&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;N=U.getClientWidth()*e,k=U.getClientHeight()*e}}function me(t){var n=t.request.mediaType;if(oe(n)){var i=R[n];if(!i)return;var a=(0,h.default)(e).create({abrController:r,streamProcessor:i,currentRequest:t.request,useBufferOccupancyABR:he(n)}),o=T.shouldAbandonFragment(a);if(o.quality>f.default.NO_CHANGE){var s=i.getFragmentModel();s.getRequests({state:u.default.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(s.abortRequests(),le(n,b),V[n].reset(),V[n].push({oldValue:fe(n,S.getActiveStreamInfo()),newValue:o.quality,confidence:1,reason:o.reason}),se(n,S.getActiveStreamInfo(),o.quality,o.reason),clearTimeout(O),O=setTimeout((function(){le(n,E),O=null}),j.getAbandonLoadTimeout()))}}}return r={isPlayingAtTopQuality:function(e){var t=e?e.id:null,n=fe(a.default.AUDIO),r=fe(a.default.VIDEO);return n===ee(a.default.AUDIO,t)&&r===ee(a.default.VIDEO,t)},updateTopQualityIndex:function(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return function(e,t,n){A[t]=A[t]||{},A[t][e]=n}(t,n,r),r},getThroughputHistory:function(){return W},getBitrateList:de,getQualityForBitrate:ce,getMaxAllowedBitrateFor:te,getTopBitrateInfoFor:function(e){if(e&&R&&R[e]){var t=R[e].getStreamInfo();if(t&&t.id){var n=ee(e,t.id),r=de(R[e].getMediaInfo());return r[n]?r[n]:null}}return null},getMinAllowedBitrateFor:ne,setMaxAllowedBitrateFor:function(e,t){(0,_.checkParameterType)(t,"number"),(0,_.checkIsVideoOrAudioType)(e),M.max=M.max||{},M.max[e]=t},setMinAllowedBitrateFor:function(e,t){(0,_.checkParameterType)(t,"number"),(0,_.checkIsVideoOrAudioType)(e),M.min=M.min||{},M.min[e]=t},getMaxAllowedIndexFor:re,getMinAllowedIndexFor:ie,getMaxAllowedRepresentationRatioFor:ae,setMaxAllowedRepresentationRatioFor:function(e,t){C.max=C.max||{},C.max[e]=t},getInitialBitrateFor:function(e){!function(){if(!G||!G.hasOwnProperty("getSavedBitrateSettings"))throw new Error(a.default.MISSING_CONFIG_ERROR)}();var t=G.getSavedBitrateSettings(e);if(!M.hasOwnProperty(e))if(C.hasOwnProperty(e)){var n=F.getValue(),r=B.getAdaptationForType(n,0,e).Representation;if(Array.isArray(r)){var i=Math.max(Math.round(r.length*C[e])-1,0);M[e]=r[i].bandwidth}else M[e]=0}else isNaN(t)?M[e]=e===a.default.VIDEO?1e3:100:M[e]=t;return M[e]},setInitialBitrateFor:function(e,t){(0,_.checkIsVideoOrAudioType)(e),(0,_.checkParameterType)(t,"number"),M[e]=t},getInitialRepresentationRatioFor:function(e){return C.hasOwnProperty(e)?C[e]:null},setInitialRepresentationRatioFor:function(e,t){C[e]=t},setAutoSwitchBitrateFor:function(e,t){(0,_.checkParameterType)(t,"boolean"),(0,_.checkIsVideoOrAudioType)(e),w[e]=t},getAutoSwitchBitrateFor:oe,getUseDeadTimeLatency:function(){return X},setUseDeadTimeLatency:function(e){(0,_.checkParameterType)(e,"boolean"),X=e},setLimitBitrateByPortal:function(e){(0,_.checkParameterType)(e,"boolean"),D=e},getLimitBitrateByPortal:function(){return D},getUsePixelRatioInLimitBitrateByPortal:function(){return P},setUsePixelRatioInLimitBitrateByPortal:function(e){(0,_.checkParameterType)(e,"boolean"),P=e},getQualityFor:fe,getAbandonmentStateFor:function(e){return I[e]?I[e].state:null},setPlaybackQuality:se,checkPlaybackQuality:function(n){if(n&&R&&R[n]){var i=R[n].getStreamInfo(),a=i?i.id:null,o=fe(n),s=(0,h.default)(e).create({abrController:r,streamProcessor:R[n],currentValue:o,switchHistory:V[n],droppedFramesHistory:z,useBufferOccupancyABR:he(n)});if(z){var u=U.getPlaybackQuality();u&&z.push(H,u)}if(oe(n)){var l=ie(n),c=ee(n,a),p=T.getMaxQuality(s),m=p.quality;if(void 0!==l&&m<l&&(m=l),m>c&&(m=c),V[n].push({oldValue:o,newValue:m}),m>f.default.NO_CHANGE&&m!=o)(I[n].state===E||m>o)&&ue(n,o,m,c,p.reason);else if(t.getLogToBrowserConsole()){var g=K.getCurrentBufferLevel(Y.getReadOnlyMetricsFor(n));d.debug("AbrController ("+n+") stay on "+o+"/"+c+" (buffer: "+g+")")}}}},getTopQualityIndexFor:ee,setElementSize:pe,setWindowResizeEventCalled:function(e){L=e},createAbrRulesCollection:Q,registerStreamType:function(t,r){V[t]=(0,p.default)(e).create(),R[t]=r,I[t]=I[t]||{},I[t].state=E,q[t]=!1,n.on(c.default.LOADING_PROGRESS,me,this),t==a.default.VIDEO&&(n.on(c.default.QUALITY_CHANGE_RENDERED,J,this),z=(0,m.default)(e).create(),pe()),n.on(c.default.METRIC_ADDED,$,this),n.on(c.default.PERIOD_SWITCH_COMPLETED,Q,this),W=(0,g.default)(e).create({mediaPlayerModel:j})},unRegisterStreamType:function(e){delete R[e]},setConfig:function(e){e&&(e.streamController&&(S=e.streamController),e.domStorage&&(G=e.domStorage),e.mediaPlayerModel&&(j=e.mediaPlayerModel),e.metricsModel&&(Y=e.metricsModel),e.dashMetrics&&(K=e.dashMetrics),e.adapter&&(B=e.adapter),e.manifestModel&&(F=e.manifestModel),e.videoModel&&(U=e.videoModel))},reset:function(){Z(),n.off(c.default.LOADING_PROGRESS,me,this),n.off(c.default.QUALITY_CHANGE_RENDERED,J,this),n.off(c.default.METRIC_ADDED,$,this),n.off(c.default.PERIOD_SWITCH_COMPLETED,Q,this),T&&T.reset()}},d=t.getLogger(r),Z(),r}T.__dashjs_factory_name="AbrController";var S=d.default.getSingletonFactory(T);S.ABANDON_LOAD=b,S.QUALITY_DEFAULT=0,d.default.updateSingletonFactory(T.__dashjs_factory_name,S),t.default=S,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(){return{modifyRequestURL:function(e){return e},modifyRequestHeader:function(e){return e}}}o.__dashjs_factory_name="RequestModifier",t.default=a.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._test=t,this._converter=n}return r(e,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(114),a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",this.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer"}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(77)),a=r(n(1175)),o=r(n(1176)),s=r(n(1177)),u=r(n(1178)),l=r(n(1179)),c=r(n(1180)),d=r(n(1181)),h=r(n(1182)),f=r(n(65));function p(){var e=this.context,t=void 0,n=void 0,r=void 0,p=void 0,m=void 0,g=void 0,v=void 0;return t={initialize:function(){p=[];var t=void 0;t=(0,u.default)(e).getInstance({BASE64:m}),p.push(t),t=(0,s.default)(e).getInstance({BASE64:m}),p.push(t),t=(0,a.default)(e).getInstance({BASE64:m}),p.push(t),g=t,t=(0,o.default)(e).getInstance({BASE64:m,debug:n}),p.push(t),v=t},setProtectionData:function(e){for(var t,n,r=0;r<p.length;r++){var i=p[r];i.hasOwnProperty("init")&&i.init((t=i.systemString,n=void 0,n=null,e&&(n=t in e?e[t]:null),n))}},isClearKey:function(e){return e===g||e===v},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}return!1},getKeySystems:function(){return p},getKeySystemBySystemString:function(e){for(var t=0;t<p.length;t++)if(p[t].systemString===e)return p[t];return null},getSupportedKeySystemsFromContentProtection:function(e){var t=void 0,n=void 0,r=void 0,i=void 0,a=[];if(e)for(r=0;r<p.length;++r)for(n=p[r],i=0;i<e.length;++i)if((t=e[i]).schemeIdUri.toLowerCase()===n.schemeIdURI){var o=n.getInitData(t);o?a.push({ks:p[r],initData:o,cdmData:n.getCDMData(),sessionId:n.getSessionId(t)}):this.isClearKey(n)&&a.push({ks:n,initData:null})}return a},getSupportedKeySystems:function(e,t){for(var n=[],r=i.default.parsePSSHList(e),a=void 0,o=void 0,s=void 0,u=0;u<p.length;++u)o=(a=p[u]).systemString,s=!t||o in t,a.uuid in r&&s&&n.push({ks:a,initData:r[a.uuid],cdmData:a.getCDMData(),sessionId:a.getSessionId()});return n},getLicenseServer:function(t,n,r){if("license-release"===r||"individualization-request"===r)return null;var i=null;return n&&n.hasOwnProperty("drmtoday")?i=(0,l.default)(e).getInstance({BASE64:m}):t.systemString===f.default.WIDEVINE_KEYSTEM_STRING?i=(0,d.default)(e).getInstance():t.systemString===f.default.PLAYREADY_KEYSTEM_STRING?i=(0,c.default)(e).getInstance():t.systemString===f.default.CLEARKEY_KEYSTEM_STRING&&(i=(0,h.default)(e).getInstance()),i},processClearKeyLicenseRequest:function(e,t,n){try{return e.getClearKeysFromProtectionData(t,n)}catch(e){return r.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(e){e&&(e.debug&&(n=e.debug,r=n.getLogger(t)),e.BASE64&&(m=e.BASE64))}}}p.__dashjs_factory_name="ProtectionKeyController",t.default=dashjs.FactoryMaker.getSingletonFactory(p),e.exports=t.default},function(e,t,n){"use strict";var r,i,a=n(154).toUnsigned,o=function(e){return new Date(1e3*e-20828448e5)},s=function(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}},u=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])},l=function(e,t){var n,r,i,o,s,c=[];if(!t.length)return null;for(n=0;n<e.byteLength;)r=a(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),i=u(e.subarray(n+4,n+8)),o=r>1?n+r:e.byteLength,i===t[0]&&(1===t.length?c.push(e.subarray(n+8,o)):(s=l(e.subarray(n+8,o),t.slice(1))).length&&(c=c.concat(s))),n=o;return c},c=function(e){var t,n,r=new DataView(e.buffer,e.byteOffset,e.byteLength),i=[];for(t=0;t+4<e.length;t+=n)if(n=r.getUint32(t),t+=4,n<=0)i.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:i.push("slice_layer_without_partitioning_rbsp");break;case 5:i.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:i.push("sei_rbsp");break;case 7:i.push("seq_parameter_set_rbsp");break;case 8:i.push("pic_parameter_set_rbsp");break;case 9:i.push("access_unit_delimiter_rbsp");break;default:i.push("UNKNOWN NAL - "+e[t]&31)}return i},d={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:r(e.subarray(78,e.byteLength))}},avcC:function(e){var t,n,r,i,a=new DataView(e.buffer,e.byteOffset,e.byteLength),o={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},s=31&e[5];for(r=6,i=0;i<s;i++)n=a.getUint16(r),r+=2,o.sps.push(new Uint8Array(e.subarray(r,r+n))),r+=n;for(t=e[r],r++,i=0;i<t;i++)n=a.getUint16(r),r+=2,o.pps.push(new Uint8Array(e.subarray(r,r+n))),r+=n;return o},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={majorBrand:u(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},r=8;r<e.byteLength;)n.compatibleBrands.push(u(e.subarray(r,r+4))),r+=4;return n},dinf:function(e){return{boxes:r(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:r(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:u(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}t.name+=String.fromCharCode(e[n])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:c(e)}},mdhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=4,i={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===i.version?(r+=4,i.creationTime=o(n.getUint32(r)),r+=8,i.modificationTime=o(n.getUint32(r)),r+=4,i.timescale=n.getUint32(r),r+=8,i.duration=n.getUint32(r)):(i.creationTime=o(n.getUint32(r)),r+=4,i.modificationTime=o(n.getUint32(r)),r+=4,i.timescale=n.getUint32(r),r+=4,i.duration=n.getUint32(r)),r+=4,t=n.getUint16(r),i.language+=String.fromCharCode(96+(t>>10)),i.language+=String.fromCharCode(96+((992&t)>>5)),i.language+=String.fromCharCode(96+(31&t)),i},mdia:function(e){return{boxes:r(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:r(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return e.byteLength>28&&(n.streamDescriptor=r(e.subarray(28))[0]),n},moof:function(e){return{boxes:r(e)}},moov:function(e){return{boxes:r(e)}},mvex:function(e){return{boxes:r(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===r.version?(n+=4,r.creationTime=o(t.getUint32(n)),n+=8,r.modificationTime=o(t.getUint32(n)),n+=4,r.timescale=t.getUint32(n),n+=8,r.duration=t.getUint32(n)):(r.creationTime=o(t.getUint32(n)),n+=4,r.modificationTime=o(t.getUint32(n)),n+=4,r.timescale=t.getUint32(n),n+=4,r.duration=t.getUint32(n)),n+=4,r.rate=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,r.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,n+=8,r.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,n+=24,r.nextTrackId=t.getUint32(n),r},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)n.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return n},sidx:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:n.getUint32(4),timescale:n.getUint32(8),earliestPresentationTime:n.getUint32(12),firstOffset:n.getUint32(16)},i=n.getUint16(22);for(t=24;i;t+=12,i--)r.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&n.getUint32(t),subsegmentDuration:n.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&n.getUint32(t+8)});return r},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:r(e)}},stco:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},i=n.getUint32(4);for(t=8;i;t+=4,i--)r.chunkOffsets.push(n.getUint32(t));return r},stsc:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=n.getUint32(4),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;r;t+=12,r--)i.sampleToChunks.push({firstChunk:n.getUint32(t),samplesPerChunk:n.getUint32(t+4),sampleDescriptionIndex:n.getUint32(t+8)});return i},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:r(e.subarray(8))}},stsz:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:n.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)r.entries.push(n.getUint32(t));return r},stts:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},i=n.getUint32(4);for(t=8;i;t+=8,i--)r.timeToSamples.push({sampleCount:n.getUint32(t),sampleDelta:n.getUint32(t+4)});return r},styp:function(e){return d.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:a(e[4]<<24|e[5]<<16|e[6]<<8|e[7])};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=a(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),t},tfhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:n.getUint32(4)},i=1&r.flags[2],a=2&r.flags[2],o=8&r.flags[2],s=16&r.flags[2],u=32&r.flags[2],l=65536&r.flags[0],c=131072&r.flags[0];return t=8,i&&(t+=4,r.baseDataOffset=n.getUint32(12),t+=4),a&&(r.sampleDescriptionIndex=n.getUint32(t),t+=4),o&&(r.defaultSampleDuration=n.getUint32(t),t+=4),s&&(r.defaultSampleSize=n.getUint32(t),t+=4),u&&(r.defaultSampleFlags=n.getUint32(t)),l&&(r.durationIsEmpty=!0),!i&&c&&(r.baseDataOffsetIsMoof=!0),r},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===r.version?(n+=4,r.creationTime=o(t.getUint32(n)),n+=8,r.modificationTime=o(t.getUint32(n)),n+=4,r.trackId=t.getUint32(n),n+=4,n+=8,r.duration=t.getUint32(n)):(r.creationTime=o(t.getUint32(n)),n+=4,r.modificationTime=o(t.getUint32(n)),n+=4,r.trackId=t.getUint32(n),n+=4,n+=4,r.duration=t.getUint32(n)),n+=4,n+=8,r.layer=t.getUint16(n),n+=2,r.alternateGroup=t.getUint16(n),n+=2,r.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,r.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,r.width=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,r.height=t.getUint16(n)+t.getUint16(n+2)/16,r},traf:function(e){return{boxes:r(e)}},trak:function(e){return{boxes:r(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r=new DataView(e.buffer,e.byteOffset,e.byteLength),i=1&n.flags[2],a=4&n.flags[2],o=1&n.flags[1],u=2&n.flags[1],l=4&n.flags[1],c=8&n.flags[1],d=r.getUint32(4),h=8;for(i&&(n.dataOffset=r.getInt32(h),h+=4),a&&d&&(t={flags:s(e.subarray(h,h+4))},h+=4,o&&(t.duration=r.getUint32(h),h+=4),u&&(t.size=r.getUint32(h),h+=4),c&&(t.compositionTimeOffset=r.getUint32(h),h+=4),n.samples.push(t),d--);d--;)t={},o&&(t.duration=r.getUint32(h),h+=4),u&&(t.size=r.getUint32(h),h+=4),l&&(t.flags=s(e.subarray(h,h+4)),h+=4),c&&(t.compositionTimeOffset=r.getUint32(h),h+=4),n.samples.push(t);return n},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}};r=function(e){for(var t,n,r,i,a,o=0,s=[],l=new ArrayBuffer(e.length),c=new Uint8Array(l),h=0;h<e.length;++h)c[h]=e[h];for(t=new DataView(l);o<e.byteLength;)n=t.getUint32(o),r=u(e.subarray(o+4,o+8)),i=n>1?o+n:e.byteLength,(a=(d[r]||function(e){return{data:e}})(e.subarray(o+8,i))).size=n,a.type=r,s.push(a),o=i;return s},i=function(e,t){var n;return t=t||0,n=new Array(2*t+1).join(" "),e.map((function(e,r){return n+e.type+"\n"+Object.keys(e).filter((function(e){return"type"!==e&&"boxes"!==e})).map((function(t){var r=n+"  "+t+": ",i=e[t];if(i instanceof Uint8Array||i instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(i.buffer,i.byteOffset,i.byteLength)).map((function(e){return" "+("00"+e.toString(16)).slice(-2)})).join("").match(/.{1,24}/g);return a?1===a.length?r+"<"+a.join("").slice(1)+">":r+"<\n"+a.map((function(e){return n+"  "+e})).join("\n")+"\n"+n+"  >":r+"<>"}return r+JSON.stringify(i,null,2).split("\n").map((function(e,t){return 0===t?e:n+"  "+e})).join("\n")})).join("\n")+(e.boxes?"\n"+i(e.boxes,t+1):"")})).join("\n")},e.exports={inspect:r,textify:i,parseType:u,findBox:l,parseTraf:d.traf,parseTfdt:d.tfdt,parseHdlr:d.hdlr,parseTfhd:d.tfhd,parseTrun:d.trun,parseSidx:d.sidx}},function(e,t,n){var r,i,a,o,s;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,i=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return n.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var u=i.exec(o.path);o.netLoc=u[1],o.path=u[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(l.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;l.path=s.normalizePath(d)}else l.path=o.path,a.params||(l.params=o.params,a.query||(l.query=o.query));return null===l.path&&(l.path=n.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(l)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>void 0===e||"number"==typeof e||"string"==typeof e&&("balanced"===e||"interactive"===e||"playback"===e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((n,r)=>e.call(t,n,r,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n,r,i)=>{"function"==typeof e.copyToChannel?0!==t[n].byteLength&&e.copyToChannel(t[n],r,i):0!==t[n].byteLength&&e.getChannelData(r).set(t[n],i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n,r,i,a,o,s,u,l,c)=>{const d=l.length;let h=s;for(let s=0;s<d;s+=1){let d=n[0]*l[s];for(let t=1;t<i;t+=1){const r=h-t&u-1;d+=n[t]*a[r],d-=e[t]*o[r]}for(let e=i;e<r;e+=1)d+=n[e]*a[h-e&u-1];for(let n=i;n<t;n+=1)d-=e[n]*o[h-n&u-1];a[h]=l[s],o[h]=d,h=h+1&u-1,c[s]=d}return h}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t)))))},function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var i=r(n(121)),a=r(n(0));e.exports=function(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=i.buildAbsoluteURL(a.location&&a.location.href||"",e)),i.buildAbsoluteURL(e,t))}},function(e,t,n){var r=n(78),i=function(e,t){for(var n,r,i,a=new Array(e.length),o=0;o<e.length;o++)n=Math.atan2(e[o][1],e[o][0]),r=Math.atan2(e[o][2],Math.sqrt(e[o][0]*e[o][0]+e[o][1]*e[o][1])),1==t?a[o]=[n,r]:(i=Math.sqrt(e[o][0]*e[o][0]+e[o][1]*e[o][1]+e[o][2]*e[o][2]),a[o]=[n,r,i]);return a},a=function(e,t){for(var n=new Array(t.length),i=new Array(t.length),a=0;a<t.length;a++)n[a]=t[a][0],i[a]=t[a][1];var u,l,c,d,h,f=new Array(2*e+1),p=(n.length,(e+1)*(e+1)),m=0,g=0,v=r.sin(i),y=0,_=new Array(p);for(a=0;a<2*e+1;a++)f[a]=o(a);for(var b=0;b<e+1;b++){if(0==b){var E=new Array(n.length);E.fill(1),_[b]=E,y=1}else{u=s(b,v,m,g),l=Math.sqrt(2*b+1);for(var T=0;T<b+1;T++)0==T?_[y+b]=r.mul(l,u[T]):(c=l*Math.sqrt(2*f[b-T]/f[b+T]),d=r.cos(r.mul(T,n)),h=r.sin(r.mul(T,n)),_[y+b-T]=r.mul(c,r.mul(u[T],h)),_[y+b+T]=r.mul(c,r.mul(u[T],d)));y=y+2*b+1}g=m,m=u}return _},o=function(e){return 0===e?1:e*o(e-1)},s=function(e,t,n,i){var a=new Array(e+1);switch(e){case 1:var o=r.mul(t,t),s=t,u=r.sqrt(r.sub(1,o));a[0]=s,a[1]=u;break;case 2:o=r.mul(t,t);var l=r.mul(3,o);l=r.sub(l,1),l=r.div(l,2);var c=r.sub(1,o);c=r.sqrt(c),c=r.mul(3,c),c=r.mul(c,t);var d=r.sub(1,o);d=r.mul(3,d),a[0]=l,a[1]=c,a[2]=d;break;default:o=r.mul(t,t);var h=r.sub(1,o),f=2*e-1,p=1;if(f%2==0)for(var m=1;m<f/2+1;m++)p=2*p*m;else for(m=1;m<(f+1)/2+1;m++)p*=2*m-1;a[e]=r.mul(p,r.pow(h,e/2)),a[e-1]=r.mul(2*e-1,r.mul(t,n[e-1]));for(var g=0;g<e-1;g++){var v=r.mul(2*e-1,r.mul(t,n[g])),y=r.mul(e+g-1,i[g]);a[g]=r.div(r.sub(v,y),e-g)}}return a},u=function(e){var t=r.transpose(e);return r.dot(r.inv(r.dot(t,e)),t)};function l(e,t,n,r,i){return h(0,e,t,n,r,i)}function c(e,t,n,r,i){var a,o,s,u;return 0==t?s=(a=h(1,e,1,n,r,i))+(o=h(-1,e,-1,n,r,i)):t>0?(u=1==t?1:0,a=h(1,e,t-1,n,r,i),o=h(-1,e,1-t,n,r,i),s=a*Math.sqrt(1+u)-o*(1-u)):(u=-1==t?1:0,s=(a=h(1,e,t+1,n,r,i))*(1-u)+(o=h(-1,e,-t-1,n,r,i))*Math.sqrt(1+u)),s}function d(e,t,n,r,i){var a;return 0==t?console.error("should not be called"):a=t>0?h(1,e,t+1,n,r,i)+h(-1,e,-t-1,n,r,i):h(1,e,t-1,n,r,i)-h(-1,e,1-t,n,r,i),a}function h(e,t,n,r,i,a){var o,s,u;return o=i[e+1][2],s=i[e+1][0],u=i[e+1][1],r==-t?o*a[n+t-1][0]+s*a[n+t-1][2*t-2]:r==t?o*a[n+t-1][2*t-2]-s*a[n+t-1][0]:u*a[n+t-1][r+t-1]}e.exports.forwardSHT=function(e,t,n,o){var s,l=t.length,c=[,];(e+1)*(e+1)>l&&console.log("The SHT degree is too high for the number of data points"),0==n&&(t=i(t));for(var d=0;d<t.length;d++)c[d]=t[d][2];return Y_N=a(e,t),s=0==o?r.mul(1/l,Y_N):u(r.transpose(Y_N)),r.dotMV(s,c)},e.exports.inverseSHT=function(e,t){for(var n=t,i=Math.sqrt(e.length)-1,o=a(i,t),s=r.dotVM(e,o),u=0;u<t.length;u++)n[u][2]=s[u];return n},e.exports.print2Darray=function(e){for(var t=0;t<e.length;t++)console.log(e[t])},e.exports.convertCart2Sph=i,e.exports.convertSph2Cart=function(e){for(var t,n,r,i=new Array(e.length),a=0;a<e.length;a++)t=Math.cos(e[a][0])*Math.cos(e[a][1]),n=Math.sin(e[a][0])*Math.cos(e[a][1]),r=Math.sin(e[a][1]),2==e[0].length?i[a]=[t,n,r]:3==e[0].length&&(i[a]=[e[a][2]*t,e[a][2]*n,e[a][2]*r]);return i},e.exports.computeRealSH=a,e.exports.factorial=o,e.exports.recurseLegendrePoly=s,e.exports.pinv_svd=function(e){for(var t=r.svd(e),n=t.S[0],i=t.U,a=t.S,o=t.V,s=e.length,u=e[0].length,l=Math.max(s,u)*r.epsilon*n,c=a.length,d=new Array(c),h=c-1;-1!==h;h--)a[h]>l?d[h]=1/a[h]:d[h]=0;return r.dot(r.dot(o,r.diag(d)),r.transpose(i))},e.exports.pinv_direct=u,e.exports.getSHrotMtx=function(e,t){var n=(t+1)*(t+1),i=r.rep([n,n],0);i[0][0]=1;var a=r.rep([3,3],0);a[0][0]=e[1][1],a[0][1]=e[1][2],a[0][2]=e[1][0],a[1][0]=e[2][1],a[1][1]=e[2][2],a[1][2]=e[2][0],a[2][0]=e[0][1],a[2][1]=e[0][2],a[2][2]=e[0][0],i=r.setBlock(i,[1,1],[3,3],a);for(var o=a,s=3,u=2;u<t+1;u++){for(var h=r.rep([2*u+1,2*u+1],0),f=-u;f<u+1;f++)for(var p=-u;p<u+1;p++){var m,g,v,y,_;m=0==f?1:0,g=Math.abs(p)==u?2*u*(2*u-1):u*u-p*p,v=Math.sqrt((u*u-f*f)/g),y=Math.sqrt((1+m)*(u+Math.abs(f)-1)*(u+Math.abs(f))/g)*(1-2*m)*.5,_=Math.sqrt((u-Math.abs(f)-1)*(u-Math.abs(f))/g)*(1-m)*-.5,0!=v&&(v*=l(u,f,p,a,o)),0!=y&&(y*=c(u,f,p,a,o)),0!=_&&(_*=d(u,f,p,a,o)),h[f+u][p+u]=v+y+_}i=r.setBlock(i,[s+1,s+1],[s+2*u+1,s+2*u+1],h),o=h,s=s+2*u+1}return i},e.exports.yawPitchRoll2Rzyx=function(e,t,n){var i,a,o;i=0==n?[[1,0,0],[0,1,0],[0,0,1]]:[[1,0,0],[0,Math.cos(n),Math.sin(n)],[0,-Math.sin(n),Math.cos(n)]],a=0==t?[[1,0,0],[0,1,0],[0,0,1]]:[[Math.cos(t),0,-Math.sin(t)],[0,1,0],[Math.sin(t),0,Math.cos(t)]],o=0==e?[[1,0,0],[0,1,0],[0,0,1]]:[[Math.cos(e),Math.sin(e),0],[-Math.sin(e),Math.cos(e),0],[0,0,1]];var s=r.dotMMsmall(a,o);return s=r.dotMMsmall(i,s)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(42),i=n(89);function a(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.active=!1,this.isRandomised="bridgid"==t,this.randomiser=null,this.time=0,this.soundUrl=this._setupSourceUrl(),this.player=null,this.channel=null,this._setup()}var t,n,s,u,l;return t=e,(n=[{key:"dispose",value:function(){console.log("disposing of "+this.name),this.isRandomised&&clearInterval(this.randomiser),this.time=null,this.active=null,this.isRandomised=null,this.name=null,this.soundUrl=null,this.player.dispose(),this.player=null,this.channel.dispose(),this.channel=null}},{key:"_setupSourceUrl",value:function(){var e="";switch(this.name){case"sun":e="./media/audio/Redstart_RX.mp3";break;case"janelleA":e="./media/audio/Janelle_Distortion_03secs_96kbps.mp3";break;case"janelleB":e="./media/audio/Janelle_Distortion_07secs_96kbps.mp3";break;case"bridgid":e=this._getRandomFile();break;case"tester":e="./media/audio/creed.mp3"}return e}},{key:"_getRandomFile",value:function(){var e="";switch(Object(i.b)(0,3)){case 0:e="./media/audio/BridgidMono02.mp3";break;case 1:e="./media/audio/BridgidMono03.mp3";break;case 2:e="./media/audio/BridgidMono07.mp3";break;default:e="./media/audio/bridgid-monologue.mp3"}return e}},{key:"_setup",value:function(){console.log("This is a Grain player reporting: "+this.name+" playing: "+this.url),this._initAsync()}},{key:"_initAsync",value:(u=regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.channel=new r.a({pan:0,volume:0}),e.next=3,new r.e({url:this.soundUrl,loop:!this.isRandomised,grainSize:.1,overlap:.05,autoplay:!1,onload:function(){t.player.set({loopStart:0,loopEnd:t.player.buffer.duration}),t._randomStart()}});case 3:this.player=e.sent,this.player.connect(this.channel),this.channel.toDestination(),this.channel.send("chorus"),this.channel.send("cheby"),this.channel.send("reverb");case 9:case"end":return e.stop()}}),e,this)})),l=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=u.apply(e,t);function o(e){a(i,n,r,o,s,"next",e)}function s(e){a(i,n,r,o,s,"throw",e)}o(void 0)}))},function(){return l.apply(this,arguments)})},{key:"_randomiser",value:function(){this.time+=1,this.time>=6&&(this.time=0,this.player.stop(),this.player.buffer.load(this._getRandomFile()),this.reset())}},{key:"_randomStart",value:function(){this.isRandomised&&this.active&&this.player.start("+0.1")}},{key:"reset",value:function(){this.player.set({grainSize:.1,loopStart:0,loopEnd:this.player.buffer.duration,overlap:.05}),this.channel.set({volume:0})}},{key:"grainTransport",value:function(){var e=this;"started"==e.player.state?(e.player.stop(),this.isRandomised&&clearInterval(this.randomiser)):(e.player.start(),this.isRandomised&&(this.randomiser=setInterval(this._randomiser.bind(this),1e3)))}},{key:"setGrainSize",value:function(e){this.player.set({grainSize:e})}},{key:"setOverlap",value:function(e){this.player.set({overlap:e})}},{key:"setLoop",value:function(e,t){this.player.set({loopStart:e*this.player.buffer.duration}),this.player.set({loopEnd:t*this.player.buffer.duration})}},{key:"setSpeed",value:function(e){this.isRandomised&&this.player.set({playbackRate:e})}},{key:"reverse",value:function(){this.isRandomised&&this.player.set({reverse:!this.player.reverse})}},{key:"detune",value:function(e){this.player.set({detune:e})}},{key:"unmute",value:function(){this.channel.mute=!1}},{key:"mute",value:function(){this.channel.mute=!0}},{key:"setTrim",value:function(e){this.channel.set({volume:e})}}])&&o(t.prototype,n),s&&o(t,s),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(9)),i=h(n(2)),a=h(n(883)),o=h(n(131)),s=h(n(909)),u=h(n(910)),l=h(n(16)),c=h(n(18)),d=n(54);function h(e){return e&&e.__esModule?e:{default:e}}function f(){var e=this.context,t=void 0,n=void 0,i=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0;function I(e){void 0===R&&null!==e.fromStreamInfo&&(R=this.getCurrentTrackIdx())}function O(){void 0===R&&(R=this.getCurrentTrackIdx())}function D(){void 0!==R&&(this.setTextTrack(R),R=void 0)}function P(e){var t=this,n=e.tracks,r=e.index;E&&n.some((function(e,n){if(p.matchSettings(E,e))return t.setTextTrack(n),r=n,!0})),(!1===w||void 0===w&&!E||C)&&this.setTextTrack(-1),S=r,b.trigger(c.default.TEXT_TRACKS_ADDED,{enabled:N(),index:r,tracks:n}),M=!0}function L(e){if(!T&&e&&e.newMediaInfo){var t=e.newMediaInfo;t.type===r.default.FRAGMENTED_TEXT&&(E={lang:t.lang,role:t.roles[0],accessibility:t.accessibility[0]})}}function N(){var e=!0;return A&&!x&&(e=!1),e}function k(){A=!0,M=!1,C=!1}return t={setConfig:function(e){e&&(e.errHandler&&(i=e.errHandler),e.adapter&&(h=e.adapter),e.manifestModel&&(f=e.manifestModel),e.mediaController&&(p=e.mediaController),e.videoModel&&(m=e.videoModel),e.streamController&&(g=e.streamController),e.textTracks&&(v=e.textTracks),e.vttParser&&(y=e.vttParser),e.ttmlParser&&(_=e.ttmlParser),n.setConfig({errHandler:i,adapter:h,manifestModel:f,mediaController:p,videoModel:m,streamController:g,textTracks:v,vttParser:y,ttmlParser:_}))},getTextSourceBuffer:function(){return n},getAllTracksAreDisabled:function(){return A},addEmbeddedTrack:function(e){n.addEmbeddedTrack(e)},getTextDefaultLanguage:function(){return E&&E.lang||""},setTextDefaultLanguage:function(e){(0,d.checkParameterType)(e,"string"),E||(E={}),E.lang=e,T=!0},setTextDefaultEnabled:function(e){(0,d.checkParameterType)(e,"boolean"),(w=e)?A=!1:this.setTextTrack(-1)},getTextDefaultEnabled:function(){return void 0!==w&&w},setInitialSettings:function(e){E=e,T=!0},enableText:function(e){(0,d.checkParameterType)(e,"boolean"),!w&&e&&(w=!0),N()!==e&&(e&&this.setTextTrack(S),e||(S=this.getCurrentTrackIdx(),M?this.setTextTrack(-1):C=!0))},isTextEnabled:N,setTextTrack:function(e){var t=n.getConfig(),i=t.fragmentModel,a=t.fragmentedTracks,o=t.videoModel,s=void 0,u=void 0;A=-1===e;var l=v.getCurrentTrackIdx();if(l!==e){A&&p&&p.saveTextSettingsDisabled(),v.setModeForTrackIdx(l,r.default.TEXT_HIDDEN),v.setCurrentTrackIdx(e),v.setModeForTrackIdx(e,r.default.TEXT_SHOWING);var c=v.getCurrentTrackInfo();if(c&&c.isFragmented&&!c.isEmbedded)for(var d=0;d<a.length;d++){var h=a[d];if(c.lang===h.lang&&c.index===h.index&&(h.id?c.id===h.id:c.id===h.index))if(h!==p.getCurrentTrackFor(r.default.FRAGMENTED_TEXT,g.getActiveStreamInfo()))i.abortRequests(),i.removeExecutedRequestsBeforeTime(),n.remove(),v.deleteCuesFromTrackIdx(l),p.setTrack(h),n.setCurrentFragmentedTrackIdx(d);else if(-1===l){for(var f=g.getActiveStreamProcessors(),m=0;m<f.length;m++)if(f[m].getType()===r.default.FRAGMENTED_TEXT){u=f[m];break}u.setIndexHandlerTime(o.getTime()),u.getScheduleController().start()}}else if(c&&!c.isFragmented){for(var y=g.getActiveStreamProcessors(),_=0;_<y.length;_++)if(y[_].getType()===r.default.TEXT){s=(u=y[_]).getMediaInfoArr();break}if(u&&s)for(var b=0;b<s.length;b++)if(s[b].index===c.index&&s[b].lang===c.lang){u.selectMediaInfo(s[b]);break}}}},getCurrentTrackIdx:function(){return v.getCurrentTrackIdx()},enableForcedTextStreaming:function(e){(0,d.checkParameterType)(e,"boolean"),x=e},reset:function(){k(),n.resetEmbedded(),n.reset()}},E=null,S=-1,x=!1,M=!1,T=!1,C=!1,v=(0,o.default)(e).getInstance(),y=(0,s.default)(e).getInstance(),_=(0,u.default)(e).getInstance(),n=(0,a.default)(e).getInstance(),b=(0,l.default)(e).getInstance(),v.initialize(),b.on(c.default.TEXT_TRACKS_QUEUE_INITIALIZED,P,t),b.on(c.default.CURRENT_TRACK_CHANGED,L,t),b.on(c.default.PERIOD_SWITCH_STARTED,I,t),b.on(c.default.STREAM_COMPLETED,O,t),b.on(c.default.PERIOD_SWITCH_COMPLETED,D,t),k(),t}f.__dashjs_factory_name="TextController",t.default=i.default.getSingletonFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(9)),i=c(n(16)),a=c(n(18)),o=c(n(2)),s=c(n(17)),u=n(103),l=n(54);function c(e){return e&&e.__esModule?e:{default:e}}function d(){var e=this.context,t=(0,i.default)(e).getInstance(),n=void 0,o=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0;function A(e){var t=h[e].kind,n=void 0!==h[e].id?h[e].id:h[e].lang,r=h[e].lang,i=h[e].isTTML,a=h[e].isEmbedded;return d.addTextTrack(t,n,r,i,a)}function x(e,t,n,r,i,a){var o=0,s=0;e/t>n/r?o=(s=t)/r*n:s=(o=e)/n*r;var u,l,c=0,d=0;return o/s>i?(d=s,c=s*i):(c=o,d=o/i),u=(e-c)/2,l=(t-d)/2,a?{x:u+.1*c,y:l+.1*d,w:.8*c,h:.8*d}:{x:u,y:l,w:c,h:d}}function M(e,n){var r=d.getClientWidth(),i=d.getClientHeight(),o=d.getVideoWidth(),s=d.getVideoHeight(),u=d.getVideoRelativeOffsetTop(),l=d.getVideoRelativeOffsetLeft();if(0!==o&&0!==s){var c=o/s,h=!1;e.isFromCEA608&&(c=3.5/3,h=!0);var f=x.call(this,r,i,o,s,c,h),p=f.w,b=f.h,S=f.x,A=f.y;if(p!=v||b!=y||S!=m||A!=g||n){if(m=S+l,g=A+u,v=p,y=b,_){var M=_.style;M&&(M.left=m+"px",M.top=g+"px",M.width=v+"px",M.height=y+"px",M.zIndex=E&&document[E]||T?w:null,t.trigger(a.default.CAPTION_CONTAINER_RESIZE,{}))}var C=e.activeCues;if(C)for(var R=C.length,I=0;I<R;++I){var O=C[I];O.scaleCue(O)}}}}function C(e){var t=v,n=y,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;if(e.cellResolution){var u=[t/e.cellResolution[0],n/e.cellResolution[1]];if(e.linePadding)for(r in e.linePadding)if(e.linePadding.hasOwnProperty(r)){i=(e.linePadding[r]*u[0]).toString();for(var l=document.getElementsByClassName("spanPadding"),c=0;c<l.length;c++)l[c].style.cssText=l[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i),l[c].style.cssText=l[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}if(e.fontSize){for(r in e.fontSize)if(e.fontSize.hasOwnProperty(r)){"%"===e.fontSize[r][0]?a=e.fontSize[r][1]/100:"c"===e.fontSize[r][0]&&(a=e.fontSize[r][1]),i=(a*u[1]).toString(),s="defaultFontSize"!==r?document.getElementsByClassName(r):document.getElementsByClassName("paragraph");for(var d=0;d<s.length;d++)s[d].style.cssText=s[d].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}if(e.lineHeight)for(r in e.lineHeight)if(e.lineHeight.hasOwnProperty(r)){"%"===e.lineHeight[r][0]?o=e.lineHeight[r][1]/100:"c"===e.fontSize[r][0]&&(o=e.lineHeight[r][1]),i=(o*u[1]).toString(),s=document.getElementsByClassName(r);for(var h=0;h<s.length;h++)s[h].style.cssText=s[h].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}}}if(e.isd){var f=document.getElementById(e.cueID);f&&_.removeChild(f),R(e)}}function R(e){if(_){var n=document.createElement("div");_.appendChild(n),S=(0,u.renderHTML)(e.isd,n,(function(t){var n=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,r=/^#(.*)$/;if(n.test(t)){var i=n.exec(t),a=parseInt(i[4],10)-1;return"data:image/png;base64,"+btoa(e.images[a])}if(r.test(t)){var o=r.exec(t)[1];return"data:image/png;base64,"+e.embeddedImages[o]}return null}),_.clientHeight,_.clientWidth,!1,(function(e){o.info("renderCaption :",e)}),S,!0),n.id=e.cueID,t.trigger(a.default.CAPTION_RENDERED,{captionDiv:n,currentTrackIdx:p})}}function I(e){return e>=0&&h[e]?d.getTextTrack(h[e].kind,h[e].id,h[e].lang,h[e].isTTML,h[e].isEmbedded):null}function O(e){if(e!==p){var t=I(p=e);D.call(this,t),b&&(clearInterval(b),b=null),t&&"html"===t.renderingType&&(M.call(this,t,!0),b=setInterval(M.bind(this,t),500))}}function D(e){F.call(this),e&&"html"===e.renderingType?N.call(this):k.call(this)}function P(e,t,n){return(isNaN(t)||e.startTime>=t)&&(isNaN(n)||e.endTime<=n)}function L(e,t,n){if(e.cues)for(var r=e.cues,i=r.length-1;i>=0;i--)P(r[i],t,n)&&e.removeCue(r[i])}function N(){var e=document.getElementById("native-cue-style");if(!e){(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,n=d.getElement();try{n&&(n.id?t.insertRule("#"+n.id+"::cue {background: transparent}",0):0!==n.classList.length?t.insertRule("."+n.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(e){o.info(""+e.message)}}}function k(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function F(){if(_)for(;_.firstChild;)_.removeChild(_.firstChild)}return n={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(c=window.VTTCue||window.TextTrackCue,h=[],f=[],p=-1,m=0,g=0,v=0,y=0,_=null,b=null,T=!1,w=2147483647,S=null,void 0!==document.fullscreenElement?E="fullscreenElement":void 0!==document.webkitIsFullScreen?E="webkitIsFullScreen":document.msFullscreenElement?E="msFullscreenElement":document.mozFullScreen&&(E="mozFullScreen"))},setDisplayCConTop:function(e){(0,l.checkParameterType)(e,"boolean"),T=e,_&&!document[E]&&(_.style.zIndex=e?w:null)},addTextTrack:function(e,n){if(h.length!==n){if(h.push(e),h.length===n){h.sort((function(e,t){return e.index-t.index})),_=d.getTTMLRenderingDiv();for(var i=-1,s=0;s<h.length;s++){var u=A.call(this,s);f.push(u),h[s].defaultTrack&&(u.default=!0,i=s);var l=I(s);l&&(l.mode=r.default.TEXT_SHOWING,_&&(h[s].isTTML||h[s].isEmbedded)?l.renderingType="html":l.renderingType="default"),this.addCaptions(s,0,h[s].captionData),t.trigger(a.default.TEXT_TRACK_ADDED)}if(O.call(this,i),i>=0){t.on(a.default.PLAYBACK_METADATA_LOADED,(function e(){var n=I(i);n&&M.call(this,n,!0),t.off(a.default.PLAYBACK_METADATA_LOADED,e,this)}),this);for(var c=0;c<h.length;c++){var m=I(c);m&&(m.mode=c===i?r.default.TEXT_SHOWING:r.default.TEXT_HIDDEN)}}t.trigger(a.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:p,tracks:h})}}else o.error("Trying to add too many tracks.")},addCaptions:function(e,n,i){var s=I(e),u=this;if(s&&Array.isArray(i)&&0!==i.length)for(var l=0;l<i.length;l++){var d=void 0,h=i[l];s.cellResolution=h.cellResolution,s.isFromCEA608=h.isFromCEA608,"html"===h.type&&_?((d=new c(h.start-n,h.end-n,"")).cueHTMLElement=h.cueHTMLElement,d.isd=h.isd,d.images=h.images,d.embeddedImages=h.embeddedImages,d.cueID=h.cueID,d.scaleCue=C.bind(u),d.cellResolution=h.cellResolution,d.lineHeight=h.lineHeight,d.linePadding=h.linePadding,d.fontSize=h.fontSize,_.style.left=m+"px",_.style.top=g+"px",_.style.width=v+"px",_.style.height=y+"px",d.onenter=function(){s.mode===r.default.TEXT_SHOWING&&(this.isd?(R(this),o.debug("Cue enter id:"+this.cueID)):(_.appendChild(this.cueHTMLElement),C.call(u,this),t.trigger(a.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:p})))},d.onexit=function(){if(_)for(var e=_.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(o.debug("Cue exit id:"+e[t].id),_.removeChild(e[t]),--t)}):h.data&&(d=new c(h.start-n,h.end-n,h.data),h.styles&&(void 0!==h.styles.align&&"align"in d&&(d.align=h.styles.align),void 0!==h.styles.line&&"line"in d&&(d.line=h.styles.line),void 0!==h.styles.position&&"position"in d&&(d.position=h.styles.position),void 0!==h.styles.size&&"size"in d&&(d.size=h.styles.size)),d.onenter=function(){s.mode===r.default.TEXT_SHOWING&&t.trigger(a.default.CAPTION_RENDERED,{currentTrackIdx:p})});try{d?s.addCue(d):o.error("impossible to display subtitles.")}catch(e){throw L(s),s.addCue(d),e}}},getCurrentTrackIdx:function(){return p},setCurrentTrackIdx:O,getTrackIdxForId:function(e){for(var t=-1,n=0;n<h.length;n++)if(h[n].id===e){t=n;break}return t},getCurrentTrackInfo:function(){return h[p]},setModeForTrackIdx:function(e,t){var n=I(e);n&&n.mode!==t&&(n.mode=t)},deleteCuesFromTrackIdx:function(e,t,n){var r=I(e);r&&L(r,t,n)},deleteAllTextTracks:function(){for(var e=f?f.length:0,t=0;t<e;t++){var n=I(t);n&&(L.call(this,n),n.mode="disabled")}f=[],h=[],b&&(clearInterval(b),b=null),p=-1,F.call(this)},deleteTextTrack:function(e){d.removeChild(f[e]),f.splice(e,1)},setConfig:function(e){e&&e.videoModel&&(d=e.videoModel)}},o=(0,s.default)(e).getInstance().getLogger(n),n}d.__dashjs_factory_name="TextTracks",t.default=o.default.getSingletonFactory(d)},function(e,t,n){!function(e,t,n){function r(e,t,n,r,i,a,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=i,this.animatable=a,this.initial=n,this.applies=r,this.parse=o,this.compute=s}for(var i in e.all=[new r(t.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,n.parseColor,null),new r(t.ns_tts,"color","white",["span"],!0,!0,n.parseColor,null),new r(t.ns_tts,"direction","ltr",["p","span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"displayAlign","before",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"extent","auto",["tt","region"],!1,!0,(function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null}),(function(e,t,r,i,a){var o,s;if("auto"===i)o=new n.ComputedLength(0,1);else if(null===(o=n.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new n.ComputedLength(1,0);else if(null===(s=n.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}})),new r(t.ns_tts,"fontFamily","default",["span"],!0,!0,(function(e){var t=e.split(","),n=[];for(var r in t)"'"!==t[r].charAt(0)&&'"'!==t[r].charAt(0)&&"default"===t[r]?n.push("monospaceSerif"):n.push(t[r]);return n}),null),new r(t.ns_tts,"shear","0%",["p"],!0,!0,n.parseLength,(function(e,t,n,r){return"%"!==r.unit?null:Math.abs(r.value)>100?100*Math.sign(r.value):r.value})),new r(t.ns_tts,"fontSize","1c",["span"],!0,!0,n.parseLength,(function(t,r,i,a,o){return n.toComputedLength(a.value,a.unit,null!==r?r.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,null!==r?r.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,t.cellLength.h,t.pxLength.h)})),new r(t.ns_tts,"fontStyle","normal",["span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"fontWeight","normal",["span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"lineHeight","normal",["p"],!0,!0,(function(e){return"normal"===e?e:n.parseLength(e)}),(function(t,r,i,a,o){var s;if("normal"===a)s=a;else if(null===(s=n.toComputedLength(a.value,a.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h)))return null;return s})),new r(t.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new r(t.ns_tts,"origin","auto",["region"],!1,!0,(function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var r=n.parseLength(t[0]),i=n.parseLength(t[1]);return i&&r?{h:i,w:r}:null}),(function(e,t,r,i,a){var o,s;if("auto"===i)o=new n.ComputedLength(0,0);else if(null===(o=n.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new n.ComputedLength(0,0);else if(null===(s=n.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}})),new r(t.ns_tts,"overflow","hidden",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"padding","0px",["region"],!1,!0,(function(e){var t=e.split(" ");if(t.length>4)return null;var r=[];for(var i in t){var a=n.parseLength(t[i]);if(!a)return null;r.push(a)}return r}),(function(t,r,i,a,o){var s;if(1===a.length)s=[a[0],a[0],a[0],a[0]];else if(2===a.length)s=[a[0],a[1],a[0],a[1]];else if(3===a.length)s=[a[0],a[1],a[2],a[1]];else{if(4!==a.length)return null;s=[a[0],a[1],a[2],a[3]]}var u=i.styleAttrs[e.byName.writingMode.qname];if("lrtb"===u||"lr"===u)s=[s[0],s[3],s[2],s[1]];else if("rltb"===u||"rl"===u)s=[s[0],s[1],s[2],s[3]];else if("tblr"===u)s=[s[3],s[0],s[1],s[2]];else{if("tbrl"!==u&&"tb"!==u)return null;s=[s[3],s[2],s[1],s[0]]}var l=[];for(var c in s)if(0===s[c].value)l[c]=new n.ComputedLength(0,0);else if(l[c]=n.toComputedLength(s[c].value,s[c].unit,i.styleAttrs[e.byName.fontSize.qname],"0"===c||"2"===c?i.styleAttrs[e.byName.extent.qname].h:i.styleAttrs[e.byName.extent.qname].w,"0"===c||"2"===c?t.cellLength.h:t.cellLength.w,"0"===c||"2"===c?t.pxLength.h:t.pxLength.w),null===l[c])return null;return l})),new r(t.ns_tts,"position","top left",["region"],!1,!0,(function(e){return n.parsePosition(e)}),(function(t,r,i,a){var o,s;return null===(o=n.toComputedLength(a.v.offset.value,a.v.offset.unit,null,new n.ComputedLength(-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-i.styleAttrs[e.byName.extent.qname].h.rh),null,t.pxLength.h))?null:("bottom"===a.v.edge&&(o=new n.ComputedLength(-o.rw-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-o.rh-i.styleAttrs[e.byName.extent.qname].h.rh)),s=n.toComputedLength(a.h.offset.value,a.h.offset.unit,null,new n.ComputedLength(t.dimensions.w.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-i.styleAttrs[e.byName.extent.qname].w.rh),null,t.pxLength.w),null===o?null:("right"===a.h.edge&&(s=new n.ComputedLength(t.dimensions.w.rw-s.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-s.rh-i.styleAttrs[e.byName.extent.qname].w.rh)),{h:o,w:s}))})),new r(t.ns_tts,"ruby","none",["span"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"rubyAlign","center",["span"],!0,!0,(function(e){return"center"!==e&&"spaceAround"!==e?null:e}),null),new r(t.ns_tts,"rubyPosition","outside",["span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"rubyReserve","none",["p"],!0,!0,(function(e){var t=e.split(" "),r=[null,null];if(0===t.length||t.length>2)return null;if("none"!==t[0]&&"both"!==t[0]&&"after"!==t[0]&&"before"!==t[0]&&"outside"!==t[0])return null;if(r[0]=t[0],2===t.length&&"none"!==t[0]){var i=n.parseLength(t[1]);if(!i)return null;r[1]=i}return r}),(function(t,r,i,a,o){if("none"===a[0])return a;var s=null;return null===(s=null===a[1]?new n.ComputedLength(.5*i.styleAttrs[e.byName.fontSize.qname].rw,.5*i.styleAttrs[e.byName.fontSize.qname].rh):n.toComputedLength(a[1].value,a[1].unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h))?null:[a[0],s]})),new r(t.ns_tts,"showBackground","always",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"textAlign","start",["p"],!0,!0,(function(e){return e}),(function(e,t,n,r,i){return"left"===r?"start":"right"===r?"end":r})),new r(t.ns_tts,"textCombine","none",["span"],!0,!0,(function(e){var t=e.split(" ");return 1!==t.length||"none"!==t[0]&&"all"!==t[0]?null:[t[0]]}),null),new r(t.ns_tts,"textDecoration","none",["span"],!0,!0,(function(e){return e.split(" ")}),null),new r(t.ns_tts,"textEmphasis","none",["span"],!0,!0,(function(e){var t=e.split(" "),r={style:null,symbol:null,color:null,position:null};for(var i in t)if("none"===t[i]||"auto"===t[i])r.style=t[i];else if("filled"===t[i]||"open"===t[i])r.style=t[i];else if("circle"===t[i]||"dot"===t[i]||"sesame"===t[i])r.symbol=t[i];else if("current"===t[i])r.color=t[i];else if("outside"===t[i]||"before"===t[i]||"after"===t[i])r.position=t[i];else if(r.color=n.parseColor(t[i]),null===r.color)return null;return null==r.style&&null==r.symbol?r.style="auto":(r.symbol=r.symbol||"circle",r.style=r.style||"filled"),r.position=r.position||"outside",r.color=r.color||"current",r}),null),new r(t.ns_tts,"textOutline","none",["span"],!0,!0,(function(e){if("none"===e)return e;var t={},r=e.split(" ");if(0===r.length||r.length>2)return null;var i=n.parseColor(r[0]);if(t.color=i,null!==i&&r.shift(),1!==r.length)return null;var a=n.parseLength(r[0]);return a?(t.thickness=a,t):null}),(function(t,r,i,a,o){if("none"===a)return a;var s={};return null===a.color?s.color=i.styleAttrs[e.byName.color.qname]:s.color=a.color,s.thickness=n.toComputedLength(a.thickness.value,a.thickness.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),null===s.thickness?null:s})),new r(t.ns_tts,"textShadow","none",["span"],!0,!0,n.parseTextShadow,(function(t,r,i,a){if("none"===a)return a;var o=[];for(var s in a){var u={};if(u.x_off=n.toComputedLength(a[s][0].value,a[s][0].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.w),null===u.x_off)return null;if(u.y_off=n.toComputedLength(a[s][1].value,a[s][1].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===u.y_off)return null;if(null===a[s][2])u.b_radius=0;else if(u.b_radius=n.toComputedLength(a[s][2].value,a[s][2].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===u.b_radius)return null;null===a[s][3]?u.color=i.styleAttrs[e.byName.color.qname]:u.color=a[s][3],o.push(u)}return o})),new r(t.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"wrapOption","wrap",["span"],!0,!0,(function(e){return e}),null),new r(t.ns_tts,"writingMode","lrtb",["region"],!1,!0,(function(e){return e}),null),new r(t.ns_tts,"zIndex","auto",["region"],!1,!0,(function(e){var t;return"auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t}),null),new r(t.ns_ebutts,"linePadding","0c",["p"],!0,!1,n.parseLength,(function(e,t,r,i,a){return n.toComputedLength(i.value,i.unit,null,null,e.cellLength.w,null)})),new r(t.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,(function(e){return e}),null),new r(t.ns_smpte,"backgroundImage",null,["div"],!1,!1,(function(e){return e}),null),new r(t.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,(function(e){return"true"===e}),null),new r(t.ns_itts,"fillLineGap","false",["p"],!0,!0,(function(e){return"true"===e}),null)],e.byQName={},e.all)e.byQName[e.all[i].qname]=e.all[i];for(var a in e.byName={},e.all)e.byName[e.all[a].name]=e.all[a]}(t,"undefined"==typeof imscNames?n(104):imscNames,"undefined"==typeof imscUtils?n(105):imscUtils)},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,o,s,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(a(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(i(n))for(s=Array.prototype.slice.call(arguments,1),o=(l=n.slice()).length,u=0;u<o;u++)l[u].apply(this,s);return!0},n.prototype.addListener=function(e,t){var o;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(o=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!r(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var n,a,o,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(n=this._events[e]).length,a=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(s=o;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){a=s;break}if(a<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(a,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){(t=e.exports=n(178)).Stream=t,t.Readable=t,t.Writable=n(135),t.Duplex=n(60),t.Transform=n(181),t.PassThrough=n(902)},function(e,t,n){"use strict";(function(t,r,i){var a=n(108);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=y;var s,u=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?r:a.nextTick;y.WritableState=v;var l=n(92);l.inherits=n(72);var c={deprecate:n(901)},d=n(179),h=n(109).Buffer,f=i.Uint8Array||function(){};var p,m=n(180);function g(){}function v(e,t){s=s||n(60),e=e||{};var r=t instanceof s;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,l=e.writableHighWaterMark,c=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(l||0===l)?l:c,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===e.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(a.nextTick(i,r),a.nextTick(w,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),w(e,t))}(e,n,r,t,i);else{var o=T(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||E(e,n),r?u(b,e,n,o,i):b(e,n,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function y(e){if(s=s||n(60),!(p.call(y,this)||this instanceof s))return new y(e);this._writableState=new v(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),d.call(this)}function _(e,t,n,r,i,a,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function b(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),w(e,t)}function E(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var s=0,u=!0;n;)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,_(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,c=n.encoding,d=n.callback;if(_(e,t,!1,t.objectMode?1:l.length,l,c,d),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function T(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function S(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),w(e,t)}))}function w(e,t){var n=T(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(S,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}l.inherits(y,d),v.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(v.prototype,"buffer",{get:c.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===y&&(e&&e._writableState instanceof v)}})):p=function(e){return e instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(e,t,n){var r,i=this._writableState,o=!1,s=!i.objectMode&&(r=e,h.isBuffer(r)||r instanceof f);return s&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof n&&(n=g),i.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),a.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),a.nextTick(r,o),i=!1),i}(this,i,e,n))&&(i.pendingcb++,o=function(e,t,n,r,i,a){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=h.from(t,n));return t}(t,r,i);r!==o&&(n=!0,i="buffer",r=o)}var s=t.objectMode?1:r.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:a,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else _(e,t,!1,s,r,i,a);return u}(this,i,s,e,t,n)),o},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||E(this,e))},y.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),y.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,w(e,t),n&&(t.finished?a.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),y.prototype.destroy=m.destroy,y.prototype._undestroy=m.undestroy,y.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(107),n(899).setImmediate,n(27))},function(e,t,n){"use strict";var r=n(109).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=l,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=c,this.end=d,t=3;break;default:return this.write=h,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function l(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function c(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=a,a.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},a.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=o(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=o(t[r]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=o(t[r]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(9)),i=u(n(18)),a=u(n(16)),o=u(n(2)),s=u(n(17));function u(e){return e&&e.__esModule?e:{default:e}}var l="neverReplace",c="alwaysReplace",d="highestBitrate",h="widestRange",f=d;function p(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,o=void 0,u=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=[c,l],_=[d,h];function b(e,t){if(!e||!t)return[];var n=t.id;return u[n]&&u[n][e]?u[n][e].list:[]}function E(e,t){return!e||!t||t&&!u[t.id]?null:u[t.id][e].current}function T(e,n){if(e&&e.streamInfo){var a=e.type,o=e.streamInfo,s=o.id,l=E(a,o);if(u[s]&&u[s][a]&&!M(e,l)&&(u[s][a].current=e,!u[s][a].current||n&&a===r.default.FRAGMENTED_TEXT||t.trigger(i.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:l,newMediaInfo:e,switchMode:g[a]}),!n)){var c=function(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}(e);if(!c||!u[s][a].storeLastSettings)return;c.roles&&(c.role=c.roles[0],delete c.roles),c.accessibility&&(c.accessibility=c.accessibility[0]),c.audioChannelConfiguration&&(c.audioChannelConfiguration=c.audioChannelConfiguration[0]),v.setSavedMediaSettings(a,c)}}}function S(e,t){e&&t&&(p[e]=t)}function w(e){return e?p[e]:null}function A(){return m||f}function x(e){return e===r.default.AUDIO||e===r.default.VIDEO||e===r.default.TEXT||e===r.default.FRAGMENTED_TEXT||e===r.default.IMAGE}function M(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&a&&o&&s}function C(){u={},p={audio:null,video:null,fragmentedText:null},g={audio:c,video:l}}function R(e,t){var n=!e.lang||t.lang.match(e.lang),r=!e.viewpoint||e.viewpoint===t.viewpoint,i=!e.role||!!t.roles.filter((function(t){return t===e.role}))[0],a=!e.accessibility||!!t.accessibility.filter((function(t){return t===e.accessibility}))[0],o=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter((function(t){return t===e.audioChannelConfiguration}))[0];return n&&r&&i&&a&&o}function I(e,t){if(e===r.default.FRAGMENTED_TEXT)return t[0];var n=A(),i=[],a=function(e){var t=0,n=[],r=void 0;return e.forEach((function(e){(r=Math.max.apply(Math,e.bitrateList.map((function(e){return e.bandwidth}))))>t?(t=r,n=[e]):r===t&&n.push(e)})),n},s=function(e){var t=0,n=[],r=void 0;return e.forEach((function(e){(r=e.representationCount)>t?(t=r,n=[e]):r===t&&n.push(e)})),n};switch(n){case d:(i=a(t)).length>1&&(i=s(i));break;case h:(i=s(t)).length>1&&(i=a(t));break;default:o.warn("Track selection mode is not supported: "+n)}return i[0]}return n={checkInitialMediaSettingsForType:function(e,t){var n=w(e),r=b(e,t),i=[];n||S(e,n=v.getSavedMediaSettings(e)),r&&0!==r.length&&(n&&r.forEach((function(e){R(n,e)&&i.push(e)})),0===i.length?T(I(e,r),!0):i.length>1?T(I(e,i)):T(i[0]))},addTrack:function(e){if(e){var t=e.type;if(x(t)){var n=e.streamInfo.id;u[n]||(u[n]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var r=u[n][t].list,i=0,a=r.length;i<a;++i)if(M(r[i],e))return;r.push(e);var o=w(t);o&&R(o,e)&&!E(t,e.streamInfo)&&T(e)}}},getTracksFor:b,getCurrentTrackFor:E,isCurrentTrack:function(e){if(!e)return!1;var t=e.type,n=e.streamInfo.id;return u[n]&&u[n][t]&&M(u[n][t].current,e)},setTrack:T,setInitialSettings:S,getInitialSettings:w,setSwitchMode:function(e,t){-1!==y.indexOf(t)?g[e]=t:o.warn("Track switch mode is not supported: "+t)},getSwitchMode:function(e){return g[e]},setSelectionModeForInitialTrack:function(e){-1!==_.indexOf(e)?m=e:o.warn("Track selection mode is not supported: "+e)},getSelectionModeForInitialTrack:A,isMultiTrackSupportedByType:x,isTracksEqual:M,matchSettings:R,saveTextSettingsDisabled:function(){v.setSavedMediaSettings(r.default.FRAGMENTED_TEXT,null)},setConfig:function(e){e&&e.domStorage&&(v=e.domStorage)},reset:C},o=(0,s.default)(e).getInstance().getLogger(n),C(),n}p.__dashjs_factory_name="MediaController";var m=o.default.getSingletonFactory(p);m.TRACK_SWITCH_MODE_NEVER_REPLACE=l,m.TRACK_SWITCH_MODE_ALWAYS_REPLACE=c,m.TRACK_SELECTION_MODE_HIGHEST_BITRATE=d,m.TRACK_SELECTION_MODE_WIDEST_RANGE=h,m.DEFAULT_INIT_TRACK_SELECTION_MODE=f,o.default.updateSingletonFactory(p.__dashjs_factory_name,m),t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e={};return{save:function(t){var n=t.streamId,r=t.representationId;e[n]=e[n]||{},e[n][r]=t},extract:function(t,n){return e&&e[t]&&e[t][n]?e[t][n]:null},reset:function(){e={}}}}o.__dashjs_factory_name="InitCache",t.default=a.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(){return{modifyRequestURL:function(e){return e},modifyRequestHeader:function(e){return e}}}o.__dashjs_factory_name="RequestModifier",t.default=a.default.getSingletonFactory(o)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};i.INITIAL_PLAYOUT_START_REASON="initial_playout",i.SEEK_START_REASON="seek",i.RESUME_FROM_PAUSE_START_REASON="resume",i.METRICS_COLLECTION_START_REASON="metrics_collection_start";var a=function e(){r(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};a.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",a.REBUFFERING_REASON="rebuffering",a.USER_REQUEST_STOP_REASON="user_request",a.END_OF_PERIOD_STOP_REASON="end_of_period",a.END_OF_CONTENT_STOP_REASON="end_of_content",a.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",a.FAILURE_STOP_REASON="failure",t.PlayList=i,t.PlayListTrace=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).requestModifier;return{load:function(e){var n=new Date,r=e.request,i=new XMLHttpRequest;i.open(e.method,e.url,!0),r.responseType&&(i.responseType=r.responseType),r.range&&i.setRequestHeader("Range","bytes="+r.range),r.requestStartDate||(r.requestStartDate=n),t&&(i=t.modifyRequestHeader(i)),i.withCredentials=e.withCredentials,i.onload=e.onload,i.onloadend=e.onend,i.onerror=e.onerror,i.onprogress=e.progress,i.onabort=e.onabort,i.send(),e.response=i},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort()}}}o.__dashjs_factory_name="XHRLoader";var s=a.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(102);var a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.AST_IN_FUTURE="astInFuture",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.SOURCE_INITIALIZED="sourceInitialized",e.STREAM_INITIALIZING="streamInitializing",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_SEEK_ASKED="playbackSeekAsked",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=l(n(2)),a=l(n(145)),o=l(n(17)),s=l(n(9)),u=n(34);function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(){var e,t,n={debug:{logLevel:o.default.LOG_LEVEL_WARNING},streaming:{metricsMaxListDepth:1e3,abandonLoadTimeout:1e4,liveDelayFragmentCount:NaN,liveDelay:null,scheduleWhilePaused:!0,fastSwitchEnabled:!1,bufferPruningInterval:10,bufferToKeep:20,bufferAheadToKeep:80,jumpGaps:!0,smallGapLimit:1.5,stableBufferTime:12,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,longFormContentDurationThreshold:600,wallclockTimeUpdateInterval:50,lowLatencyEnabled:!1,keepProtectionMediaKeys:!1,useManifestDateHeaderTimeSource:!0,useSuggestedPresentationDelay:!0,useAppendWindowEnd:!0,manifestUpdateRetryInterval:100,liveCatchUpMinDrift:.02,liveCatchUpMaxDrift:0,liveCatchUpPlaybackRate:.5,liveCatchupLatencyThreshold:NaN,lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},retryIntervals:(e={},c(e,u.HTTPRequest.MPD_TYPE,500),c(e,u.HTTPRequest.XLINK_EXPANSION_TYPE,500),c(e,u.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),c(e,u.HTTPRequest.INIT_SEGMENT_TYPE,1e3),c(e,u.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),c(e,u.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),c(e,u.HTTPRequest.OTHER_TYPE,1e3),c(e,"lowLatencyReductionFactor",10),e),retryAttempts:(t={},c(t,u.HTTPRequest.MPD_TYPE,3),c(t,u.HTTPRequest.XLINK_EXPANSION_TYPE,1),c(t,u.HTTPRequest.MEDIA_SEGMENT_TYPE,3),c(t,u.HTTPRequest.INIT_SEGMENT_TYPE,3),c(t,u.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),c(t,u.HTTPRequest.INDEX_SEGMENT_TYPE,3),c(t,u.HTTPRequest.OTHER_TYPE,3),c(t,"lowLatencyMultiplyFactor",5),t),abr:{movingAverageMethod:s.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:s.default.ABR_STRATEGY_DYNAMIC,bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useBufferOccupancyABR:!1,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0}},cmcd:{enabled:!1,sid:null,cid:null,did:null}}},i=a.default.clone(n);return{get:function(){return i},update:function(e){"object"===(void 0===e?"undefined":r(e))&&function e(t,n,i){for(var o in t)t.hasOwnProperty(o)&&n.hasOwnProperty(o)&&("object"===r(t[o])&&null!==t[o]?e(t[o],n[o],i.slice()+o+"."):n[o]=a.default.clone(t[o]))}(e,i,"")},reset:function(){i=a.default.clone(n)}}}d.__dashjs_factory_name="Settings";var h=i.default.getSingletonFactory(d);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"mixin",value:function(t,n,i){var a=void 0,o={};if(t)for(var s in n)n.hasOwnProperty(s)&&(a=n[s],s in t&&(t[s]===a||s in o&&o[s]===a)||("object"===r(t[s])&&null!==t[s]?t[s]=e.mixin(t[s],a,i):t[s]=i(a)));return t}},{key:"clone",value:function(t){if(!t||"object"!==(void 0===t?"undefined":r(t)))return t;var n=void 0;if(t instanceof Array){n=[];for(var i=0,a=t.length;i<a;++i)i in t&&n.push(e.clone(t[i]))}else n={};return e.mixin(n,t,e.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(e,t){try{if(!t||0===t.length)return e;var n=new URL(e);return t.forEach((function(e){e.key&&e.value&&n.searchParams.set(e.key,e.value)})),n.href}catch(t){return e}}},{key:"generateUuid",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=b(n(9)),i=b(n(33)),a=b(n(939)),o=b(n(940)),s=b(n(941)),u=b(n(942)),l=b(n(189)),c=b(n(190)),d=b(n(191)),h=b(n(943)),f=b(n(192)),p=b(n(46)),m=b(n(2)),g=b(n(17)),v=b(n(25)),y=b(n(35)),_=n(193);function b(e){return e&&e.__esModule?e:{default:e}}function E(){var e=void 0,t=void 0,n=void 0,m=void 0,b=this.context,E=(0,p.default)(b).getInstance(),T=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function S(e,t){var n=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=!1,d=!1;if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.hasOwnProperty("ContentComponent_asArray")&&(s=e.ContentComponent_asArray),u=t!==r.default.TEXT?new RegExp(t):new RegExp("(vtt|ttml)"),e.Representation_asArray&&e.Representation_asArray.length&&e.Representation_asArray.length>0){var h=P(e.Representation_asArray[0]);if(h&&h.length>0&&_.THUMBNAILS_SCHEME_ID_URIS.indexOf(h[0].schemeIdUri)>=0)return t===r.default.IMAGE;if(e.Representation_asArray[0].hasOwnProperty(i.default.CODECS)&&(0===(l=e.Representation_asArray[0].codecs).search(r.default.STPP)||0===l.search(r.default.WVTT)))return t===r.default.FRAGMENTED_TEXT}if(s){if(s.length>1)return t===r.default.MUXED;s[0]&&s[0].contentType===t&&(c=!0,d=!0)}if(e.hasOwnProperty(i.default.MIME_TYPE)&&(c=u.test(e.mimeType),d=!0),!d)for(n=0,a=e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0;!d&&n<a;)(o=e.Representation_asArray[n]).hasOwnProperty(i.default.MIME_TYPE)&&(c=u.test(o.mimeType),d=!0),n++;return c}function w(e){return S(e,r.default.AUDIO)}function A(e){return S(e,r.default.VIDEO)}function x(e){return S(e,r.default.FRAGMENTED_TEXT)}function M(e){return S(e,r.default.IMAGE)}function C(e){return"text/vtt"===e||"application/ttml+xml"===e}function R(){return function(e,t){return e.bandwidth-t.bandwidth}}function I(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort((function(e,t){return e.bandwidth-t.bandwidth})),e}function O(e,t){return e&&e.Period_asArray&&T(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function D(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===i.default.DYNAMIC),t}function P(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map((function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}})):null}function L(e){if(e&&e.period&&T(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&T(e.index))return I(t.AdaptationSet_asArray[e.index])}}function N(e){var t=e.S_asArray[e.S_asArray.length-1];return!t.hasOwnProperty("r")||t.r>=0}function k(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=s.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty(i.default.ID)&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n}function F(e,t){var n=[],a=void 0;if(!e)return n;for(a=0;a<e.length;a++){var o=new h.default;if(o.timescale=1,o.representation=t,!e[a].hasOwnProperty(r.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");o.schemeIdUri=e[a].schemeIdUri,e[a].hasOwnProperty(i.default.TIMESCALE)&&(o.timescale=e[a].timescale),e[a].hasOwnProperty(i.default.VALUE)&&(o.value=e[a].value),n.push(o)}return n}function B(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],r=!1;return n.some((function(n){if(n){var a=new d.default,o=n.__text||n;return E.isRelative(o)&&(r=!0,e.baseUri&&(o=E.resolve(o,e.baseUri))),a.url=o,n.hasOwnProperty(i.default.SERVICE_LOCATION)&&n.serviceLocation.length?a.serviceLocation=n.serviceLocation:a.serviceLocation=o,n.hasOwnProperty(i.default.DVB_PRIORITY)&&(a.dvb_priority=n[i.default.DVB_PRIORITY]),n.hasOwnProperty(i.default.DVB_WEIGHT)&&(a.dvb_weight=n[i.default.DVB_WEIGHT]),n.hasOwnProperty(i.default.AVAILABILITY_TIME_OFFSET)&&(a.availabilityTimeOffset=n[i.default.AVAILABILITY_TIME_OFFSET]),n.hasOwnProperty(i.default.AVAILABILITY_TIME_COMPLETE)&&(a.availabilityTimeComplete="false"!==n[i.default.AVAILABILITY_TIME_COMPLETE]),t.push(a),r}})),t}return e={getIsTypeOf:S,getIsTextTrack:C,getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(i.default.LANG)&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(i.default.VIEWPOINT)?e.Viewpoint:null},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(i.default.ROLE_ASARRAY)?e.Role_asArray:[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(i.default.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(i.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(i.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(e,t,n){var r=O(t,n);return r.length>0&&T(e)?r[e]:null},getIndexForAdaptation:function(e,t,n){if(!e)return-1;for(var r=O(t,n),i=0;i<r.length;i++){if((0,f.default)(b).getInstance().areEqual(r[i],e))return i}return-1},getAdaptationForId:function(e,t,n){var r,a=O(t,n),o=void 0;for(o=0,r=a.length;o<r;o++)if(a[o].hasOwnProperty(i.default.ID)&&a[o].id===e)return a[o];return null},getAdaptationsForType:function(e,t,n){var r,i=O(e,t),a=void 0,o=[];for(a=0,r=i.length;a<r;a++)S(i[a],n)&&o.push(I(i[a]));return o},getCodec:function(e,t,n){var r=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var i=T(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];i&&(r=i.mimeType+';codecs="'+i.codecs+'"',n&&void 0!==i.width&&(r+=';width="'+i.width+'";height="'+i.height+'"'))}return r&&(r=r.replace(/\sprofiles=[^;]*/g,"")),r},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(i.default.CENC_DEFAULT_KID)?e[i.default.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return[];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(i.default.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:D,hasProfile:function(e,t){var n=!1;return e&&e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf(t)),n},getDuration:function(e){return e&&e.hasOwnProperty(i.default.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e&&e.hasOwnProperty(i.default.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){var t=I(e);return(t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map((function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null}}))},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&T(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t,n,r,o,s,u=[],l=L(e),c=void 0,d=void 0;if(l&&l.Representation_asArray){if(e&&e.period&&T(e.period.index)){var h=B(e.period.mpd.manifest);h&&(d=h[0])}for(var f=0,p=l.Representation_asArray.length;f<p;++f){var m=l.Representation_asArray[f],g=new a.default;if(g.index=f,g.adaptation=e,m.hasOwnProperty(i.default.ID)&&(g.id=m.id),m.hasOwnProperty(i.default.CODECS)&&(g.codecs=m.codecs),m.hasOwnProperty(i.default.CODEC_PRIVATE_DATA)&&(g.codecPrivateData=m.codecPrivateData),m.hasOwnProperty(i.default.BANDWITH)&&(g.bandwidth=m.bandwidth),m.hasOwnProperty(i.default.WIDTH)&&(g.width=m.width),m.hasOwnProperty(i.default.HEIGHT)&&(g.height=m.height),m.hasOwnProperty(i.default.SCAN_TYPE)&&(g.scanType=m.scanType),m.hasOwnProperty(i.default.MAX_PLAYOUT_RATE)&&(g.maxPlayoutRate=m.maxPlayoutRate),m.hasOwnProperty(i.default.SEGMENT_BASE)?(c=m.SegmentBase,g.segmentInfoType=i.default.SEGMENT_BASE):m.hasOwnProperty(i.default.SEGMENT_LIST)?(c=m.SegmentList).hasOwnProperty(i.default.SEGMENT_TIMELINE)?(g.segmentInfoType=i.default.SEGMENT_TIMELINE,g.useCalculatedLiveEdgeTime=N(c.SegmentTimeline)):(g.segmentInfoType=i.default.SEGMENT_LIST,g.useCalculatedLiveEdgeTime=!0):m.hasOwnProperty(i.default.SEGMENT_TEMPLATE)?((c=m.SegmentTemplate).hasOwnProperty(i.default.SEGMENT_TIMELINE)?(g.segmentInfoType=i.default.SEGMENT_TIMELINE,g.useCalculatedLiveEdgeTime=N(c.SegmentTimeline)):g.segmentInfoType=i.default.SEGMENT_TEMPLATE,c.hasOwnProperty(i.default.INITIALIZATION_MINUS)&&(g.initialization=c.initialization.split("$Bandwidth$").join(m.bandwidth).split("$RepresentationID$").join(m.id))):g.segmentInfoType=i.default.BASE_URL,g.essentialProperties=P(m),c){if(c.hasOwnProperty(i.default.INITIALIZATION)){var v=c.Initialization;v.hasOwnProperty(i.default.SOURCE_URL)&&(g.initialization=v.sourceURL),v.hasOwnProperty(i.default.RANGE)&&(g.range=v.range)}else m.hasOwnProperty(i.default.MIME_TYPE)&&C(m.mimeType)&&(g.range=0);c.hasOwnProperty(i.default.TIMESCALE)&&(g.timescale=c.timescale),c.hasOwnProperty(i.default.DURATION)?g.segmentDuration=c.duration/g.timescale:m.hasOwnProperty(i.default.SEGMENT_TEMPLATE)&&(c=m.SegmentTemplate).hasOwnProperty(i.default.SEGMENT_TIMELINE)&&(g.segmentDuration=(r=c.SegmentTimeline,o=void 0,s=void 0,o=r.S_asArray[0],s=r.S_asArray[1],(o.hasOwnProperty("d")?o.d:s.t-o.t)/g.timescale)),c.hasOwnProperty(i.default.MEDIA)&&(g.media=c.media),c.hasOwnProperty(i.default.START_NUMBER)&&(g.startNumber=c.startNumber),c.hasOwnProperty(i.default.INDEX_RANGE)&&(g.indexRange=c.indexRange),c.hasOwnProperty(i.default.PRESENTATION_TIME_OFFSET)&&(g.presentationTimeOffset=c.presentationTimeOffset/g.timescale),c.hasOwnProperty(i.default.AVAILABILITY_TIME_OFFSET)?g.availabilityTimeOffset=c.availabilityTimeOffset:d&&void 0!==d.availabilityTimeOffset&&(g.availabilityTimeOffset=d.availabilityTimeOffset),c.hasOwnProperty(i.default.AVAILABILITY_TIME_COMPLETE)?g.availabilityTimeComplete="false"!==c.availabilityTimeComplete:d&&void 0!==d.availabilityTimeComplete&&(g.availabilityTimeComplete=d.availabilityTimeComplete)}g.MSETimeOffset=(n=void 0,void 0,n=(t=g).presentationTimeOffset,t.adaptation.period.start-n),g.path=[e.period.index,e.index,f],u.push(g)}}return u},getAdaptationsForPeriod:function(e){var t=e&&T(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,n=[],a=void 0,s=void 0,u=void 0;if(t&&t.AdaptationSet_asArray)for(u=0;u<t.AdaptationSet_asArray.length;u++)s=t.AdaptationSet_asArray[u],a=new o.default,s.hasOwnProperty(i.default.ID)&&(a.id=s.id),a.index=u,a.period=e,S(s,r.default.MUXED)?a.type=r.default.MUXED:w(s)?a.type=r.default.AUDIO:A(s)?a.type=r.default.VIDEO:x(s)?a.type=r.default.FRAGMENTED_TEXT:M(s)?a.type=r.default.IMAGE:a.type=r.default.TEXT,n.push(a);return n},getRegularPeriods:function(e){var a,o=!!e&&D(e.manifest),u=[],l=null,c=null,d=null,h=null,f=void 0;for(f=0,a=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;f<a;f++)(c=e.manifest.Period_asArray[f]).hasOwnProperty(i.default.START)?(h=new s.default).start=c.start:null!==l&&l.hasOwnProperty(i.default.DURATION)&&null!==d?(h=new s.default).start=parseFloat((d.start+d.duration).toFixed(5)):0!==f||o||((h=new s.default).start=0),null!==d&&isNaN(d.duration)&&(null!==h?d.duration=parseFloat((h.start-d.start).toFixed(5)):t.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==h&&(h.id=k(c,f),h.index=f,h.mpd=e,c.hasOwnProperty(i.default.DURATION)&&(h.duration=c.duration),u.push(h),l=c,d=h),c=null,h=null;return 0===u.length||null!==d&&isNaN(d.duration)&&(d.duration=parseFloat((function(e){!function(){if(!n||!n.hasOwnProperty("error"))throw new Error(r.default.MISSING_CONFIG_ERROR)}();var t=D(e.mpd.manifest),i=void 0;e.mpd.manifest.mediaPresentationDuration?i=e.mpd.manifest.mediaPresentationDuration:e.duration?i=e.duration:t?i=Number.POSITIVE_INFINITY:n.error(new v.default(y.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e));return i}(d)-d.start).toFixed(5))),u},getMpd:function(e){var t=new u.default;return e&&(t.manifest=e,e.hasOwnProperty(i.default.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(i.default.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(i.default.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(i.default.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(i.default.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(i.default.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(i.default.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration)),t},getEventsForPeriod:function(e){var t=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,n=t?t.Period_asArray:null,a=n&&e&&T(e.index)?n[e.index].EventStream_asArray:null,o=[],s=void 0,u=void 0;if(a)for(s=0;s<a.length;s++){var l=new h.default;if(l.period=e,l.timescale=1,!a[s].hasOwnProperty(r.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(l.schemeIdUri=a[s].schemeIdUri,a[s].hasOwnProperty(i.default.TIMESCALE)&&(l.timescale=a[s].timescale),a[s].hasOwnProperty(i.default.VALUE)&&(l.value=a[s].value),u=0;a[s].Event_asArray&&u<a[s].Event_asArray.length;u++){var d=new c.default;if(d.presentationTime=0,d.eventStream=l,a[s].Event_asArray[u].hasOwnProperty(i.default.PRESENTATION_TIME)){d.presentationTime=a[s].Event_asArray[u].presentationTime;var f=l.presentationTimeOffset?l.presentationTimeOffset*l.timescale:0;d.calculatedPresentationTime=d.presentationTime+e.start*l.timescale+f}a[s].Event_asArray[u].hasOwnProperty(i.default.DURATION)&&(d.duration=a[s].Event_asArray[u].duration),a[s].Event_asArray[u].hasOwnProperty(i.default.ID)&&(d.id=a[s].Event_asArray[u].id),a[s].Event_asArray[u].Signal&&a[s].Event_asArray[u].Signal.Binary?d.messageData=m.decodeArray(a[s].Event_asArray[u].Signal.Binary.toString()):d.messageData=a[s].Event_asArray[u].messageData||a[s].Event_asArray[u].__text,o.push(d)}}return o},getEventStreamForAdaptationSet:function(e,t){var n=void 0,r=void 0,i=void 0;return e&&e.Period_asArray&&t&&t.period&&T(t.period.index)&&(r=e.Period_asArray[t.period.index])&&r.AdaptationSet_asArray&&T(t.index)&&(i=r.AdaptationSet_asArray[t.index])&&(n=i.InbandEventStream_asArray),F(n,null)},getEventStreamForRepresentation:function(e,t){var n=void 0,r=void 0,i=void 0,a=void 0;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&T(t.adaptation.period.index)&&(r=e.Period_asArray[t.adaptation.period.index])&&r.AdaptationSet_asArray&&T(t.adaptation.index)&&(i=r.AdaptationSet_asArray[t.adaptation.index])&&i.Representation_asArray&&T(t.index)&&(a=i.Representation_asArray[t.index])&&(n=a.InbandEventStream_asArray),F(n,t)},getUTCTimingSources:function(e){var t=D(e),n=!!e&&e.hasOwnProperty(i.default.AVAILABILITY_START_TIME),a=e?e.UTCTiming_asArray:null,o=[];return(t||n)&&a&&a.forEach((function(e){var t=new l.default;e.hasOwnProperty(r.default.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(i.default.VALUE)&&(t.value=e.value.toString(),o.push(t)))})),o},getBaseURLsFromElement:B,getRepresentationSortFunction:R,getLocation:function(e){if(e&&e.hasOwnProperty(r.default.LOCATION))return e.Location=e.Location_asArray[0],e.Location},getUseCalculatedLiveEdgeTimeForAdaptation:function(e){var t=L(e),n=t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray[0]:null,r=void 0;if(n){if(n.hasOwnProperty(i.default.SEGMENT_LIST))return!(r=n.SegmentList).hasOwnProperty(i.default.SEGMENT_TIMELINE)||N(r.SegmentTimeline);if(n.hasOwnProperty(i.default.SEGMENT_TEMPLATE)&&(r=n.SegmentTemplate).hasOwnProperty(i.default.SEGMENT_TIMELINE))return N(r.SegmentTimeline)}return!1},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(i.default.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(i.default.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(i.default.SERVICE_DESCRIPTION)){var n=!0,a=!1,o=void 0;try{for(var s,u=e.ServiceDescription_asArray[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var l=s.value,c=void 0,d=void 0,h=void 0,f=void 0;for(var p in l)l.hasOwnProperty(p)&&(p===i.default.ID?c=l[p]:p===i.default.SERVICE_DESCRIPTION_SCOPE?d=l[p].schemeIdUri:p===i.default.SERVICE_DESCRIPTION_LATENCY?h={target:l[p].target,max:l[p].max,min:l[p].min}:p===i.default.SERVICE_DESCRIPTION_PLAYBACK_RATE&&(f={max:l[p].max,min:l[p].min}));d===r.default.SERVICE_DESCRIPTION_LL_SCHEME&&(h||f)&&t.push({id:c,schemeIdUri:d,latency:h,playbackRate:f})}}catch(e){a=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw o}}}return t},getSupplementalPropperties:function(e){var t={};if(e&&e.hasOwnProperty(i.default.SUPPLEMENTAL_PROPERTY)){var n=!0,a=!1,o=void 0;try{for(var s,u=e.SupplementalProperty_asArray[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var l=s.value;l.hasOwnProperty(r.default.SCHEME_ID_URI)&&l.hasOwnProperty(i.default.VALUE)&&(t[l[r.default.SCHEME_ID_URI]]=l[i.default.VALUE])}}catch(e){a=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw o}}}return t},setConfig:function(e){e&&(e.errHandler&&(n=e.errHandler),e.BASE64&&(m=e.BASE64))}},t=(0,g.default)(b).getInstance().getLogger(e),e}E.__dashjs_factory_name="DashManifestModel",t.default=m.default.getSingletonFactory(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVersionString=function(){return"3.1.2"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=r,this.persistentState=i,this.sessionTypes=a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyID=t,this.key=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&"persistent"!==n&&"temporary"!==n)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=n}return r(e,[{key:"toJWK",value:function(){var e=void 0,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r)}this.type&&(n.type=this.type);var i=JSON.stringify(n),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initData=t,this.initDataType=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionToken=t,this.message=n,this.defaultURL=r,this.messageType=i||"license-request"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keySystem=t,this.ksConfiguration=n}},function(e,t){e.exports={toUnsigned:function(e){return e>>>0},toHexString:function(e){return("00"+e.toString(16)).slice(-2)}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(3)),o=r(n(1055)),s=r(n(156)),u=r(n(1061)),l=r(n(1062)),c=r(n(12)),d=r(n(14)),h=n(76);function f(){var e=this.context,t=void 0,n=void 0,r=void 0,a=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0;function x(e){var t=this,n=e.tracks,r=e.index;n.some((function(e,n){if(e.lang===E)return t.setTextTrack(n),r=n,!0})),S||this.setTextTrack(-1),T=r,b.trigger(d.default.TEXT_TRACKS_ADDED,{enabled:M(),index:r,tracks:n})}function M(){var e=!0;return w&&!A&&(e=!1),e}function C(){w=!1}return t={setConfig:function(e){e&&(e.errHandler&&(r=e.errHandler),e.dashManifestModel&&(a=e.dashManifestModel),e.manifestModel&&(f=e.manifestModel),e.mediaController&&(p=e.mediaController),e.videoModel&&(m=e.videoModel),e.streamController&&(g=e.streamController),e.textTracks&&(v=e.textTracks),e.vttParser&&(y=e.vttParser),e.ttmlParser&&(_=e.ttmlParser),n.setConfig({errHandler:r,dashManifestModel:a,manifestModel:f,mediaController:p,videoModel:m,streamController:g,textTracks:v,vttParser:y,ttmlParser:_}))},getTextSourceBuffer:function(){return n},getAllTracksAreDisabled:function(){return w},addEmbeddedTrack:function(e){n.addEmbeddedTrack(e)},getTextDefaultLanguage:function(){return E},setTextDefaultLanguage:function(e){(0,h.checkParameterType)(e,"string"),E=e},setTextDefaultEnabled:function(e){(0,h.checkParameterType)(e,"boolean"),(S=e)||this.setTextTrack(-1)},getTextDefaultEnabled:function(){return S},enableText:function(e){(0,h.checkParameterType)(e,"boolean"),M()!==e&&(e&&this.setTextTrack(T),e||(T=this.getCurrentTrackIdx(),this.setTextTrack(-1)))},isTextEnabled:M,setTextTrack:function(e){var t=n.getConfig(),r=t.fragmentModel,a=t.fragmentedTracks,o=t.videoModel,s=void 0,u=void 0;w=-1===e;var l=v.getCurrentTrackIdx();if(l!==e){v.setModeForTrackIdx(l,i.default.TEXT_HIDDEN),v.setCurrentTrackIdx(e),v.setModeForTrackIdx(e,i.default.TEXT_SHOWING);var c=v.getCurrentTrackInfo();if(c&&c.isFragmented&&!c.isEmbedded)for(var d=0;d<a.length;d++){var h=a[d];if(c.lang===h.lang&&c.index===h.index&&(h.id?c.id===h.id:c.id===h.index))if(h!==p.getCurrentTrackFor(i.default.FRAGMENTED_TEXT,g.getActiveStreamInfo()))r.abortRequests(),r.removeExecutedRequestsBeforeTime(),n.remove(),v.deleteCuesFromTrackIdx(l),p.setTrack(h),n.setCurrentFragmentedTrackIdx(d);else if(-1===l){for(var f=g.getActiveStreamProcessors(),m=0;m<f.length;m++)if(f[m].getType()===i.default.FRAGMENTED_TEXT){u=f[m];break}u.getIndexHandler().setCurrentTime(o.getTime()),u.getScheduleController().start()}}else if(c&&!c.isFragmented){for(f=g.getActiveStreamProcessors(),d=0;d<f.length;d++)if(f[d].getType()===i.default.TEXT){s=(u=f[d]).getMediaInfoArr();break}if(u&&s)for(d=0;d<s.length;d++)if(s[d].index===c.index&&s[d].lang===c.lang){u.selectMediaInfo(s[d]);break}}}},getCurrentTrackIdx:function(){return v.getCurrentTrackIdx()},enableForcedTextStreaming:function(e){(0,h.checkParameterType)(e,"boolean"),A=e},reset:function(){C(),n.resetEmbedded(),n.reset()}},E="",T=-1,S=!0,A=!1,v=(0,s.default)(e).getInstance(),y=(0,u.default)(e).getInstance(),_=(0,l.default)(e).getInstance(),n=(0,o.default)(e).getInstance(),b=(0,c.default)(e).getInstance(),v.initialize(),b.on(d.default.TEXT_TRACKS_QUEUE_INITIALIZED,x,t),C(),t}f.__dashjs_factory_name="TextController",t.default=a.default.getSingletonFactory(f),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(12)),o=r(n(14)),s=r(n(3)),u=r(n(13)),l=n(103);function c(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,r=void 0,s=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0;function w(e){var t=d[e].kind,n=void 0!==d[e].id?d[e].id:d[e].lang,r=d[e].lang,i=d[e].isTTML,a=d[e].isEmbedded,o=c.addTextTrack(t,n,r);return o.isEmbedded=a,o.isTTML=i,o}function A(e,t,n,r,i,a){var o=0,s=0;e/t>n/r?o=(s=t)/r*n:s=(o=e)/n*r;var u,l,c=0,d=0;return o/s>i?(d=s,c=s*i):(c=o,d=o/i),u=(e-c)/2,l=(t-d)/2,a?{x:u+.1*c,y:l+.1*d,w:.8*c,h:.8*d}:{x:u,y:l,w:c,h:d}}function x(e,n){var r=c.getClientWidth(),i=c.getClientHeight(),a=c.getVideoWidth(),s=c.getVideoHeight(),u=c.getVideoRelativeOffsetTop(),l=c.getVideoRelativeOffsetLeft(),d=a/s,h=!1;e.isFromCEA608&&(d=3.5/3,h=!0);var f=A.call(this,r,i,a,s,d,h),_=f.w,T=f.h,w=f.x,x=f.y;if(_!=g||T!=v||w!=p||x!=m||n){if(p=w+l,m=x+u,g=_,v=T,y){var M=y.style;M.left=p+"px",M.top=m+"px",M.width=g+"px",M.height=v+"px",M.zIndex=b&&document[b]||E?S:null,t.trigger(o.default.CAPTION_CONTAINER_RESIZE,{})}var C=e.activeCues;if(C)for(var R=C.length,I=0;I<R;++I){var O=C[I];O.scaleCue(O)}}}function M(e){var t=g,n=v,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;if(e.cellResolution){var u=[t/e.cellResolution[0],n/e.cellResolution[1]];if(e.linePadding)for(r in e.linePadding)if(e.linePadding.hasOwnProperty(r)){i=(e.linePadding[r]*u[0]).toString();for(var l=document.getElementsByClassName("spanPadding"),c=0;c<l.length;c++)l[c].style.cssText=l[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i),l[c].style.cssText=l[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}if(e.fontSize){for(r in e.fontSize)if(e.fontSize.hasOwnProperty(r)){"%"===e.fontSize[r][0]?a=e.fontSize[r][1]/100:"c"===e.fontSize[r][0]&&(a=e.fontSize[r][1]),i=(a*u[1]).toString(),s="defaultFontSize"!==r?document.getElementsByClassName(r):document.getElementsByClassName("paragraph");for(var d=0;d<s.length;d++)s[d].style.cssText=s[d].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}if(e.lineHeight)for(r in e.lineHeight)if(e.lineHeight.hasOwnProperty(r)){"%"===e.lineHeight[r][0]?o=e.lineHeight[r][1]/100:"c"===e.fontSize[r][0]&&(o=e.lineHeight[r][1]),i=(o*u[1]).toString(),s=document.getElementsByClassName(r);for(var h=0;h<s.length;h++)s[h].style.cssText=s[h].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+i)}}}if(e.isd){var f=document.getElementById(e.cueID);f&&y.removeChild(f),C(e)}}function C(e){if(y){var n=document.createElement("div");y.appendChild(n),T=(0,l.renderHTML)(e.isd,n,(function(t){var n=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,r=/^#(.*)$/;if(n.test(t)){var i=n.exec(t),a=parseInt(i[4],10)-1;return"data:image/png;base64,"+btoa(e.images[a])}if(r.test(t)){a=(i=r.exec(t))[1];return"data:image/png;base64,"+e.embeddedImages[a]}return null}),y.clientHeight,y.clientWidth,!1,(function(e){r.info("renderCaption :",e)}),T,!0),n.id=e.cueID,t.trigger(o.default.CAPTION_RENDERED,{captionDiv:n,currentTrackIdx:f})}}function R(e){return e>=0&&d[e]?c.getTextTrack(d[e].kind,d[e].id,d[e].lang,d[e].isTTML,d[e].isEmbedded):null}function I(e){if(e!==f){var t=R(f=e);O.call(this,t),_&&(clearInterval(_),_=null),t&&"html"===t.renderingType&&(x.call(this,t,!0),_=setInterval(x.bind(this,t),500))}}function O(e){N.call(this),e&&"html"===e.renderingType?P.call(this):L.call(this)}function D(e){if(e.cues)for(var t=e.cues,n=t.length-1;n>=0;n--)e.removeCue(t[n])}function P(){var e=document.getElementById("native-cue-style");if(!e){(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,n=c.getElement();try{n&&(n.id?t.insertRule("#"+n.id+"::cue {background: transparent}",0):0!==n.classList.length?t.insertRule("."+n.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(e){r.info(""+e.message)}}}function L(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function N(){if(y)for(;y.firstChild;)y.removeChild(y.firstChild)}return n={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(s=window.VTTCue||window.TextTrackCue,d=[],h=[],f=-1,p=0,m=0,g=0,v=0,y=null,_=null,E=!1,S=2147483647,T=null,void 0!==document.fullscreenElement?b="fullscreenElement":void 0!==document.webkitIsFullScreen?b="webkitIsFullScreen":document.msFullscreenElement?b="msFullscreenElement":document.mozFullScreen&&(b="mozFullScreen"))},displayCConTop:function(e){E=e,y&&!document[b]&&(y.style.zIndex=e?S:null)},addTextTrack:function(e,n){if(d.length!==n){if(d.push(e),d.length===n){d.sort((function(e,t){return e.index-t.index})),y=c.getTTMLRenderingDiv();for(var a=-1,s=0;s<d.length;s++){var u=w.call(this,s);h.push(u),d[s].defaultTrack&&(u.default=!0,a=s);var l=R(s);l&&(l.mode=i.default.TEXT_SHOWING,y&&(d[s].isTTML||d[s].isEmbedded)?l.renderingType="html":l.renderingType="default"),this.addCaptions(s,0,d[s].captionData),t.trigger(o.default.TEXT_TRACK_ADDED)}if(I.call(this,a),a>=0)for(var p=0;p<d.length;p++){var m=R(p);m&&(m.mode=p===a?i.default.TEXT_SHOWING:i.default.TEXT_HIDDEN)}t.trigger(o.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:f,tracks:d})}}else r.error("Trying to add too many tracks.")},addCaptions:function(e,n,a){var u=R(e),l=this;if(u&&a&&0!==a.length)for(var c=0;c<a.length;c++){var d=void 0,h=a[c];u.cellResolution=h.cellResolution,u.isFromCEA608=h.isFromCEA608,"html"===h.type&&y?((d=new s(h.start-n,h.end-n,"")).cueHTMLElement=h.cueHTMLElement,d.isd=h.isd,d.images=h.images,d.embeddedImages=h.embeddedImages,d.cueID=h.cueID,d.scaleCue=M.bind(l),d.cellResolution=h.cellResolution,d.lineHeight=h.lineHeight,d.linePadding=h.linePadding,d.fontSize=h.fontSize,y.style.left=p+"px",y.style.top=m+"px",y.style.width=g+"px",y.style.height=v+"px",d.onenter=function(){u.mode===i.default.TEXT_SHOWING&&(this.isd?(C(this),r.debug("Cue enter id:"+this.cueID)):(y.appendChild(this.cueHTMLElement),M.call(l,this),t.trigger(o.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:f})))},d.onexit=function(){if(y)for(var e=y.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(r.debug("Cue exit id:"+e[t].id),y.removeChild(e[t]))}):h.data&&(d=new s(h.start-n,h.end-n,h.data),h.styles&&(void 0!==h.styles.align&&"align"in d&&(d.align=h.styles.align),void 0!==h.styles.line&&"line"in d&&(d.line=h.styles.line),void 0!==h.styles.position&&"position"in d&&(d.position=h.styles.position),void 0!==h.styles.size&&"size"in d&&(d.size=h.styles.size)),d.onenter=function(){u.mode===i.default.TEXT_SHOWING&&t.trigger(o.default.CAPTION_RENDERED,{currentTrackIdx:f})});try{d?u.addCue(d):r.error("impossible to display subtitles.")}catch(e){throw D(u),u.addCue(d),e}}},getCurrentTrackIdx:function(){return f},setCurrentTrackIdx:I,getTrackIdxForId:function(e){for(var t=-1,n=0;n<d.length;n++)if(d[n].id===e){t=n;break}return t},getCurrentTrackInfo:function(){return d[f]},setModeForTrackIdx:function(e,t){var n=R(e);n&&n.mode!==t&&(n.mode=t)},deleteCuesFromTrackIdx:function(e){var t=R(e);t&&D(t)},deleteAllTextTracks:function(){for(var e=h?h.length:0,t=0;t<e;t++){var n=R(t);n&&(D.call(this,n),n.mode="disabled")}h=[],d=[],_&&(clearInterval(_),_=null),f=-1,N.call(this)},deleteTextTrack:function(e){c.removeChild(h[e]),h.splice(e,1)},setConfig:function(e){e&&e.videoModel&&(c=e.videoModel)}},r=(0,u.default)(e).getInstance().getLogger(n),n}c.__dashjs_factory_name="TextTracks",t.default=s.default.getSingletonFactory(c),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(14)),o=r(n(12)),s=r(n(3)),u=r(n(13)),l="neverReplace",c="alwaysReplace",d="highestBitrate",h="widestRange",f=d;function p(){var e=this.context,t=(0,o.default)(e).getInstance(),n=void 0,r=void 0,s=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=[c,l],_=[d,h];function b(e,t){if(!e||!t)return[];var n=t.id;return s[n]&&s[n][e]?s[n][e].list:[]}function E(e,t){return!e||!t||t&&!s[t.id]?null:s[t.id][e].current}function T(e){if(e&&e.streamInfo){var n=e.type,r=e.streamInfo,i=r.id,o=E(n,r);if(s[i]&&s[i][n]&&!M(e,o)){s[i][n].current=e,s[i][n].current&&t.trigger(a.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:o,newMediaInfo:e,switchMode:g[n]});var u=function(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}(e);u&&s[i][n].storeLastSettings&&(u.roles&&(u.role=u.roles[0],delete u.roles),u.accessibility&&(u.accessibility=u.accessibility[0]),u.audioChannelConfiguration&&(u.audioChannelConfiguration=u.audioChannelConfiguration[0]),v.setSavedMediaSettings(n,u))}}}function S(e,t){e&&t&&(p[e]=t)}function w(e){return e?p[e]:null}function A(){return m||f}function x(e){return e===i.default.AUDIO||e===i.default.VIDEO||e===i.default.TEXT||e===i.default.FRAGMENTED_TEXT||e===i.default.IMAGE}function M(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.roles.toString()===t.roles.toString(),o=e.accessibility.toString()===t.accessibility.toString(),s=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&a&&o&&s}function C(){s={},p={audio:null,video:null},g={audio:c,video:l}}function R(e,t){var n=!e.lang||e.lang===t.lang,r=!e.viewpoint||e.viewpoint===t.viewpoint,i=!e.role||!!t.roles.filter((function(t){return t===e.role}))[0],a=!e.accessibility||!!t.accessibility.filter((function(t){return t===e.accessibility}))[0],o=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter((function(t){return t===e.audioChannelConfiguration}))[0];return n&&r&&i&&a&&o}function I(e){var t=A(),n=[],i=function(e){var t=0,n=[],r=void 0;return e.forEach((function(e){(r=Math.max.apply(Math,e.bitrateList.map((function(e){return e.bandwidth}))))>t?(t=r,n=[e]):r===t&&n.push(e)})),n},a=function(e){var t=0,n=[],r=void 0;return e.forEach((function(e){(r=e.representationCount)>t?(t=r,n=[e]):r===t&&n.push(e)})),n};switch(t){case d:(n=i(e)).length>1&&(n=a(n));break;case h:(n=a(e)).length>1&&(n=i(e));break;default:r.warn("Track selection mode is not supported: "+t)}return n[0]}return n={checkInitialMediaSettingsForType:function(e,t){var n=w(e),r=b(e,t),a=[];e!==i.default.FRAGMENTED_TEXT?(n||S(e,n=v.getSavedMediaSettings(e)),r&&0!==r.length&&(n&&r.forEach((function(e){R(n,e)&&a.push(e)})),0===a.length?T(I(r)):a.length>1?T(I(a)):T(a[0]))):T(r[0])},addTrack:function(e){if(e){var t=e.type;if(x(t)){var n=e.streamInfo.id;s[n]||(s[n]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},fragmentedText:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var r=s[n][t].list,i=0,a=r.length;i<a;++i)if(M(r[i],e))return;r.push(e);var o=w(t);o&&R(o,e)&&!E(t,e.streamInfo)&&T(e)}}},getTracksFor:b,getCurrentTrackFor:E,isCurrentTrack:function(e){if(!e)return!1;var t=e.type,n=e.streamInfo.id;return s[n]&&s[n][t]&&M(s[n][t].current,e)},setTrack:T,setInitialSettings:S,getInitialSettings:w,setSwitchMode:function(e,t){-1!==y.indexOf(t)?g[e]=t:r.warn("Track switch mode is not supported: "+t)},getSwitchMode:function(e){return g[e]},setSelectionModeForInitialTrack:function(e){-1!==_.indexOf(e)?m=e:r.warn("Track selection mode is not supported: "+e)},getSelectionModeForInitialTrack:A,isMultiTrackSupportedByType:x,isTracksEqual:M,setConfig:function(e){e&&e.domStorage&&(v=e.domStorage)},reset:C},r=(0,u.default)(e).getInstance().getLogger(n),C(),n}p.__dashjs_factory_name="MediaController";var m=s.default.getSingletonFactory(p);m.TRACK_SWITCH_MODE_NEVER_REPLACE=l,m.TRACK_SWITCH_MODE_ALWAYS_REPLACE=c,m.TRACK_SELECTION_MODE_HIGHEST_BITRATE=d,m.TRACK_SELECTION_MODE_WIDEST_RANGE=h,m.DEFAULT_INIT_TRACK_SELECTION_MODE=f,s.default.updateSingletonFactory(p.__dashjs_factory_name,m),t.default=m,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e={};return{save:function(t){var n=t.streamId,r=t.representationId;e[n]=e[n]||{},e[n][r]=t},extract:function(t,n){return e&&e[t]&&e[t][n]?e[t][n]:null},reset:function(){e={}}}}o.__dashjs_factory_name="InitCache",t.default=a.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.availabilityIdx=NaN,this.wallStartTime=NaN,this.representation=null},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i,a=n(39),o=(i=a)&&i.__esModule?i:{default:i},s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return r(e,null,[{key:"hasInitialization",value:function(e){return null!==e.initialization||null!==e.range}},{key:"hasSegments",value:function(e){return e.segmentInfoType!==o.default.BASE_URL&&e.segmentInfoType!==o.default.SEGMENT_BASE&&!e.indexRange}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).requestModifier;return{load:function(e){var n=new Date,r=e.request,i=new XMLHttpRequest;i.open(e.method,e.url,!0),r.responseType&&(i.responseType=r.responseType),r.range&&i.setRequestHeader("Range","bytes="+r.range),r.requestStartDate||(r.requestStartDate=n),t&&(i=t.modifyRequestHeader(i)),i.withCredentials=e.withCredentials,i.onload=e.onload,i.onloadend=e.onend,i.onerror=e.onerror,i.onprogress=e.progress,i.onabort=e.onabort,i.send(),e.response=i},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort()}}}o.__dashjs_factory_name="XHRLoader";var s=a.default.getClassFactory(o);t.default=s,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=r,this.persistentState=i,this.sessionTypes=a},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyID=t,this.key=n},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&"persistent"!==n&&"temporary"!==n)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=n}return r(e,[{key:"toJWK",value:function(){var e=void 0,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r)}this.type&&(n.type=this.type);var i=JSON.stringify(n),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initData=t,this.initDataType=n},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionToken=t,this.message=n,this.defaultURL=r,this.messageType=i||"license-request"},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keySystem=t,this.ksConfiguration=n},e.exports=t.default},function(e,t,n){"use strict";n.r(t);var r=n(48),i=n(5),a=n(38),o=n.n(a),s=n(0),u=n.n(s),l=n(1),c=n.n(l);function d(e,t){var n=e.dash.mediaPlayer,r=n.getTracksFor("audio"),a=e.audioTracks();function s(e){return"dash-audio-"+e}function u(e,t){return e.find((function(e){return s(e.index)===t.id}))}a.length&&t.clearTracks(["audio"]);var l=n.getCurrentTrackFor("audio");r.forEach((function(t){var n,r;if(Array.isArray(t.labels))for(var o=0;o<t.labels.length;o++)if(t.labels[o].lang&&-1!==e.language().indexOf(t.labels[o].lang.toLowerCase())){n=t.labels[o];break}n?r=n.text:Array.isArray(t.labels)&&1===t.labels.length?r=t.labels[0].text:(r=t.lang,t.roles&&t.roles.length&&(r+=" ("+t.roles.join(", ")+")")),a.addTrack(new i.a.AudioTrack({enabled:t===l,id:s(t.index),kind:t.kind||"main",label:r,language:t.lang}))}));var c=function(){for(var e=0;e<a.length;e++){var t=a[e];if(t.enabled){var i=u(r,t);n.setCurrentTrack(i)}else;}};a.addEventListener("change",c),e.dash.mediaPlayer.on(o.a.MediaPlayer.events.STREAM_TEARDOWN_COMPLETE,(function(){a.removeEventListener("change",c)}))}function h(e,t){e.dash.mediaPlayer.on(o.a.MediaPlayer.events.PLAYBACK_METADATA_LOADED,d.bind(null,e,t))}function f(e,t,n){u.a.VTTCue&&!/\[native code\]/.test(u.a.VTTCue.toString())&&(u.a.VTTCue=!1);var r=[];if(t.featuresNativeTextTracks)i.a.log.error("You must pass {html: {nativeCaptions: false}} in the videojs constructor to use text tracks in videojs-contrib-dash");else{var a=e.dash.mediaPlayer;a.on(o.a.MediaPlayer.events.TEXT_TRACKS_ADDED,s),a.on(o.a.MediaPlayer.events.CAN_PLAY,(function(){a.off(o.a.MediaPlayer.events.TEXT_TRACKS_ADDED,s)}))}function s(t){t.index;var n=t.tracks;a.off(o.a.MediaPlayer.events.TEXT_TRACKS_ADDED,s),r.forEach(e.removeRemoteTextTrack.bind(e)),r=[],n.length&&(r=function(e,t,n){var r=[],i=n.map((function(t){var n;if(Array.isArray(t.labels))for(var r=0;r<t.labels.length;r++)if(t.labels[r].lang&&-1!==e.language().indexOf(t.labels[r].lang.toLowerCase())){n=t.labels[r];break}return{dashTrack:t,trackConfig:{label:n?n.text:Array.isArray(t.labels)&&1===t.labels.length?t.labels[0].text:t.lang||t.label,language:t.lang,srclang:t.lang,kind:t.kind}}})).map((function(t){var n=t.trackConfig,i=t.dashTrack,a=e.addRemoteTextTrack(n,!1);return r.push({textTrack:a.track,dashTrack:i}),a}));function a(){for(var t=e.dash.mediaPlayer,i=e.textTracks(),a=-1,o=function(e){var t=i[e];if("showing"===t.mode){var o=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}(r,(function(e){return e.textTrack===t})),s=o?o.dashTrack:null;s&&(a=n.indexOf(s))}},s=0;s<i.length;s+=1)o(s);a!==t.getCurrentTextTrackIndex()&&t.setTextTrack(a)}return e.textTracks().on("change",a),e.dash.mediaPlayer.on(o.a.MediaPlayer.events.STREAM_TEARDOWN_COMPLETE,(function(){e.textTracks().off("change",a)})),a(),i}(e,0,n))}}var p=function(){function e(t,n,r){var a=this;if(r=r||n.options_,this.player=Object(i.a)(r.playerId),this.player.dash=this.player.dash||{},this.tech_=n,this.el_=n.el(),this.elParent_=this.el_.parentNode,this.hasFiniteDuration_=!1,t.src){n.isReady_=!1,e.updateSourceData&&(i.a.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),t=e.updateSourceData(t)),e.hooks("updatesource").forEach((function(e){t=e(t)}));var s=t.src;this.keySystemOptions_=e.buildDashJSProtData(t.keySystemOptions),this.player.dash.mediaPlayer=o.a.MediaPlayer().create(),this.mediaPlayer_=this.player.dash.mediaPlayer,this.mediaPlayer_.setTextDefaultEnabled(!1),e.useVideoJSDebug&&(i.a.log.warn('useVideoJSDebug has been deprecated. Please switch to using hook("beforeinitialize", callback).'),e.useVideoJSDebug(this.mediaPlayer_)),e.beforeInitialize&&(i.a.log.warn('beforeInitialize has been deprecated. Please switch to using hook("beforeinitialize", callback).'),e.beforeInitialize(this.player,this.mediaPlayer_)),e.hooks("beforeinitialize").forEach((function(e){e(a.player,a.mediaPlayer_)})),this.mediaPlayer_.initialize(),this.retriggerError_=function(e){if("capability"===e.error&&"mediasource"===e.event)a.player.error({code:4,message:"The media cannot be played because it requires a feature that your browser does not support."});else if("manifestError"!==e.error||"createParser"!==e.event.id&&"codec"!==e.event.id&&"nostreams"!==e.event.id&&"nostreamscomposed"!==e.event.id&&"parse"!==e.event.id&&"multiplexedrep"!==e.event.id)if("mediasource"===e.error)e.event.match("MEDIA_ERR_ABORTED")?a.player.error({code:1,message:e.event}):e.event.match("MEDIA_ERR_NETWORK")?a.player.error({code:2,message:e.event}):e.event.match("MEDIA_ERR_DECODE")?a.player.error({code:3,message:e.event}):e.event.match("MEDIA_ERR_SRC_NOT_SUPPORTED")?a.player.error({code:4,message:e.event}):e.event.match("MEDIA_ERR_ENCRYPTED")?a.player.error({code:5,message:e.event}):(e.event.match("UNKNOWN"),a.player.error({code:4,message:e.event}));else if("capability"===e.error&&"encryptedmedia"===e.event)a.player.error({code:5,message:"The media cannot be played because it requires encryption features that your browser does not support."});else if("key_session"===e.error)a.player.error({code:5,message:e.event});else if("download"===e.error)a.player.error({code:2,message:"The media playback was aborted because too many consecutive download errors occurred."});else{if("mssError"!==e.error)return;a.player.error({code:3,message:e.event})}else a.player.error({code:4,message:e.event.message});setTimeout((function(){a.mediaPlayer_.reset()}),10)},this.mediaPlayer_.on(o.a.MediaPlayer.events.ERROR,this.retriggerError_),this.getDuration_=function(e){var t=e.data.Period_asArray,n=a.hasFiniteDuration_;e.data.mediaPresentationDuration||t[t.length-1].duration?a.hasFiniteDuration_=!0:a.hasFiniteDuration_=!1,a.hasFiniteDuration_!==n&&a.player.trigger("durationchange")},this.mediaPlayer_.on(o.a.MediaPlayer.events.MANIFEST_LOADED,this.getDuration_),r.dash&&Object.keys(r.dash).forEach((function(e){var t,n="set"+e.charAt(0).toUpperCase()+e.slice(1),o=r.dash[e];a.mediaPlayer_.hasOwnProperty(n)&&(i.a.log.warn("Using dash options in videojs-contrib-dash without the set prefix has been deprecated. Change '"+e+"' to '"+n+"'"),e=n),a.mediaPlayer_.hasOwnProperty(e)?(Array.isArray(o)||(o=[o]),(t=a.mediaPlayer_)[e].apply(t,o)):i.a.log.warn("Warning: dash configuration option unrecognized: "+e)})),this.mediaPlayer_.attachView(this.el_),this.mediaPlayer_.setAutoPlay(!1),h.call(null,this.player,n),f.call(null,this.player,n,r),this.mediaPlayer_.setProtectionData(this.keySystemOptions_),this.mediaPlayer_.attachSource(s),this.tech_.triggerReady()}}e.buildDashJSProtData=function(e){var t={};if(!e||!Array.isArray(e))return null;for(var n=0;n<e.length;n++){var r=e[n],a=i.a.mergeOptions({},r.options);a.licenseUrl&&(a.serverURL=a.licenseUrl,delete a.licenseUrl),t[r.name]=a}return t};var t=e.prototype;return t.dispose=function(){this.mediaPlayer_&&(this.mediaPlayer_.off(o.a.MediaPlayer.events.ERROR,this.retriggerError_),this.mediaPlayer_.off(o.a.MediaPlayer.events.MANIFEST_LOADED,this.getDuration_),this.mediaPlayer_.reset()),this.player.dash&&delete this.player.dash},t.duration=function(){return this.mediaPlayer_.isDynamic()&&!this.hasFiniteDuration_?1/0:this.mediaPlayer_.duration()},e.hooks=function(t,n){return e.hooks_[t]=e.hooks_[t]||[],n&&(e.hooks_[t]=e.hooks_[t].concat(n)),e.hooks_[t]},e.hook=function(t,n){e.hooks(t,n)},e.removeHook=function(t,n){var r=e.hooks(t).indexOf(n);return-1!==r&&(e.hooks_[t]=e.hooks_[t].slice(),e.hooks_[t].splice(r,1),!0)},e}();p.hooks_={};i.a.DashSourceHandler=function(){return{canHandleSource:function(e){return function(e){e=JSON.parse(JSON.stringify(e)),p.updateSourceData&&(i.a.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),e=p.updateSourceData(e)),p.hooks("updatesource").forEach((function(t){e=t(e)}));var t=c.a.createElement("video");return!(e.keySystemOptions&&!u.a.navigator.requestMediaKeySystemAccess&&!t.msSetMediaKeys)}(e)?i.a.DashSourceHandler.canPlayType(e.type)?"probably":/\.mpd/i.test(e.src)?"maybe":"":""},handleSource:function(e,t,n){return new p(e,t,n)},canPlayType:function(e){return i.a.DashSourceHandler.canPlayType(e)}}},i.a.DashSourceHandler.canPlayType=function(e){return/^application\/dash\+xml/i.test(e)?"probably":""},u.a.MediaSource&&i.a.getTech("Html5").registerSourceHandler(i.a.DashSourceHandler(),0),i.a.Html5DashJS=p;function m(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var v=i.a.getComponent("MenuItem"),y=i.a.getComponent("Component"),_=function(e){function t(t,n){return n.selectable=!0,n.multiSelectable=!1,e.call(this,t,n)||this}m(t,e);var n=t.prototype;return n.handleClick=function(){var t=this.options_;console.log("Changing quality to:",t.label),e.prototype.handleClick.call(this);for(var n=this.player().qualityLevels(),r=0;r<n.length;r++)t.index==n.length||t.index==r?n[r].enabled=!0:n[r].enabled=!1},n.update=function(){var e=this.player().qualityLevels().selectedIndex;this.selected(this.options_.index==e)},t}(v);y.registerComponent("SourceMenuItem",_);var b=i.a.getComponent("MenuButton"),E=function(e){function t(t,n){var r;r=e.call(this,t,n)||this,b.apply(g(r),arguments);var a=r.player().qualityLevels();if(n&&n.default)if("low"==n.default)for(var o=0;o<a.length;o++)a[o].enabled=0==o;else if(n.default="high")for(o=0;o<a.length;o++)a[o].enabled=o==a.length-1;return r.player().qualityLevels().on(["change","addqualitylevel"],i.a.bind(g(r),r.update)),r}m(t,e);var n=t.prototype;return n.createEl=function(){return i.a.dom.createEl("div",{className:"vjs-http-source-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})},n.buildCSSClass=function(){return b.prototype.buildCSSClass.call(this)+" vjs-icon-cog"},n.update=function(){return b.prototype.update.call(this)},n.createItems=function(){for(var e=[],t=this.player().qualityLevels(),n=[],r=0;r<t.length;r++){var i=t.length-(r+1),a=i===t.selectedIndex,o=""+i,s=i;t[i].height?(o=t[i].height+"p",s=parseInt(t[i].height,10)):t[i].bitrate&&(o=Math.floor(t[i].bitrate/1e3)+" kbps",s=parseInt(t[i].bitrate,10)),n.indexOf(o)>=0||(n.push(o),e.push(new _(this.player_,{label:o,index:i,selected:a,sortVal:s})))}return t.length>1&&e.push(new _(this.player_,{label:"Auto",index:t.length,selected:!1,sortVal:99999})),e.sort((function(e,t){return e.options_.sortVal<t.options_.sortVal?1:e.options_.sortVal>t.options_.sortVal?-1:0})),e},t}(b),T={},S=i.a.registerPlugin||i.a.plugin,w=function(e){var t=this;this.ready((function(){!function(e,t){if(e.addClass("vjs-http-source-selector"),console.log("videojs-http-source-selector initialized!"),console.log("player.techName_:"+e.techName_),"Html5"!=e.techName_)return!1;e.on(["loadedmetadata"],(function(t){if(e.qualityLevels(),i.a.log("loadmetadata event"),"undefined"==e.videojs_http_source_selector_initialized||1==e.videojs_http_source_selector_initialized)console.log("player.videojs_http_source_selector_initialized == true");else{console.log("player.videojs_http_source_selector_initialized == false"),e.videojs_http_source_selector_initialized=!0;var n=e.controlBar,r=n.getChild("fullscreenToggle").el();n.el().insertBefore(n.addChild("SourceMenuButton").el(),r)}}))}(t,i.a.mergeOptions(T,e))})),i.a.registerComponent("SourceMenuButton",E),i.a.registerComponent("SourceMenuItem",_)};S("httpSourceSelector",w),w.VERSION="1.1.6";function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var x=function e(t){var n=this;if(i.a.browser.IS_IE8)for(var r in n=c.a.createElement("custom"),e.prototype)"constructor"!==r&&(n[r]=e.prototype[r]);return n.id=t.id,n.label=n.id,n.width=t.width,n.height=t.height,n.bitrate=t.bandwidth,n.enabled_=t.enabled,Object.defineProperty(n,"enabled",{get:function(){return n.enabled_()},set:function(e){n.enabled_(e)}}),n},M=function(e){var t,n;function r(){var t,n=A(A(t=e.call(this)||this));if(i.a.browser.IS_IE8)for(var a in n=c.a.createElement("custom"),r.prototype)"constructor"!==a&&(n[a]=r.prototype[a]);return n.levels_=[],n.selectedIndex_=-1,Object.defineProperty(n,"selectedIndex",{get:function(){return n.selectedIndex_}}),Object.defineProperty(n,"length",{get:function(){return n.levels_.length}}),n||A(t)}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var a=r.prototype;return a.addQualityLevel=function(e){var t=this.getQualityLevelById(e.id);if(t)return t;var n=this.levels_.length;return t=new x(e),""+n in this||Object.defineProperty(this,n,{get:function(){return this.levels_[n]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t},a.removeQualityLevel=function(e){for(var t=null,n=0,r=this.length;n<r;n++)if(this[n]===e){t=this.levels_.splice(n,1)[0],this.selectedIndex_===n?this.selectedIndex_=-1:this.selectedIndex_>n&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t},a.getQualityLevelById=function(e){for(var t=0,n=this.length;t<n;t++){var r=this[t];if(r.id===e)return r}return null},a.dispose=function(){this.selectedIndex_=-1,this.levels_.length=0},r}(i.a.EventTarget);for(var C in M.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"},M.prototype.allowedEvents_)M.prototype["on"+C]=null;var R="2.0.9",I=i.a.registerPlugin||i.a.plugin,O=function(e){return t=this,i.a.mergeOptions({},e),n=t.qualityLevels,r=new M,t.on("dispose",(function e(){r.dispose(),t.qualityLevels=n,t.off("dispose",e)})),t.qualityLevels=function(){return r},t.qualityLevels.VERSION=R,r;var t,n,r};I("qualityLevels",O),O.VERSION=R;n(1188);var D=n(78);function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.order=n,this.nCh=(n+1)*(n+1),this.mtx=D.identity(this.nCh),this.bypassed=!1,this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh),this.gain=new Array(this.nCh);for(var r=0;r<this.nCh;r++){this.gain[r]=new Array(this.nCh);for(var i=0;i<this.nCh;i++)this.gain[r][i]=this.ctx.createGain(),this.gain[r][i].gain.value=this.mtx[r][i],this.in.connect(this.gain[r][i],i,0),this.gain[r][i].connect(this.out,0,r)}}var t,n,r;return t=e,(n=[{key:"updateMtx",value:function(e){if(!this.bypassed){this.mtx=e;for(var t=0;t<this.nCh;t++)for(var n=0;n<this.nCh;n++)this.gain[t][n].gain.value=this.mtx[t][n]}}},{key:"bypass",value:function(e){e?(this.updateMtx(D.identity(this.nCh)),this.bypassed=!0):this.bypassed=!1}},{key:"printGainMtx",value:function(){console.log(this)}}])&&P(t.prototype,n),r&&P(t,r),e}(),N=[[[.64625,24461e-9,-4089e-7,.20862,50219e-9,-52748e-8,-.1093,-78951e-8,.14164,21747e-8,-79888e-8,48411e-8,44694e-8,-.093541,-90626e-8,.049019,50964e-8,-48203e-8,92489e-8,43532e-8,.02554,37256e-8,-.037707,-83965e-8,-.025445],[24406e-9,.58558,-41143e-8,38856e-9,.14513,50484e-9,33858e-8,-5266e-7,25715e-8,.14072,-22435e-9,-.040347,57186e-8,54592e-8,1218e-7,52198e-8,.086187,-23946e-8,-.041983,36777e-9,-68321e-8,43714e-8,11039e-8,79005e-8,54782e-8],[-41095e-8,-41143e-8,.54842,-61474e-8,-5266e-7,42247e-8,26998e-9,.087242,-5966e-7,-28013e-8,73651e-8,-69342e-9,-.073972,-34061e-8,.064364,-48763e-8,97077e-9,79363e-8,-2939e-7,-12281e-8,43887e-8,-.084714,-68878e-8,.023305,-28636e-8],[.19849,38828e-9,-61123e-8,.80458,93387e-9,-5152e-7,-.16302,-.0011348,.22524,31308e-8,-79098e-8,53699e-8,6568e-7,-.14343,-.0012054,.09861,66164e-8,-50598e-8,.0010547,42777e-8,.044786,51993e-8,-.06468,-.0010368,-.005522],[5007e-8,.12861,-51876e-8,93477e-9,.74158,-2227e-8,47805e-8,-67306e-8,43128e-8,.25473,-19268e-8,-.072517,72336e-8,79392e-8,12221e-8,81618e-8,.16658,-50117e-8,-.078524,90285e-9,-97769e-8,55924e-8,2361e-7,94543e-8,83181e-8],[-53486e-8,51058e-9,42512e-8,-53024e-8,-18728e-9,.54246,17457e-8,62628e-8,10378e-8,-17933e-8,.084803,94887e-9,-38837e-8,-86558e-9,32679e-8,59316e-8,-31921e-8,.08438,95179e-9,-.043767,41066e-8,-17795e-8,49007e-9,94514e-10,59243e-8],[-.10942,34082e-8,22597e-9,-.155,48623e-8,16632e-8,.59766,30628e-9,-.11113,27213e-8,25502e-8,-26441e-8,-42634e-9,.10856,-11253e-9,-.040205,-16775e-8,15033e-8,-31258e-8,-15558e-8,-.054583,-43195e-9,.055009,-64321e-9,.020717],[-79322e-8,-51876e-8,.071127,-.0011409,-67306e-8,61665e-8,39219e-9,.65142,-.0010244,-37954e-8,.0011148,-84578e-9,-.13605,-64922e-8,.1291,-77723e-8,7844e-8,.0012888,-37488e-8,-17509e-8,86799e-8,-.15496,-.001181,.059043,-42839e-8],[.14124,25889e-8,-592e-6,.2102,43602e-8,11808e-8,-.11045,-.0010182,.69736,45932e-8,1479e-7,38072e-10,60212e-8,-.11147,-91345e-8,.15847,35583e-8,-22808e-10,21347e-8,-10435e-8,.03617,41567e-8,-.064123,-64686e-8,.092688],[22089e-8,.14043,-26296e-8,31846e-8,.23004,-18435e-8,25461e-8,-36269e-8,45478e-8,.77017,-44779e-8,-.072371,36414e-8,5903e-7,-19878e-9,59567e-8,.22612,-7213e-7,-.08933,12329e-8,-74496e-8,28962e-8,38758e-8,3379e-7,5309e-7],[-79789e-8,-26105e-9,73409e-8,-8018e-7,-19331e-8,.063567,26358e-8,.0011215,12331e-8,-44427e-8,.65129,89263e-9,-6662e-7,-13017e-8,70771e-8,83994e-8,-62751e-8,.17635,-27017e-9,-.087071,60488e-8,-31948e-8,36444e-9,23471e-8,84011e-8],[49378e-8,-.040321,-75659e-9,55307e-8,-.066254,96763e-9,-26913e-8,-93945e-9,19178e-9,-.072552,94236e-9,.53533,87417e-9,-63206e-9,13943e-9,-48195e-8,-.047059,-78326e-9,.062868,-70113e-9,-84252e-9,49647e-9,16646e-8,10368e-8,-58817e-8],[4444e-7,5667e-7,-.074704,65323e-8,7277e-7,-37858e-8,-47253e-9,-.12171,59911e-8,38479e-8,-656e-6,77767e-9,.61874,33408e-8,-.10117,45402e-8,-14948e-8,-74103e-8,3734e-7,16911e-9,-44109e-8,.15258,70315e-8,-.038455,24201e-8],[-.09601,54403e-8,-34849e-8,-.14309,79927e-8,-918e-7,.086601,-66395e-8,-.10716,61085e-8,-14028e-8,-61614e-9,3471e-7,.62695,-77092e-8,-.051024,16023e-8,-10633e-8,1919e-7,48363e-9,-.096681,2607e-7,.09402,-74571e-8,.0019158],[-90935e-8,14083e-8,.064898,-.0012115,14918e-8,31277e-8,-9.9481e-7,.10959,-91848e-8,-17227e-10,68618e-8,1483e-8,-.10023,-75551e-8,.62343,-57355e-8,-20829e-8,.0010125,50756e-9,-15674e-8,.0010724,-.13186,-.001046,.11144,-26243e-8],[.051801,52227e-8,-47921e-8,.097067,82131e-8,59196e-8,-.04061,-76706e-8,.13419,60936e-8,853e-6,-4871e-7,45284e-8,-.049994,-56946e-8,.69569,13044e-9,37685e-8,-54845e-8,-51755e-8,.014479,25727e-8,-.055169,-29779e-8,.2151],[51658e-8,.088775,11285e-8,67289e-8,.16423,-32031e-8,-18918e-8,1013e-7,35665e-8,.19258,-62824e-8,-.047327,-17334e-8,12974e-8,-20709e-8,-24617e-10,.71786,-81442e-8,-.062173,11207e-8,-24106e-8,-12571e-8,51769e-8,-52429e-8,-18112e-8],[-45845e-8,-24851e-8,78155e-8,-48969e-8,-51038e-8,.084815,14762e-8,.0012812,-22354e-9,-72528e-8,.1468,-84189e-9,-74318e-8,-96694e-9,.0010287,34062e-8,-81659e-8,.69566,-45531e-8,-.089395,3471e-7,-43499e-8,-84247e-9,63284e-8,33745e-8],[93369e-8,-.043038,-29946e-8,.0010751,-.077832,91543e-9,-3188e-7,-38777e-8,2427e-7,-.083693,-27488e-9,.037125,38519e-8,18917e-8,38876e-9,-52703e-8,-.062622,-44958e-8,.59638,-63301e-9,-5158e-7,26879e-8,44977e-8,44357e-8,-73249e-8],[43394e-8,39403e-9,-11519e-8,43287e-8,92062e-9,-.044092,-16019e-8,-16586e-8,-90741e-9,12205e-8,-.076371,-68027e-9,11431e-9,42146e-9,-15562e-8,-50978e-8,10852e-8,-.090178,-63215e-9,.55076,-30071e-8,-10061e-8,-44091e-9,-18634e-8,-52989e-8],[.024287,-68098e-8,44025e-8,.046456,-98422e-8,41334e-8,-.055264,87045e-8,.035731,-76679e-8,61854e-8,-78956e-9,-44819e-8,-.076,.0010755,.015605,-26965e-8,37256e-8,-50905e-8,-30948e-8,.5861,-35748e-8,-.068219,.0010858,-.0080666],[36278e-8,4236e-7,-.088187,50613e-8,55013e-8,-16319e-8,-46573e-9,-.1555,40323e-8,29887e-8,-29669e-8,41029e-9,.12447,24422e-8,-.12393,2491e-7,-10458e-8,-41303e-8,25301e-8,-98766e-9,-34343e-8,.68038,48316e-8,-.062931,9542e-8],[-.036394,97977e-9,-6982e-7,-.067832,21983e-8,59647e-9,.055717,-.0011988,-.063915,37975e-8,53604e-9,16491e-8,72268e-8,.070836,-.0010605,-.050376,52623e-8,-72473e-9,44212e-8,-53054e-9,-.067734,50953e-8,.57914,-7305e-7,-.034854],[-83493e-8,79998e-8,.026126,-.0010351,97432e-8,16225e-10,-53865e-9,.058505,-6492e-7,37984e-8,21376e-8,92154e-9,-.038997,-72785e-8,.082227,-29911e-8,-49514e-8,60306e-8,43943e-8,-18093e-8,.0010741,-.061081,-72224e-8,.64196,-93765e-9],[-.026973,53825e-8,-27366e-8,-.0017445,82228e-8,56764e-8,.021988,-41243e-8,.09185,53812e-8,81817e-8,-57411e-8,23488e-8,.0017919,-25756e-8,.18228,-15563e-8,35494e-8,-72595e-8,-51764e-8,-.0087198,97547e-9,-.034296,-95702e-9,.76345]],[[.587,10936e-9,21995e-8,.22357,-12525e-8,52665e-8,-.12183,24653e-8,.16726,-42001e-8,87024e-8,-17717e-9,-27965e-8,-.1162,-20894e-8,.079485,-72313e-8,63269e-8,-11138e-8,-55681e-8,.043034,-16766e-8,-.058607,-75764e-8,-.0027889],[13453e-9,.5122,41908e-8,-9663e-8,.14497,46143e-8,-18693e-9,58522e-8,-35626e-8,.14812,76269e-8,-.041486,-66906e-8,-40991e-9,-47655e-9,-52001e-8,.10853,60956e-8,-.049085,-3212e-7,-53337e-9,-62472e-8,-27486e-8,-85503e-8,-43094e-8],[22731e-8,41908e-8,.47752,19813e-8,58522e-8,-42166e-10,-50531e-9,.087118,-1388e-7,3751e-7,-16618e-8,-35399e-9,-.070649,6476e-8,.066165,-44804e-8,-54522e-9,-59191e-8,13014e-8,-94357e-9,-21832e-8,-.08609,-98574e-9,.031453,-5487e-7],[.19052,-10907e-8,17584e-8,.76943,-33859e-8,54445e-8,-.19196,15457e-8,.27705,-67656e-8,8991e-7,-41963e-9,-22123e-8,-.17887,-32998e-8,.14113,-97169e-8,65186e-8,-24377e-8,-58218e-8,.069117,-10029e-8,-.09471,-89466e-8,.022901],[-14079e-8,.091335,55927e-8,-34253e-8,.6736,61634e-8,23739e-9,78045e-8,-61504e-8,.29159,.0010097,-.081031,-89889e-8,-98872e-9,-68201e-9,-74007e-8,.21073,78527e-8,-.093753,-42078e-8,41262e-9,-84257e-8,-47826e-8,-.0011437,-5475e-7],[55581e-8,47424e-8,-21353e-10,60115e-8,66261e-8,.46752,-2822e-7,-14037e-8,-41528e-9,46736e-8,.084676,14672e-8,-86235e-9,-57514e-9,-58129e-8,-65502e-8,45509e-9,.079704,50601e-8,-.038675,-25213e-8,-49656e-9,-1754e-8,-.0010075,-83182e-8],[-.12272,-14076e-9,-35527e-9,-.16574,18466e-9,-24961e-8,.54282,-35473e-9,-.13781,81276e-9,-41996e-8,-75118e-9,41261e-9,.13968,46084e-9,-.069897,12341e-8,-3151e-7,-14685e-8,28454e-8,-.063923,1529e-8,.070979,13473e-8,.0015837],[23571e-8,55927e-8,.034616,1624e-7,78045e-8,-15434e-8,-49681e-9,.57853,-28336e-8,49872e-8,-53035e-8,-54614e-9,-.14532,58476e-9,.14795,-68265e-8,-72608e-9,-.0012119,16021e-8,-3101e-8,-2336e-7,-.16497,-20779e-8,.074562,-79425e-8],[.16674,-37376e-8,-16977e-8,.22789,-63911e-8,-97983e-9,-.13551,-32386e-8,.66329,-73505e-8,-16578e-8,-11944e-8,21977e-8,-.15126,-35402e-8,.20173,-68928e-8,-12466e-8,-49324e-8,98012e-9,.057386,22846e-8,-.091151,-33529e-8,.10988],[-46008e-8,.14922,3115e-7,-7135e-7,.2117,38666e-8,10637e-8,43339e-8,-72197e-8,.73371,6142e-7,-.081181,-50759e-8,-20602e-8,-4241e-8,-60208e-8,.30099,42817e-8,-.11561,-25057e-8,35043e-8,-47818e-8,-56969e-8,-62459e-8,-32467e-8],[87755e-8,74968e-8,-18303e-8,94845e-8,.0010383,.015795,-4539e-7,-53665e-8,-70515e-9,71283e-8,.56617,24289e-8,83571e-9,-10334e-8,-.0011916,-.001037,28558e-9,.19361,81459e-8,-.088821,-38316e-8,12401e-8,-2744e-8,-.0017587,-.0012989],[-12527e-9,-.041911,-15593e-9,-40766e-9,-.060723,17501e-8,-79366e-9,-28841e-9,-13596e-8,-.081693,29976e-8,.4658,45291e-9,-1566e-7,-58756e-10,-23345e-8,-.064719,25926e-8,.078461,-1366e-7,20827e-8,61588e-9,-11007e-8,41947e-9,-24589e-8],[-27333e-8,-65289e-8,-.074051,-23434e-8,-91748e-8,-8159e-8,56771e-9,-.098597,1763e-7,-59474e-8,52732e-9,75544e-9,.55085,-85288e-9,-.1093,54703e-8,78646e-9,59813e-8,-16846e-8,21206e-8,27729e-8,.18439,12369e-8,-.058698,65847e-8],[-.12401,-42674e-9,75271e-9,-.17794,-10753e-8,-27989e-9,.068014,76141e-9,-.13726,-22709e-8,-5717e-8,-15054e-8,-10325e-8,.57506,-11153e-8,-.079334,-37814e-8,-55202e-9,-36816e-8,58381e-9,-.11968,-6759e-8,.12818,-34618e-8,-.017439],[-26384e-8,-11929e-8,.069338,-38999e-8,-17077e-8,-60613e-8,64088e-9,.084731,-36054e-8,-11379e-8,-.0012344,25475e-10,-.10651,-11662e-8,.55842,-30142e-8,2581e-8,-.0016245,-51097e-9,42263e-8,24084e-8,-.15779,-28213e-8,.13738,-21951e-8],[.08773,-51248e-8,-46167e-8,.13578,-74876e-8,-66335e-8,-.070682,-7181e-7,.12241,-6334e-7,-.0010966,-19813e-8,58602e-8,-.075445,-34127e-8,.63319,-34374e-8,-78187e-8,-6792e-7,70974e-8,.029344,48856e-8,-.079183,19165e-8,.24662],[-75913e-8,.1168,-12719e-8,-.0010153,.20442,-37202e-9,16034e-8,-17643e-8,-69473e-8,.19208,-10178e-8,-.065659,19822e-8,-34109e-8,27693e-9,-31539e-8,.68451,-18867e-8,-.085002,43521e-9,73445e-8,18409e-8,-55823e-8,32967e-8,-19921e-9],[55398e-8,53374e-8,-64303e-8,59676e-8,71701e-8,.083751,-29748e-8,-.0012756,-50365e-9,44194e-8,.098569,19308e-8,70265e-8,-80763e-9,-.0015965,-64309e-8,-94928e-9,.62729,60047e-8,-.088009,-21995e-8,6881e-7,-90439e-10,-.001667,-75426e-8],[-12064e-8,-.052475,15649e-8,-25972e-8,-.091997,52931e-8,-14448e-8,20598e-8,-52079e-8,-.097269,88753e-8,-.0051841,-21779e-8,-37285e-8,-32722e-9,-73475e-8,-.086445,72645e-8,.52063,-39696e-8,48166e-8,-1717e-7,-41294e-8,-29842e-8,-67731e-8],[-56349e-8,-29988e-8,-98596e-9,-61614e-8,-41066e-8,-.040634,30788e-8,-57013e-9,35928e-9,-27584e-8,-.054116,-10789e-8,21971e-8,90579e-9,36152e-8,67102e-8,-74605e-10,-.090099,-35018e-8,.47806,22216e-8,19329e-8,17083e-9,82013e-8,87003e-8],[.038195,-62543e-9,-22772e-8,.074183,17895e-9,-27043e-8,-.067145,-26393e-8,.055714,31949e-8,-43415e-8,20617e-8,30397e-8,-.052367,19648e-8,.033209,72351e-8,-29696e-8,46785e-8,25631e-8,.5135,20764e-8,-.072454,76991e-8,2467e-7],[-13864e-8,-5743e-7,-.097476,-86233e-9,-8102e-7,-39066e-9,20131e-9,-.16797,18998e-8,-52754e-8,98761e-9,85299e-9,.093169,-49658e-9,-.13214,42683e-8,67516e-9,56963e-8,-11564e-8,17115e-8,16617e-8,.62967,13685e-8,-.085793,47754e-8],[-.05284,-31082e-8,-1308e-7,-.10398,-53831e-8,-38177e-9,.074059,-25608e-8,-.090313,-62992e-8,-61739e-9,-92038e-9,1683e-7,.052794,-29875e-8,-.064083,-60017e-8,-36338e-9,-39615e-8,35458e-9,-.071162,17938e-8,.51628,-30385e-8,-.045999],[-81926e-8,-91472e-8,.04043,-98663e-8,-.0012783,-996e-6,18071e-8,.073818,-39491e-8,-80468e-8,-.0017808,89624e-9,-.0605,-32221e-8,.042798,19881e-8,18949e-8,-.0017505,-25602e-8,86978e-8,78885e-8,-.079564,-32601e-8,.56016,49632e-8],[-.010655,-37483e-8,-5194e-7,.03283,-49429e-8,-75177e-8,.007781,-77663e-8,.10793,-32154e-8,-.0012254,-20055e-8,64903e-8,-.016619,-27053e-8,.14045,-52848e-9,-82206e-8,-58626e-8,82325e-8,-.0024109,51115e-8,-.043315,41371e-8,.69773]],[[.53332,-86478e-8,27166e-8,.23291,-.0014148,-14464e-8,-.13098,40892e-8,.18602,-.0013398,-26134e-8,26761e-8,-30622e-8,-.1348,16256e-8,.10507,-7004e-7,-2715e-7,8021e-8,96284e-9,.058845,-19821e-8,-.078358,-19865e-8,.021045],[-90985e-8,.44769,-11815e-8,-.0011527,.14455,27429e-8,60892e-8,-18031e-8,-3661e-7,.15062,48797e-8,-.041865,14747e-8,35878e-8,-74965e-9,60646e-8,.12104,50935e-8,-.053368,-96561e-9,41347e-10,1167e-7,-89577e-9,70802e-9,.0012522],[28759e-8,-11815e-8,.41457,3356e-7,-18031e-8,-47149e-8,-28169e-9,.086711,11326e-8,-16492e-8,-91004e-8,-40426e-9,-.066605,1799e-7,.065367,-12066e-8,-99163e-9,-.0010352,-14725e-8,43378e-8,-39039e-8,-.083296,1111e-7,.034984,-26994e-8],[.17421,-.0010423,29403e-8,.73101,-.0017132,-15908e-8,-.2161,43704e-8,.32079,-.0016401,-29144e-8,32487e-8,-31571e-8,-.20973,16503e-8,.18008,-88877e-8,-31458e-8,98381e-9,10185e-8,.091587,-17934e-8,-.1232,-22674e-8,.054197],[-.0014152,.049946,-16761e-8,-.0018015,.60492,3823e-7,94954e-8,-25934e-8,-59625e-8,.3182,67573e-8,-.087543,2054e-7,56198e-8,-12312e-8,90336e-8,.24329,70609e-8,-.10563,-10217e-8,-34285e-10,1616e-7,-15295e-8,68444e-9,.0019108],[-16086e-8,29014e-8,-49595e-8,-19003e-8,43639e-8,.40162,32538e-9,-8087e-7,-6638e-8,40177e-8,.087628,19764e-8,73131e-8,-68853e-9,-416e-6,56337e-9,25116e-8,.074795,5755e-7,-.035127,17509e-8,74014e-8,-50437e-9,24938e-8,1179e-7],[-.13364,53735e-8,61261e-10,-.16983,88139e-8,14409e-9,.49172,25862e-9,-.15788,796e-6,22049e-9,-32706e-8,-89418e-9,.17035,55162e-10,-.097012,30599e-8,22108e-9,-39624e-8,1177e-8,-.07533,-1754e-7,.088908,-63338e-9,-.020377],[40229e-8,-16761e-8,-.0060338,46373e-8,-25934e-8,-73061e-8,-20827e-9,.50675,14908e-8,-24644e-8,-.0014207,-6202e-8,-.15157,28546e-8,.1619,-17743e-8,-16457e-8,-.0016442,-22065e-8,66734e-8,-58746e-8,-.16949,16686e-8,.086096,-38442e-8],[.18672,-20498e-8,57035e-9,.23363,-35963e-8,-3498e-8,-.15352,76583e-9,.62827,-41958e-8,-78058e-9,-25584e-9,-61877e-9,-.18721,-45833e-10,.24698,-38487e-8,-11782e-8,-18337e-8,2439e-8,.079212,-27086e-9,-.11941,-12286e-8,.13485],[-.0012036,.15644,-13455e-8,-.0015501,.1786,30698e-8,76583e-8,-21707e-8,-59149e-8,.68216,54237e-8,-.084436,16329e-8,40189e-8,-13412e-8,61452e-8,.36417,5664e-7,-.1366,-78115e-9,91856e-9,13422e-8,-19129e-8,-6161e-9,.001454],[-26978e-8,47869e-8,-90884e-8,-3231e-7,71541e-8,-.033353,49152e-9,-.001493,-12892e-8,65943e-8,.48346,36997e-8,.0013348,-12564e-8,-80979e-8,6484e-8,42316e-8,.20587,.0010421,-.090794,30344e-8,.0013566,-98268e-9,36915e-8,16723e-8],[22108e-8,-.043628,-572e-7,28283e-8,-.052084,23844e-8,-31699e-8,-91147e-9,-23164e-10,-.085377,46214e-8,.40214,93055e-9,-39136e-8,-33124e-9,-38245e-8,-.077651,48058e-8,.095957,-33935e-8,41676e-8,9877e-8,-90395e-9,59714e-9,-6221e-7],[-28637e-8,13378e-8,-.074912,-31889e-8,201e-6,65439e-8,-58413e-9,-.069798,-11168e-8,18324e-8,.0012592,67431e-9,.48303,-33506e-8,-.10772,78951e-9,11568e-8,.0014198,21008e-8,-60998e-8,60184e-8,.21086,-15305e-8,-.071426,19194e-8],[-.14805,25645e-8,21451e-8,-.20869,4223e-7,-81669e-9,.044261,35151e-8,-.1633,33068e-8,-15524e-8,-35567e-8,-3827e-7,.52375,13231e-8,-.10609,-21583e-9,-1659e-7,-61963e-8,88258e-9,-.14476,-44808e-8,.16406,-25556e-8,-.040697],[93291e-9,-43083e-9,.074033,97733e-9,-81333e-9,-2876e-7,-61962e-10,.051506,-28197e-10,-10843e-8,-59761e-8,-13327e-9,-.103,64884e-9,.49105,-1126e-7,-11984e-8,-79528e-8,-59505e-9,24068e-8,-11644e-8,-.17428,45472e-9,.16356,-18319e-8],[.11808,73649e-8,-16218e-8,.17022,.0011718,69683e-9,-.097733,-25267e-8,.10725,97467e-8,10306e-8,-44825e-8,1442e-7,-.098128,-16722e-8,.57495,20865e-8,56758e-9,-55838e-8,-30894e-9,.045411,56194e-9,-.10397,-57899e-9,.28097],[-43129e-8,.13428,-62207e-9,-5877e-7,.23464,14304e-8,15382e-8,-11574e-8,-39076e-8,.17521,26077e-8,-.079679,80071e-9,-75027e-9,-11694e-8,-12457e-8,.64054,26654e-8,-.10168,-98848e-9,31663e-8,83163e-9,-21019e-8,-90779e-9,12033e-8],[-24497e-8,43596e-8,-94313e-8,-30588e-8,65136e-8,.08692,42003e-9,-.0015776,-15911e-8,60025e-8,.041647,34299e-8,.0013693,-12071e-8,-96417e-8,-54095e-10,38228e-8,.54472,95989e-8,-.079407,2771e-7,.0014047,-11755e-8,15227e-8,92483e-9],[-38413e-9,-.058893,-16951e-8,-47598e-9,-.10358,61439e-8,-32203e-8,-26882e-8,-21846e-8,-.10533,.0011687,-.050337,25149e-8,-61088e-8,-11326e-8,-4818e-7,-.10448,.0012144,.44441,-72985e-8,85798e-8,2478e-7,-24241e-8,12905e-8,-62427e-8],[8632e-8,-54223e-9,40836e-8,98225e-9,-5074e-8,-.04042,62587e-10,66197e-8,38134e-9,-48001e-9,-.030707,-30475e-8,-6105e-7,77506e-9,32101e-8,-12032e-9,-10096e-8,-.082863,-67652e-8,.4097,-14358e-8,-621e-6,38371e-9,-24809e-8,-30663e-9],[.04866,70266e-9,-41611e-8,.099601,10626e-8,17813e-8,-.083395,-66127e-8,.075838,18568e-8,32842e-8,36065e-8,66412e-8,-.027901,-23518e-8,.05308,34727e-8,33957e-8,8165e-7,-1603e-7,.44254,7028e-7,-.071921,47772e-8,.012711],[-12703e-8,85424e-9,-.10275,-11532e-8,12754e-8,5968e-7,-15922e-8,-.17746,-38296e-9,1223e-7,.0011538,69515e-9,.052386,-38879e-8,-.1311,-10053e-9,94817e-9,.0013138,1888e-7,-55874e-8,59095e-8,.56611,-13321e-8,-.098787,-81604e-10],[-.065256,-13081e-8,73937e-9,-.13753,-22989e-8,-30907e-9,.09636,11609e-8,-.11766,-27166e-8,-67881e-9,-25943e-9,-97473e-9,.033249,51346e-9,-.078993,-25628e-8,-99628e-9,-13762e-8,22714e-9,-.069944,-83109e-9,.45469,-53426e-9,-.058191],[-29594e-8,99494e-9,.049968,-35676e-8,12462e-8,36576e-8,-33474e-9,.086916,-19831e-8,61055e-9,63375e-8,57795e-9,-.075546,-295e-6,-58358e-8,-58434e-9,-41169e-9,52313e-8,15845e-8,-37978e-8,58641e-8,-.08738,-13265e-8,.47959,27647e-9],[.0020659,.0012258,-26624e-8,.067349,.00198,9976e-8,-.0057097,-40732e-8,.13285,.0017418,16042e-8,-65422e-8,23053e-8,-.037488,-24598e-8,.096915,59714e-8,12964e-8,-71902e-8,-38515e-9,.0068276,73255e-9,-.051904,-34608e-9,.62072]],[[.48444,15705e-8,58138e-8,.23811,25076e-8,-78536e-9,-.13719,.001163,.20144,19008e-8,-14565e-8,-1639e-7,-76151e-8,-.15006,.0014598,.13013,-18133e-9,-16595e-8,-26e-5,50548e-9,.073115,-89218e-8,-.097071,.0016982,.048857],[17215e-8,.38846,-65903e-9,21316e-8,.13935,-13323e-8,-20532e-8,-10281e-8,-23094e-10,.14819,-22673e-8,-.040915,80807e-9,-22636e-8,-54913e-9,-27833e-8,.12757,-92678e-9,-.055125,3184e-7,15229e-8,6414e-8,-96775e-9,1837e-9,-45754e-8],[61109e-8,-65903e-9,.35838,94798e-8,-10281e-8,-14845e-9,-15306e-8,.08465,.0010105,-10222e-8,-34107e-9,-24325e-9,-.0619,2259e-7,.064114,.0010426,-83146e-9,-89249e-9,-87359e-9,-79612e-9,-63941e-8,-.077718,47262e-8,.037663,96853e-8],[.15672,17553e-8,89285e-8,.69162,27738e-8,-83992e-9,-.23513,.001773,.35838,20084e-8,-16309e-8,-18922e-8,-.0012033,-.23771,.0021601,.22071,-45266e-9,-20707e-8,-30368e-8,51592e-9,.11269,-.0014222,-.15119,.0024199,.092031],[24882e-8,.0094769,-90311e-9,30505e-8,.53203,-16443e-8,-30259e-8,-1474e-7,-17625e-9,.33037,-25437e-8,-.090134,10815e-8,-33687e-8,-10491e-8,-42944e-8,.26907,10882e-9,-.11424,4593e-7,22694e-8,89423e-9,-15092e-8,-59171e-9,-69527e-8],[-92222e-9,-14872e-8,-15659e-9,-11091e-8,-2157e-7,.3417,16689e-9,-30375e-9,-48598e-9,-84998e-9,.087448,22263e-8,-67316e-9,-4351e-8,-10367e-8,41892e-10,24221e-8,.069441,41653e-8,-.031127,10555e-8,-14221e-8,-35079e-9,-22712e-8,13486e-9],[-.14266,-18914e-8,-8919e-8,-.17176,-30667e-8,13866e-10,.4438,-21036e-8,-.17376,-27394e-8,15337e-10,86478e-9,3286e-8,.1967,-42605e-8,-.12354,-10311e-8,74302e-10,70957e-9,14004e-9,-.089046,69609e-10,.10947,-72788e-8,-.046798],[.0012135,-90311e-9,-.042955,.0018682,-1474e-7,-28181e-9,-34599e-8,.43639,.0019308,-16348e-8,-65168e-9,-36498e-9,-.15255,37109e-8,.17014,.0019167,-16223e-8,-15886e-8,-12883e-8,-11878e-8,-.0011711,-.17104,8794e-7,.098231,.0017221],[.20541,-62541e-9,95077e-8,.23881,-11243e-8,-22095e-9,-.16761,.0018385,.59489,-1414e-7,-6632e-8,-1976e-8,-.001411,-.2195,.0019884,.28939,-15078e-8,-14134e-8,-81978e-9,18392e-9,.10153,-.0017145,-.14964,.0018591,.16726],[12932e-8,.16276,-74602e-9,14876e-8,.14306,15032e-9,-20484e-8,-13808e-8,-71847e-9,.61862,12821e-8,-.082671,90833e-9,-25889e-8,-15266e-8,-35192e-8,.41002,51557e-8,-.15037,2309e-7,20645e-8,92048e-9,-14105e-8,-17511e-8,-52657e-8],[-14842e-8,-22003e-8,-35125e-9,-18659e-8,-29277e-8,-.077332,22808e-9,-68584e-9,-10973e-8,-11312e-9,.39913,4181e-7,-11415e-8,-77315e-9,-20593e-8,-51534e-9,61841e-8,.20652,82151e-8,-.087635,17692e-8,-24959e-8,-72164e-9,-43527e-8,-52264e-9],[-18098e-8,-.045053,-39744e-9,-22934e-8,-.042624,21136e-8,95729e-9,-63247e-9,-8602e-8,-.084034,43093e-8,.34299,64502e-9,20865e-9,-2296e-8,891e-7,-.08624,49619e-8,.1094,-32486e-8,10291e-8,68014e-9,-20778e-9,4026e-8,21294e-8],[-72477e-8,68217e-9,-.076931,-.0011552,1054e-7,-77841e-9,89586e-9,-.042325,-.0013635,10851e-8,-14792e-8,40949e-9,.4145,-4378e-7,-.099758,-.0015731,1016e-7,-89748e-9,12253e-8,25352e-8,97249e-8,.22552,-69284e-8,-.080646,-.0015946],[-.16753,-19196e-8,31996e-8,-.23729,-31368e-8,-52091e-9,.025255,58348e-8,-.18871,-30567e-8,-993e-7,14531e-9,-56788e-8,.47294,44567e-8,-.13302,-18374e-8,-10782e-8,-88898e-9,55598e-9,-.16661,-72129e-8,.19598,10743e-8,-.06796],[.0015377,-25959e-9,.080991,.0023032,-67475e-9,-10658e-8,-62865e-8,.021978,.0021052,-12947e-8,-22261e-8,-44344e-10,-.093965,11932e-8,.4231,.0017358,-20395e-8,-30352e-8,-34348e-9,83179e-9,-.0010386,-.18248,8454e-7,.18239,.0012725],[.14612,-32247e-8,95961e-8,.20726,-53661e-8,99127e-10,-.12473,.0018012,.099974,-51256e-8,-23151e-9,1569e-7,-.001569,-.12095,.0016626,.51792,-26493e-8,-12389e-8,1405e-7,15289e-9,.062144,-.0019548,-.12832,.0010848,.30653],[-13553e-8,.14362,-56113e-9,-19031e-8,.26223,36192e-8,32342e-9,-12864e-8,-15404e-8,.16177,83212e-8,-.090793,80524e-9,-51527e-9,-20398e-8,-10685e-8,.5881,.0013166,-.11309,-30246e-8,13275e-8,11472e-8,-86653e-9,-28441e-8,-62521e-9],[-13634e-8,93663e-10,-99665e-9,-19483e-8,13414e-8,.094062,2275e-8,-18303e-8,-1814e-7,52852e-8,-.0095829,39039e-8,-21695e-10,-687e-7,-28476e-8,-18419e-8,.0011742,.45221,90964e-8,-.064164,15775e-8,-11335e-8,-98091e-9,-44028e-8,-20584e-8],[-26444e-8,-.061956,-10478e-8,-33816e-8,-.11346,38545e-8,71931e-9,-16927e-8,-17618e-8,-.11111,81581e-8,-.087784,1556e-7,-93349e-9,-85086e-9,12929e-9,-.11722,.001052,.36706,-51528e-8,30359e-8,15566e-8,-10045e-8,39986e-9,15386e-8],[39057e-9,35566e-8,-10735e-8,45511e-9,57303e-8,-.04125,10956e-9,-17653e-8,28536e-9,45023e-8,-.0082026,-34614e-8,2897e-7,49348e-9,90994e-10,26493e-9,-1845e-8,-.068135,-56418e-8,.34248,-76252e-9,41041e-8,31322e-9,34378e-8,45599e-9],[.056827,11455e-8,-69085e-8,.12211,18667e-8,10644e-8,-.10395,-.0013113,.096197,20931e-8,19859e-8,99635e-9,.0010888,-.012363,-.0012891,.074171,20063e-8,21633e-8,29313e-8,-89983e-9,.37372,.001344,-.068601,-98811e-8,.028622],[-78321e-8,36515e-9,-.10259,-.0012578,6083e-8,-14815e-8,68033e-9,-.18576,-.0015243,80516e-9,-2866e-7,40842e-9,.015151,-52644e-8,-.12867,-.0018046,11091e-8,-24219e-8,10614e-8,34752e-8,.0011171,.49093,-79147e-8,-.10704,-.0018639],[-.074733,-63458e-9,54333e-8,-.16723,-10994e-8,-12217e-9,.12284,.0010458,-.14661,-12609e-8,-37071e-9,-85744e-10,-82189e-8,.023297,.0011035,-.097792,-11469e-8,-79587e-9,-58657e-9,11575e-9,-.066173,-.0010052,.39489,98594e-8,-.072602],[.0017706,18058e-9,.056467,.0025726,-22476e-9,-22454e-8,-96359e-8,.10296,.001999,-1281e-7,-45862e-8,4024e-8,-.089975,-30459e-8,-.034888,.0011367,-25475e-8,-51506e-8,73723e-9,39399e-8,-63475e-8,-.091869,63725e-8,.39532,3378e-7],[.015382,-41929e-8,82433e-8,.10313,-69277e-8,-13914e-9,-.021293,.0015129,.16707,-642e-6,-69987e-9,23399e-8,-.0014455,-.062138,.0012068,.064233,-28881e-8,-17e-5,24544e-8,49782e-9,.019169,-.0018323,-.061826,42494e-8,.53265]],[[.44202,40148e-8,76252e-8,.2418,69148e-8,40455e-8,-.14126,.0013649,.21217,77214e-8,85235e-8,19886e-9,-.0012121,-.16032,.0010716,.14831,66569e-8,.0011326,32045e-8,-41324e-8,.08267,-.0014352,-.11085,38083e-8,.07076],[45229e-8,.33814,35116e-8,60261e-8,.13559,56961e-8,-1892e-7,62533e-8,347e-6,.14691,.0011388,-.040013,-54973e-8,48693e-9,47693e-8,32998e-9,.1308,.0013702,-.055003,-5729e-7,-40204e-8,-63701e-8,15351e-8,11438e-8,-19864e-8],[84881e-8,35116e-8,.31037,.0011743,62533e-8,36543e-8,-42546e-8,.083721,77183e-8,73287e-8,77461e-8,-16323e-9,-.059947,-90962e-9,.064185,2282e-7,6605e-7,.0010054,18224e-8,-48082e-8,-43698e-8,-.074061,16859e-8,.038769,-24283e-8],[.14275,48067e-8,97279e-8,.65234,83274e-8,51499e-8,-.24792,.001763,.38476,95146e-8,.001086,58219e-9,-.0015491,-.2587,.0014587,.25315,8684e-7,.0014461,46617e-8,-52282e-8,.1277,-.0018599,-.17274,67351e-8,.12383],[6976e-7,-.020151,57712e-8,93453e-8,.46597,85161e-8,-2562e-7,.0010288,57539e-8,.33434,.0017116,-.090205,-90024e-8,14492e-8,79005e-8,14526e-8,.2882,.0020849,-.11926,-8542e-7,-71624e-8,-.0010416,28602e-8,19969e-8,-16291e-8],[50799e-8,64419e-8,40796e-8,70073e-8,.0010877,.29045,-24447e-8,73004e-8,45162e-8,.0011524,.088387,-18332e-9,-74621e-8,-30414e-9,49029e-8,9559e-8,86e-5,.069551,33892e-8,-.030071,-28584e-8,-95654e-8,13034e-8,-50365e-9,-25183e-8],[-.14972,-95569e-9,-26888e-8,-.17246,-14087e-8,-12882e-8,.39844,-4883e-7,-.18289,-14157e-8,-26824e-8,-15274e-8,41425e-8,.21405,-41871e-8,-.14274,-13982e-8,-35366e-8,-43473e-8,11714e-8,-.10164,48774e-8,.1279,-22877e-8,-.069111],[.001393,57712e-8,-.069385,.0019511,.0010288,60475e-8,-70159e-8,.37378,.0013518,.0012085,.0012891,-22865e-9,-.15221,-15831e-8,.17375,52832e-8,.0010931,.0016961,30878e-8,-78767e-8,-71005e-8,-.17472,28944e-8,.10817,-20149e-8],[.21974,17631e-8,49545e-8,.24148,33537e-8,25131e-8,-.17497,95633e-8,.55831,45889e-8,53359e-8,34421e-9,-80504e-8,-.24118,98187e-8,.31986,55078e-8,71787e-8,20026e-8,-25457e-8,.11901,-.001042,-.17468,82739e-8,.19955],[64423e-8,.17111,59511e-8,88397e-8,.11706,72437e-8,-20026e-8,.0010631,63029e-8,.55124,.0014769,-.077863,-92558e-8,2e-4,82453e-8,33545e-8,.43193,.0018528,-.15489,-73186e-8,-74652e-8,-.0010712,32252e-8,22032e-8,12895e-8],[98781e-8,.0011382,7974e-7,.0013641,.0019318,-.10658,-47052e-8,.0014347,88574e-8,.0020714,.32588,-28867e-9,-.0014493,-50069e-9,99971e-8,19855e-8,.0015906,.20395,60875e-8,-.084602,-5653e-7,-.0018601,26231e-8,-43029e-10,-47917e-8],[12712e-8,-.046678,62591e-9,19812e-8,-.035038,12794e-8,-21591e-8,11466e-8,10456e-8,-.079367,25635e-8,.28925,-11353e-8,-32246e-8,86519e-9,-77592e-9,-.089373,2953e-7,.11661,-1649e-7,37097e-8,-14818e-8,-15551e-8,1226e-8,-27836e-8],[-.0012036,-4853e-7,-.082189,-.001672,-86159e-8,-62776e-8,58845e-8,-.024668,-.001128,-.0010078,-.0013249,70083e-10,.35208,10162e-8,-.089757,-39213e-8,-90823e-8,-.0016976,-28732e-8,84211e-8,65765e-8,.23066,-25913e-8,-.083384,25083e-8],[-.17937,18078e-8,11703e-8,-.25832,35527e-8,96921e-9,.012463,19859e-8,-.20813,42213e-8,21008e-8,-27835e-8,-20882e-8,.42088,99087e-9,-.15339,32082e-8,28486e-8,-55112e-8,-12448e-8,-.17967,-25339e-8,.21602,-94357e-9,-.091088],[82362e-8,33316e-8,.089844,.0012299,59836e-8,27608e-8,-43865e-8,.0020521,.0010629,71118e-8,61945e-8,-12425e-9,-.082757,-14717e-8,.35835,78325e-8,65128e-8,91638e-8,18071e-8,-31766e-8,-36391e-8,-.18237,19855e-8,.19069,482e-6],[.16385,-10881e-8,-19721e-9,.23533,-11923e-8,-67339e-9,-.1446,7471e-8,.097909,15365e-9,-1373e-7,-67753e-9,-38962e-10,-.13718,41929e-8,.46334,25452e-8,-17683e-8,-24153e-8,64349e-9,.075072,-15112e-8,-.14571,89591e-8,.32201],[41159e-8,.14389,43121e-8,61134e-8,.28286,32997e-8,-12503e-8,77231e-8,57592e-8,.1543,71035e-8,-.097865,-67016e-8,11889e-8,60314e-8,53101e-8,.52683,98224e-8,-.11741,-35311e-8,-44773e-8,-77728e-8,23417e-8,1585e-7,48727e-8],[.001155,.0010941,89343e-8,.0015988,.0018833,.10731,-54556e-8,.0016309,.0010497,.0020791,-.039323,-36125e-9,-.0015922,-50256e-9,.001248,25118e-8,.0016994,.36626,57137e-8,-.050197,-66744e-8,-.0020477,31862e-8,28802e-8,-55351e-8],[57188e-8,-.060864,33962e-8,82764e-8,-.11934,54431e-8,-60614e-8,61227e-8,45791e-8,-.1136,.0010935,-.11231,-56344e-8,-6964e-7,46817e-8,-14755e-8,-.12223,.0013001,.2935,-62101e-8,58257e-8,-68794e-8,-25315e-8,10089e-8,-74315e-8],[-41535e-8,-49844e-8,-48794e-8,-5697e-7,-84098e-8,-.045268,18181e-8,-86714e-8,-36808e-8,-90085e-8,.0048159,-26568e-9,91042e-8,-1036e-8,-54623e-8,-84657e-9,-70009e-8,-.054693,-3546e-7,.2816,27527e-8,.0011728,-12969e-8,15604e-8,19055e-8],[.059634,-52659e-8,-5936e-7,.13525,-96789e-8,-34532e-8,-.12358,-.0010504,.11093,-.0011082,-73267e-8,40108e-8,97468e-8,-.0070676,-75686e-8,.091678,-87415e-8,-9757e-7,61263e-8,38215e-8,.31028,.0011655,-.063395,-11247e-8,.044566],[-.0012082,-46667e-8,-.099419,-.0017059,-82704e-8,-71353e-8,58222e-8,-.19554,-.0012378,-96785e-8,-.0015092,-10671e-9,-.0079951,88965e-9,-.12901,-59069e-8,-87487e-8,-.001942,-31624e-8,96018e-8,68344e-8,.41463,-28798e-8,-.10927,-55779e-10],[-.078503,15722e-8,1922e-7,-.18593,29636e-8,14907e-8,.14733,36705e-8,-.16959,3659e-7,32034e-8,-88382e-9,-31541e-8,.022851,36133e-8,-.11541,34724e-8,4377e-7,-10804e-8,-16181e-8,-.060452,-40633e-8,.33726,27747e-8,-.085698],[-7213e-8,-10087e-8,.057061,62398e-9,-17285e-8,-2823e-7,-23261e-9,.11613,49086e-8,-19396e-8,-52822e-8,-27229e-10,-.09956,-12264e-8,-.055426,9739e-7,-17538e-8,-45373e-8,-68199e-9,46836e-8,17883e-8,-.090157,36088e-9,.31648,.0012946],[.021411,-20532e-8,-32344e-8,.12628,-26089e-8,-31626e-8,-.031478,-46198e-8,.20041,-12018e-8,-66794e-8,-20602e-8,4717e-7,-.082611,18783e-9,.050641,1389e-7,-90184e-8,-64047e-8,311e-6,.031205,39892e-8,-.070278,80208e-8,.44958]],[[.40316,97095e-8,99913e-9,.2426,.0017327,18476e-8,-.14377,24888e-8,.22102,.001926,37541e-8,-48221e-8,-73085e-9,-.16939,52259e-8,.16682,.0014628,4507e-7,-52419e-8,-23218e-8,.09214,-97122e-9,-.12489,94897e-8,.096164],[.0011362,.29173,16858e-8,.0015704,.12614,-26681e-8,-91183e-8,28868e-8,8099e-7,.14047,-56541e-8,-.037962,-29858e-8,-78441e-8,15645e-8,-32267e-8,.12945,-68934e-8,-.053516,45284e-8,23514e-8,-36481e-8,-24425e-8,-10367e-8,-.001389],[94016e-9,16858e-8,.26716,18925e-8,28868e-8,41397e-8,43045e-9,.079058,36333e-8,30359e-8,86588e-8,-50296e-9,-.056349,15258e-8,.062593,60509e-8,21318e-8,.0010832,-15912e-9,-55893e-8,-27358e-8,-.068758,15149e-8,.039611,81559e-8],[.13228,.0011912,21105e-8,.61458,.0021277,20704e-8,-.25676,4877e-7,.40544,.0023668,42403e-8,-60166e-8,-23861e-8,-.27883,86504e-8,.28706,.0017987,51844e-8,-66642e-8,-26497e-8,.14364,-33022e-8,-.19624,.0014176,.16239],[.0017991,-.044327,24263e-8,.0024888,.39875,-42694e-8,-.0014548,41814e-8,.001284,.32241,-90188e-8,-.086415,-43464e-8,-.0012639,23471e-8,-51389e-8,.29731,-.0010909,-.12094,72633e-8,3996e-7,-53883e-8,-4006e-7,-12618e-8,-.0022086],[25674e-8,-3126e-7,48579e-8,33971e-8,-56023e-8,.24416,-16906e-8,85861e-8,15308e-8,-60345e-8,.083148,24398e-8,-90172e-8,-10389e-8,52328e-8,-96919e-9,-39941e-8,.066366,37446e-8,-.027849,-37933e-9,-.0011618,-18085e-9,-21985e-8,-29948e-8],[-.15553,-66484e-8,48584e-9,-.17521,-.0011936,-88586e-9,.358,52076e-9,-.19132,-.0013331,-18543e-8,36979e-8,-15891e-8,.22539,-15517e-8,-.16184,-.0010144,-2353e-7,45103e-8,11839e-8,-.11408,-21548e-8,.14668,-53016e-8,-.0947],[27268e-8,24263e-8,-.088784,49754e-8,41814e-8,64278e-8,-39684e-10,.31338,78126e-8,44629e-8,.001346,-78411e-9,-.14454,20367e-8,.16866,.0011645,32852e-8,.0016858,-37775e-9,-87385e-8,-47646e-8,-.17364,25643e-8,.11589,.0014901],[.23342,25287e-8,41354e-8,.25015,45307e-8,13694e-9,-.18242,85147e-8,.52822,50588e-8,38207e-9,-1339e-7,-67932e-8,-.26094,.0010563,.34555,38704e-8,76748e-9,-15547e-8,-28524e-9,.13748,-9519e-7,-.20139,.001218,.23553],[.0015629,.17568,17617e-8,.0021644,.096375,-34853e-8,-.0012751,31099e-8,.0011176,.48181,-72899e-8,-.071156,-32534e-8,-.0011204,19939e-8,-44793e-8,.43225,-85536e-8,-.15324,60764e-8,3741e-7,-42098e-8,-36246e-8,-21175e-9,-.0019251],[43525e-8,-59259e-8,89215e-8,57877e-8,-.0010587,-.12667,-2942e-7,.0015786,26763e-8,-.0011318,.25475,46455e-8,-.0016633,-19256e-8,9629e-7,-14645e-8,-73119e-8,.1852,71547e-8,-.075621,-44847e-9,-.002151,-44315e-9,-40572e-8,-47267e-8],[-37434e-8,-.047505,-62965e-10,-52655e-8,-.029068,19205e-8,34708e-8,-16352e-9,-2723e-7,-.072787,40841e-8,.24078,1898e-8,35139e-8,-24025e-9,12194e-8,-.089246,51529e-8,.11552,-29458e-8,-19634e-8,37054e-9,13786e-8,-27444e-9,50339e-8],[-18074e-9,-26265e-8,-.085672,-1184e-7,-45432e-8,-6997e-7,-17939e-8,-.011662,-48413e-8,-48715e-8,-.0014684,8619e-8,.29319,-3444e-7,-.077336,-.0010029,-35832e-8,-.0018435,43966e-9,9622e-7,47866e-8,.22235,-27469e-8,-.082705,-.0014656],[-.18869,-40897e-8,15451e-8,-.27903,-74227e-8,-1801e-8,.010647,26875e-8,-.23045,-8359e-7,-47806e-9,27181e-8,-32097e-8,.37586,11852e-8,-.17684,-63783e-8,-83842e-9,38006e-8,36067e-9,-.18524,-43396e-8,.2285,-20391e-8,-.1178],[68456e-8,14306e-9,.097378,.0010926,34138e-9,1519e-7,-37244e-8,-.0099051,.0011492,61342e-9,31987e-8,-21212e-9,-.0703,-15895e-8,.29838,.0011739,10391e-8,40281e-8,-43018e-9,-21411e-8,-29993e-8,-.17438,12637e-8,.18804,.0011534],[.18082,-86642e-8,64785e-8,.26691,-.0015476,-17429e-8,-.16604,.0012662,.11135,-.0017199,-33333e-8,44279e-8,-.0011964,-.15775,.0012444,.41926,-.0013011,-33642e-8,49739e-8,20756e-8,.090038,-.0016788,-.16346,90992e-8,.32714],[55785e-8,.13763,25212e-9,77483e-8,.29689,-48908e-9,-46339e-8,64373e-9,40257e-8,.15847,-85516e-9,-.10331,-63983e-9,-41596e-8,11121e-8,-15603e-8,.47191,-34873e-9,-.12151,12819e-8,15056e-8,-12127e-8,-14047e-8,19466e-8,-68277e-8],[35248e-8,-55084e-8,85755e-8,47792e-8,-97485e-8,.11766,-25549e-8,.0015199,24629e-8,-.0010126,-.057906,45542e-8,-.0016097,-19379e-8,92818e-8,-5331e-8,-58803e-8,.28216,72187e-8,-.034802,54857e-10,-.0020932,-68083e-9,-39288e-8,-26146e-8],[-17352e-8,-.057598,59669e-9,-25811e-8,-.12308,25212e-8,23272e-8,89262e-9,-13422e-8,-.1172,539e-6,-.12464,-89466e-9,30541e-8,12514e-9,81309e-9,-.12677,69735e-8,.22573,-36486e-8,-27295e-8,-7921e-8,15052e-8,-10931e-8,30421e-8],[-25862e-8,51177e-8,-56368e-8,-34792e-8,91816e-8,-.04813,17966e-8,-.0010017,-16985e-8,.001002,.013837,-363e-6,.0010667,12531e-8,-61424e-8,73961e-9,69895e-8,-.039143,-52955e-8,.22623,86785e-10,.0013966,29305e-9,25767e-8,2765e-7],[.063586,-58865e-9,-26679e-8,.14778,-8961e-8,-89961e-9,-.14286,-51388e-8,.12696,-87192e-9,-17072e-8,-59372e-9,4722e-7,-.013822,-4949e-7,.11081,-65395e-9,-17935e-8,-1734e-7,91599e-9,.2548,64238e-8,-.061235,-34786e-8,.063742],[-50262e-9,-25496e-8,-.091137,-19443e-8,-449e-6,-75562e-8,-19651e-8,-.20009,-6526e-7,-49898e-8,-.0015913,97489e-9,-.019618,-39953e-8,-.13108,-.0012977,-40072e-8,-.0020052,76378e-9,.0010588,58271e-8,.34342,-33172e-8,-.11132,-.0018716],[-.083624,-36825e-9,14958e-8,-.2033,-68343e-9,-24842e-9,.17179,29489e-8,-.19401,-78596e-9,-57215e-9,30952e-9,-26135e-8,.036792,31012e-8,-.13849,-61442e-9,-85831e-9,47999e-9,301e-7,-.058195,-36068e-8,.29068,26831e-8,-.10346],[.0012543,-28534e-8,.054862,.0018951,-46579e-8,-61893e-8,-91931e-8,.12817,.0015589,-42752e-8,-.0012952,65325e-9,-.10903,-72899e-8,-.060411,9776e-7,-15552e-8,-.0016209,-21023e-9,83681e-8,38409e-9,-.091029,-10858e-8,.24714,38317e-8],[.032457,-.0015601,76732e-8,.15257,-.0027899,-23378e-8,-.045992,.0014697,.23832,-.0031031,-44103e-8,81544e-8,-.0014756,-.10783,.0012929,.057873,-.0023485,-42459e-8,93693e-8,29218e-8,.047159,-.0020718,-.083996,63964e-8,.37707]],[[.3697,-30446e-8,-4065e-7,.24299,-59382e-8,33247e-8,-.14569,-85327e-8,.22625,-7804e-7,73048e-8,20374e-8,77063e-8,-.17607,-.0010365,.17805,-83589e-8,.001,29869e-8,-47461e-8,.099396,.0011748,-.13548,-.0011391,.11219],[-35032e-8,.25386,3102e-7,-5267e-7,.12027,-30093e-9,32853e-8,57574e-8,-38838e-8,.13811,-74718e-9,-.037067,-59737e-8,3536e-7,43568e-8,-16076e-8,.13004,-10179e-8,-.053062,10783e-8,-19978e-8,-82269e-8,16926e-8,45257e-9,53777e-9],[-44376e-8,3102e-7,.23031,-72294e-8,57574e-8,-72904e-9,34717e-8,.074327,-74323e-8,69448e-8,-17593e-8,-15131e-8,-.053923,32344e-8,.060797,-72093e-8,62878e-8,-28841e-8,-16626e-8,11188e-8,-68783e-9,-.06503,10986e-8,.038773,-67862e-8],[.12654,-42486e-8,-65718e-8,.57902,-84164e-8,42558e-8,-.26151,-.0013736,.41584,-.0011388,93683e-8,27494e-8,.0012288,-.29399,-.0016621,.30941,-.0012766,.0012865,39518e-8,-60965e-8,.15666,.0018564,-.21509,-.0018214,.18901],[-62454e-8,-.055853,51208e-8,-95467e-8,.34562,-63609e-9,57698e-8,95223e-8,-7567e-7,.31076,-15532e-8,-.082956,-98858e-8,618e-6,72521e-8,-41328e-8,.30407,-21636e-8,-.12246,19716e-8,-3358e-7,-.0013653,29093e-8,85656e-9,-79485e-9],[4825e-7,-33332e-9,-79314e-9,69336e-8,-70246e-9,.20569,-38427e-8,-16053e-8,44261e-8,-83185e-9,.078463,10196e-8,16292e-8,-3393e-7,-17043e-8,3877e-8,-55662e-9,.06655,22543e-8,-.027371,10353e-8,24637e-8,-11319e-8,-16473e-8,-38307e-8],[-.15991,27171e-8,29848e-8,-.17891,52488e-8,-21653e-8,.32263,60879e-8,-.19613,67421e-8,-47791e-8,-18349e-8,-57312e-8,.23028,67324e-8,-.17356,68565e-8,-65015e-8,-27301e-8,3345e-7,-.12439,-856e-6,.16139,62866e-8,-.11227],[-92951e-8,51208e-8,-.098996,-.0015071,95223e-8,-14003e-8,70352e-8,.26128,-.0015426,.0011521,-34786e-8,-25274e-8,-.13474,62773e-8,.15825,-.0014912,.0010488,-59734e-8,-28149e-8,20673e-8,-82478e-9,-.17063,19294e-8,.11733,-.0013982],[.24156,-24086e-8,-66378e-8,.2564,-51657e-8,15208e-8,-.18573,-.0013828,.49644,-80043e-8,33875e-8,11908e-8,.0011916,-.27206,-.0016966,.35685,-.0010745,47968e-8,13629e-8,-20874e-8,.15147,.0017655,-.22144,-.0019126,.26152],[-7177e-7,.18121,49785e-8,-.0011317,.090331,-66544e-9,63446e-8,92905e-8,-.0010175,.42494,-16538e-8,-.066305,-95819e-8,66307e-8,72193e-8,-77331e-8,.42033,-24369e-8,-.14902,19542e-8,-31264e-8,-.0013248,29505e-8,12229e-8,-51483e-8],[9415e-7,-84164e-9,-17683e-8,.0013555,-17397e-8,-.13363,-75394e-8,-37048e-8,87065e-8,-21096e-8,.19926,20745e-8,35368e-8,-67092e-8,-44269e-8,86667e-9,-16182e-8,.16687,4482e-7,-.067643,21407e-8,54566e-8,-22532e-8,-50571e-8,-73446e-8],[22322e-8,-.048633,-87731e-9,33044e-8,-.027025,11534e-8,-20901e-8,-16532e-8,2236e-7,-.067894,25544e-8,.19994,19821e-8,-22571e-8,-11109e-8,38687e-9,-.087588,34744e-8,.11058,-18469e-8,13839e-8,29783e-8,-1083e-7,36999e-9,-16359e-8],[83245e-8,-54546e-8,-.088847,.001337,-.0010144,1496e-7,-65871e-8,-.0063706,.0013149,-.0012207,35485e-8,29532e-8,.24337,-61645e-8,-.065953,.0011873,-.0010925,5679e-7,36408e-8,-21708e-8,14896e-8,.20688,-21619e-8,-.076746,.0010215],[-.1933,25762e-8,22894e-8,-.29359,4944e-7,-12542e-8,.016062,44798e-8,-.24811,62358e-8,-27931e-8,-17628e-8,-44527e-8,.33781,42411e-8,-.19464,60442e-8,-37406e-8,-26689e-8,22608e-8,-.1848,-6451e-7,.23197,26496e-8,-.13757],[-.0011136,21496e-8,.10248,-.0017987,40435e-8,-13645e-8,76256e-8,-.015238,-.0018685,50395e-8,-3712e-7,-92689e-9,-.058153,58826e-8,.24457,-.0018623,48933e-8,-72148e-8,-84416e-9,17988e-8,11055e-8,-.15928,10655e-8,.17395,-.0018068],[.18695,-28704e-9,-62528e-8,.2843,-1325e-7,-19342e-8,-.17883,-.0013007,.12466,-38164e-8,-41889e-8,-82037e-9,.0010589,-.17164,-.0016392,.3805,-78713e-8,-54502e-8,-21604e-8,3054e-7,.1009,.0015273,-.17467,-.0019363,.32325],[-66997e-8,.12767,28303e-8,-.0011063,.3033,-2635e-8,52504e-8,53342e-8,-.0011781,.16978,-78278e-9,-.10659,-53076e-8,49742e-8,4449e-7,-.0011934,.42495,-14896e-8,-.12431,86754e-9,-11366e-8,-72911e-8,17698e-8,15633e-8,-.0011587],[.0010358,-97778e-9,-27085e-8,.0014964,-2058e-7,.12771,-82475e-8,-59464e-8,97995e-8,-26377e-8,-.057901,22639e-8,51877e-8,-72925e-8,-81466e-8,14e-5,-23822e-8,.21853,48546e-8,-.025236,22561e-8,82354e-8,-23458e-8,-.0010738,-74341e-8],[29165e-8,-.053233,-17349e-9,42366e-8,-.12458,22962e-8,-27711e-8,-36742e-9,25499e-8,-.12114,50413e-8,-.12471,97552e-9,-30307e-8,6216e-9,-397e-7,-.12984,6854e-7,.17263,-33533e-8,2025e-7,18781e-8,-14821e-8,11522e-8,-37873e-8],[-59701e-8,15949e-8,12838e-8,-86077e-8,30614e-8,-.051393,51186e-8,25347e-8,-53689e-8,36596e-8,.01486,-18584e-8,-24731e-8,49493e-8,25594e-8,-81601e-10,3032e-7,-.029642,-34748e-8,.18071,-22618e-8,-35744e-8,19816e-8,21694e-8,54758e-8],[.065877,-12584e-8,-40058e-10,.15509,-23451e-8,-28281e-9,-.15801,30981e-9,.1386,-26931e-8,-56633e-9,10533e-8,27187e-9,-.0287,1875e-7,.12577,-19496e-8,-86406e-9,18128e-8,-20545e-9,.21177,42194e-10,-.062911,45903e-8,.080377],[.0012247,-63944e-8,-.080771,.0019515,-.0011922,21149e-8,-94651e-8,-.20002,.0018873,-.0014352,50942e-8,37108e-8,-.020502,-85716e-8,-.13306,.0016603,-.0012794,8382e-7,48757e-8,-29208e-8,16085e-8,.28359,-28202e-8,-.10975,.0013765],[-.086589,69317e-9,-4755e-8,-.21319,11977e-8,95566e-10,.1902,-11179e-8,-.21175,11692e-8,22413e-9,-49254e-9,73957e-9,.057113,-18954e-8,-.15899,45834e-9,43471e-9,-76457e-9,89291e-10,-.059278,11824e-8,.25426,-30213e-8,-.12042],[-.0011904,-31552e-8,.047495,-.0019194,-57784e-8,-15623e-8,69871e-8,.1307,-.0020526,-66467e-8,-44682e-8,20376e-8,-.11135,39305e-8,-.059026,-.0021515,-52885e-8,-92251e-8,29328e-8,17116e-8,42264e-8,-.086715,-65963e-9,.18866,-.0021962],[.03526,62267e-9,-57369e-8,.16194,43163e-9,-44176e-8,-.052454,-.0011912,.26243,-17322e-8,-96537e-8,-21713e-8,91984e-8,-.12386,-.0015342,.076072,-61591e-8,-.0012872,-48821e-8,67944e-8,.059606,.0012904,-.095965,-.0018767,.32546]],[[.33938,13333e-8,-27637e-8,.24211,27273e-8,-51689e-8,-.1462,-52298e-8,.2318,38753e-8,-.0012045,-871e-7,54413e-8,-.18091,-42838e-8,.19241,46006e-8,-.0018644,-13072e-8,68563e-8,.10499,77272e-8,-.14509,-13652e-8,.13474],[15382e-8,.21796,-48112e-8,24382e-8,.10768,-26877e-8,-14304e-8,-94626e-8,21766e-8,.12788,-5806e-7,-.034082,88342e-8,-15992e-8,-95152e-8,15509e-8,.124,-76218e-8,-.049857,39486e-8,90239e-9,.0012554,-85679e-9,-71192e-8,75991e-9],[-34153e-8,-48112e-8,.1982,-4981e-7,-94626e-8,33417e-9,28501e-8,.068396,-33669e-8,-.0012887,86208e-9,18188e-8,-.050765,27071e-8,.059043,-77048e-9,-.0014584,15724e-8,13649e-8,-43358e-9,-94499e-9,-.061338,12389e-8,.040115,1849e-7],[.12487,20462e-8,-34994e-8,.54835,41838e-8,-73107e-8,-.2635,-66975e-8,.42539,59568e-8,-.0017087,-12712e-8,69183e-8,-.3065,-57578e-8,.33603,71043e-8,-.0026584,-18384e-8,97061e-8,.16787,9947e-7,-.23347,-24999e-8,.22589],[30504e-8,-.065722,-8759e-7,48332e-8,.29053,-40635e-8,-27625e-8,-.0017279,43498e-8,.28367,-87603e-8,-.075317,.0016094,-30128e-8,-.0017555,31742e-8,.29583,-.0011415,-.11762,60551e-8,15676e-8,.0022946,-15672e-8,-.0013486,1674e-7],[-74739e-8,-34447e-8,35437e-9,-.0011371,-62934e-8,.17159,53669e-8,78023e-9,-96178e-8,-73026e-8,.068783,18185e-8,-63909e-9,4302e-7,11022e-8,-62653e-8,-6022e-7,.061316,21896e-8,-.024637,11288e-9,-10139e-8,13111e-8,14754e-8,-22012e-8],[-.16253,-11838e-8,1884e-7,-.18373,-23735e-8,27898e-8,.29214,36102e-8,-.20202,-323e-6,65273e-8,87009e-9,-37469e-8,.23063,30903e-8,-.18706,-35632e-8,.0010127,13901e-8,-38227e-8,-.13163,-54106e-8,.17343,12538e-8,-.13421],[-5519e-7,-8759e-7,-.10261,-8133e-7,-.0017279,74819e-9,46529e-8,.21712,-57479e-8,-.0023654,19078e-8,33243e-8,-.12286,45054e-8,.14679,-18678e-8,-.0026981,3416e-7,25214e-8,-98342e-9,-1654e-7,-.16528,2139e-7,.12026,20233e-8],[.25108,16471e-8,-12109e-8,.27143,33878e-8,-51542e-8,-.19196,-25426e-8,.47751,49367e-8,-.0012177,-76954e-9,24412e-8,-.28338,-30216e-8,.37092,61352e-8,-.0019322,-84209e-9,67926e-8,.16422,38435e-8,-.24084,-3295e-7,.29162],[40992e-8,.1791,-.0010705,65031e-8,.082773,-31298e-8,-3509e-7,-.0021227,5994e-7,.36873,-66838e-8,-.05962,.0019652,-36224e-8,-.0021968,46604e-8,.39387,-84539e-8,-.13904,48462e-8,15136e-8,.0028141,-17577e-8,-.0017682,29101e-8],[-.0016052,-61728e-8,95579e-9,-.0024497,-.0011257,-.13547,.0011546,20749e-8,-.0020936,-.0012975,.14856,33912e-8,-17422e-8,93045e-8,28161e-8,-.0014012,-.0010495,.13788,42547e-8,-.05519,19491e-9,-27308e-8,28765e-8,35897e-8,-55487e-8],[-99164e-9,-.047706,60748e-9,-15085e-8,-.024335,69083e-9,10335e-8,12247e-8,-10849e-8,-.061059,15574e-8,.16463,-12586e-8,12331e-8,12268e-8,-28924e-9,-.082717,21893e-8,.10015,-11194e-8,-8697e-8,-19384e-8,69805e-9,84571e-9,63608e-9],[61047e-8,78452e-8,-.089851,89543e-8,.0015454,-58137e-9,-5143e-7,-.005483,61809e-8,.0021067,-15007e-8,-31088e-8,.20145,-4961e-7,-.058199,1652e-7,.0023843,-27251e-8,-25912e-8,78598e-9,18378e-8,.18696,-2322e-7,-.073902,-29881e-8],[-.19593,-11584e-8,12614e-8,-.30567,-22732e-8,99577e-9,.027499,2488e-7,-.26654,-29537e-8,23728e-8,91578e-9,-25518e-8,.30929,2352e-7,-.21581,-29879e-8,37229e-8,15077e-8,-15594e-8,-.18062,-38118e-8,.23232,14091e-8,-.16201],[-20294e-8,-72266e-8,.10655,-32853e-8,-.0014413,10961e-8,18175e-8,-.01145,-32346e-8,-.002013,27208e-8,2669e-7,-.051436,19917e-8,.20487,-30157e-8,-.0023681,46751e-8,1902e-7,-1448e-7,-88264e-9,-.14692,11663e-8,.16128,-29419e-8],[.19817,91305e-9,13336e-8,.31025,19183e-8,-20506e-8,-.19601,20786e-8,.15428,30098e-8,-50635e-8,27028e-10,-2617e-7,-.1927,-33449e-10,.36026,41974e-8,-86838e-8,66831e-9,25657e-8,.11411,-31197e-8,-.1888,-43534e-8,.31928],[44894e-8,.11462,-.001051,71425e-8,.30023,-34528e-9,-3486e-7,-.0021005,68528e-8,.18342,-57004e-9,-.10716,.0019221,-32249e-8,-.0022397,58605e-8,.39167,-81808e-10,-.12622,91263e-9,63144e-9,.0027677,-13227e-8,-.0019345,44583e-8],[-.0022133,-5432e-7,18372e-8,-.003395,-9823e-7,.13079,.0015892,39141e-8,-.0029564,-.0011025,-.055007,33035e-8,-33673e-8,.0012824,50444e-8,-.0020753,-82452e-8,.16353,45353e-8,-.015618,37776e-9,-51807e-8,39802e-8,60128e-8,-98184e-8],[-12904e-8,-.047295,-15155e-8,-18928e-8,-.12151,11037e-9,14423e-8,-29272e-8,-10758e-8,-.12225,3917e-8,-.11865,24504e-8,17751e-8,-3012e-7,35895e-9,-.13131,8655e-8,.12962,-38289e-9,-13811e-8,31558e-8,10259e-8,-25319e-8,19752e-8],[81682e-8,41613e-8,-43288e-9,.0012462,76637e-8,-.051606,-60466e-8,-95489e-9,.0010539,90114e-8,.015796,-23273e-8,81973e-9,-50966e-8,-13213e-8,68094e-8,7628e-7,-.019079,-29851e-8,.14176,41469e-9,13253e-8,-17558e-8,-1706e-7,22654e-8],[.068688,6431e-8,24013e-9,.16087,11801e-8,20148e-8,-.16877,35621e-9,.14904,12873e-8,46473e-8,-65248e-9,-36497e-9,-.047843,23943e-10,.13991,79721e-9,7197e-7,-11766e-8,-2331e-7,.17976,-30341e-9,-.069454,-50757e-9,.097775],[71936e-8,9656e-7,-.069785,.001069,.0019093,-91666e-9,-61423e-8,-.19608,77783e-8,.0026165,-23325e-8,-39541e-8,-.014194,-60713e-8,-.1378,29088e-8,.0029827,-41365e-8,-35173e-8,1267e-7,24023e-8,.23924,-29585e-8,-.11498,-21214e-8],[-.091135,-16788e-9,5147e-8,-.2222,-28598e-9,-84955e-9,.2047,10151e-8,-.22818,-24611e-9,-1984e-7,19606e-9,-99587e-9,.083339,98436e-9,-.18086,2.5708e-7,-31285e-8,36666e-9,10063e-8,-.065865,-14565e-8,.23194,61992e-9,-.14079],[33703e-8,-31046e-8,.042786,42621e-8,-6492e-7,14648e-8,-27355e-8,.13605,74611e-9,-98486e-8,35348e-8,91197e-9,-.11806,-2263e-7,-.043261,-46585e-8,-.0013,5814e-7,23848e-9,-19158e-8,75866e-9,-.094091,-67492e-9,.15119,-.0010431],[.049763,15764e-9,25546e-8,.18481,3964e-8,88669e-9,-.067998,42573e-8,.29301,96758e-9,1717e-7,74907e-9,-5189e-7,-.14755,11117e-8,.10827,20384e-8,15821e-8,19734e-8,-14462e-8,.075987,-67251e-8,-.11483,-56106e-8,.29147]],[[.31363,-41101e-8,53517e-9,.24148,-81202e-8,23273e-8,-.147,36807e-9,.23417,-.0010772,58812e-8,29418e-8,-46975e-9,-.18483,-17434e-8,.19896,-.0011403,.0010566,45549e-8,-25734e-8,.10964,67167e-9,-.15213,-53544e-8,.14545],[-51527e-8,.19046,20222e-8,-78816e-8,.10169,24513e-8,50206e-8,43499e-8,-60158e-8,.12481,52734e-8,-.033124,-32469e-8,56687e-8,60977e-8,-24747e-8,.12357,71933e-8,-.049267,-26743e-8,-32219e-8,-47777e-8,3205e-7,8151e-7,16694e-8],[12129e-8,20222e-8,.17107,11911e-8,43499e-8,-85475e-9,-31851e-9,.062795,-7016e-8,69824e-8,-21551e-8,-19332e-9,-.048365,75361e-9,.056424,-33496e-8,98882e-8,-35721e-8,77751e-9,16866e-8,-16816e-8,-.058979,12642e-8,.038952,-60143e-8],[.12617,-57528e-8,-49614e-9,.52022,-.0011369,39165e-8,-.26331,-19226e-8,.42636,-.0015154,97857e-8,38822e-8,16688e-8,-.31495,-48291e-8,.3489,-.001623,.0017216,5782e-7,-45565e-8,.17701,42577e-8,-.24717,-91837e-8,.24574],[-93034e-8,-.064638,4467e-7,-.0014232,.2536,34399e-8,87887e-8,94768e-8,-.0011031,.26675,73335e-8,-.070658,-74521e-8,96546e-8,.0012639,-49521e-8,.29184,99138e-8,-.11537,-34817e-8,-50443e-8,-.0010977,52891e-8,.0015908,21612e-8],[28975e-8,33393e-8,-96852e-9,48711e-8,60873e-8,.14458,-13859e-8,-20809e-8,59526e-8,73448e-8,.06217,-48062e-9,2406e-7,-4176e-8,-22413e-8,72625e-8,68815e-8,.060039,1153e-7,-.0241,-19933e-8,41336e-8,29679e-9,-17256e-8,82785e-8],[-.16417,37565e-8,95406e-9,-.18898,72766e-8,-74836e-9,.26692,22552e-8,-.20549,93949e-8,-20414e-8,-23063e-8,-23971e-8,.22812,31544e-8,-.1937,95554e-8,-4162e-7,-31512e-8,52811e-9,-.1363,-4426e-7,.18098,38961e-8,-.14614],[17306e-9,4467e-7,-.10092,-89715e-9,94768e-8,-18624e-8,93328e-9,.1807,-37553e-8,.0014834,-46275e-8,-7699e-8,-.1111,2634e-7,.1325,-75346e-8,.0020386,-75819e-8,89057e-9,34369e-8,-31126e-8,-.15799,27604e-8,.11556,-.0011219],[.25367,-29197e-8,-31992e-8,.2797,-58706e-8,48483e-8,-.19405,-69142e-8,.45488,-82095e-8,.001177,14757e-8,62707e-8,-.28743,-89643e-8,.37172,-96186e-8,.0019564,17162e-8,-63432e-8,.17251,.0010063,-.2527,-.0010748,.30696],[-.0010337,.17852,73966e-8,-.0015876,.08755,247e-6,92589e-8,.001541,-.0012804,.33134,51567e-8,-.056696,-.0012947,9693e-7,.0019145,-68737e-8,.37037,6814e-7,-.13175,-20737e-8,-4202e-7,-.0019102,50205e-8,.0021826,10906e-9],[77306e-8,55917e-8,-25475e-8,.0012775,.0010114,-.12865,-42263e-8,-53764e-8,.0014708,.0012114,.11512,-37407e-9,5976e-7,-21176e-8,-5721e-7,.0016764,.0011281,.11844,30404e-8,-.047719,-38947e-8,99724e-8,374e-8,-43967e-8,.0018042],[35095e-8,-.047367,46489e-9,51691e-8,-.025226,12056e-8,-29071e-8,80985e-9,36127e-8,-.058053,28332e-8,.13652,-11437e-8,-26834e-8,20468e-9,95741e-9,-.079582,41831e-8,.08966,-22776e-8,71205e-9,-17042e-8,-10649e-8,-1175e-7,-1975e-7],[-20886e-9,-27094e-8,-.089692,76135e-9,-59833e-8,22642e-8,-12201e-8,-.0084482,31949e-8,-.0010051,55144e-8,-13828e-9,.16915,-32414e-8,-.052153,62607e-8,-.0014978,8743e-7,-20102e-8,-41577e-8,40043e-8,.16776,-32617e-8,-.067064,91082e-8],[-.19592,33672e-8,24777e-8,-.31235,63843e-8,36841e-9,.041285,50228e-8,-.27931,80155e-8,67902e-9,-1613e-7,-53484e-8,.28773,4977e-7,-.23054,7834e-7,38558e-9,-16209e-8,-92233e-9,-.17457,-84217e-8,.22892,3281e-7,-.17829],[-53338e-8,68132e-8,.10645,-89894e-8,.0013983,-18669e-8,44845e-8,-.007567,-9981e-7,.0020511,-45789e-8,-24116e-8,-.044536,48119e-8,.16977,-.0010721,.0025859,-75462e-8,-16352e-8,29275e-8,-16821e-8,-.13042,28627e-8,.14167,-.001116],[.19758,11229e-8,-56847e-8,.31717,1954e-7,55568e-8,-.20212,-.0011413,.17323,17001e-8,.0013154,-16545e-8,.0010217,-.204,-.0012566,.34107,-62759e-10,.0020696,-33049e-8,-79975e-8,.12255,.0014647,-.1964,-.001194,.31157],[-79257e-8,.10212,.0010424,-.0012342,.29167,36944e-9,63214e-8,.0021379,-.0010948,.19632,5963e-8,-.10615,-.0019008,58818e-8,.0024813,-79718e-8,.36644,50026e-9,-.1277,31289e-9,-10946e-8,-.0028105,26101e-8,.0025254,-43315e-8],[.0014898,46433e-8,-41705e-8,.0024096,82563e-8,.13259,-94155e-8,-86901e-8,.002555,9719e-7,-.041282,44921e-9,91805e-8,-65006e-8,-9323e-7,.0026071,88969e-8,.13126,44808e-8,-.013553,-40724e-8,.001486,-17593e-8,-75507e-8,.0025091],[41859e-8,-.042133,23062e-8,59588e-8,-.11749,40682e-8,-29089e-8,45331e-8,38224e-8,-.12324,92864e-8,-.10748,-46171e-8,-19069e-8,42452e-8,44434e-9,-.1327,.001338,.099632,-65792e-8,-81039e-9,-68567e-8,-23324e-10,23859e-8,-30934e-8],[-20477e-8,-18918e-8,23108e-8,-36868e-8,-32215e-8,-.052357,40246e-9,47061e-8,-55055e-8,-36239e-8,.010402,-91112e-9,-52555e-8,-81005e-9,45227e-8,-80463e-8,-31958e-8,-.017613,-37083e-8,.11385,29881e-8,-8453e-7,-10644e-8,25635e-8,-.0010424],[.070773,-13904e-8,-32558e-8,.16356,-23926e-8,-2213e-7,-.17425,-61284e-8,.1558,-25608e-8,-52461e-8,-9.537e-7,66974e-8,-.06671,-45871e-8,.14993,-18182e-8,-82728e-8,-1138e-7,31716e-8,.15713,96922e-8,-.077784,8.8884e-7,.11179],[33757e-8,-38402e-8,-.059394,64421e-8,-84014e-8,3727e-7,-45108e-8,-.18799,82986e-8,-.0013897,89475e-8,-4.7474e-7,-.0041612,-69089e-8,-.1388,99795e-8,-.0020381,.0013971,-23956e-8,-64896e-8,59044e-8,.20779,-54188e-8,-.11449,.0011069],[-.094363,28314e-9,99717e-9,-.22618,4212e-8,99806e-9,.21228,19137e-8,-.23799,32568e-9,23459e-8,21108e-9,-21177e-8,.10733,15223e-8,-.19737,20976e-10,36229e-8,80665e-9,-14877e-8,-.073989,-31651e-8,.21727,21217e-9,-.15805],[-.0011939,91547e-8,.0339,-.001848,.0018285,-10146e-8,81456e-8,.12917,-.0016949,.0025287,-24643e-8,-46318e-8,-.11427,6066e-7,-.033049,-.0013819,.0029092,-4337e-7,-55738e-8,73783e-9,17608e-8,-.090871,17404e-8,.12049,-.0010266],[.0528,42988e-8,-66133e-8,.18711,80881e-8,51955e-8,-.072458,-.0012989,.30275,95112e-8,.0012079,-38218e-8,.0011314,-.15757,-.0013723,.13589,76198e-8,.0018195,-64908e-8,-80352e-8,.086229,.0015389,-.12785,-.0012231,.27476]],[[.29045,-19386e-8,33846e-8,.24015,-30362e-8,79368e-9,-.1471,72776e-8,.23683,-21266e-8,11931e-8,10437e-8,-6044e-7,-.18797,97645e-8,.20739,12741e-8,-3.0863e-7,11287e-8,-99209e-9,.11372,-93099e-8,-.15887,.0012408,.15985],[-33292e-8,.16481,12625e-8,-4302e-7,.091774,-1032e-7,27397e-8,19551e-8,-10452e-8,.11645,-22452e-8,-.030856,-23047e-8,22894e-8,-4.156e-7,40487e-8,.11854,-28269e-8,-.047069,18907e-8,-81065e-9,-25071e-8,51118e-9,-40697e-8,95421e-8],[38016e-8,12625e-8,.14747,63746e-8,19551e-8,-11345e-8,-2503e-7,.056524,73849e-8,13353e-8,-21944e-8,-46073e-9,-.044907,-19615e-8,.053296,84981e-8,-92775e-9,-20869e-8,-15926e-9,16279e-8,-87622e-9,-.05557,-90548e-9,.038687,94219e-8],[.12996,-1008e-7,57366e-8,.49704,-89492e-9,-4.3725e-7,-.26233,.0012225,.42788,15476e-8,-98236e-9,63941e-9,-.0010361,-.32219,.0015939,.36383,67869e-8,-42181e-8,64931e-9,20211e-9,.18558,-.0015887,-.26073,.001951,.27055],[-3125e-7,-.06335,8656e-8,-33772e-8,.21756,-14365e-8,26579e-8,69326e-9,16977e-8,.24287,-30651e-8,-.064279,-14379e-8,20183e-8,-29677e-8,9364e-7,.27887,-3605e-7,-.10989,28118e-8,-10104e-8,-47922e-9,-69226e-10,-97369e-8,.001743],[28667e-8,-14912e-8,-18702e-8,37142e-8,-27616e-8,.12097,-20976e-8,-31949e-8,10624e-8,-3139e-7,.052814,13161e-8,36107e-8,-14092e-8,-12854e-8,-31256e-8,-22636e-8,.05411,23135e-8,-.021404,-69653e-10,458e-6,83242e-10,29954e-8,-77938e-8],[-.16479,54774e-9,-17635e-8,-.19487,62772e-9,22013e-9,.24652,-38361e-8,-.21044,-30252e-9,92824e-9,-36722e-9,29275e-8,.22523,-54734e-8,-.20198,-24616e-8,25528e-8,-44489e-9,-46544e-9,-.13974,4417e-7,.18724,-75543e-8,-.16031],[84634e-8,8656e-8,-.096328,.0014031,69326e-9,-96532e-9,-57623e-8,.15046,.001569,-15503e-8,-14429e-8,-14165e-9,-.09869,-47007e-8,.11873,.0017271,-63031e-8,76602e-10,52303e-9,13956e-8,-13941e-8,-.14787,-22188e-8,.11125,.0018375],[.25746,39376e-8,68788e-8,.29354,84694e-8,-29521e-8,-.19924,.0014372,.44269,.0013247,-7664e-7,-18164e-8,-.0012845,-.29378,.001743,.3764,.0018012,-.0013953,-21411e-8,42942e-8,.18087,-.0019587,-.26486,.0019128,.32349],[24354e-8,.17281,-20233e-8,53579e-8,.089972,-60847e-9,-17272e-8,-53103e-8,97191e-8,.2982,-1086e-7,-.053558,41438e-8,-21374e-8,-99896e-8,.0015633,.34482,-40383e-9,-.12373,17149e-8,-20413e-9,81243e-8,-22345e-8,-.0016922,.002134],[33741e-8,-25173e-8,-23102e-8,36699e-8,-45932e-8,-.12087,-2287e-7,-35189e-8,-14622e-8,-49631e-8,.085425,24982e-8,44699e-8,-92711e-9,43156e-9,-92808e-8,-29431e-8,.094375,46004e-8,-.037718,-62161e-9,50714e-8,12375e-8,84243e-8,-.001782],[-44085e-9,-.045788,69947e-9,-80966e-9,-.02565,76953e-9,28161e-9,15138e-8,-114e-6,-.054933,17899e-8,.1136,-14572e-8,2408e-8,19016e-8,-15699e-8,-.075974,25944e-8,.078971,-14462e-8,13622e-9,-24071e-8,16391e-9,21318e-8,-19717e-8],[-60683e-8,-13574e-8,-.087044,-.0010229,-17505e-8,15339e-8,37017e-8,-.011445,-.0012176,-11982e-9,28185e-8,31503e-9,.14218,25236e-8,-.047953,-.0014527,39824e-8,21762e-8,-3954e-8,-21997e-8,22431e-8,.14755,91709e-9,-.062981,-.0016681],[-.19604,-88342e-9,-69582e-9,-.31846,-19448e-8,136e-6,.057827,-15664e-8,-.29254,-31688e-8,34247e-8,31302e-9,83448e-9,.27546,-2666e-7,-.24727,-4532e-7,59049e-8,24414e-9,-21155e-8,-.17065,10994e-8,.22808,-44386e-8,-.19708],[.0012459,-37507e-8,.10482,.002017,-83384e-8,26734e-8,-92596e-8,-39943e-8,.0020711,-.0013628,6843e-7,19743e-8,-.041372,-83657e-8,.14487,.0020101,-.0019481,.0012222,27478e-8,-37889e-8,2116e-8,-.11804,-42826e-8,.12604,.0018552],[.20181,91367e-8,77771e-8,.33038,.00182,-6184e-7,-.21156,.0015965,.20056,.0025104,-.0014899,-44294e-8,-.001503,-.22048,.0017973,.33501,.0028789,-.0024249,-51249e-8,87227e-8,.1332,-.0022881,-.20773,.0017181,.30767],[.0011846,.090921,-68709e-8,.0019608,.27976,13415e-8,-92284e-8,-.0014981,.0021129,.20873,34383e-8,-.10405,.0013388,-90885e-8,-.0019949,.0021747,.35291,63742e-8,-.12963,-1305e-7,13964e-8,.0021713,-54773e-8,-.0024732,.0021122],[-21634e-8,-14533e-8,92864e-9,-54784e-8,-23808e-8,.12853,22216e-8,31995e-8,-.0011178,-15997e-8,-.031125,23098e-8,-17508e-8,37336e-8,82619e-8,-.0019099,15368e-8,.10421,48221e-8,-.01043,-18391e-8,-44737e-8,41755e-8,.0016355,-.0027269],[-26734e-8,-.037612,23219e-8,-39272e-8,-.11244,1239e-7,20125e-8,45644e-8,-28285e-8,-.12357,29748e-8,-.094137,-46538e-8,16555e-8,4268e-7,-94726e-9,-.1347,45836e-8,.079807,-23167e-8,-89577e-10,-69224e-8,54434e-9,23575e-8,11938e-8],[-18904e-8,23937e-8,16051e-8,-20847e-8,454e-6,-.050161,11755e-8,25999e-8,64079e-9,54247e-8,.0080357,-21963e-8,-30953e-8,30322e-9,43752e-9,47663e-8,44747e-8,-.013477,-39561e-8,.090187,67312e-9,-37214e-8,-86365e-9,-41222e-8,92463e-8],[.074596,18043e-8,-18927e-8,.16779,32798e-8,-18207e-8,-.17772,-39237e-8,.1633,37715e-8,-40984e-8,-78995e-9,39768e-8,-.086576,-42944e-8,.1596,30001e-8,-57962e-8,-70109e-9,27513e-8,.1438,63364e-8,-.089728,-37077e-8,.12485],[-9118e-7,58168e-9,-.049475,-.0015219,23785e-8,38495e-9,56294e-8,-.17617,-.0017657,61966e-8,-37834e-10,-78528e-9,.0050053,38663e-8,-.13813,-.0020483,.001232,-2705e-7,-19727e-8,-56402e-9,31636e-8,.18438,13442e-8,-.11671,-.0023007],[-.099706,-35423e-9,64061e-9,-.23182,-65586e-9,85321e-9,.21754,12907e-8,-.24796,-79844e-9,19928e-8,11406e-9,-1432e-7,.13193,12082e-8,-.21392,-74321e-9,30357e-8,34169e-10,-12832e-8,-.085603,-22861e-8,.21236,60459e-9,-.17638],[.0016477,-.0010298,.028378,.0026151,-.0020929,75964e-8,-.0013266,.12467,.0024708,-.0029939,.0017874,48445e-8,-.11351,-.0013014,-.017793,.002053,-.0036317,.0027874,55021e-8,-.00108,32505e-8,-.09551,-71119e-8,.1028,.0014826],[.064155,.0011563,76615e-8,.1999,.0022549,-80822e-8,-.083472,.0015552,.31614,.0029892,-.0019024,-56956e-8,-.0015247,-.1724,.001654,.16657,.0032106,-.0029779,-65872e-8,.0011248,.098179,-.0023275,-.14457,.0013883,.26835]],[[.27052,-.001436,24056e-9,.23917,-.0028499,-54443e-8,-.14703,24454e-9,.23882,-.0038187,-.0012727,.0010131,23912e-9,-.18998,-64801e-10,.2139,-.0040951,-.0019369,.0016263,83273e-8,.11631,12545e-8,-.16369,-33997e-9,.17142],[-.0019515,.14345,-57781e-8,-.0029966,.08358,32768e-9,.0018556,-.0011404,-.0023531,.10912,50985e-9,-.028823,.0011654,.002111,-.0010782,-.0010762,.11366,29823e-9,-.044832,1348e-8,-.001189,.0017445,.0013382,-62124e-8,52216e-8],[59075e-9,-57781e-8,.12778,65753e-9,-.0011404,-37678e-8,33153e-9,.051499,24357e-9,-.001528,-87548e-8,34631e-8,-.04238,14416e-8,.050743,-15329e-9,-.0016521,-.0013164,49174e-8,58088e-8,-22242e-8,-.05365,18269e-8,.038504,-31696e-9],[.13538,-.0019229,-25937e-9,.47744,-.0038238,-71777e-8,-.26029,-81103e-9,.42736,-.0051387,-.0016807,.0013721,1523e-7,-.32632,-11057e-8,.37476,-.0055362,-.0025657,.002221,.0010994,.19131,34934e-8,-.27065,-9022e-8,.2911],[-.0033615,-.058997,-98035e-8,-.0051712,.18887,-13633e-9,.0032167,-.001938,-.0040798,.2212,-75105e-9,-.058421,.0019794,.0036859,-.0018423,-.0018997,.26369,-19354e-8,-.10344,13176e-8,-.0021087,.002969,.0023602,-.0010834,83761e-8],[-.0010239,69745e-9,-52082e-8,-.001564,10797e-8,.10192,89749e-8,-.0010213,-.0012455,95463e-9,.045322,52197e-9,.0010554,93737e-8,-93762e-8,-6246e-7,35843e-9,.049444,19563e-8,-.019513,-3998e-7,.0015741,53343e-8,-47946e-8,1459e-7],[-.16435,.0011544,11504e-8,-.20005,.0023018,36143e-8,.22944,24497e-8,-.21454,.0030995,84711e-8,-85703e-8,-29204e-8,.22094,25204e-8,-.20833,.0033415,.0012922,-.0014224,-56141e-8,-.14058,-50995e-8,.19027,16216e-8,-.17177],[-22873e-10,-98035e-8,-.088896,-44527e-9,-.001938,-6253e-7,15278e-8,.1276,-7753e-8,-.0026037,-.0014564,59025e-8,-.08882,35321e-8,.10732,-72894e-9,-.0028283,-.0021986,84205e-8,96736e-8,-43656e-8,-.13928,37951e-8,.1065,-10997e-9],[.25877,-82526e-8,-10511e-8,.3055,-.0016586,-31702e-8,-.20332,-21784e-8,.43316,-.0022689,-75011e-8,60929e-8,2634e-7,-.29756,-20478e-8,.37971,-.0025178,-.0011681,.0010126,48456e-8,.18624,45028e-8,-.27311,-90541e-9,.33708],[-.0034965,.16496,-.0010127,-.0053979,.092325,-13122e-8,.0033758,-.0020087,-.0043032,.27064,-3505e-7,-.050731,.002046,.0039092,-.0019343,-.0020877,.31891,-6118e-7,-.11535,31747e-8,-.0022814,.0030793,.002543,-.0011934,70796e-8],[-.0020495,2748e-8,-.0010182,-.0031352,-51434e-10,-.1104,.001801,-.0020009,-.0025091,-10387e-8,.06507,17701e-8,.0020684,.0018882,-.0018489,-.0012817,-24281e-8,.076343,50134e-8,-.030616,-81303e-8,.0030947,.0010818,-97213e-8,2445e-7],[95378e-8,-.043572,17236e-8,.0014806,-.025887,14049e-8,-96524e-8,34307e-8,.0011795,-.051932,33754e-8,.094967,-35902e-8,-.0011673,32613e-8,55501e-8,-.071864,52507e-8,.068541,-25241e-8,75578e-8,-54992e-8,-79332e-8,1867e-7,-24692e-8],[96068e-9,.0010234,-.083964,19316e-8,.0020222,67088e-8,-2506e-7,-.016473,20405e-8,.0027121,.0015621,-62473e-8,.12265,-47578e-8,-.046765,14802e-8,.0029348,.0023558,-90097e-8,-.0010398,52118e-8,.13215,-46521e-8,-.060467,17351e-9],[-.19455,99376e-8,25611e-8,-.32071,.001995,22368e-8,.073016,52072e-8,-.30174,.0027074,52759e-8,-78674e-8,-57122e-8,.26649,50716e-8,-.26093,.0029457,81e-5,-.0013573,-35824e-8,-.16625,-91999e-8,.22638,30052e-8,-.21366],[-2028e-7,-5021e-7,.10161,-32663e-8,-.0010023,-2716e-7,26754e-8,.0075454,-26122e-8,-.0013715,-64341e-8,30177e-8,-.040308,39223e-8,.127,-10422e-8,-.0015379,-.0010007,43253e-8,42735e-8,-33573e-8,-.10862,33126e-8,.11364,11826e-8],[.20358,68167e-8,-11362e-8,.33856,.0013218,20958e-8,-.21747,-2086e-7,.22523,.0016934,47477e-8,-46823e-8,21089e-8,-.23384,-15306e-8,.33487,.0016653,67555e-8,-72812e-8,-32795e-8,.14197,28044e-8,-.21749,3.8801e-7,.30878],[-.0023134,.079781,-68389e-8,-.0036041,.26221,-24794e-8,.0022661,-.0013689,-.0029609,.21287,-6069e-7,-.099662,.0013793,.0026748,-.0013673,-.0016085,.33829,-97056e-8,-.12854,45669e-8,-.0016048,.0020917,.001796,-95473e-8,11929e-8],[-.0023854,-18445e-8,-.0011255,-.0036604,-43244e-8,.12241,.0021001,-.0022221,-.0029637,-68904e-8,-.020342,34067e-8,.0022961,.0022114,-.0020862,-.001582,-88912e-8,.086794,78118e-8,-.0097905,-9577e-7,.0034577,.001279,-.0011712,14324e-8],[.0010514,-.032932,51891e-9,.0016518,-.1049,33754e-8,-.0011337,10854e-8,.0013379,-.12017,79532e-8,-.081346,-1296e-7,-.0014491,1059e-7,65171e-8,-.13315,.001209,.065427,-56652e-8,.0010425,-2212e-7,-.0010417,56938e-9,-25425e-8],[.0012794,99963e-9,65467e-8,.001958,23615e-8,-.047728,-.0011378,.0012879,.0015614,37589e-8,.0042213,-20188e-8,-.0013344,-.0012082,.0011919,7824e-7,48081e-8,-.012883,-46896e-8,.072991,54548e-8,-.0020019,-70392e-8,6276e-7,-18862e-8],[.07712,-34151e-8,-32763e-8,.16921,-70456e-8,69349e-9,-.17684,-65083e-8,.16769,-98104e-8,15721e-8,35371e-8,68507e-8,-.10197,-61266e-8,.16632,-.0010921,23327e-8,69117e-8,-86107e-9,.13433,.0010508,-.10026,-33766e-8,.13581],[39676e-8,.0012374,-.042038,66488e-8,.0024503,79998e-8,-57081e-8,-.16485,5864e-7,.0032968,.0018695,-76649e-8,.015281,-88201e-8,-.13727,33578e-8,.0035845,.0028364,-.0011196,-.0012475,80497e-8,.17063,-76093e-8,-.11918,-5248e-8],[-.10433,34436e-8,15666e-8,-.23516,69767e-8,28921e-9,.21847,31705e-8,-.25435,9588e-7,69421e-9,-28729e-8,-33433e-8,.15174,31545e-8,-.2267,.0010619,10757e-8,-51113e-8,-52363e-9,-.096238,-52625e-8,.21063,20975e-8,-.19233],[-30178e-8,40814e-8,.023414,-43206e-8,78453e-8,35814e-8,223e-6,.11772,-27684e-8,99378e-8,80895e-8,-25652e-8,-.11005,17371e-8,-.0039195,-20196e-9,96066e-8,.0011504,-37232e-8,-54321e-8,1126e-8,-.098365,55787e-9,.093704,26963e-8],[.074793,.0019177,-23909e-10,.21074,.0037741,62253e-8,-.093374,3195e-8,.32537,.0049637,.0014372,-.0013877,-74083e-9,-.18444,10552e-8,.19589,.0051284,.0021279,-.0022517,-97008e-8,.10835,-22347e-8,-.15978,18829e-8,.27267]],[[.25276,-28176e-8,-44466e-8,.23765,-55342e-8,11908e-8,-.14703,-91486e-8,.23962,-74835e-8,30165e-8,10422e-8,82233e-8,-.19228,-.0010663,.21816,-82947e-8,51706e-8,65875e-9,-20674e-8,.11967,.0012279,-.1687,-.0011014,.17948],[-41535e-8,.12546,1095e-7,-63558e-8,.076819,-90303e-9,30309e-8,23622e-8,-54197e-8,.1032,-2105e-7,-.027274,-2451e-7,24487e-8,28123e-8,-35021e-8,.11038,-33965e-8,-.043541,83716e-9,30029e-9,-41534e-8,85989e-9,28225e-8,-95256e-9],[-58113e-8,1095e-7,.11038,-92378e-8,23622e-8,-18624e-8,42234e-8,.04565,-90377e-8,36002e-8,-44229e-8,-95328e-9,-.038688,36099e-8,.046627,-8138e-7,46523e-8,-6907e-7,-17824e-8,2869e-7,31447e-9,-.049914,17233e-8,.036557,-67989e-8],[.14132,-36379e-8,-65107e-8,.46047,-70888e-8,20146e-8,-.25841,-.0013441,.42496,-947e-6,50554e-8,12155e-8,.0012052,-.33036,-.0015825,.38127,-.0010296,85711e-8,48334e-9,-34055e-8,.19799,.0018073,-.28047,-.0016631,.30529],[-70468e-8,-.052361,24524e-8,-.0010719,.16753,-14424e-8,49971e-8,52249e-8,-90118e-8,.20487,-33771e-8,-.054155,-53594e-8,37972e-8,6088e-7,-56077e-8,.25226,-55406e-8,-.098985,12104e-8,95459e-9,-89116e-8,10485e-8,59184e-8,-11164e-8],[16442e-8,-12982e-8,-26109e-8,27764e-8,-25494e-8,.0859,-18333e-8,-52526e-8,28392e-8,-35954e-8,.038079,-29316e-10,52919e-8,-2505e-7,-53049e-8,25677e-8,-44216e-8,.043958,-10253e-8,-.017209,17504e-8,80898e-8,-20965e-8,-3725e-7,19908e-8],[-.16379,88912e-9,19612e-8,-.20564,16386e-8,-13263e-8,.21649,40744e-8,-.219,20741e-8,-32717e-8,21755e-9,-32958e-8,.21854,51536e-8,-.21373,21423e-8,-54031e-8,12925e-8,22118e-8,-.14218,-47182e-8,.19357,62042e-8,-.1805],[-.0010891,24524e-8,-.081549,-.0017375,52249e-8,-33272e-8,79218e-8,.10714,-.0017191,78502e-8,-78792e-8,-19759e-8,-.077945,68152e-8,.094342,-.0015789,99872e-8,-.0012239,-35531e-8,51228e-8,56411e-9,-.12712,33334e-8,.097961,-.0013593],[.25846,-17624e-8,-55747e-8,.3158,-3306e-7,19611e-8,-.20761,-.0011614,.4251,-41045e-8,48507e-8,47461e-9,.001056,-.30187,-.0013865,.38002,-38595e-8,81069e-8,-1147e-8,-31262e-8,.19222,.0016179,-.28094,-.0014815,.34372],[-74521e-8,.15765,37423e-8,-.0011199,.098284,-16117e-8,5086e-7,78847e-8,-9082e-7,.25433,-38296e-8,-.05009,-79674e-8,35017e-8,90337e-8,-50357e-8,.30328,-64513e-8,-.1111,1325e-7,16133e-8,-.0012991,47633e-9,85834e-8,2398e-8],[45065e-8,-24271e-8,-55566e-8,74826e-8,-47821e-8,-.099721,-47422e-8,-.0011151,74343e-8,-68471e-8,.049512,-29274e-9,.0011256,-61818e-8,-.0011161,6448e-7,-86609e-8,.060939,-25372e-8,-.024338,39939e-8,.0017163,-49586e-8,-76142e-8,46809e-8],[-51005e-9,-.041712,-11415e-8,-91757e-9,-.027483,-88668e-9,10584e-8,-23355e-8,-83246e-9,-.051463,-21336e-8,.080631,24018e-8,19052e-8,-24434e-8,-46651e-9,-.070524,-32747e-8,.0606,17337e-8,-21012e-8,37945e-8,18009e-8,-18879e-8,10298e-9],[87556e-8,-26047e-8,-.078867,.001396,-55152e-8,33051e-8,-59061e-8,-.01893,.0014058,-81987e-8,78373e-8,21142e-8,.1054,-44583e-8,-.043881,.0013435,-.0010273,.0012196,38013e-8,-51144e-8,-1829e-7,.11603,-16833e-8,-.055965,.0012345],[-.19422,-98994e-9,46959e-10,-.32371,-2185e-7,-16141e-8,.08924,1849e-8,-.31072,-32823e-8,-39114e-8,15436e-8,56124e-9,.26406,10485e-8,-.27361,-40231e-8,-62977e-8,34667e-8,26064e-8,-.16567,12198e-8,.22843,28814e-8,-.228],[-.0010786,29268e-8,.096011,-.0017387,61232e-8,-22083e-8,82578e-8,.012546,-.0017507,90281e-8,-5152e-7,-19936e-8,-.038186,77514e-8,.11051,-.0016452,.0011277,-77807e-8,-32487e-8,33763e-8,-67789e-9,-.097962,44249e-8,.0993,-.001455],[.20364,81143e-9,-43204e-8,.3425,18524e-8,14473e-8,-.22114,-91287e-8,.24484,31758e-8,35168e-8,-36423e-9,86661e-8,-.24537,-.0010981,.33417,48459e-8,57997e-8,-45047e-9,-20675e-8,.1506,.0013828,-.22698,-.0011679,.30702],[-52055e-8,.073002,45752e-8,-75655e-8,.24915,-16941e-8,33123e-8,95539e-8,-54164e-8,.22123,-41328e-8,-.096585,-94805e-8,1774e-7,.0010842,-15814e-8,.33511,-71435e-8,-.13,16871e-8,18532e-8,-.0015168,-57319e-9,.0010217,33234e-8],[8024e-7,-29732e-8,-72008e-8,.0013133,-59377e-8,.11455,-79505e-8,-.0014378,.0012758,-87333e-8,-.010949,-48287e-9,.0014564,-98305e-8,-.0014126,.0010724,-.0011474,.075531,-34045e-8,-.0099532,57053e-8,.0022081,-7505e-7,-90432e-8,74143e-8],[-42043e-8,-.030403,-19319e-8,-67762e-8,-.10004,-26387e-8,47902e-8,-38828e-8,-59004e-8,-.1197,-63081e-8,-.067976,39782e-8,65041e-8,-38694e-8,-36315e-8,-.13511,-9784e-7,.058187,45897e-8,-506e-6,6123e-7,51227e-8,-26242e-8,-41583e-9],[-34122e-8,16811e-9,33001e-8,-55732e-8,25029e-9,-.044369,35211e-8,66244e-8,-52954e-8,47358e-9,.0015492,1204e-7,-67195e-8,44782e-8,66102e-8,-42097e-8,10957e-8,-.01229,33236e-8,.059427,-28339e-8,-.0010273,34599e-8,44584e-8,-25205e-8],[.081858,32311e-8,3279e-7,.17381,66398e-8,1063e-7,-.1764,66498e-8,.17432,93412e-8,24892e-8,-27717e-8,-69455e-8,-.11772,67028e-8,.17375,.001072,37898e-8,-50761e-8,-16467e-8,.13046,-.0010925,-.11256,46328e-8,.14581],[.0010558,-43696e-8,-.034625,.0016946,-91447e-8,41481e-8,-67486e-8,-.14998,.0017626,-.0013398,97981e-8,33096e-8,.021187,-46163e-8,-.13092,.0017829,-.0016498,.0015128,57192e-8,-6435e-7,-33079e-8,.15675,-13896e-8,-.11625,.0017665],[-.11037,-17816e-8,-94945e-9,-.24028,-36954e-8,-72093e-9,.2188,-19029e-8,-.26125,-52802e-8,-1727e-7,15634e-8,21737e-8,.17038,-17052e-8,-.23868,-62143e-8,-27371e-8,29062e-8,1131e-7,-.10797,35024e-8,.21354,-64823e-9,-.20704],[-91442e-8,25483e-8,.018567,-.0014996,52175e-8,55323e-9,79734e-8,.10772,-.0015311,75523e-8,1512e-7,-12357e-8,-.1036,88457e-8,.0042628,-.0014452,93133e-8,29302e-8,-14831e-8,-90688e-9,-34836e-8,-.097142,61696e-8,.083344,-.0012649],[.082637,33001e-8,-31924e-8,.21635,68187e-8,51283e-9,-.10067,-68463e-8,.32636,.0010164,11916e-8,-10474e-8,70262e-8,-.19233,-81089e-8,.21563,.0013192,19457e-8,-43017e-9,-40629e-9,.11634,.0011786,-.17193,-8138e-7,.27475]],[[.2374,49985e-9,-48501e-9,.2364,66211e-9,66793e-8,-.14678,-10908e-8,.2403,-42657e-10,.0016095,-54027e-9,66755e-9,-.19358,-17984e-8,.22189,-1955e-7,.0025947,-87825e-9,-.0010025,.12166,95689e-9,-.1722,-29432e-8,.18679],[14155e-8,.11013,72578e-8,18826e-8,.070788,65739e-9,-15279e-8,.0014768,38822e-9,.097326,15764e-8,-.025654,-.0014458,-17226e-8,.001578,-219e-6,.10643,24392e-8,-.041754,-11985e-8,1196e-7,-.0022169,-84349e-9,.0013174,-53501e-8],[-47168e-9,72578e-8,.09591,-8393e-8,.0014768,63208e-10,32661e-10,.041218,-12852e-8,.0020962,48557e-10,-41298e-8,-.035995,-33465e-9,.043502,-20116e-8,.0024909,-33814e-9,-57725e-8,-38536e-9,88752e-9,-.047565,-41577e-9,.035238,-29082e-8],[.1477,-10964e-9,-89775e-9,.44628,-7761e-8,93646e-8,-.25598,-19954e-8,.42231,-25929e-8,.0022595,-1851e-8,13753e-8,-.33214,-31043e-8,.38643,-5945e-7,.0036508,-26955e-9,-.0014049,.20212,20526e-8,-.28737,-47953e-8,.31814],[1232e-7,-.045378,.0013091,12428e-8,.1497,11686e-8,-14854e-8,.0026671,-13901e-8,.18939,28051e-8,-.049957,-.002607,-15714e-8,.002863,-57309e-8,.23894,43522e-8,-.093392,-21207e-8,13118e-8,-.0040017,-36068e-9,.0024177,-.0010955],[.0013177,93466e-9,26883e-9,.0020749,1893e-7,.072924,-.0011274,4411e-8,.0018676,25786e-8,.032488,-86552e-9,-90846e-9,-.0011811,-2274e-8,.0013641,27958e-8,.039651,-16109e-8,-.015518,4266e-7,-15072e-8,-7309e-7,-17893e-8,67053e-8],[-.1624,-32604e-9,-91872e-10,-.20999,-35826e-9,-40094e-8,.20539,-10493e-9,-.22265,24815e-9,-9672e-7,76022e-10,39394e-9,.21538,36749e-9,-.21831,1689e-7,-.001563,-20236e-9,59966e-8,-.14196,63831e-9,.19481,13924e-8,-.18837],[-11889e-8,.0013091,-.073038,-20745e-8,.0026671,-12471e-9,35755e-9,.092153,-29098e-8,.0037944,-51718e-9,-7438e-7,-.069905,-26597e-9,.084612,-42259e-8,.004525,-1666e-7,-.0010397,-32296e-9,14633e-8,-.1177,-50776e-9,.091044,-58389e-8],[.25704,-26586e-8,-15078e-8,.32469,-58899e-8,60944e-8,-.21112,-32407e-8,.41937,-95945e-8,.0014784,15377e-8,27688e-8,-.30478,-43124e-8,.38131,-.0013736,.0024114,24146e-8,-91383e-8,.19609,43244e-8,-.28644,-5498e-7,.35056],[-19411e-8,.14865,.0015514,-40267e-8,.10139,12224e-8,13952e-8,.0031683,-6922e-7,.23874,29431e-8,-.048778,-.0030885,18077e-8,.0034302,-.0011203,.28648,4589e-7,-.10572,-22256e-8,-25383e-9,-.0047515,22355e-8,.0029557,-.0016115],[.0028023,19604e-8,23624e-9,.0044183,39746e-8,-.088639,-.0023958,21763e-9,.0039954,54289e-8,.039259,-17976e-8,-12463e-8,-.0025112,-1385e-7,.0029519,59185e-8,.050258,-33354e-8,-.020166,90218e-8,-2084e-7,-.0015597,-48307e-8,.0015077],[-60345e-9,-.039237,-15299e-8,-74461e-9,-.027982,-61026e-9,24327e-9,-31259e-8,-16556e-9,-.049984,-14564e-8,.068721,30186e-8,-20909e-9,-34114e-8,72871e-9,-.067994,-22783e-8,.053059,9931e-8,75234e-9,46258e-8,-63299e-9,-3006e-7,17491e-8],[14531e-9,-.0012336,-.07403,41505e-9,-.0025111,-50329e-9,55133e-9,-.022434,13717e-8,-.0035677,-10095e-8,69899e-8,.093083,1244e-7,-.043276,30169e-8,-.0042464,-81399e-9,97384e-8,13196e-8,-18494e-8,.10475,1137e-7,-.053598,50822e-8],[-.1927,28933e-9,-49121e-9,-.32388,89803e-9,-20292e-8,.10279,-92329e-9,-.31648,19333e-8,-49178e-8,-68421e-9,1128e-7,.26204,-57746e-9,-.28385,34135e-8,-80247e-8,-17798e-8,30028e-8,-.16457,17274e-8,.22978,43394e-9,-.24117],[-27041e-8,99298e-8,.090145,-45026e-8,.0020342,-13283e-8,18799e-8,.017784,-51026e-8,.0029223,-34546e-8,-56297e-8,-.037642,16044e-8,.098962,-58082e-8,.0035371,-64208e-8,-79011e-8,17153e-8,33164e-9,-.090708,8677e-8,.089185,-65987e-8],[.20333,-581e-6,-23411e-8,.34495,-.0012155,13604e-8,-.22333,-49346e-8,.26273,-.0018049,34485e-8,35661e-8,46808e-8,-.25502,-59207e-8,.33726,-.0022928,6044e-7,54307e-8,-20419e-8,.15791,74373e-8,-.23563,-63442e-8,.31016],[-79982e-8,.066175,.0014235,-.0013722,.2327,76351e-9,69247e-8,.0029196,-.001596,.22157,18563e-8,-.091767,-.0028333,80749e-8,.0032081,-.0018334,.32683,2933e-7,-.12811,-14257e-8,-31465e-8,-.0043773,66041e-8,.0028591,-.0020561],[.0037409,23062e-8,-94262e-9,.0059123,469e-6,.10603,-.0031955,-23637e-8,.0053925,64381e-8,-.0027747,-21324e-8,93345e-9,-.0033548,-49762e-8,.0040677,70756e-8,.068432,-39792e-8,-.010934,.0011971,14107e-8,-.0020999,-96487e-8,.0022153],[87447e-10,-.027426,90602e-9,41684e-9,-.093025,-97407e-9,-9996e-8,18131e-8,73544e-9,-.11533,-23218e-8,-.056803,-18727e-8,-23204e-8,17693e-8,95111e-9,-.13268,-36527e-8,.052108,15086e-8,29739e-8,-28761e-8,-25662e-8,11065e-8,99207e-9],[-.0015425,-17211e-8,-99033e-9,-.0024306,-34783e-8,-.041083,.0013155,-18587e-8,-.0021953,-47641e-8,-.0013977,14172e-8,25108e-8,.0013741,-96514e-9,-.0016182,-52521e-8,-.013258,25029e-8,.049542,-48693e-8,40101e-8,84871e-8,15264e-8,-82123e-8],[.084997,-61103e-9,99842e-9,.17577,-13652e-8,-20206e-8,-.17312,20188e-8,.17827,-20131e-8,-4846e-7,12441e-8,-19724e-8,-.1287,21222e-8,.17893,-23222e-8,-77256e-8,29363e-8,30848e-8,.12715,-29932e-8,-.12201,17071e-8,.15431],[16694e-9,-.0015392,-.029621,54701e-9,-.0031383,-5836e-8,72159e-9,-.1375,19189e-8,-.0044722,-10933e-8,86864e-8,.027452,15854e-8,-.12571,42647e-8,-.0053484,-56056e-9,.0012079,16148e-8,-23711e-8,.14846,14071e-8,-.11444,72139e-8],[-.11546,83771e-9,-38661e-9,-.24377,18506e-8,25352e-9,.21673,-75814e-9,-.26593,28775e-8,59404e-9,-95164e-9,79906e-9,.18444,-67767e-9,-.24805,37832e-8,89945e-9,-20034e-8,-40765e-9,-.11745,12046e-8,.21648,-27318e-9,-.21979],[-51014e-8,21939e-8,.014907,-8307e-7,47355e-8,-33998e-8,44256e-8,.098137,-83376e-8,74064e-8,-84518e-8,-12414e-8,-.096711,48442e-8,.011531,-77322e-8,.0010057,-.0014301,-18402e-8,5324e-7,-18428e-8,-.09538,33002e-8,.077874,-678e-6],[.091151,-80783e-8,-30383e-8,.22326,-.0016605,-31276e-8,-.10852,-63553e-8,.32773,-.0023928,-73349e-8,49021e-8,629e-6,-.20009,-72759e-8,.23465,-.0029099,-.0011259,72361e-8,46718e-8,.12379,.001007,-.18345,-70653e-8,.28206]],[[.2231,94076e-8,82348e-8,.23411,.0019197,-63238e-8,-.14592,.0017436,.24057,.0027074,-.0015573,-65781e-8,-.0016521,-.19443,.0021163,.22635,.0031593,-.0025895,-.0010767,99446e-8,.12357,-.0026459,-.17593,.0023041,.19631],[.0013673,.095478,-66815e-8,.0021577,.062385,12773e-8,-.0012949,-.0013902,.0018851,.087626,30956e-8,-.023049,.0013742,-.0015058,-.0015675,.0012435,.097884,50736e-8,-.038244,-18416e-8,81219e-8,.0021874,-.0010492,-.0014602,36719e-8],[.0010491,-66815e-8,.082991,.0017171,-.0013902,26992e-8,-90887e-8,.036216,.0017514,-.0020372,64841e-8,43308e-8,-.032334,-.0010044,.039427,.0016654,-.0025272,.0010332,6856e-7,-42244e-8,36714e-8,-.043531,-72888e-8,.03311,.0014988],[.15367,.0012947,.001287,.43417,.0026465,-94796e-8,-.25364,.0027299,.42067,.0037431,-.0023348,-91029e-8,-.0025834,-.33404,.0033307,.39343,.0043875,-.003884,-.0014973,.0014895,.20656,-.0041459,-.29515,.0036578,.33458],[.0024155,-.040895,-.0012921,.0038177,.13003,22835e-8,-.0022947,-.0026885,.0033503,.16891,55536e-8,-.044486,.0026558,-.0026796,-.0030339,.0022374,.21858,91641e-8,-.085181,-32781e-8,.0014568,.0042266,-.0018805,-.0028324,71331e-8],[-.0011781,1829e-7,39834e-8,-.0018981,37347e-8,.061611,.0010757,80752e-8,-.0018064,53669e-8,.026463,-92821e-9,-81621e-8,.0012323,83413e-8,-.0014793,65367e-8,.033591,-11559e-8,-.013066,-57575e-8,-.0012639,8886e-7,63039e-8,-98034e-8],[-.16071,-70683e-8,-57986e-8,-.21401,-.0014469,46557e-8,.19658,-.0012318,-.22708,-.002047,.001146,51512e-8,.0011578,.21362,-.0015146,-.2247,-.0023958,.0019032,86709e-8,-73426e-8,-.14229,.0018563,.19709,-.0016877,-.199],[.0021021,-.0012921,-.065543,.0034478,-.0026885,46867e-8,-.0018231,.078342,.003538,-.0039412,.0011277,83549e-8,-.061136,-.0020211,.074462,.0033993,-.0048925,.0018025,.0013207,-73352e-8,74127e-8,-.10595,-.0014779,.083251,.0031056],[.25695,69216e-8,.001215,.33595,.0014271,-74963e-8,-.21676,.0025886,.41964,.00205,-.0018482,-48928e-8,-.0024461,-.31123,.003195,.38811,.0024639,-.0030821,-81336e-8,.0011729,.20216,-.0039485,-.29527,.0035741,.36243],[.0026784,.13681,-.0016983,.0042462,.098507,27421e-8,-.0025529,-.0035352,.0037642,.21921,67149e-8,-.045911,.0034865,-.0029984,-.0039982,.0025859,.26513,.0011215,-.098422,-39315e-8,.0016419,.0055475,-.0021294,-.0037527,96313e-8],[-.0026941,38239e-8,81402e-8,-.0043408,7833e-7,-.079267,.0024568,.0016524,-.0041336,.0011329,.029244,-19111e-8,-.001668,.0028111,.0017153,-.0033909,.001394,.037897,-2348e-7,-.015152,-.0013075,-.0025863,.0020255,.0013154,-.0022582],[-56557e-8,-.036011,27028e-8,-89952e-8,-.026893,-73682e-10,56544e-8,56153e-8,-79118e-8,-.046861,-18418e-9,.058593,-55875e-8,69384e-8,62794e-8,-52417e-8,-.063835,-35547e-9,.046012,11129e-10,-42789e-8,-89016e-8,51389e-8,57389e-8,-15298e-8],[-.0018986,.0012413,-.067946,-.0031126,.002582,-47536e-8,.0016372,-.023252,-.0031951,.0037813,-.0011429,-80743e-8,.081175,.0018034,-.040968,-.0030743,.0046861,-.0018237,-.001281,74466e-8,-64075e-8,.092351,.0013104,-.050493,-.0028167],[-.19256,-56754e-8,-47469e-8,-.3259,-.0011692,37984e-8,.11659,-.0010148,-.32418,-.0016663,93469e-8,44043e-8,94118e-8,.26429,-.0012765,-.29695,-.0019672,.0015509,77163e-8,-60115e-8,-.16651,.001514,.23518,-.0014782,-.25835],[.0023078,-.001204,.083407,.0038052,-.0025073,28073e-8,-.0020145,.021064,.00396,-.0036835,68208e-8,76946e-8,-.036397,-.0022601,.088957,.0038921,-.0045902,.0011101,.0012075,-43879e-8,85315e-8,-.083456,-.0016891,.080495,.003669],[.20786,-16574e-8,.0010537,.35462,-31196e-8,-391e-6,-.22992,.0022598,.28667,-36985e-8,-96838e-8,12052e-8,-.0021345,-.27048,.0028332,.34908,-29317e-8,-.0016312,18967e-8,60273e-8,.16922,-.0034774,-.2503,.0032452,.32107],[.0020959,.059517,-.0018059,.0033471,.21463,27066e-8,-.0020035,-.0037626,.0030435,.2167,67066e-8,-.086112,.0036996,-.0023744,-.0042745,.0022377,.31601,.0011416,-.12458,-39074e-8,.0013032,.0058863,-.0017264,-.0040548,.0011101],[-.0040089,50864e-8,99198e-8,-.0064611,.0010488,.095754,.0036462,.0020198,-.0061643,.0015352,28526e-8,-25197e-8,-.0020323,.004163,.0021212,-.0050811,.0019236,.058204,-3093e-7,-.0096467,-.0019174,-.0031605,.0029964,.0016811,-.0034263],[-50173e-8,-.024477,22528e-8,-80974e-8,-.085329,61297e-9,54764e-8,46721e-8,-72357e-8,-.10922,14716e-8,-.047295,-47009e-8,72575e-8,51613e-8,-48914e-8,-.12834,22795e-8,.047498,-11177e-8,-52165e-8,-75082e-8,58116e-8,45793e-8,-15227e-8],[.0015931,-18769e-8,-49265e-8,.0025655,-38359e-8,-.036907,-.0014587,-99979e-8,.0024354,-55562e-8,-.0018568,8214e-8,.0010105,-.0016747,-.0010362,.0019828,-6882e-7,-.011326,83407e-9,.040614,79118e-8,.0015672,-.0012085,-79051e-8,.0012963],[.089774,90347e-9,-55354e-9,.18067,19639e-8,-12207e-9,-.17116,-10754e-8,.18521,29274e-8,-28768e-9,-12077e-8,12734e-8,-.14026,-81918e-9,.18706,35797e-8,-42008e-9,-26352e-8,25162e-9,.12701,20121e-8,-.13299,84066e-10,.16552],[-.0027483,.0017417,-.024578,-.004518,.0036231,-58487e-8,.0023669,-.12334,-.0046783,.005307,-.0014095,-.0011324,.029682,.0026113,-.11747,-.0045686,.0065791,-.002259,-.0017961,91668e-8,-918e-6,.13773,.0019123,-.11037,-.0042757],[-.12311,-19066e-8,-21344e-8,-.25182,-39939e-8,11943e-8,.21693,-46028e-8,-.2751,-58209e-8,29466e-8,16345e-8,4199e-7,.2001,-59617e-8,-.26136,-70835e-8,49072e-8,30387e-8,-1902e-7,-.12857,67908e-8,.22412,-72261e-8,-.23627],[.0022109,-69946e-8,.012637,.0036754,-.0014626,-1e-4,-.0019569,.089981,.003902,-.0021693,-22365e-8,42828e-8,-.090715,-.0022437,.018059,.0039532,-.0027469,-30619e-8,65448e-8,15832e-8,89905e-8,-.094565,-.0017344,.074646,.0038746],[.1067,-92034e-8,87377e-8,.24193,-.0018437,30622e-9,-.12365,.0018873,.33951,-.0025035,65633e-9,66869e-8,-.0017865,-.21679,.0024025,.25978,-.0027261,73903e-9,.0011045,-64954e-9,.13654,-.0029427,-.20188,.0028111,.29581]],[[.21133,-47612e-8,-76483e-8,.23289,-.0010025,-17291e-8,-.14566,-.0016019,.24057,-.0014421,-40751e-8,5252e-7,.0015887,-.19535,-.0018383,.22834,-.0016871,-61632e-8,.0010796,29451e-8,.12518,.0025582,-.1785,-.001787,.20075],[-64539e-8,.084493,-22056e-8,-.0010559,.05826,-29775e-8,80754e-8,-4416e-7,-92871e-8,.083272,-71686e-8,-.021894,47585e-8,.0011769,-41547e-8,-56611e-8,.094829,-.001143,-.036999,4746e-7,-98403e-8,74665e-8,.0010305,-21375e-8,-20295e-9],[-.0010488,-22056e-8,.072282,-.0016941,-4416e-7,99269e-9,97497e-8,.032569,-.0016192,-59625e-8,23929e-8,17016e-8,-.029788,.0011399,.03632,-.0013456,-63979e-8,38809e-8,29104e-8,-14393e-8,-56113e-8,-.041002,85234e-8,.031266,-94291e-8],[.15982,-75052e-8,-.0011307,.42405,-.0015747,-21137e-8,-.2515,-.0023769,.41758,-.002256,-49492e-8,80864e-8,.0023497,-.33467,-.0027608,.39538,-.0026264,-73661e-8,.001647,36523e-8,.20955,.0037983,-.29985,-.0027504,.34222],[-.0013317,-.033526,-35546e-8,-.0021695,.11922,-51243e-8,.0016351,-70868e-8,-.001896,.1587,-.0012343,-.041777,77279e-8,.0023521,-65005e-8,-.0011407,.20825,-.0019692,-.081061,81806e-8,-.0019346,.0012123,.0020344,-29104e-8,-16101e-9],[-46093e-8,-45609e-8,15066e-8,-71739e-8,-92772e-8,.052643,45661e-8,3061e-7,-5817e-7,-.0013039,.022544,30472e-8,-29453e-8,54603e-8,32994e-8,-28959e-8,-.0015145,.029984,48265e-8,-.011688,-33394e-8,-44583e-8,37954e-8,28534e-8,10406e-8],[-.15908,6628e-7,5781e-7,-.21748,.0013859,1346e-7,.18938,.0012165,-.23022,.0019893,31865e-8,-6555e-7,-.0012023,.2119,.0014165,-.22812,.0023377,48403e-8,-.0012939,-23494e-8,-.142,-.0019461,.1978,.0014176,-.20443],[-.0019709,-35546e-8,-.057688,-.0031951,-70868e-8,16881e-8,.0018341,.068351,-.0030909,-94685e-8,40826e-8,28146e-8,-.05498,.0021543,.066843,-.0026353,-99374e-8,66718e-8,48701e-8,-24187e-8,-.0010603,-.097323,.0016318,.076348,-.0019512],[.25427,-50579e-8,-86507e-8,.34205,-.0010505,-23963e-9,-.21954,-.0018426,.41602,-.00148,-43235e-9,53623e-8,.0017997,-.31362,-.0022301,.38891,-.0016773,-18685e-9,.001081,56694e-9,.20508,.0029486,-.29917,-.002401,.36609],[-.0017531,.12814,-30577e-8,-.0028408,.10089,-54293e-8,.0021205,-60051e-8,-.0024523,.20996,-.0013089,-.045341,67843e-8,.0030144,-50344e-8,-.0014239,.25473,-.0020906,-.095249,86931e-8,-.002448,.0010604,.0025724,-10029e-8,8546e-8],[-89141e-8,-92725e-8,29947e-8,-.0013834,-.0018869,-.069534,89343e-8,61018e-8,-.0011023,-.0026535,.024121,62182e-8,-58078e-8,.0010767,66798e-8,-50479e-8,-.0030843,.031982,9879e-7,-.012882,-67762e-8,-87799e-8,74947e-8,60089e-8,29856e-8],[8825e-7,-.033763,98602e-9,.0014255,-.027483,90299e-9,-9869e-7,1993e-7,.0012629,-.046368,2185e-7,.050922,-22095e-8,-.0013333,18843e-8,82123e-8,-.062595,35073e-8,.041161,-14621e-8,98582e-8,-35586e-8,-.0010981,95664e-9,17398e-8],[.0019534,41742e-8,-.062684,.0031619,83728e-8,-15186e-8,-.0018182,-.025069,.003043,.0011323,-36544e-8,-33025e-8,.072919,-.0021329,-.040217,.0025657,.0012167,-59404e-8,-57364e-8,21223e-8,.0010525,.084403,-.0016074,-.04829,.0018549],[-.19152,9388e-7,50733e-8,-.32551,.0019553,10352e-8,.1277,.001078,-.3278,.002801,24555e-8,-87583e-8,-.001057,.26527,.0012932,-.30433,.003294,3709e-7,-.0016868,-18949e-8,-.16756,-.0017285,.23831,.0013688,-.26834],[-.0016857,-82335e-9,.076813,-.0027708,-14993e-8,10932e-8,.0015736,.023785,-.0028006,-15579e-8,26998e-8,88473e-9,-.035693,.0018787,.080869,-.002602,-6568e-8,45884e-8,16838e-8,-15289e-8,-92071e-8,-.077902,.0014892,.072932,-.0022558],[.2067,30548e-9,-46622e-8,.35416,83359e-9,2298e-7,-.22996,-.001034,.29894,17354e-8,56818e-8,-14133e-9,9719e-7,-.27684,-.0014039,.3526,31038e-8,95083e-8,-26136e-9,-36539e-8,.17477,.0016585,-.25731,-.0018042,.32558],[-.0016503,.05573,-65069e-9,-.0026537,.20099,-38348e-8,.0019835,-10381e-8,-.0022314,.21443,-92636e-8,-.081616,17571e-8,.0027959,35954e-9,-.0011807,.30914,-.0014834,-.12203,6183e-7,-.0022652,26087e-8,.0023503,36093e-8,33021e-8],[-912e-6,-.0011106,36164e-8,-.0014017,-.0022619,.086998,94003e-8,74235e-8,-.0010555,-.0031842,.0052607,75004e-8,-69341e-8,.0011508,83988e-8,-34368e-8,-.0037062,.054659,.0011984,-.01063,-77288e-8,-.0010504,7977e-7,81388e-8,60624e-8],[.0017541,-.022982,93853e-9,.0028242,-.080029,28742e-9,-.0019067,19189e-8,.0025053,-.10539,71968e-9,-.038419,-22273e-8,-.0025208,18023e-8,.0016511,-.12596,1207e-7,.04509,-51481e-9,.0017913,-37105e-8,-.0020364,83206e-9,40926e-8],[63496e-8,57144e-8,-14922e-8,99076e-8,.0011635,-.033601,-64177e-8,-30211e-8,80419e-8,.0016376,-.0037522,-38505e-8,28066e-8,-78236e-8,-33032e-8,39848e-8,.0019055,-.012399,-6141e-7,.03472,49881e-8,41402e-8,-55703e-8,-30029e-8,-15121e-8],[.093128,-87242e-8,-61593e-9,.18322,-.0018112,-33842e-9,-.16756,-14297e-8,.18909,-.002595,-84342e-9,75645e-8,1319e-7,-.14787,-21403e-8,.19137,-.0030668,-13581e-8,.0014095,71871e-9,.12611,2372e-7,-.1404,-30687e-8,.17207],[.0027055,50172e-8,-.021536,.0044007,.0010036,-16237e-8,-.0025225,-.11218,.0043013,.0013456,-3918e-7,-41346e-8,.03284,-.0029774,-.11063,.0037444,.0014176,-64465e-8,-73249e-8,21496e-8,.0014699,.13109,-.0022811,-.10605,.0028891],[-.12799,59307e-8,27298e-8,-.25539,.0012323,21298e-9,.21407,58934e-8,-.27897,.0017625,49269e-9,-53479e-8,-56841e-8,.20971,74226e-8,-.26837,.0020725,67297e-9,-.0010141,-47214e-9,-.13585,-94388e-8,.2279,85389e-8,-.24599],[-83924e-8,4267e-7,.01034,-.0014573,88864e-8,85013e-10,79067e-8,.080861,-.0017169,.0013037,34866e-9,-28467e-8,-.083143,.0010027,.021161,-.0020124,.0016221,98968e-9,-46028e-8,-10372e-9,-47784e-8,-.09027,9257e-7,.070184,-.002334],[.11331,73778e-8,-11573e-8,.24654,.0015664,4424e-7,-.1298,-32136e-8,.33769,.0023157,.0010807,-70187e-8,24204e-8,-.22182,-66947e-8,.27174,.0028558,.0017624,-.0013773,-72386e-8,.14171,51581e-8,-.21008,-.0012605,.30244]],[[.2013,-18674e-8,-40977e-8,.23228,-36405e-8,-12887e-8,-.14538,-86363e-8,.24148,-49048e-8,-32847e-8,47852e-9,84291e-8,-.19585,-.0010164,.23172,-54677e-8,-57186e-8,-20322e-9,21969e-8,.12593,.0013597,-.18047,-.0010354,.20721],[-34685e-8,.074247,-12402e-8,-52963e-8,.053022,-11328e-8,24391e-8,-26873e-8,-45303e-8,.077015,-2798e-7,-.020187,27216e-8,17805e-8,-33034e-8,-30124e-8,.089348,-46905e-8,-.034663,17518e-8,58015e-9,46286e-8,25227e-9,-35657e-8,-1103e-7],[-56518e-8,-12402e-8,.063414,-92158e-8,-26873e-8,-16614e-8,5149e-7,.030112,-91364e-8,-41569e-8,-40144e-8,10131e-8,-.028067,59636e-8,.034456,-81585e-8,-55177e-8,-64521e-8,18913e-8,26174e-8,-27028e-8,-.039571,45237e-8,.030802,-65099e-8],[.16645,-18996e-8,-62475e-8,.41702,-36177e-8,-21748e-8,-.2499,-.0013182,.41682,-47488e-8,-55163e-8,93801e-10,.0012857,-.33504,-.0015564,.39977,-51448e-8,-95434e-8,-13192e-8,36696e-8,.21131,.0020767,-.3037,-.001595,.35282],[-48854e-8,-.027971,-27695e-8,-73546e-8,.10765,-21335e-8,29933e-8,-59613e-8,-62019e-8,.14623,-52812e-8,-.03838,60197e-8,14364e-8,-72261e-8,-40772e-8,.19465,-88869e-8,-.075419,32984e-8,21816e-8,.0010138,-92838e-9,-76319e-8,-15233e-8],[-19274e-8,-16306e-8,-26262e-8,-32635e-8,-33964e-8,.044952,20421e-8,-53641e-8,-34491e-8,-50029e-8,.018855,10068e-8,5415e-7,27543e-8,-56613e-8,-33669e-8,-6273e-7,.026085,15417e-8,-.010103,-17976e-8,8468e-7,24494e-8,-45008e-8,-30327e-8],[-.15729,-18656e-9,29499e-8,-.22034,-57523e-9,1328e-7,.18318,62294e-8,-.23332,-1101e-7,33455e-8,95352e-9,-60524e-8,.21017,73899e-8,-.23211,-16442e-8,57162e-8,25522e-8,-22574e-8,-.14112,-97716e-8,.19797,76478e-8,-.21093],[-.0011067,-27695e-8,-.049616,-.0018069,-59613e-8,-28507e-8,.0010091,.061858,-.001798,-91415e-8,-68852e-8,21913e-8,-.051156,.0011711,.062563,-.0016168,-.0012009,-.0011065,40113e-8,44745e-8,-53169e-8,-.091774,89277e-8,.072917,-.0013059],[.25342,18418e-9,-53627e-8,.35054,54972e-9,-22123e-8,-.22362,-.001135,.41699,10084e-8,-55633e-8,-96245e-9,.0011063,-.31747,-.0013509,.39398,14244e-8,-95274e-8,-25653e-8,36329e-8,.20789,.0017946,-.30366,-.001404,.37359],[-31771e-8,.11846,-43259e-8,-45526e-8,.099825,-27462e-8,94997e-9,-92479e-8,-36571e-8,.1986,-68226e-8,-.043761,92888e-8,-14762e-8,-.0011064,-23377e-8,.24221,-.001155,-.09074,42505e-8,44933e-8,.0015468,-34813e-8,-.0011454,-10198e-8],[-52766e-8,-35985e-8,-53391e-8,-88478e-8,-75125e-8,-.061078,54501e-8,-.0010901,-91648e-8,-.001111,.019557,22188e-8,.0010984,71679e-8,-.0011509,-86792e-8,-.0014013,.026235,34026e-8,-.01047,-44917e-8,.0017151,61981e-8,-91678e-8,-74874e-8],[-17641e-8,-.031093,11176e-8,-29721e-8,-.026859,30591e-9,23244e-8,23595e-8,-28296e-8,-.044507,76299e-9,.044299,-24297e-8,35478e-8,26887e-8,-21278e-8,-.059933,13076e-8,.036699,-45493e-9,-30536e-8,-4019e-7,33258e-8,25139e-8,-94425e-9],[.0010345,28069e-8,-.058073,.0016884,60314e-8,28698e-8,-94011e-8,-.027436,.0016802,92104e-8,69249e-8,-22702e-8,.066974,-.0010873,-.041114,.001512,.0012018,.0011114,-41929e-8,-44924e-8,48777e-8,.079263,-82579e-8,-.04871,.0012239],[-.19034,-2444e-7,24239e-8,-.32454,-52342e-8,16241e-8,.13709,51388e-8,-.33052,-77718e-8,40516e-8,26508e-8,-49573e-8,.26618,6184e-7,-.31105,-95782e-8,68165e-8,54823e-8,-27416e-8,-.16856,-80239e-8,.24124,65755e-8,-.27829],[-.0011081,-34774e-8,.071494,-.0018156,-74006e-8,-15856e-8,.0010154,.028119,-.0018241,-.0011194,-38273e-8,25426e-8,-.037219,.0011883,.077203,-.0016686,-.0014478,-6159e-7,44309e-8,24492e-8,-5473e-7,-.076816,92024e-8,.070376,-.0013866],[.20913,22496e-8,-37233e-8,.35904,46008e-8,-18722e-8,-.23271,-79276e-8,.31504,64806e-8,-46561e-8,-16837e-8,77334e-8,-.28564,-95727e-8,.36127,75063e-8,-78811e-8,-28733e-8,29339e-8,.18106,.0012658,-.26608,-.0010188,.33465],[84963e-9,.052382,-5571e-7,17865e-8,.18766,-29331e-8,-27621e-8,-.0011836,18806e-8,.20994,-73248e-8,-.076903,.0011801,-56632e-8,-.0014015,13191e-8,.30101,-.0012502,-.11842,45557e-8,65345e-8,.0019428,-62852e-8,-.0014294,43093e-10],[-96754e-8,-51675e-8,-63912e-8,-.0016072,-.001083,.078185,97014e-8,-.0013043,-.0016347,-.0016121,.0079833,31921e-8,.0013094,.0012388,-.0013789,-.0015057,-.0020524,.050354,4924e-7,-.010578,-73444e-8,.0020394,.0010368,-.0011048,-.0012466],[-69394e-8,-.021271,19483e-8,-.0011302,-.074072,35281e-10,76388e-8,4068e-7,-.0010388,-.099936,10649e-9,-.031056,-42128e-8,.0010285,44823e-8,-75137e-8,-.12139,25112e-9,.043023,-12284e-10,-7363e-7,-68809e-8,86357e-8,38901e-8,-31354e-8],[37037e-8,19832e-8,3188e-7,61685e-8,41386e-8,-.030053,-38582e-8,6499e-7,62399e-8,61231e-8,-.0042581,-11967e-8,-65333e-8,-50769e-8,68416e-8,56521e-8,77347e-8,-.011831,-18042e-8,.029331,32482e-8,-.0010165,-43409e-8,54187e-8,45129e-8],[.095555,42337e-8,11436e-9,.18453,8833e-7,-10025e-8,-.16336,21057e-9,.19159,.0012792,-24538e-8,-35687e-8,-27472e-9,-.15337,10234e-9,.19432,.0015399,-39922e-8,-65934e-8,16937e-8,.12543,-4234e-8,-.14617,-19446e-9,.17714],[.0014689,47696e-8,-.020051,.0024015,.0010178,33936e-8,-.0013345,-.10387,.002403,.0015391,81767e-8,-37548e-8,.036416,-.0015459,-.10635,.0021849,.0019836,.0013106,-68114e-8,-52628e-8,69154e-8,.1272,-.0011805,-.10495,.0018007],[-.13246,-27364e-8,10347e-8,-.25866,-57337e-8,93873e-9,.211,22088e-8,-.28239,-83314e-8,23232e-8,24413e-8,-21091e-8,.21733,27205e-8,-.27447,-.001005,38613e-8,464e-6,-15691e-8,-.1418,-34326e-8,.23114,30141e-8,-.25458],[-84761e-8,-35117e-8,.010279,-.001399,-73733e-8,96257e-9,78781e-8,.076047,-.0014315,-.0010985,23238e-8,22525e-8,-.079296,94095e-8,.027346,-.0013499,-.001398,37009e-8,35742e-8,-15889e-8,-45169e-8,-.091108,75352e-8,.070644,-.0011753],[.12401,30104e-8,-18076e-8,.25828,59544e-8,-11157e-8,-.13978,-39045e-8,.34268,80897e-8,-27245e-8,-13805e-8,38381e-8,-.23116,-48559e-8,.2872,90023e-8,-45398e-8,-13681e-8,15649e-8,.14854,64302e-8,-.22059,-53981e-8,.31211]]];function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var F=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.context=t,this.eventsRegistered=!1}var t,n,i;return t=e,(n=[{key:"initialize",value:function(e,t){this.videoPlayer=e,this.audioPlayer=t,this.allBuffersLoaded=!1,this.wasPlaying=!1,this.waitingForPlayback=!1,this.isSeeking=!1,this.videoPlayer.bigPlayButton.hide(),this.videoPlayer.addClass("vjs-seeking"),this.eventsRegistered||this.registerEvents()}},{key:"reset",value:function(){this.unregisterEvents()}},{key:"registerEvents",value:function(){var e=this;this.videoPlayer.bigPlayButton.off("click"),this.videoPlayer.controlBar.playToggle.off("click"),this.videoPlayer.xr().canvasPlayerControls.addEventListener("vrtoggleplay",(function(){e.togglePlay()})),this.videoPlayer.controlBar.playToggle.on("click",(function(){e.togglePlay()})),this.videoPlayer.bigPlayButton.on("click",(function(){e.togglePlay()})),this.audioPlayer.on(r.MediaPlayer.events.CAN_PLAY,this.onAudioCanPlay,this),this.audioPlayer.on(r.MediaPlayer.events.PLAYBACK_WAITING,this.onAudioPlaybackWaiting,this),this.audioPlayer.on(r.MediaPlayer.events.PLAYBACK_SEEKING,this.onAudioPlaybackSeeking,this),this.audioPlayer.on(r.MediaPlayer.events.PLAYBACK_SEEKED,this.onAudioPlaybackSeeked,this),this.videoPlayer.on("canplay",(function(){e.checkReadyStates()})),this.videoPlayer.on("play",(function(){"running"!==e.context.state&&(e.context.resume(),console.log("resuming context")),e.audioPlayer.play()})),this.videoPlayer.on("pause",(function(){e.audioPlayer.pause()})),this.videoPlayer.on("seeking",(function(){e.isSeeking=!0,e.startWaitingRoutine()})),this.videoPlayer.on("seeked",(function(){var t=this.currentTime();e.audioPlayer.getVideoElement().currentTime=t})),this.videoPlayer.on("waiting",(function(){e.startWaitingRoutine()})),this.eventsRegistered=!0}},{key:"unregisterEvents",value:function(){this.eventsRegistered&&(this.videoPlayer.xr().canvasPlayerControls.removeEventListener("vrtoggleplay"),this.videoPlayer.controlBar.playToggle.off("click"),this.videoPlayer.bigPlayButton.off("click"),this.audioPlayer.off(r.MediaPlayer.events.CAN_PLAY,this.onAudioCanPlay,this),this.audioPlayer.off(r.MediaPlayer.events.PLAYBACK_WAITING,this.onAudioPlaybackWaiting,this),this.audioPlayer.off(r.MediaPlayer.events.PLAYBACK_SEEKING,this.onAudioPlaybackSeeking,this),this.videoPlayer.off("canplay"),this.videoPlayer.off("seeking"),this.videoPlayer.off("seeked"),this.videoPlayer.off("waiting"),this.eventsRegistered=!1)}},{key:"onAudioCanPlay",value:function(){this.checkReadyStates()}},{key:"onAudioPlaybackWaiting",value:function(){this.startWaitingRoutine()}},{key:"onAudioPlaybackSeeking",value:function(){this.startWaitingRoutine()}},{key:"onAudioPlaybackSeeked",value:function(){this.audioPlayer.isSeeking()||(this.isSeeking=!1,this.checkReadyStates())}},{key:"startWaitingRoutine",value:function(){this.waitingForPlayback||(this.waitingForPlayback=!0,this.videoPlayer.pause(),this.videoPlayer.addClass("vjs-seeking"),this.audioPlayer.pause())}},{key:"togglePlay",value:function(){this.wasPlaying?(this.videoPlayer.pause(),this.wasPlaying=!1):this.readyForPlayback()&&this.startPlayback()}},{key:"checkReadyStates",value:function(){this.readyForPlayback()&&this.videoPlayer.paused()&&(this.wasPlaying?this.startPlayback():this.videoPlayer.bigPlayButton.show())}},{key:"startPlayback",value:function(){this.wasPlaying=!0,this.waitingForPlayback=!1,this.videoPlayer.play()}},{key:"readyForPlayback",value:function(){return!(!(this.videoPlayer.readyState()>=3&&this.isAudioReady()&&this.allBuffersLoaded)||this.isSeeking||(this.videoPlayer.removeClass("vjs-seeking"),0))}},{key:"isAudioReady",value:function(){return!(this.audioPlayer.getVideoElement().readyState<3)}},{key:"setAllBuffersLoaded",value:function(e){this.allBuffersLoaded=e,this.checkReadyStates()}}])&&k(t.prototype,n),i&&k(t,i),e}();function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.context=t,this.order=n,this.nCh=(n+1)*(n+1),this.buffers=new Array,this.loadCount=0,this.loaded=!1,this.onLoad=i;var a=r.slice(r.length-3,r.length);this.fileExt=a;var o=r.slice(0,r.length-4);switch(this.order){case 1:this.nChGroups=1,this.urls=new Array(this.nChGroups),this.urls[0]=o+"_01-04ch."+a;break;case 2:this.nChGroups=2,this.urls=new Array(this.nChGroups),this.urls[0]=o+"_01-04ch."+a,this.urls[1]=o+"_05-09ch."+a;break;case 3:this.nChGroups=3,this.urls=new Array(this.nChGroups),this.urls[0]=o+"_01-04ch."+a,this.urls[1]=o+"_05-12ch."+a,this.urls[2]=o+"_13-16ch."+a;break;case 4:this.nChGroups=4,this.urls=new Array(this.nChGroups),this.urls[0]=o+"_01-04ch."+a,this.urls[1]=o+"_05-12ch."+a,this.urls[2]=o+"_13-20ch."+a,this.urls[3]=o+"_21-25ch."+a;break;default:console.error("HOASTloader: unsupported Ambisonics order!")}}var t,n,r;return t=e,(n=[{key:"loadBuffers",value:function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer";var r=this;n.onload=function(){r.context.decodeAudioData(n.response,(function(n){n?(r.buffers[t]=n,r.loadCount++,r.loadCount==r.nChGroups&&(r.loaded=!0,r.concatBuffers(),console.log("HOASTloader: all buffers loaded and concatenated"),r.onLoad(r.foaBuffer,r.hoaBuffer))):alert("error decoding file data: "+e)}),(function(t){alert("Browser cannot decode audio data:  "+e+"\n\nError: "+t+"\n\n(If you re using Safari and get a null error, this is most likely due to Apple's shady plan going on to stop the .ogg format from easing web developer's life :)")}))},n.onerror=function(){alert("HOASTloader: XHR error")},n.send()}},{key:"load",value:function(){for(var e=0;e<this.nChGroups;++e)this.loadBuffers(this.urls[e],e)}},{key:"concatBuffers",value:function(){if(this.loaded){var e=this.nCh,t=this.nChGroups;if(this.foaBuffer=this.buffers[0],1!==this.order){for(var n=0,r=1;r<this.nChGroups;++r)n=Math.max(n,this.buffers[r].length);var i=this.buffers[1].sampleRate;this.hoaBuffer=this.context.createBuffer(e-4,n,i);for(var a=1;a<t;a++)for(var o=0;o<this.buffers[a].numberOfChannels;o++)this.hoaBuffer.getChannelData(8*(a-1)+o).set(this.buffers[a].getChannelData(0))}}}}])&&B(t.prototype,n),r&&B(t,r),e}();function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var G=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initialized=!1,this.ctx=t,this.order=n,this.nCh=(n+1)*(n+1),this.decFilters=new Array(this.nCh),this.decFilterNodes=new Array(this.nCh),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(2),this.out.channelCountMode="explicit",this.out.channelCount=1,this.gainMid=this.ctx.createGain(),this.gainSide=this.ctx.createGain(),this.invertSide=this.ctx.createGain(),this.gainMid.gain.value=1,this.gainSide.gain.value=1,this.invertSide.gain.value=-1;for(var r=0;r<this.nCh;r++)this.decFilterNodes[r]=this.ctx.createConvolver(),this.decFilterNodes[r].normalize=!1;this.resetFilters();for(var i=0;i<this.nCh;i++){this.in.connect(this.decFilterNodes[i],i,0);var a=Math.floor(Math.sqrt(i));i-a*a-a>=0?this.decFilterNodes[i].connect(this.gainMid):this.decFilterNodes[i].connect(this.gainSide)}this.gainMid.connect(this.out,0,0),this.gainSide.connect(this.out,0,0),this.gainMid.connect(this.out,0,1),this.gainSide.connect(this.invertSide,0,0),this.invertSide.connect(this.out,0,1),this.initialized=!0}var t,n,r;return t=e,(n=[{key:"updateFilters",value:function(e,t){for(var n=0;n<4;++n)this.decFilters[n]=this.ctx.createBuffer(1,e.length,e.sampleRate),this.decFilters[n].getChannelData(0).set(e.getChannelData(n)),this.decFilterNodes[n].buffer=this.decFilters[n];for(var r=4;r<this.nCh;++r)this.decFilters[r]=this.ctx.createBuffer(1,t.length,t.sampleRate),this.decFilters[r].getChannelData(0).set(t.getChannelData(r-4)),this.decFilterNodes[r].buffer=this.decFilters[r]}},{key:"resetFilters",value:function(){var e=new Array(this.nCh);e.fill(0),e[0]=.5,e[1]=.5/Math.sqrt(3);for(var t=0;t<this.nCh;t++){this.decFilters[t]=this.ctx.createBuffer(1,64,this.ctx.sampleRate);for(var n=0;n<64;n++)this.decFilters[t].getChannelData(0)[n]=0;this.decFilters[t].getChannelData(0)[0]=e[t],this.decFilterNodes[t].buffer=this.decFilters[t]}}}])&&j(t.prototype,n),r&&j(t,r),e}(),H=n(128);function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var z=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ctx=t,this.order=n,this.nCh=(n+1)*(n+1),this.yaw=0,this.pitch=0,this.roll=0,this.rotMtx=D.identity(this.nCh),this.rotMtxNodes=new Array(this.order),this.in=this.ctx.createChannelSplitter(this.nCh),this.out=this.ctx.createChannelMerger(this.nCh);for(var r=1;r<=this.order;r++){for(var i=new Array(2*r+1),a=0;a<2*r+1;a++){i[a]=new Array(2*r+1);for(var o=0;o<2*r+1;o++)i[a][o]=this.ctx.createGain(),i[a][o].gain.value=a==o?1:0}this.rotMtxNodes[r-1]=i}this.in.connect(this.out,0,0);var s=1;for(r=1;r<=this.order;r++){for(a=0;a<2*r+1;a++)for(o=0;o<2*r+1;o++)this.in.connect(this.rotMtxNodes[r-1][a][o],s+o,0),this.rotMtxNodes[r-1][a][o].connect(this.out,0,s+a);s=s+2*r+1}}var t,n,r;return t=e,(n=[{key:"updateRotMtx",value:function(){var e=this.yaw*Math.PI/180,t=this.pitch*Math.PI/180,n=this.roll*Math.PI/180;this.rotMtx=H.getSHrotMtx(H.yawPitchRoll2Rzyx(e,t,n),this.order);for(var r=1,i=1;i<this.order+1;i++){for(var a=0;a<2*i+1;a++)for(var o=0;o<2*i+1;o++)this.rotMtxNodes[i-1][a][o].gain.value=this.rotMtx[r+a][r+o];r=r+2*i+1}}},{key:"updateRotationFromCamera",value:function(e){this.rotMtx=H.getSHrotMtx([[e[10],e[8],e[9]],[e[2],e[0],e[1]],[e[6],e[4],e[5]]],this.order);for(var t=1,n=1;n<this.order+1;n++){for(var r=0;r<2*n+1;r++)for(var i=0;i<2*n+1;i++)this.rotMtxNodes[n-1][r][i].gain.value=this.rotMtx[t+r][t+i];t=t+2*n+1}}}])&&V(t.prototype,n),r&&V(t,r),e}();n(1189),n(1190);function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n}var t,n,r;return t=e,(n=[{key:"toString",value:function(){return"("+this.x+","+this.y+")"}}])&&W(t.prototype,n),r&&W(t,r),e}();function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"HOAST360",(function(){return K})),n.d(t,"Point",(function(){return q}));var K=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.order=0,this.irs="",this.mediaUrl="",this.irUrl="",this.audioPlayer=null,this.sourceNode=null,this.audioSetupComplete=!1,this.videoSetupComplete=!1,this.xrActive=!1,this.context=null,this.rotator=null,this.multiplier=null,this.decoder=null,this.masterGain=0,this.numCh=0,this.videoPlayer=null,this.maxOrder=4,this.opusSupport=!0,this.zoomIndex=1,this.pointer=null;var t=window.AudioContext||window.webkitAudioContext;this.context=new t,console.log(this.context),this.playbackEventHandler=new F(this.context),this.audioElement=new Audio,""===this.audioElement.canPlayType('audio/ogg; codecs="opus"')&&(this.opusSupport=!1),this.sourceNode=this.context.createMediaElementSource(this.audioElement),this.videoPlayer=Object(i.a)("hoast360-player",{html5:{nativeCaptions:!1},liveui:!0,plugins:{httpSourceSelector:{default:"auto"}}})}var t,n,a;return t=e,(n=[{key:"initialize",value:function(e,t,n){if(this._testPoint(),this.opusSupport){this.videoPlayer.xr(),console.log(this.videoPlayer),console.log(this.videoPlayer.xr()),this.audioSetupComplete=!1,this.videoSetupComplete=!1,this.order>this.maxOrder&&console.error("Ambisonic orders greater than 4 not supported!"),this.order=n,this.mediaUrl=e,this.irUrl=t,this._setOrderDependentVariables(),this.videoPlayer.src({type:"application/dash+xml",src:this.mediaUrl+"video.mpd"}),this.audioPlayer=r.MediaPlayer().create(),this.audioPlayer.initialize(this.audioElement),this.audioPlayer.setAutoPlay(!1),this.audioPlayer.attachSource(this.mediaUrl+"audio.mpd");var i=this;this.videoPlayer.xr().on("initialized",(function(){console.log("xr initialized"),i._startSetup(),i.playbackEventHandler.initialize(i.videoPlayer,i.audioPlayer)}))}else this.videoPlayer.error("Error: Your browser does not support the OPUS audio codec. Please use Firefox or Chrome-based browsers.")}},{key:"reset",value:function(){this.opusSupport?(this.playbackEventHandler.reset(),this.videoPlayer.pause(),this._disconnectAudio(),this.videoPlayer.xr().reset(),this.videoPlayer.dash.mediaPlayer.reset(),this.videoPlayer.reset(),this.audioPlayer.reset()):this.videoPlayer.reset()}},{key:"_testPoint",value:function(){this.pointer=new q(3,5),console.log("Trying to execute testPoint"),console.log("Good point: "+this.pointer.toString())}},{key:"_disconnectAudio",value:function(){this.sourceNode.disconnect(),this.rotator.out.disconnect(),this.multiplier.out.disconnect(),this.decoder.out.disconnect(),this.masterGain.disconnect()}},{key:"_startSetup",value:function(){this.audioSetupComplete||this.videoSetupComplete||(this._setupAudio(),this._setupVideo(),this.videoPlayer.trigger("initComplete"))}},{key:"_setupAudio",value:function(){var e=this,t=this;this.rotator=new z(this.context,this.order),console.log(this.rotator),this.multiplier=new L(this.context,4),console.log(this.multiplier),this.decoder=new G(this.context,this.order),console.log(this.decoder),new U(this.context,this.order,this.irs,(function(t,n){e.decoder.updateFilters(t,n),e.playbackEventHandler.setAllBuffersLoaded(!0)})).load(),this.masterGain=this.context.createGain(),this.masterGain.gain.value=1,this.videoPlayer.on("volumechange",(function(){t.masterGain&&(this.muted()?t.masterGain.gain.value=0:t.masterGain.gain.value=this.volume())})),this.sourceNode.channelCount=this.numCh,this.sourceNode.connect(this.rotator.in),this.rotator.out.connect(this.multiplier.in),this.multiplier.out.connect(this.decoder.in),this.decoder.out.connect(this.masterGain),this.masterGain.connect(this.context.destination),this.audioSetupComplete=!0}},{key:"_setupVideo",value:function(){this.videoPlayer.xr().camera.position.x=0,this.videoPlayer.xr().camera.position.y=0,this.videoPlayer.xr().camera.position.z=0,this.videoPlayer.xr().camera.rotation.order="YZX";var e=this.videoPlayer.xr().controls3d;e.orbit.minDistance=-700,e.orbit.maxDistance=200;var t=this;e.orbit.addEventListener("change",(function(){t.xrActive||t.rotator.updateRotationFromCamera(t.videoPlayer.xr().camera.matrixWorld.elements)})),this.videoPlayer.xr().on("xrCameraUpdate",(function(){t.xrActive&&t.rotator.updateRotationFromCamera(this.xrPose.views[0].transform.matrix)})),e.orbit.addEventListener("zoom",(function(){t._updateZoom()})),this.videoPlayer.xr().on("xrSessionActivated",(function(){t.xrActive=!0,t.multiplier.bypass(!0)})),this.videoPlayer.xr().on("xrSessionDeactivated",(function(){t.xrActive=!1,t.multiplier.bypass(!1),t._updateZoom(),t.rotator.updateRotationFromCamera(this.camera.matrixWorld.elements)})),this.videoSetupComplete=!0}},{key:"_updateZoom",value:function(){var e=this.videoPlayer.xr().controls3d.orbit.currentDistance,t=this.videoPlayer.xr().controls3d.orbit.minDistance,n=(t+e)/t;if(n>=1&&n<=2.5){var r=Math.round((n-1)/.1);r!=this.zoomIndex&&(this.multiplier.updateMtx(N[r]),this.zoomIndex=r)}}},{key:"_setOrderDependentVariables",value:function(){var e=window.location,t=e.protocol+"//"+e.host+"/";this.numCh=(this.order+1)*(this.order+1),this.irUrl.includes("://")?this.irs=this.irUrl+"hoast_o"+this.order+".wav":this.irs=t+this.irUrl+"hoast_o"+this.order+".wav"}}])&&Y(t.prototype,n),a&&Y(t,a),e}()},function(e,t,n){"use strict";var r=n(1040),i=n(98),a=n(1041);function o(e,t,n){var r=e;return a(t)?(n=t,"string"==typeof e&&(r={uri:e})):r=i({},t,{uri:e}),r.callback=n,r}function s(e,t,n){return u(t=o(e,t,n))}function u(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,n=function(n,r,i){t||(t=!0,e.callback(n,r,i))};function r(){var e=void 0;if(e=l.response?l.response:l.responseText||function(e){try{if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;if(""===e.responseType&&!t)return e.responseXML}catch(e){}return null}(l),g)try{e=JSON.parse(e)}catch(e){}return e}function i(e){return clearTimeout(c),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,n(e,v)}function a(){if(!u){var t;clearTimeout(c),t=e.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var i=v,a=null;return 0!==t?(i={body:r(),statusCode:t,method:h,headers:{},url:d,rawRequest:l},l.getAllResponseHeaders&&(i.headers=function(e){var t={};return e?(e.trim().split("\n").forEach((function(e){var n=e.indexOf(":"),r=e.slice(0,n).trim().toLowerCase(),i=e.slice(n+1).trim();void 0===t[r]?t[r]=i:Array.isArray(t[r])?t[r].push(i):t[r]=[t[r],i]})),t):t}(l.getAllResponseHeaders()))):a=new Error("Internal XMLHttpRequest Error"),n(a,i,i.body)}}var o,u,l=e.xhr||null;l||(l=e.cors||e.useXDR?new s.XDomainRequest:new s.XMLHttpRequest);var c,d=l.url=e.uri||e.url,h=l.method=e.method||"GET",f=e.body||e.data,p=l.headers=e.headers||{},m=!!e.sync,g=!1,v={body:void 0,headers:{},statusCode:0,method:h,url:d,rawRequest:l};if("json"in e&&!1!==e.json&&(g=!0,p.accept||p.Accept||(p.Accept="application/json"),"GET"!==h&&"HEAD"!==h&&(p["content-type"]||p["Content-Type"]||(p["Content-Type"]="application/json"),f=JSON.stringify(!0===e.json?f:e.json))),l.onreadystatechange=function(){4===l.readyState&&setTimeout(a,0)},l.onload=a,l.onerror=i,l.onprogress=function(){},l.onabort=function(){u=!0},l.ontimeout=i,l.open(h,d,!m,e.username,e.password),m||(l.withCredentials=!!e.withCredentials),!m&&e.timeout>0&&(c=setTimeout((function(){if(!u){u=!0,l.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",i(e)}}),e.timeout)),l.setRequestHeader)for(o in p)p.hasOwnProperty(o)&&l.setRequestHeader(o,p[o]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(l.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(l),l.send(f||null),l}e.exports=s,e.exports.default=s,s.XMLHttpRequest=r.XMLHttpRequest||function(){},s.XDomainRequest="withCredentials"in new s.XMLHttpRequest?s.XMLHttpRequest:r.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],(function(e){s["delete"===e?"del":e]=function(t,n,r){return(n=o(t,n,r)).method=e.toUpperCase(),u(n)}}))},function(e,t,n){var r=n(0),i=e.exports={WebVTT:n(1042),VTTCue:n(1043),VTTRegion:n(1044)};r.vttjs=i,r.WebVTT=i.WebVTT;var a=i.VTTCue,o=i.VTTRegion,s=r.VTTCue,u=r.VTTRegion;i.shim=function(){r.VTTCue=a,r.VTTRegion=o},i.restore=function(){r.VTTCue=s,r.VTTRegion=u},r.VTTCue||i.shim()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>{try{return new DOMException("","UnknownError")}catch(e){return e.name="UnknownError",e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>{if(null===e)return!1;const t=e.length;return t%2!=0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=W(n(174)),i=W(n(9)),a=W(n(33)),o=W(n(36)),s=W(n(878)),u=W(n(880)),l=W(n(137)),c=W(n(952)),d=W(n(958)),h=W(n(970)),f=W(n(971)),p=W(n(131)),m=W(n(140)),g=W(n(130)),v=W(n(972)),y=W(n(974)),_=W(n(975)),b=W(n(183)),E=W(n(187)),T=W(n(976)),S=W(n(188)),w=W(n(977)),A=W(n(17)),x=W(n(35)),M=W(n(16)),C=W(n(18)),R=W(n(143)),I=W(n(2)),O=W(n(144)),D=n(147),P=W(n(978)),L=W(n(982)),N=W(n(987)),k=W(n(999)),F=n(34),B=W(n(1e3)),U=W(n(71)),j=W(n(25)),G=n(54),H=W(n(194)),V=W(n(46)),z=W(n(91));function W(e){return e&&e.__esModule?e:{default:e}}function q(){var e="You must first call initialize() and set a source before calling this method",t="You must first call initialize() and set a valid source and view before calling this method",n="You must first call attachView() to set the video element before calling this method",W="You must first call attachSource() with a valid source before calling this method",q="MediaPlayer not initialized!",Y=this.context,K=(0,M.default)(Y).getInstance(),X=(0,O.default)(Y).getInstance(),Q=(0,A.default)(Y).getInstance({settings:X}),Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,ce=void 0,de=void 0,he=void 0,fe=void 0,pe=void 0,me=void 0,ge=void 0,ve=void 0,ye=void 0,_e=void 0,be=void 0,Ee=void 0,Te=void 0,Se=void 0,we=void 0,Ae=void 0,xe=void 0,Me=void 0;function Ce(){return!!$&&!!Se.getElement()}function Re(){return(0,D.getVersionString)()}function Ie(){if(!re)throw t;return _e.isPaused()}function Oe(e){var t=be.getCurrentDVRInfo();if(!t)return 0;var n=_e.getLiveDelay(),r=t.range.start+e;return r>t.range.end-n&&(r=t.range.end-n),r}function De(e){if(!re)throw t;var n=Fe().currentTime;if(void 0!==e)n=ye.getTimeRelativeToStreamId(n,e);else if(_e.getIsDynamic()){var r=be.getCurrentDVRInfo();n=null===r?0:Pe()-(r.range.end-r.time)}return n}function Pe(){if(!re)throw t;var e=Fe().duration;if(_e.getIsDynamic()){var n,r=be.getCurrentDVRInfo();if(!r)return 0;e=(n=r.range.end-r.range.start)<r.manifestInfo.DVRWindowSize?n:r.manifestInfo.DVRWindowSize}return e}function Le(e){(0,G.checkParameterType)(e,"boolean"),ie=e}function Ne(){pe.restoreDefaultUTCTimingSources()}function ke(){return be}function Fe(){if(!Se.getElement())throw n;return Se.getElement()}function Be(e){if(!te)throw q;Se.setElement(e),e&&(ze(),function(){if(ce)return;var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(Y).create();ce=t.createMetricsReporting({debug:Q,eventBus:K,mediaElement:Fe(),adapter:fe,dashMetrics:be,events:C.default,constants:i.default,metricsConstants:o.default})}}(),function(){if(de)return;var e=dashjs.MssHandler;"function"==typeof e&&(x.default.extend(e.errors),de=e(Y).create({eventBus:K,mediaPlayerModel:pe,dashMetrics:be,manifestModel:Ee,playbackController:_e,streamController:ye,protectionController:le,baseURLController:ge,errHandler:me,events:C.default,constants:i.default,debug:Q,initSegmentType:F.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:B.default,ISOBoxer:U.default,settings:X}))}(),ye&&ye.switchToVideoElement()),re&&He(),Ye()}function Ue(t){if(!ne)throw e;var n=ye.getActiveStreamInfo();return ue.getTracksFor(t,n)}function je(e){if(!te)throw q;"string"==typeof e&&Ae.initialize(e),$=e,(ne||re)&&He(),Ce()&&Ye()}function Ge(){if(!ne)throw e;var t=ye.getActiveStreamInfo();return t?ye.getStreamById(t.id):null}function He(){re=!1,ne=!1,fe.reset(),ye.reset(),_e.reset(),ae.reset(),ue.reset(),we.reset(),le&&(X.get().streaming.keepProtectionMediaKeys?le.stop():(le.reset(),le=null,ze())),Te.reset()}function Ve(){return(0,d.default)(Y).create({debug:Q,errHandler:me,dashMetrics:be,mediaPlayerModel:pe,requestModifier:(0,m.default)(Y).getInstance(),mssHandler:de,settings:X})}function ze(){if(le)return le;var e=dashjs.Protection;if("function"==typeof e){var t=e(Y).create();return C.default.extend(e.events),R.default.extend(e.events,{publicOnly:!0}),x.default.extend(e.errors),ve||(ve=(0,f.default)(Y).getInstance()),le=t.createProtectionSystem({debug:Q,errHandler:me,videoModel:Se,capabilities:ve,eventBus:K,events:C.default,BASE64:B.default,constants:i.default})}return null}function We(){if(!te)throw q;if(he)return he;var e=dashjs.OfflineController;if("function"==typeof e){C.default.extend(e.events),R.default.extend(e.events,{publicOnly:!0}),x.default.extend(e.errors);var t=Ve(),n=(0,H.default)(Y).create();return n.setConfig({manifestModel:Ee,adapter:fe,manifestLoader:t,errHandler:me}),he=e(Y).create({debug:Q,manifestUpdater:n,baseURLController:ge,manifestLoader:t,manifestModel:Ee,mediaPlayerModel:pe,abrController:ae,playbackController:_e,adapter:fe,errHandler:me,dashMetrics:be,timelineConverter:se,schemeLoaderFactory:oe,eventBus:K,events:C.default,errors:x.default,constants:i.default,settings:X,dashConstants:a.default,urlUtils:(0,V.default)(Y).getInstance()})}return null}function qe(e){var t=be.getCurrentDVRInfo();return t?e+(t.manifestInfo.availableFrom.getTime()/1e3+t.range.start):0}function Ye(){var e;he&&he.resetRecords(),!ne&&$&&(ne=!0,J.info("Streaming Initialized"),e=Ve(),ye||(ye=(0,u.default)(Y).getInstance()),ue.setConfig({domStorage:xe}),ye.setConfig({capabilities:ve,manifestLoader:e,manifestModel:Ee,mediaPlayerModel:pe,protectionController:le,adapter:fe,dashMetrics:be,errHandler:me,timelineConverter:se,videoModel:Se,playbackController:_e,abrController:ae,mediaController:ue,textController:we,settings:X,baseURLController:ge}),_e.setConfig({streamController:ye,dashMetrics:be,mediaPlayerModel:pe,adapter:fe,videoModel:Se,timelineConverter:se,uriFragmentModel:Ae,settings:X}),ae.setConfig({streamController:ye,domStorage:xe,mediaPlayerModel:pe,dashMetrics:be,adapter:fe,videoModel:Se,settings:X}),ae.createAbrRulesCollection(),we.setConfig({errHandler:me,manifestModel:Ee,adapter:fe,mediaController:ue,streamController:ye,videoModel:Se}),Te.setConfig({abrController:ae,dashMetrics:be,playbackController:_e}),ye.initialize(ie,ee),Te.initialize(),"string"==typeof $?ye.load($):ye.loadWithManifest($)),!re&&Ce()&&(re=!0,J.info("Playback Initialized"))}return Z={initialize:function(e,t,n){ve||(ve=(0,f.default)(Y).getInstance()),me=(0,h.default)(Y).getInstance(),ve.supportsMediaSource()?te||(te=!0,se=(0,k.default)(Y).getInstance(),ae||(ae=(0,b.default)(Y).getInstance()).setConfig({settings:X}),oe||(oe=(0,E.default)(Y).getInstance()),_e||(_e=(0,s.default)(Y).getInstance()),ue||(ue=(0,l.default)(Y).getInstance()),ye||(ye=(0,u.default)(Y).getInstance()),fe=(0,L.default)(Y).getInstance(),Ee=(0,y.default)(Y).getInstance(),Te=(0,S.default)(Y).getInstance(),be=(0,N.default)(Y).getInstance({settings:X}),we=(0,g.default)(Y).getInstance(),xe=(0,w.default)(Y).getInstance({settings:X}),fe.setConfig({constants:i.default,cea608parser:r.default,errHandler:me,BASE64:B.default}),ge||(ge=(0,c.default)(Y).create()),ge.setConfig({adapter:fe}),(Me=(0,P.default)(Y).getInstance({dashMetrics:be,mediaPlayerModel:pe,errHandler:me,baseURLController:ge,events:C.default,eventBus:K,debug:Q,boxParser:(0,z.default)(Y).getInstance(),requestModifier:(0,m.default)(Y).getInstance(),errors:x.default})).initialize(),Ne(),Le(void 0===n||n),We(),e&&Be(e),t&&je(t),J.info("[dash.js "+Re()+"] MediaPlayer has been initialized")):me.error(new j.default(x.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,x.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(e){e&&(e.capabilities&&(ve=e.capabilities),e.streamController&&(ye=e.streamController),e.playbackController&&(_e=e.playbackController),e.mediaPlayerModel&&(pe=e.mediaPlayerModel),e.abrController&&(ae=e.abrController),e.schemeLoaderFactory&&(oe=e.schemeLoaderFactory),e.mediaController&&(ue=e.mediaController),e.settings&&(X=e.settings))},on:function(e,t,n){K.on(e,t,n)},off:function(e,t,n){K.off(e,t,n)},extend:function(e,t,n){I.default.extend(e,t,n,Y)},attachView:Be,attachSource:je,isReady:Ce,preload:function(){if(Se.getElement()||ne)return!1;if(!$)throw W;Ye()},play:function(){if(!re)throw t;(!ie||Ie()&&re)&&_e.play()},isPaused:Ie,pause:function(){if(!re)throw t;_e.pause()},isSeeking:function(){if(!re)throw t;return _e.isSeeking()},isDynamic:function(){if(!re)throw t;return _e.getIsDynamic()},seek:function(e){if(!re)throw t;if((0,G.checkParameterType)(e,"number"),isNaN(e))throw i.default.BAD_ARGUMENT_ERROR;var n=_e.getIsDynamic()?Oe(e):e;_e.seek(n)},setPlaybackRate:function(e){Fe().playbackRate=e},getPlaybackRate:function(){return Fe().playbackRate},setMute:function(e){(0,G.checkParameterType)(e,"boolean"),Fe().muted=e},isMuted:function(){return Fe().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw i.default.BAD_ARGUMENT_ERROR;Fe().volume=e},getVolume:function(){return Fe().volume},time:De,duration:Pe,timeAsUTC:function(){if(!re)throw t;return De()<0?NaN:qe(De())},durationAsUTC:function(){if(!re)throw t;return qe(Pe())},getActiveStream:Ge,getDVRWindowSize:function(){var e=be.getCurrentDVRInfo();return e?e.manifestInfo.DVRWindowSize:0},getDVRSeekOffset:Oe,convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString())},formatUTC:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:n});return r?o+" "+a:o},getVersion:Re,getDebug:function(){return Q},getBufferLength:function(e){var t=[i.default.VIDEO,i.default.AUDIO,i.default.FRAGMENTED_TEXT];if(e){if(-1!==t.indexOf(e)){var n=ke().getCurrentBufferLevel(e);return n||NaN}return J.warn("getBufferLength requested for invalid type"),NaN}var r=t.map((function(e){return Ue(e).length>0?ke().getCurrentBufferLevel(e):Number.MAX_VALUE})).reduce((function(e,t){return Math.min(e,t)}));return r===Number.MAX_VALUE?NaN:r},getTTMLRenderingDiv:function(){return Se?Se.getTTMLRenderingDiv():null},getVideoElement:Fe,getSource:function(){if(!$)throw W;return $},getCurrentLiveLatency:function(){if(!te)throw q;return re?_e.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(t){if(!ne)throw e;return ae.getTopBitrateInfoFor(t)},setAutoPlay:Le,getAutoPlay:function(){return ie},getDashMetrics:ke,getQualityFor:function(t){if(!ne)throw e;if(t===i.default.IMAGE){var n=Ge();if(!n)return-1;var r=n.getThumbnailController();return r?r.getCurrentTrackIndex():-1}return ae.getQualityFor(t)},setQualityFor:function(t,n){if(!ne)throw e;if(t===i.default.IMAGE){var r=Ge();if(!r)return;var a=r.getThumbnailController();a&&a.setTrackByIndex(n)}ae.setPlaybackQuality(t,ye.getActiveStreamInfo(),n)},updatePortalSize:function(){ae.setElementSize(),ae.setWindowResizeEventCalled(!0)},setTextDefaultLanguage:function(e){J.warn('setTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use setInitialMediaSettingsFor("fragmentedText", { lang: lang }) instead'),void 0===we&&(we=(0,g.default)(Y).getInstance()),we.setTextDefaultLanguage(e)},getTextDefaultLanguage:function(){return J.warn('getTextDefaultLanguage is deprecated and will be removed in version 3.2.0. Please use getInitialMediaSettingsFor("fragmentedText").lang instead'),void 0===we&&(we=(0,g.default)(Y).getInstance()),we.getTextDefaultLanguage()},setTextDefaultEnabled:function(e){void 0===we&&(we=(0,g.default)(Y).getInstance()),we.setTextDefaultEnabled(e)},getTextDefaultEnabled:function(){return void 0===we&&(we=(0,g.default)(Y).getInstance()),we.getTextDefaultEnabled()},enableText:function(e){void 0===we&&(we=(0,g.default)(Y).getInstance()),we.enableText(e)},enableForcedTextStreaming:function(e){void 0===we&&(we=(0,g.default)(Y).getInstance()),we.enableForcedTextStreaming(e)},isTextEnabled:function(){return void 0===we&&(we=(0,g.default)(Y).getInstance()),we.isTextEnabled()},setTextTrack:function(e){if(!re)throw t;void 0===we&&(we=(0,g.default)(Y).getInstance()),we.setTextTrack(e)},getBitrateInfoListFor:function(t){if(!ne)throw e;var n=Ge();return n?n.getBitrateListFor(t):[]},getStreamsFromManifest:function(t){if(!ne)throw e;return fe.getStreamsInfo(t)},getTracksFor:Ue,getTracksForTypeFromManifest:function(t,n,r){if(!ne)throw e;return(r=r||fe.getStreamsInfo(n,1)[0])?fe.getAllMediaInfoForType(r,t,n):[]},getCurrentTrackFor:function(t){if(!ne)throw e;var n=ye.getActiveStreamInfo();return ue.getCurrentTrackFor(t,n)},setInitialMediaSettingsFor:function(e,t){if(!te)throw q;ue.setInitialSettings(e,t),e===i.default.FRAGMENTED_TEXT&&we.setInitialSettings(t)},getInitialMediaSettingsFor:function(e){if(!te)throw q;return ue.getInitialSettings(e)},setCurrentTrack:function(t){if(!ne)throw e;ue.setTrack(t)},getTrackSwitchModeFor:function(e){if(!te)throw q;return ue.getSwitchMode(e)},setTrackSwitchModeFor:function(e,t){if(!te)throw q;ue.setSwitchMode(e,t)},setSelectionModeForInitialTrack:function(e){if(!te)throw q;ue.setSelectionModeForInitialTrack(e)},getSelectionModeForInitialTrack:function(){if(!te)throw q;return ue.getSelectionModeForInitialTrack()},addABRCustomRule:function(e,t,n){pe.addABRCustomRule(e,t,n)},removeABRCustomRule:function(e){pe.removeABRCustomRule(e)},removeAllABRCustomRule:function(){pe.removeABRCustomRule()},getAverageThroughput:function(e){var t=ae.getThroughputHistory();return t?t.getAverageThroughput(e):0},retrieveManifest:function(e,t){var n=Ve(),r=this;K.on(C.default.INTERNAL_MANIFEST_LOADED,(function e(i){i.error?t(null,i.error):t(i.manifest),K.off(C.default.INTERNAL_MANIFEST_LOADED,e,r),n.reset()}),r),Ae.initialize(e),n.load(e)},addUTCTimingSource:function(e,t){pe.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){pe.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){pe.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:Ne,setXHRWithCredentialsForType:function(e,t){pe.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return pe.getXHRWithCredentialsForType(e)},getProtectionController:function(){return ze()},attachProtectionController:function(e){le=e},setProtectionData:function(e){ee=e,ye&&ye.setProtectionData(ee)},displayCaptionsOnTop:function(e){var t=(0,p.default)(Y).getInstance();t.setConfig({videoModel:Se}),t.initialize(),t.setDisplayCConTop(e)},attachTTMLRenderingDiv:function(e){if(!Se.getElement())throw n;Se.setTTMLRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=NaN;return we&&(e=we.getCurrentTrackIdx()),e},provideThumbnail:function(e,t){if("function"==typeof t)if(e<0)t(null);else{var n=_e.getIsDynamic()?Oe(e):e,r=ye.getStreamForTime(n);if(null!==r){var i=r.getThumbnailController();if(i){var a=ye.getTimeRelativeToStreamId(n,r.getId());return i.provide(a,t)}t(null)}else t(null)}},getDashAdapter:function(){return fe},getOfflineController:function(){return We()},getSettings:function(){return X.get()},updateSettings:function(e){X.update(e)},resetSettings:function(){X.reset()},reset:function(){je(null),Be(null),ee=null,le&&(le.reset(),le=null),ce&&(ce.reset(),ce=null),Me.reset(),X.reset(),he&&(he.reset(),he=null)}},J=Q.getLogger(Z),te=!1,re=!1,ne=!1,ie=!0,le=null,he=null,ee=null,fe=null,Me=null,C.default.extend(R.default),pe=(0,_.default)(Y).getInstance(),Se=(0,T.default)(Y).getInstance(),Ae=(0,v.default)(Y).getInstance(),Z}q.__dashjs_factory_name="MediaPlayer";var Y=I.default.getClassFactory(q);Y.events=R.default,Y.errors=x.default,I.default.updateClassFactory(q.__dashjs_factory_name,Y),t.default=Y},function(e,t,n){"use strict";!function(e){var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n)},r=15,i=32,a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},o={17:2,18:4,21:6,22:8,23:10,19:13,20:15},s={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},u={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],c={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},d=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},h=function(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1};h.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var f=function(e,t,n,r,i,a){this.uchar=e||" ",this.penState=new h(t,n,r,i,a)};f.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var p=function(){this.chars=[];for(var e=0;e<i;e++)this.chars.push(new f);this.pos=0,this.currPenState=new h};p.prototype={equals:function(e){for(var t=!0,n=0;n<i;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<i;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<i;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(c.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(c.log("ERROR","Too large cursor position "+this.pos),this.pos=i)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);this.pos>=i?c.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<i;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<i;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var m=function(){this.rows=[];for(var e=0;e<r;e++)this.rows.push(new p);this.currRow=14,this.nrRollUpRows=null,this.reset()};m.prototype={reset:function(){for(var e=0;e<r;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,n=0;n<r;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<r;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<r;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){c.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){c.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var r=e.indent,i=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){c.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null!==this.nrRollUpRows){c.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),c.log("INFO","Rolling up")}else c.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",i=-1,a=0;a<r;a++){var o=this.rows[a].getTextString();o&&(i=a+1,e?t.push("Row "+i+': "'+o+'"'):t.push(o.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};var g=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new m,this.nonDisplayedMemory=new m,this.lastOutputScreen=new m,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};g.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,c.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";c.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(c.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){c.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){c.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){c.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){c.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){c.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){c.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){c.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){c.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){c.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){c.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){c.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(c.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,c.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){c.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}c.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=c.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var v=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new g(1,t),new g(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};v.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,r,i,a=!1;this.lastTime=e,c.setTime(e);for(var o=0;o<t.length;o+=2)if(r=127&t[o],i=127&t[o+1],r>=16&&r<=31&&r===this.lastCmdA&&i===this.lastCmdB)this.lastCmdA=null,this.lastCmdB=null,c.log("DEBUG","Repeated command ("+d([r,i])+") is dropped");else if(0!==r||0!==i){if(c.log("DATA","["+d([t[o],t[o+1]])+"] -> ("+d([r,i])+")"),(n=this.parseCmd(r,i))||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n)if(a=this.parseChars(r,i))if(this.currChNr&&this.currChNr>=0)this.channels[this.currChNr-1].insertChars(a);else c.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,c.log("WARNING","Couldn't parse cleaned data "+d([r,i])+" orig: "+d([t[o],t[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(e,t){var n=null;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&33<=t&&t<=35))return!1;n=20===e||21===e||23===e?1:2;var r=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?r.cc_RCL():33===t?r.cc_BS():34===t?r.cc_AOF():35===t?r.cc_AON():36===t?r.cc_DER():37===t?r.cc_RU(2):38===t?r.cc_RU(3):39===t?r.cc_RU(4):40===t?r.cc_FON():41===t?r.cc_RDC():42===t?r.cc_TR():43===t?r.cc_RTD():44===t?r.cc_EDM():45===t?r.cc_CR():46===t?r.cc_ENM():47===t&&r.cc_EOC():r.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return c.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.insertChars([32]),r.cc_MIDROW(t),c.log("DEBUG","MIDROW ("+d([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var n,r=null;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return!1;n=e<=23?1:2,r=64<=t&&t<=95?1===n?a[e]:s[e]:1===n?o[e]:u[e];var i=this.interpretPAC(r,t);return this.channels[n-1].setPAC(i),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},parseChars:function(e,t){var r=null,i=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),17<=a&&a<=19){var o=t;o=17===a?t+80:18===a?t+112:t+144,c.log("INFO","Special char '"+n(o)+"' in channel "+r),i=[o],this.lastCmdA=e,this.lastCmdB=t}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null);if(i){var s=d(i);c.log("DEBUG","Char codes =  "+s.join(","))}return i},parseBackgroundAttributes:function(e,t){var n,r,i;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=l[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}};e.logger=c,e.PenState=h,e.CaptionScreen=m,e.Cea608Parser=v,e.findCea608Nalus=function(e,t,n){for(var r=0,i=t,a=[],o=function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),a=n.getUint16(r+1),o=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==a&&1195456820==o&&3==s};i<t+n;){if(r=e.getUint32(i),6===(31&e.getUint8(i+4)))for(var s=i+5,u=-1;s<i+4+r-1;){u=0;for(var l=255;255===l;)u+=l=e.getUint8(s),s++;var c=0;for(l=255;255===l;)c+=l=e.getUint8(s),s++;o(u,c,e,s)&&a.push([s,c]),s+=c}i+=r+4}return a},e.extractCea608DataFromRange=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var a=0;a<i;a++){var o=e.getUint8(n),s=4&o,u=3&o;n++;var l=e.getUint8(n);n++;var c=e.getUint8(n);n++,s&&(127&l)+(127&c)!=0&&(0===u?(r[0].push(l),r[0].push(c)):1===u&&(r[1].push(l),r[1].push(c)))}return r}}(t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=y(n(9)),i=y(n(36)),a=y(n(90)),o=y(n(176)),s=y(n(911)),u=y(n(183)),l=y(n(137)),c=y(n(16)),d=y(n(18)),h=y(n(2)),f=y(n(17)),p=y(n(138)),m=y(n(25)),g=y(n(35)),v=n(34);function y(e){return e&&e.__esModule?e:{default:e}}var _=.5,b=.5,E=.01,T="BufferController";function S(e){e=e||{};var t=this.context,n=(0,c.default)(t).getInstance(),h=e.errHandler,y=e.fragmentModel,S=e.representationController,w=e.mediaController,A=e.adapter,x=e.textController,M=e.abrController,C=e.playbackController,R=e.streamInfo,I=e.type,O=e.settings,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0,V=void 0,z=void 0,W=void 0,q=void 0,Y=void 0,K=void 0,X=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0;function ee(e,n){if(!K||!e)return null;var r=e[0];if(B)try{"function"==typeof(G=n&&n[I]?(0,o.default)(t).create(B,r,ae.bind(this),O.get().streaming.useAppendWindowEnd,n[I]):(0,o.default)(t).create(B,r,ae.bind(this),O.get().streaming.useAppendWindowEnd)).getBuffer().initialize&&G.getBuffer().initialize(I,R,e,y)}catch(e){P.fatal("Caught error on create SourceBuffer: "+e),h.error(new m.default(g.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,g.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+I))}else G=(0,s.default)(t).create(ae.bind(this));return Te(this.getRepresentationInfo(L)),G}function te(e){e.chunk.streamId===R.id&&e.chunk.mediaInfo.type===I&&(P.info("Init fragment finished loading saving to",I+"'s init cache"),K.save(e.chunk),P.debug("Append Init fragment",I," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),re(e.chunk))}function ne(e){var t=e.chunk;if(t.streamId===R.id&&t.mediaInfo.type==I)if(J){$=t;var n=G&&G.getAllBufferRanges();n&&n.length>0&&C.getTimeToStreamEnd()>_&&(P.debug("Clearing buffer because track changed - "+(n.end(n.length-1)+.5)),_e([{start:0,end:n.end(n.length-1)+.5,force:!0}]))}else re(t)}function re(e){G.append(e),e.mediaInfo.type===r.default.VIDEO&&Oe(d.default.VIDEO_CHUNK_RECEIVED,{chunk:e})}function ie(e){if(e&&e.length>0)for(var t=0,n=e.length;t<n;t++)P.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",C.getTime())}function ae(e){if(e.error){if(22===e.error.code&&(Y=!0,F=.8*Re(),P.warn("Quota exceeded, Critical Buffer: "+F),F>0)){var t=Math.max(.2*F,1),n=F-t,i={streaming:{bufferToKeep:parseFloat(t.toFixed(5)),bufferAheadToKeep:parseFloat(n.toFixed(5))}};O.update(i)}22!==e.error.code&&Ie()||(P.warn("Clearing playback buffer to overcome quota exceed situation"),Oe(d.default.QUOTA_EXCEEDED,{criticalBufferLevel:F}),le())}else{Y=!1,(z=e.chunk)&&!isNaN(z.index)&&(U=Math.max(z.index,U),me());var a=G.getAllBufferRanges();if(z.segmentType===v.HTTPRequest.MEDIA_SEGMENT_TYPE)ie(a),ce(),function(){if(I!==r.default.AUDIO&&I!==r.default.VIDEO)return;if(isNaN(X))return;var e=C.getTime(),t=fe(X,0);if(e===X&&t)return;var n=S.getCurrentRepresentation().segmentDuration;if(!(t=fe(X,n)))return;Math.abs(e-X)>n?X<=t.end&&(C.seek(Math.max(X,t.start),!1,!0),X=NaN):e<t.start&&(C.seek(t.start,!1,!0),X=NaN)}();else if(J){var o=C.getTime();P.debug("AppendToBuffer seek target should be "+o),Oe(d.default.SEEK_TARGET,{time:o})}z&&Oe(z.endFragment?d.default.BYTES_APPENDED_END_FRAGMENT:d.default.BYTES_APPENDED,{quality:z.quality,startTime:z.start,index:z.index,bufferedRanges:a,mediaType:I})}}function oe(e){e.streamInfo.id==R.id&&e.mediaType===I&&L!==e.newQuality&&(Te(this.getRepresentationInfo(e.newQuality)),L=e.newQuality)}function se(e){X=e.seekTime,N&&(Q=!0,N=!1,j=Number.POSITIVE_INFINITY),I!==r.default.FRAGMENTED_TEXT?le():ce()}function ue(){X=NaN}function le(){G.waitForUpdateEnd((function(){var e=function(){var e=[],t=G.getAllBufferRanges();if(!t||0===t.length)return e;var n=C.getTime(),r=t.end(t.length-1)+b,i=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:E})[0];if(i){var o={start:0,end:i.startTime-_},s=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:i.startTime-i.duration/2,threshold:E})[0];s&&s.startTime!=i.startTime&&(o.end=s.startTime),o.start<o.end&&o.end>t.start(0)&&e.push(o);var u={start:i.startTime+i.duration+_,end:r},l=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:i.startTime+i.duration+_,threshold:E})[0];l&&l.startTime!==i.startTime&&(u.start=l.startTime+l.duration+_),u.start<u.end&&u.start<r&&e.push(u)}else P.debug("getAllRangesWithSafetyFactor - No request found in current time position, removing full buffer 0 -",r),e.push({start:0,end:r});return e}();e&&0!==e.length||ce(),_e(e)}))}function ce(){(!J||I===r.default.FRAGMENTED_TEXT&&x.isTextEnabled())&&pe()}function de(){ge()}function he(){X=NaN,ge()}function fe(e,t){var n=G.getAllBufferRanges(),r=0,i=0,a=null,o=null,s=0,u=void 0,l=void 0,c=isNaN(t)?.15:t;if(null!=n){for(l=0,u=n.length;l<u;l++)if(r=n.start(l),i=n.end(l),null===a)s=Math.abs(r-e),(e>=r&&e<i||s<=c)&&(a=r,o=i);else{if(!((s=r-o)<=c))break;o=i}if(null!==a)return{start:a,end:o}}return null}function pe(){var e,t,n;C&&(e=(isNaN(X)?C.getTime():X)||0,k=null===(n=fe(e,t))?0:n.end-e,Oe(d.default.BUFFER_LEVEL_UPDATED,{bufferLevel:k}),ge())}function me(){U>=j-1&&!N&&void 0===G.discharge&&(N=!0,P.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED"),Oe(d.default.BUFFERING_COMPLETED))}function ge(){I!==r.default.AUDIO&&I!==r.default.VIDEO||(Q&&!N&&k>0&&C&&C.getTimeToStreamEnd()-k<_&&(Q=!1,N=!0,P.debug("checkIfSufficientBuffer trigger BUFFERING_COMPLETED"),Oe(d.default.BUFFERING_COMPLETED)),(!O.get().streaming.lowLatencyEnabled&&k<_||0===k)&&!N?ve(i.default.BUFFER_EMPTY):(N||k>=R.manifestInfo.minBufferTime)&&ve(i.default.BUFFER_LOADED))}function ve(e){V===e||e===i.default.BUFFER_EMPTY&&0===C.getTime()||I===r.default.FRAGMENTED_TEXT&&!x.isTextEnabled()||(V=e,Oe(d.default.BUFFER_LEVEL_STATE_CHANGED,{state:e}),Oe(e===i.default.BUFFER_LOADED?d.default.BUFFER_LOADED:d.default.BUFFER_EMPTY),P.debug(e===i.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function ye(){G&&I!==r.default.FRAGMENTED_TEXT&&(N||_e(function(){var e=[],t=G.getAllBufferRanges();if(!t||0===t.length)return e;var n=C.getTime(),r={start:Math.max(0,n-O.get().streaming.bufferToKeep),end:n+O.get().streaming.bufferAheadToKeep},i=y.getRequests({state:a.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:E})[0];if(i)r.start=Math.min(i.startTime,r.start),r.end=Math.max(i.startTime+i.duration,r.end);else if(0===n&&C.getIsDynamic())return[];if(t.start(0)<=r.start){for(var o={start:0,end:r.start},s=0;s<t.length&&t.end(s)<=r.start;s++)o.end=t.end(s);o.start<o.end&&e.push(o)}if(t.end(t.length-1)>=r.end){var u={start:r.end,end:t.end(t.length-1)+E};u.start<u.end&&e.push(u)}return e}()))}function _e(e){e&&G&&0!==e.length&&(Z.push.apply(Z,e),q||be())}function be(){if(0===Z.length||!G)return P.debug("Nothing to prune, halt pruning"),Z=[],void(q=!1);var e=G.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return P.debug("SourceBuffer is empty (or does not exist), halt pruning"),Z=[],void(q=!1);var t=Z.shift();P.debug("Removing buffer from:",t.start,"to",t.end),q=!0,C.getTime()<t.end&&(N=!1,U=0),G.remove(t.start,t.end,t.force)}function Ee(e){G===e.buffer&&(P.debug("onRemoved buffer from:",e.from,"to",e.to),ie(G.getAllBufferRanges()),0===Z.length&&(q=!1),e.unintended&&(P.warn("Detected unintended removal from:",e.from,"to",e.to,"setting index handler time to",e.from),Oe(d.default.SEEK_TARGET,{time:e.from})),q?be():(J?(J=!1,$&&re($)):pe(),Oe(d.default.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:Ie(),quotaExceeded:Y})))}function Te(e){e&&void 0!==e.MSETimeOffset&&G&&G.updateTimestampOffset&&G.updateTimestampOffset(e.MSETimeOffset)}function Se(e){e.sender.getStreamId()===R.id&&e.sender.getType()===I&&(e.error||Te(e.currentRepresentation))}function we(e){e.request.mediaInfo.streamInfo.id===R.id&&e.request.mediaType===I&&(j=e.request.index,me())}function Ae(e){if(e.newMediaInfo.streamInfo.id===R.id&&e.newMediaInfo.type===I){var t=G&&G.getAllBufferRanges();t&&(P.info("Track change asked"),w.getSwitchMode(I)===l.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&t&&t.length>0&&C.getTimeToStreamEnd()>_&&(N=!1,j=Number.POSITIVE_INFINITY))}}function xe(){++W*(O.get().streaming.wallclockTimeUpdateInterval/1e3)>=O.get().streaming.bufferPruningInterval&&(W=0,ye())}function Me(){ge()}function Ce(e,t){B=e,G&&t&&"function"==typeof G.discharge&&(H=G,ee(t))}function Re(){var e,t=G.getAllBufferRanges(),n=0,r=void 0;if(!t)return n;for(r=0,e=t.length;r<e;r++)n+=t.end(r)-t.start(r);return n}function Ie(){return Re()<F}function Oe(e,t){var r=t||{};r.sender=D,r.mediaType=I,r.streamId=R.id,n.trigger(e,r)}function De(e,t){F=Number.POSITIVE_INFINITY,V=void 0,L=u.default.QUALITY_DEFAULT,j=Number.POSITIVE_INFINITY,U=0,z=null,N=!1,q=!1,Y=!1,Q=!1,k=0,W=0,Z=[],X=NaN,G&&(e||G.abort(),G.reset(t),G=null),J=!1}return D={getBufferControllerType:function(){return T},getRepresentationInfo:function(e){return A.convertDataToRepresentationInfo(S.getRepresentationForQuality(e))},initialize:function(e){Ce(e),L=M.getQualityFor(I),n.on(d.default.DATA_UPDATE_COMPLETED,Se,this),n.on(d.default.INIT_FRAGMENT_LOADED,te,this),n.on(d.default.MEDIA_FRAGMENT_LOADED,ne,this),n.on(d.default.QUALITY_CHANGE_REQUESTED,oe,this),n.on(d.default.STREAM_COMPLETED,we,this),n.on(d.default.PLAYBACK_PLAYING,he,this),n.on(d.default.PLAYBACK_PROGRESS,ce,this),n.on(d.default.PLAYBACK_TIME_UPDATED,ce,this),n.on(d.default.PLAYBACK_RATE_CHANGED,Me,this),n.on(d.default.PLAYBACK_SEEKING,se,this),n.on(d.default.PLAYBACK_SEEKED,ue,this),n.on(d.default.PLAYBACK_STALLED,de,this),n.on(d.default.WALLCLOCK_TIME_UPDATED,xe,this),n.on(d.default.CURRENT_TRACK_CHANGED,Ae,this,c.default.EVENT_PRIORITY_HIGH),n.on(d.default.SOURCEBUFFER_REMOVE_COMPLETED,Ee,this)},createBuffer:ee,dischargePreBuffer:function(){if(G&&H&&"function"==typeof H.discharge){var e=H.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+I+"PreBuffer discharge, adding buffer for:",n=0;n<e.length;n++)t+=" start: "+e.start(n)+", end: "+e.end(n)+";";P.debug(t)}else P.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");for(var r=H.discharge(),i=null,a=0;a<r.length;a++){var o=r[a],s=K.extract(o.streamId,o.representationId);s&&(i!==s&&(G.append(s),i=s),G.append(o))}H.reset(),H=null}},getType:function(){return I},getBuffer:function(){return G},setBuffer:function(e){G=e},getBufferLevel:function(){return k},getRangeAt:fe,setMediaSource:Ce,getMediaSource:function(){return B},appendInitSegment:function(e){var t=K.extract(R.id,e);return!!t&&(P.info("Append Init fragment",I," with representationId:",t.representationId," and quality:",t.quality,", data size:",t.bytes.byteLength),re(t),!0)},replaceBuffer:function(){J=!0},getIsBufferingCompleted:function(){return N},getIsPruningInProgress:function(){return q},reset:function(e,t){n.off(d.default.DATA_UPDATE_COMPLETED,Se,this),n.off(d.default.INIT_FRAGMENT_LOADED,te,this),n.off(d.default.MEDIA_FRAGMENT_LOADED,ne,this),n.off(d.default.QUALITY_CHANGE_REQUESTED,oe,this),n.off(d.default.STREAM_COMPLETED,we,this),n.off(d.default.PLAYBACK_PLAYING,he,this),n.off(d.default.PLAYBACK_PROGRESS,ce,this),n.off(d.default.PLAYBACK_TIME_UPDATED,ce,this),n.off(d.default.PLAYBACK_RATE_CHANGED,Me,this),n.off(d.default.PLAYBACK_SEEKING,se,this),n.off(d.default.PLAYBACK_SEEKED,ue,this),n.off(d.default.PLAYBACK_STALLED,de,this),n.off(d.default.WALLCLOCK_TIME_UPDATED,xe,this),n.off(d.default.CURRENT_TRACK_CHANGED,Ae,this),n.off(d.default.SOURCEBUFFER_REMOVE_COMPLETED,Ee,this),De(e,t)}},P=(0,f.default)(t).getInstance().getLogger(D),K=(0,p.default)(t).getInstance(),De(),D}S.__dashjs_factory_name=T,t.default=h.default.getClassFactory(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(17)),i=c(n(25)),a=c(n(16)),o=c(n(18)),s=c(n(2)),u=c(n(130)),l=c(n(35));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,s,c){var d=this.context,h=(0,a.default)(d).getInstance(),f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=[],_=[],b=n,E=!1!==s;function T(){try{return m.buffered}catch(e){return p.error("getAllBufferRanges exception: "+e.message),null}}function S(){var e=this;if(_.length>0){g=!0;var t=_[0];_.splice(0,1);var n=[],r=function(){var r=T();!function(e,t,n,r){t&&t.length>0&&t.length<n.length&&function(e,t){for(var n=0;n<e.length;n++){var r=Math.round(e.start(n)),i=Math.round(e.end(n));if(i===t.start||r===t.end||t.start>=r&&t.end<=i)return!0}return!1}(t,r)&&h.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:n.end(n.length-2),to:n.start(n.length-1),unintended:!0})}(e,n,r,t),_.length>0?S.call(this):(g=!1,b&&b({chunk:t}))};try{0===t.bytes.length?r.call(this):(n=T(),m.appendBuffer?m.appendBuffer(t.bytes):m.append(t.bytes,t),C(r.bind(this)))}catch(e){p.fatal('SourceBuffer append failed "'+e+'"'),_.length>0?S():g=!1,b&&b({chunk:t,error:new i.default(e.code,e.message)})}}}function w(){if(y.length>0){var e=y.shift();m.updating?C(e):(e(),w())}}function A(){m.updating||w()}function x(){m.updating||w()}function M(){p.error("SourceBufferSink error",t.type)}function C(e){y.push(e),m.updating||w()}return f={getAllBufferRanges:T,getBuffer:function(){return m},append:function(e){e?(_.push(e),g||C(S.bind(this))):b({chunk:e,error:new i.default(l.default.APPEND_ERROR_CODE,l.default.APPEND_ERROR_MESSAGE)})},remove:function(t,n,r){var a=this;C((function(){try{t>=0&&n>t&&(r||"ended"!==e.readyState)&&m.remove(t,n),C((function(){h.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:a,from:t,to:n,unintended:!1})}))}catch(e){h.trigger(o.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:a,from:t,to:n,unintended:!1,error:new i.default(e.code,e.message)})}}))},abort:function(){try{("open"===e.readyState||m.setTextTrack&&"ended"===e.readyState)&&m.abort()}catch(e){p.error('SourceBuffer append abort failed: "'+e+'"')}_=[]},reset:function(t){if(m){if("function"==typeof m.removeEventListener&&(m.removeEventListener("updateend",x,!1),m.removeEventListener("error",M,!1),m.removeEventListener("abort",M,!1)),clearInterval(v),m.appendWindowEnd=1/0,!t){try{m.getClassName&&"TextSourceBuffer"===m.getClassName()||e.removeSourceBuffer(m)}catch(e){p.error("Failed to remove source buffer from media source.")}m=null}g=!1}_=[],b=null},updateTimestampOffset:function(e){m.timestampOffset===e||isNaN(e)||C((function(){m.timestampOffset=e}))},hasDiscontinuitiesAfter:function(e){try{var t=T();if(t&&t.length>1)for(var n=0,r=t.length;n<r;n++)if(n>0&&e<t.start(n)&&t.start(n)>t.end(n-1)+.1)return!0}catch(e){p.error("hasDiscontinuities exception: "+e.message)}return!1},waitForUpdateEnd:C},function(){p=(0,r.default)(d).getInstance().getLogger(f),g=!1;var n=t.codec;try{if(n.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new Error("not really supported");(m=c||e.addSourceBuffer(n)).changeType&&c&&(p.debug("Doing period transition with changeType"),m.changeType(n)),E&&m&&(m.appendWindowEnd=e.duration);if("function"==typeof m.addEventListener)try{m.addEventListener("updateend",x,!1),m.addEventListener("error",M,!1),m.addEventListener("abort",M,!1)}catch(e){v=setInterval(A,50)}else v=setInterval(A,50)}catch(e){if(!t.isText&&-1===n.indexOf('codecs="stpp')&&-1===n.indexOf('codecs="wvtt'))throw e;var i=(0,u.default)(d).getInstance();m=i.getTextSourceBuffer()}}(),f}d.__dashjs_factory_name="SourceBufferSink";var h=s.default.getClassFactory(d);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r},o=n(54);function s(){return{customTimeRangeArray:[],length:0,add:function(e,t){var n=0;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return(0,o.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return(0,o.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}s.__dashjs_factory_name="CustomTimeRanges",t.default=a.default.getClassFactory(s)},function(e,t,n){"use strict";(function(t,r){var i=n(108);e.exports=_;var a,o=n(895);_.ReadableState=y;n(133).EventEmitter;var s=function(e,t){return e.listeners(t).length},u=n(179),l=n(109).Buffer,c=t.Uint8Array||function(){};var d=n(92);d.inherits=n(72);var h=n(896),f=void 0;f=h&&h.debuglog?h.debuglog("stream"):function(){};var p,m=n(897),g=n(180);d.inherits(_,u);var v=["error","close","destroy","pause","resume"];function y(e,t){e=e||{};var r=t instanceof(a=a||n(60));this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,o=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(o||0===o)?o:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=n(136).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function _(e){if(a=a||n(60),!(this instanceof _))return new _(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),u.call(this)}function b(e,t,n,r,i){var a,o=e._readableState;null===t?(o.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,w(e)}(e,o)):(i||(a=function(e,t){var n;r=t,l.isBuffer(r)||r instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(o,t)),a?e.emit("error",a):o.objectMode||t&&t.length>0?("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),r?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):E(e,o,t,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!n?(t=o.decoder.write(t),o.objectMode||0!==t.length?E(e,o,t,!1):x(e,o)):E(e,o,t,!1))):r||(o.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function E(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&w(e)),x(e,t)}Object.defineProperty(_.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),_.prototype.destroy=g.destroy,_.prototype._undestroy=g.undestroy,_.prototype._destroy=function(e,t){this.push(null),t(e)},_.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=""),n=!0),b(this,e,t,!1,n)},_.prototype.unshift=function(e){return b(this,e,null,!0,!1)},_.prototype.isPaused=function(){return!1===this._readableState.flowing},_.prototype.setEncoding=function(e){return p||(p=n(136).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var T=8388608;function S(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=T?e=T:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function w(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(A,e):A(e))}function A(e){f("emit readable"),e.emit("readable"),I(e)}function x(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(M,e,t))}function M(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function C(e){f("readable nexttick read 0"),e.read(0)}function R(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),I(e),t.flowing&&!t.reading&&e.read(0)}function I(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var a=n.data,o=e>a.length?a.length:e;if(o===a.length?i+=a:i+=a.slice(0,e),0===(e-=o)){o===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(o));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=l.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var a=r.data,o=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,o),0===(e-=o)){o===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=a.slice(o));break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function D(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(P,t,e))}function P(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function L(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}_.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?D(this):w(this),null;if(0===(e=S(e,t))&&t.ended)return 0===t.length&&D(this),null;var r,i=t.needReadable;return f("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",i=!0),t.ended||t.reading?f("reading or ended",i=!1):i&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=S(n,t))),null===(r=e>0?O(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&D(this)),null!==r&&this.emit("data",r),r},_.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},_.prototype.pipe=function(e,t){var n=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,f("pipe count=%d opts=%j",a.pipesCount,t);var u=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?c:_;function l(t,r){f("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,f("cleanup"),e.removeListener("close",v),e.removeListener("finish",y),e.removeListener("drain",d),e.removeListener("error",g),e.removeListener("unpipe",l),n.removeListener("end",c),n.removeListener("end",_),n.removeListener("data",m),h=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function c(){f("onend"),e.end()}a.endEmitted?i.nextTick(u):n.once("end",u),e.on("unpipe",l);var d=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,I(e))}}(n);e.on("drain",d);var h=!1;var p=!1;function m(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==L(a.pipes,e))&&!h&&(f("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function g(t){f("onerror",t),_(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function v(){e.removeListener("finish",y),_()}function y(){f("onfinish"),e.removeListener("close",v),_()}function _(){f("unpipe"),n.unpipe(e)}return n.on("data",m),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",g),e.once("close",v),e.once("finish",y),e.emit("pipe",n),a.flowing||(f("pipe resume"),n.resume()),e},_.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,n);return this}var o=L(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},_.prototype.on=function(e,t){var n=u.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&w(this):i.nextTick(C,this))}return n},_.prototype.addListener=_.prototype.on,_.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(R,e,t))}(this,e)),this},_.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},_.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(f("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(f("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<v.length;a++)e.on(v[a],this.emit.bind(this,v[a]));return this._read=function(t){f("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),_._fromList=O}).call(this,n(27),n(107))},function(e,t,n){e.exports=n(133).EventEmitter},function(e,t,n){"use strict";var r=n(108);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,a=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return a||o?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(r.nextTick(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";e.exports=o;var r=n(60),i=n(92);function a(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);r.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush((function(t,n){u(e,t,n)})):u(this,null,null)}function u(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=n(72),i.inherits(o,r),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,(function(e){t(e),n.emit("close")}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=_(n(184)),i=_(n(9)),a=_(n(36)),o=_(n(185)),s=_(n(90)),u=_(n(16)),l=_(n(18)),c=_(n(2)),d=_(n(918)),h=_(n(51)),f=_(n(919)),p=_(n(920)),m=_(n(921)),g=_(n(17)),v=n(34),y=n(54);function _(e){return e&&e.__esModule?e:{default:e}}function b(){var e=this.context,t=(0,g.default)(e).getInstance(),n=(0,u.default)(e).getInstance(),c=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0;function G(){(b=(0,r.default)(e).create({dashMetrics:U,mediaPlayerModel:D,settings:j})).initialize()}function H(){T={},S={},A={},w={},N={},B={},void 0===M&&(M=!1),L=void 0,k=void 0,F=void 0,clearTimeout(x),x=null}function V(e){e.mediaType===i.default.VIDEO&&(L=e.oldQuality,k.push(L,O.getPlaybackQuality()))}function z(e){e.metric!==a.default.HTTP_REQUEST||!e.value||e.value.type!==v.HTTPRequest.MEDIA_SEGMENT_TYPE||e.mediaType!==i.default.AUDIO&&e.mediaType!==i.default.VIDEO||F.push(e.mediaType,e.value,j.get().streaming.abr.useDeadTimeLatency),e.metric!==a.default.BUFFER_LEVEL||e.mediaType!==i.default.AUDIO&&e.mediaType!==i.default.VIDEO||function(e,t){var n=j.get().streaming.abr.ABRStrategy;if(n===i.default.ABR_STRATEGY_BOLA)return void(B[e]=!0);if(n===i.default.ABR_STRATEGY_THROUGHPUT)return void(B[e]=!1);var r=D.getStableBufferTime(),a=r,o=.5*r,s=B[e],u=t>(s?o:a);B[e]=u,u!==s&&(u?_.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+t.toFixed(3)+")."):_.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+t.toFixed(3)+")."))}(e.mediaType,.001*e.value.level)}function W(e,t){return T[t]=T[t]||{},T[t].hasOwnProperty(e)||(T[t][e]=0),function(e,t){if(t!==i.default.VIDEO||!j.get().streaming.abr.limitBitrateByPortal||!w[t])return e;M||te();var n=I.getAdaptationForType(0,t).Representation,r=e;if(C>0&&R>0){for(;r>0&&n[r]&&C<n[r].width&&C-n[r-1].width<n[r].width-C;)r-=1;for(;r<n.length-1&&n[r].width===n[r+1].width;)r+=1}return r}(function(e,t,n){var r=j.get().streaming.abr.maxRepresentationRatio[t];if(isNaN(r)||r>=1||r<0)return e;return Math.min(e,Math.round(n*r))}(function(e,t){var n=e;if(!w[t])return n;var r=Y(t);void 0!==r&&(n=Math.max(e,r));var i=q(t);void 0!==i&&(n=Math.min(n,i));return n}(T[t][e],e),e,T[t][e]),e)}function q(e){var t=function(e){return j.get().streaming.abr.maxBitrate[e]}(e);return t>-1?Z(w[e].getMediaInfo(),t):void 0}function Y(e){var t=function(e){return j.get().streaming.abr.minBitrate[e]}(e);if(t>-1){var n=w[e].getMediaInfo(),r=J(n),i=Z(n,t);return r[i]&&i<r.length-1&&r[i].bitrate<1e3*t&&i++,i}}function K(e,t,n,r){var i=t.id,a=ee(e);(0,y.checkInteger)(n);var o=W(e,i);n!==a&&n>=0&&n<=o&&X(e,a,n,o,r)}function X(e,t,r,i,a){if(e&&w[e]){var o=w[e].getStreamInfo(),s=o?o.id:null;if(j.get().debug.logLevel===g.default.LOG_LEVEL_DEBUG){var u=U.getCurrentBufferLevel(e);_.info("["+e+"] switch from "+t+" to "+r+"/"+i+" (buffer: "+u+") "+(a?JSON.stringify(a):"."))}!function(e,t,n){S[t]=S[t]||{},S[t][e]=n}(e,s,r),n.trigger(l.default.QUALITY_CHANGE_REQUESTED,{mediaType:e,streamInfo:o,oldQuality:t,newQuality:r,reason:a});var c=F.getAverageThroughput(e);isNaN(c)||P.setSavedBitrateSettings(e,c)}}function Q(e,t){A[e].state=t}function Z(e,t,n){var r=e&&e.type?w[e.type].getRepresentationInfo():null;if(j.get().streaming.abr.useDeadTimeLatency&&n&&r&&r.fragmentDuration){n/=1e3;var i=r.fragmentDuration;if(n>i)return 0;t*=1-n/i}for(var a=J(e),o=a.length-1;o>=0;o--){if(1e3*t>=a[o].bitrate)return o}return 0}function J(e){var t=[];if(!e||!e.bitrateList)return t;for(var n=e.bitrateList,r=e.type,i=void 0,a=0,s=n.length;a<s;a++)(i=new o.default).mediaType=r,i.qualityIndex=a,i.bitrate=n[a].bandwidth,i.width=n[a].width,i.height=n[a].height,i.scanType=n[a].scanType,t.push(i);return t}function $(e){return B[e]}function ee(e){if(e&&w[e]){var t=w[e].getStreamInfo(),n=t?t.id:null;if(n)return S[n]=S[n]||{},S[n].hasOwnProperty(e)||(S[n][e]=0),S[n][e]}return 0}function te(){if(O){var e=j.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;C=O.getClientWidth()*e,R=O.getClientHeight()*e}}function ne(t){var n=t.request.mediaType;if(j.get().streaming.abr.autoSwitchBitrate[n]){var r=w[n];if(!r)return;var i=(0,d.default)(e).create({abrController:c,streamProcessor:r,currentRequest:t.request,useBufferOccupancyABR:$(n)}),o=b.shouldAbandonFragment(i);if(o.quality>h.default.NO_CHANGE){var u=r.getFragmentModel();u.getRequests({state:s.default.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(u.abortRequests(),Q(n,a.default.ABANDON_LOAD),N[n].reset(),N[n].push({oldValue:ee(n),newValue:o.quality,confidence:1,reason:o.reason}),K(n,E.getActiveStreamInfo(),o.quality,o.reason),clearTimeout(x),x=setTimeout((function(){Q(n,a.default.ALLOW_LOAD),x=null}),j.get().streaming.abandonLoadTimeout))}}}return c={isPlayingAtTopQuality:function(e){var t=e?e.id:null,n=ee(i.default.AUDIO),r=ee(i.default.VIDEO);return n===W(i.default.AUDIO,t)&&r===W(i.default.VIDEO,t)},updateTopQualityIndex:function(e){if(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return function(e,t,n){T[t]=T[t]||{},T[t][e]=n}(t,n,r),r}},getThroughputHistory:function(){return F},getBitrateList:J,getQualityForBitrate:Z,getTopBitrateInfoFor:function(e){if(e&&w&&w[e]){var t=w[e].getStreamInfo();if(t&&t.id){var n=W(e,t.id),r=J(w[e].getMediaInfo());return r[n]?r[n]:null}}return null},getMaxAllowedIndexFor:q,getMinAllowedIndexFor:Y,getInitialBitrateFor:function(e){if(function(){if(!P||!P.hasOwnProperty("getSavedBitrateSettings"))throw new Error(i.default.MISSING_CONFIG_ERROR)}(),e===i.default.TEXT||e===i.default.FRAGMENTED_TEXT)return NaN;var t=P.getSavedBitrateSettings(e),n=j.get().streaming.abr.initialBitrate[e],r=j.get().streaming.abr.initialRepresentationRatio[e];if(-1===n)if(r>-1){var a=I.getAdaptationForType(0,e).Representation;if(Array.isArray(a))n=a[Math.max(Math.round(a.length*r)-1,0)].bandwidth;else n=0}else n=isNaN(t)?e===i.default.VIDEO?1e3:100:t;return n},getQualityFor:ee,getAbandonmentStateFor:function(e){return A[e]?A[e].state:null},setPlaybackQuality:K,checkPlaybackQuality:function(t){if(t&&w&&w[t]){var n=w[t].getStreamInfo(),r=n?n.id:null,i=ee(t),o=(0,d.default)(e).create({abrController:c,streamProcessor:w[t],currentValue:i,switchHistory:N[t],droppedFramesHistory:k,useBufferOccupancyABR:$(t)});if(k){var s=O.getPlaybackQuality();s&&k.push(L,s)}if(j.get().streaming.abr.autoSwitchBitrate[t]){var u=Y(t),l=W(t,r),f=b.getMaxQuality(o),p=f.quality;if(void 0!==u&&(p>h.default.NO_CHANGE?p:i)<u&&(p=u),p>l&&(p=l),N[t].push({oldValue:i,newValue:p}),p>h.default.NO_CHANGE&&p!=i)(A[t].state===a.default.ALLOW_LOAD||p>i)&&X(t,i,p,l,f.reason);else if(j.get().debug.logLevel===g.default.LOG_LEVEL_DEBUG){var m=U.getCurrentBufferLevel(t);_.debug("["+t+"] stay on "+i+"/"+l+" (buffer: "+m+")")}}}},getTopQualityIndexFor:W,setElementSize:te,setWindowResizeEventCalled:function(e){M=e},createAbrRulesCollection:G,registerStreamType:function(t,r){N[t]=N[t]||(0,f.default)(e).create(),w[t]=r,A[t]=A[t]||{},A[t].state=a.default.ALLOW_LOAD,B[t]=!1,n.on(l.default.LOADING_PROGRESS,ne,this),t==i.default.VIDEO&&(n.on(l.default.QUALITY_CHANGE_RENDERED,V,this),k=k||(0,p.default)(e).create(),te()),n.on(l.default.METRIC_ADDED,z,this),n.on(l.default.PERIOD_SWITCH_COMPLETED,G,this),F=F||(0,m.default)(e).create({settings:j})},unRegisterStreamType:function(e){delete w[e]},setConfig:function(e){e&&(e.streamController&&(E=e.streamController),e.domStorage&&(P=e.domStorage),e.mediaPlayerModel&&(D=e.mediaPlayerModel),e.dashMetrics&&(U=e.dashMetrics),e.adapter&&(I=e.adapter),e.videoModel&&(O=e.videoModel),e.settings&&(j=e.settings))},reset:function(){H(),n.off(l.default.LOADING_PROGRESS,ne,this),n.off(l.default.QUALITY_CHANGE_RENDERED,V,this),n.off(l.default.METRIC_ADDED,z,this),n.off(l.default.PERIOD_SWITCH_COMPLETED,G,this),b&&b.reset()}},_=t.getLogger(c),H(),c}b.__dashjs_factory_name="AbrController";var E=c.default.getSingletonFactory(b);E.QUALITY_DEFAULT=0,c.default.updateSingletonFactory(b.__dashjs_factory_name,E),t.default=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(912)),i=d(n(913)),a=d(n(914)),o=d(n(915)),s=d(n(916)),u=d(n(917)),l=d(n(2)),c=d(n(51));function d(e){return e&&e.__esModule?e:{default:e}}var h="qualitySwitchRules",f="abandonFragmentRules";function p(e){e=e||{};var t=this.context,n=e.mediaPlayerModel,l=e.dashMetrics,d=e.settings,p=void 0,m=void 0;function g(e){return e.filter((function(e){return e.quality>c.default.NO_CHANGE}))}function v(e){var n,r={},i=void 0,a=void 0,o=void 0,s=void 0;if(0!==e.length){for(r[c.default.PRIORITY.STRONG]=c.default.NO_CHANGE,r[c.default.PRIORITY.WEAK]=c.default.NO_CHANGE,r[c.default.PRIORITY.DEFAULT]=c.default.NO_CHANGE,i=0,n=e.length;i<n;i+=1)(a=e[i]).quality!==c.default.NO_CHANGE&&(r[a.priority]=r[a.priority]>c.default.NO_CHANGE?Math.min(r[a.priority],a.quality):a.quality);return r[c.default.PRIORITY.WEAK]!==c.default.NO_CHANGE&&(o=r[c.default.PRIORITY.WEAK]),r[c.default.PRIORITY.DEFAULT]!==c.default.NO_CHANGE&&(o=r[c.default.PRIORITY.DEFAULT]),r[c.default.PRIORITY.STRONG]!==c.default.NO_CHANGE&&(o=r[c.default.PRIORITY.STRONG]),o!==c.default.NO_CHANGE&&(s=o),(0,c.default)(t).create(s)}}return{initialize:function(){p=[],m=[],d.get().streaming.abr.useDefaultABRRules&&(p.push((0,u.default)(t).create({dashMetrics:l,mediaPlayerModel:n,settings:d})),p.push((0,r.default)(t).create({dashMetrics:l})),p.push((0,i.default)(t).create({dashMetrics:l})),p.push((0,s.default)(t).create()),p.push((0,o.default)(t).create()),m.push((0,a.default)(t).create({dashMetrics:l,mediaPlayerModel:n,settings:d}))),n.getABRCustomRules().forEach((function(e){e.type===h&&p.push(e.rule(t).create()),e.type===f&&m.push(e.rule(t).create())}))},reset:function(){[p,m].forEach((function(e){e&&e.length&&e.forEach((function(e){return e.reset&&e.reset()}))})),p=[],m=[]},getMaxQuality:function(e){return v(g(p.map((function(t){return t.getMaxIndex(e)}))))||(0,c.default)(t).create()},shouldAbandonFragment:function(e){return v(g(m.map((function(t){return t.shouldAbandon(e)}))))||(0,c.default)(t).create()}}}p.__dashjs_factory_name="ABRRulesCollection";var m=l.default.getClassFactory(p);m.QUALITY_SWITCH_RULES=h,m.ABANDON_FRAGMENT_RULES=f,l.default.updateSingletonFactory(p.__dashjs_factory_name,m),t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(59)),i=n(34),a=u(n(2)),o=n(73),s=u(n(928));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var t=this.context,n=e.eventBus,a=e.events,u=e.debug,l=e.dashConstants,c=e.urlUtils,d=e.type,h=e.streamInfo,f=e.timelineConverter,p=e.dashMetrics,m=e.baseURLController,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0;function x(){return d}function M(){y=-1,_=null}function C(){M(),E=0,b=null,A=null,w=null}function R(e,t,n){var r=m.resolve(n.path),i=void 0,a=void 0;return r&&t!==r.url&&c.isRelative(t)?(i=r.url,a=r.serviceLocation,t&&(i=c.resolve(t,i))):i=t,!c.isRelative(i)&&(e.url=i,e.serviceLocation=a,!0)}function I(e){var t,r,i;e.sender.getType()===x()&&(t=e.representation,r=t.hasInitialization(),i=t.hasSegments(),r&&i?n.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{sender:g,representation:t}):A.update(t,x(),w,r,i))}function O(e,t){if(null==t)return null;var n=new r.default,a=t.representation,s=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].bandwidth,u=t.media;return u=(0,o.replaceTokenForTemplate)(u,"Number",t.replacementNumber),u=(0,o.replaceTokenForTemplate)(u,"Time",t.replacementTime),u=(0,o.replaceTokenForTemplate)(u,"Bandwidth",s),u=(0,o.replaceIDForTemplate)(u,a.id),u=(0,o.unescapeDollarsInTemplate)(u),n.mediaType=x(),n.type=i.HTTPRequest.MEDIA_SEGMENT_TYPE,n.range=t.mediaRange,n.startTime=t.presentationStartTime,n.duration=t.duration,n.timescale=a.timescale,n.availabilityStartTime=t.availabilityStartTime,n.availabilityEndTime=t.availabilityEndTime,n.wallStartTime=t.wallStartTime,n.quality=a.index,n.index=t.availabilityIdx,n.mediaInfo=e,n.adaptationIndex=a.adaptation.index,n.representationId=a.id,R(n,u,a)?n:void 0}function D(e){var t=!1;if(!e)return t;if(T){if(S)t=!0;else if(_){var n=parseFloat((_.presentationStartTime-e.adaptation.period.start).toFixed(5));t=(_.duration>0?n+1.5*_.duration:n)>=e.adaptation.period.duration}}else y>=e.availableSegmentsNumber&&(t=!0);return t}function P(e){var t=e.representation;t.segments&&n.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{sender:this,representation:t})}function L(e){if(!e.error&&x()===e.mediaType){var t,r=e.segments,i=e.representation,s=[],u=0,l=void 0,c=void 0,d=void 0;for(l=0,t=r?r.length:0;l<t;l++)c=r[l],(d=(0,o.getTimeBasedSegment)(f,T,i,c.startTime,c.duration,c.timescale,c.media,c.mediaRange,u))&&(s.push(d),d=null,u++);if(s.length>0)if(i.segmentAvailabilityRange={start:s[0].presentationStartTime,end:s[s.length-1].presentationStartTime},i.availableSegmentsNumber=s.length,i.segments=s,T)!function(e){f.setExpectedLiveEdge(e),p.updateManifestUpdateInfo({presentationStartTime:e})}(s[s.length-1].presentationStartTime-8);i.hasInitialization()&&n.trigger(a.REPRESENTATION_UPDATE_COMPLETED,{sender:this,representation:i})}}function N(){v.debug("Dynamic stream complete"),S=!0}return g={initialize:function(e){T=e,S=!1,A.initialize(e)},getType:x,getStreamInfo:function(){return h},getInitRequest:function(e,t){return t?function(e,t,n){var a=new r.default,s=t.adaptation.period,u=s.start;if(a.mediaType=n,a.type=i.HTTPRequest.INIT_SEGMENT_TYPE,a.range=t.range,a.availabilityStartTime=f.calcAvailabilityStartTimeFromPresentationTime(u,s.mpd,T),a.availabilityEndTime=f.calcAvailabilityEndTimeFromPresentationTime(u+s.duration,s.mpd,T),a.quality=t.index,a.mediaInfo=e,a.representationId=t.id,R(a,t.initialization,t))return a.url=(0,o.replaceTokenForTemplate)(a.url,"Bandwidth",t.bandwidth),a}(e,t,x()):null},getRequestForSegment:O,getSegmentRequestForTime:function(e,t,n,i){var a=null;if(!t||!t.segmentInfoType)return a;var o=y,s=!!i&&i.keepIdx,u=!(!i||!i.ignoreIsFinished);b!==n&&(b=n,v.debug("Getting the request for time : "+n));var c=A.getSegmentByTime(t,n);return c?(y=c.availabilityIdx,_=c,v.debug("Index for time "+n+" is "+y),a=O(e,c)):!u&&D(t)&&((a=new r.default).action=r.default.ACTION_COMPLETE,a.index=y-1,a.mediaType=d,a.mediaInfo=e,v.debug("Signal complete in getSegmentRequestForTime")),s&&o>=0&&(y=t.segmentInfoType===l.SEGMENT_TIMELINE&&T?y:o),a},getNextSegmentRequest:function(e,t){var n=null;if(!t||!t.segmentInfoType)return null;b=null;var i=y+1;v.debug("Getting the next request at index: "+i);var a=A.getSegmentByIndex(t,i,_?_.mediaStartTime:-1);return a||!function(e){return!isFinite(e.adaptation.period.duration)}(t)||S?(a?(n=O(e,a),y=a.availabilityIdx):y=T?i-1:i,a?_=a:D(t)&&((n=new r.default).action=r.default.ACTION_COMPLETE,n.index=y-1,n.mediaType=x(),n.mediaInfo=e,v.debug("Signal complete")),n):(v.debug("No segment found at index: "+i+". Wait for next loop"),null)},setCurrentTime:function(e){E=e},getCurrentTime:function(){return E},setCurrentIndex:function(e){y=e},getCurrentIndex:function(){return y},isMediaFinished:D,reset:function(){C(),n.off(a.INITIALIZATION_LOADED,P,g),n.off(a.SEGMENTS_LOADED,L,g),n.off(a.REPRESENTATION_UPDATE_STARTED,I,g),n.off(a.DYNAMIC_STREAM_COMPLETED,N,g)},resetIndex:M,setMimeType:function(e){w=e}},v=u.getLogger(g),C(),A=(0,s.default)(t).create(e),n.on(a.INITIALIZATION_LOADED,P,g),n.on(a.SEGMENTS_LOADED,L,g),n.on(a.REPRESENTATION_UPDATE_STARTED,I,g),n.on(a.DYNAMIC_STREAM_COMPLETED,N,g),g}l.__dashjs_factory_name="DashHandler",t.default=a.default.getClassFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(937));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0;function t(){e={}}function n(){t()}return n(),{getLoader:function(t){for(var n in e)if(e.hasOwnProperty(n)&&t.startsWith(n))return e[n];return i.default},registerLoader:function(t,n){e[t]=n},unregisterLoader:function(t){e[t]&&delete e[t]},unregisterAllLoader:t,reset:n}}o.__dashjs_factory_name="SchemeLoaderFactory";var s=r.default.getSingletonFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(16)),i=h(n(143)),a=h(n(2)),o=h(n(17)),s=h(n(144)),u=n(34),l=h(n(146)),c=h(n(145)),d=n(147);function h(e){return e&&e.__esModule?e:{default:e}}var f="dash.js-v"+(0,d.getVersionString)(),p=null,m=1,g=2,v=3,y=4,_="m",b="a",E="v",T="i",S="c",w="d",A="s",x="v",M="l";function C(){var e=void 0,t=void 0,n=void 0,a=void 0,d=void 0,h=void 0,C=this.context,R=(0,r.default)(C).getInstance(),I=(0,s.default)(C).getInstance();function O(){n={pr:1,nor:null,st:null,sf:null,sid:""+c.default.generateUuid(),bs:{audio:m,video:m},cid:null,did:""+f}}function D(){var e={v:1};return e.sid=I.get().streaming.cmcd.sid?I.get().streaming.cmcd.sid:n.sid,e.cid=I.get().streaming.cmcd.cid?I.get().streaming.cmcd.cid:n.cid,e.did=I.get().streaming.cmcd.did?I.get().streaming.cmcd.did:n.did,e.sid='"'+e.sid+'"',e.cid='"'+e.cid+'"',e.did='"'+e.did+'"',isNaN(n.pr)||1===n.pr||null===n.pr||(e.pr=n.pr),n.st&&(e.st=n.st),n.sf&&(e.sf=n.sf),e}function P(e){try{n.pr=e.playbackRate}catch(e){}}function L(t){try{var r=e.getIsDynamic(t.data)?""+M:""+x,i=t.protocol&&"MSS"===t.protocol?""+A:""+w;n.st=""+r,n.sf=""+i}catch(e){}}function N(e){try{if(e.state&&e.mediaType){var t=null;switch(e.state){case i.default.BUFFER_LOADED:t=p;break;case i.default.BUFFER_EMPTY:h.isSeeking()&&(t=g),t=y}n.bs[e.mediaType]=t}}catch(e){}}return t={getQueryParameter:function(e){try{return I.get().streaming.cmcd&&I.get().streaming.cmcd.enabled?{key:"Common-Media-Client-Data",value:function(e){try{if(!e)return null;var t=Object.keys(e),n=t.length;return t.reduce((function(t,r,i){return t+=r+"="+e[r],i<n-1&&(t+=","),t}),"")}catch(e){return null}}(function(e){try{var t=null;return e.type===u.HTTPRequest.MPD_TYPE?(function(e){try{n.cid=""+c.default.generateHashCode(e.url)}catch(e){}}(e),(r=D()).ot=""+_,r):e.type===u.HTTPRequest.MEDIA_SEGMENT_TYPE?function(e){var t=D(),r=function(e){try{var t=e.quality,n=e.mediaInfo.bitrateList;return parseInt(n[t].bandwidth/1e3)}catch(e){return null}}(e),i=function(e){try{return isNaN(e.duration)?null:Math.round(1e3*e.duration)}catch(e){return null}}(e),o="video"===e.mediaType?""+E:"audio"===e.mediaType?""+b:"fragmentedText"===e.mediaType?""+S:null,s=function(e){try{return Math.round(a.getThroughputHistory().getSafeAverageThroughput(e))}catch(e){return null}}(e.mediaType),u=function(e){try{var t=n.pr,r=d.getCurrentBufferLevel(e);return isNaN(t)||isNaN(r)?null:parseInt(r/t*1e3)}catch(e){return null}}(e.mediaType),l=function(e){try{var t=e.mediaType;return null!==n.bs[t]?n.bs[t]:d.getCurrentBufferLevel(t)<e.duration?v:p}catch(e){}}(e);r&&(t.br=r);o&&(t.ot=o);isNaN(i)||(t.d=i);isNaN(s)||(t.mtp=s);isNaN(u)||(t.dl=u);isNaN(l)||null===l||(t.bs=l);return t}(e):e.type===u.HTTPRequest.INIT_SEGMENT_TYPE?function(){var e=D();return e.ot=""+T,e}():t}catch(e){return null}var r}(e))}:null}catch(e){return null}},setConfig:function(e){e&&(e.abrController&&(a=e.abrController),e.dashMetrics&&(d=e.dashMetrics),e.playbackController&&(h=e.playbackController))},reset:function(){R.off(i.default.PLAYBACK_RATE_CHANGED,P,this),R.off(i.default.MANIFEST_LOADED,L,this),R.off(i.default.BUFFER_LEVEL_STATE_CHANGED,N,t),O()},initialize:function(){R.on(i.default.PLAYBACK_RATE_CHANGED,P,t),R.on(i.default.MANIFEST_LOADED,L,t),R.on(i.default.BUFFER_LEVEL_STATE_CHANGED,N,t)}},(0,o.default)(C).getInstance().getLogger(t),e=(0,l.default)(C).getInstance(),O(),t}C.__dashjs_factory_name="CmcdModel",t.default=a.default.getSingletonFactory(C)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvb_priority=r||1,this.dvb_weight=i||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};r.DEFAULT_DVB_PRIORITY=1,r.DEFAULT_DVB_WEIGHT=1,t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(944));function a(e){return e&&e.__esModule?e:{default:e}}function o(){return{areEqual:function(e,t){return(0,i.default)(e,t)}}}o.__dashjs_factory_name="ObjectUtils",t.default=r.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.THUMBNAILS_SCHEME_ID_URIS=void 0;var r=f(n(9)),i=f(n(33)),a=f(n(2)),o=f(n(945)),s=f(n(46)),u=n(73),l=f(n(18)),c=f(n(91)),d=f(n(142)),h=f(n(186));function f(e){return e&&e.__esModule?e:{default:e}}var p=t.THUMBNAILS_SCHEME_ID_URIS=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function m(e){var t,n=this.context,a=e.adapter,f=e.baseURLController,m=e.streamInfo,g=e.timelineConverter,v=e.debug,y=e.eventBus,_=e.events,b=e.dashConstants,E=(0,s.default)(n).getInstance(),T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0;function C(){I(),x=(0,d.default)(n).create({}),M=(0,c.default)(n).getInstance(),(S=(0,h.default)(n).create({timelineConverter:g,baseURLController:f,debug:v,eventBus:y,events:_,dashConstants:b,urlUtils:E})).initialize(!!a&&a.getIsDynamic()),function(){if(!m||!a)return;if(!(A=a.getMediaInfoForType(m,r.default.IMAGE)))return;var e=a.getVoRepresentations(A);e&&e.length>0&&e.forEach((function(e){(e.segmentInfoType===i.default.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media||e.segmentInfoType===i.default.SEGMENT_TIMELINE)&&R(e),e.segmentInfoType===i.default.SEGMENT_BASE&&R(e,!0)}));T.length>0&&(T.sort((function(e,t){return e.bitrate-t.bitrate})),w=T.length-1)}()}function R(e,t){var n=new o.default;n.id=e.id,n.bitrate=e.bandwidth,n.width=e.width,n.height=e.height,n.tilesHor=1,n.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach((function(e){if(p.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(n.tilesHor=parseInt(t[0],10),n.tilesVert=parseInt(t[1],10))}})),t?y.trigger(l.default.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{mimeType:A.mimeType,mediaType:r.default.IMAGE,representation:e,callback:function(e,t){var r=[];e=function(e,t){var n,r=[],i=0,o=void 0,s=void 0,l=void 0;for(o=0,n=e.length;o<n;o++)s=e[o],(l=(0,u.getTimeBasedSegment)(g,a.getIsDynamic(),t,s.startTime,s.duration,s.timescale,s.media,s.mediaRange,i))&&(r.push(l),l=null,i++);return r}(e,t),n.segmentDuration=e[0].duration,n.readThumbnail=function(n,i){var a=null;r.some((function(e){if(e.start<=n&&e.end>n)return a=e.url,!0})),a?i(a):e.some((function(e){if(e.mediaStartTime<=n&&e.mediaStartTime+e.duration>n){var a=f.resolve(t.path);return x.load({method:"get",url:a.url,request:{range:e.mediaRange,responseType:"arraybuffer"},onload:function(t){var n=M.getSamplesInfo(t.target.response),a=new Blob([t.target.response.slice(n.sampleList[0].offset,n.sampleList[0].offset+n.sampleList[0].size)],{type:"image/jpeg"}),o=window.URL.createObjectURL(a);r.push({start:e.mediaStartTime,end:e.mediaStartTime+e.duration,url:o}),i&&i(o)}}),!0}}))}}}):(n.startNumber=e.startNumber,n.segmentDuration=e.segmentDuration,n.timescale=e.timescale,n.templateUrl=function(e){var t=E.isRelative(e.media)?E.resolve(e.media,f.resolve(e.path).url):e.media;if(!t)return"";return(0,u.replaceIDForTemplate)(t,e.id)}(e)),n.tilesHor>0&&n.tilesVert>0&&(n.widthPerTile=n.width/n.tilesHor,n.heightPerTile=n.height/n.tilesVert,T.push(n))}function I(){T=[],w=-1,A=null}return t={initialize:C,getTracks:function(){return T},reset:I,setTrackByIndex:function(e){T&&0!==T.length&&(e>=T.length&&(e=T.length-1),w=e)},getCurrentTrack:function(){return w<0?null:T[w]},getCurrentTrackIndex:function(){return w},getThumbnailRequestForTime:function(e){for(var t=void 0,n=a.getVoRepresentations(A),r=0;r<n.length;r++)if(T[w].id===n[r].id){t=n[r];break}return S.getSegmentRequestForTime(A,t,e)}},C(),t}m.__dashjs_factory_name="ThumbnailTracks",t.default=a.default.getClassFactory(m)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(16)),i=l(n(18)),a=l(n(2)),o=l(n(17)),s=l(n(35)),u=l(n(33));function l(e){return e&&e.__esModule?e:{default:e}}function c(){var e=this.context,t=(0,r.default)(e).getInstance(),n=void 0,a=void 0,l=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;function y(){l=NaN,h=!1,d=!0,_()}function _(){null!==c&&(clearTimeout(c),c=null)}function b(e){_(),isNaN(e)&&!isNaN(l)&&(e=1e3*l),isNaN(e)||(a.debug("Refresh manifest in "+e+" milliseconds."),c=setTimeout(S,e))}function E(){h=!0;var e=p.getValue(),t=e.url,n=m.getLocation(e);n&&(t=n),f.load(t)}function T(e){if(p.getValue()&&p.getValue().type===u.default.DYNAMIC&&e.type===u.default.STATIC)t.trigger(i.default.DYNAMIC_STREAM_COMPLETED);else{p.setValue(e);var n=new Date,r=(n.getTime()-e.loadedTime.getTime())/1e3;1e3*(l=m.getManifestUpdatePeriod(e,r))>2147483647&&(l=2147483.647),t.trigger(i.default.MANIFEST_UPDATED,{manifest:e}),a.info("Manifest has been refreshed at "+n+"["+n.getTime()/1e3+"] "),d||b()}}function S(){d&&!v.get().streaming.scheduleWhilePaused||(h?b(v.get().streaming.manifestUpdateRetryInterval):E())}function w(e){e.error?e.error.code===s.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&g.error(e.error):T(e.manifest)}function A(){d=!1,b()}function x(){d=!0,_()}function M(){h=!1}return n={initialize:function(){y(),t.on(i.default.STREAMS_COMPOSED,M,this),t.on(i.default.PLAYBACK_STARTED,A,this),t.on(i.default.PLAYBACK_PAUSED,x,this),t.on(i.default.INTERNAL_MANIFEST_LOADED,w,this)},setManifest:function(e){T(e)},refreshManifest:E,setConfig:function(e){e&&(e.manifestModel&&(p=e.manifestModel),e.adapter&&(m=e.adapter),e.manifestLoader&&(f=e.manifestLoader),e.errHandler&&(g=e.errHandler),e.settings&&(v=e.settings))},reset:function(){t.off(i.default.PLAYBACK_STARTED,A,this),t.off(i.default.PLAYBACK_PAUSED,x,this),t.off(i.default.STREAMS_COMPOSED,M,this),t.off(i.default.INTERNAL_MANIFEST_LOADED,w,this),y()}},a=(0,o.default)(e).getInstance().getLogger(n),n}c.__dashjs_factory_name="ManifestUpdater",t.default=a.default.getClassFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(9));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.url=e||null,i.type=n||null,i.mediaType=r.default.STREAM,i.responseType="",i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i(n(59)).default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e=e||{},function(){void 0===e.escapeMode&&(e.escapeMode=!0);void 0===e.attributePrefix&&(e.attributePrefix="_");e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0);e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0);void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0);e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1);e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1);void 0===e.ignoreRoot&&(e.ignoreRoot=!1)}();var t=1,n=3,r=4,i=8,a=9;function o(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function s(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function u(e,t,n,r){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==r)break}else if(a instanceof RegExp){if(a.test(r))break}else if("function"==typeof a&&a(t,n,r))break}return i!=e.length}function l(t,n,r){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&u(e.arrayAccessFormPaths,t,n,r)&&(t[n]=[t[n]])}function c(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function d(n,r,i,a){return!(r==t&&e.xmlElementsFilter.length>0)||u(e.xmlElementsFilter,n,i,a)}function h(s,f){if(s.nodeType==a){for(var p=new Object,m=s.childNodes,g=0;g<m.length;g++){if((y=m[g]).nodeType==t)if(e.ignoreRoot)p=h(y);else(p={})[_=o(y)]=h(y)}return p}if(s.nodeType==t){(p=new Object).__cnt=0;var v=[];for(m=s.childNodes,g=0;g<m.length;g++){var y,_=o(y=m[g]);if(y.nodeType!=i){var b=f+"."+_;if(d(p,y.nodeType,_,b))if(p.__cnt++,null==p[_]){var E=h(y,b);if("#text"!=_||/[^\s]/.test(E))(T={})[_]=E,v.push(T);p[_]=E,l(p,_,b)}else{null!=p[_]&&(p[_]instanceof Array||(p[_]=[p[_]],l(p,_,b)));var T;E=h(y,b);if("#text"!=_||/[^\s]/.test(E))(T={})[_]=E,v.push(T);p[_][p[_].length]=E}}}p.__children=v;for(var S=o(s),w=0;w<s.attributes.length;w++){var A=s.attributes[w];p.__cnt++;for(var x=A.value,M=0,C=e.matchers.length;M<C;M++){var R=e.matchers[M];R.test(A,S)&&(x=R.converter(A.value))}p[e.attributePrefix+A.name]=x}var I=function(e){return e.prefix}(s);return null!=I&&""!=I&&(p.__cnt++,p.__prefix=I),null!=p["#text"]&&(p.__text=p["#text"],p.__text instanceof Array&&(p.__text=p.__text.join("\n")),e.stripWhitespaces&&(p.__text=p.__text.trim()),delete p["#text"],"property"==e.arrayAccessForm&&delete p["#text_asArray"],p.__text=function(t,n,r){if(e.datetimeAccessFormPaths.length>0){var i=r.split(".#")[0];return u(e.datetimeAccessFormPaths,t,n,i)?c(t):t}return t}(p.__text,_,f+"."+_)),null!=p["#cdata-section"]&&(p.__cdata=p["#cdata-section"],delete p["#cdata-section"],"property"==e.arrayAccessForm&&delete p["#cdata-section_asArray"]),0==p.__cnt&&"text"==e.emptyNodeForm?p="":1==p.__cnt&&null!=p.__text?p=p.__text:1!=p.__cnt||null==p.__cdata||e.keepCData?p.__cnt>1&&null!=p.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==p.__text||""==p.__text.trim())&&delete p.__text:p=p.__cdata,delete p.__cnt,!e.enableToStringFunc||null==p.__text&&null==p.__cdata||(p.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),p}if(s.nodeType==n||s.nodeType==r)return s.nodeValue}function f(t,n,r,i){var a="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=r)for(var o=0;o<r.length;o++){var u=r[o],l=t[u];e.escapeMode&&(l=s(l)),a+=" "+u.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?a+='"'+l+'"':a+="'"+l+"'"}return a+=i?"/>":">"}function p(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function m(t,n){return"property"==e.arrayAccessForm&&(r=n.toString(),i="_asArray",-1!==r.indexOf(i,r.length-i.length))||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function;var r,i}function g(e){var t=0;if(e instanceof Object)for(var n in e)m(e,n)||t++;return t}function v(t,n,r){return 0==e.jsonPropertiesFilter.length||""==r||u(e.jsonPropertiesFilter,t,n,r)}function y(t){var n=[];if(t instanceof Object)for(var r in t)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(e.attributePrefix)&&n.push(r);return n}function _(t){var n="";return t instanceof Object?n+=function(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?n+=s(t.__text):n+=t.__text),n}(t):null!=t&&(e.escapeMode?n+=s(t):n+=t),n}function b(e,t){return""===e?t:e+"."+t}function E(e,t,n,r){var i="";if(0==e.length)i+=f(e,t,n,!0);else for(var a=0;a<e.length;a++)i+=f(e[a],t,y(e[a]),!1),i+=T(e[a],b(r,t)),i+=p(e[a],t);return i}function T(e,t){var n="";if(g(e)>0)for(var r in e)if(!m(e,r)&&(""==t||v(e,r,b(t,r)))){var i=e[r],a=y(i);if(null==i||null==i)n+=f(i,r,a,!0);else if(i instanceof Object)if(i instanceof Array)n+=E(i,r,a,t);else if(i instanceof Date)n+=f(i,r,a,!1),n+=i.toISOString(),n+=p(i,r);else{g(i)>0||null!=i.__text||null!=i.__cdata?(n+=f(i,r,a,!1),n+=T(i,b(t,r)),n+=p(i,r)):n+=f(i,r,a,!0)}else n+=f(i,r,a,!1),n+=_(i),n+=p(i,r)}return n+=_(e)}this.parseXmlString=function(e){var t;window.ActiveXObject||window;if(void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser;try{(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?c(e):e},this.xml2json=function(e){return h(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return T(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(968),o=(r=a)&&r.__esModule?r:{default:r};var s=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t||"",this._properties=[],this._children=r||[],Array.isArray(n)&&n.forEach((function(e){i._properties.push(new o.default(e))}))}return i(e,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(1008),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t={"urn:dvb:dash:reporting:2014":a.default},n=this.context,r=void 0,i=e.debug?e.debug.getLogger(r):{},o=e.metricsConstants;return r={create:function(e,r){var a=void 0;try{(a=t[e.schemeIdUri](n).create({metricsConstants:o})).initialize(e,r)}catch(t){a=null,i.error("ReportingFactory: could not create Reporting with schemeIdUri "+e.schemeIdUri+" ("+t.message+")")}return a},register:function(e,n){t[e]=n},unregister:function(e){delete t[e]}}}o.__dashjs_factory_name="ReportingFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1012)),i=s(n(1013)),a=s(n(1014)),o=s(n(1015));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){var t=void 0,n=(e=e||{}).debug?e.debug.getLogger(t):{},s=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,u=this.context,l={BufferLevel:r.default,DVBErrors:i.default,HttpList:a.default,PlayList:o.default,RepSwitchList:o.default,TcpList:o.default};return t={create:function(t,r){var i,a=t.match(s);if(a){try{(i=l[a[1]](u).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants})).initialize(a[1],r,a[3],a[5])}catch(e){i=null,n.error("MetricsHandlerFactory: Could not create handler for type "+a[1]+" with args "+a[3]+", "+a[5]+" ("+e.message+")")}return i}},register:function(e,t){l[e]=t},unregister:function(e){delete l[e]}}}u.__dashjs_factory_name="MetricsHandlerFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(u)},function(e,t,n){"use strict";function r(){return{reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="HandlerHelpers",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){function n(e,t){for(var n in e)t[n]=e[n]}function r(e,t){var r=e.prototype;if(Object.create){var i=Object.create(t.prototype);r.__proto__=i}if(!(r instanceof t)){function a(){}a.prototype=t.prototype,n(r,a=new a),e.prototype=r=a}r.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),r.constructor=e)}var i={},a=i.ELEMENT_NODE=1,o=i.ATTRIBUTE_NODE=2,s=i.TEXT_NODE=3,u=i.CDATA_SECTION_NODE=4,l=i.ENTITY_REFERENCE_NODE=5,c=i.ENTITY_NODE=6,d=i.PROCESSING_INSTRUCTION_NODE=7,h=i.COMMENT_NODE=8,f=i.DOCUMENT_NODE=9,p=i.DOCUMENT_TYPE_NODE=10,m=i.DOCUMENT_FRAGMENT_NODE=11,g=i.NOTATION_NODE=12,v={},y={},_=(v.INDEX_SIZE_ERR=(y[1]="Index size error",1),v.DOMSTRING_SIZE_ERR=(y[2]="DOMString size error",2),v.HIERARCHY_REQUEST_ERR=(y[3]="Hierarchy request error",3)),b=(v.WRONG_DOCUMENT_ERR=(y[4]="Wrong document",4),v.INVALID_CHARACTER_ERR=(y[5]="Invalid character",5),v.NO_DATA_ALLOWED_ERR=(y[6]="No data allowed",6),v.NO_MODIFICATION_ALLOWED_ERR=(y[7]="No modification allowed",7),v.NOT_FOUND_ERR=(y[8]="Not found",8)),E=(v.NOT_SUPPORTED_ERR=(y[9]="Not supported",9),v.INUSE_ATTRIBUTE_ERR=(y[10]="Attribute in use",10));v.INVALID_STATE_ERR=(y[11]="Invalid state",11),v.SYNTAX_ERR=(y[12]="Syntax error",12),v.INVALID_MODIFICATION_ERR=(y[13]="Invalid modification",13),v.NAMESPACE_ERR=(y[14]="Invalid namespace",14),v.INVALID_ACCESS_ERR=(y[15]="Invalid access",15);function T(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,y[e]),this.message=y[e],Error.captureStackTrace&&Error.captureStackTrace(this,T);return n.code=e,t&&(this.message=this.message+": "+t),n}function S(){}function w(e,t){this._node=e,this._refresh=t,A(this)}function A(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var r=e._refresh(e._node);te(e,"length",r.length),n(r,e),e._inc=t}}function x(){}function M(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function C(e,t,n,r){if(r?t[M(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(r&&N(i,e,r),function(e,t,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(t._nsMap[n.prefix?n.localName:""]=n.value)}(i,e,n))}}function R(e,t,n){var r=M(t,n);if(!(r>=0))throw T(b,new Error(e.tagName+"@"+n));for(var i=t.length-1;r<i;)t[r]=t[++r];if(t.length=i,e){var a=e.ownerDocument;a&&(N(a,e,n),n.ownerElement=null)}}function I(e){if(this._features={},e)for(var t in e)this._features=e[t]}function O(){}function D(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function P(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(P(e,t))return!0}while(e=e.nextSibling)}function L(){}function N(e,t,n,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function k(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var i=t.firstChild,a=0;i;)r[a++]=i,i=i.nextSibling;r.length=a}}}function F(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,k(e.ownerDocument,e),t}function B(e,t,n){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===m){var i=t.firstChild;if(null==i)return t;var a=t.lastChild}else i=a=t;var o=n?n.previousSibling:e.lastChild;i.previousSibling=o,a.nextSibling=n,o?o.nextSibling=i:e.firstChild=i,null==n?e.lastChild=a:n.previousSibling=a;do{i.parentNode=e}while(i!==a&&(i=i.nextSibling));return k(e.ownerDocument||e,e),t.nodeType==m&&(t.firstChild=t.lastChild=null),t}function U(){this._nsMap={}}function j(){}function G(){}function H(){}function V(){}function z(){}function W(){}function q(){}function Y(){}function K(){}function X(){}function Q(){}function Z(){}function J(e,t){var n=[],r=9==this.nodeType?this.documentElement:this,i=r.prefix,a=r.namespaceURI;if(a&&null==i&&null==(i=r.lookupPrefix(a)))var o=[{namespace:a,prefix:null}];return ee(this,n,e,t,o),n.join("")}function $(e,t,n){var r=e.prefix||"",i=e.namespaceURI;if(!r&&!i)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;for(var a=n.length;a--;){var o=n[a];if(o.prefix==r)return o.namespace!=i}return!0}function ee(e,t,n,r,i){if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case a:i||(i=[]);i.length;var c=e.attributes,g=c.length,v=e.firstChild,y=e.tagName;n="http://www.w3.org/1999/xhtml"===e.namespaceURI||n,t.push("<",y);for(var _=0;_<g;_++){"xmlns"==(b=c.item(_)).prefix?i.push({prefix:b.localName,namespace:b.value}):"xmlns"==b.nodeName&&i.push({prefix:"",namespace:b.value})}for(_=0;_<g;_++){var b;if($(b=c.item(_),0,i)){var E=b.prefix||"",T=b.namespaceURI,S=E?" xmlns:"+E:" xmlns";t.push(S,'="',T,'"'),i.push({prefix:E,namespace:T})}ee(b,t,n,r,i)}if($(e,0,i)){E=e.prefix||"",T=e.namespaceURI,S=E?" xmlns:"+E:" xmlns";t.push(S,'="',T,'"'),i.push({prefix:E,namespace:T})}if(v||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(y)){if(t.push(">"),n&&/^script$/i.test(y))for(;v;)v.data?t.push(v.data):ee(v,t,n,r,i),v=v.nextSibling;else for(;v;)ee(v,t,n,r,i),v=v.nextSibling;t.push("</",y,">")}else t.push("/>");return;case f:case m:for(v=e.firstChild;v;)ee(v,t,n,r,i),v=v.nextSibling;return;case o:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,D),'"');case s:return t.push(e.data.replace(/[<&]/g,D));case u:return t.push("<![CDATA[",e.data,"]]>");case h:return t.push("\x3c!--",e.data,"--\x3e");case p:var w=e.publicId,A=e.systemId;if(t.push("<!DOCTYPE ",e.name),w)t.push(' PUBLIC "',w),A&&"."!=A&&t.push('" "',A),t.push('">');else if(A&&"."!=A)t.push(' SYSTEM "',A,'">');else{var x=e.internalSubset;x&&t.push(" [",x,"]"),t.push(">")}return;case d:return t.push("<?",e.target," ",e.data,"?>");case l:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function te(e,t,n){e[t]=n}T.prototype=Error.prototype,n(v,T),S.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],r=0;r<this.length;r++)ee(this[r],n,e,t);return n.join("")}},w.prototype.item=function(e){return A(this),this[e]},r(w,S),x.prototype={length:0,item:S.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new T(E);var n=this.getNamedItem(e.nodeName);return C(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new T(E);return t=this.getNamedItemNS(e.namespaceURI,e.localName),C(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return R(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return R(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}},I.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var r=new L;if(r.implementation=this,r.childNodes=new S,r.doctype=n,n&&r.appendChild(n),t){var i=r.createElementNS(e,t);r.appendChild(i)}return r},createDocumentType:function(e,t,n){var r=new W;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=n,r}},O.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return B(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return F(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,n,r){var i=new n.constructor;for(var s in n){var u=n[s];"object"!=typeof u&&u!=i[s]&&(i[s]=u)}n.childNodes&&(i.childNodes=new S);switch(i.ownerDocument=t,i.nodeType){case a:var l=n.attributes,c=i.attributes=new x,d=l.length;c._ownerElement=i;for(var h=0;h<d;h++)i.setAttributeNode(e(t,l.item(h),!0));break;case o:r=!0}if(r)for(var f=n.firstChild;f;)i.appendChild(e(t,f,r)),f=f.nextSibling;return i}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==s&&e.nodeType==s?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var r in n)if(n[r]==e)return r;t=t.nodeType==o?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==o?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},n(i,O),n(i,O.prototype),L.prototype={nodeName:"#document",nodeType:f,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==m){for(var n=e.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,t),n=r}return e}return null==this.documentElement&&e.nodeType==a&&(this.documentElement=e),B(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),F(this,e)},importNode:function(e,t){return function e(t,n,r){var i;switch(n.nodeType){case a:(i=n.cloneNode(!1)).ownerDocument=t;case m:break;case o:r=!0}i||(i=n.cloneNode(!1));if(i.ownerDocument=t,i.parentNode=null,r)for(var s=n.firstChild;s;)i.appendChild(e(t,s,r)),s=s.nextSibling;return i}(this,e,t)},getElementById:function(e){var t=null;return P(this.documentElement,(function(n){if(n.nodeType==a&&n.getAttribute("id")==e)return t=n,!0})),t},createElement:function(e){var t=new U;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new S,(t.attributes=new x)._ownerElement=t,t},createDocumentFragment:function(){var e=new X;return e.ownerDocument=this,e.childNodes=new S,e},createTextNode:function(e){var t=new H;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new V;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new z;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new Q;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new j;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new K;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new U,r=t.split(":"),i=n.attributes=new x;return n.childNodes=new S,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new j,r=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},r(L,O),U.prototype={nodeType:a,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===m?this.insertBefore(e,null):function(e,t){var n=t.parentNode;if(n){var r=e.lastChild;n.removeChild(t),r=e.lastChild}return r=e.lastChild,t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,k(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new w(this,(function(t){var n=[];return P(t,(function(r){r===t||r.nodeType!=a||"*"!==e&&r.tagName!=e||n.push(r)})),n}))},getElementsByTagNameNS:function(e,t){return new w(this,(function(n){var r=[];return P(n,(function(i){i===n||i.nodeType!==a||"*"!==e&&i.namespaceURI!==e||"*"!==t&&i.localName!=t||r.push(i)})),r}))}},L.prototype.getElementsByTagName=U.prototype.getElementsByTagName,L.prototype.getElementsByTagNameNS=U.prototype.getElementsByTagNameNS,r(U,O),j.prototype.nodeType=o,r(j,O),G.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(y[_])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},r(G,O),H.prototype={nodeName:"#text",nodeType:s,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},r(H,G),V.prototype={nodeName:"#comment",nodeType:h},r(V,G),z.prototype={nodeName:"#cdata-section",nodeType:u},r(z,G),W.prototype.nodeType=p,r(W,O),q.prototype.nodeType=g,r(q,O),Y.prototype.nodeType=c,r(Y,O),K.prototype.nodeType=l,r(K,O),X.prototype.nodeName="#document-fragment",X.prototype.nodeType=m,r(X,O),Q.prototype.nodeType=d,r(Q,O),Z.prototype.serializeToString=function(e,t,n){return J.call(e,t,n)},O.prototype.toString=J;try{if(Object.defineProperty){Object.defineProperty(w.prototype,"length",{get:function(){return A(this),this.$$length}}),Object.defineProperty(O.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case a:case m:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case a:case m:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),te=function(e,t,n){e["$$"+t]=n}}}catch(e){}t.DOMImplementation=I,t.XMLSerializer=Z},function(e,t,n){"use strict";e.exports={parseSei:function(e){for(var t=0,n={payloadType:-1,payloadSize:0},r=0,i=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)r+=255,t++;for(r+=e[t++];255===e[t];)i+=255,t++;if(i+=e[t++],!n.payload&&4===r){n.payloadType=r,n.payloadSize=i,n.payload=e.subarray(t,t+i);break}t+=i,r=0,i=0}return n},parseUserData:function(e){return 181!==e.payload[0]||49!=(e.payload[1]<<8|e.payload[2])||"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])||3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},parseCaptionPackets:function(e,t){var n,r,i,a,o=[];if(!(64&t[0]))return o;for(r=31&t[0],n=0;n<r;n++)a={type:3&t[(i=3*n)+2],pts:e},4&t[i+2]&&(a.ccData=t[i+3]<<8|t[i+4],o.push(a));return o},discardEmulationPreventionBytes:function(e){for(var t,n,r=e.byteLength,i=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n},USER_DATA_REGISTERED_ITU_T_T35:4}},function(e,t,n){"use strict";var r=function(){this.init=function(){var e={};this.on=function(t,n){e[t]||(e[t]=[]),e[t]=e[t].concat(n)},this.off=function(t,n){var r;return!!e[t]&&(r=e[t].indexOf(n),e[t]=e[t].slice(),e[t].splice(r,1),r>-1)},this.trigger=function(t){var n,r,i,a;if(n=e[t])if(2===arguments.length)for(i=n.length,r=0;r<i;++r)n[r].call(this,arguments[1]);else{for(a=[],r=arguments.length,r=1;r<arguments.length;++r)a.push(arguments[r]);for(i=n.length,r=0;r<i;++r)n[r].apply(this,a)}},this.dispose=function(){e={}}}};r.prototype.pipe=function(e){return this.on("data",(function(t){e.push(t)})),this.on("done",(function(t){e.flush(t)})),this.on("partialdone",(function(t){e.partialFlush(t)})),this.on("endedtimeline",(function(t){e.endTimeline(t)})),this.on("reset",(function(t){e.reset(t)})),e},r.prototype.push=function(e){this.trigger("data",e)},r.prototype.flush=function(e){this.trigger("done",e)},r.prototype.partialFlush=function(e){this.trigger("partialdone",e)},r.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},r.prototype.reset=function(e){this.trigger("reset",e)},e.exports=r},function(e,t,n){"use strict";e.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(75)),o=r(n(1053)),s=r(n(1074)),u=r(n(157)),l=r(n(217)),c=r(n(1109)),d=r(n(1121)),h=r(n(1122)),f=r(n(156)),p=r(n(116)),m=r(n(155)),g=r(n(1123)),v=r(n(1125)),y=r(n(1126)),_=r(n(1127)),b=r(n(115)),E=r(n(1137)),T=r(n(1138)),S=r(n(13)),w=r(n(29)),A=r(n(12)),x=r(n(14)),M=r(n(216)),C=r(n(3)),R=n(224),I=r(n(1139)),O=r(n(1144)),D=r(n(1149)),P=r(n(1151)),L=n(32),N=r(n(1152)),k=r(n(71)),F=r(n(26)),B=n(76);function U(){var e="You must first call initialize() and set a source before calling this method",t="You must first call initialize() and set a valid source and view before calling this method",n="You must first call attachView() to set the video element before calling this method",r="You must first call attachSource() with a valid source before calling this method",U="MediaPlayer not initialized!",j=this.context,G=(0,A.default)(j).getInstance(),H=(0,S.default)(j).getInstance(),V=void 0,z=void 0,W=void 0,q=void 0,Y=void 0,K=void 0,X=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,ce=void 0,de=void 0,he=void 0,fe=void 0,pe=void 0,me=void 0,ge=void 0;function ve(){return!!W&&!!fe.getElement()}function ye(){return(0,R.getVersionString)()}function _e(){if(!X)throw t;return le.isPaused()}function be(e){var t=Ne();if(!t)return 0;var n=le.getLiveDelay(),r=t.range.start+e;return r>t.range.end-n&&(r=t.range.end-n),r}function Ee(e){if(!X)throw t;var n=Me().currentTime;if(void 0!==e)n=ue.getTimeRelativeToStreamId(n,e);else if(le.getIsDynamic()){var r=Ne();n=null===r?0:Te()-(r.range.end-r.time)}return n}function Te(){if(!X)throw t;var e=Me().duration;if(le.getIsDynamic()){var n,r=Ne();if(!r)return 0;e=(n=r.range.end-r.range.start)<r.manifestInfo.DVRWindowSize?n:r.manifestInfo.DVRWindowSize}return e}function Se(e){(0,B.checkParameterType)(e,"boolean"),Q=e}function we(){ae.restoreDefaultUTCTimingSources()}function Ae(){return ce}function xe(e){return ie.getReadOnlyMetricsFor(e)}function Me(){if(!fe.getElement())throw n;return fe.getElement()}function Ce(e){if(!Y)throw U;fe.setElement(e),e&&(Le(),function(){if(te)return;var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(j).create();te=t.createMetricsReporting({debug:H,eventBus:G,mediaElement:Me(),dashManifestModel:de,metricsModel:ie,events:x.default,constants:i.default,metricsConstants:a.default})}}(),function(){if(ne)return;var e=dashjs.MssHandler;"function"==typeof e&&(w.default.extend(e.errors),ne=e(j).create({eventBus:G,mediaPlayerModel:ae,metricsModel:ie,manifestModel:he,playbackController:le,protectionController:ee,baseURLController:(0,l.default)(j).getInstance(),errHandler:oe,events:x.default,constants:i.default,debug:H,initSegmentType:L.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:N.default,ISOBoxer:k.default}))}(),ue&&ue.switchToVideoElement()),X&&De(),Fe()}function Re(t){if(!K)throw e;var n=ue.getActiveStreamInfo();return $.getTracksFor(t,n)}function Ie(e){if(!Y)throw U;"string"==typeof e&&me.initialize(e),W=e,(K||X)&&De(),ve()&&Fe()}function Oe(){if(!K)throw e;var t=ue.getActiveStreamInfo();return t?ue.getStreamById(t.id):null}function De(){X=!1,K=!1,re.reset(),ue.reset(),le.reset(),Z.reset(),$.reset(),pe.reset(),ee&&(ae.getKeepProtectionMediaKeys()?ee.stop():(ee.reset(),ee=null,Le()))}function Pe(){return(0,c.default)(j).create({errHandler:oe,metricsModel:ie,mediaPlayerModel:ae,requestModifier:(0,p.default)(j).getInstance(),mssHandler:ne})}function Le(){if(ee)return ee;var e=dashjs.Protection;if("function"==typeof e){var t=e(j).create();return x.default.extend(e.events),M.default.extend(e.events,{publicOnly:!0}),w.default.extend(e.errors),se||(se=(0,h.default)(j).getInstance()),ee=t.createProtectionSystem({debug:H,errHandler:oe,videoModel:fe,capabilities:se,eventBus:G,events:x.default,BASE64:N.default,constants:i.default})}return null}function Ne(){var e=ie.getReadOnlyMetricsFor(i.default.VIDEO)||ie.getReadOnlyMetricsFor(i.default.AUDIO);return ce.getCurrentDVRInfo(e)}function ke(e){var t=Ne();return t?e+(t.manifestInfo.availableFrom.getTime()/1e3+t.range.start):0}function Fe(){var e;!K&&W&&(K=!0,z.info("Streaming Initialized"),e=Pe(),ue||(ue=(0,s.default)(j).getInstance()),$.setConfig({domStorage:ge}),ue.setConfig({capabilities:se,manifestLoader:e,manifestModel:he,dashManifestModel:de,mediaPlayerModel:ae,protectionController:ee,adapter:re,metricsModel:ie,dashMetrics:ce,errHandler:oe,timelineConverter:J,videoModel:fe,playbackController:le,domStorage:ge,abrController:Z,mediaController:$,textController:pe}),le.setConfig({streamController:ue,metricsModel:ie,dashMetrics:ce,manifestModel:he,mediaPlayerModel:ae,dashManifestModel:de,adapter:re,videoModel:fe,timelineConverter:J,uriFragmentModel:me}),Z.setConfig({streamController:ue,domStorage:ge,mediaPlayerModel:ae,metricsModel:ie,dashMetrics:ce,manifestModel:he,videoModel:fe,adapter:re}),Z.createAbrRulesCollection(),pe.setConfig({errHandler:oe,manifestModel:he,dashManifestModel:de,mediaController:$,streamController:ue,videoModel:fe}),ue.initialize(Q,q),"string"==typeof W?ue.load(W):ue.loadWithManifest(W)),!X&&ve()&&(X=!0,z.info("Playback Initialized"))}return V={initialize:function(e,t,n){if(se||(se=(0,h.default)(j).getInstance()),oe=(0,d.default)(j).getInstance(),!se.supportsMediaSource())return oe.capabilityError("mediasource"),void oe.error(new F.default(w.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,w.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE));Y||(Y=!0,J=(0,P.default)(j).getInstance(),Z||(Z=(0,b.default)(j).getInstance()),le||(le=(0,o.default)(j).getInstance()),$||($=(0,u.default)(j).getInstance()),re=(0,I.default)(j).getInstance(),de=(0,O.default)(j).getInstance({timelineConverter:J,errHandler:oe,BASE64:N.default}),he=(0,v.default)(j).getInstance(),ce=(0,D.default)(j).getInstance({manifestModel:he,dashManifestModel:de}),ie=(0,_.default)(j).getInstance(),pe=(0,m.default)(j).getInstance(),ge=(0,T.default)(j).getInstance({mediaPlayerModel:ae}),re.setConfig({dashManifestModel:de}),we(),Se(void 0===n||n),e&&Ce(e),t&&Ie(t),z.info("[dash.js "+ye()+"] MediaPlayer has been initialized"))},setConfig:function(e){e&&(e.capabilities&&(se=e.capabilities),e.streamController&&(ue=e.streamController),e.playbackController&&(le=e.playbackController),e.mediaPlayerModel&&(ae=e.mediaPlayerModel),e.abrController&&(Z=e.abrController),e.mediaController&&($=e.mediaController))},on:function(e,t,n){G.on(e,t,n)},off:function(e,t,n){G.off(e,t,n)},extend:function(e,t,n){C.default.extend(e,t,n,j)},attachView:Ce,attachSource:Ie,isReady:ve,preload:function(){if(fe.getElement()||K)return!1;if(!W)throw r;Fe()},play:function(){if(!X)throw t;(!Q||_e()&&X)&&le.play()},isPaused:_e,pause:function(){if(!X)throw t;le.pause()},isSeeking:function(){if(!X)throw t;return le.isSeeking()},isDynamic:function(){if(!X)throw t;return le.getIsDynamic()},seek:function(e){if(!X)throw t;if((0,B.checkParameterType)(e,"number"),isNaN(e))throw i.default.BAD_ARGUMENT_ERROR;var n=le.getIsDynamic()?be(e):e;le.seek(n)},setPlaybackRate:function(e){Me().playbackRate=e},getPlaybackRate:function(){return Me().playbackRate},setMute:function(e){(0,B.checkParameterType)(e,"boolean"),Me().muted=e},isMuted:function(){return Me().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw i.default.BAD_ARGUMENT_ERROR;Me().volume=e},getVolume:function(){return Me().volume},time:Ee,duration:Te,timeAsUTC:function(){if(!X)throw t;return Ee()<0?NaN:ke(Ee())},durationAsUTC:function(){if(!X)throw t;return ke(Te())},getActiveStream:Oe,getDVRWindowSize:function(){var e=Ne();return e?e.manifestInfo.DVRWindowSize:0},getDVRSeekOffset:be,convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString())},formatUTC:function(e,t,n){var r=!(arguments.length<=3||void 0===arguments[3])&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:n});return r?o+" "+a:o},getVersion:ye,getDebug:function(){return H},getBufferLength:function(e){var t,n=[i.default.VIDEO,i.default.AUDIO,i.default.FRAGMENTED_TEXT];return e?-1!==n.indexOf(e)?(t=Ae().getCurrentBufferLevel(xe(e)))||NaN:(z.warn("getBufferLength requested for invalid type"),NaN):(t=n.map((function(e){return Re(e).length>0?Ae().getCurrentBufferLevel(xe(e)):Number.MAX_VALUE})).reduce((function(e,t){return Math.min(e,t)})))===Number.MAX_VALUE?NaN:t},getTTMLRenderingDiv:function(){return fe?fe.getTTMLRenderingDiv():null},getVideoElement:Me,getSource:function(){if(!W)throw r;return W},setLiveDelayFragmentCount:function(e){ae.setLiveDelayFragmentCount(e)},setLiveDelay:function(e){ae.setLiveDelay(e)},getLiveDelay:function(){return ae.getLiveDelay()},getCurrentLiveLatency:function(){if(!Y)throw U;return X?le.getCurrentLiveLatency():NaN},useSuggestedPresentationDelay:function(e){ae.setUseSuggestedPresentationDelay(e)},enableLastBitrateCaching:function(e,t){ae.setLastBitrateCachingInfo(e,t)},enableLastMediaSettingsCaching:function(e,t){ae.setLastMediaSettingsCachingInfo(e,t)},setMaxAllowedBitrateFor:function(e,t){Z.setMaxAllowedBitrateFor(e,t)},getMaxAllowedBitrateFor:function(e){return Z.getMaxAllowedBitrateFor(e)},getTopBitrateInfoFor:function(t){if(!K)throw e;return Z.getTopBitrateInfoFor(t)},setMinAllowedBitrateFor:function(e,t){Z.setMinAllowedBitrateFor(e,t)},getMinAllowedBitrateFor:function(e){return Z.getMinAllowedBitrateFor(e)},setMaxAllowedRepresentationRatioFor:function(e,t){Z.setMaxAllowedRepresentationRatioFor(e,t)},getMaxAllowedRepresentationRatioFor:function(e){return Z.getMaxAllowedRepresentationRatioFor(e)},setAutoPlay:Se,getAutoPlay:function(){return Q},setScheduleWhilePaused:function(e){ae.setScheduleWhilePaused(e)},getScheduleWhilePaused:function(){return ae.getScheduleWhilePaused()},getDashMetrics:Ae,getMetricsFor:xe,getQualityFor:function(t){if(!K)throw e;if(t===i.default.IMAGE){var n=Oe();if(!n)return-1;var r=n.getThumbnailController();return r?r.getCurrentTrackIndex():-1}return Z.getQualityFor(t,ue.getActiveStreamInfo())},setQualityFor:function(t,n){if(!K)throw e;if(t===i.default.IMAGE){var r=Oe();if(!r)return;var a=r.getThumbnailController();a&&a.setTrackByIndex(n)}Z.setPlaybackQuality(t,ue.getActiveStreamInfo(),n)},updatePortalSize:function(){Z.setElementSize(),Z.setWindowResizeEventCalled(!0)},getLimitBitrateByPortal:function(){return Z.getLimitBitrateByPortal()},setLimitBitrateByPortal:function(e){Z.setLimitBitrateByPortal(e)},getUsePixelRatioInLimitBitrateByPortal:function(){return Z.getUsePixelRatioInLimitBitrateByPortal()},setUsePixelRatioInLimitBitrateByPortal:function(e){Z.setUsePixelRatioInLimitBitrateByPortal(e)},setTextDefaultLanguage:function(e){void 0===pe&&(pe=(0,m.default)(j).getInstance()),pe.setTextDefaultLanguage(e)},getTextDefaultLanguage:function(){return void 0===pe&&(pe=(0,m.default)(j).getInstance()),pe.getTextDefaultLanguage()},setTextDefaultEnabled:function(e){void 0===pe&&(pe=(0,m.default)(j).getInstance()),pe.setTextDefaultEnabled(e)},getTextDefaultEnabled:function(){return void 0===pe&&(pe=(0,m.default)(j).getInstance()),pe.getTextDefaultEnabled()},enableText:function(e){void 0===pe&&(pe=(0,m.default)(j).getInstance()),pe.enableText(e)},enableForcedTextStreaming:function(e){void 0===pe&&(pe=(0,m.default)(j).getInstance()),pe.enableForcedTextStreaming(e)},isTextEnabled:function(){return void 0===pe&&(pe=(0,m.default)(j).getInstance()),pe.isTextEnabled()},setTextTrack:function(e){if(!X)throw t;void 0===pe&&(pe=(0,m.default)(j).getInstance()),pe.setTextTrack(e)},getBitrateInfoListFor:function(t){if(!K)throw e;var n=Oe();return n?n.getBitrateListFor(t):[]},setInitialBitrateFor:function(e,t){Z.setInitialBitrateFor(e,t)},getInitialBitrateFor:function(t){if(!K)throw e;return Z.getInitialBitrateFor(t)},setInitialRepresentationRatioFor:function(e,t){Z.setInitialRepresentationRatioFor(e,t)},getInitialRepresentationRatioFor:function(e){return Z.getInitialRepresentationRatioFor(e)},getStreamsFromManifest:function(t){if(!K)throw e;return re.getStreamsInfo(t)},getTracksFor:Re,getTracksForTypeFromManifest:function(t,n,r){if(!K)throw e;return(r=r||re.getStreamsInfo(n,1)[0])?re.getAllMediaInfoForType(r,t,n):[]},getCurrentTrackFor:function(t){if(!K)throw e;var n=ue.getActiveStreamInfo();return $.getCurrentTrackFor(t,n)},setInitialMediaSettingsFor:function(e,t){if(!Y)throw U;$.setInitialSettings(e,t)},getInitialMediaSettingsFor:function(e){if(!Y)throw U;return $.getInitialSettings(e)},setCurrentTrack:function(t){if(!K)throw e;$.setTrack(t)},getTrackSwitchModeFor:function(e){if(!Y)throw U;return $.getSwitchMode(e)},setTrackSwitchModeFor:function(e,t){if(!Y)throw U;$.setSwitchMode(e,t)},setSelectionModeForInitialTrack:function(e){if(!Y)throw U;$.setSelectionModeForInitialTrack(e)},getSelectionModeForInitialTrack:function(){if(!Y)throw U;return $.getSelectionModeForInitialTrack()},setFastSwitchEnabled:function(e){ae.setFastSwitchEnabled(e)},getFastSwitchEnabled:function(){return ae.getFastSwitchEnabled()},setMovingAverageMethod:function(e){ae.setMovingAverageMethod(e)},getMovingAverageMethod:function(){return ae.getMovingAverageMethod()},getAutoSwitchQualityFor:function(e){return Z.getAutoSwitchBitrateFor(e)},setAutoSwitchQualityFor:function(e,t){Z.setAutoSwitchBitrateFor(e,t)},setABRStrategy:function(e){ae.setABRStrategy(e)},getABRStrategy:function(){return ae.getABRStrategy()},useDefaultABRRules:function(e){ae.setUseDefaultABRRules(e)},addABRCustomRule:function(e,t,n){ae.addABRCustomRule(e,t,n)},removeABRCustomRule:function(e){ae.removeABRCustomRule(e)},removeAllABRCustomRule:function(){ae.removeABRCustomRule()},setBandwidthSafetyFactor:function(e){ae.setBandwidthSafetyFactor(e)},getBandwidthSafetyFactor:function(){return ae.getBandwidthSafetyFactor()},getAverageThroughput:function(e){var t=Z.getThroughputHistory();return t?t.getAverageThroughput(e):0},setAbandonLoadTimeout:function(e){ae.setAbandonLoadTimeout(e)},retrieveManifest:function(e,t){var n=Pe(),r=this;G.on(x.default.INTERNAL_MANIFEST_LOADED,(function e(i){i.error?t(null,i.error):t(i.manifest),G.off(x.default.INTERNAL_MANIFEST_LOADED,e,r),n.reset()}),r),me.initialize(e),n.load(e)},addUTCTimingSource:function(e,t){ae.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){ae.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){ae.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:we,setBufferToKeep:function(e){ae.setBufferToKeep(e)},setBufferAheadToKeep:function(e){ae.setBufferAheadToKeep(e)},setBufferPruningInterval:function(e){ae.setBufferPruningInterval(e)},setStableBufferTime:function(e){ae.setStableBufferTime(e)},getStableBufferTime:function(){return ae.getStableBufferTime()},setBufferTimeAtTopQuality:function(e){ae.setBufferTimeAtTopQuality(e)},getBufferTimeAtTopQuality:function(){return ae.getBufferTimeAtTopQuality()},setBufferTimeAtTopQualityLongForm:function(e){ae.setBufferTimeAtTopQualityLongForm(e)},getBufferTimeAtTopQualityLongForm:function(){return ae.getBufferTimeAtTopQualityLongForm()},setFragmentLoaderRetryAttempts:function(e){ae.setRetryAttemptsForType(L.HTTPRequest.MEDIA_SEGMENT_TYPE,e)},setFragmentLoaderRetryInterval:function(e){ae.setRetryIntervalForType(L.HTTPRequest.MEDIA_SEGMENT_TYPE,e)},setManifestLoaderRetryAttempts:function(e){ae.setRetryAttemptsForType(L.HTTPRequest.MPD_TYPE,e)},setManifestLoaderRetryInterval:function(e){ae.setRetryIntervalForType(L.HTTPRequest.MPD_TYPE,e)},setXHRWithCredentialsForType:function(e,t){ae.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return ae.getXHRWithCredentialsForType(e)},setJumpGaps:function(e){ae.setJumpGaps(e)},getJumpGaps:function(){return ae.getJumpGaps()},setSmallGapLimit:function(e){ae.setSmallGapLimit(e)},getSmallGapLimit:function(){return ae.getSmallGapLimit()},setLowLatencyEnabled:function(e){ae.setLowLatencyEnabled(e)},getLowLatencyEnabled:function(){return ae.getLowLatencyEnabled()},setCatchUpPlaybackRate:function(e){ae.setCatchUpPlaybackRate(e)},getCatchUpPlaybackRate:function(){return ae.getCatchUpPlaybackRate()},setLowLatencyMinDrift:function(e){if("number"!=typeof e||isNaN(e)||e<0||e>.5)throw"Playback minimum drift has an invalid value! Use a number from 0 to 0.5";ae.setLowLatencyMinDrift(e)},getLowLatencyMinDrift:function(){return ae.getLowLatencyMinDrift()},setLowLatencyMaxDriftBeforeSeeking:function(e){if("number"!=typeof e||isNaN(e)||e<0)throw"Playback maximum drift has an invalid value! Use a number greater or equal to 0";ae.setLowLatencyMaxDriftBeforeSeeking(e)},getLowLatencyMaxDriftBeforeSeeking:function(){return ae.getLowLatencyMaxDriftBeforeSeeking()},setManifestUpdateRetryInterval:function(e){ae.setManifestUpdateRetryInterval(e)},getManifestUpdateRetryInterval:function(){return ae.getManifestUpdateRetryInterval()},setLongFormContentDurationThreshold:function(e){ae.setLongFormContentDurationThreshold(e)},setSegmentOverlapToleranceTime:function(e){ae.setSegmentOverlapToleranceTime(e)},setCacheLoadThresholdForType:function(e,t){ae.setCacheLoadThresholdForType(e,t)},getProtectionController:function(){return Le()},attachProtectionController:function(e){ee=e},setProtectionData:function(e){q=e,ue&&ue.setProtectionData(q)},enableManifestDateHeaderTimeSource:function(e){ae.setUseManifestDateHeaderTimeSource(e)},displayCaptionsOnTop:function(e){var t=(0,f.default)(j).getInstance();t.setConfig({videoModel:fe}),t.initialize(),t.displayCConTop(e)},attachVideoContainer:function(e){z.warn("attachVideoContainer method has been deprecated and will be removed in dash.js v3.0.0")},attachTTMLRenderingDiv:function(e){if(!fe.getElement())throw n;fe.setTTMLRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=NaN;return pe&&(e=pe.getCurrentTrackIdx()),e},getUseDeadTimeLatencyForAbr:function(){return Z.getUseDeadTimeLatency()},setUseDeadTimeLatencyForAbr:function(e){Z.setUseDeadTimeLatency(e)},getThumbnail:function(e,t){if(e<0)return null;var n=le.getIsDynamic()?be(e):e,r=ue.getStreamForTime(n);if(null===r)return null;var i=r.getThumbnailController();if(!i)return null;var a=ue.getTimeRelativeToStreamId(n,r.getId());return i.get(a,t)},keepProtectionMediaKeys:function(e){ae.setKeepProtectionMediaKeys(e)},reset:function(){Ie(null),Ce(null),q=null,ee&&(ee.reset(),ee=null),te&&(te.reset(),te=null)}},z=H.getLogger(V),Y=!1,X=!1,K=!1,Q=!0,ee=null,q=null,re=null,x.default.extend(M.default),ae=(0,y.default)(j).getInstance(),fe=(0,E.default)(j).getInstance(),me=(0,g.default)(j).getInstance(),V}U.__dashjs_factory_name="MediaPlayer";var j=C.default.getClassFactory(U);j.events=M.default,j.errors=w.default,C.default.updateClassFactory(U.__dashjs_factory_name,j),t.default=j,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(13)),a=r(n(26)),o=r(n(12)),s=r(n(14)),u=r(n(3)),l=r(n(155)),c=r(n(29));function d(e,t,n,r){var u=this.context,d=(0,o.default)(u).getInstance(),h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=[],y=[],_=n;function b(){try{return p.buffered}catch(e){return f.error("getAllBufferRanges exception: "+e.message),null}}function E(){var e=this,t=this;y.length>0&&function(){m=!0;var n=y[0];y.splice(0,1);var r=[],i=function(){var e=b();!function(e,t,n,r){t&&t.length>0&&t.length<n.length&&function(e,t){for(var n=0;n<e.length;n++){var r=Math.round(e.start(n)),i=Math.round(e.end(n));if(i===t.start||r===t.end||t.start>=r&&t.end<=i)return!0}return!1}(t,r)&&d.trigger(s.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:e,from:n.end(n.length-2),to:n.start(n.length-1),unintended:!0})}(t,r,e,n),y.length>0?E.call(this):(m=!1,_&&_({chunk:n}))};try{0===n.bytes.length?i.call(e):(r=b(),p.appendBuffer?p.appendBuffer(n.bytes):p.append(n.bytes,n),x(p,i.bind(e)))}catch(e){f.fatal('SourceBuffer append failed "'+e+'"'),y.length>0?E():m=!1,_&&_({chunk:n,error:new a.default(e.code,e.message)})}}()}function T(){if(v.length>0){var e=v.shift();p.updating?x(p,e):(e(),T())}}function S(){p.updating||T()}function w(){p.updating||T()}function A(){f.error("SourceBufferSink error",t.type)}function x(e,t){v.push(t),e.updating||T()}return h={getAllBufferRanges:b,getBuffer:function(){return p},append:function(e){e?(y.push(e),m||x(p,E.bind(this))):_({chunk:e,error:new a.default(c.default.APPEND_ERROR_CODE,c.default.APPEND_ERROR_MESSAGE)})},remove:function(t,n,r){var i=this;x(p,(function(){try{t>=0&&n>t&&(r||"ended"!==e.readyState)&&p.remove(t,n),x(p,(function(){d.trigger(s.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:i,from:t,to:n,unintended:!1})}))}catch(e){d.trigger(s.default.SOURCEBUFFER_REMOVE_COMPLETED,{buffer:i,from:t,to:n,unintended:!1,error:new a.default(e.code,e.message)})}}))},abort:function(){try{("open"===e.readyState||p.setTextTrack&&"ended"===e.readyState)&&p.abort()}catch(e){f.error('SourceBuffer append abort failed: "'+e+'"')}y=[]},reset:function(t){if(p){if("function"==typeof p.removeEventListener&&(p.removeEventListener("updateend",w,!1),p.removeEventListener("error",A,!1),p.removeEventListener("abort",A,!1)),clearInterval(g),!t){try{p.getClassName&&"TextSourceBuffer"===p.getClassName()||e.removeSourceBuffer(p)}catch(e){f.error("Failed to remove source buffer from media source.")}p=null}m=!1}y=[],_=null},updateTimestampOffset:function(e){p.timestampOffset===e||isNaN(e)||x(p,(function(){p.timestampOffset=e}))},hasDiscontinuitiesAfter:function(e){try{var t=b();if(t&&t.length>1)for(var n=0,r=t.length;n<r;n++)if(n>0&&e<t.start(n)&&t.start(n)>t.end(n-1)+.1)return!0}catch(e){f.error("hasDiscontinuities exception: "+e.message)}return!1}},function(){f=(0,i.default)(u).getInstance().getLogger(h),m=!1;var n=t.codec;try{if(n.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))throw new Error("not really supported");(p=r||e.addSourceBuffer(n)).changeType&&r&&(f.debug("Doing period transition with changeType"),p.changeType(n));if("function"==typeof p.addEventListener)try{p.addEventListener("updateend",w,!1),p.addEventListener("error",A,!1),p.addEventListener("abort",A,!1)}catch(e){g=setInterval(S,50)}else g=setInterval(S,50)}catch(e){if(!t.isText&&-1===n.indexOf('codecs="stpp')&&-1===n.indexOf('codecs="wvtt'))throw e;var a=(0,l.default)(u).getInstance();p=a.getTextSourceBuffer()}}(),h}d.__dashjs_factory_name="SourceBufferSink";var h=u.default.getClassFactory(d);t.default=h,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r},o=n(76);function s(){return{customTimeRangeArray:[],length:0,add:function(e,t){var n=0;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return(0,o.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return(0,o.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}s.__dashjs_factory_name="CustomTimeRanges",t.default=a.default.getClassFactory(s),e.exports=t.default},function(e,t,n){"use strict";!function(e){var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},n=function(e){var n=e;return t.hasOwnProperty(e)&&(n=t[e]),String.fromCharCode(n)},r=15,i=32,a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},o={17:2,18:4,21:6,22:8,23:10,19:13,20:15},s={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},u={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],c={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}},d=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t},h=function(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1};h.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var f=function(e,t,n,r,i,a){this.uchar=e||" ",this.penState=new h(t,n,r,i,a)};f.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var p=function(){this.chars=[];for(var e=0;e<i;e++)this.chars.push(new f);this.pos=0,this.currPenState=new h};p.prototype={equals:function(e){for(var t=!0,n=0;n<i;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<i;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<i;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(c.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(c.log("ERROR","Too large cursor position "+this.pos),this.pos=i)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=n(e);this.pos>=i?c.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<i;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<i;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var m=function(){this.rows=[];for(var e=0;e<r;e++)this.rows.push(new p);this.currRow=14,this.nrRollUpRows=null,this.reset()};m.prototype={reset:function(){for(var e=0;e<r;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,n=0;n<r;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<r;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<r;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){c.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){c.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var r=e.indent,i=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){c.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null!==this.nrRollUpRows){c.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),c.log("INFO","Rolling up")}else c.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",i=-1,a=0;a<r;a++){var o=this.rows[a].getTextString();o&&(i=a+1,e?t.push("Row "+i+': "'+o+'"'):t.push(o.trim()))}return t.length>0&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};var g=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new m,this.nonDisplayedMemory=new m,this.lastOutputScreen=new m,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};g.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,c.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";c.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(c.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){c.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){c.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){c.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){c.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){c.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){c.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){c.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){c.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){c.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){c.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){c.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(c.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,c.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){c.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}c.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=c.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var v=function(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new g(1,t),new g(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};v.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,r,i,a=!1;this.lastTime=e,c.setTime(e);for(var o=0;o<t.length;o+=2)if(r=127&t[o],i=127&t[o+1],r>=16&&r<=31&&r===this.lastCmdA&&i===this.lastCmdB)this.lastCmdA=null,this.lastCmdB=null,c.log("DEBUG","Repeated command ("+d([r,i])+") is dropped");else if(0!==r||0!==i){if(c.log("DATA","["+d([t[o],t[o+1]])+"] -> ("+d([r,i])+")"),(n=this.parseCmd(r,i))||(n=this.parseMidrow(r,i)),n||(n=this.parsePAC(r,i)),n||(n=this.parseBackgroundAttributes(r,i)),!n)if(a=this.parseChars(r,i))if(this.currChNr&&this.currChNr>=0)this.channels[this.currChNr-1].insertChars(a);else c.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,c.log("WARNING","Couldn't parse cleaned data "+d([r,i])+" orig: "+d([t[o],t[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(e,t){var n=null;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&33<=t&&t<=35))return!1;n=20===e||21===e||23===e?1:2;var r=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?r.cc_RCL():33===t?r.cc_BS():34===t?r.cc_AOF():35===t?r.cc_AON():36===t?r.cc_DER():37===t?r.cc_RU(2):38===t?r.cc_RU(3):39===t?r.cc_RU(4):40===t?r.cc_FON():41===t?r.cc_RDC():42===t?r.cc_TR():43===t?r.cc_RTD():44===t?r.cc_EDM():45===t?r.cc_CR():46===t?r.cc_ENM():47===t&&r.cc_EOC():r.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return c.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.insertChars([32]),r.cc_MIDROW(t),c.log("DEBUG","MIDROW ("+d([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var n,r=null;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return!1;n=e<=23?1:2,r=64<=t&&t<=95?1===n?a[e]:s[e]:1===n?o[e]:u[e];var i=this.interpretPAC(r,t);return this.channels[n-1].setPAC(i),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=t>95?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},parseChars:function(e,t){var r=null,i=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),17<=a&&a<=19){var o=t;o=17===a?t+80:18===a?t+112:t+144,c.log("INFO","Special char '"+n(o)+"' in channel "+r),i=[o],this.lastCmdA=e,this.lastCmdB=t}else 32<=e&&e<=127&&(i=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null);if(i){var s=d(i);c.log("DEBUG","Char codes =  "+s.join(","))}return i},parseBackgroundAttributes:function(e,t){var n,r,i;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=l[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}};e.logger=c,e.PenState=h,e.CaptionScreen=m,e.Cea608Parser=v,e.findCea608Nalus=function(e,t,n){for(var r=0,i=t,a=[],o=function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),a=n.getUint16(r+1),o=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==a&&1195456820==o&&3==s};i<t+n;){if(r=e.getUint32(i),6===(31&e.getUint8(i+4)))for(var s=i+5,u=-1;s<i+4+r-1;){u=0;for(var l=255;255===l;)u+=l=e.getUint8(s),s++;var c=0;for(l=255;255===l;)c+=l=e.getUint8(s),s++;o(u,c,e,s)&&a.push([s,c]),s+=c}i+=r+4}return a},e.extractCea608DataFromRange=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var a=0;a<i;a++){var o=e.getUint8(n),s=4&o,u=3&o;n++;var l=e.getUint8(n);n++;var c=e.getUint8(n);n++,s&&(127&l)+(127&c)!=0&&(0===u?(r[0].push(l),r[0].push(c)):1===u&&(r[1].push(l),r[1].push(c)))}return r}}(t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1064)),a=r(n(1065)),o=r(n(1066)),s=r(n(1067)),u=r(n(1068)),l=r(n(1069)),c=r(n(3)),d=r(n(52)),h="qualitySwitchRules",f="abandonFragmentRules";function p(e){e=e||{};var t=this.context,n=e.mediaPlayerModel,r=e.metricsModel,c=e.dashMetrics,p=void 0,m=void 0;function g(e){return e.filter((function(e){return e.quality>d.default.NO_CHANGE}))}function v(e){var n,r={},i=void 0,a=void 0,o=void 0,s=void 0;if(0!==e.length){for(r[d.default.PRIORITY.STRONG]=d.default.NO_CHANGE,r[d.default.PRIORITY.WEAK]=d.default.NO_CHANGE,r[d.default.PRIORITY.DEFAULT]=d.default.NO_CHANGE,i=0,n=e.length;i<n;i+=1)(a=e[i]).quality!==d.default.NO_CHANGE&&(r[a.priority]=r[a.priority]>d.default.NO_CHANGE?Math.min(r[a.priority],a.quality):a.quality);return r[d.default.PRIORITY.WEAK]!==d.default.NO_CHANGE&&(o=r[d.default.PRIORITY.WEAK]),r[d.default.PRIORITY.DEFAULT]!==d.default.NO_CHANGE&&(o=r[d.default.PRIORITY.DEFAULT]),r[d.default.PRIORITY.STRONG]!==d.default.NO_CHANGE&&(o=r[d.default.PRIORITY.STRONG]),o!==d.default.NO_CHANGE&&(s=o),(0,d.default)(t).create(s)}}return{initialize:function(){p=[],m=[],n.getUseDefaultABRRules()&&(p.push((0,l.default)(t).create({metricsModel:r,dashMetrics:c,mediaPlayerModel:n})),p.push((0,i.default)(t).create({metricsModel:r,dashMetrics:c})),p.push((0,a.default)(t).create({metricsModel:r,dashMetrics:c})),p.push((0,u.default)(t).create()),p.push((0,s.default)(t).create()),m.push((0,o.default)(t).create({metricsModel:r,dashMetrics:c,mediaPlayerModel:n}))),n.getABRCustomRules().forEach((function(e){e.type===h&&p.push(e.rule(t).create()),e.type===f&&m.push(e.rule(t).create())}))},reset:function(){[p,m].forEach((function(e){e&&e.length&&e.forEach((function(e){return e.reset&&e.reset()}))})),p=[],m=[]},getMaxQuality:function(e){return v(g(p.map((function(t){return t.getMaxIndex(e)}))))||(0,d.default)(t).create()},shouldAbandonFragment:function(e){return v(g(m.map((function(t){return t.shouldAbandon(e)}))))||(0,d.default)(t).create()}}}p.__dashjs_factory_name="ABRRulesCollection";var m=c.default.getClassFactory(p);m.QUALITY_SWITCH_RULES=h,m.ABANDON_FRAGMENT_RULES=f,c.default.updateSingletonFactory(p.__dashjs_factory_name,m),t.default=m,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){r(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};i.INITIAL_PLAYOUT_START_REASON="initial_playout",i.SEEK_START_REASON="seek",i.RESUME_FROM_PAUSE_START_REASON="resume",i.METRICS_COLLECTION_START_REASON="metrics_collection_start";var a=function e(){r(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};a.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",a.REBUFFERING_REASON="rebuffering",a.USER_REQUEST_STOP_REASON="user_request",a.END_OF_PERIOD_STOP_REASON="end_of_period",a.END_OF_CONTENT_STOP_REASON="end_of_content",a.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",a.FAILURE_STOP_REASON="failure",t.PlayList=i,t.PlayListTrace=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(116)),a=r(n(159)),o=r(n(26)),s=r(n(14)),u=r(n(12)),l=r(n(95)),c=r(n(3)),d=r(n(13)),h=n(32),f=r(n(63)),p=r(n(96)),m=r(n(29));function g(){var e=this.context,t=(0,u.default)(e).getInstance(),n=void 0,r=void 0,c=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0;function T(){if(!E||!E.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function S(e){if(e.url){var t=new f.default;return t.type=e.init?h.HTTPRequest.INIT_SEGMENT_TYPE:h.HTTPRequest.MEDIA_SEGMENT_TYPE,t.url=e.url,t.range=e.range.start+"-"+e.range.end,t}}function w(e,n,r){e?t.trigger(s.default.SEGMENTS_LOADED,{segments:e,representation:n,mediaType:r}):t.trigger(s.default.SEGMENTS_LOADED,{segments:null,representation:n,mediaType:r,error:new o.default(m.default.SEGMENT_BASE_LOADER_ERROR_CODE,m.default.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}return n={setConfig:function(e){e.baseURLController&&(E=e.baseURLController),e.metricsModel&&(y=e.metricsModel),e.mediaPlayerModel&&(_=e.mediaPlayerModel),e.errHandler&&(c=e.errHandler)},initialize:function(){g=(0,l.default)(e).getInstance(),v=(0,i.default)(e).getInstance(),b=(0,p.default)(e).create({errHandler:c,metricsModel:y,mediaPlayerModel:_,requestModifier:v})},loadInitialization:function e(n,i){T();var a=null,o=E.resolve(n.path),u=i||{init:!0,url:o?o.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500};r.debug("Start searching for initialization.");var l=S(u);b.load({request:l,success:function(r){u.bytesLoaded=u.range.end,(a=g.findInitRange(r))?(n.range=a,t.trigger(s.default.INITIALIZATION_LOADED,{representation:n})):(u.range.end=u.bytesLoaded+u.bytesToLoad,e(n,u))},error:function(){t.trigger(s.default.INITIALIZATION_LOADED,{representation:n})}}),r.debug("Perform init search: "+u.url)},loadSegments:function e(t,n,i,o,s){if(T(),i&&(void 0===i.start||void 0===i.end)){var u=i?i.toString().split("-"):null;i=u?{start:parseFloat(u[0]),end:parseFloat(u[1])}:null}s=s||w;var l=null,c=null,d=!!i,h=E.resolve(t.path),f={init:!1,url:h?h.url:void 0,range:d?i:{start:0,end:1500},searching:!d,bytesLoaded:o?o.bytesLoaded:0,bytesToLoad:1500},p=S(f);b.load({request:p,success:function(i){var o=f.bytesToLoad,u=i.byteLength;if(f.bytesLoaded=f.range.end-f.range.start,l=g.parse(i),(c=l.getBox("sidx"))&&c.isComplete){var d=c.references,h=void 0,p=void 0;null!=d&&d.length>0&&(h=1===d[0].reference_type),h?function(){r.debug("Initiate multiple SIDX load."),f.range.end=f.range.start+c.size;var i=void 0,a=void 0,o=void 0,u=void 0,l=[],h=0,p=(c.offset||f.range.start)+c.size,m=function(e){e?(l=l.concat(e),++h>=a&&s(l,t,n)):s(null,t,n)};for(i=0,a=d.length;i<a;i++)o=p,u=p+d[i].referenced_size-1,p+=d[i].referenced_size,e(t,null,{start:o,end:u},f,m)}():(r.debug("Parsing segments from SIDX."),p=function(e,t){for(var n=e.references,r=n.length,i=e.timescale,o=e.earliest_presentation_time,s=t.range.start+e.offset+e.first_offset+e.size,u=[],l=void 0,c=void 0,d=void 0,h=void 0,f=0;f<r;f++)d=n[f].subsegment_duration,h=n[f].referenced_size,(l=new a.default).duration=d,l.startTime=o,l.timescale=i,c=s+h-1,l.mediaRange=s+"-"+c,u.push(l),o+=d,s+=h;return u}(c,f),s(p,t,n))}else{if(c)f.range.start=c.offset||f.range.start,f.range.end=f.range.start+(c.size||o);else{if(u<f.bytesLoaded)return void s(null,t,n);var m=l.getLastBox();m&&m.size?(f.range.start=m.offset+m.size,f.range.end=f.range.start+o):f.range.end+=o}e(t,n,f.range,f,s)}},error:function(){s(null,t,n)}}),r.debug("Perform SIDX load: "+f.url)},reset:function(){b.abort(),b=null,c=null,g=null,v=null}},r=(0,d.default)(e).getInstance().getLogger(n),n}g.__dashjs_factory_name="SegmentBaseLoader",t.default=c.default.getSingletonFactory(g),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(39)),o=r(n(3)),s=r(n(1099)),u=r(n(55)),l=n(64),c=r(n(214)),d=r(n(95)),h=r(n(161)),f=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function p(e){var t,n=this.context,r=e.dashManifestModel,o=e.adapter,p=e.baseURLController,m=e.stream,g=e.timelineConverter,v=e.metricsModel,y=e.mediaPlayerModel,_=e.errHandler,b=(0,u.default)(n).getInstance(),E=void 0,T=void 0,S=void 0,w=void 0,A=void 0;function x(){C(),S=(0,h.default)(n).create({}),A=(0,d.default)(n).getInstance(),(w=(0,c.default)(n).getInstance()).setConfig({baseURLController:p,metricsModel:v,mediaPlayerModel:y,errHandler:_}),function(){if(!m||!r||!o)return;var e=m.getStreamInfo();if(!e)return;var t=o.getMediaInfoForType(e,i.default.IMAGE);if(!t)return;var n=o.getDataForMedia(t);if(!n)return;var s=r.getRepresentationsForAdaptation(n);s&&s.length>0&&s.forEach((function(e){e.segmentInfoType===a.default.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media&&M(e),e.segmentInfoType===a.default.SEGMENT_BASE&&M(e,!0)}));E.length>0&&(E.sort((function(e,t){return e.bitrate-t.bitrate})),T=E.length-1)}()}function M(e,t){var n=new s.default;n.id=e.id,n.bitrate=e.bandwidth,n.width=e.width,n.height=e.height,n.tilesHor=1,n.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach((function(e){if(f.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(n.tilesHor=parseInt(t[0],10),n.tilesVert=parseInt(t[1],10))}})),t?w.loadSegments(e,i.default.IMAGE,e.indexRange,{},(function(e,t){var i=[];e=function(e,t){var n,i=[],a=0,o=void 0,s=void 0,u=void 0;for(o=0,n=e.length;o<n;o++)s=e[o],u=(0,l.getTimeBasedSegment)(g,r.getIsDynamic(),t,s.startTime,s.duration,s.timescale,s.media,s.mediaRange,a),i.push(u),u=null,a++;return i}(e,t),n.segmentDuration=e[0].duration,n.readThumbnail=function(n,r){var a=null;i.some((function(e){if(e.start<=n&&e.end>n)return a=e.url,!0})),a?r(a):e.some((function(e){if(e.mediaStartTime<=n&&e.mediaStartTime+e.duration>n){var a=p.resolve(t.path);return S.load({method:"get",url:a.url,request:{range:e.mediaRange,responseType:"arraybuffer"},onload:function(t){var n=A.getSamplesInfo(t.target.response),a=new Blob([t.target.response.slice(n.sampleList[0].offset,n.sampleList[0].offset+n.sampleList[0].size)],{type:"image/jpeg"}),o=window.URL.createObjectURL(a);i.push({start:e.mediaStartTime,end:e.mediaStartTime+e.duration,url:o}),r&&r(o)}}),!0}}))}})):(n.startNumber=e.startNumber,n.segmentDuration=e.segmentDuration,n.timescale=e.timescale,n.templateUrl=function(e){var t=b.isRelative(e.media)?b.resolve(e.media,p.resolve(e.path).url):e.media;if(!t)return"";return(0,l.replaceIDForTemplate)(t,e.id)}(e)),n.tilesHor>0&&n.tilesVert>0&&(n.widthPerTile=n.width/n.tilesHor,n.heightPerTile=n.height/n.tilesVert,E.push(n))}function C(){E=[],T=-1}return t={initialize:x,getTracks:function(){return E},reset:C,setTrackByIndex:function(e){E&&0!==E.length&&(e>=E.length&&(e=E.length-1),T=e)},getCurrentTrack:function(){return T<0?null:E[T]},getCurrentTrackIndex:function(){return T}},x(),t}t.THUMBNAILS_SCHEME_ID_URIS=f,p.__dashjs_factory_name="ThumbnailTracks",t.default=o.default.getClassFactory(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(114),a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.AST_IN_FUTURE="astInFuture",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_LOADED="bufferLoaded",this.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",this.ERROR="error",this.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",this.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",this.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",this.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",this.LOG="log",this.MANIFEST_LOADED="manifestLoaded",this.METRICS_CHANGED="metricsChanged",this.METRIC_CHANGED="metricChanged",this.METRIC_ADDED="metricAdded",this.METRIC_UPDATED="metricUpdated",this.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",this.PERIOD_SWITCH_STARTED="periodSwitchStarted",this.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",this.QUALITY_CHANGE_RENDERED="qualityChangeRendered",this.TRACK_CHANGE_RENDERED="trackChangeRendered",this.SOURCE_INITIALIZED="sourceInitialized",this.STREAM_INITIALIZED="streamInitialized",this.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",this.TEXT_TRACKS_ADDED="allTextTracksAdded",this.TEXT_TRACK_ADDED="textTrackAdded",this.TTML_PARSED="ttmlParsed",this.TTML_TO_PARSE="ttmlToParse",this.CAPTION_RENDERED="captionRendered",this.CAPTION_CONTAINER_RESIZE="captionContainerResize",this.CAN_PLAY="canPlay",this.PLAYBACK_ENDED="playbackEnded",this.PLAYBACK_ERROR="playbackError",this.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",this.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",this.PLAYBACK_PAUSED="playbackPaused",this.PLAYBACK_PLAYING="playbackPlaying",this.PLAYBACK_PROGRESS="playbackProgress",this.PLAYBACK_RATE_CHANGED="playbackRateChanged",this.PLAYBACK_SEEKED="playbackSeeked",this.PLAYBACK_SEEKING="playbackSeeking",this.PLAYBACK_SEEK_ASKED="playbackSeekAsked",this.PLAYBACK_STALLED="playbackStalled",this.PLAYBACK_STARTED="playbackStarted",this.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",this.PLAYBACK_WAITING="playbackWaiting",this.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged"}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1102)),a=r(n(1104)),o=r(n(55)),s=r(n(219)),u=r(n(3)),l=r(n(12)),c=r(n(14));function d(){var e=void 0,t=void 0,n=this.context,r=(0,l.default)(n).getInstance(),u=(0,o.default)(n).getInstance(),d=void 0,h=void 0;function f(e){d.invalidateSelectedIndexes(e.entry)}return e={reset:function(){d.reset(),h.reset()},initialize:function(e){var n;d.setConfig({dashManifestModel:t}),h.setConfig({dashManifestModel:t}),n=e,d.update(n),h.chooseSelectorFromManifest(n)},resolve:function(e){var t=d.getForPath(e).reduce((function(e,t){var n=h.select(t);return n?(u.isRelative(n.url)?e.url=u.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e):new s.default}),new s.default);if(!u.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(d=e.baseURLTreeModel),e.baseURLSelector&&(h=e.baseURLSelector),e.dashManifestModel&&(t=e.dashManifestModel)}},d=(0,i.default)(n).create(),h=(0,a.default)(n).create(),r.on(c.default.SERVICE_LOCATION_BLACKLIST_CHANGED,f,e),e}d.__dashjs_factory_name="BaseURLController",t.default=u.default.getSingletonFactory(d),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(1103));function o(){return{areEqual:function(e,t){return(0,a.default)(e,t)}}}o.__dashjs_factory_name="ObjectUtils",t.default=i.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvb_priority=r||1,this.dvb_weight=i||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};r.DEFAULT_DVB_PRIORITY=1,r.DEFAULT_DVB_WEIGHT=1,t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return e&&e.__esModule?e:{default:e}}var i=r(n(11)),a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.url=e||null,this.type=n||null,this.mediaType=i.default.STREAM,this.responseType=""}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r(n(63)).default);t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e=e||{},function(){void 0===e.escapeMode&&(e.escapeMode=!0);void 0===e.attributePrefix&&(e.attributePrefix="_");e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0);e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0);void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0);e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1);e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1);void 0===e.ignoreRoot&&(e.ignoreRoot=!1)}();var t=1,n=3,r=4,i=8,a=9;function o(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function s(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function u(e,t,n,r){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==r)break}else if(a instanceof RegExp){if(a.test(r))break}else if("function"==typeof a&&a(t,n,r))break}return i!=e.length}function l(t,n,r){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&u(e.arrayAccessFormPaths,t,n,r)&&(t[n]=[t[n]])}function c(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function d(n,r,i,a){return!(r==t&&e.xmlElementsFilter.length>0)||u(e.xmlElementsFilter,n,i,a)}function h(s,f){if(s.nodeType==a){for(var p=new Object,m=s.childNodes,g=0;g<m.length;g++){if((y=m[g]).nodeType==t)if(e.ignoreRoot)p=h(y);else(p={})[_=o(y)]=h(y)}return p}if(s.nodeType==t){(p=new Object).__cnt=0;var v=[];for(m=s.childNodes,g=0;g<m.length;g++){var y,_=o(y=m[g]);if(y.nodeType!=i){var b=f+"."+_;if(d(p,y.nodeType,_,b))if(p.__cnt++,null==p[_]){var E=h(y,b);if("#text"!=_||/[^\s]/.test(E))(T={})[_]=E,v.push(T);p[_]=E,l(p,_,b)}else{null!=p[_]&&(p[_]instanceof Array||(p[_]=[p[_]],l(p,_,b)));var T;E=h(y,b);if("#text"!=_||/[^\s]/.test(E))(T={})[_]=E,v.push(T);p[_][p[_].length]=E}}}p.__children=v;for(var S=o(s),w=0;w<s.attributes.length;w++){var A=s.attributes[w];p.__cnt++;for(var x=A.value,M=0,C=e.matchers.length;M<C;M++){var R=e.matchers[M];R.test(A,S)&&(x=R.converter(A.value))}p[e.attributePrefix+A.name]=x}var I=function(e){return e.prefix}(s);return null!=I&&""!=I&&(p.__cnt++,p.__prefix=I),null!=p["#text"]&&(p.__text=p["#text"],p.__text instanceof Array&&(p.__text=p.__text.join("\n")),e.stripWhitespaces&&(p.__text=p.__text.trim()),delete p["#text"],"property"==e.arrayAccessForm&&delete p["#text_asArray"],p.__text=function(t,n,r){if(e.datetimeAccessFormPaths.length>0){var i=r.split(".#")[0];return u(e.datetimeAccessFormPaths,t,n,i)?c(t):t}return t}(p.__text,_,f+"."+_)),null!=p["#cdata-section"]&&(p.__cdata=p["#cdata-section"],delete p["#cdata-section"],"property"==e.arrayAccessForm&&delete p["#cdata-section_asArray"]),0==p.__cnt&&"text"==e.emptyNodeForm?p="":1==p.__cnt&&null!=p.__text?p=p.__text:1!=p.__cnt||null==p.__cdata||e.keepCData?p.__cnt>1&&null!=p.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==p.__text||""==p.__text.trim())&&delete p.__text:p=p.__cdata,delete p.__cnt,!e.enableToStringFunc||null==p.__text&&null==p.__cdata||(p.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),p}if(s.nodeType==n||s.nodeType==r)return s.nodeValue}function f(t,n,r,i){var a="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=r)for(var o=0;o<r.length;o++){var u=r[o],l=t[u];e.escapeMode&&(l=s(l)),a+=" "+u.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?a+='"'+l+'"':a+="'"+l+"'"}return a+=i?"/>":">"}function p(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function m(t,n){return"property"==e.arrayAccessForm&&(r=n.toString(),i="_asArray",-1!==r.indexOf(i,r.length-i.length))||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function;var r,i}function g(e){var t=0;if(e instanceof Object)for(var n in e)m(e,n)||t++;return t}function v(t,n,r){return 0==e.jsonPropertiesFilter.length||""==r||u(e.jsonPropertiesFilter,t,n,r)}function y(t){var n=[];if(t instanceof Object)for(var r in t)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(e.attributePrefix)&&n.push(r);return n}function _(t){var n="";return t instanceof Object?n+=function(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?n+=s(t.__text):n+=t.__text),n}(t):null!=t&&(e.escapeMode?n+=s(t):n+=t),n}function b(e,t){return""===e?t:e+"."+t}function E(e,t,n,r){var i="";if(0==e.length)i+=f(e,t,n,!0);else for(var a=0;a<e.length;a++)i+=f(e[a],t,y(e[a]),!1),i+=T(e[a],b(r,t)),i+=p(e[a],t);return i}function T(e,t){var n="";if(g(e)>0)for(var r in e)if(!m(e,r)&&(""==t||v(e,r,b(t,r)))){var i=e[r],a=y(i);if(null==i||null==i)n+=f(i,r,a,!0);else if(i instanceof Object)if(i instanceof Array)n+=E(i,r,a,t);else if(i instanceof Date)n+=f(i,r,a,!1),n+=i.toISOString(),n+=p(i,r);else{g(i)>0||null!=i.__text||null!=i.__cdata?(n+=f(i,r,a,!1),n+=T(i,b(t,r)),n+=p(i,r)):n+=f(i,r,a,!0)}else n+=f(i,r,a,!1),n+=_(i),n+=p(i,r)}return n+=_(e)}this.parseXmlString=function(e){var t;window.ActiveXObject||window;if(void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser;try{(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?c(e):e},this.xml2json=function(e){return h(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return T(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i,a=n(1119),o=(i=a)&&i.__esModule?i:{default:i},s=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t||"",this._properties=[],this._children=r||[],Array.isArray(n)&&n.forEach((function(e){i._properties.push(new o.default(e))}))}return r(e,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),e}();t.default=s,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getVersionString=function(){return"2.9.3"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(1160),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t={"urn:dvb:dash:reporting:2014":a.default},n=this.context,r=e.debug,i=e.metricsConstants;return{create:function(e,a){var o=void 0;try{(o=t[e.schemeIdUri](n).create({metricsConstants:i})).initialize(e,a)}catch(t){o=null,r.error("ReportingFactory: could not create Reporting with schemeIdUri "+e.schemeIdUri+" ("+t.message+")")}return o},register:function(e,n){t[e]=n},unregister:function(e){delete t[e]}}}o.__dashjs_factory_name="ReportingFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1164)),a=r(n(1165)),o=r(n(1166)),s=r(n(1167));function u(e){var t=(e=e||{}).debug,n=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,r=this.context,u={BufferLevel:i.default,DVBErrors:a.default,HttpList:o.default,PlayList:s.default,RepSwitchList:s.default,TcpList:s.default};return{create:function(i,a){var o,s=i.match(n);if(s){try{(o=u[s[1]](r).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants})).initialize(s[1],a,s[3],s[5])}catch(e){o=null,t.error("MetricsHandlerFactory: Could not create handler for type "+s[1]+" with args "+s[3]+", "+s[5]+" ("+e.message+")")}return o}},register:function(e,t){u[e]=t},unregister:function(e){delete u[e]}}}u.__dashjs_factory_name="MetricsHandlerFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(u),e.exports=t.default},function(e,t,n){"use strict";function r(){return{reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="HandlerHelpers",t.default=dashjs.FactoryMaker.getSingletonFactory(r),e.exports=t.default},function(e,t,n){"use strict";n(230),n(231),n(232),n(233),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(259),n(260),n(261),n(262),n(263),n(264),n(265),n(266),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355),n(356),n(357),n(358),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(385),n(386),n(387),n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(395),n(396),n(397),n(398),n(399),n(400),n(401),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(459),n(460),n(461),n(462),n(463),n(464),n(465),n(466),n(467),n(468),n(469),n(470),n(471),n(472),n(473),n(474),n(475),n(476),n(477),n(478),n(479),n(480),n(481),n(482),n(483),n(484),n(485),n(486),n(487),n(488),n(489),n(490),n(491),n(492),n(493),n(494),n(495),n(496),n(497),n(498),n(499),n(500),n(501),n(502),n(503),n(504),n(505),n(506),n(507),n(508),n(509),n(510),n(511),n(512),n(513),n(514),n(515),n(516),n(517),n(518),n(519),n(520),n(521),n(522),n(523),n(524),n(525),n(526),n(527),n(528),n(529),n(530),n(531),n(532),n(533),n(534),n(535),n(536),n(537),n(538),n(539),n(540),n(541),n(542),n(543),n(544),n(545),n(546),n(547),n(548),n(549),n(550),n(551),n(552),n(553),n(554),n(555),n(556),n(557),n(558),n(559),n(560),n(561),n(562),n(563),n(564),n(565),n(566),n(567),n(568),n(569),n(570),n(571),n(572),n(573),n(574),n(575),n(576),n(577),n(578),n(579),n(580),n(581),n(582),n(583),n(584),n(585),n(586),n(587),n(588),n(589),n(590),n(591),n(592),n(593),n(594),n(595),n(596),n(597),n(598),n(599),n(600),n(601),n(602),n(603),n(604),n(605),n(606),n(607),n(608),n(609),n(610),n(611),n(612),n(613),n(614),n(615),n(616),n(617),n(618),n(619),n(620),n(621),n(622),n(623),n(624),n(625),n(626),n(627),n(628),n(629),n(630),n(631),n(632),n(633),n(634),n(635),n(636),n(637),n(638),n(639),n(640),n(641),n(642),n(643),n(644),n(645),n(646),n(647),n(648),n(649),n(650),n(651),n(652),n(653),n(654),n(655),n(656),n(657),n(658),n(659),n(660),n(661),n(662),n(663),n(664),n(665),n(666),n(667),n(668),n(669),n(670),n(671),n(672),n(673),n(674),n(675),n(676),n(677),n(678),n(679),n(680),n(681),n(682),n(683),n(684),n(685),n(686),n(687),n(688),n(689),n(690),n(691),n(692),n(693),n(694),n(695),n(696),n(697)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){e.exports=function(e,t){var n,r=null;try{n=JSON.parse(e,t)}catch(e){r=e}return[r,n]}},function(e,t,n){var r=n(201),i=n(1045);function a(t,n,o){return i()?e.exports=a=Reflect.construct:e.exports=a=function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&r(a,n.prototype),a},a.apply(null,arguments)}e.exports=a},function(e,t,n){var r=n(201);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){"use strict";(function(t){var r,i=(r=n(0))&&"object"==typeof r&&"default"in r?r.default:r;e.exports=function(e){for(var n=function(e){return i.atob?i.atob(e):t.from(e,"base64").toString("binary")}(e),r=new Uint8Array(n.length),a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return r}}).call(this,n(106).Buffer)},function(e,t,n){function r(e){this.options=e||{locator:{}}}function i(){this.cdata=!1}function a(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function o(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function s(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function u(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}r.prototype.parseFromString=function(e,t){var n=this.options,r=new l,a=n.domBuilder||new i,s=n.errorHandler,u=n.locator,c=n.xmlns||{},d={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return u&&a.setDocumentLocator(u),r.errorHandler=function(e,t,n){if(!e){if(t instanceof i)return t;e=t}var r={},a=e instanceof Function;function s(t){var i=e[t];!i&&a&&(i=2==e.length?function(n){e(t,n)}:e),r[t]=i&&function(e){i("[xmldom "+t+"]\t"+e+o(n))}||function(){}}return n=n||{},s("warning"),s("error"),s("fatalError"),r}(s,a,u),r.domBuilder=n.domBuilder||a,/\/x?html?$/.test(t)&&(d.nbsp="",d.copy="",c[""]="http://www.w3.org/1999/xhtml"),c.xml=c.xml||"http://www.w3.org/XML/1998/namespace",e?r.parse(e,c,d):r.errorHandler.error("invalid doc source"),a.doc},i.prototype={startDocument:function(){this.doc=(new c).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var i=this.doc,o=i.createElementNS(e,n||t),s=r.length;u(this,o),this.currentElement=o,this.locator&&a(this.locator,o);for(var l=0;l<s;l++){e=r.getURI(l);var c=r.getValue(l),d=(n=r.getQName(l),i.createAttributeNS(e,n));this.locator&&a(r.getLocator(l),d),d.value=d.nodeValue=c,o.setAttributeNode(d)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&a(this.locator,n),u(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=s.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(e);else r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&a(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=s.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&a(this.locator,r),u(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(e,t,n);this.locator&&a(this.locator,i),u(this,i)}},warning:function(e){console.warn("[xmldom warning]\t"+e,o(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,o(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,o(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){i.prototype[e]=function(){return null}}));var l=n(1046).XMLReader,c=t.DOMImplementation=n(202).DOMImplementation;t.XMLSerializer=n(202).XMLSerializer,t.DOMParser=r},function(e,t,n){"use strict";var r=n(203).discardEmulationPreventionBytes,i=n(1047).CaptionStream,a=n(82),o=n(120),s=function(e,t){for(var n=e,r=0;r<t.length;r++){var i=t[r];if(n<i.size)return i;n-=i.size}return null},u=function(e,t){var n=a.findBox(e,["moof","traf"]),i=a.findBox(e,["mdat"]),u={},l=[];return i.forEach((function(e,t){var r=n[t];l.push({mdat:e,traf:r})})),l.forEach((function(e){var n,i=e.mdat,l=e.traf,c=a.findBox(l,["tfhd"]),d=o.parseTfhd(c[0]),h=d.trackId,f=a.findBox(l,["tfdt"]),p=f.length>0?o.parseTfdt(f[0]).baseMediaDecodeTime:0,m=a.findBox(l,["trun"]);t===h&&m.length>0&&(n=function(e,t,n){var i,a,o,u,l=new DataView(e.buffer,e.byteOffset,e.byteLength),c=[];for(a=0;a+4<e.length;a+=o)if(o=l.getUint32(a),a+=4,!(o<=0))switch(31&e[a]){case 6:var d=e.subarray(a+1,a+1+o),h=s(a,t);i={nalUnitType:"sei_rbsp",size:o,data:d,escapedRBSP:r(d),trackId:n},h?(i.pts=h.pts,i.dts=h.dts,u=h):(i.pts=u.pts,i.dts=u.dts),c.push(i)}return c}(i,function(e,t,n){var r=t,i=n.defaultSampleDuration||0,a=n.defaultSampleSize||0,s=n.trackId,u=[];return e.forEach((function(e){var t=o.parseTrun(e).samples;t.forEach((function(e){void 0===e.duration&&(e.duration=i),void 0===e.size&&(e.size=a),e.trackId=s,e.dts=r,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=r+e.compositionTimeOffset,r+=e.duration})),u=u.concat(t)})),u}(m,p,d),h),u[h]||(u[h]=[]),u[h]=u[h].concat(n))})),u};e.exports=function(){var e,t,n,r,a,o,s=!1;this.isInitialized=function(){return s},this.init=function(t){e=new i,s=!0,o=!!t&&t.isPartial,e.on("data",(function(e){e.startTime=e.startPts/r,e.endTime=e.endPts/r,a.captions.push(e),a.captionStreams[e.stream]=!0}))},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length)&&(n!==e[0]||r!==t[n])},this.parse=function(e,i,o){var s;if(!this.isInitialized())return null;if(!i||!o)return null;if(this.isNewInit(i,o))n=i[0],r=o[n];else if(null===n||!r)return t.push(e),null;for(;t.length>0;){var l=t.shift();this.parse(l,i,o)}return null!==(s=function(e,t,n){return null===t?null:{seiNals:u(e,t)[t],timescale:n}}(e,n,r))&&s.seiNals?(this.pushNals(s.seiNals),this.flushStream(),a):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach((function(t){e.push(t)}))},this.flushStream=function(){if(!this.isInitialized())return null;o?e.partialFlush():e.flush()},this.clearParsedCaptions=function(){a.captions=[],a.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=null,r=null,a?this.clearParsedCaptions():a={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}},function(e,t,n){"use strict";var r=n(205),i=n(1048).handleRollover,a={};a.ts=n(1049),a.aac=n(1050);var o=n(1051).ONE_SECOND_IN_TS,s=188,u=71,l=function(e,t,n){for(var r,i,o,l,c=0,d=s,h=!1;d<=e.byteLength;)if(e[c]!==u||e[d]!==u&&d!==e.byteLength)c++,d++;else{switch(r=e.subarray(c,d),a.ts.parseType(r,t.pid)){case"pes":i=a.ts.parsePesType(r,t.table),o=a.ts.parsePayloadUnitStartIndicator(r),"audio"===i&&o&&(l=a.ts.parsePesTime(r))&&(l.type="audio",n.audio.push(l),h=!0)}if(h)break;c+=s,d+=s}for(c=(d=e.byteLength)-s,h=!1;c>=0;)if(e[c]!==u||e[d]!==u&&d!==e.byteLength)c--,d--;else{switch(r=e.subarray(c,d),a.ts.parseType(r,t.pid)){case"pes":i=a.ts.parsePesType(r,t.table),o=a.ts.parsePayloadUnitStartIndicator(r),"audio"===i&&o&&(l=a.ts.parsePesTime(r))&&(l.type="audio",n.audio.push(l),h=!0)}if(h)break;c-=s,d-=s}},c=function(e,t,n){for(var r,i,o,l,c,d,h,f=0,p=s,m=!1,g={data:[],size:0};p<e.byteLength;)if(e[f]!==u||e[p]!==u)f++,p++;else{switch(r=e.subarray(f,p),a.ts.parseType(r,t.pid)){case"pes":if(i=a.ts.parsePesType(r,t.table),o=a.ts.parsePayloadUnitStartIndicator(r),"video"===i&&(o&&!m&&(l=a.ts.parsePesTime(r))&&(l.type="video",n.video.push(l),m=!0),!n.firstKeyFrame)){if(o&&0!==g.size){for(c=new Uint8Array(g.size),d=0;g.data.length;)h=g.data.shift(),c.set(h,d),d+=h.byteLength;if(a.ts.videoPacketContainsKeyFrame(c)){var v=a.ts.parsePesTime(c);v?(n.firstKeyFrame=v,n.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}g.size=0}g.data.push(r),g.size+=r.byteLength}}if(m&&n.firstKeyFrame)break;f+=s,p+=s}for(f=(p=e.byteLength)-s,m=!1;f>=0;)if(e[f]!==u||e[p]!==u)f--,p--;else{switch(r=e.subarray(f,p),a.ts.parseType(r,t.pid)){case"pes":i=a.ts.parsePesType(r,t.table),o=a.ts.parsePayloadUnitStartIndicator(r),"video"===i&&o&&(l=a.ts.parsePesTime(r))&&(l.type="video",n.video.push(l),m=!0)}if(m)break;f-=s,p-=s}},d=function(e){var t={pid:null,table:null},n={};for(var i in function(e,t){for(var n,r=0,i=s;i<e.byteLength;)if(e[r]!==u||e[i]!==u)r++,i++;else{switch(n=e.subarray(r,i),a.ts.parseType(n,t.pid)){case"pat":t.pid||(t.pid=a.ts.parsePat(n));break;case"pmt":t.table||(t.table=a.ts.parsePmt(n))}if(t.pid&&t.table)return;r+=s,i+=s}}(e,t),t.table){if(t.table.hasOwnProperty(i))switch(t.table[i]){case r.H264_STREAM_TYPE:n.video=[],c(e,t,n),0===n.video.length&&delete n.video;break;case r.ADTS_STREAM_TYPE:n.audio=[],l(e,t,n),0===n.audio.length&&delete n.audio}}return n};e.exports={inspect:function(e,t){var n;return(n=a.aac.isLikelyAacData(e)?function(e){for(var t,n=!1,r=0,i=null,s=null,u=0,l=0;e.length-l>=3;){switch(a.aac.parseType(e,l)){case"timed-metadata":if(e.length-l<10){n=!0;break}if((u=a.aac.parseId3TagSize(e,l))>e.length){n=!0;break}null===s&&(t=e.subarray(l,l+u),s=a.aac.parseAacTimestamp(t)),l+=u;break;case"audio":if(e.length-l<7){n=!0;break}if((u=a.aac.parseAdtsSize(e,l))>e.length){n=!0;break}null===i&&(t=e.subarray(l,l+u),i=a.aac.parseSampleRate(t)),r++,l+=u;break;default:l++}if(n)return null}if(null===i||null===s)return null;var c=o/i;return{audio:[{type:"audio",dts:s,pts:s},{type:"audio",dts:s+1024*r*c,pts:s+1024*r*c}]}}(e):d(e))&&(n.audio||n.video)?(function(e,t){if(e.audio&&e.audio.length){var n=t;void 0===n&&(n=e.audio[0].dts),e.audio.forEach((function(e){e.dts=i(e.dts,n),e.pts=i(e.pts,n),e.dtsTime=e.dts/o,e.ptsTime=e.pts/o}))}if(e.video&&e.video.length){var r=t;if(void 0===r&&(r=e.video[0].dts),e.video.forEach((function(e){e.dts=i(e.dts,r),e.pts=i(e.pts,r),e.dtsTime=e.dts/o,e.ptsTime=e.pts/o})),e.firstKeyFrame){var a=e.firstKeyFrame;a.dts=i(a.dts,r),a.pts=i(a.pts,r),a.dtsTime=a.dts/o,a.ptsTime=a.dts/o}}}(n,t),n):null},parseAudioPes_:l}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var r=n(42),i=n(129),a=n(21),o=n(89);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=new r.d,r.g(this.context),this.players={},this.listenerForward=new a.Vector3(0,0,0),this.lastOn=null,this.objFwd=new a.Vector3(0,0,0),this.chorusChannel=null,this.chebyChannel=null,this.reverbChannel=null}var n,u,l;return n=t,(u=[{key:"setup",value:function(){console.log("InteractiveAudioSystem setup, loaded extra audio context for tone: "+this.context);var e=new r.c({wet:1}).toDestination().start();this.chorusChannel=new r.a({volume:-60}).connect(e),this.chorusChannel.receive("chorus");var t=new r.b(50).toDestination();this.chebyChannel=new r.a({volume:-60}).connect(t),this.chebyChannel.receive("cheby");var n=new r.f(3).toDestination();this.reverbChannel=new r.a({volume:-60}).connect(n),this.reverbChannel.receive("reverb")}},{key:"spawnGranulator",value:function(e){return this.players[e]=new i.a(e),this.players[e]}},{key:"start",value:function(e){var t=this.players[e];t instanceof i.a&&console.log("This is a granulator class."),null!=t&&(t.active=!0,t.grainTransport(),this._updateSends(-80,-80,-80))}},{key:"transport",value:function(e){var t=this.players[e];null!=t&&t.grainTransport()}},{key:"triggerOn",value:function(e){var t=this.players[e];null!=t&&(t.unmute(),this.lastOn=e)}},{key:"triggerOff",value:function(e){var t=this.players[e];null!=t&&(t.mute(),this.lastOn=null)}},{key:"triggerMashup",value:function(e){var t=this.players[e];if(null!=t)switch(Object(o.b)(0,100)){case 0:t.setGrainSize(Math.random());break;case 1:t.setOverlap(Math.random());break;case 2:t.setLoop(Math.random(),Math.random());break;case 3:t.setSpeed(Object(o.c)(.1,3));break;case 4:t.reverse();break;case 6:t.reset();break;case 7:this._updateSends(-60*Math.random(),-60*Math.random(),-60*Math.random())}}},{key:"_updateSends",value:function(e,t,n){this.chorusChannel.volume.value=e,this.chebyChannel.volume.value=t,this.reverbChannel.volume.value=n}},{key:"_updateSynthesis",value:function(){if(null!=this.lastOn){var t=e.gazeSystem.targets[this.lastOn];if(null!=t){t.cube.getWorldDirection(this.objFwd);var n=this.listenerForward.dot(this.objFwd),r=Object(o.a)(1+n,0,1),i=this._map(r,0,.15,1,0),a=this._map(r,0,.15,0,-12),s=this.players[this.lastOn];null!=s&&(s.detune(-50*i),s.setTrim(a))}}}},{key:"_map",value:function(e,t,n,r,i){var a=(i-r)/(n-t);return a*e+(r-a*t)}},{key:"vecToString",value:function(e){return e.x+" "+e.y+" "+e.z}},{key:"isGranulator",value:function(e){return e.constructor===i.a}},{key:"ListenerForward",set:function(e){this.listenerForward.x=e.x,this.listenerForward.y=e.y,this.listenerForward.z=e.z,this._updateSynthesis()}}])&&s(n.prototype,u),l&&s(n,l),t}()}).call(this,n(27))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>{try{return new DOMException("","AbortError")}catch(e){return e.code=20,e.name="AbortError",e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n,r)=>{const i=[];for(let e=0;e<r.numberOfInputs;e+=1)i.push(new Set);e.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n)=>{e.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n)=>{const r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(r.context.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n)=>{e(t).add(n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},i=(e,t,n,i,a,o)=>class extends e{constructor(e,n=r){const s=a(e),u={...r,...n},l=i(s,u);super(e,!1,l,o(s)?t():null),this._nativeAnalyserNode=l}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(e){this._nativeAnalyserNode.fftSize=e}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(e){const t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(e){const t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(e){this._nativeAnalyserNode.smoothingTimeConstant=e}getByteFrequencyData(e){this._nativeAnalyserNode.getByteFrequencyData(e)}getByteTimeDomainData(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}getFloatFrequencyData(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}getFloatTimeDomainData(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);const i=(e,t,n)=>()=>{const i=new WeakMap;return{render(a,o,s){const u=i.get(o);return void 0!==u?Promise.resolve(u):(async(a,o,s)=>{let u=t(a);if(!Object(r.a)(u,o)){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,fftSize:u.fftSize,maxDecibels:u.maxDecibels,minDecibels:u.minDecibels,smoothingTimeConstant:u.smoothingTimeConstant};u=e(o,t)}return i.set(o,u),await n(a,o,u,s),u})(a,o,s)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(83),i=n(79);const a={numberOfChannels:1},o=(e,t,n,o,s,u,l,c)=>{let d=null;return class h{constructor(h){if(null===s)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:f,numberOfChannels:p,sampleRate:m}={...a,...h};null===d&&(d=new s(1,1,44100));const g=null!==o&&t(u,u)?new o({length:f,numberOfChannels:p,sampleRate:m}):d.createBuffer(p,f,m);if(0===g.numberOfChannels)throw n();return"function"!=typeof g.copyFromChannel?(l(g),Object(i.a)(g)):t(r.a,()=>Object(r.a)(g))||c(g),e.add(g),g}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===h.prototype||e.has(t)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(15),i=n(47),a=n(56);const o={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},s=(e,t,n,s,u,l,c,d)=>class extends e{constructor(e,i=o){const a=l(e),s={...o,...i},d=u(a,s),h=c(a),f=h?t():null;super(e,!1,d,f),this._audioBufferSourceNodeRenderer=f,this._isBufferNullified=!1,this._isBufferSet=null!==i.buffer&&void 0!==i.buffer,this._nativeAudioBufferSourceNode=d,this._onended=null,this._playbackRate=n(this,h,d.playbackRate,r.b,r.a)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(e){try{this._nativeAudioBufferSourceNode.buffer=e}catch(t){if(null!==e||17!==t.code)throw t;if(null!==this._nativeAudioBufferSourceNode.buffer){const e=this._nativeAudioBufferSourceNode.buffer,t=e.numberOfChannels;for(let n=0;n<t;n+=1)e.getChannelData(n).fill(0);this._isBufferNullified=!0}}if(null!==e){if(this._isBufferSet)throw s();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(e){this._nativeAudioBufferSourceNode.loop=e}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(e){this._nativeAudioBufferSourceNode.loopEnd=e}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(e){this._nativeAudioBufferSourceNode.loopStart=e}get onended(){return this._onended}set onended(e){const t="function"==typeof e?d(this,e):null;this._nativeAudioBufferSourceNode.onended=t;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===t?e:n}get playbackRate(){return this._playbackRate}start(e=0,t=0,n){if(this._nativeAudioBufferSourceNode.start(e,t,n),null!==this._audioBufferSourceNodeRenderer)this._audioBufferSourceNodeRenderer.start=void 0===n?[e,t]:[e,t,n];else{Object(i.a)(this);const e=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",e),setTimeout(()=>Object(a.a)(this),1e3)};this._nativeAudioBufferSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);const i=(e,t,n,i,a)=>()=>{const o=new WeakMap;let s=null,u=null;return{set start(e){s=e},set stop(e){u=e},render(l,c,d){const h=o.get(c);return void 0!==h?Promise.resolve(h):(async(l,c,d)=>{let h=n(l);const f=Object(r.a)(h,c);if(!f){const e={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=t(c,e),null!==s&&h.start(...s),null!==u&&h.stop(u)}return o.set(c,h),f?await e(c,l.playbackRate,h.playbackRate,d):await i(c,l.playbackRate,h.playbackRate,d),await a(l,c,h,d),h})(l,c,d)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(122);const i=(e,t,n,i,a,o,s,u,l)=>class extends e{constructor(e={}){if(null===l)throw new Error("Missing the native AudioContext constructor.");const t=new l(e);if(null===t)throw i();if(!Object(r.a)(e.latencyHint))throw new TypeError(`The provided value '${e.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==e.sampleRate&&t.sampleRate!==e.sampleRate)throw n();super(t,2);const{latencyHint:a}=e,{sampleRate:o}=t;if(this._baseLatency="number"==typeof t.baseLatency?t.baseLatency:"balanced"===a?512/o:"interactive"===a||void 0===a?256/o:"playback"===a?1024/o:128*Math.max(2,Math.min(128,Math.round(a*o/128)))/o,this._nativeAudioContext=t,this._state=null,"running"===t.state){this._state="suspended";const e=()=>{"suspended"===this._state&&(this._state=null),t.removeEventListener("statechange",e)};t.addEventListener("statechange",e)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw t()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close())}createMediaElementSource(e){return new a(this,{mediaElement:e})}createMediaStreamDestination(){return new o(this)}createMediaStreamSource(e){return new s(this,{mediaStream:e})}createMediaStreamTrackSource(e){return new u(this,{mediaStreamTrack:e})}resume(){return"suspended"===this._state?new Promise((e,t)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?e():this.resume().then(e,t)};this._nativeAudioContext.addEventListener("statechange",n)}):this._nativeAudioContext.resume().catch(e=>{if(void 0===e||15===e.code)throw t();throw e})}suspend(){return this._nativeAudioContext.suspend().catch(e=>{if(void 0===e)throw t();throw e})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n,r,i,a,o,s)=>class extends e{constructor(e,n){const r=a(e),u=o(r),l=i(r,n,u);super(e,!1,l,u?t(s):null),this._isNodeOfNativeOfflineAudioContext=u,this._nativeAudioDestinationNode=l}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(e){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=e}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(e){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=e}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>{let t=null;return{render:(n,r,i)=>(null===t&&(t=(async(t,n,r)=>{const i=n.destination;return await e(t,n,i,r),i})(n,r,i)),t)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(15);const i=(e,t,n,i,a)=>(o,s)=>{const u=s.listener,{forwardX:l,forwardY:c,forwardZ:d,positionX:h,positionY:f,positionZ:p,upX:m,upY:g,upZ:v}=void 0===u.forwardX?(()=>{const l=t(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),c=a(s),d=i(s,256,9,0),h=(t,i)=>{const a=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});return a.connect(l,0,t),a.start(),Object.defineProperty(a.offset,"defaultValue",{get:()=>i}),e({context:o},c,a.offset,r.b,r.a)};let f=[0,0,-1,0,1,0],p=[0,0,0];return d.onaudioprocess=({inputBuffer:e})=>{const t=[e.getChannelData(0)[0],e.getChannelData(1)[0],e.getChannelData(2)[0],e.getChannelData(3)[0],e.getChannelData(4)[0],e.getChannelData(5)[0]];t.some((e,t)=>e!==f[t])&&(u.setOrientation(...t),f=t);const n=[e.getChannelData(6)[0],e.getChannelData(7)[0],e.getChannelData(8)[0]];n.some((e,t)=>e!==p[t])&&(u.setPosition(...n),p=n)},l.connect(d),{forwardX:h(0,0),forwardY:h(1,0),forwardZ:h(2,-1),positionX:h(6,0),positionY:h(7,0),positionZ:h(8,0),upX:h(3,0),upY:h(4,1),upZ:h(5,0)}})():u;return{get forwardX(){return l},get forwardY(){return c},get forwardZ(){return d},get positionX(){return h},get positionY(){return f},get positionZ(){return p},get upX(){return m},get upY(){return g},get upZ(){return v}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(49);const i=(e,t,n,i,a,o,s,u,l,c,d,h)=>(f,p,m,g=null,v=null)=>{const y=new r.AutomationEventList(m.defaultValue),_=p?i(y):null,b={get defaultValue(){return m.defaultValue},get maxValue(){return null===g?m.maxValue:g},get minValue(){return null===v?m.minValue:v},get value(){return m.value},set value(e){m.value=e,b.setValueAtTime(e,f.context.currentTime)},cancelAndHoldAtTime(e){if("function"==typeof m.cancelAndHoldAtTime)null===_&&y.flush(f.context.currentTime),y.add(a(e)),m.cancelAndHoldAtTime(e);else{const t=Array.from(y).pop();null===_&&y.flush(f.context.currentTime),y.add(a(e));const n=Array.from(y).pop();m.cancelScheduledValues(e),t!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return b},cancelScheduledValues:e=>(null===_&&y.flush(f.context.currentTime),y.add(o(e)),m.cancelScheduledValues(e),b),exponentialRampToValueAtTime:(e,t)=>(null===_&&y.flush(f.context.currentTime),y.add(s(e,t)),m.exponentialRampToValueAtTime(e,t),b),linearRampToValueAtTime:(e,t)=>(null===_&&y.flush(f.context.currentTime),y.add(u(e,t)),m.linearRampToValueAtTime(e,t),b),setTargetAtTime:(e,t,n)=>(null===_&&y.flush(f.context.currentTime),y.add(l(e,t,n)),m.setTargetAtTime(e,t,n),b),setValueAtTime:(e,t)=>(null===_&&y.flush(f.context.currentTime),y.add(c(e,t)),m.setValueAtTime(e,t),b),setValueCurveAtTime(e,t,n){if(null!==h&&"webkitAudioContext"===h.name){const r=t+n,i=f.context.sampleRate,a=Math.ceil(t*i),o=Math.floor(r*i),s=o-a,u=new Float32Array(s);for(let r=0;r<s;r+=1){const o=(e.length-1)/n*((a+r)/i-t),s=Math.floor(o),l=Math.ceil(o);u[r]=s===l?e[s]:(1-(o-s))*e[s]+(1-(l-o))*e[l]}null===_&&y.flush(f.context.currentTime),y.add(d(u,t,n)),m.setValueCurveAtTime(u,t,n);const l=o/i;l<r&&b.setValueAtTime(u[u.length-1],l),b.setValueAtTime(e[e.length-1],r)}else null===_&&y.flush(f.context.currentTime),y.add(d(e,t,n)),m.setValueCurveAtTime(e,t,n);return b}};return n.set(b,m),t.set(b,f),e(b,_),b}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>({replay(t){for(const n of e)if("exponentialRampToValue"===n.type){const{endTime:e,value:r}=n;t.exponentialRampToValueAtTime(r,e)}else if("linearRampToValue"===n.type){const{endTime:e,value:r}=n;t.linearRampToValueAtTime(r,e)}else if("setTarget"===n.type){const{startTime:e,target:r,timeConstant:i}=n;t.setTargetAtTime(r,e,i)}else if("setValue"===n.type){const{startTime:e,value:r}=n;t.setValueAtTime(r,e)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:e,startTime:r,values:i}=n;t.setValueCurveAtTime(i,r,e)}}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(6),i=n(123);const a={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,outputChannelCount:void 0,parameterData:{},processorOptions:{}},o=e=>{const t=[];for(let n=0;n<e;n+=1)t.push(1);return t},s=(e,t,n,s,u,l,c,d,h)=>class extends t{constructor(t,h,f=a){const p=l(t),m=c(p),g=(e=>({...e,outputChannelCount:void 0!==e.outputChannelCount?e.outputChannelCount:1===e.numberOfInputs&&1===e.numberOfOutputs?[e.channelCount]:o(e.numberOfOutputs)}))({...a,...f}),v=r.j.get(p),y=void 0===v?void 0:v.get(h),_=u(p,m?null:t.baseLatency,d,h,y,g);super(t,!0,_,m?s(h,g,y):null);const b=[];_.parameters.forEach((e,t)=>{const r=n(this,m,e);b.push([t,r])}),this._nativeAudioWorkletNode=_,this._onprocessorerror=null,this._parameters=new i.a(b),m&&e(p,this)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(e){const t="function"==typeof e?h(this,e):null;this._nativeAudioWorkletNode.onprocessorerror=t;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===t?e:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n,r,i,a,o,s,u,l,c,d,h,f,p,m,g,v,y,_)=>class extends p{constructor(t,n){super(t,n),this._nativeContext=t,this._audioWorklet=void 0===e?void 0:{addModule:(t,n)=>e(this,t,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new i(this)}createBuffer(e,t,r){return new n({length:t,numberOfChannels:e,sampleRate:r})}createBufferSource(){return new r(this)}createChannelMerger(e=6){return new a(this,{numberOfInputs:e})}createChannelSplitter(e=6){return new o(this,{numberOfOutputs:e})}createConstantSource(){return new s(this)}createConvolver(){return new u(this)}createDelay(e=1){return new c(this,{maxDelayTime:e})}createDynamicsCompressor(){return new d(this)}createGain(){return new h(this)}createIIRFilter(e,t){return new f(this,{feedback:t,feedforward:e})}createOscillator(){return new m(this)}createPanner(){return new g(this)}createPeriodicWave(e,t,n={disableNormalization:!1}){return new v(this,{...n,imag:t,real:e})}createStereoPanner(){return new y(this)}createWaveShaper(){return new _(this)}decodeAudioData(e,t,n){return l(this._nativeContext,e).then(e=>("function"==typeof t&&t(e),e)).catch(e=>{throw"function"==typeof n&&n(e),e})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);const i={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},a=(e,t,n,a,o,s,u)=>class extends e{constructor(e,a=i){const l=s(e),c={...i,...a},d=o(l,c),h=u(l);super(e,!1,d,h?n():null),this._Q=t(this,h,d.Q,r.b,r.a),this._detune=t(this,h,d.detune,1200*Math.log2(r.b),-1200*Math.log2(r.b)),this._frequency=t(this,h,d.frequency,e.sampleRate/2,0),this._gain=t(this,h,d.gain,40*Math.log10(r.b),r.a),this._nativeBiquadFilterNode=d}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(e){this._nativeBiquadFilterNode.type=e}getFrequencyResponse(e,t,n){if(this._nativeBiquadFilterNode.getFrequencyResponse(e,t,n),e.length!==t.length||t.length!==n.length)throw a()}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);const i=(e,t,n,i,a)=>()=>{const o=new WeakMap;return{render(s,u,l){const c=o.get(u);return void 0!==c?Promise.resolve(c):(async(s,u,l)=>{let c=n(s);const d=Object(r.a)(c,u);if(!d){const e={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=t(u,e)}return o.set(u,c),d?(await e(u,s.Q,c.Q,l),await e(u,s.detune,c.detune,l),await e(u,s.frequency,c.frequency,l),await e(u,s.gain,c.gain,l)):(await i(u,s.Q,c.Q,l),await i(u,s.detune,c.detune,l),await i(u,s.frequency,c.frequency,l),await i(u,s.gain,c.gain,l)),await a(s,u,c,l),c})(s,u,l)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>(n,r)=>{const i=t.get(n);if(void 0!==i)return i;const a=e.get(n);if(void 0!==a)return a;try{const i=r();return i instanceof Promise?(e.set(n,i),i.catch(()=>!1).then(r=>(e.delete(n),t.set(n,r),r))):(t.set(n,i),i)}catch{return t.set(n,!1),!1}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},i=(e,t,n,i,a)=>class extends e{constructor(e,o=r){const s=i(e),u={...r,...o};super(e,!1,n(s,u),a(s)?t():null)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);const i=(e,t,n)=>()=>{const i=new WeakMap;return{render(a,o,s){const u=i.get(o);return void 0!==u?Promise.resolve(u):(async(a,o,s)=>{let u=t(a);if(!Object(r.a)(u,o)){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfInputs:u.numberOfInputs};u=e(o,t)}return i.set(o,u),await n(a,o,u,s),u})(a,o,s)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},i=(e,t,n,i,a)=>class extends e{constructor(e,o=r){const s=i(e),u=(e=>({...e,channelCount:e.numberOfOutputs}))({...r,...o});super(e,!1,n(s,u),a(s)?t():null)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);const i=(e,t,n)=>()=>{const i=new WeakMap;return{render(a,o,s){const u=i.get(o);return void 0!==u?Promise.resolve(u):(async(a,o,s)=>{let u=t(a);if(!Object(r.a)(u,o)){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfOutputs:u.numberOfOutputs};u=e(o,t)}return i.set(o,u),await n(a,o,u,s),u})(a,o,s)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n,r,i)=>e(n,t,r,i)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(67);const i=e=>(t,n,i=0,a=0)=>{const o=t[i];if(void 0===o)throw e();return Object(r.a)(n)?o.connect(n,0,a):o.connect(n,0)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n)=>{const r=e(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=t.createBuffer(1,2,t.sampleRate);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(15),i=n(47),a=n(56);const o={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},s=(e,t,n,s,u,l,c)=>class extends e{constructor(e,i=o){const a=u(e),c={...o,...i},d=s(a,c),h=l(a),f=h?n():null;super(e,!1,d,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=d,this._offset=t(this,h,d.offset,r.b,r.a),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(e){const t="function"==typeof e?c(this,e):null;this._nativeConstantSourceNode.onended=t;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===t?e:n}start(e=0){if(this._nativeConstantSourceNode.start(e),null!==this._constantSourceNodeRenderer)this._constantSourceNodeRenderer.start=e;else{Object(i.a)(this);const e=()=>{this._nativeConstantSourceNode.removeEventListener("ended",e),setTimeout(()=>Object(a.a)(this),1e3)};this._nativeConstantSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);const i=(e,t,n,i,a)=>()=>{const o=new WeakMap;let s=null,u=null;return{set start(e){s=e},set stop(e){u=e},render(l,c,d){const h=o.get(c);return void 0!==h?Promise.resolve(h):(async(l,c,d)=>{let h=n(l);const f=Object(r.a)(h,c);if(!f){const e={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=t(c,e),null!==s&&h.start(s),null!==u&&h.stop(u)}return o.set(c,h),f?await e(c,l.offset,h.offset,d):await i(c,l.offset,h.offset,d),await a(l,c,h,d),h})(l,c,d)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>(e[0]=t,e[0])},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},i=(e,t,n,i,a)=>class extends e{constructor(e,o=r){const s=i(e),u={...r,...o},l=n(s,u);super(e,!1,l,a(s)?t():null),this._isBufferNullified=!1,this._nativeConvolverNode=l}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){const e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,e.sampleRate),this._isBufferNullified=!0}else this._isBufferNullified=!1}get normalize(){return this._nativeConvolverNode.normalize}set normalize(e){this._nativeConvolverNode.normalize=e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(40),i=n(19);const a=(e,t,n)=>()=>{const a=new WeakMap;return{render(o,s,u){const l=a.get(s);return void 0!==l?Promise.resolve(l):(async(o,s,u)=>{let l=t(o);if(!Object(i.a)(l,s)){const t={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,disableNormalization:!l.normalize};l=e(s,t)}return a.set(s,l),Object(r.a)(l)?await n(o,s,l.inputs[0],u):await n(o,s,l,u),l})(o,s,u)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>(n,r,i)=>{if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(n,r,i)}catch(t){if("IndexSizeError"===t.name||"SyntaxError"===t.name)throw e();throw t}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>{try{return new DOMException("","DataCloneError")}catch(e){return e.code=25,e.name="DataCloneError",e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);const i=(e,t,n,i,a,o,s,u)=>(l,c)=>{const d=t.get(l);if(void 0===d)throw new Error("Missing the expected cycle count.");const h=o(l.context),f=u(h);if(d===c){if(t.delete(l),!f&&s(l)){const t=i(l),{outputs:o}=n(l);for(const n of o)if(Object(r.a)(n)){const r=i(n[0]);e(t,r,n[1],n[2])}else{const e=a(n[0]);t.connect(e,n[1])}}}else t.set(l,d-c)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},i=(e,t,n,i,a,o)=>class extends e{constructor(e,s=r){const u=a(e),l={...r,...s},c=i(u,l),d=o(u);super(e,!1,c,d?n(l.maxDelayTime):null),this._delayTime=t(this,d,c.delayTime,l.maxDelayTime,0)}get delayTime(){return this._delayTime}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);const i=(e,t,n,i,a)=>o=>{const s=new WeakMap;return{render(u,l,c){const d=s.get(l);return void 0!==d?Promise.resolve(d):(async(u,l,c)=>{let d=n(u);const h=Object(r.a)(d,l);if(!h){const e={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,delayTime:d.delayTime.value,maxDelayTime:o};d=t(l,e)}return s.set(l,d),h?await e(l,u.delayTime,d.delayTime,c):await i(l,u.delayTime,d.delayTime,c),await a(u,l,d,c),d})(u,l,c)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n)=>{e(t).delete(n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(67);const i=(e,t,n)=>{const r=t[n];if(void 0===r)throw e();return r},a=e=>(t,n,a,o=0)=>void 0===n?t.forEach(e=>e.disconnect()):"number"==typeof n?i(e,t,n).disconnect():Object(r.a)(n)?void 0===a?t.forEach(e=>e.disconnect(n)):void 0===o?i(e,t,a).disconnect(n,0):i(e,t,a).disconnect(n,0,o):void 0===a?t.forEach(e=>e.disconnect(n)):i(e,t,a).disconnect(n,0)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},i=(e,t,n,i,a,o,s)=>class extends e{constructor(e,a=r){const u=o(e),l={...r,...a},c=i(u,l),d=s(u);super(e,!1,c,d?n():null),this._attack=t(this,d,c.attack,1,0),this._knee=t(this,d,c.knee,40,0),this._nativeDynamicsCompressorNode=c,this._ratio=t(this,d,c.ratio,20,1),this._release=t(this,d,c.release,1,0),this._threshold=t(this,d,c.threshold,0,-100)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(e){const t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,a()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(e){const t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,a()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);const i=(e,t,n,i,a)=>()=>{const o=new WeakMap;return{render(s,u,l){const c=o.get(u);return void 0!==c?Promise.resolve(c):(async(s,u,l)=>{let c=n(s);const d=Object(r.a)(c,u);if(!d){const e={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=t(u,e)}return o.set(u,c),d?(await e(u,s.attack,c.attack,l),await e(u,s.knee,c.knee,l),await e(u,s.ratio,c.ratio,l),await e(u,s.release,c.release,l),await e(u,s.threshold,c.threshold,l)):(await i(u,s.attack,c.attack,l),await i(u,s.knee,c.knee,l),await i(u,s.ratio,c.ratio,l),await i(u,s.release,c.release,l),await i(u,s.threshold,c.threshold,l)),await a(s,u,c,l),c})(s,u,l)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>{try{return new DOMException("","EncodingError")}catch(e){return e.code=0,e.name="EncodingError",e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>new Promise((n,r)=>{if(null===e)return void r(new SyntaxError);const i=e.document.head;if(null===i)r(new SyntaxError);else{const a=e.document.createElement("script"),o=new Blob([t],{type:"application/javascript"}),s=URL.createObjectURL(o),u=e.onerror,l=()=>{e.onerror=u,URL.revokeObjectURL(s)};e.onerror=(t,n,i,a,o)=>n===s||n===e.location.href&&1===i&&1===a?(l(),r(o),!1):null!==u?u(t,n,i,a,o):void 0,a.onerror=()=>{l(),r(new SyntaxError)},a.onload=()=>{l(),n()},a.src=s,a.type="module",i.appendChild(a)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(t,n,r){if(null!==n){let i=this._listeners.get(n);void 0===i&&(i=e(this,n),"function"==typeof n&&this._listeners.set(n,i)),this._nativeEventTarget.addEventListener(t,i,r)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n,r)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get:()=>Math.round(t*n)},currentTime:{configurable:!0,get:()=>t}});try{return r()}finally{null!==e&&(delete e.currentFrame,delete e.currentTime)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>async t=>{try{const e=await fetch(t);if(e.ok)return e.text()}catch{}throw e()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);const i={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},a=(e,t,n,a,o,s)=>class extends e{constructor(e,u=i){const l=o(e),c={...i,...u},d=a(l,c),h=s(l);super(e,!1,d,h?n():null),this._gain=t(this,h,d.gain,r.b,r.a)}get gain(){return this._gain}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);const i=(e,t,n,i,a)=>()=>{const o=new WeakMap;return{render(s,u,l){const c=o.get(u);return void 0!==c?Promise.resolve(c):(async(s,u,l)=>{let c=n(s);const d=Object(r.a)(c,u);if(!d){const e={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=t(u,e)}return o.set(u,c),d?await e(u,s.gain,c.gain,l):await i(u,s.gain,c.gain,l),await a(s,u,c,l),c})(s,u,l)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>{const n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>{const n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(6);const i=(e,t,n)=>i=>{if("closed"===i.state&&null!==t&&"webkitAudioContext"!==t.name){if(!e(i)){const e=r.f.get(i);if(void 0!==e)return e;const n=new t;return r.f.set(i,n),n}{const e=r.f.get(i);if(void 0!==e)return e;if(null!==n){const e=new n(1,1,44100);return r.f.set(i,e),e}}}return null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(24);const i=e=>t=>{const n=e.get(t);if(void 0===n)throw Object(r.a)();return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>{const n=e.get(t);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(125),i=n(19);const a=(e,t,n,a,o,s)=>(u,l)=>{const c=new WeakMap;let d=null;const h=async(h,f,p)=>{let m=null,g=n(h);const v=Object(i.a)(g,f);if(void 0===f.createIIRFilter?m=e(f,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):v||(g=t(f,e=>e.createIIRFilter(l,u))),c.set(f,null===m?g:m),null!==m){if(null===d){if(null===a)throw new Error("Missing the native OfflineAudioContext constructor.");const e=new a(h.context.destination.channelCount,h.context.length,f.sampleRate);d=(async()=>{await o(h,e,e.destination,p);return((e,t,n,i)=>{const a=n.length,o=i.length,s=Math.min(a,o);if(1!==n[0]){for(let e=0;e<a;e+=1)i[e]/=n[0];for(let e=1;e<o;e+=1)n[e]/=n[0]}const u=new Float32Array(32),l=new Float32Array(32),c=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),d=e.numberOfChannels;for(let t=0;t<d;t+=1){const d=e.getChannelData(t),h=c.getChannelData(t);u.fill(0),l.fill(0),Object(r.a)(n,a,i,o,s,u,l,0,32,d,h)}return c})(await s(e),f,u,l)})()}const e=await d;return m.buffer=e,m.start(0),m}return await o(h,f,g,p),g};return{render(e,t,n){const r=c.get(t);return void 0!==r?Promise.resolve(r):h(e,t,n)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57);const i=(e,t,n,i,a,o)=>s=>(u,l)=>{const c=e.get(u);if(void 0===c){if(!s&&o(u)){const e=i(u),{outputs:o}=n(u);for(const n of o)if(Object(r.a)(n)){const r=i(n[0]);t(e,r,n[1],n[2])}else{const t=a(n[0]);e.disconnect(t,n[1])}}e.set(u,l)}else e.set(u,c+l)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>n=>{const r=e.get(n);return t(r)||t(n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>n=>e.has(n)||t(n)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>n=>e.has(n)||t(n)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>n=>{const r=e.get(n);return t(r)||t(n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>null!==e&&t instanceof e},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>null!==e&&"function"==typeof e.AudioNode&&t instanceof e.AudioNode},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>null!==e&&"function"==typeof e.AudioParam&&t instanceof e.AudioParam},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>n=>e(n)||t(n)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>null!==e&&t instanceof e},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>null!==e&&e.isSecureContext},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=async(e,t,n,r,i,a,o,s,u,l,c,d,h,f)=>{if(e(t,t)&&e(n,n)&&e(i,i)&&e(a,a)&&e(s,s)&&e(u,u)&&e(l,l)&&e(c,c)&&e(d,d)){return(await Promise.all([e(r,r),e(o,o),e(h,h),e(f,f)])).every(e=>e)}return!1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n,r)=>class extends e{constructor(e,i){const a=n(e),o=t(a,i);if(r(a))throw TypeError();super(e,!0,o,null),this._mediaElement=i.mediaElement,this._nativeMediaElementAudioSourceNode=o}get mediaElement(){return void 0===this._nativeMediaElementAudioSourceNode.mediaElement?this._mediaElement:this._nativeMediaElementAudioSourceNode.mediaElement}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},i=(e,t,n,i)=>class extends e{constructor(e,a=r){const o=n(e);if(i(o))throw new TypeError;const s={...r,...a},u=t(o,s);super(e,!1,u,null),this._nativeMediaStreamAudioDestinationNode=u}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n,r)=>class extends e{constructor(e,i){const a=n(e),o=t(a,i);if(r(a))throw new TypeError;super(e,!0,o,null),this._nativeMediaStreamAudioSourceNode=o}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n)=>class extends e{constructor(e,r){const i=n(e);super(e,!0,t(i,r),null)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(122);const i=(e,t,n,i,a)=>class extends i{constructor(e={}){if(null===a)throw new Error("Missing the native AudioContext constructor.");const i=new a(e);if(null===i)throw n();if(!Object(r.a)(e.latencyHint))throw new TypeError(`The provided value '${e.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==e.sampleRate&&i.sampleRate!==e.sampleRate)throw t();super(i,2);const{latencyHint:o}=e,{sampleRate:s}=i;if(this._baseLatency="number"==typeof i.baseLatency?i.baseLatency:"balanced"===o?512/s:"interactive"===o||void 0===o?256/s:"playback"===o?1024/s:128*Math.max(2,Math.min(128,Math.round(o*s/128)))/s,this._nativeAudioContext=i,this._state=null,"running"===i.state){this._state="suspended";const e=()=>{"suspended"===this._state&&(this._state=null),i.removeEventListener("statechange",e)};i.addEventListener("statechange",e)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw e()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close())}resume(){return"suspended"===this._state?new Promise((e,t)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?e():this.resume().then(e,t)};this._nativeAudioContext.addEventListener("statechange",n)}):this._nativeAudioContext.resume().catch(t=>{if(void 0===t||15===t.code)throw e();throw t})}suspend(){return this._nativeAudioContext.suspend().catch(t=>{if(void 0===t)throw e();throw t})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(6);const i=(e,t,n,i,a,o)=>class extends n{constructor(n,o){super(n),this._nativeContext=n,r.g.set(this,n);const s=n.sampleRate;Object.defineProperty(n,"sampleRate",{get:()=>s}),i(n)&&a.set(n,new Set),this._destination=new e(this,o),this._listener=t(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(e){const t="function"==typeof e?o(this,e):null;this._nativeContext.onstatechange=t;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===t?e:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(43);const i={numberOfChannels:1},a=(e,t,n,a,o)=>class extends a{constructor(t){const{length:a,numberOfChannels:o,sampleRate:s}={...i,...t},u=n(o,a,s);e(r.a,()=>Object(r.a)(u))||u.addEventListener("statechange",(()=>{let e=0;const t=n=>{"running"===this._state&&(e>0?(u.removeEventListener("statechange",t),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):e+=1)};return t})()),super(u,o),this._length=a,this._nativeOfflineAudioContext=u,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(t()):(this._state="running",o(this.destination,this._nativeOfflineAudioContext).then(e=>(this._state=null,e)).catch(e=>{throw this._state=null,e}))}_waitForThePromiseToSettle(e){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout(()=>this._waitForThePromiseToSettle(e))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>(n,r,i)=>{const a=new Set;var o,s;return n.connect=(o=n.connect,(i,s=0,u=0)=>{const l=0===a.size;if(t(i))return o.call(n,i,s,u),e(a,[i,s,u],e=>e[0]===i&&e[1]===s&&e[2]===u,!0),l&&r(),i;o.call(n,i,s),e(a,[i,s],e=>e[0]===i&&e[1]===s,!0),l&&r()}),n.disconnect=(s=n.disconnect,(e,r,o)=>{const u=a.size>0;if(void 0===e)s.apply(n),a.clear();else if("number"==typeof e){s.call(n,e);for(const t of a)t[1]===e&&a.delete(t)}else{t(e)?s.call(n,e,r,o):s.call(n,e,r);for(const t of a)t[0]!==e||void 0!==r&&t[1]!==r||void 0!==o&&t[2]!==o||a.delete(t)}const l=0===a.size;u&&l&&i()}),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>null===e?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>null===e?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>(n,r,i)=>{const a=n.destination;if(a.channelCount!==r)try{a.channelCount=r}catch{}i&&"explicit"!==a.channelCountMode&&(a.channelCountMode="explicit"),0===a.maxChannelCount&&Object.defineProperty(a,"maxChannelCount",{value:r});const o=e(n,{channelCount:r,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,gain:1});return t(o,"channelCount",e=>()=>e.call(o),e=>t=>{e.call(o,t);try{a.channelCount=t}catch(e){if(t>a.maxChannelCount)throw e}}),t(o,"channelCountMode",e=>()=>e.call(o),e=>t=>{e.call(o,t),a.channelCountMode=t}),t(o,"channelInterpretation",e=>()=>e.call(o),e=>t=>{e.call(o,t),a.channelInterpretation=t}),Object.defineProperty(o,"maxChannelCount",{get:()=>a.maxChannelCount}),o.connect(a),o}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n)=>{const r=e(t);return n(null!==r?r:t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>null===e?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(22),i=n(20),a=n(10);const o=e=>(t,n)=>{const o=e(t,e=>e.createBiquadFilter());return Object(a.a)(o,n),Object(r.a)(o,n,"Q"),Object(r.a)(o,n,"detune"),Object(r.a)(o,n,"frequency"),Object(r.a)(o,n,"gain"),Object(i.a)(o,n,"type"),o}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(10);const i=(e,t)=>(n,i)=>{const a=e(n,e=>e.createChannelMerger(i.numberOfInputs));return 1!==a.channelCount&&"explicit"!==a.channelCountMode&&t(n,a),Object(r.a)(a,i),a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(22),i=n(10),a=n(80),o=n(81);const s=(e,t,n,s,u,l)=>(c,d)=>{if(void 0===c.createConstantSource)return s(c,d);const h=n(c,e=>e.createConstantSource());return Object(i.a)(h,d),Object(r.a)(h,d,"offset"),t(u,()=>u(c))||Object(a.a)(h),t(l,()=>l(c))||Object(o.a)(h),e(c,h),h}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(37);const i=(e,t,n,i)=>(a,{offset:o,...s})=>{const u=a.createBuffer(1,2,a.sampleRate),l=t(a,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=n(a,{...s,gain:o}),d=u.getChannelData(0);d[0]=1,d[1]=1,l.buffer=u,l.loop=!0;const h={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(e){c.channelCount=e},get channelCountMode(){return c.channelCountMode},set channelCountMode(e){c.channelCountMode=e},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(e){c.channelInterpretation=e},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(e){l.onended=e},addEventListener:(...e)=>l.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>l.dispatchEvent(e[0]),removeEventListener:(...e)=>l.removeEventListener(e[0],e[1],e[2]),start(e=0){l.start.call(l,e)},stop(e=0){l.stop.call(l,e)}};return e(a,l),i(Object(r.a)(h,c),()=>l.connect(c),()=>l.disconnect(c))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(20),i=n(10);const a=(e,t,n,a)=>(o,s)=>{const u=e(o,e=>e.createConvolver());try{u.channelCount=1}catch(e){return t(o,s)}if(Object(i.a)(u,s),s.disableNormalization===u.normalize&&(u.normalize=!s.disableNormalization),Object(r.a)(u,s,"buffer"),s.channelCount>2)throw n();if(a(u,"channelCount",e=>()=>e.call(u),e=>t=>{if(t>2)throw n();return e.call(u,t)}),"max"===s.channelCountMode)throw n();return a(u,"channelCountMode",e=>()=>e.call(u),e=>t=>{if("max"===t)throw n();return e.call(u,t)}),u}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(10),i=n(37);const a=(e,t,n)=>(a,{buffer:o,channelCount:s,channelCountMode:u,channelInterpretation:l,disableNormalization:c})=>{const d=e(a,e=>e.createConvolver());Object(r.a)(d,{channelCount:Math.max(s,2),channelCountMode:"max"===u?u:"clamped-max",channelInterpretation:l});const h=t(a,{channelCount:s,channelCountMode:u,channelInterpretation:l,gain:1}),f={get buffer(){return d.buffer},set buffer(e){d.buffer=e},get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(e){e>2&&(d.channelCount=e),h.channelCount=e},get channelCountMode(){return h.channelCountMode},set channelCountMode(e){"max"===e&&(d.channelCountMode=e),h.channelCountMode=e},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(e){d.channelInterpretation=e,h.channelInterpretation=e},get context(){return d.context},get inputs(){return[d]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get normalize(){return d.normalize},set normalize(e){d.normalize=e},addEventListener:(...e)=>d.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>d.dispatchEvent(e[0]),removeEventListener:(...e)=>d.removeEventListener(e[0],e[1],e[2])};c===f.normalize&&(f.normalize=!c),o!==f.buffer&&(f.buffer=o);return n(Object(i.a)(f,h),()=>d.connect(h),()=>d.disconnect(h))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(22),i=n(10);const a=e=>(t,n)=>{const a=e(t,e=>e.createDelay(n.maxDelayTime));return Object(i.a)(a,n),Object(r.a)(a,n,"delayTime"),a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(22),i=n(10);const a=(e,t)=>(n,a)=>{const o=e(n,e=>e.createDynamicsCompressor());if(Object(i.a)(o,a),a.channelCount>2)throw t();if("max"===a.channelCountMode)throw t();return Object(r.a)(o,a,"attack"),Object(r.a)(o,a,"knee"),Object(r.a)(o,a,"ratio"),Object(r.a)(o,a,"release"),Object(r.a)(o,a,"threshold"),o}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(22),i=n(10);const a=e=>(t,n)=>{const a=e(t,e=>e.createGain());return Object(i.a)(a,n),Object(r.a)(a,n,"gain"),a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(10);const i=(e,t)=>(n,i,a)=>{if(void 0===n.createIIRFilter)return t(n,i,a);const o=e(n,e=>e.createIIRFilter(a.feedforward,a.feedback));return Object(r.a)(o,a),o}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(126),i=n(125),a=n(37);function o(e,t){const n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}function s(e,t){return[e[0]*t[0]-e[1]*t[1],e[0]*t[1]+e[1]*t[0]]}function u(e,t){let n=[0,0];for(let r=e.length-1;r>=0;r-=1)n=s(n,t),n[0]+=e[r];return n}const l=(e,t,n,s)=>(l,c,{channelCount:d,channelCountMode:h,channelInterpretation:f,feedback:p,feedforward:m})=>{const g=Object(r.a)(c,l.sampleRate),v=p.length,y=m.length,_=Math.min(v,y);if(0===p.length||p.length>20)throw s();if(0===p[0])throw t();if(0===m.length||m.length>20)throw s();if(0===m[0])throw t();if(1!==p[0]){for(let e=0;e<y;e+=1)m[e]/=p[0];for(let e=1;e<v;e+=1)p[e]/=p[0]}const b=n(l,g,d,d);b.channelCount=d,b.channelCountMode=h,b.channelInterpretation=f;const E=[],T=[],S=[];for(let e=0;e<d;e+=1){E.push(0);const e=new Float32Array(32),t=new Float32Array(32);e.fill(0),t.fill(0),T.push(e),S.push(t)}b.onaudioprocess=e=>{const t=e.inputBuffer,n=e.outputBuffer,r=t.numberOfChannels;for(let e=0;e<r;e+=1){const r=t.getChannelData(e),a=n.getChannelData(e);E[e]=Object(i.a)(p,v,m,y,_,T[e],S[e],E[e],32,r,a)}};const w=l.sampleRate/2,A={get bufferSize(){return g},get channelCount(){return b.channelCount},set channelCount(e){b.channelCount=e},get channelCountMode(){return b.channelCountMode},set channelCountMode(e){b.channelCountMode=e},get channelInterpretation(){return b.channelInterpretation},set channelInterpretation(e){b.channelInterpretation=e},get context(){return b.context},get inputs(){return[b]},get numberOfInputs(){return b.numberOfInputs},get numberOfOutputs(){return b.numberOfOutputs},addEventListener:(...e)=>b.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>b.dispatchEvent(e[0]),getFrequencyResponse(t,n,r){if(t.length!==n.length||n.length!==r.length)throw e();const i=t.length;for(let e=0;e<i;e+=1){const i=-Math.PI*(t[e]/w),a=[Math.cos(i),Math.sin(i)],s=o(u(m,a),u(p,a));n[e]=Math.sqrt(s[0]*s[0]+s[1]*s[1]),r[e]=Math.atan2(s[1],s[0])}},removeEventListener:(...e)=>b.removeEventListener(e[0],e[1],e[2])};return Object(a.a)(A,b)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n)=>e(t,e=>e.createMediaElementSource(n.mediaElement))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(10);const i=(e,t)=>(n,i)=>{if(void 0===n.createMediaStreamDestination)throw t();const a=e(n,e=>e.createMediaStreamDestination());return Object(r.a)(a,i),1===a.numberOfOutputs&&Object.defineProperty(a,"numberOfOutputs",{get:()=>0}),a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,{mediaStream:n})=>{const r=n.getAudioTracks(),i=e(t,e=>{r.sort((e,t)=>e.id<t.id?-1:e.id>t.id?1:0);const t=r.slice(0,1);return e.createMediaStreamSource(new MediaStream(t))});return Object.defineProperty(i,"mediaStream",{value:n}),i}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n)=>(r,{mediaStreamTrack:i})=>"function"==typeof r.createMediaStreamTrackSource?t(r,e=>e.createMediaStreamTrackSource(i)):t(r,t=>{const r=new MediaStream([i]),a=t.createMediaStreamSource(r);if("audio"!==i.kind)throw e();if(n(t))throw new TypeError;return a})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>null===e?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(22),i=n(20),a=n(10),o=n(80),s=n(81);const u=(e,t,n,u,l,c,d)=>(h,f)=>{const p=n(h,e=>e.createOscillator());return Object(a.a)(p,f),Object(r.a)(p,f,"detune"),Object(r.a)(p,f,"frequency"),void 0!==f.periodicWave?p.setPeriodicWave(f.periodicWave):Object(i.a)(p,f,"type"),t(u,()=>u(h))||Object(o.a)(p),t(l,()=>l(h))||d(p,h),t(c,()=>c(h))||Object(s.a)(p),e(h,p),p}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(22),i=n(20),a=n(10);const o=(e,t)=>(n,o)=>{const s=e(n,e=>e.createPanner());return void 0===s.orientationX?t(n,o):(Object(a.a)(s,o),Object(r.a)(s,o,"orientationX"),Object(r.a)(s,o,"orientationY"),Object(r.a)(s,o,"orientationZ"),Object(r.a)(s,o,"positionX"),Object(r.a)(s,o,"positionY"),Object(r.a)(s,o,"positionZ"),Object(i.a)(s,o,"coneInnerAngle"),Object(i.a)(s,o,"coneOuterAngle"),Object(i.a)(s,o,"coneOuterGain"),Object(i.a)(s,o,"distanceModel"),Object(i.a)(s,o,"maxDistance"),Object(i.a)(s,o,"panningModel"),Object(i.a)(s,o,"refDistance"),Object(i.a)(s,o,"rolloffFactor"),s)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(10),i=n(37);const a=(e,t,n,a,o,s,u,l,c,d)=>(h,{coneInnerAngle:f,coneOuterAngle:p,coneOuterGain:m,distanceModel:g,maxDistance:v,orientationX:y,orientationY:_,orientationZ:b,panningModel:E,positionX:T,positionY:S,positionZ:w,refDistance:A,rolloffFactor:x,...M})=>{const C=n(h,e=>e.createPanner());if(M.channelCount>2)throw l();if("max"===M.channelCountMode)throw l();Object(r.a)(C,M);const R={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},I=a(h,{...R,channelInterpretation:"speakers",numberOfInputs:6}),O=o(h,{...M,gain:1}),D=o(h,{...R,gain:1}),P=o(h,{...R,gain:0}),L=o(h,{...R,gain:0}),N=o(h,{...R,gain:0}),k=o(h,{...R,gain:0}),F=o(h,{...R,gain:0}),B=s(h,256,6,1),U=u(h,{...R,curve:new Float32Array([1,1]),oversample:"none"});let j=[y,_,b],G=[T,S,w];B.onaudioprocess=({inputBuffer:e})=>{const t=[e.getChannelData(0)[0],e.getChannelData(1)[0],e.getChannelData(2)[0]];t.some((e,t)=>e!==j[t])&&(C.setOrientation(...t),j=t);const n=[e.getChannelData(3)[0],e.getChannelData(4)[0],e.getChannelData(5)[0]];n.some((e,t)=>e!==G[t])&&(C.setPosition(...n),G=n)},Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(L.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(k.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0});const H={get bufferSize(){},get channelCount(){return C.channelCount},set channelCount(e){if(e>2)throw l();O.channelCount=e,C.channelCount=e},get channelCountMode(){return C.channelCountMode},set channelCountMode(e){if("max"===e)throw l();O.channelCountMode=e,C.channelCountMode=e},get channelInterpretation(){return C.channelInterpretation},set channelInterpretation(e){O.channelInterpretation=e,C.channelInterpretation=e},get coneInnerAngle(){return C.coneInnerAngle},set coneInnerAngle(e){C.coneInnerAngle=e},get coneOuterAngle(){return C.coneOuterAngle},set coneOuterAngle(e){C.coneOuterAngle=e},get coneOuterGain(){return C.coneOuterGain},set coneOuterGain(e){if(e<0||e>1)throw t();C.coneOuterGain=e},get context(){return C.context},get distanceModel(){return C.distanceModel},set distanceModel(e){C.distanceModel=e},get inputs(){return[O]},get maxDistance(){return C.maxDistance},set maxDistance(e){if(e<0)throw new RangeError;C.maxDistance=e},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get orientationX(){return D.gain},get orientationY(){return P.gain},get orientationZ(){return L.gain},get panningModel(){return C.panningModel},set panningModel(e){if(C.panningModel=e,C.panningModel!==e&&"HRTF"===e)throw l()},get positionX(){return N.gain},get positionY(){return k.gain},get positionZ(){return F.gain},get refDistance(){return C.refDistance},set refDistance(e){if(e<0)throw new RangeError;C.refDistance=e},get rolloffFactor(){return C.rolloffFactor},set rolloffFactor(e){if(e<0)throw new RangeError;C.rolloffFactor=e},addEventListener:(...e)=>O.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>O.dispatchEvent(e[0]),removeEventListener:(...e)=>O.removeEventListener(e[0],e[1],e[2])};f!==H.coneInnerAngle&&(H.coneInnerAngle=f),p!==H.coneOuterAngle&&(H.coneOuterAngle=p),m!==H.coneOuterGain&&(H.coneOuterGain=m),g!==H.distanceModel&&(H.distanceModel=g),v!==H.maxDistance&&(H.maxDistance=v),y!==H.orientationX.value&&(H.orientationX.value=y),_!==H.orientationY.value&&(H.orientationY.value=_),b!==H.orientationZ.value&&(H.orientationZ.value=b),E!==H.panningModel&&(H.panningModel=E),T!==H.positionX.value&&(H.positionX.value=T),S!==H.positionY.value&&(H.positionY.value=S),w!==H.positionZ.value&&(H.positionZ.value=w),A!==H.refDistance&&(H.refDistance=A),x!==H.rolloffFactor&&(H.rolloffFactor=x),1===j[0]&&0===j[1]&&0===j[2]||C.setOrientation(...j),0===G[0]&&0===G[1]&&0===G[2]||C.setPosition(...G);return d(Object(i.a)(H,C),()=>{O.connect(C),e(O,U,0,0),U.connect(D).connect(I,0,0),U.connect(P).connect(I,0,1),U.connect(L).connect(I,0,2),U.connect(N).connect(I,0,3),U.connect(k).connect(I,0,4),U.connect(F).connect(I,0,5),I.connect(B).connect(h.destination)},()=>{O.disconnect(C),c(O,U,0,0),U.disconnect(D),D.disconnect(I),U.disconnect(P),P.disconnect(I),U.disconnect(L),L.disconnect(I),U.disconnect(N),N.disconnect(I),U.disconnect(k),k.disconnect(I),U.disconnect(F),F.disconnect(I),I.disconnect(B),B.disconnect(h.destination)})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,{disableNormalization:n,imag:r,real:i})=>{const a=e(t),o=new Float32Array(r),s=new Float32Array(i);return null!==a?a.createPeriodicWave(s,o,{disableNormalization:n}):t.createPeriodicWave(s,o,{disableNormalization:n})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n,r,i)=>e(t,e=>e.createScriptProcessor(n,r,i))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(22),i=n(10);const a=(e,t,n)=>(a,o)=>e(a,e=>{const s=o.channelCountMode;if("clamped-max"===s)throw n();if(void 0===a.createStereoPanner)return t(a,o);const u=e.createStereoPanner();return Object(i.a)(u,o),Object(r.a)(u,o,"pan"),Object.defineProperty(u,"channelCountMode",{get:()=>s,set:e=>{if(e!==s)throw n()}}),u})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(37);const i=(e,t,n,i,a,o)=>{const s=16385,u=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},d={...c,oversample:"none"},h=(e,r,o,h,f)=>{if(1===r)return((e,t,r,a)=>{const o=new Float32Array(s),h=new Float32Array(s);for(let e=0;e<s;e+=1){const t=e/16384*l;o[e]=Math.cos(t),h[e]=Math.sin(t)}const f=n(e,{...c,gain:0}),p=i(e,{...d,curve:o}),m=i(e,{...d,curve:u}),g=n(e,{...c,gain:0}),v=i(e,{...d,curve:h});return{connectGraph(){t.connect(f),t.connect(m.inputs[0]),t.connect(g),m.connect(r),r.connect(p.inputs[0]),r.connect(v.inputs[0]),p.connect(f.gain),v.connect(g.gain),f.connect(a,0,0),g.connect(a,0,1)},disconnectGraph(){t.disconnect(f),t.disconnect(m.inputs[0]),t.disconnect(g),m.disconnect(r),r.disconnect(p.inputs[0]),r.disconnect(v.inputs[0]),p.disconnect(f.gain),v.disconnect(g.gain),f.disconnect(a,0,0),g.disconnect(a,0,1)}}})(e,o,h,f);if(2===r)return((e,r,a,o)=>{const h=new Float32Array(s),f=new Float32Array(s),p=new Float32Array(s),m=new Float32Array(s),g=Math.floor(8192.5);for(let e=0;e<s;e+=1)if(e>g){const t=(e-g)/(16384-g)*l;h[e]=Math.cos(t),f[e]=Math.sin(t),p[e]=0,m[e]=1}else{const t=e/(16384-g)*l;h[e]=1,f[e]=0,p[e]=Math.cos(t),m[e]=Math.sin(t)}const v=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),y=n(e,{...c,gain:0}),_=i(e,{...d,curve:h}),b=n(e,{...c,gain:0}),E=i(e,{...d,curve:f}),T=i(e,{...d,curve:u}),S=n(e,{...c,gain:0}),w=i(e,{...d,curve:p}),A=n(e,{...c,gain:0}),x=i(e,{...d,curve:m});return{connectGraph(){r.connect(v),r.connect(T.inputs[0]),v.connect(y,1),v.connect(b,1),v.connect(S,1),v.connect(A,1),T.connect(a),a.connect(_.inputs[0]),a.connect(E.inputs[0]),a.connect(w.inputs[0]),a.connect(x.inputs[0]),_.connect(y.gain),E.connect(b.gain),w.connect(S.gain),x.connect(A.gain),y.connect(o,0,0),S.connect(o,0,0),b.connect(o,0,1),A.connect(o,0,1)},disconnectGraph(){r.disconnect(v),r.disconnect(T.inputs[0]),v.disconnect(y,1),v.disconnect(b,1),v.disconnect(S,1),v.disconnect(A,1),T.disconnect(a),a.disconnect(_.inputs[0]),a.disconnect(E.inputs[0]),a.disconnect(w.inputs[0]),a.disconnect(x.inputs[0]),_.disconnect(y.gain),E.disconnect(b.gain),w.disconnect(S.gain),x.disconnect(A.gain),y.disconnect(o,0,0),S.disconnect(o,0,0),b.disconnect(o,0,1),A.disconnect(o,0,1)}}})(e,o,h,f);throw a()};return(t,{channelCount:i,channelCountMode:s,pan:u,...l})=>{if("max"===s)throw a();const c=e(t,{...l,channelCount:1,channelCountMode:s,numberOfInputs:2}),d=n(t,{...l,channelCount:i,channelCountMode:s,gain:1}),f=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:u});let{connectGraph:p,disconnectGraph:m}=h(t,i,d,f,c);Object.defineProperty(f.gain,"defaultValue",{get:()=>0});const g={get bufferSize(){},get channelCount(){return d.channelCount},set channelCount(e){d.channelCount!==e&&(v&&m(),({connectGraph:p,disconnectGraph:m}=h(t,e,d,f,c)),v&&p()),d.channelCount=e},get channelCountMode(){return d.channelCountMode},set channelCountMode(e){if("clamped-max"===e||"max"===e)throw a();d.channelCountMode=e},get channelInterpretation(){return d.channelInterpretation},set channelInterpretation(e){d.channelInterpretation=e},get context(){return d.context},get inputs(){return[d]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return d.numberOfOutputs},get pan(){return f.gain},addEventListener:(...e)=>d.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>d.dispatchEvent(e[0]),removeEventListener:(...e)=>d.removeEventListener(e[0],e[1],e[2])};let v=!1;return o(Object(r.a)(g,c),()=>{p(),v=!0},()=>{m(),v=!1})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(20),i=n(10);const a=(e,t,n,a,o,s,u)=>(l,c)=>{const d=n(l,e=>e.createWaveShaper());try{return d.curve=new Float32Array([1]),a(l,c)}catch{}Object(i.a)(d,c);const h=c.curve;if(null!==h&&h.length<2)throw t();Object(r.a)(d,c,"curve"),Object(r.a)(d,c,"oversample");let f=null,p=!1;u(d,"curve",e=>()=>e.call(d),t=>n=>(t.call(d,n),p&&(o(n)&&null===f?f=e(l,d):o(n)||null===f||(f(),f=null)),n));return s(d,()=>{p=!0,o(d.curve)&&(f=e(l,d))},()=>{p=!1,null!==f&&(f(),f=null)})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(10),i=n(37);const a=(e,t,n,a,o,s)=>(u,{curve:l,oversample:c,...d})=>{const h=n(u,e=>e.createWaveShaper()),f=n(u,e=>e.createWaveShaper());Object(r.a)(h,d),Object(r.a)(f,d);const p=a(u,{...d,gain:1}),m=a(u,{...d,gain:-1}),g=a(u,{...d,gain:1}),v=a(u,{...d,gain:-1});let y=null,_=!1,b=null;const E={get bufferSize(){},get channelCount(){return h.channelCount},set channelCount(e){p.channelCount=e,m.channelCount=e,h.channelCount=e,g.channelCount=e,f.channelCount=e,v.channelCount=e},get channelCountMode(){return h.channelCountMode},set channelCountMode(e){p.channelCountMode=e,m.channelCountMode=e,h.channelCountMode=e,g.channelCountMode=e,f.channelCountMode=e,v.channelCountMode=e},get channelInterpretation(){return h.channelInterpretation},set channelInterpretation(e){p.channelInterpretation=e,m.channelInterpretation=e,h.channelInterpretation=e,g.channelInterpretation=e,f.channelInterpretation=e,v.channelInterpretation=e},get context(){return h.context},get curve(){return b},set curve(n){if(null!==l&&l.length<2)throw t();if(null===n)h.curve=n,f.curve=n;else{const e=n.length,t=new Float32Array(e+2-e%2),r=new Float32Array(e+2-e%2);t[0]=n[0],r[0]=-n[e-1];const i=Math.ceil((e+1)/2),a=(e+1)/2-1;for(let o=1;o<i;o+=1){const s=o/i*a,u=Math.floor(s),l=Math.ceil(s);t[o]=u===l?n[u]:(1-(s-u))*n[u]+(1-(l-s))*n[l],r[o]=u===l?-n[e-1-u]:-(1-(s-u))*n[e-1-u]-(1-(l-s))*n[e-1-l]}t[i]=e%2==1?n[i-1]:(n[i-2]+n[i-1])/2,h.curve=t,f.curve=r}b=n,_&&(o(b)&&null===y?y=e(u,p):null!==y&&(y(),y=null))},get inputs(){return[p]},get numberOfInputs(){return h.numberOfInputs},get numberOfOutputs(){return h.numberOfOutputs},get oversample(){return h.oversample},set oversample(e){h.oversample=e,f.oversample=e},addEventListener:(...e)=>p.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>p.dispatchEvent(e[0]),removeEventListener:(...e)=>p.removeEventListener(e[0],e[1],e[2])};l!==E.curve&&(E.curve=l),c!==E.oversample&&(E.oversample=c);return s(Object(i.a)(E,g),()=>{p.connect(h).connect(g),p.connect(m).connect(f).connect(v).connect(g),_=!0,o(b)&&(y=e(u,p))},()=>{p.disconnect(h),h.disconnect(g),p.disconnect(m),m.disconnect(f),f.disconnect(v),v.disconnect(g),_=!1,null!==y&&(y(),y=null)})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(43);const i={numberOfChannels:1},a=(e,t,n,a,o)=>class extends e{constructor(e,n,o){let s;if("number"==typeof e&&void 0!==n&&void 0!==o)s={length:n,numberOfChannels:e,sampleRate:o};else{if("object"!=typeof e)throw new Error("The given parameters are not valid.");s=e}const{length:u,numberOfChannels:l,sampleRate:c}={...i,...s},d=a(l,u,c);t(r.a,()=>Object(r.a)(d))||d.addEventListener("statechange",(()=>{let e=0;const t=n=>{"running"===this._state&&(e>0?(d.removeEventListener("statechange",t),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):e+=1)};return t})()),super(d,l),this._length=u,this._nativeOfflineAudioContext=d,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",o(this.destination,this._nativeOfflineAudioContext).then(e=>(this._state=null,e)).catch(e=>{throw this._state=null,e}))}_waitForThePromiseToSettle(e){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout(()=>this._waitForThePromiseToSettle(e))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(47),i=n(56);const a={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,type:"sine"},o=(e,t,n,o,s,u,l,c)=>class extends e{constructor(e,n=a){const r=u(e),i={...a,...n},c=o(r,i),d=l(r),h=d?s():null,f=e.sampleRate/2;super(e,!1,c,h),this._detune=t(this,d,c.detune,153600,-153600),this._frequency=t(this,d,c.frequency,f,-f),this._nativeOscillatorNode=c,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==i.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=i.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(e){const t="function"==typeof e?c(this,e):null;this._nativeOscillatorNode.onended=t;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===t?e:n}get type(){return this._nativeOscillatorNode.type}set type(e){if(this._nativeOscillatorNode.type=e,"custom"===e)throw n();null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}start(e=0){if(this._nativeOscillatorNode.start(e),null!==this._oscillatorNodeRenderer)this._oscillatorNodeRenderer.start=e;else{Object(r.a)(this);const e=()=>{this._nativeOscillatorNode.removeEventListener("ended",e),setTimeout(()=>Object(i.a)(this),1e3)};this._nativeOscillatorNode.addEventListener("ended",e)}}stop(e=0){this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);const i=(e,t,n,i,a)=>()=>{const o=new WeakMap;let s=null,u=null,l=null;return{set periodicWave(e){s=e},set start(e){u=e},set stop(e){l=e},render(c,d,h){const f=o.get(d);return void 0!==f?Promise.resolve(f):(async(c,d,h)=>{let f=n(c);const p=Object(r.a)(f,d);if(!p){const e={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:null===s?void 0:s,type:f.type};f=t(d,e),null!==u&&f.start(u),null!==l&&f.stop(l)}return o.set(d,f),p?(await e(d,c.detune,f.detune,h),await e(d,c.frequency,f.frequency,h)):(await i(d,c.detune,f.detune,h),await i(d,c.frequency,f.frequency,h)),await a(c,d,f,h),f})(c,d,h)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15);const i={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},a=(e,t,n,a,o,s)=>class extends e{constructor(e,u=i){const l=o(e),c={...i,...u},d=n(l,c),h=s(l);super(e,!1,d,h?a():null),this._nativePannerNode=d,this._orientationX=t(this,h,d.orientationX,r.b,r.a),this._orientationY=t(this,h,d.orientationY,r.b,r.a),this._orientationZ=t(this,h,d.orientationZ,r.b,r.a),this._positionX=t(this,h,d.positionX,r.b,r.a),this._positionY=t(this,h,d.positionY,r.b,r.a),this._positionZ=t(this,h,d.positionZ,r.b,r.a)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(e){this._nativePannerNode.coneInnerAngle=e}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(e){this._nativePannerNode.coneOuterAngle=e}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(e){this._nativePannerNode.coneOuterGain=e}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(e){this._nativePannerNode.distanceModel=e}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(e){this._nativePannerNode.maxDistance=e}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(e){this._nativePannerNode.panningModel=e}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(e){this._nativePannerNode.refDistance=e}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(e){this._nativePannerNode.rolloffFactor=e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(40),i=n(19);const a=(e,t,n,a,o,s,u,l,c,d)=>()=>{const h=new WeakMap;let f=null;return{render(p,m,g){const v=h.get(m);return void 0!==v?Promise.resolve(v):(async(p,m,g)=>{let v=null,y=s(p);const _={channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation},b={..._,coneInnerAngle:y.coneInnerAngle,coneOuterAngle:y.coneOuterAngle,coneOuterGain:y.coneOuterGain,distanceModel:y.distanceModel,maxDistance:y.maxDistance,panningModel:y.panningModel,refDistance:y.refDistance,rolloffFactor:y.rolloffFactor},E=Object(i.a)(y,m);if("bufferSize"in y)v=a(m,{..._,gain:1});else if(!E){const e={...b,orientationX:y.orientationX.value,orientationY:y.orientationY.value,orientationZ:y.orientationZ.value,positionX:y.positionX.value,positionY:y.positionY.value,positionZ:y.positionZ.value};y=o(m,e)}if(h.set(m,null===v?y:v),null!==v){if(null===f){if(null===u)throw new Error("Missing the native OfflineAudioContext constructor.");const e=new u(6,p.context.length,m.sampleRate),r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});r.connect(e.destination),f=(async()=>{const t=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(async(t,r)=>{const i=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===r?1:0});return await l(e,t,i.offset,g),i}));for(let e=0;e<6;e+=1)t[e].connect(r,0,e),t[e].start(0);return d(e)})()}const e=await f,r=a(m,{..._,gain:1});await c(p,m,r,g);const i=[];for(let t=0;t<e.numberOfChannels;t+=1)i.push(e.getChannelData(t));let s=[i[0][0],i[1][0],i[2][0]],h=[i[3][0],i[4][0],i[5][0]],y=a(m,{..._,gain:1}),E=o(m,{...b,orientationX:s[0],orientationY:s[1],orientationZ:s[2],positionX:h[0],positionY:h[1],positionZ:h[2]});r.connect(y).connect(E.inputs[0]),E.connect(v);for(let t=128;t<e.length;t+=128){const e=[i[0][t],i[1][t],i[2][t]],n=[i[3][t],i[4][t],i[5][t]];if(e.some((e,t)=>e!==s[t])||n.some((e,t)=>e!==h[t])){s=e,h=n;const i=t/m.sampleRate;y.gain.setValueAtTime(0,i),y=a(m,{..._,gain:0}),E=o(m,{...b,orientationX:s[0],orientationY:s[1],orientationZ:s[2],positionX:h[0],positionY:h[1],positionZ:h[2]}),y.gain.setValueAtTime(1,i),r.connect(y).connect(E.inputs[0]),E.connect(v)}}return v}return E?(await e(m,p.orientationX,y.orientationX,g),await e(m,p.orientationY,y.orientationY,g),await e(m,p.orientationZ,y.orientationZ,g),await e(m,p.positionX,y.positionX,g),await e(m,p.positionY,y.positionY,g),await e(m,p.positionZ,y.positionZ,g)):(await l(m,p.orientationX,y.orientationX,g),await l(m,p.orientationY,y.orientationY,g),await l(m,p.orientationZ,y.orientationZ,g),await l(m,p.positionX,y.positionX,g),await l(m,p.positionY,y.positionY,g),await l(m,p.positionZ,y.positionZ,g)),Object(r.a)(y)?await c(p,m,y.inputs[0],g):await c(p,m,y,g),y})(p,m,g)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={disableNormalization:!1},i=(e,t,n)=>class i{constructor(i,a){const o=t(i),s={...r,...a},u=e(o,s);return n.add(u),u}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===i.prototype||n.has(e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>(n,r,i,a)=>(e(r).replay(i),t(r,n,i,a))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n)=>async(r,i,a,o)=>{const s=e(r),u=[...o,r];await Promise.all(s.activeInputs.map((e,o)=>Array.from(e).filter(([e])=>!u.includes(e)).map(async([e,s])=>{const l=t(e),c=await l.render(e,i,u),d=r.context.destination;n(e)||r===d&&n(r)||c.connect(a,s,o)})).reduce((e,t)=>[...e,...t],[]))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n)=>async(r,i,a,o)=>{const s=t(r);await Promise.all(Array.from(s.activeInputs).map(async([t,r])=>{const s=e(t),u=await s.render(t,i,o);n(t)||u.connect(a,r)}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(43);const i=(e,t,n,i)=>a=>e(r.a,()=>Object(r.a)(a))?Promise.resolve(e(i,i)).then(e=>{if(!e){const e=n(a,512,0,1);a.oncomplete=()=>{e.onaudioprocess=null,e.disconnect()},e.onaudioprocess=()=>a.currentTime,e.connect(a.destination)}return a.startRendering()}):new Promise(e=>{const n=t(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});a.oncomplete=t=>{n.disconnect(),e(t.renderedBuffer)},n.connect(a.destination),a.startRendering()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(79);const i=(e,t,n,i,a,o,s,u)=>{const l=[];return(c,d)=>n(c).render(c,d,l).then(()=>Promise.all(Array.from(i(d)).map(e=>n(e).render(e,d,l)))).then(()=>a(d)).then(n=>("function"!=typeof n.copyFromChannel?(s(n),Object(r.a)(n)):t(o,()=>o(n))||u(n),e.add(n),n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},i=(e,t,n,i,a,o)=>class extends e{constructor(e,s=r){const u=a(e),l={...r,...s},c=n(u,l),d=o(u);super(e,!1,c,d?i():null),this._pan=t(this,d,c.pan,1,-1)}get pan(){return this._pan}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(40),i=n(19);const a=(e,t,n,a,o)=>()=>{const s=new WeakMap;return{render(u,l,c){const d=s.get(l);return void 0!==d?Promise.resolve(d):(async(u,l,c)=>{let d=n(u);const h=Object(i.a)(d,l);if(!h){const e={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,pan:d.pan.value};d=t(l,e)}return s.set(l,d),h?await e(l,u.pan,d.pan,c):await a(l,u.pan,d.pan,c),Object(r.a)(d)?await o(u,l,d.inputs[0],c):await o(u,l,d,c),d})(u,l,c)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>{if(null===e)return!1;try{new e({length:1,sampleRate:44100})}catch{return!1}return!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>{if(null===e)return!1;const t=new e(1,1,44100).createBuffer(1,1,44100);if(void 0===t.copyToChannel)return!0;const n=new Float32Array(2);try{t.copyFromChannel(n,0,0)}catch{return!1}return!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>{const n=e(t,e=>e.createBufferSource());n.start();try{n.start()}catch{return!0}return!1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>{if(null===e)return Promise.resolve(!1);const t=new e(1,1,44100),n=t.createBuffer(1,1,t.sampleRate),r=t.createBufferSource();return n.getChannelData(0)[0]=1,r.buffer=n,r.start(0,0,0),r.connect(t.destination),new Promise(e=>{t.oncomplete=({renderedBuffer:t})=>{e(0===t.getChannelData(0)[0])},t.startRendering()})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>{const n=e(t,e=>e.createBufferSource()),r=t.createBuffer(1,1,44100);n.buffer=r;try{n.start(0,1)}catch{return!1}return!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>{const n=e(t,e=>e.createBufferSource());n.start();try{n.stop()}catch{return!1}return!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>{if(null===e)return!1;if(void 0!==e.prototype&&void 0!==e.prototype.close)return!0;const t=new e,n=void 0!==t.close;try{t.close()}catch{}return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>{if(null===e)return Promise.resolve(!1);const t=new e(1,1,44100);return new Promise(e=>{let n=!0;const r=r=>{n&&(n=!1,t.startRendering(),e(r instanceof TypeError))};let i;try{i=t.decodeAudioData(null,()=>{},r)}catch(e){r(e)}void 0!==i&&i.catch(r)})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>{if(null===e)return!1;let t;try{t=new e({latencyHint:"balanced"})}catch{return!1}return t.close(),!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>{if(null===e)return!1;const t=new e(1,1,44100).createGain(),n=t.connect(t)===t;return t.disconnect(t),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>{const n=e(t,e=>e.createOscillator());try{n.start(-1)}catch(e){return e instanceof RangeError}return!1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>{const n=t.createBuffer(1,1,44100),r=e(t,e=>e.createBufferSource());r.buffer=n,r.start(),r.stop();try{return r.stop(),!0}catch{return!1}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>{const n=e(t,e=>e.createOscillator());try{n.stop(-1)}catch(e){return e instanceof RangeError}return!1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>async()=>{if(null===e)return!0;if(null===t)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(){this.port.postMessage(0)}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new t(1,128,3200),i=URL.createObjectURL(n);let a=!1;try{await r.audioWorklet.addModule(i);const t=r.createGain(),n=new e(r,"a",{numberOfOutputs:0});n.port.onmessage=()=>a=!0,t.connect(n),await r.startRendering()}catch{}finally{URL.revokeObjectURL(i)}return a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>()=>{if(null===t)return!1;const n=new t(1,1,44100),r=e(n,e=>e.createChannelMerger());if("max"===r.channelCountMode)return!0;try{r.channelCount=2}catch{return!0}return!1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>()=>{if(null===t)return!1;const n=new t(1,1,44100);if(void 0===n.createConstantSource)return!0;return e(n,e=>e.createConstantSource()).offset.maxValue!==Number.POSITIVE_INFINITY}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>{if(null===e)return!1;const t=new e(1,1,44100),n=t.createConvolver();n.buffer=t.createBuffer(1,1,t.sampleRate);try{n.buffer=t.createBuffer(1,1,t.sampleRate)}catch{return!1}return!0}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>null!==e&&e.hasOwnProperty("isSecureContext")},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>{if(null===e)return!1;const t=new e;try{return t.createMediaStreamSource(new MediaStream),!1}catch(e){return!0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>()=>{if(null===t)return Promise.resolve(!1);const n=new t(1,1,44100),r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(e=>{n.oncomplete=()=>{r.disconnect(),e(0!==n.currentTime)},n.startRendering()})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>()=>{if(null===e)return Promise.resolve(!1);const t=new e(1,1,44100);if(void 0===t.createStereoPanner)return Promise.resolve(!0);if(void 0===t.createConstantSource)return Promise.resolve(!0);const n=t.createConstantSource(),r=t.createStereoPanner();return n.channelCount=1,n.offset.value=1,r.channelCount=1,n.start(),n.connect(r).connect(t.destination),t.startRendering().then(e=>1!==e.getChannelData(0)[0])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},i=(e,t,n,i,a,o)=>class extends e{constructor(e,t=r){const s=a(e),u={...r,...t},l=n(s,u);super(e,!0,l,o(s)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=l}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(e){this._nativeWaveShaperNode.oversample=e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(40),i=n(19);const a=(e,t,n)=>()=>{const a=new WeakMap;return{render(o,s,u){const l=a.get(s);return void 0!==l?Promise.resolve(l):(async(o,s,u)=>{let l=t(o);if(!Object(i.a)(l,s)){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,curve:l.curve,oversample:l.oversample};l=e(s,t)}return a.set(s,l),Object(r.a)(l)?await n(o,s,l.inputs[0],u):await n(o,s,l,u),l})(o,s,u)}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>"undefined"==typeof window?null:window},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>n=>{n.copyFromChannel=(r,i,a=0)=>{const o=e(a),s=e(i);if(s>=n.numberOfChannels)throw t();const u=n.length,l=n.getChannelData(s),c=r.length;for(let e=o<0?-o:0;e+o<u&&e<c;e+=1)r[e]=l[e+o]},n.copyToChannel=(r,i,a=0)=>{const o=e(a),s=e(i);if(s>=n.numberOfChannels)throw t();const u=n.length,l=n.getChannelData(s),c=r.length;for(let e=o<0?-o:0;e+o<u&&e<c;e+=1)l[e+o]=r[e]}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>t=>{var n,r;t.copyFromChannel=(n=t.copyFromChannel,(r,i,a=0)=>{const o=e(a),s=e(i);if(o<t.length)return n.call(t,r,s,o)}),t.copyToChannel=(r=t.copyToChannel,(n,i,a=0)=>{const o=e(a),s=e(i);if(o<t.length)return r.call(t,n,s,o)})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>(t,n)=>{const r=n.createBuffer(1,1,n.sampleRate);null===t.buffer&&(t.buffer=r),e(t,"buffer",e=>()=>{const n=e.call(t);return n===r?null:n},e=>n=>e.call(t,null===n?r:n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(37);const i=e=>(t,n)=>{const i=e(n,e=>e.createGain());t.connect(i);const a=(o=t.disconnect,()=>{o.call(t,i),t.removeEventListener("ended",a)});var o;t.addEventListener("ended",a),Object(r.a)(t,i),t.stop=(e=>{let n=!1;return(r=0)=>{if(n)try{e.call(t,r)}catch{i.gain.setValueAtTime(0,r)}else e.call(t,r),n=!0}})(t.stop)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n)=>(r,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const a=t(r,e=>e.createBufferSource());n(i,()=>{const e=i.numberOfInputs;for(let t=0;t<e;t+=1)a.connect(i,0,t)},()=>a.disconnect(i))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=()=>new Promise(e=>{const t=new ArrayBuffer(0),{port1:n,port2:r}=new MessageChannel;n.onmessage=({data:t})=>e(null!==t),r.postMessage(t,[t])})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=e=>{var t;e.start=(t=e.start,(n=0,r=0,i)=>{const a=e.buffer,o=null===a?r:Math.min(a.duration,r);null!==a&&o>a.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,o,i)})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(857),i=n(21),a=n(101);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.videoPlayer=t,this.videoEvents=(o(n={},"sun",{time:0,launched:!1}),o(n,"janelleA",{time:144,launched:!1}),o(n,"janelleB",{time:160,launched:!1}),o(n,"bridgid",{time:295,launched:!1}),n),this.eventAssemblies={}}var t,n,u;return t=e,(n=[{key:"setup",value:function(){var e=this;for(var t in console.log("Time tracker setup "+this.videoPlayer),this.videoEvents){var n,o,s,u=new r.a(t);switch(t){case"sun":n=new i.Vector3(-78,-13,52),o=new i.Vector3(75,50,50),s=new i.Color("skyblue");break;case"janelleA":n=new i.Vector3(-30,-7.8,-100),o=new i.Vector3(75,100,50),s=new i.Color("white");break;case"janelleB":n=new i.Vector3(-121,-10,-10),o=new i.Vector3(75,120,50),s=new i.Color("coral");break;case"bridgid":n=new i.Vector3(98,0,30),o=new i.Vector3(150,100,50),s=new i.Color("darkseagreen")}u.position=n,u.scale=o,u.color=s,u.setup();var l={};switch(t){case"sun":l=Object(a.d)(u);break;case"janelleA":l=Object(a.b)(u);break;case"janelleB":l=Object(a.c)(u);break;case"bridgid":l=Object(a.a)(u)}u.animation=l,this.eventAssemblies[t]=u}this.videoPlayer.on("timeupdate",(function(){e.checkEvents()}))}},{key:"checkEvents",value:function(){var e=this.videoPlayer.currentTime();for(var t in this.videoEvents){var n=this.videoEvents[t];e>=n.time&&!n.launched&&(console.log("event triggered: "+t),console.log("event value: "+n),console.log("event data: "+n.time),this.eventAssemblies[t].start(),n.launched=!0)}}}])&&s(t.prototype,n),u&&s(t,u),e}()},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var r=n(21),i=n(858);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this.position=new r.Vector3(0,0,20),this.animation={},this.scale=new r.Vector3(50,50,50),this.color=null,console.log("Event Assembly made: "+this.name)}var n,o,s;return n=t,(o=[{key:"setup",value:function(){this.gazeTarget=e.gazeSystem.makeGazeTarget(this.name,this.position,this.scale,this.color),e.ias.spawnGranulator(this.name)}},{key:"dispose",value:function(){var e=this.name;this.name=null,this.position=null,this.gazeTarget=null,this.animation=null,console.log("Event Assembly destroyed: "+e)}},{key:"start",value:function(){e.ias.start(this.name),Object(i.a)(this.animation)}}])&&a(n.prototype,o),s&&a(n,s),t}()}).call(this,n(27))},function(e,t,n){"use strict";var r={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},i={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},a=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],o={CSS:{},springs:{}};function s(e,t,n){return Math.min(Math.max(e,t),n)}function u(e,t){return e.indexOf(t)>-1}function l(e,t){return e.apply(null,t)}var c={arr:function(e){return Array.isArray(e)},obj:function(e){return u(Object.prototype.toString.call(e),"Object")},pth:function(e){return c.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return e.nodeType||c.svg(e)},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return void 0===e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return c.hex(e)||c.rgb(e)||c.hsl(e)},key:function(e){return!r.hasOwnProperty(e)&&!i.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function d(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map((function(e){return parseFloat(e)})):[]}function h(e,t){var n=d(e),r=s(c.und(n[0])?1:n[0],.1,100),i=s(c.und(n[1])?100:n[1],.1,100),a=s(c.und(n[2])?10:n[2],.1,100),u=s(c.und(n[3])?0:n[3],.1,100),l=Math.sqrt(i/r),h=a/(2*Math.sqrt(i*r)),f=h<1?l*Math.sqrt(1-h*h):0,p=h<1?(h*l-u)/f:-u+l;function m(e){var n=t?t*e/1e3:e;return n=h<1?Math.exp(-n*h*l)*(1*Math.cos(f*n)+p*Math.sin(f*n)):(1+p*n)*Math.exp(-n*l),0===e||1===e?e:1-n}return t?m:function(){var t=o.springs[e];if(t)return t;for(var n=1/6,r=0,i=0;;)if(1===m(r+=n)){if(++i>=16)break}else i=0;var a=r*n*1e3;return o.springs[e]=a,a}}function f(e){return void 0===e&&(e=10),function(t){return Math.ceil(s(t,1e-6,1)*e)*(1/e)}}var p,m,g=function(){var e=.1;function t(e,t){return 1-3*t+3*e}function n(e,t){return 3*t-6*e}function r(e){return 3*e}function i(e,i,a){return((t(i,a)*e+n(i,a))*e+r(i))*e}function a(e,i,a){return 3*t(i,a)*e*e+2*n(i,a)*e+r(i)}return function(t,n,r,o){if(0<=t&&t<=1&&0<=r&&r<=1){var s=new Float32Array(11);if(t!==n||r!==o)for(var u=0;u<11;++u)s[u]=i(u*e,t,r);return function(e){return t===n&&r===o||0===e||1===e?e:i(l(e),n,o)}}function l(n){for(var o=0,u=1;10!==u&&s[u]<=n;++u)o+=e;--u;var l=o+(n-s[u])/(s[u+1]-s[u])*e,c=a(l,t,r);return c>=.001?function(e,t,n,r){for(var o=0;o<4;++o){var s=a(t,n,r);if(0===s)return t;t-=(i(t,n,r)-e)/s}return t}(n,l,t,r):0===c?l:function(e,t,n,r,a){var o,s,u=0;do{(o=i(s=t+(n-t)/2,r,a)-e)>0?n=s:t=s}while(Math.abs(o)>1e-7&&++u<10);return s}(n,o,o+e,t,r)}}}(),v=(p={linear:function(){return function(e){return e}}},m={Sine:function(){return function(e){return 1-Math.cos(e*Math.PI/2)}},Circ:function(){return function(e){return 1-Math.sqrt(1-e*e)}},Back:function(){return function(e){return e*e*(3*e-2)}},Bounce:function(){return function(e){for(var t,n=4;e<((t=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*t-2)/22-e,2)}},Elastic:function(e,t){void 0===e&&(e=1),void 0===t&&(t=.5);var n=s(e,1,10),r=s(t,.1,2);return function(e){return 0===e||1===e?e:-n*Math.pow(2,10*(e-1))*Math.sin((e-1-r/(2*Math.PI)*Math.asin(1/n))*(2*Math.PI)/r)}}},["Quad","Cubic","Quart","Quint","Expo"].forEach((function(e,t){m[e]=function(){return function(e){return Math.pow(e,t+2)}}})),Object.keys(m).forEach((function(e){var t=m[e];p["easeIn"+e]=t,p["easeOut"+e]=function(e,n){return function(r){return 1-t(e,n)(1-r)}},p["easeInOut"+e]=function(e,n){return function(r){return r<.5?t(e,n)(2*r)/2:1-t(e,n)(-2*r+2)/2}}})),p);function y(e,t){if(c.fnc(e))return e;var n=e.split("(")[0],r=v[n],i=d(e);switch(n){case"spring":return h(e,t);case"cubicBezier":return l(g,i);case"steps":return l(f,i);default:return l(r,i)}}function _(e){try{return document.querySelectorAll(e)}catch(e){return}}function b(e,t){for(var n=e.length,r=arguments.length>=2?arguments[1]:void 0,i=[],a=0;a<n;a++)if(a in e){var o=e[a];t.call(r,o,a,e)&&i.push(o)}return i}function E(e){return e.reduce((function(e,t){return e.concat(c.arr(t)?E(t):t)}),[])}function T(e){return c.arr(e)?e:(c.str(e)&&(e=_(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function S(e,t){return e.some((function(e){return e===t}))}function w(e){var t={};for(var n in e)t[n]=e[n];return t}function A(e,t){var n=w(e);for(var r in e)n[r]=t.hasOwnProperty(r)?t[r]:e[r];return n}function x(e,t){var n=w(e);for(var r in t)n[r]=c.und(e[r])?t[r]:e[r];return n}function M(e){return c.rgb(e)?(n=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t=e))?"rgba("+n[1]+",1)":t:c.hex(e)?function(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,n,r){return t+t+n+n+r+r})),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+parseInt(n[1],16)+","+parseInt(n[2],16)+","+parseInt(n[3],16)+",1)"}(e):c.hsl(e)?function(e){var t,n,r,i=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),a=parseInt(i[1],10)/360,o=parseInt(i[2],10)/100,s=parseInt(i[3],10)/100,u=i[4]||1;function l(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(0==o)t=n=r=s;else{var c=s<.5?s*(1+o):s+o-s*o,d=2*s-c;t=l(d,c,a+1/3),n=l(d,c,a),r=l(d,c,a-1/3)}return"rgba("+255*t+","+255*n+","+255*r+","+u+")"}(e):void 0;var t,n}function C(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function R(e,t){return c.fnc(e)?e(t.target,t.id,t.total):e}function I(e,t){return e.getAttribute(t)}function O(e,t,n){if(S([n,"deg","rad","turn"],C(t)))return t;var r=o.CSS[t+n];if(!c.und(r))return r;var i=document.createElement(e.tagName),a=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;a.appendChild(i),i.style.position="absolute",i.style.width=100+n;var s=100/i.offsetWidth;a.removeChild(i);var u=s*parseFloat(t);return o.CSS[t+n]=u,u}function D(e,t,n){if(t in e.style){var r=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i=e.style[t]||getComputedStyle(e).getPropertyValue(r)||"0";return n?O(e,i,n):i}}function P(e,t){return c.dom(e)&&!c.inp(e)&&(I(e,t)||c.svg(e)&&e[t])?"attribute":c.dom(e)&&S(a,t)?"transform":c.dom(e)&&"transform"!==t&&D(e,t)?"css":null!=e[t]?"object":void 0}function L(e){if(c.dom(e)){for(var t,n=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map;t=r.exec(n);)i.set(t[1],t[2]);return i}}function N(e,t,n,r){var i=u(t,"scale")?1:0+function(e){return u(e,"translate")||"perspective"===e?"px":u(e,"rotate")||u(e,"skew")?"deg":void 0}(t),a=L(e).get(t)||i;return n&&(n.transforms.list.set(t,a),n.transforms.last=t),r?O(e,a,r):a}function k(e,t,n,r){switch(P(e,t)){case"transform":return N(e,t,r,n);case"css":return D(e,t,n);case"attribute":return I(e,t);default:return e[t]||0}}function F(e,t){var n=/^(\*=|\+=|-=)/.exec(e);if(!n)return e;var r=C(e)||0,i=parseFloat(t),a=parseFloat(e.replace(n[0],""));switch(n[0][0]){case"+":return i+a+r;case"-":return i-a+r;case"*":return i*a+r}}function B(e,t){if(c.col(e))return M(e);if(/\s/g.test(e))return e;var n=C(e),r=n?e.substr(0,e.length-n.length):e;return t?r+t:r}function U(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function j(e){for(var t,n=e.points,r=0,i=0;i<n.numberOfItems;i++){var a=n.getItem(i);i>0&&(r+=U(t,a)),t=a}return r}function G(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return function(e){return 2*Math.PI*I(e,"r")}(e);case"rect":return function(e){return 2*I(e,"width")+2*I(e,"height")}(e);case"line":return function(e){return U({x:I(e,"x1"),y:I(e,"y1")},{x:I(e,"x2"),y:I(e,"y2")})}(e);case"polyline":return j(e);case"polygon":return function(e){var t=e.points;return j(e)+U(t.getItem(t.numberOfItems-1),t.getItem(0))}(e)}}function H(e,t){var n=t||{},r=n.el||function(e){for(var t=e.parentNode;c.svg(t)&&c.svg(t.parentNode);)t=t.parentNode;return t}(e),i=r.getBoundingClientRect(),a=I(r,"viewBox"),o=i.width,s=i.height,u=n.viewBox||(a?a.split(" "):[0,0,o,s]);return{el:r,viewBox:u,x:u[0]/1,y:u[1]/1,w:o/u[2],h:s/u[3]}}function V(e,t){function n(n){void 0===n&&(n=0);var r=t+n>=1?t+n:0;return e.el.getPointAtLength(r)}var r=H(e.el,e.svg),i=n(),a=n(-1),o=n(1);switch(e.property){case"x":return(i.x-r.x)*r.w;case"y":return(i.y-r.y)*r.h;case"angle":return 180*Math.atan2(o.y-a.y,o.x-a.x)/Math.PI}}function z(e,t){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,r=B(c.pth(e)?e.totalLength:e,t)+"";return{original:r,numbers:r.match(n)?r.match(n).map(Number):[0],strings:c.str(e)||t?r.split(n):[]}}function W(e){return b(e?E(c.arr(e)?e.map(T):T(e)):[],(function(e,t,n){return n.indexOf(e)===t}))}function q(e){var t=W(e);return t.map((function(e,n){return{target:e,id:n,total:t.length,transforms:{list:L(e)}}}))}function Y(e,t){var n=w(t);if(/^spring/.test(n.easing)&&(n.duration=h(n.easing)),c.arr(e)){var r=e.length;2===r&&!c.obj(e[0])?e={value:e}:c.fnc(t.duration)||(n.duration=t.duration/r)}var i=c.arr(e)?e:[e];return i.map((function(e,n){var r=c.obj(e)&&!c.pth(e)?e:{value:e};return c.und(r.delay)&&(r.delay=n?0:t.delay),c.und(r.endDelay)&&(r.endDelay=n===i.length-1?t.endDelay:0),r})).map((function(e){return x(e,n)}))}function K(e,t){var n=[],r=t.keyframes;for(var i in r&&(t=x(function(e){for(var t=b(E(e.map((function(e){return Object.keys(e)}))),(function(e){return c.key(e)})).reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]),n={},r=function(r){var i=t[r];n[i]=e.map((function(e){var t={};for(var n in e)c.key(n)?n==i&&(t.value=e[n]):t[n]=e[n];return t}))},i=0;i<t.length;i++)r(i);return n}(r),t)),t)c.key(i)&&n.push({name:i,tweens:Y(t[i],e)});return n}function X(e,t){var n;return e.tweens.map((function(r){var i=function(e,t){var n={};for(var r in e){var i=R(e[r],t);c.arr(i)&&1===(i=i.map((function(e){return R(e,t)}))).length&&(i=i[0]),n[r]=i}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}(r,t),a=i.value,o=c.arr(a)?a[1]:a,s=C(o),u=k(t.target,e.name,s,t),l=n?n.to.original:u,d=c.arr(a)?a[0]:l,h=C(d)||C(u),f=s||h;return c.und(o)&&(o=l),i.from=z(d,f),i.to=z(F(o,d),f),i.start=n?n.end:0,i.end=i.start+i.delay+i.duration+i.endDelay,i.easing=y(i.easing,i.duration),i.isPath=c.pth(a),i.isColor=c.col(i.from.original),i.isColor&&(i.round=1),n=i,i}))}var Q={css:function(e,t,n){return e.style[t]=n},attribute:function(e,t,n){return e.setAttribute(t,n)},object:function(e,t,n){return e[t]=n},transform:function(e,t,n,r,i){if(r.list.set(t,n),t===r.last||i){var a="";r.list.forEach((function(e,t){a+=t+"("+e+") "})),e.style.transform=a}}};function Z(e,t){q(e).forEach((function(e){for(var n in t){var r=R(t[n],e),i=e.target,a=C(r),o=k(i,n,a,e),s=F(B(r,a||C(o)),o),u=P(i,n);Q[u](i,n,s,e.transforms,!0)}}))}function J(e,t){return b(E(e.map((function(e){return t.map((function(t){return function(e,t){var n=P(e.target,t.name);if(n){var r=X(t,e),i=r[r.length-1];return{type:n,property:t.name,animatable:e,tweens:r,duration:i.end,delay:r[0].delay,endDelay:i.endDelay}}}(e,t)}))}))),(function(e){return!c.und(e)}))}function $(e,t){var n=e.length,r=function(e){return e.timelineOffset?e.timelineOffset:0},i={};return i.duration=n?Math.max.apply(Math,e.map((function(e){return r(e)+e.duration}))):t.duration,i.delay=n?Math.min.apply(Math,e.map((function(e){return r(e)+e.delay}))):t.delay,i.endDelay=n?i.duration-Math.max.apply(Math,e.map((function(e){return r(e)+e.duration-e.endDelay}))):t.endDelay,i}var ee=0;var te,ne=[],re=[],ie=function(){function e(){te=requestAnimationFrame(t)}function t(t){var n=ne.length;if(n){for(var r=0;r<n;){var i=ne[r];if(i.paused){var a=ne.indexOf(i);a>-1&&(ne.splice(a,1),n=ne.length)}else i.tick(t);r++}e()}else te=cancelAnimationFrame(te)}return e}();function ae(e){void 0===e&&(e={});var t,n=0,a=0,o=0,u=0,l=null;function c(e){var t=window.Promise&&new Promise((function(e){return l=e}));return e.finished=t,t}var d=function(e){var t=A(r,e),n=A(i,e),a=K(n,e),o=q(e.targets),s=J(o,a),u=$(s,n),l=ee;return ee++,x(t,{id:l,children:[],animatables:o,animations:s,duration:u.duration,delay:u.delay,endDelay:u.endDelay})}(e);c(d);function h(){var e=d.direction;"alternate"!==e&&(d.direction="normal"!==e?"normal":"reverse"),d.reversed=!d.reversed,t.forEach((function(e){return e.reversed=d.reversed}))}function f(e){return d.reversed?d.duration-e:e}function p(){n=0,a=f(d.currentTime)*(1/ae.speed)}function m(e,t){t&&t.seek(e-t.timelineOffset)}function g(e){for(var t=0,n=d.animations,r=n.length;t<r;){var i=n[t],a=i.animatable,o=i.tweens,u=o.length-1,l=o[u];u&&(l=b(o,(function(t){return e<t.end}))[0]||l);for(var c=s(e-l.start-l.delay,0,l.duration)/l.duration,h=isNaN(c)?1:l.easing(c),f=l.to.strings,p=l.round,m=[],g=l.to.numbers.length,v=void 0,y=0;y<g;y++){var _=void 0,E=l.to.numbers[y],T=l.from.numbers[y]||0;_=l.isPath?V(l.value,h*E):T+h*(E-T),p&&(l.isColor&&y>2||(_=Math.round(_*p)/p)),m.push(_)}var S=f.length;if(S){v=f[0];for(var w=0;w<S;w++){f[w];var A=f[w+1],x=m[w];isNaN(x)||(v+=A?x+A:x+" ")}}else v=m[0];Q[i.type](a.target,i.property,v,a.transforms),i.currentValue=v,t++}}function v(e){d[e]&&!d.passThrough&&d[e](d)}function y(e){var r=d.duration,i=d.delay,p=r-d.endDelay,y=f(e);d.progress=s(y/r*100,0,100),d.reversePlayback=y<d.currentTime,t&&function(e){if(d.reversePlayback)for(var n=u;n--;)m(e,t[n]);else for(var r=0;r<u;r++)m(e,t[r])}(y),!d.began&&d.currentTime>0&&(d.began=!0,v("begin")),!d.loopBegan&&d.currentTime>0&&(d.loopBegan=!0,v("loopBegin")),y<=i&&0!==d.currentTime&&g(0),(y>=p&&d.currentTime!==r||!r)&&g(r),y>i&&y<p?(d.changeBegan||(d.changeBegan=!0,d.changeCompleted=!1,v("changeBegin")),v("change"),g(y)):d.changeBegan&&(d.changeCompleted=!0,d.changeBegan=!1,v("changeComplete")),d.currentTime=s(y,0,r),d.began&&v("update"),e>=r&&(a=0,d.remaining&&!0!==d.remaining&&d.remaining--,d.remaining?(n=o,v("loopComplete"),d.loopBegan=!1,"alternate"===d.direction&&h()):(d.paused=!0,d.completed||(d.completed=!0,v("loopComplete"),v("complete"),!d.passThrough&&"Promise"in window&&(l(),c(d)))))}return d.reset=function(){var e=d.direction;d.passThrough=!1,d.currentTime=0,d.progress=0,d.paused=!0,d.began=!1,d.loopBegan=!1,d.changeBegan=!1,d.completed=!1,d.changeCompleted=!1,d.reversePlayback=!1,d.reversed="reverse"===e,d.remaining=d.loop,t=d.children;for(var n=u=t.length;n--;)d.children[n].reset();(d.reversed&&!0!==d.loop||"alternate"===e&&1===d.loop)&&d.remaining++,g(d.reversed?d.duration:0)},d.set=function(e,t){return Z(e,t),d},d.tick=function(e){o=e,n||(n=o),y((o+(a-n))*ae.speed)},d.seek=function(e){y(f(e))},d.pause=function(){d.paused=!0,p()},d.play=function(){d.paused&&(d.completed&&d.reset(),d.paused=!1,ne.push(d),p(),te||ie())},d.reverse=function(){h(),d.completed=!d.reversed,p()},d.restart=function(){d.reset(),d.play()},d.reset(),d.autoplay&&d.play(),d}function oe(e,t){for(var n=t.length;n--;)S(e,t[n].animatable.target)&&t.splice(n,1)}"undefined"!=typeof document&&document.addEventListener("visibilitychange",(function(){document.hidden?(ne.forEach((function(e){return e.pause()})),re=ne.slice(0),ae.running=ne=[]):re.forEach((function(e){return e.play()}))})),ae.version="3.2.0",ae.speed=1,ae.running=ne,ae.remove=function(e){for(var t=W(e),n=ne.length;n--;){var r=ne[n],i=r.animations,a=r.children;oe(t,i);for(var o=a.length;o--;){var s=a[o],u=s.animations;oe(t,u),u.length||s.children.length||a.splice(o,1)}i.length||a.length||r.pause()}},ae.get=k,ae.set=Z,ae.convertPx=O,ae.path=function(e,t){var n=c.str(e)?_(e)[0]:e,r=t||100;return function(e){return{property:e,el:n,svg:H(n),totalLength:G(n)*(r/100)}}},ae.setDashoffset=function(e){var t=G(e);return e.setAttribute("stroke-dasharray",t),t},ae.stagger=function(e,t){void 0===t&&(t={});var n=t.direction||"normal",r=t.easing?y(t.easing):null,i=t.grid,a=t.axis,o=t.from||0,s="first"===o,u="center"===o,l="last"===o,d=c.arr(e),h=d?parseFloat(e[0]):parseFloat(e),f=d?parseFloat(e[1]):0,p=C(d?e[1]:e)||0,m=t.start||0+(d?h:0),g=[],v=0;return function(e,t,c){if(s&&(o=0),u&&(o=(c-1)/2),l&&(o=c-1),!g.length){for(var y=0;y<c;y++){if(i){var _=u?(i[0]-1)/2:o%i[0],b=u?(i[1]-1)/2:Math.floor(o/i[0]),E=_-y%i[0],T=b-Math.floor(y/i[0]),S=Math.sqrt(E*E+T*T);"x"===a&&(S=-E),"y"===a&&(S=-T),g.push(S)}else g.push(Math.abs(o-y));v=Math.max.apply(Math,g)}r&&(g=g.map((function(e){return r(e/v)*v}))),"reverse"===n&&(g=g.map((function(e){return a?e<0?-1*e:-e:Math.abs(v-e)})))}return m+(d?(f-h)/v:h)*(Math.round(100*g[t])/100)+p}},ae.timeline=function(e){void 0===e&&(e={});var t=ae(e);return t.duration=0,t.add=function(n,r){var a=ne.indexOf(t),o=t.children;function s(e){e.passThrough=!0}a>-1&&ne.splice(a,1);for(var u=0;u<o.length;u++)s(o[u]);var l=x(n,A(i,e));l.targets=l.targets||e.targets;var d=t.duration;l.autoplay=!1,l.direction=t.direction,l.timelineOffset=c.und(r)?d:F(r,d),s(t),t.seek(l.timelineOffset);var h=ae(l);s(h),o.push(h);var f=$(o,e);return t.delay=f.delay,t.endDelay=f.endDelay,t.duration=f.duration,t.seek(0),t.reset(),t.autoplay&&t.play(),t},t},ae.easing=y,ae.penner=v,ae.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},t.a=ae},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var r=n(860),i=n(21),a=n(861),o=n.n(a);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="Gaze System",this.scene=null,this.gazeEvent=null,this.targets={},this.xrActive=!1,this.pos=null,this.fwd=null,this.animate_gaze=this.animate_gaze.bind(this)}var n,a,u;return n=t,(a=[{key:"setup",value:function(){var t=this,n=e.hoast360.videoPlayer.xr();t.scene=n.scene,t.scene.name="xrVideoPlayerScene";var r=n.camera;this.camera=r,this.camera.name="xrGazeCamera",this.gazeEvent=new o.a,this.pos=new i.Vector3(0,0,0),this.fwd=new i.Vector3(0,0,0),this._setupGaze(),e.hoast360.videoPlayer.xr().on("xrSessionActivated",(function(){console.log("xr active (this): "+this.name),console.log("scope: "+t.name),t.xrActive=!0,t.xrSession=this.currentSession,t.xrRefSpace=this.xrReferenceSpace,t.xrSession.requestAnimationFrame(t.animate_gaze)})),console.log("GazeSystem setup")}},{key:"_setupGaze",value:function(){var t=this,n=e.hoast360,r=n.videoPlayer.xr(),i=r.controls3d;this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=0,t.xrActive||(i.update(),i.orbit.update(),i.orbit.enableZoom=!1),i.orbit.addEventListener("change",(function(){t.xrActive||(t.gazeEvent.update(t.camera),t.fwd=r.cameraVector,e.ias.ListenerForward=t.fwd,null!=t.arrow&&(t.pos.x=t.camera.position.x,t.pos.y=t.camera.position.y,t.pos.z=t.camera.position.z,t.arrow.position.x=t.pos.x,t.arrow.position.y=t.pos.y,t.arrow.position.z=t.pos.z,t.arrow.rotation.setFromVector3(t.fwd),t.arrow.translateZ(-2)))})),n.videoPlayer.xr().on("xrCameraUpdate",(function(){t.xrActive&&(t.gazeEvent.updateXr(t.pos,t.fwd),e.ias.ListenerForward=t.fwd)})),console.log("gaze setup complete")}},{key:"makeGazeTarget",value:function(e,t,n){var i=new r.a(e,t,n,this.gazeEvent);return this.targets[e]=i,i}},{key:"animate_gaze",value:function(t,n){if(this.xrFrame=n,this.xrSession.requestAnimationFrame(this.animate_gaze),(null!=this.xrRefSpace||(console.log("I am: "+this),this.xrRefSpace=e.hoast360.videoPlayer.xr().xrReferenceSpace,null!=this.xrRefSpace))&&n){this.xrPose=n.getViewerPose(this.xrRefSpace);var r=this.xrPose.transform,a=r.position,o=r.orientation;this.pos.set(a.x,a.y+1.6,a.z);var s=new i.Quaternion(o.x,o.y,o.z,o.w),u=new i.Vector3(0,0,-1);u.applyQuaternion(s),this.fwd.set(u.x,u.y,u.z),null!=this.arrow&&(this.arrow.setRotationFromQuaternion(s),this.arrow.position.set(this.pos.x,this.pos.y,this.pos.z))}}},{key:"destroyGazeTarget",value:function(e){this.targets[e].dispose(),this.targets[e]=null}}])&&s(n.prototype,a),u&&s(n,u),t}()}).call(this,n(27))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var r=n(21);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function t(n,i,a,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=n,null==i&&(i=new r.Vector3(50*(Math.random()-.5),50*(Math.random()-.5),50*(Math.random()-.5))),null==a&&(a=new r.Vector3(5,5,5)),null==o&&(o=new r.Color(15688960));var s=new r.CubeGeometry(a.x,a.y,a.z),u=new r.MeshLambertMaterial({color:o,opacity:0,transparent:!0}),l=new r.Mesh(s,u);this.cube=l,this.cube.name=n,e.gazeSystem.scene.add(this.cube),this.cube.position.set(i.x,i.y,i.z),this.cube.lookAt(0,0,0);var c=this;e.gazeSystem.gazeEvent.on(this.cube,"gazeEnter",(function(){e.ias.triggerOn(c.name)})),e.gazeSystem.gazeEvent.on(this.cube,"gazeTrigger",(function(){e.ias.triggerMashup(c.name)})),e.gazeSystem.gazeEvent.on(this.cube,"gazeLeave",(function(){e.ias.triggerOff(c.name)}))}var n,a,o;return n=t,(a=[{key:"dispose",value:function(){e.gazeSystem.gazeEvent.off(this.cube,"gazeEnter"),e.gazeSystem.gazeEvent.off(this.cube,"gazeTrigger"),e.gazeSystem.gazeEvent.off(this.cube,"gazeLeave"),e.gazeSystem.scene.remove(this.cube),this.cube=null}}])&&i(n.prototype,a),o&&i(n,o),t}()}).call(this,n(27))},function(e,t,n){(function(n){var r,i,a;i=[],void 0===(a="function"==typeof(r=function(){if(n)return e.prototype.on=function(e,t,n){var r=function(){};this.rayList[e.id]||(this.rayList[e.id]={target:e,gazeEnter:r,gazeTrigger:r,gazeLeave:r,gazeWait:r}),this.rayList[e.id][t]=n;var i=this;this.targetList=Object.keys(this.rayList).map((function(e){return i.rayList[e].target}))},e.prototype.off=function(e,t){if(t){var n=function(){};this.rayList[e.id][t]=n}else delete this.rayList[e.id],this.targetList=Object.keys(this.rayList).map((function(e){return this.rayList[e].target}))},e.prototype.removeAll=function(){this.rayList={},this.targetList=[],this._lastTarget=null},e.prototype.update=function(e){if(this.targetList.length){this.raycaster.setFromCamera(this._center,e);var t=this.raycaster.intersectObjects(this.targetList,!0);if(t.length>0){var n=t[0].object;this._lastTarget?this._lastTarget.id!==n.id&&(this.rayList[this._lastTarget.id]&&this.rayList[this._lastTarget.id].gazeLeave(this._lastTarget),this._gazeEnterTime=Date.now(),this.rayList[n.id].gazeEnter(n)):(this._gazeEnterTime=Date.now(),this.rayList[n.id].gazeEnter(n)),this.rayList[n.id].gazeTrigger(n),this._delayListener(n.id),this._lastTarget=n}else this._lastTarget&&this.rayList[this._lastTarget.id]&&this.rayList[this._lastTarget.id].gazeLeave(this._lastTarget),this._lastTarget=null}},e.prototype.updateXr=function(e,t){if(this.targetList.length){this.raycaster.set(e,t);var n=this.raycaster.intersectObjects(this.targetList,!0);if(n.length>0){var r=n[0].object;this._lastTarget?this._lastTarget.id!==r.id&&(this.rayList[this._lastTarget.id]&&this.rayList[this._lastTarget.id].gazeLeave(this._lastTarget),this._gazeEnterTime=Date.now(),this.rayList[r.id].gazeEnter(r)):(this._gazeEnterTime=Date.now(),this.rayList[r.id].gazeEnter(r)),this.rayList[r.id].gazeTrigger(r),this._delayListener(r.id),this._lastTarget=r}else this._lastTarget&&this.rayList[this._lastTarget.id]&&this.rayList[this._lastTarget.id].gazeLeave(this._lastTarget),this._lastTarget=null}},e.prototype._delayListener=function(e){var t=this._gazeEnterTime,n=this.delayTime,r=this.rayList;t&&Date.now()-t>n&&(r[e].gazeWait(),this._gazeEnterTime=null)},e;function e(){this.raycaster=new n.Raycaster,this._center=new n.Vector2,this.rayList={},this.targetList=[],this._lastTarget=null,this.delayTime=1500}console.error("THREE is undefined,make sure you have included three.js library first.")})?r.apply(t,i):r)||(e.exports=a)}).call(this,n(21))},function(e,t,n){"use strict";(function(e){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",(function(){return i}));var i=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,i,a;return n=t,(i=[{key:"Destroy",value:function(t){e.gazeSystem.destroyGazeTarget(t),e.ias.players[t].dispose(),e.ias.players[t]=null;var n=e.timeTracker.eventAssemblies[t];n.dispose(),e.timeTracker.eventAssemblies[t]=null,n=null,delete e.timeTracker.videoEvents[t]}}])&&r(n.prototype,i),a&&r(n,a),t}()}).call(this,n(27))},function(e,t,n){"use strict";var r=n(6),i=n(66),a=n(57);const o=e=>"port"in e;var s=n(84),u=n(53);const l=(e,t)=>{if(!Object(u.a)(e).delete(t))throw new Error("Missing the expected event listener.")};var c=n(85),d=n(28),h=n(68),f=n(23),p=n(69),m=n(30),g=n(45),v=n(58),y=n(50);const _=e=>!r.a.has(e),b=(e,t)=>{const n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[r]=n;return e.delete(r),r};var E=n(47),T=n(56);const S=(e,t)=>{!o(e)&&t.every(e=>0===e.size)&&Object(T.a)(e)},w=e=>new Promise(t=>{const n=e.createScriptProcessor(256,1,1),r=e.createGain(),i=e.createBuffer(1,2,44100),a=i.getChannelData(0);a[0]=1,a[1]=1;const o=e.createBufferSource();o.buffer=i,o.loop=!0,o.connect(n).connect(e.destination),o.connect(r),o.disconnect(r),n.onaudioprocess=r=>{const i=r.inputBuffer.getChannelData(0);Array.prototype.some.call(i,e=>1===e)?t(!0):t(!1),o.stop(),n.onaudioprocess=null,o.disconnect(n),n.disconnect(e.destination)},o.start()}),A=(e,t)=>{const n=new Map;for(const t of e)for(const e of t){const t=n.get(e);n.set(e,void 0===t?1:t+1)}n.forEach((e,n)=>t(n,e))};var x=n(67);n.d(t,"a",(function(){return B}));const M=(e,t,[n,r,i],a)=>{Object(g.a)(e[r],[t,n,i],e=>e[0]===t&&e[1]===n,a)},C=(e,t,[n,r],i)=>{Object(g.a)(e,[t,n,r],e=>e[0]===t&&e[1]===n,i)},R=(e,t,[n,r,i],a)=>{const o=e.get(n);void 0===o?e.set(n,new Set([[r,t,i]])):Object(g.a)(o,[r,t,i],e=>e[0]===r&&e[1]===t,a)},I=(e,[t,n,r],i)=>{const a=e.get(t);void 0===a?e.set(t,new Set([[n,r]])):Object(g.a)(a,[n,r],e=>e[0]===n,i)},O=(e,t,n,r)=>{const i=Object(m.a)(e,t),a=b(i,e=>e[0]===n&&e[1]===r);return 0===i.size&&e.delete(t),a},D=(e,t,n)=>{const r=Object(m.a)(e,t),i=b(r,e=>e[0]===n);return 0===r.size&&e.delete(t),i},P=(e,t,n,r)=>{const{activeInputs:i,passiveInputs:a}=Object(d.a)(t),{outputs:o}=Object(d.a)(e),l=Object(u.a)(e),h=o=>{const u=Object(f.a)(t),l=Object(f.a)(e);if(o){const o=O(a,e,n,r);M(i,e,o,!1),Object(y.a)(e)||Object(s.a)(l,u,n,r),_(t)&&Object(E.a)(t)}else{const o=((e,t,n,r)=>b(e[r],e=>e[0]===t&&e[1]===n))(i,e,n,r);R(a,r,o,!1),Object(y.a)(e)||Object(c.a)(l,u,n,r),Object(v.a)(t)&&S(t,i)}};return!!Object(g.a)(o,[t,n,r],e=>e[0]===t&&e[1]===n&&e[2]===r,!0)&&(l.add(h),Object(v.a)(e)?M(i,e,[n,r,h],!0):R(a,r,[e,n,h],!0),!0)},L=(e,t,n)=>{const{activeInputs:r,passiveInputs:i}=Object(h.a)(t),{outputs:a}=Object(d.a)(e),o=Object(u.a)(e),s=a=>{const o=Object(f.a)(e),s=Object(p.a)(t);if(a){const t=D(i,e,n);C(r,e,t,!1),Object(y.a)(e)||o.connect(s,n)}else{const t=((e,t,n)=>b(e,e=>e[0]===t&&e[1]===n))(r,e,n);I(i,t,!1),Object(y.a)(e)||o.disconnect(s,n)}};return!!Object(g.a)(a,[t,n],e=>e[0]===t&&e[1]===n,!0)&&(o.add(s),Object(v.a)(e)?C(r,e,[n,s],!0):I(i,[e,n,s],!0),!0)},N=(e,t,n)=>{for(const r of e)if(r[0]===t&&r[1]===n)return e.delete(r),r;return null},k=(e,t,n,r)=>{const[i,a]=((e,t,n,r)=>{const{activeInputs:i,passiveInputs:a}=Object(d.a)(t),o=N(i[r],e,n);if(null===o)return[O(a,e,n,r)[2],!1];return[o[2],!0]})(e,t,n,r);if(null!==i&&(l(e,i),a&&!Object(y.a)(e)&&Object(c.a)(Object(f.a)(e),Object(f.a)(t),n,r)),Object(v.a)(t)){const{activeInputs:e}=Object(d.a)(t);S(t,e)}},F=(e,t,n)=>{const[r,i]=((e,t,n)=>{const{activeInputs:r,passiveInputs:i}=Object(h.a)(t),a=N(r,e,n);if(null===a)return[D(i,e,n)[1],!1];return[a[2],!0]})(e,t,n);null!==r&&(l(e,r),i&&!Object(y.a)(e)&&Object(f.a)(e).disconnect(Object(p.a)(t),n))},B=(e,t,n,u,l,c,m,v,y,b,T,S,R,I,O)=>class extends b{constructor(t,i,a,o){super(a),this._context=t,this._nativeAudioNode=a;const s=T(t);S(s)&&!0!==n(w,()=>w(s))&&(e=>{const t=new Map;var n,r;e.connect=(n=e.connect.bind(e),(e,r=0,i=0)=>{const a=Object(x.a)(e)?n(e,r,i):n(e,r),o=t.get(e);return void 0===o?t.set(e,[{input:i,output:r}]):o.every(e=>e.input!==i||e.output!==r)&&o.push({input:i,output:r}),a}),e.disconnect=(r=e.disconnect,(n,i,a)=>{if(r.apply(e),void 0===n)t.clear();else if("number"==typeof n)for(const[e,r]of t){const i=r.filter(e=>e.output!==n);0===i.length?t.delete(e):t.set(e,i)}else if(t.has(n))if(void 0===i)t.delete(n);else{const e=t.get(n);if(void 0!==e){const r=e.filter(e=>e.output!==i&&(e.input!==a||void 0===a));0===r.length?t.delete(n):t.set(n,r)}}for(const[n,r]of t)r.forEach(t=>{Object(x.a)(n)?e.connect(n,t.output,t.input):e.connect(n,t.output)})})})(a),r.c.set(this,a),r.i.set(this,new Set),i&&Object(E.a)(this),e(this,o,a)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(e){this._nativeAudioNode.channelCount=e}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(e){this._nativeAudioNode.channelCountMode=e}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(e){this._nativeAudioNode.channelInterpretation=e}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(e,n=0,r=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw l();const a=T(this._context),v=O(a);if(R(e)||I(e))throw c();if(Object(i.a)(e)){const i=Object(f.a)(e);try{const u=Object(s.a)(this._nativeAudioNode,i,n,r);if(v||_(this)?this._nativeAudioNode.disconnect(...u):_(e)&&Object(E.a)(e),o(e)){const e=t.get(i);if(void 0===e){const e=a.createGain();e.connect(u[0],0,u[2]),t.set(i,new Map([[r,e]]))}else if(void 0===e.get(r)){const t=a.createGain();t.connect(u[0],0,u[2]),e.set(r,t)}}}catch(e){if(12===e.code)throw c();throw e}if(v?((e,t,n,r)=>{const{outputs:i}=Object(d.a)(e);if(Object(g.a)(i,[t,n,r],e=>e[0]===t&&e[1]===n&&e[2]===r,!0)){const{activeInputs:i}=Object(d.a)(t);return M(i,e,[n,r,null],!0),!0}return!1})(this,e,n,r):P(this,e,n,r)){const t=y([this],e);A(t,u(v))}return e}const b=Object(p.a)(e);if("playbackRate"===b.name)throw m();try{this._nativeAudioNode.connect(b,n),(v||_(this))&&this._nativeAudioNode.disconnect(b,n)}catch(e){if(12===e.code)throw c();throw e}if(v?((e,t,n)=>{const{outputs:r}=Object(d.a)(e);if(Object(g.a)(r,[t,n],e=>e[0]===t&&e[1]===n,!0)){const{activeInputs:r}=Object(h.a)(t);return C(r,e,[n,null],!0),!0}return!1})(this,e,n):L(this,e,n)){const t=y([this],e);A(t,u(v))}}disconnect(e,t,n){let r;if(void 0===e)r=(e=>{const t=Object(d.a)(e),n=[];for(const r of t.outputs)Object(a.a)(r)?k(e,...r):F(e,...r),n.push(r[0]);return t.outputs.clear(),n})(this);else if("number"==typeof e){if(e<0||e>=this.numberOfOutputs)throw l();r=((e,t)=>{const n=Object(d.a)(e),r=[];for(const i of n.outputs)i[1]===t&&(Object(a.a)(i)?k(e,...i):F(e,...i),r.push(i[0]),n.outputs.delete(i));return r})(this,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs))throw l();if(Object(i.a)(e)&&void 0!==n&&(n<0||n>=e.numberOfInputs))throw l();if(r=((e,t,n,r)=>{const i=Object(d.a)(e);return Array.from(i.outputs).filter(e=>!(e[0]!==t||void 0!==n&&e[1]!==n||void 0!==r&&e[2]!==r)).map(t=>(Object(a.a)(t)?k(e,...t):F(e,...t),i.outputs.delete(t),t[0]))})(this,e,t,n),0===r.length)throw c()}for(const e of r){const t=y([this],e);A(t,v)}}}},function(e,t,n){"use strict";var r=n(15),i=n(126),a=n(86),o=n(124),s=n(6);const u=async(e,t)=>new e(await(e=>new Promise((t,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:e})=>{r.close(),i.close(),t(e)},r.onmessageerror=({data:e})=>{r.close(),i.close(),n(e)},i.postMessage(e)}))(t));var l=n(87),c=n(123);n.d(t,"a",(function(){return d}));const d=(e,t,n,d,h,f,p,m,g,v,y,_,b)=>(E,T,S,w)=>{if(0===w.numberOfInputs&&0===w.numberOfOutputs)throw v();if(void 0!==w.outputChannelCount){if(w.outputChannelCount.some(e=>e<1))throw v();if(w.outputChannelCount.length!==w.numberOfOutputs)throw n()}if("explicit"!==w.channelCountMode)throw v();const A=w.channelCount*w.numberOfInputs,x=w.outputChannelCount.reduce((e,t)=>e+t,0),M=void 0===S.parameterDescriptors?0:S.parameterDescriptors.length;if(A+M>6||x>6)throw v();const C=new MessageChannel,R=[],I=[];for(let e=0;e<w.numberOfInputs;e+=1)R.push(m(E,{channelCount:w.channelCount,channelCountMode:w.channelCountMode,channelInterpretation:w.channelInterpretation,gain:1})),I.push(f(E,{channelCount:w.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:w.channelCount}));const O=[];if(void 0!==S.parameterDescriptors)for(const{defaultValue:e,maxValue:t,minValue:n,name:i}of S.parameterDescriptors){const a=p(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==w.parameterData[i]?w.parameterData[i]:void 0===e?0:e});Object.defineProperties(a.offset,{defaultValue:{get:()=>void 0===e?0:e},maxValue:{get:()=>void 0===t?r.b:t},minValue:{get:()=>void 0===n?r.a:n}}),O.push(a)}const D=h(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,A+M)}),P=Object(i.a)(T,E.sampleRate),L=g(E,P,A+M,Math.max(1,x)),N=f(E,{channelCount:Math.max(1,x),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,x)}),k=[];for(let e=0;e<w.numberOfOutputs;e+=1)k.push(h(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:w.outputChannelCount[e]}));for(let e=0;e<w.numberOfInputs;e+=1){R[e].connect(I[e]);for(let t=0;t<w.channelCount;t+=1)I[e].connect(D,t,e*w.channelCount+t)}const F=new c.a(void 0===S.parameterDescriptors?[]:S.parameterDescriptors.map(({name:e},t)=>{const n=O[t];return n.connect(D,0,A+t),n.start(0),[e,n.offset]}));D.connect(L);let B=w.channelInterpretation,U=null;const j=0===w.numberOfOutputs?[L]:k,G={get bufferSize(){return P},get channelCount(){return w.channelCount},set channelCount(e){throw d()},get channelCountMode(){return w.channelCountMode},set channelCountMode(e){throw d()},get channelInterpretation(){return B},set channelInterpretation(e){for(const t of R)t.channelInterpretation=e;B=e},get context(){return L.context},get inputs(){return R},get numberOfInputs(){return w.numberOfInputs},get numberOfOutputs(){return w.numberOfOutputs},get onprocessorerror(){return U},set onprocessorerror(e){"function"==typeof U&&G.removeEventListener("processorerror",U),U="function"==typeof e?e:null,"function"==typeof U&&G.addEventListener("processorerror",U)},get parameters(){return F},get port(){return C.port2},addEventListener:(...e)=>L.addEventListener(e[0],e[1],e[2]),connect:t.bind(null,j),disconnect:y.bind(null,j),dispatchEvent:(...e)=>L.dispatchEvent(e[0]),removeEventListener:(...e)=>L.removeEventListener(e[0],e[1],e[2])},H=new Map;var V,z;C.port1.addEventListener=(V=C.port1.addEventListener,(...e)=>{if("message"===e[0]){const t="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==t){const n=H.get(e[1]);void 0!==n?e[1]=n:(e[1]=e=>{_(E.currentTime,E.sampleRate,()=>t(e))},H.set(t,e[1]))}}return V.call(C.port1,e[0],e[1],e[2])}),C.port1.removeEventListener=(z=C.port1.removeEventListener,(...e)=>{if("message"===e[0]){const t=H.get(e[1]);void 0!==t&&(H.delete(e[1]),e[1]=t)}return z.call(C.port1,e[0],e[1],e[2])});let W=null;Object.defineProperty(C.port1,"onmessage",{get:()=>W,set:e=>{"function"==typeof W&&C.port1.removeEventListener("message",W),W="function"==typeof e?e:null,"function"==typeof W&&(C.port1.addEventListener("message",W),C.port1.start())}}),S.prototype.port=C.port1;let q=null;((e,t,n,r)=>{let i=s.k.get(e);void 0===i&&(i=new WeakMap,s.k.set(e,i));const a=u(n,r);return i.set(t,a),a})(E,G,S,w).then(e=>q=e);const Y=Object(l.a)(w.numberOfInputs,w.channelCount),K=Object(l.a)(w.numberOfOutputs,w.outputChannelCount),X=void 0===S.parameterDescriptors?[]:S.parameterDescriptors.reduce((e,{name:t})=>({...e,[t]:new Float32Array(128)}),{});let Q=!0;const Z=()=>{w.numberOfOutputs>0&&L.disconnect(N);for(let e=0,t=0;e<w.numberOfOutputs;e+=1){const n=k[e];for(let r=0;r<w.outputChannelCount[e];r+=1)N.disconnect(n,t+r,r);t+=w.outputChannelCount[e]}};L.onaudioprocess=({inputBuffer:t,outputBuffer:n})=>{if(null!==q)for(let r=0;r<P;r+=128){for(let e=0;e<w.numberOfInputs;e+=1)for(let n=0;n<w.channelCount;n+=1)Object(a.a)(t,Y[e],n,n,r);void 0!==S.parameterDescriptors&&S.parameterDescriptors.forEach(({name:e},n)=>{Object(a.a)(t,X,e,A+n,r)});for(let e=0;e<w.numberOfInputs;e+=1)for(let t=0;t<w.outputChannelCount[e];t+=1)0===K[e][t].byteLength&&(K[e][t]=new Float32Array(128));try{const t=Y.map((t,n)=>{const r=e.get(G);return void 0===r||void 0===r.get(n)?[]:t}),i=_(E.currentTime+r/E.sampleRate,E.sampleRate,()=>q.process(t,K,X));Q=i;for(let e=0,t=0;e<w.numberOfOutputs;e+=1){for(let i=0;i<w.outputChannelCount[e];i+=1)Object(o.a)(n,K[e],i,t+i,r);t+=w.outputChannelCount[e]}}catch(e){Q=!1,G.dispatchEvent(new ErrorEvent("processorerror",{error:e}))}if(!Q){for(let e=0;e<w.numberOfInputs;e+=1){R[e].disconnect(I[e]);for(let t=0;t<w.channelCount;t+=1)I[r].disconnect(D,t,e*w.channelCount+t)}if(void 0!==S.parameterDescriptors){const e=S.parameterDescriptors.length;for(let t=0;t<e;t+=1){const e=O[t];e.disconnect(D,0,A+t),e.stop()}}D.disconnect(L),L.onaudioprocess=null,J?Z():te();break}}};let J=!1;const $=m(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),ee=()=>L.connect($).connect($.context.destination),te=()=>{L.disconnect($),$.disconnect()};return ee(),b(G,()=>{if(Q){te(),w.numberOfOutputs>0&&L.connect(N);for(let e=0,t=0;e<w.numberOfOutputs;e+=1){const n=k[e];for(let r=0;r<w.outputChannelCount[e];r+=1)N.connect(n,t+r,r);t+=w.outputChannelCount[e]}}J=!0},()=>{Q&&(ee(),Z()),J=!1})}},function(e,t,n){"use strict";var r=n(6);const i={construct:()=>i},a=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,o=(e,t)=>{const n=[];let r=e.replace(/^[\s]+/,""),i=r.match(a);for(;null!==i;){const e=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(e,new URL(e,t).toString());n.push(o),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(a)}return[n.join(";"),r]};n.d(t,"a",(function(){return l}));const s=e=>{if(void 0!==e&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},u=e=>{if(!(e=>{try{new new Proxy(e,i)}catch{return!1}return!0})(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!=typeof e.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},l=(e,t,n,i,a,l,c,d,h)=>(f,p,m={credentials:"omit"})=>{const g=l(f),v=new URL(p,h.location.href).toString();if(void 0!==g.audioWorklet)return i(p).then(e=>{const[t,n]=o(e,v),r=new Blob([`${t};(registerProcessor=>{${n}\n})((n,p)=>registerProcessor(n,class extends p{process(i,o,p){return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`],{type:"application/javascript; charset=utf-8"}),i=URL.createObjectURL(r),s=a(g);return(null!==s?s:g).audioWorklet.addModule(i,m).then(()=>URL.revokeObjectURL(i)).catch(e=>{throw URL.revokeObjectURL(i),void 0!==e.code&&"SyntaxError"!==e.name||(e.code=12),e})});const y=d.get(f);if(void 0!==y&&y.has(p))return Promise.resolve();const _=c.get(f);if(void 0!==_){const e=_.get(p);if(void 0!==e)return e}const b=i(p).then(e=>{const[n,r]=o(e,v);return t(`${n};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${r}\n})})(window,'_AWGS')`)}).then(()=>{const t=h._AWGS.pop();if(void 0===t)throw new SyntaxError;n(g.currentTime,g.sampleRate,()=>t(class{},void 0,(t,n)=>{if(""===t.trim())throw e();const i=r.j.get(g);if(void 0!==i){if(i.has(t))throw e();u(n),s(n.parameterDescriptors),i.set(t,n)}else u(n),s(n.parameterDescriptors),r.j.set(g,new Map([[t,n]]))},g.sampleRate,void 0,void 0))}).catch(e=>{throw void 0!==e.code&&"SyntaxError"!==e.name||(e.code=12),e});return void 0===_?c.set(f,new Map([[p,b]])):_.set(p,b),b.then(()=>{const e=d.get(f);void 0===e?d.set(f,new Set([p])):e.add(p)}).catch(()=>{}).then(()=>{const e=c.get(f);void 0!==e&&e.delete(p)}),b}},function(e,t,n){"use strict";var r=n(20),i=n(10);const a=e=>"function"==typeof e.getFloatTimeDomainData;n.d(t,"a",(function(){return o}));const o=(e,t,n)=>(o,s)=>{const u=n(o,e=>e.createAnalyser());if(Object(i.a)(u,s),!(s.maxDecibels>s.minDecibels))throw t();return Object(r.a)(u,s,"fftSize"),Object(r.a)(u,s,"maxDecibels"),Object(r.a)(u,s,"minDecibels"),Object(r.a)(u,s,"smoothingTimeConstant"),e(a,()=>a(u))||(e=>{e.getFloatTimeDomainData=t=>{const n=new Uint8Array(t.length);e.getByteTimeDomainData(n);const r=Math.max(n.length,e.fftSize);for(let e=0;e<r;e+=1)t[e]=.0078125*(n[e]-128);return t}})(u),u}},function(e,t,n){"use strict";var r=n(22),i=n(20),a=n(10),o=n(24);var s=n(80),u=n(81);n.d(t,"a",(function(){return l}));const l=(e,t,n,l,c,d,h,f,p,m,g,v,y)=>(_,b)=>{const E=n(_,e=>e.createBufferSource());return Object(a.a)(E,b),Object(r.a)(E,b,"playbackRate"),Object(i.a)(E,b,"buffer"),Object(i.a)(E,b,"loop"),Object(i.a)(E,b,"loopEnd"),Object(i.a)(E,b,"loopStart"),t(l,()=>l(_))||(e=>{e.start=(t=>{let n=!1;return(r=0,i=0,a)=>{if(n)throw Object(o.a)();t.call(e,r,i,a),n=!0}})(e.start)})(E),t(c,c)||((e,t)=>{let n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;var i,a;e.start=(i=e.start,a=e.stop,(o=0,s=0,u=Number.POSITIVE_INFINITY)=>{if(i.call(e,o,s),u>=0&&u<Number.POSITIVE_INFINITY){const i=Math.max(o,t.currentTime),s=u/e.playbackRate.value;n=i+s,a.call(e,Math.min(n,r))}}),e.stop=(i=>(a=0)=>{r=Math.max(a,t.currentTime),i.call(e,Math.min(n,r))})(e.stop)})(E,_),t(d,()=>d(_))||g(E),t(h,()=>h(_))||v(E,_),t(f,()=>f(_))||Object(s.a)(E),t(p,()=>p(_))||y(E,_),t(m,()=>m(_))||Object(u.a)(E),e(_,E),E}},function(e,t,n){"use strict";var r=n(86),i=n(124),a=n(87),o=n(28),s=n(6),u=n(23),l=n(30);var c=n(19);n.d(t,"a",(function(){return h}));const d=async(e,t,n,c,d,h)=>{const f=null===t?128*Math.ceil(e.context.length/128):t.length,p=c.channelCount*c.numberOfInputs,m=c.outputChannelCount.reduce((e,t)=>e+t,0),g=0===m?null:n.createBuffer(m,f,n.sampleRate);if(void 0===d)throw new Error("Missing the processor constructor.");const v=Object(o.a)(e),y=await((e,t)=>{const n=Object(l.a)(s.k,e),r=Object(u.a)(t);return Object(l.a)(n,r)})(n,e),_=Object(a.a)(c.numberOfInputs,c.channelCount),b=Object(a.a)(c.numberOfOutputs,c.outputChannelCount),E=Array.from(e.parameters.keys()).reduce((e,t)=>({...e,[t]:new Float32Array(128)}),{});for(let a=0;a<f;a+=128){if(c.numberOfInputs>0&&null!==t)for(let e=0;e<c.numberOfInputs;e+=1)for(let n=0;n<c.channelCount;n+=1)Object(r.a)(t,_[e],n,n,a);void 0!==d.parameterDescriptors&&null!==t&&d.parameterDescriptors.forEach(({name:e},n)=>{Object(r.a)(t,E,e,p+n,a)});for(let e=0;e<c.numberOfInputs;e+=1)for(let t=0;t<c.outputChannelCount[e];t+=1)0===b[e][t].byteLength&&(b[e][t]=new Float32Array(128));try{const e=_.map((e,t)=>0===v.activeInputs[t].size?[]:e),t=h(a/n.sampleRate,n.sampleRate,()=>y.process(e,b,E));if(null!==g)for(let e=0,t=0;e<c.numberOfOutputs;e+=1){for(let n=0;n<c.outputChannelCount[e];n+=1)Object(i.a)(g,b[e],n,t+n,a);t+=c.outputChannelCount[e]}if(!t)break}catch(t){e.dispatchEvent(new ErrorEvent("processorerror",{error:t}));break}}return g},h=(e,t,n,r,i,a,o,s,u,l,h,f,p,m,g,v)=>(y,_,b)=>{const E=new WeakMap;let T=null;return{render(S,w,A){s(w,S);const x=E.get(w);return void 0!==x?Promise.resolve(x):(async(s,S,w)=>{let A=h(s),x=null;const M=Object(c.a)(A,S);if(null===f){const e=_.outputChannelCount.reduce((e,t)=>e+t,0),n=i(S,{channelCount:Math.max(1,e),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,e)}),a=[];for(let e=0;e<s.numberOfOutputs;e+=1)a.push(r(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:_.outputChannelCount[e]}));const l=o(S,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1});l.connect=t.bind(null,a),l.disconnect=u.bind(null,a),x=[n,a,l]}else M||(A=new f(S,y));if(E.set(S,null===x?A:x[2]),null!==x){if(null===T){if(void 0===b)throw new Error("Missing the processor constructor.");if(null===p)throw new Error("Missing the native OfflineAudioContext constructor.");const e=s.channelCount*s.numberOfInputs,t=void 0===b.parameterDescriptors?0:b.parameterDescriptors.length,n=e+t,u=async()=>{const u=new p(n,128*Math.ceil(s.context.length/128),S.sampleRate),l=[],c=[];for(let e=0;e<_.numberOfInputs;e+=1)l.push(o(u,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),c.push(i(u,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const d=await Promise.all(Array.from(s.parameters.values()).map(async e=>{const t=a(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:e.value});return await m(u,e,t.offset,w),t})),h=r(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,e+t)});for(let e=0;e<_.numberOfInputs;e+=1){l[e].connect(c[e]);for(let t=0;t<_.channelCount;t+=1)c[e].connect(h,t,e*_.channelCount+t)}for(const[t,n]of d.entries())n.connect(h,0,e+t),n.start(0);return h.connect(u.destination),await Promise.all(l.map(e=>g(s,u,e,w))),v(u)};T=d(s,0===n?null:await u(),S,_,b,l)}const e=await T,t=n(S,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[u,c,h]=x;null!==e&&(t.buffer=e,t.start(0)),t.connect(u);for(let e=0,t=0;e<s.numberOfOutputs;e+=1){const n=c[e];for(let r=0;r<_.outputChannelCount[e];r+=1)u.connect(n,t+r,r);t+=_.outputChannelCount[e]}return h}if(M)for(const[t,n]of s.parameters.entries())await e(S,n,A.parameters.get(t),w);else for(const[e,t]of s.parameters.entries())await m(S,t,A.parameters.get(e),w);return await g(s,S,A,w),A})(S,w,A)}}}},function(e,t,n){"use strict";var r=n(79);n.d(t,"a",(function(){return i}));const i=(e,t,n,i,a,o,s,u,l,c,d,h,f)=>(p,m)=>{const g=s(p)?p:o(p);if(a.has(m)){const e=n();return Promise.reject(e)}try{a.add(m)}catch{}if(t(d,()=>d(g))){return("closed"===g.state&&null!==l&&u(g)?new l(1,1,g.sampleRate):g).decodeAudioData(m).catch(e=>{if(e instanceof DOMException&&"NotSupportedError"===e.name)throw new TypeError;throw e}).then(n=>(t(c,()=>c(n))||f(n),e.add(n),n))}return new Promise((t,n)=>{const a=()=>{try{(e=>{const{port1:t}=new MessageChannel;t.postMessage(e,[e])})(m)}catch{}},o=e=>{n(e),a()};try{g.decodeAudioData(m,n=>{"function"!=typeof n.copyFromChannel&&(h(n),Object(r.a)(n)),e.add(n),a(),t(n)},e=>{o(null===e?i():e)})}catch(e){o(e)}})}},function(e,t,n){"use strict";var r=n(66);n.d(t,"a",(function(){return i}));const i=(e,t,n)=>function i(a,o){const s=Object(r.a)(o)?o:n(e,o);if((e=>"delayTime"in e)(s))return[];if(a[0]===s)return[a];if(a.includes(s))return[];const{outputs:u}=t(s);return Array.from(u).map(e=>i([...a,s],e[0])).reduce((e,t)=>e.concat(t),[])}},function(e,t,n){"use strict";var r=n(88);n.d(t,"a",(function(){return a}));const i={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},a=(e,t,n,a,o)=>class extends e{constructor(e,s){const u=a(e),l=o(u),c={...i,...s},d=t(u,l?null:e.baseLatency,c);super(e,!1,d,l?n(c.feedback,c.feedforward):null),(e=>{var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,(n,i,a)=>{if(n.length!==i.length||i.length!==a.length)throw Object(r.a)();return t.call(e,n,i,a)})})(d),this._nativeIIRFilterNode=d}getFrequencyResponse(e,t,n){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,n)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n,r,i,a)=>(o,s,u,l,c,d)=>{if(null!==u)try{const n=t(o,e=>new u(e,l,d)),i=new Map;let s=null;if(Object.defineProperties(n,{channelCount:{get:()=>d.channelCount,set:()=>{throw e()}},channelCountMode:{get:()=>"explicit",set:()=>{throw e()}},onprocessorerror:{get:()=>s,set:e=>{"function"==typeof s&&n.removeEventListener("processorerror",s),s="function"==typeof e?e:null,"function"==typeof s&&n.addEventListener("processorerror",s)}}}),n.addEventListener=(f=n.addEventListener,(...e)=>{if("processorerror"===e[0]){const t="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==t){const n=i.get(e[1]);void 0!==n?e[1]=n:(e[1]=n=>{t(new ErrorEvent(e[0],{...n,error:new Error}))},i.set(t,e[1]))}}return f.call(n,e[0],e[1],e[2])}),n.removeEventListener=(h=n.removeEventListener,(...e)=>{if("processorerror"===e[0]){const t=i.get(e[1]);void 0!==t&&(i.delete(e[1]),e[1]=t)}return h.call(n,e[0],e[1],e[2])}),0!==d.numberOfOutputs){const e=r(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(e).connect(e.context.destination);return a(n,()=>e.disconnect(),()=>e.connect(e.context.destination))}return n}catch(e){if(11===e.code)throw i();throw e}var h,f;if(void 0===c)throw i();return(e=>{const{port1:t}=new MessageChannel;try{t.postMessage(e)}finally{t.close()}})(d),n(o,s,c,d)}},function(e,t,n){"use strict";var r=n(10),i=n(24);n.d(t,"a",(function(){return a}));const a=e=>(t,n)=>{const a=e(t,e=>e.createChannelSplitter(n.numberOfOutputs));return Object(r.a)(a,n),(e=>{const t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw Object(i.a)()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:e=>{if("explicit"!==e)throw Object(i.a)()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:e=>{if("discrete"!==e)throw Object(i.a)()}})})(a),a}},function(e,t,n){"use strict";n.r(t),function(e){var t=n(168),r=n(706),i=n(856),a=n(859),o=n(862);n(875),n(876),n(168),e.hoast360=new t.HOAST360,e.gazeSystem=new a.a,e.ias=new r.a,e.timeTracker=new i.a(hoast360.videoPlayer),e.binMan=new o.a,document.addEventListener("DOMContentLoaded",(function(){hoast360.initialize("./media/sundowning/","./media/irs/",4),hoast360.videoPlayer.on("initComplete",(function(){gazeSystem.setup(),ias.setup(),timeTracker.setup()}))}))}.call(this,n(27))},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Debug=t.FactoryMaker=t.MediaPlayer=void 0;var r=s(n(173)),i=s(n(2)),a=s(n(17)),o=n(147);function s(e){return e&&e.__esModule?e:{default:e}}var u="undefined"!=typeof window&&window||e,l=u.dashjs;l||(l=u.dashjs={}),l.MediaPlayer=r.default,l.FactoryMaker=i.default,l.Debug=a.default,l.Version=(0,o.getVersionString)(),t.default=l,t.MediaPlayer=r.default,t.FactoryMaker=i.default,t.Debug=a.default}).call(this,n(27))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(9)),i=l(n(36)),a=l(n(16)),o=l(n(18)),s=l(n(2)),u=l(n(17));function l(e){return e&&e.__esModule?e:{default:e}}function c(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,s=void 0,l=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0;function I(e){if(!p||!isNaN(m)){var n=m;if(isNaN(n))if(_){n=e.liveStartTime;var r=c.getCurrentDVRInfo(),i=r?r.range:null;if(i){var a=W(y.start,!0);isNaN(a)||(s.info("Start time from URI parameters: "+a),n=Math.max(Math.min(n,a),i.start))}}else{n=y.start;var u=W(y.start,!1);!isNaN(u)&&u<n+y.duration&&(s.info("Start time from URI parameters: "+u),n=Math.max(n,u))}isNaN(n)||n===h.getTime()||(t.trigger(o.default.PLAYBACK_SEEKING,{seekTime:n}),F(n,!1,!0))}}function O(){return parseFloat((D()-B()).toFixed(5))}function D(){return y.start+y.duration}function P(){y&&h&&h.getElement()?h.play():E=!0}function L(){return y&&h?h.isPaused():null}function N(){y&&h&&h.pause()}function k(){return y&&h?h.isSeeking():null}function F(e,n,r){y&&h&&(e!==(isNaN(w)?h.getTime():w)&&(!0===r?(h.removeEventListener("seeking",te),s.info("Requesting internal seek to time: "+e),h.setCurrentTime(e,n)):(w=e,t.trigger(o.default.PLAYBACK_SEEK_ASKED),s.info("Requesting seek to time: "+e),h.setCurrentTime(e,n))))}function B(){return y&&h?h.getTime():null}function U(){var e=B();if(_&&!isNaN(S)){var t=S/1e3;e>t&&(e-=t)}return e}function j(){return y&&h?h.getPlaybackRate():null}function G(){return y&&h?h.getEnded():null}function H(){return _}function V(){if(!_||isNaN(S))return NaN;var e=U();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*f.getClientTimeOffset();return Math.max(((t-S-1e3*e)/1e3).toFixed(3),0)}function z(){E=!1,p=!1,m=NaN,v=0,S=0,w=NaN,h&&(t.off(o.default.STREAM_INITIALIZED,I,this),t.off(o.default.DATA_UPDATE_COMPLETED,X,this),t.off(o.default.BUFFER_LEVEL_STATE_CHANGED,fe,this),t.off(o.default.LOADING_PROGRESS,he,this),t.off(o.default.PLAYBACK_PROGRESS,ce,this),t.off(o.default.PLAYBACK_TIME_UPDATED,ce,this),t.off(o.default.PLAYBACK_ENDED,ue,this),t.off(o.default.STREAM_INITIALIZING,me,this),Y(),h.removeEventListener("canplay",Q),h.removeEventListener("play",Z),h.removeEventListener("waiting",J),h.removeEventListener("playing",$),h.removeEventListener("pause",ee),h.removeEventListener("error",le),h.removeEventListener("seeking",te),h.removeEventListener("seeked",ne),h.removeEventListener("timeupdate",re),h.removeEventListener("progress",ie),h.removeEventListener("ratechange",ae),h.removeEventListener("loadedmetadata",oe),h.removeEventListener("stalled",pe),h.removeEventListener("ended",se)),g=null,h=null,y=null,_=null}function W(e,t){var n=C.getURIFragmentData();if(!n||!n.t)return NaN;return n.t=n.t.split(",")[0],t&&-1!==n.t.indexOf("posix:")?parseInt(n.t.substring(6)):e+parseInt(n.t)}function q(){if(null===g){g=setInterval((function(){var e;t.trigger(o.default.WALLCLOCK_TIME_UPDATED,{isDynamic:_,time:new Date}),H()&&L()&&(e=Date.now(),(!T||e>T+500)&&(T=e,re()))}),R.get().streaming.wallclockTimeUpdateInterval)}}function Y(){clearInterval(g),g=null}function K(){if(!L()&&_&&0!==h.getReadyState()){var e=U(),t=function(e){var t=c.getCurrentDVRInfo(),n=t?t.range:null;return n?e>n.end?Math.max(n.end-2*y.manifestInfo.minBufferTime,n.start):e>0&&e+.25<n.start&&Math.abs(e-n.start)<31536e4?n.start:e:NaN}(e);!isNaN(t)&&t!==e&&F(t)}}function X(e){if(!e.error){var t=d.convertDataToRepresentationInfo(e.currentRepresentation),n=t?t.mediaInfo.streamInfo:null;null!==n&&y.id===n.id&&(y=n,K())}}function Q(){t.trigger(o.default.CAN_PLAY)}function Z(){s.info("Native video element event: play"),K(),q(),t.trigger(o.default.PLAYBACK_STARTED,{startTime:B()})}function J(){s.info("Native video element event: waiting"),t.trigger(o.default.PLAYBACK_WAITING,{playingTime:B()})}function $(){s.info("Native video element event: playing"),t.trigger(o.default.PLAYBACK_PLAYING,{playingTime:B()})}function ee(){s.info("Native video element event: pause"),t.trigger(o.default.PLAYBACK_PAUSED,{ended:G()})}function te(){var e=B();isNaN(w)||w===e||(e=w),w=NaN,s.info("Seeking to: "+e),q(),t.trigger(o.default.PLAYBACK_SEEKING,{seekTime:e})}function ne(){s.info("Native video element event: seeked"),t.trigger(o.default.PLAYBACK_SEEKED),h.addEventListener("seeking",te)}function re(){y&&t.trigger(o.default.PLAYBACK_TIME_UPDATED,{timeToEnd:O(),time:B()})}function ie(){t.trigger(o.default.PLAYBACK_PROGRESS)}function ae(){var e=j();s.info("Native video element event: ratechange: ",e),t.trigger(o.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function oe(){s.info("Native video element event: loadedmetadata"),t.trigger(o.default.PLAYBACK_METADATA_LOADED),q()}function se(){s.info("Native video element event: ended"),N(),Y(),t.trigger(o.default.PLAYBACK_ENDED,{isLast:l.getActiveStreamInfo().isLast})}function ue(e){g&&e.isLast&&(s.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended"),h.setCurrentTime(D()),N(),Y())}function le(e){var n=e.target||e.srcElement;t.trigger(o.default.PLAYBACK_ERROR,{error:n.error})}function ce(){var e,t,n;_&&R.get().streaming.lowLatencyEnabled&&R.get().streaming.liveCatchUpPlaybackRate>0&&!L()&&!k()&&(e=V(),t=Math.abs(e-b.getLiveDelay()),n=b.getLiveCatchupLatencyThreshold(),R.get().streaming.lowLatencyEnabled&&R.get().streaming.liveCatchUpPlaybackRate>0&&B()>0&&t>R.get().streaming.liveCatchUpMinDrift&&(isNaN(n)||e<=n)?function(){if(h){var e=R.get().streaming.liveCatchUpPlaybackRate,t=b.getLiveDelay(),n=V()-t,r=5*n,i=1-e+2*e/(1+Math.pow(Math.E,-r));if(x)(function(){var e=null;return l.getActiveStreamProcessors().forEach((function(t){var n=t.getBufferLevel();e=null===e?n:Math.min(e,n)})),e})()>t/2?x=!1:n>0&&(i=1);Math.abs(h.getPlaybackRate()-i)>M&&h.setPlaybackRate(i),R.get().streaming.liveCatchUpMaxDrift>0&&!A&&n>R.get().streaming.liveCatchUpMaxDrift?(s.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),A=!0,F(((a=c.getCurrentDVRInfo())?a.range:null).end-b.getLiveDelay(),!0,!1)):A=!1}var a}():de())}function de(){h&&h.setPlaybackRate(1)}function he(e){if(!1===e.stream&&R.get().streaming.lowLatencyEnabled&&!isNaN(e.request.duration)){var t=1.2*e.request.duration;if(t>b.getLiveDelay()){s.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",t.toFixed(2));var n={streaming:{liveDelay:t}};R.update(n)}}}function fe(e){e.streamId===y.id&&(R.get().streaming.lowLatencyEnabled?e.state!==i.default.BUFFER_EMPTY||k()||x||(x=!0,de()):h.setStallState(e.mediaType,e.state===i.default.BUFFER_EMPTY))}function pe(e){t.trigger(o.default.PLAYBACK_STALLED,{e})}function me(e){!function(e,t){if(e&&e.manifestInfo&&e.manifestInfo.serviceDescriptions){for(var n=void 0,i=0;i<e.manifestInfo.serviceDescriptions.length;i++){var a=e.manifestInfo.serviceDescriptions[i];if(a.schemeIdUri===r.default.SERVICE_DESCRIPTION_LL_SCHEME){n=a;break}}n&&t&&t.supplementalProperties&&"true"===t.supplementalProperties[r.default.SUPPLEMENTAL_PROPERTY_LL_SCHEME]&&(n.latency&&n.latency.target>0&&(s.debug("Apply LL properties coming from service description. Target Latency (ms):",n.latency.target),R.update({streaming:{lowLatencyEnabled:!0,liveDelay:n.latency.target/1e3,liveCatchUpMinDrift:n.latency.max>n.latency.target?(n.latency.max-n.latency.target)/1e3:void 0}})),n.playbackRate&&n.playbackRate.max>1&&(s.debug("Apply LL properties coming from service description. Max PlaybackRate:",n.playbackRate.max),R.update({streaming:{lowLatencyEnabled:!0,liveCatchUpPlaybackRate:n.playbackRate.max-1}})))}}(e.streamInfo,e.mediaInfo)}return n={initialize:function(e,n,r){y=e,h.addEventListener("canplay",Q),h.addEventListener("play",Z),h.addEventListener("waiting",J),h.addEventListener("playing",$),h.addEventListener("pause",ee),h.addEventListener("error",le),h.addEventListener("seeking",te),h.addEventListener("seeked",ne),h.addEventListener("timeupdate",re),h.addEventListener("progress",ie),h.addEventListener("ratechange",ae),h.addEventListener("loadedmetadata",oe),h.addEventListener("stalled",pe),h.addEventListener("ended",se),_=y.manifestInfo.isDynamic,A=!1,x=!1,p=!0===n,m=r;var i="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",a=/safari/.test(i)&&!/chrome/.test(i);M=a?.25:.02,t.on(o.default.STREAM_INITIALIZED,I,this),t.on(o.default.DATA_UPDATE_COMPLETED,X,this),t.on(o.default.LOADING_PROGRESS,he,this),t.on(o.default.BUFFER_LEVEL_STATE_CHANGED,fe,this),t.on(o.default.PLAYBACK_PROGRESS,ce,this),t.on(o.default.PLAYBACK_TIME_UPDATED,ce,this),t.on(o.default.PLAYBACK_ENDED,ue,this),t.on(o.default.STREAM_INITIALIZING,me,this),E&&(E=!1,P())},setConfig:function(e){e&&(e.streamController&&(l=e.streamController),e.dashMetrics&&(c=e.dashMetrics),e.mediaPlayerModel&&(b=e.mediaPlayerModel),e.adapter&&(d=e.adapter),e.videoModel&&(h=e.videoModel),e.timelineConverter&&(f=e.timelineConverter),e.uriFragmentModel&&(C=e.uriFragmentModel),e.settings&&(R=e.settings))},getStartTimeFromUriParameters:W,getTimeToStreamEnd:O,getTime:B,getNormalizedTime:U,getPlaybackRate:j,getPlayedRanges:function(){return y&&h?h.getPlayedRanges():null},getEnded:G,getIsDynamic:H,getStreamController:function(){return l},computeAndSetLiveDelay:function(e,t,n){var r,i=void 0,a=void 0,o=!isNaN(e)&&isFinite(e)?e:NaN,s=d.getSuggestedPresentationDelay();if(i=R.get().streaming.lowLatencyEnabled?0:b.getLiveDelay()?b.getLiveDelay():null===R.get().streaming.liveDelayFragmentCount||isNaN(R.get().streaming.liveDelayFragmentCount)||isNaN(o)?!0===R.get().streaming.useSuggestedPresentationDelay&&null!==s&&!isNaN(s)&&s>0?s:isNaN(o)?isNaN(n)?4*y.manifestInfo.minBufferTime:4*n:4*o:o*R.get().streaming.liveDelayFragmentCount,null!==(r=d.getAvailabilityStartTime())&&(S=r),t>0){var u=Math.max(t-10,t/2);a=Math.min(i,u)}else a=i;return v=a,a},getLiveDelay:function(){return v},setLiveDelay:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&e<v||(v=e)},getCurrentLiveLatency:V,play:P,isPaused:L,pause:N,isSeeking:k,seek:F,reset:z},s=(0,u.default)(e).getInstance().getLogger(n),z(),n}c.__dashjs_factory_name="PlaybackController",t.default=s.default.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(102);var a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.BYTES_APPENDED="bytesAppended",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.DATA_UPDATE_STARTED="dataUpdateStarted",e.INBAND_EVENTS="inbandEvents",e.INITIALIZATION_LOADED="initializationLoaded",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_FRAGMENT_NEEDED="initFragmentNeeded",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",e.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",e.QUOTA_EXCEEDED="quotaExceeded",e.REPRESENTATION_UPDATE_STARTED="representationUpdateStarted",e.REPRESENTATION_UPDATE_COMPLETED="representationUpdateCompleted",e.SEGMENTS_LOADED="segmentsLoaded",e.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_COMPLETED="streamCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e.SEGMENTBASE_INIT_REQUEST_NEEDED="segmentBaseInitRequestNeeded",e.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED="segmentBaseSegmentsListRequestNeeded",e.SEEK_TARGET="seekTarget",e.DYNAMIC_STREAM_COMPLETED="dynamicStreamCompleted",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=b(n(9)),i=b(n(36)),a=b(n(881)),o=b(n(194)),s=b(n(16)),u=b(n(18)),l=b(n(2)),c=n(141),d=b(n(17)),h=b(n(138)),f=b(n(46)),p=b(n(143)),m=b(n(949)),g=b(n(950)),v=b(n(25)),y=b(n(35)),_=b(n(951));function b(e){return e&&e.__esModule?e:{default:e}}function E(){var e=this.context,t=(0,s.default)(e).getInstance(),n=void 0,l=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0,V=void 0,z=void 0,W=void 0,q=void 0,Y=void 0,K=void 0,X=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,ae=void 0;function oe(){if(Ce()){var e=q.getPlaybackQuality();e&&A.addDroppedFrames(e)}}function se(){if(!(!ae.get().streaming.jumpGaps||0===ve()||Y.isSeeking()||X||H||V||z)&&++ee>=40){var e=Y.getTime();re===e?function(e){for(var n=ve(),r=ae.get().streaming.smallGapLimit,i=void 0,a=0;a<n.length;a++){var o=n[a].getBuffer().getAllBufferRanges(),s=void 0;if(o&&!(o.length<=1)){for(var c=0;c<o.length;c++)if(e<o.start(c)){s=o.start(c);break}if(s>0){var d=s-e;d>0&&d<=r&&(void 0===i||s>i)&&(i=s)}}}var h=Y.getTimeToStreamEnd();void 0===i&&!isNaN(h)&&h<r&&(i=e+h);i>0&&(!isNaN(h)&&i>=e+h?(l.info("Jumping media gap (discontinuity) at time ",e,". Jumping to end of the stream"),t.trigger(u.default.PLAYBACK_ENDED,{isLast:Pe().isLast})):(l.info("Jumping media gap (discontinuity) at time ",e,". Jumping to time position",i),Y.seek(i,!0,!0)))}(e):re=e,ee=0}}function ue(e){var t=ge(e.seekTime);J&&(de(),Z=!1),$&&(l.debug("[PreloadTimer] stop period preload timer."),clearTimeout($),$=void 0),t===B&&ne&&ne.deactivate(!0),t&&(t!==B||ne&&!B.isActive())?(Ie(c.PlayListTrace.END_OF_PERIOD_STOP_REASON),be(t,B,e.seekTime)):Ie(c.PlayListTrace.USER_REQUEST_STOP_REASON),Oe(c.PlayList.SEEK_START_REASON)}function le(){l.debug("[onPlaybackStarted]"),Q?(Q=!1,Oe(c.PlayList.INITIAL_PLAYOUT_START_REASON)):X&&(X=!1,Oe(c.PlayList.RESUME_FROM_PAUSE_START_REASON),he())}function ce(e){l.debug("[onPlaybackPaused]"),e.ended||(X=!0,Ie(c.PlayListTrace.USER_REQUEST_STOP_REASON),he())}function de(){l.debug("[toggleEndPeriodTimer] stop end period timer."),clearTimeout(J),J=void 0}function he(){if(Z)if(J)de();else{var e=Y.getTimeToStreamEnd(),n=e>0?1e3*e:0,r=n<2e3?n/4:n-2e3;l.debug("[toggleEndPeriodTimer] Going to fire preload in",r,"milliseconds"),$=setTimeout(me,r),l.debug("[toggleEndPeriodTimer] start-up of timer to notify PLAYBACK_ENDED event. It will be triggered in",n,"milliseconds"),J=setTimeout((function(){t.trigger(u.default.PLAYBACK_ENDED,{isLast:Pe().isLast})}),n)}}function fe(e){if(e.mediaType===r.default.AUDIO||e.mediaType===r.default.VIDEO){var t=Pe().isLast;W&&!t&&void 0===J&&(l.info("[onTrackBufferingCompleted] end of period detected. Track",e.mediaType,"has finished"),Z=!0,!1===X&&he())}}function pe(){var e=Pe().isLast;W&&e&&(l.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),x.signalEndOfStream(W))}function me(){var e=Pe().isLast;if(W&&!e){var t=_e();B.isProtectionCompatible(t)&&(ie||B.isMediaCodecCompatible(t))&&(l.info("[onStreamCanLoadNext] Preloading next stream"),B.deactivate(!0),t.preload(W,te),ne=t,t.getProcessors().forEach((function(e){e.setIndexHandlerTime(t.getStartTime())})))}}function ge(e){var t=0,n=null,r=F.length;r>0&&(t+=F[0].getStartTime());for(var i=0;i<r;i++)if(n=F[i],e<(t=parseFloat((t+n.getDuration()).toFixed(5))))return n;return null}function ve(){return B?B.getProcessors():[]}function ye(){var e=_e();e?be(e,B,NaN):l.debug("StreamController no next stream found"),Ie(e?c.PlayListTrace.END_OF_PERIOD_STOP_REASON:c.PlayListTrace.END_OF_CONTENT_STOP_REASON),J=void 0,Z=!1}function _e(){if(B){var e=Pe().start,t=Pe().duration;return F.filter((function(n){return n.getStreamInfo().start===parseFloat((e+t).toFixed(5))}))[0]}}function be(e,n,r){if(l.info("Switch stream to "+e.getId()+" at t="+r),!(H||!e||n===e&&e.isActive())){H=!0,t.trigger(u.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:n?n.getStreamInfo():null,toStreamInfo:e.getStreamInfo()});var i=!1;n&&(i=B.isProtectionCompatible(e)&&(ie||B.isMediaCodecCompatible(e))&&!r||e.getPreloaded(),n.deactivate(i)),r=isNaN(r)?!i&&n?e.getStreamInfo().start:NaN:r,B=e,ne=!1,Y.initialize(Pe(),!!n,r),q.getElement()?Ee(r,null===n,!1,i):Te(r,i)}}function Ee(e,n,r,i){var a=void 0;function o(){W&&"open"==W.readyState&&(l.debug("MediaSource is open!"),window.URL.revokeObjectURL(a),W.removeEventListener("sourceopen",o),W.removeEventListener("webkitsourceopen",o),Se(),n||t.trigger(u.default.SOURCE_INITIALIZED),r?B.setMediaSource(W):Te(e,i))}W?i?(Te(e,i),n||t.trigger(u.default.SOURCE_INITIALIZED)):(x.detachMediaSource(q),W.addEventListener("sourceopen",o,!1),W.addEventListener("webkitsourceopen",o,!1),a=x.attachMediaSource(W,q),l.debug("MediaSource attached to element.  Waiting on open...")):((W=x.createMediaSource()).addEventListener("sourceopen",o,!1),W.addEventListener("webkitsourceopen",o,!1),a=x.attachMediaSource(W,q),l.debug("MediaSource attached to element.  Waiting on open..."))}function Te(e,n){if(te=B.activate(W,n?te:void 0)){var r=Object.keys(te);r.length>0&&te[r[0]].changeType&&(l.debug("SourceBuffer changeType method supported. Use it to switch codecs in periods transitions"),ie=!0)}Q||isNaN(e)||Y.seek(e),!G&&Q||Y.play(),H=!1,t.trigger(u.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:Pe()})}function Se(e){var t=e||Pe().manifestInfo.duration,n=x.setDuration(W,t);l.debug("Duration successfully set to: "+n)}function we(e){for(var t=0,n=F.length;t<n;t++)if(F[t].getId()===e.id)return F[t];return null}function Ae(){try{var n=w.getStreamsInfo();if(0===n.length)throw new Error("There are no streams");A.updateManifestUpdateInfo({currentTime:Y.getTime(),buffered:q.getBufferRange(),presentationStartTime:n[0].start,clientTimeOffset:k.getClientTimeOffset()});for(var i=0,o=n.length;i<o;i++){var s=n[i],c=we(s);c?c.updateData(s):(c=(0,a.default)(e).create({manifestModel:S,mediaPlayerModel:K,dashMetrics:A,manifestUpdater:E,adapter:w,timelineConverter:k,capabilities:b,errHandler:N,baseURLController:C,abrController:R,playbackController:Y,eventController:O,mediaController:I,textController:D,videoModel:q,settings:ae}),F.push(c),c.initialize(s,U)),A.addManifestUpdateStreamInfo(s)}if(!B){if(w.getIsDynamic()&&F.length){var d=n[0].manifestInfo,h=function(e,t){try{var n=NaN;if(t&&!isNaN(t.maxFragmentDuration)&&isFinite(t.maxFragmentDuration))return t.maxFragmentDuration;if(e&&1===e.length){var i=e[0],a=[r.default.VIDEO,r.default.AUDIO,r.default.FRAGMENTED_TEXT].reduce((function(e,t){var n=w.getMediaInfoForType(i,t);return n&&e.push(n),e}),[]).reduce((function(e,t){var n=w.getVoRepresentations(t);return n&&n.length>0&&n.forEach((function(t){t&&e.push(t)})),e}),[]).reduce((function(e,t){var n=w.convertDataToRepresentationInfo(t);return n&&n.fragmentDuration&&!isNaN(n.fragmentDuration)&&e.push(n.fragmentDuration),e}),[]);n=Math.max.apply(Math,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a))}return isFinite(n)?n:NaN}catch(e){return NaN}}(n,d);Y.computeAndSetLiveDelay(h,d.DVRWindowSize,d.minBufferTime)}var f=null,p=Y.getStartTimeFromUriParameters(n[0].start,w.getIsDynamic());isNaN(p)||(f=ge(p)),!f&&w.getIsDynamic()&&F.length&&(l.debug("Dynamic stream: Trying to find the correct starting period"),f=function(){try{return ge(k.calcPresentationTimeFromWallTime(new Date,w.getRegularPeriods()[0])-Y.getLiveDelay())}catch(e){return null}}()),be(null!==f?f:F[0],null,NaN)}t.trigger(u.default.STREAMS_COMPOSED)}catch(e){N.error(new v.default(y.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+"nostreamscomposed",S.getValue())),z=!0,Fe()}}function xe(){var e=S.getValue();U&&(t.trigger(u.default.PROTECTION_CREATED,{controller:U,manifest:e}),U.setMediaElement(q.getElement()),j&&U.setProtectionData(j)),Ae()}function Me(e){if(e.error)z=!0,Fe();else{var t=e.manifest;w.updatePeriods(t);var n=w.getStreamsInfo(void 0,1)[0],i=w.getMediaInfoForType(n,r.default.VIDEO)||w.getMediaInfoForType(n,r.default.AUDIO),a=void 0;if(i&&(a=w.getUseCalculatedLiveEdgeTimeForMediaInfo(i))){l.debug("SegmentTimeline detected using calculated Live Edge Time");ae.update({streaming:{useManifestDateHeaderTimeSource:!1}})}var o=w.getUTCTimingSources(),s=!w.getIsDynamic()||a?o:o.concat(K.getUTCTimingSources()),u=L.isHTTPS(e.manifest.url);s.forEach((function(e){e.value.replace(/.*?:\/\//g,"")===K.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(u?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),u?"https://":"http://"),l.debug("Matching default timing source protocol to manifest protocol: ",e.value))})),C.initialize(t),M.setConfig({dashMetrics:A,baseURLController:C}),M.initialize(s,ae.get().streaming.useManifestDateHeaderTimeSource)}}function Ce(){return!!B&&B.getHasVideoTrack()}function Re(){return!!B&&B.getHasAudioTrack()}function Ie(e,t){t=t||new Date,ve().forEach((function(n){n.finalisePlayList(t,e)})),A.addPlayList()}function Oe(e){A.createPlaylistMetrics(1e3*Y.getTime(),e)}function De(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}V=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),l.fatal("Video Element Error: "+t),e.error&&l.fatal(e.error),N.error(new v.default(e.error.code,t)),Fe()}}function Pe(){return B?B.getStreamInfo():null}function Le(){if(!(T&&T.hasOwnProperty("load")&&k&&k.hasOwnProperty("initialize")&&k.hasOwnProperty("reset")&&k.hasOwnProperty("getClientTimeOffset")&&S&&N&&A&&Y))throw new Error(r.default.MISSING_CONFIG_ERROR)}function Ne(e){isNaN(e.newDuration)||Se(e.newDuration)}function ke(){F=[],U=null,H=!1,B=null,V=!1,z=!1,Q=!0,X=!1,G=!0,J=void 0,Z=!1,ee=0}function Fe(){Le(),M.reset(),Ie(V||z?c.PlayListTrace.FAILURE_STOP_REASON:c.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,n=F?F.length:0;e<n;e++){F[e].reset(V)}!function(){t.off(u.default.PLAYBACK_TIME_UPDATED,oe,this),t.off(u.default.PLAYBACK_SEEKING,ue,this),t.off(u.default.PLAYBACK_ERROR,De,this),t.off(u.default.PLAYBACK_STARTED,le,this),t.off(u.default.PLAYBACK_PAUSED,ce,this),t.off(u.default.PLAYBACK_ENDED,ye,this),t.off(u.default.MANIFEST_UPDATED,Me,this),t.off(u.default.BUFFERING_COMPLETED,fe,this),t.off(u.default.STREAM_BUFFERING_COMPLETED,pe,this),t.off(u.default.MANIFEST_VALIDITY_CHANGED,Ne,this),t.off(u.default.TIME_SYNCHRONIZATION_COMPLETED,xe,this),t.off(u.default.WALLCLOCK_TIME_UPDATED,se,this),t.off(p.default.METRIC_ADDED,Be,this)}(),C.reset(),E.reset(),O.reset(),A.clearAllCurrentMetrics(),S.setValue(null),T.reset(),k.reset(),P.reset(),W&&(x.detachMediaSource(q),W=null),q=null,U&&(U.setMediaElement(null),U=null,j=null,S.getValue()&&t.trigger(u.default.PROTECTION_DESTROYED,{data:S.getValue().url})),t.trigger(u.default.STREAM_TEARDOWN_COMPLETE),ke()}function Be(e){if(e.metric===i.default.DVR_INFO){var t=Re()?r.default.AUDIO:r.default.VIDEO;e.mediaType===t&&x.setSeekable(W,e.value.range.start,e.value.range.end)}}return n={initialize:function(n,r){Le(),G=n,j=r,k.initialize(),(E=(0,o.default)(e).create()).setConfig({manifestModel:S,adapter:w,manifestLoader:T,errHandler:N,settings:ae}),E.initialize(),(O=(0,_.default)(e).getInstance()).setConfig({manifestUpdater:E,playbackController:Y}),O.start(),function(){t.on(u.default.PLAYBACK_TIME_UPDATED,oe,this),t.on(u.default.PLAYBACK_SEEKING,ue,this),t.on(u.default.PLAYBACK_ERROR,De,this),t.on(u.default.PLAYBACK_STARTED,le,this),t.on(u.default.PLAYBACK_PAUSED,ce,this),t.on(u.default.PLAYBACK_ENDED,ye,this),t.on(u.default.MANIFEST_UPDATED,Me,this),t.on(u.default.BUFFERING_COMPLETED,fe,this),t.on(u.default.STREAM_BUFFERING_COMPLETED,pe,this),t.on(u.default.MANIFEST_VALIDITY_CHANGED,Ne,this),t.on(u.default.TIME_SYNCHRONIZATION_COMPLETED,xe,this),t.on(u.default.WALLCLOCK_TIME_UPDATED,se,this),t.on(p.default.METRIC_ADDED,Be,this)}()},getActiveStreamInfo:Pe,hasVideoTrack:Ce,hasAudioTrack:Re,switchToVideoElement:function(e){B&&(Y.initialize(Pe()),Ee(e,!1,!0,!1))},getStreamById:function(e){return F.filter((function(t){return t.getId()===e}))[0]},getStreamForTime:ge,getTimeRelativeToStreamId:function(e,t){for(var n=null,r=0,i=0,a=null,o=0;o<F.length;o++){if(i=(n=F[o]).getStartTime(),a=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(a)&&(r+=a)}return null},load:function(e){Le(),T.load(e)},loadWithManifest:function(e){!function(){if(!E||!E.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}(),E.setManifest(e)},getActiveStreamProcessors:ve,setConfig:function(e){e&&(e.capabilities&&(b=e.capabilities),e.manifestLoader&&(T=e.manifestLoader),e.manifestModel&&(S=e.manifestModel),e.mediaPlayerModel&&(K=e.mediaPlayerModel),e.protectionController&&(U=e.protectionController),e.adapter&&(w=e.adapter),e.dashMetrics&&(A=e.dashMetrics),e.errHandler&&(N=e.errHandler),e.timelineConverter&&(k=e.timelineConverter),e.videoModel&&(q=e.videoModel),e.playbackController&&(Y=e.playbackController),e.abrController&&(R=e.abrController),e.mediaController&&(I=e.mediaController),e.textController&&(D=e.textController),e.settings&&(ae=e.settings),e.baseURLController&&(C=e.baseURLController))},setProtectionData:function(e){j=e},reset:Fe},l=(0,d.default)(e).getInstance().getLogger(n),M=(0,m.default)(e).getInstance(),x=(0,g.default)(e).getInstance(),P=(0,h.default)(e).getInstance(),L=(0,f.default)(e).getInstance(),ke(),n}E.__dashjs_factory_name="StreamController",t.default=l.default.getSingletonFactory(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=g(n(9)),i=g(n(33)),a=g(n(882)),o=g(n(934)),s=g(n(947)),u=g(n(16)),l=g(n(18)),c=g(n(17)),d=g(n(35)),h=g(n(2)),f=g(n(25)),p=g(n(91)),m=g(n(46));function g(e){return e&&e.__esModule?e:{default:e}}function v(e){e=e||{};var t=this.context,n=(0,u.default)(t).getInstance(),h=(0,m.default)(t).getInstance(),g=e.manifestModel,v=e.mediaPlayerModel,y=e.manifestUpdater,_=e.adapter,b=e.capabilities,E=e.errHandler,T=e.timelineConverter,S=e.dashMetrics,w=e.abrController,A=e.playbackController,x=e.eventController,M=e.mediaController,C=e.textController,R=e.videoModel,I=e.settings,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0,V=void 0,z=void 0,W=void 0,q=void 0,Y=void 0,K=void 0,X=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function Q(e){for(var t=L?L.length:0,r=0;r<t;r++){L[r].getFragmentModel().removeExecutedRequestsBeforeTime(ee()+$()),L[r].reset(false,e)}L=[],k=!1,F=!1,be(!1),n.off(l.default.CURRENT_TRACK_CHANGED,se,O)}function Z(){Q(),P=null,N=!1,B=!1,U=!1,j={},G=!1}function J(){A&&A.pause(),V&&(V.reset(),V=null),Z(),n.off(l.default.DATA_UPDATE_COMPLETED,pe,O),n.off(l.default.BUFFERING_COMPLETED,fe,O),n.off(l.default.INBAND_EVENTS,me,O),H&&(n.off(l.default.KEY_ERROR,ae,O),n.off(l.default.SERVER_CERTIFICATE_UPDATED,ae,O),n.off(l.default.LICENSE_REQUEST_COMPLETE,ae,O),n.off(l.default.KEY_SYSTEM_SELECTED,ae,O),n.off(l.default.KEY_SESSION_CREATED,ae,O),n.off(l.default.KEY_STATUSES_CHANGED,ae,O)),be(!1)}function $(){return P?P.duration:NaN}function ee(){return P?P.start:NaN}function te(){if(!P.manifestInfo.isDynamic)return NaN;for(var e=0;e<L.length;e++)if(L[e].getType()===r.default.AUDIO||L[e].getType()===r.default.VIDEO)return L[e].getLiveStartTime();return NaN}function ne(){return P?P.id:null}function re(){return P}function ie(){if(!(R&&w&&w.hasOwnProperty("getBitrateList")&&_&&_.hasOwnProperty("getAllMediaInfoForType")&&_.hasOwnProperty("getEventsFor")))throw new Error(r.default.MISSING_CONFIG_ERROR)}function ae(e){e.error&&(E.error(e.error),D.fatal(e.error.message),J())}function oe(e){var t,n=e?e.type:null,i=void 0;if(n===r.default.MUXED)return i="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",D.fatal(i),E.error(new f.default(d.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,i,g.getValue())),!1;if(n===r.default.TEXT||n===r.default.FRAGMENTED_TEXT||n===r.default.EMBEDDED_TEXT||n===r.default.IMAGE)return!0;if(t=e.codec,D.debug(n+" codec: "+t),e.contentProtection&&!b.supportsEncryptedMedia())E.error(new f.default(d.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,d.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE));else if(!b.supportsCodec(t))return i=n+"Codec ("+t+") is not supported.",D.error(i),!1;return!0}function se(e){if(P&&e.newMediaInfo.streamInfo.id===P.id){var t=e.newMediaInfo,n=g.getValue();_.setCurrentMediaInfo(P.id,t.type,t);var i=ge(t);if(i){var a=A.getTime();D.info("Stream -  Process track changed at current time "+a),D.debug("Stream -  Update stream controller"),n.refreshManifestOnSwitchTrack?(D.debug("Stream -  Refreshing manifest for switch track"),K=e,y.refreshManifest()):(i.selectMediaInfo(t),t.type!==r.default.FRAGMENTED_TEXT?(w.updateTopQualityIndex(t),i.switchTrackAsked(),i.getFragmentModel().abortRequests()):(i.getScheduleController().setSeekTarget(a),i.setIndexHandlerTime(a),i.resetIndexHandler()))}}}function ue(o,u){var c,d=_.getAllMediaInfoForType(P,o),h=null;if(d&&0!==d.length){o===r.default.VIDEO&&(B=!0),o===r.default.AUDIO&&(U=!0);for(var f=0,p=d.length;f<p;f++)if(h=d[f],o===r.default.EMBEDDED_TEXT)C.addEmbeddedTrack(h);else{if(!oe(h))continue;M.addTrack(h)}o!==r.default.EMBEDDED_TEXT&&0!==M.getTracksFor(o,P).length&&(o!==r.default.IMAGE?(M.checkInitialMediaSettingsForType(o,P),c=M.getCurrentTrackFor(o,P),n.trigger(l.default.STREAM_INITIALIZING,{streamInfo:P,mediaInfo:h}),function(n,i,o,s){var u=V.getModel(ne(),n?n.type:null),l=(0,a.default)(t).create({streamInfo:P,type:n?n.type:null,mimeType:n?n.mimeType:null,timelineConverter:T,adapter:_,manifestModel:g,mediaPlayerModel:v,fragmentModel:u,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,abrController:w,playbackController:A,mediaController:M,textController:C,errHandler:E,settings:I,boxParser:q});if(l.initialize(o,B),w.updateTopQualityIndex(n),s?(l.setBuffer(s.buffer),l.setIndexHandlerTime(s.currentTime),L[s.replaceIdx]=l):L.push(l),!s||!s.ignoreMediaInfo)if(!n||n.type!==r.default.TEXT&&n.type!==r.default.FRAGMENTED_TEXT)l.addMediaInfo(n,!0);else{for(var c=void 0,d=0;d<i.length;d++)i[d].index===n.index&&(c=d),l.addMediaInfo(i[d]);l.selectMediaInfo(i[c])}}(c,d,u)):z=(0,s.default)(t).create({streamInfo:P,adapter:_,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:Y,eventBus:n,events:l.default,dashConstants:i.default}))}else D.info("No "+o+" data.")}function le(){if(x){var e=_.getEventsFor(P);x.addInlineEvents(e)}}function ce(e){var t=_.getAdaptationForType(P?P.index:null,e,P);t&&Array.isArray(t.Representation_asArray)&&(t.Representation_asArray=t.Representation_asArray.filter((function(e,n){if(0===n)return!0;var r=_.getCodec(t,n,!0);return!!b.supportsCodec(r)||(D.error("[Stream] codec not supported: "+r),!1)})))}function de(){for(var e=L.length,t=!!j.audio||!!j.video?new f.default(d.default.DATA_UPDATE_FAILED_ERROR_CODE,d.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,i=0;i<e;i++)if(L[i].isUpdating()||G)return;if(F){if(H)for(var a=0;a<e&&L[a];a++)L[a].getType()!==r.default.AUDIO&&L[a].getType()!==r.default.VIDEO&&L[a].getType()!==r.default.FRAGMENTED_TEXT||H.initializeForMedia(L[a].getMediaInfo());t?E.error(t):N||(N=!0,T.setTimeSyncCompleted(!0),n.trigger(l.default.STREAM_INITIALIZED,{streamInfo:P,liveStartTime:te()}));for(var o=0;o<e&&L[o];o++)L[o].getScheduleController().start()}}function he(e){for(var t={},n=0,r=L.length;n<r;n++){var i=L[n].createBuffer(e);i&&(t[L[n].getType()]=i.getBuffer())}return t}function fe(e){if(e.streamId===P.id){var t=ve(),i=t.length;if(0!==i){for(var a=0;a<i;a++)if(!t[a].isBufferingCompleted()&&(t[a].getType()===r.default.AUDIO||t[a].getType()===r.default.VIDEO))return void D.warn("onBufferingCompleted - One streamProcessor has finished but",t[a].getType(),"one is not buffering completed");D.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),n.trigger(l.default.STREAM_BUFFERING_COMPLETED,{streamInfo:P})}else D.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}}function pe(e){P&&e.sender.getStreamId()===P.id&&(j[e.sender.getType()]=e.error,de())}function me(e){var t;P&&e.sender.getStreamInfo().id===P.id&&(t=e.events,x&&x.addInbandEvents(t))}function ge(e){return e?ve().filter((function(t){return t.getType()===e.type}))[0]:null}function ve(){for(var e=[],t=void 0,n=void 0,i=0;i<L.length;i++)(t=(n=L[i]).getType())!==r.default.AUDIO&&t!==r.default.VIDEO&&t!==r.default.FRAGMENTED_TEXT&&t!==r.default.TEXT||e.push(n);return e}function ye(e,t){if(!e)return!1;var n=e.getStreamInfo(),r=re();if(!n||!r)return!1;var i=_.getAdaptationForType(n.index,t,n),a=_.getAdaptationForType(r.index,t,r);return i&&a?!i.ContentProtection&&!a.ContentProtection:!i&&!a}function _e(e,t){if(!e||!e.hasOwnProperty("getStreamInfo"))return!1;var n=e.getStreamInfo(),r=re();if(!n||!r)return!1;var i=_.getAdaptationForType(n.index,t,n),a=_.getAdaptationForType(r.index,t,r);if(!i||!a)return!i&&!a;var o=i&&a&&i.mimeType===a.mimeType,s=a.Representation_asArray.map((function(e){return e.codecs})),u=i.Representation_asArray.map((function(e){return e.codecs})),l=u.some((function(e){return s.indexOf(e)>-1})),c=u.some((function(e){return s.some((function(t){return function(e,t){for(var n=e.split(".")[0],r=0===t.indexOf(n),i=void 0,a=0;a<X.length;a++)if(X[a].codec===n){i=X[a];break}if(i)return r||i.compatibleCodecs.some((function(e){return 0===t.indexOf(e)}));return r}(t,e)}))}));return l||c&&o}function be(e){W=e}function Ee(){return W}return O={initialize:function(e,t){P=e,(H=t)&&(n.on(l.default.KEY_ERROR,ae,O),n.on(l.default.SERVER_CERTIFICATE_UPDATED,ae,O),n.on(l.default.LICENSE_REQUEST_COMPLETE,ae,O),n.on(l.default.KEY_SYSTEM_SELECTED,ae,O),n.on(l.default.KEY_SESSION_CREATED,ae,O),n.on(l.default.KEY_STATUSES_CHANGED,ae,O))},activate:function(e,t){if(!k){var i=void 0;return n.on(l.default.CURRENT_TRACK_CHANGED,se,O),Ee()?(!function(){if(G=!0,ie(),ce(r.default.VIDEO),ce(r.default.AUDIO),F=!0,G=!1,0===L.length){var e="No streams to play.";E.error(new f.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e,g.getValue())),D.debug(e)}else de()}(),i=t):i=function(e,t){ie();var n=R.getElement();le(),G=!0,ce(r.default.VIDEO),ce(r.default.AUDIO),(!n||n&&/^VIDEO$/i.test(n.nodeName))&&ue(r.default.VIDEO,e);ue(r.default.AUDIO,e),ue(r.default.TEXT,e),ue(r.default.FRAGMENTED_TEXT,e),ue(r.default.EMBEDDED_TEXT,e),ue(r.default.MUXED,e),ue(r.default.IMAGE,e);var i=he(t);if(F=!0,G=!1,0===L.length){var a="No streams to play.";E.error(new f.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,a,g.getValue())),D.fatal(a)}else de();return i}(e,t),k=!0,i}return t},deactivate:Q,isActive:function(){return k},getDuration:$,getStartTime:ee,getId:ne,getStreamInfo:re,getHasAudioTrack:function(){return U},getHasVideoTrack:function(){return B},preload:function(e,t){le(),ue(r.default.VIDEO,e),ue(r.default.AUDIO,e),ue(r.default.TEXT,e),ue(r.default.FRAGMENTED_TEXT,e),ue(r.default.EMBEDDED_TEXT,e),ue(r.default.MUXED,e),ue(r.default.IMAGE,e),he(t),n.on(l.default.CURRENT_TRACK_CHANGED,se,O);for(var i=0;i<L.length&&L[i];i++)L[i].getScheduleController().start();be(!0)},getThumbnailController:function(){return z},getBitrateListFor:function(e){if(ie(),e===r.default.IMAGE)return z?z.getBitrateList():[];var t=function(e){for(var t=null,n=0;n<L.length;n++)if((t=L[n]).getType()===e)return t.getMediaInfo();return null}(e);return w.getBitrateList(t)},updateData:function(e){D.info("Manifest updated... updating data system wide."),k=!1,G=!0,P=e,x&&le(),ce(r.default.VIDEO),ce(r.default.AUDIO);for(var t=0,n=L.length;t<n;t++){var i=L[t];i.updateStreamInfo(P);var a=_.getMediaInfoForType(P,i.getType());w.updateTopQualityIndex(a),i.addMediaInfo(a,!0)}if(K&&K.newMediaInfo.type!==r.default.FRAGMENTED_TEXT){var o=ge(K.oldMediaInfo);if(!o)return;o.switchTrackAsked(),K=void 0}G=!1,de()},reset:J,getProcessors:ve,setMediaSource:function(e){for(var t=0;t<L.length;)oe(L[t].getMediaInfo())?(L[t].setMediaSource(e),t++):(L[t].reset(),L.splice(t,1));for(var n=0;n<L.length;n++)L[n].dischargePreBuffer();if(0===L.length){var r="No streams to play.";E.error(new f.default(d.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,r+"nostreams",g.getValue())),D.fatal(r)}},isMediaCodecCompatible:function(e){return _e(e,r.default.VIDEO)&&_e(e,r.default.AUDIO)},isProtectionCompatible:function(e){return ye(e,r.default.VIDEO)&&ye(e,r.default.AUDIO)},getPreloaded:Ee},Y=(0,c.default)(t).getInstance(),D=Y.getLogger(O),Z(),q=(0,p.default)(t).getInstance(),V=(0,o.default)(t).create({mediaPlayerModel:v,dashMetrics:S,errHandler:E,settings:I,boxParser:q,dashConstants:i.default,urlUtils:h}),n.on(l.default.BUFFERING_COMPLETED,fe,O),n.on(l.default.DATA_UPDATE_COMPLETED,pe,O),n.on(l.default.INBAND_EVENTS,me,O),O}v.__dashjs_factory_name="Stream",t.default=h.default.getClassFactory(v)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=A(n(9)),i=A(n(33)),a=A(n(36)),o=A(n(90)),s=A(n(175)),u=A(n(922)),l=A(n(924)),c=A(n(926)),d=A(n(927)),h=A(n(2)),f=n(54),p=A(n(16)),m=A(n(18)),g=A(n(186)),v=A(n(35)),y=A(n(25)),_=A(n(17)),b=A(n(140)),E=A(n(46)),T=A(n(91)),S=A(n(59)),w=n(141);function A(e){return e&&e.__esModule?e:{default:e}}function x(e){e=e||{};var t=this.context,n=(0,p.default)(t).getInstance(),h=e.streamInfo,A=e.type,x=e.errHandler,M=e.mimeType,C=e.timelineConverter,R=e.adapter,I=e.manifestModel,O=e.mediaPlayerModel,D=e.fragmentModel,P=e.abrController,L=e.playbackController,N=e.mediaController,k=e.textController,F=e.dashMetrics,B=e.settings,U=e.boxParser,j=void 0,G=void 0,H=void 0,V=void 0,z=void 0,W=void 0,q=void 0,Y=void 0,K=void 0,X=void 0;function Q(){z=[],V=null}function Z(e){e.sender.getType()===re()&&e.sender.getStreamId()===h.id&&(e.error||q.setCurrentRepresentation(R.convertDataToRepresentationInfo(e.currentRepresentation)),e.error&&e.error.code!==v.default.SEGMENTS_UPDATE_FAILED_ERROR_CODE||ne())}function J(e){if(A===e.mediaType&&h.id===e.streamInfo.id){var t=se(e.newQuality);q.setCurrentRepresentation(t),F.pushPlayListTraceMetrics(new Date,w.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),F.createPlaylistTraceMetrics(t.id,1e3*L.getTime(),L.getPlaybackRate())}}function $(e){e.streamId===h.id&&e.mediaType===A&&(F.addBufferLevel(A,new Date,1e3*e.bufferLevel),I.getValue().doNotUpdateDVRWindowOnBufferUpdated||ne())}function ee(e){e.streamId===h.id&&e.mediaType===A&&(F.addBufferState(A,e.state,q.getBufferTarget()),e.state!==a.default.BUFFER_EMPTY||L.isSeeking()||F.pushPlayListTraceMetrics(new Date,w.PlayListTrace.REBUFFERING_REASON))}function te(e){e.streamId===h.id&&e.mediaType===A&&(e.unintended?D.removeExecutedRequestsAfterTime(e.from):D.syncExecutedRequestsWithBufferedRange(W.getBuffer().getAllBufferRanges(),h.duration))}function ne(){var e=h.manifestInfo,t=e.isDynamic,n=C.calcSegmentAvailabilityRange(Y.getCurrentRepresentation(),t);F.addDVRInfo(re(),L.getTime(),e,n)}function re(){return A}function ie(){return W?W.getBuffer():null}function ae(){return z}function oe(){return V}function se(e){var t=void 0;return void 0!==e?((0,f.checkInteger)(e),t=Y?Y.getRepresentationForQuality(e):null):t=Y?Y.getCurrentRepresentation():null,R.convertDataToRepresentationInfo(t)}function ue(e){if(e.sender&&e.mediaType===A&&e.streamId===h.id&&(!R.getIsTextTrack(M)||k.isTextEnabled())&&W&&e.representationId&&!W.appendInitSegment(e.representationId)){var t=X?X.getInitRequest(oe(),Y.getCurrentRepresentation()):null;q.processInitRequest(t)}}function le(e){if(e.sender&&e.mediaType===A&&e.streamId===h.id){var t=void 0;W.getIsPruningInProgress()||(t=function(e,t){var n=se(),i=!isNaN(e),a=L.getNormalizedTime(),o=i?e:fe(),s=!1,u=void 0;if(isNaN(o)||re()===r.default.FRAGMENTED_TEXT&&!k.isTextEnabled())return null;if(W){var l=W.getRangeAt(o),c=W.getRangeAt(a);if((null!==l||null!==c)&&!i)if(!l||c&&c.start!=l.start&&c.end!=l.end)W.getBuffer().hasDiscontinuitiesAfter(a)&&re()!==r.default.FRAGMENTED_TEXT&&(D.removeExecutedRequestsAfterTime(c.end),s=!0)}if(t)u=pe(n,o=t.startTime+t.duration/2,{timeThreshold:0,ignoreIsFinished:!0});else for(u=pe(n,i||s?o:void 0,{keepIdx:!i&&!s});u&&u.action!==S.default.ACTION_COMPLETE&&D.isFragmentLoaded(u);)u=pe(n);return u}(e.seekTarget,e.replacement))&&(q.setSeekTarget(NaN),e.replacement||(isNaN(t.startTime+t.duration)||he(t.startTime+t.duration),t.delayLoadingTime=(new Date).getTime()+q.getTimeToLoadDelay(),q.setTimeToLoadDelay(0))),q.processMediaRequest(t)}}function ce(e){var r=e.chunk;if(r.streamId===h.id&&r.mediaInfo.type==A){var i=r.bytes,a=r.quality,s=se(a),u=Y&&s?Y.getRepresentationForQuality(s.quality):null,l=R.getEventsFor(s.mediaInfo),c=R.getEventsFor(s,u);if(l&&l.length>0||c&&c.length>0){var d=function(e,n,r,i){for(var a=Math.max(!n||isNaN(n.startTime)?0:n.startTime,0),o=[],s=[],u=r.concat(i),l=0,c=u.length;l<c;l++)o[u[l].schemeIdUri+"/"+u[l].value]=u[l];for(var d=(0,T.default)(t).getInstance().parse(e).getBoxes("emsg"),h=0,f=d.length;h<f;h++){var p=R.getEvent(d[h],o,a);p&&s.push(p)}return s}(i,D.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,quality:a,index:r.index})[0],l,c);n.trigger(m.default.INBAND_EVENTS,{sender:j,events:d})}}}function de(e){e.mediaType===A&&e.streamId===h.id&&(he(e.time),q.setSeekTarget(e.time))}function he(e){X&&X.setCurrentTime(e)}function fe(){return X?X.getCurrentTime():NaN}function pe(e,t,n){var r=null;if(X){var i=Y&&e?Y.getRepresentationForQuality(e.quality):null;r=void 0!==t&&void 0!==n?X.getSegmentRequestForTime(oe(),i,t,n):X.getNextSegmentRequest(oe(),i)}return r}return j={initialize:function(a,o){X=(0,g.default)(t).create({streamInfo:h,type:A,timelineConverter:C,dashMetrics:F,mediaPlayerModel:O,baseURLController:e.baseURLController,errHandler:x,settings:B,boxParser:U,events:m.default,eventBus:n,errors:v.default,debug:(0,_.default)(t).getInstance(),requestModifier:(0,b.default)(t).getInstance(),dashConstants:i.default,constants:r.default,urlUtils:(0,E.default)(t).getInstance()}),(H=h.manifestInfo.isDynamic)&&(K=(0,d.default)(t).create({timelineConverter:C})),X.initialize(H),P.registerStreamType(A,j),Y=(0,c.default)(t).create({streamId:h.id,type:A,abrController:P,dashMetrics:F,playbackController:L,timelineConverter:C,dashConstants:i.default,events:m.default,eventBus:n,errors:v.default}),(W=function(e){var n=null;if(!e)return x.error(new y.default(v.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,v.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null;n=e===r.default.VIDEO||e===r.default.AUDIO?(0,s.default)(t).create({streamInfo:h,type:e,mediaPlayerModel:O,manifestModel:I,fragmentModel:D,errHandler:x,mediaController:N,representationController:Y,adapter:R,textController:k,abrController:P,playbackController:L,settings:B}):(0,u.default)(t).create({streamInfo:h,type:e,mimeType:M,mediaPlayerModel:O,manifestModel:I,fragmentModel:D,errHandler:x,mediaController:N,representationController:Y,adapter:R,textController:k,abrController:P,playbackController:L,settings:B});return n}(A))&&W.initialize(a),(q=(0,l.default)(t).create({streamId:h.id,type:A,mimeType:M,adapter:R,dashMetrics:F,mediaPlayerModel:O,fragmentModel:D,abrController:P,playbackController:L,textController:k,mediaController:N,bufferController:W,settings:B})).initialize(o),!1},isUpdating:function(){return!!Y&&Y.isUpdating()},getType:re,getBufferController:function(){return W},getFragmentModel:function(){return D},getScheduleController:function(){return q},getRepresentationController:function(){return Y},getRepresentationInfo:se,getBufferLevel:function(){return W?W.getBufferLevel():0},isBufferingCompleted:function(){return!!W&&W.getIsBufferingCompleted()},createBuffer:function(e){return ie()||W?W.createBuffer(z,e):null},updateStreamInfo:function(e){h=e},getStreamInfo:function(){return h},selectMediaInfo:function(e){e===V||e&&V&&e.type!==V.type||(V=e);var t=R.getRealAdaptation(h,V),n=R.getVoRepresentations(V);if(Y){var i=Y.getData(),a=P.getTopQualityIndexFor(A,h.id),o=P.getMinAllowedIndexFor(A),s=void 0,u=null;null!==i&&i.id==t.id||A===r.default.FRAGMENTED_TEXT?s=P.getQualityFor(A):(u=P.getThroughputHistory().getAverageThroughput(A)||P.getInitialBitrateFor(A),s=P.getQualityForBitrate(V,u)),void 0!==o&&s<o&&(s=o),s>a&&(s=a),X.setMimeType(V?V.mimeType:null),Y.updateData(t,n,A,s)}},addMediaInfo:function(e,t){-1===z.indexOf(e)&&z.push(e),t&&this.selectMediaInfo(e)},getLiveStartTime:function(){if(!H)return NaN;if(!K)return NaN;var e=NaN,t=se(),n=function(e,t){try{var n=null,r=L.getLiveDelay(),i=isNaN(h.manifestInfo.DVRWindowSize)?r:h.manifestInfo.DVRWindowSize,a=.1*i,o=void 0;if(!isFinite(i)||pe(t,e-i+a,{ignoreIsFinished:!0}))for(;!n&&r<=i;)(n=pe(t,o=e-r,{ignoreIsFinished:!0}))||(r+=1);return n&&L.setLiveDelay(r,!0),G.debug("live edge: "+e+", live delay: "+r+", live target: "+o),n}catch(e){return null}}(K.getLiveEdge(t),t);return n&&(e=B.get().streaming.lowLatencyEnabled?n.duration<O.getLiveDelay()?n.startTime:n.startTime+n.duration-O.getLiveDelay():n.startTime),e},switchTrackAsked:function(){q.switchTrackAsked()},getMediaInfoArr:ae,getMediaInfo:oe,getMediaSource:function(){return W.getMediaSource()},setMediaSource:function(e){W.setMediaSource(e,ae())},dischargePreBuffer:function(){W.dischargePreBuffer()},getBuffer:ie,setBuffer:function(e){W.setBuffer(e)},setIndexHandlerTime:he,getIndexHandlerTime:fe,resetIndexHandler:function(){X&&X.resetIndex()},getInitRequest:function(e){(0,f.checkInteger)(e);var t=Y?Y.getRepresentationForQuality(e):null;return X?X.getInitRequest(oe(),t):null},getFragmentRequest:pe,finalisePlayList:function(e,t){F.pushPlayListTraceMetrics(e,t)},reset:function(e,t){X&&X.reset(),W&&(W.reset(e,t),W=null),q&&(q.reset(),q=null),Y&&(Y.reset(),Y=null),K&&(K.reset(),K=null),P&&P.unRegisterStreamType(A),n.off(m.default.DATA_UPDATE_COMPLETED,Z,j),n.off(m.default.QUALITY_CHANGE_REQUESTED,J,j),n.off(m.default.INIT_FRAGMENT_NEEDED,ue,j),n.off(m.default.MEDIA_FRAGMENT_NEEDED,le,j),n.off(m.default.MEDIA_FRAGMENT_LOADED,ce,j),n.off(m.default.BUFFER_LEVEL_UPDATED,$,j),n.off(m.default.BUFFER_LEVEL_STATE_CHANGED,ee,j),n.off(m.default.BUFFER_CLEARED,te,j),n.off(m.default.SEEK_TARGET,de,j),Q(),A=null,h=null}},G=(0,_.default)(t).getInstance().getLogger(j),Q(),n.on(m.default.DATA_UPDATE_COMPLETED,Z,j,p.default.EVENT_PRIORITY_HIGH),n.on(m.default.QUALITY_CHANGE_REQUESTED,J,j),n.on(m.default.INIT_FRAGMENT_NEEDED,ue,j),n.on(m.default.MEDIA_FRAGMENT_NEEDED,le,j),n.on(m.default.MEDIA_FRAGMENT_LOADED,ce,j),n.on(m.default.BUFFER_LEVEL_UPDATED,$,j),n.on(m.default.BUFFER_LEVEL_STATE_CHANGED,ee,j),n.on(m.default.BUFFER_CLEARED,te,j),n.on(m.default.SEEK_TARGET,de,j),j}x.__dashjs_factory_name="StreamProcessor",t.default=h.default.getClassFactory(x)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=y(n(9)),i=n(34),a=y(n(884)),o=y(n(91)),s=y(n(177)),u=y(n(2)),l=y(n(17)),c=y(n(131)),d=y(n(908)),h=y(n(71)),f=y(n(174)),p=y(n(16)),m=y(n(18)),g=y(n(25)),v=y(n(35));function y(e){return e&&e.__esModule?e:{default:e}}function _(){var e=this.context,t=(0,p.default)(e).getInstance(),n=!1,u=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0;function V(){R=null,O=NaN,D=[],N=null,I=!1}function z(){V(),M=[],w=null}function W(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&X(t.bytes,t)}function q(){F=[],(C=(0,c.default)(e).getInstance()).setConfig({videoModel:P}),C.initialize(),_=(0,o.default)(e).getInstance(),k=null,B=0,j=[],U=null,n=!0,G=(0,d.default)(e).getInstance();var r=L.getActiveStreamProcessors();for(var i in r)if("video"===r[i].getType()){H=r[i].getRepresentationInfo().MSETimeOffset;break}t.on(m.default.VIDEO_CHUNK_RECEIVED,W,this),t.on(m.default.BUFFER_CLEARED,Z,this)}function Y(e){k=e}function K(e,t){var n,i,o=new a.default,s={subtitle:"subtitles",caption:"captions"};o.captionData=e,o.lang=t.lang,o.labels=t.labels,o.id=t.id?t.id:t.index,o.index=t.index,o.isTTML=(n=!1,t.codec&&t.codec.search(r.default.STPP)>=0&&(n=!0),t.mimeType&&t.mimeType.search(r.default.TTML)>=0&&(n=!0),n),o.defaultTrack=function(e){var t=!1;F.length>1&&e.isEmbedded?t=e.id&&e.id===r.default.CC1:1===F.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===F.length&&(t=e.index===M[0].index);return t}(t),o.isFragmented=!E.getIsTextTrack(t.mimeType),o.isEmbedded=!!t.isEmbedded,o.kind=i=(i=t.roles.length>0?s[t.roles[0]]:s.caption)===s.caption||i===s.subtitle?i:s.caption,o.roles=t.roles,o.accessibility=t.accessibility;var u=(M?M.length:0)+F.length;C.addTextTrack(o,u)}function X(e,t){var n=void 0,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=t.mediaInfo,p=d.type,m=d.mimeType,E=d.codec||m;if(E){if(p===r.default.FRAGMENTED_TEXT)if(I||"InitializationSegment"!==t.segmentType){if(!I)return;if(a=(l=_.getSamplesInfo(e)).sampleList,null===N&&a.length>0&&(N=a[0].cts-t.start*O),E.search(r.default.STPP)>=0)for(w=null!==w?w:Q(E),o=0;o<a.length;o++){var S=a[o],A=S.cts,x=A-N;this.buffered.add(x/O,(x+S.duration)/O);var M=new DataView(e,S.offset,S.subSizes[0]);c=h.default.Utils.dataViewToString(M,r.default.UTF8);var D=[],L=S.offset+S.subSizes[0];for(s=1;s<S.subSizes.length;s++){var V=new Uint8Array(e,L,S.subSizes[s]),z=String.fromCharCode.apply(null,V);D.push(z),L+=S.subSizes[s]}try{var W=T.getValue().ttmlTimeIsRelative?A/O:0;n=w.parse(c,W,A/O,(A+S.duration)/O,D),C.addCaptions(k,N/O,n)}catch(e){R.removeExecutedRequestsBeforeTime(),this.remove(),y.error("TTML parser error: "+e.message)}}else{var q=[];for(o=0;o<a.length;o++){var Y=a[o];Y.cts-=N,this.buffered.add(Y.cts/O,(Y.cts+Y.duration)/O);var X=e.slice(Y.offset,Y.offset+Y.size),Z=h.default.parseBuffer(X);for(s=0;s<Z.boxes.length;s++){var J=Z.boxes[s];if(y.debug("VTT box1: "+J.type),"vtte"!==J.type&&"vttc"===J.type)for(y.debug("VTT vttc boxes.length = "+J.boxes.length),u=0;u<J.boxes.length;u++){var $=J.boxes[u];if(y.debug("VTT box2: "+$.type),"payl"===$.type){var ee=$.cue_text;y.debug("VTT cue_text = "+ee);var te=Y.cts/O,ne=(Y.cts+Y.duration)/O;q.push({start:te,end:ne,data:ee,styles:{}}),y.debug("VTT "+te+"-"+ne+" : "+ee)}}}}q.length>0&&C.addCaptions(k,0,q)}}else I=!0,O=_.getMediaTimescaleFromMoov(e);else if(p===r.default.TEXT){var re=new DataView(e,0,e.byteLength);c=h.default.Utils.dataViewToString(re,r.default.UTF8);try{n=Q(E).parse(c,0),C.addCaptions(C.getCurrentTrackIdx(),0,n)}catch(e){b.error(new g.default(v.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,v.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,c))}}else if(p===r.default.VIDEO)if(t.segmentType===i.HTTPRequest.INIT_SEGMENT_TYPE){if(0===B)for(B=_.getMediaTimescaleFromMoov(e),o=0;o<F.length;o++)K(null,F[o])}else{if(0===B)return void y.warn("CEA-608: No timescale for embeddedTextTrack yet");var ie=function(e,t){return function(e,n,r){var i=null;i=P.getTTMLRenderingDiv()?G.createHTMLCaptionsFromScreen(P.getElement(),e,n,r):[{start:e,end:n,data:r.getDisplayText(),styles:{}}],i&&C.addCaptions(t,0,i)}},ae=(l=_.getSamplesInfo(e)).lastSequenceNumber;if(!j[0]&&!j[1]){var oe=void 0,se=void 0;for(o=0;o<F.length;o++){if(F[o].id===r.default.CC1?(0,se=C.getTrackIdxForId(r.default.CC1)):F[o].id===r.default.CC3&&(1,se=C.getTrackIdxForId(r.default.CC3)),-1===se)return void y.warn("CEA-608: data before track is ready.");oe=ie(0,se),j[o]=new f.default.Cea608Parser(o+1,{newCue:oe},null)}}if(B){if(null!==U&&ae!==U+l.numSequences)for(o=0;o<j.length;o++)j[o]&&j[o].reset();for(var ue=function(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},r=new DataView(e),i=0;i<t.length;i++)for(var a=t[i],o=f.default.findCea608Nalus(r,a.offset,a.size),s=null,u=0,l=0;l<o.length;l++)for(var c=f.default.extractCea608DataFromRange(r,o[l]),d=0;d<2;d++)c[d].length>0&&(a.cts!==s?u=0:u+=1,n.fields[d].push([a.cts+H*B,c[d],u]),s=a.cts);return n.fields.forEach((function(e){e.sort((function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]}))})),n}(e,l.sampleList),le=0;le<j.length;le++){var ce=ue.fields[le],de=j[le];if(de)for(o=0;o<ce.length;o++)de.addData(ce[o][0]/B,ce[o][1])}U=ae}}}else y.error("No text type defined")}function Q(e){var t=void 0;return e.search(r.default.VTT)>=0?t=A:(e.search(r.default.TTML)>=0||e.search(r.default.STPP)>=0)&&(t=x),t}function Z(e){F.forEach((function(t){var n=C.getTrackIdxForId(t.id);n>=0&&C.deleteCuesFromTrackIdx(n,e.from,e.to)}))}return u={initialize:function(t,i,a,l){n||q(),C.setConfig({videoModel:P}),C.initialize(),_||(_=(0,o.default)(e).getInstance()),function(t,n,i,a){var o=!E.getIsTextTrack(t);if(M=M.concat(i),o){R=a,u.buffered=(0,s.default)(e).create(),D=S.getTracksFor(r.default.FRAGMENTED_TEXT,n);for(var l=S.getCurrentTrackFor(r.default.FRAGMENTED_TEXT,n),c=0;c<D.length;c++)if(D[c]===l){Y(c);break}}for(var d=0;d<M.length;d++)K(null,M[d])}(t,i,a,l)},append:X,abort:function(){C.deleteAllTextTracks(),V(),_=null,M=[]},addEmbeddedTrack:function(e){if(n||q(),e)if(e.id===r.default.CC1||e.id===r.default.CC3){for(var t=0;t<F.length;t++)if(F[t].id===e.id)return;F.push(e)}else y.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){t.off(m.default.VIDEO_CHUNK_RECEIVED,W,this),t.off(m.default.BUFFER_CLEARED,Z,this),C&&C.deleteAllTextTracks(),n=!1,F=[],j=[null,null],U=null},setConfig:function(e){e&&(e.errHandler&&(b=e.errHandler),e.adapter&&(E=e.adapter),e.manifestModel&&(T=e.manifestModel),e.mediaController&&(S=e.mediaController),e.videoModel&&(P=e.videoModel),e.streamController&&(L=e.streamController),e.textTracks&&(C=e.textTracks),e.vttParser&&(A=e.vttParser),e.ttmlParser&&(x=e.ttmlParser))},getConfig:function(){return{fragmentModel:R,fragmentedTracks:D,videoModel:P}},setCurrentFragmentedTrackIdx:Y,remove:function(e,t){void 0===e&&e===t&&(e=this.buffered.start(0),t=this.buffered.end(this.buffered.length-1)),this.buffered.remove(e,t)},reset:function(){z(),L=null,P=null,C=null}},y=(0,l.default)(e).getInstance().getLogger(u),z(),u}_.__dashjs_factory_name="TextSourceBuffer",t.default=u.default.getSingletonFactory(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(886)),i=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0;function t(t){var r=[];if(!t||!e||"function"!=typeof e.fetchAll)return r;for(var i=e.fetchAll(t),a=void 0,o=0,s=i.length;o<s;o++)(a=n(i[o]))&&r.push(a);return r}function n(e){if(!e)return null;var t=new r.default(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return{getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&"function"==typeof e.fetch?n(e.fetch(t)):null},getBoxes:t,setData:function(t){e=t},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var n=t(e.boxes[e.boxes.length-1].type);return n.length>0?n[n.length-1]:null}}}o.__dashjs_factory_name="IsoFile",t.default=i.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var n=0;n<t.boxes.length;n++)this.boxes.push(new e(t.boxes[n]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var r=0;r<t.references.length;r++){var i={reference_type:t.references[r].reference_type,referenced_size:t.references[r].referenced_size,subsegment_duration:t.references[r].subsegment_duration};this.references.push(i)}}break;case"emsg":this.id=t.id,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var a=0,o=t.samples.length;a<o;a++){var s={sample_size:t.samples[a].sample_size,sample_duration:t.samples[a].sample_duration,sample_composition_time_offset:t.samples[a].sample_composition_time_offset};this.samples.push(s)}}}}return r(e,[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastCompletedOffset=t,this.found=n,this.size=r}},function(e,t,n){!function(e,t,n,r){e.generateISD=function(e,t,n){var r=new o(e),i={};for(var s in e.head.layout.regions){var u=a(e,t,e.head.layout.regions[s],e.body,null,"",e.head.layout.regions[s],n,i);null!==u&&r.contents.push(u.element)}return r};var i=[n.byName.color.qname,n.byName.textCombine.qname,n.byName.textDecoration.qname,n.byName.textEmphasis.qname,n.byName.textOutline.qname,n.byName.textShadow.qname];function a(e,t,o,l,c,d,h,f,p){if(t<h.begin||t>=h.end)return null;var m="regionID"in h&&""!==h.regionID?h.regionID:d;if(null!==c&&m!==o.id&&(!("contents"in h)||"contents"in h&&0===h.contents.length||""!==m))return null;var g=new s(h);for(var v in h.sets)t<h.sets[v].begin||t>=h.sets[v].end||(g.styleAttrs[h.sets[v].qname]=h.sets[v].value);var y,_={};for(var b in g.styleAttrs)if(_[b]=!0,b===n.byName.writingMode.qname&&!(n.byName.direction.qname in g.styleAttrs)){var E=g.styleAttrs[b];"lrtb"===E||"lr"===E?g.styleAttrs[n.byName.direction.qname]="ltr":"rltb"!==E&&"rl"!==E||(g.styleAttrs[n.byName.direction.qname]="rtl")}if(null!==c)for(var T in n.all){var S=n.all[T];if(S.qname===n.byName.textDecoration.qname){var w=c.styleAttrs[S.qname],A=g.styleAttrs[S.qname],x=[];void 0===A?x=w:-1===A.indexOf("none")?((-1===A.indexOf("noUnderline")&&-1!==w.indexOf("underline")||-1!==A.indexOf("underline"))&&x.push("underline"),(-1===A.indexOf("noLineThrough")&&-1!==w.indexOf("lineThrough")||-1!==A.indexOf("lineThrough"))&&x.push("lineThrough"),(-1===A.indexOf("noOverline")&&-1!==w.indexOf("overline")||-1!==A.indexOf("overline"))&&x.push("overline")):x.push("none"),g.styleAttrs[S.qname]=x}else if(S.qname!==n.byName.fontSize.qname||S.qname in g.styleAttrs||"span"!==g.kind||"textContainer"!==g.styleAttrs[n.byName.ruby.qname])if(S.qname!==n.byName.fontSize.qname||S.qname in g.styleAttrs||"span"!==g.kind||"text"!==g.styleAttrs[n.byName.ruby.qname])S.inherit&&S.qname in c.styleAttrs&&!(S.qname in g.styleAttrs)&&(g.styleAttrs[S.qname]=c.styleAttrs[S.qname]);else{var M=c.styleAttrs[n.byName.fontSize.qname];"textContainer"===c.styleAttrs[n.byName.ruby.qname]?g.styleAttrs[S.qname]=M:g.styleAttrs[S.qname]=new r.ComputedLength(.5*M.rw,.5*M.rh)}else{var C=c.styleAttrs[n.byName.fontSize.qname];g.styleAttrs[S.qname]=new r.ComputedLength(.5*C.rw,.5*C.rh)}}for(var R in n.all){var I=n.all[R];if(!(I.qname in g.styleAttrs)&&!(I.qname===n.byName.position.qname&&n.byName.origin.qname in g.styleAttrs||I.qname===n.byName.origin.qname&&n.byName.position.qname in g.styleAttrs)){var O=e.head.styling.initials[I.qname]||I.initial;("region"===g.kind||!1===I.inherit&&null!==O)&&(g.styleAttrs[I.qname]=I.parse(O),_[I.qname]=!0)}}for(var D in n.all){var P=n.all[D];if(P.qname in _&&null!==P.compute){var L=P.compute(e,c,g,g.styleAttrs[P.qname],p);null!==L?g.styleAttrs[P.qname]=L:(g.styleAttrs[P.qname]=P.compute(e,c,g,P.parse(P.initial),p),u(f,"Style '"+P.qname+"' on element '"+g.kind+"' cannot be computed"))}}if("none"===g.styleAttrs[n.byName.display.qname])return null;for(var N in null===c?y=null===l?[]:[l]:"contents"in h&&(y=h.contents),y){var k=a(e,t,o,l,g,m,y[N],f,p);null!==k&&g.contents.push(k.element)}for(var F in g.styleAttrs){var B=!1;if("span"===g.kind){var U=g.styleAttrs[n.byName.ruby.qname];(B=("container"===U||"textContainer"===U||"baseContainer"===U)&&-1!==i.indexOf(F))||(B="container"!==U&&F===n.byName.rubyAlign.qname),B||(B=!("textContainer"===U||"text"===U)&&F===n.byName.rubyPosition.qname)}if(!B)B=-1===n.byQName[F].applies.indexOf(g.kind);B&&delete g.styleAttrs[F]}if("span"===g.kind&&g.text&&"default"===g.space){var j=g.text.replace(/[\t\r\n ]+/g," ");g.text=j}if("p"===g.kind){var G=[];!function e(t,n){if("contents"in t)for(var r in t.contents)e(t.contents[r],n);else"span"!==t.kind&&"br"!==t.kind||n.push(t)}(g,G);for(var H=0,V="after_br",z=0;;)if("after_br"===V)H>=G.length||"br"===G[H].kind?(V="before_br",z=H,H--):("preserve"!==G[H].space&&(G[H].text=G[H].text.replace(/^[\t\r\n ]+/g,"")),G[H].text.length>0?(V="looking_br",H++):G.splice(H,1));else if("before_br"===V)if(H<0||"br"===G[H].kind){if(V="after_br",(H=z+1)>=G.length)break}else if("preserve"!==G[H].space&&(G[H].text=G[H].text.replace(/[\t\r\n ]+$/g,"")),G[H].text.length>0){if(V="after_br",(H=z+1)>=G.length)break}else G.splice(H,1),H--;else H>=G.length||"br"===G[H].kind?(V="before_br",z=H,H--):H++;!function e(t){if("br"===t.kind)return!1;if("text"in t)return 0===t.text.length;if("contents"in t){for(var n=t.contents.length;n--;)e(t.contents[n])&&t.contents.splice(n,1);return 0===t.contents.length}}(g)}return"div"===g.kind&&n.byName.backgroundImage.qname in g.styleAttrs||"br"===g.kind||"image"===g.kind||"contents"in g&&g.contents.length>0||"span"===g.kind&&null!==g.text||"region"===g.kind&&"always"===g.styleAttrs[n.byName.showBackground.qname]?{region_id:m,element:g}:null}function o(e){this.contents=[],this.aspectRatio=e.aspectRatio}function s(e){for(var t in this.kind=e.kind||"region",e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)this.styleAttrs[t]=e.styleAttrs[t];"src"in e&&(this.src=e.src),"type"in e&&(this.type=e.type),"text"in e?this.text=e.text:("region"===this.kind||"contents"in e)&&(this.contents=[]),"space"in e&&(this.space=e.space)}function u(e,t){if(e&&e.error&&e.error(t))throw t}}(t,"undefined"==typeof imscNames?n(104):imscNames,"undefined"==typeof imscStyles?n(132):imscStyles,"undefined"==typeof imscUtils?n(105):imscUtils)},function(e,t,n){!function(e,t,n,r,i){function a(e,t,n,r){var i=r&&"seq"===r.timeContainer,o=0;r&&(o=i&&n?n.end:r.begin),t.begin=t.explicit_begin?t.explicit_begin+o:o;var s=t.begin,u=null;for(var l in t.sets)a(e,t.sets[l],u,t),s="seq"===t.timeContainer?t.sets[l].end:Math.max(s,t.sets[l].end),u=t.sets[l];if("contents"in t)for(var c in t.contents)a(e,t.contents[c],u,t),s="seq"===t.timeContainer?t.contents[c].end:Math.max(s,t.contents[c].end),u=t.contents[c];else s=i?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,o+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=o+t.explicit_end:t.end=s,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t)}function o(e){this.node=e}function s(){this.events=[],this.head=new u,this.body=null}function u(){this.styling=new l,this.layout=new h}function l(){this.styles={},this.initials={}}function c(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function d(){this.styleAttrs=null}function h(){this.regions={}}function f(e,t){p.call(this,"image"),this.src=e,this.type=t}function p(e){this.kind=e}function m(e){this.id=e}function g(e){this.regionID=e}function v(e){this.styleAttrs=e}function y(e){this.sets=e}function _(e){this.contents=e}function b(e,t,n){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=n}function E(){p.call(this,"body")}function T(){p.call(this,"div")}function S(){p.call(this,"p")}function w(){p.call(this,"span")}function A(){p.call(this,"span")}function x(){p.call(this,"br")}function M(){}function C(){}function R(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null}function I(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function O(e,t){var n={};if(null!==e)for(var i in e.attributes){var a=e.attributes[i].uri+" "+e.attributes[i].local,o=r.byQName[a];if(void 0!==o){var s=o.parse(e.attributes[i].value);null!==s?(n[a]=s,o===r.byName.zIndex&&F(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):B(t,"Cannot parse styling attribute "+a+" --\x3e "+e.attributes[i].value)}}return n}function D(e,t,n){for(var r in e.attributes)if(e.attributes[r].uri===t&&e.attributes[r].local===n)return e.attributes[r].value;return null}function P(e,t,n){var r,i=null;return null!==(r=/^(\d+(?:\.\d+)?)f$/.exec(n))?null!==t&&(i=parseFloat(r[1])/t):null!==(r=/^(\d+(?:\.\d+)?)t$/.exec(n))?null!==e&&(i=parseFloat(r[1])/e):null!==(r=/^(\d+(?:\.\d+)?)ms$/.exec(n))?i=parseFloat(r[1])/1e3:null!==(r=/^(\d+(?:\.\d+)?)s$/.exec(n))?i=parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)h$/.exec(n))?i=3600*parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)m$/.exec(n))?i=60*parseFloat(r[1]):null!==(r=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n))?i=3600*parseInt(r[1])+60*parseInt(r[2])+parseFloat(r[3]):null!==(r=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n))&&null!==t&&(i=3600*parseInt(r[1])+60*parseInt(r[2])+parseInt(r[3])+(null===r[4]?0:parseInt(r[4])/t)),i}function L(e,t,n){for(;t.styleRefs.length>0;){var r=t.styleRefs.pop();r in e.styles?(L(e,e.styles[r],n),k(e.styles[r].styleAttrs,t.styleAttrs)):B(n,"Non-existant style id referenced")}}function N(e,t,n,r){for(var i=t.length-1;i>=0;i--){var a=t[i];a in e.styles?k(e.styles[a].styleAttrs,n):B(r,"Non-existant style id referenced")}}function k(e,t){for(var n in e)n in t||(t[n]=e[n])}function F(e,t){if(e&&e.warn&&e.warn(t))throw t}function B(e,t){if(e&&e.error&&e.error(t))throw t}function U(e,t){throw e&&e.fatal&&e.fatal(t),t}function j(e,t){for(var n,r=0,i=e.length-1;r<=i;){var a=e[n=Math.floor((r+i)/2)];if(a<t)r=n+1;else{if(!(a>t))return{found:!0,index:n};i=n-1}}return{found:!1,index:r}}e.fromXML=function(e,i,p){var m=t.parser(!0,{xmlns:!0}),g=[],v=[],y=[],_=0,b=null;m.onclosetag=function(e){if(g[0]instanceof l)for(var t in g[0].styles)L(g[0],g[0].styles[t],i);else if(g[0]instanceof S||g[0]instanceof w){if(g[0].contents.length>1){var r,a=[g[0].contents[0]];for(r=1;r<g[0].contents.length;r++)g[0].contents[r]instanceof A&&a[a.length-1]instanceof A?a[a.length-1].text+=g[0].contents[r].text:a.push(g[0].contents[r]);g[0].contents=a}g[0]instanceof w&&1===g[0].contents.length&&g[0].contents[0]instanceof A&&(g[0].text=g[0].contents[0].text,delete g[0].contents)}else g[0]instanceof o&&(g[0].node.uri===n.ns_tt&&"metadata"===g[0].node.local?_--:_>0&&p&&"onCloseTag"in p&&p.onCloseTag());y.shift(),v.shift(),g.shift()},m.ontext=function(e){if(void 0===g[0]);else if(g[0]instanceof w||g[0]instanceof S){if(g[0]instanceof w){var t=g[0].styleAttrs[r.byName.ruby.qname];if("container"===t||"textContainer"===t||"baseContainer"===t)return}var n=new A;n.initFromText(b,g[0],e,y[0],i),g[0].contents.push(n)}else g[0]instanceof o&&_>0&&p&&"onText"in p&&p.onText(e)},m.onopentag=function(e){var t=e.attributes["xml:space"];t?y.unshift(t.value):0===y.length?y.unshift("default"):y.unshift(y[0]);var a=e.attributes["xml:lang"];if(a?v.unshift(a.value):0===v.length?v.unshift(""):v.unshift(v[0]),e.uri===n.ns_tt)if("tt"===e.local)null!==b&&U(i,"Two <tt> elements at ("+this.line+","+this.column+")"),(b=new s).initFromNode(e,i),g.unshift(b);else if("head"===e.local)g[0]instanceof s||U(i,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),g.unshift(b.head);else if("styling"===e.local)g[0]instanceof u||U(i,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),g.unshift(b.head.styling);else if("style"===e.local){var m;g[0]instanceof l?((m=new c).initFromNode(e,i),m.id?b.head.styling.styles[m.id]=m:B(i,"<style> element missing @id attribute"),g.unshift(m)):g[0]instanceof M?((m=new c).initFromNode(e,i),k(m.styleAttrs,g[0].styleAttrs),g.unshift(m)):U(i,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("initial"===e.local){var A;if(g[0]instanceof l){for(var R in(A=new d).initFromNode(e,i),A.styleAttrs)b.head.styling.initials[R]=A.styleAttrs[R];g.unshift(A)}else U(i,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if("layout"===e.local)g[0]instanceof u||U(i,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),g.unshift(b.head.layout);else if("region"===e.local){g[0]instanceof h||U(i,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var I=new M;I.initFromNode(b,e,i),!I.id||I.id in b.head.layout.regions?B(i,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):b.head.layout.regions[I.id]=I,g.unshift(I)}else if("body"===e.local){g[0]instanceof s||U(i,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==b.body&&U(i,"Second <body> element at "+this.line+","+this.column+")");var O=new E;O.initFromNode(b,e,i),b.body=O,g.unshift(O)}else if("div"===e.local){g[0]instanceof T||g[0]instanceof E||U(i,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var D=new T;D.initFromNode(b,g[0],e,i);var P=D.styleAttrs[r.byName.backgroundImage.qname];P&&(D.contents.push(new f(P)),delete D.styleAttrs[r.byName.backgroundImage.qname]),g[0].contents.push(D),g.unshift(D)}else if("image"===e.local){g[0]instanceof T||U(i,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var L=new f;L.initFromNode(b,g[0],e,i),g[0].contents.push(L),g.unshift(L)}else if("p"===e.local){g[0]instanceof T||U(i,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var N=new S;N.initFromNode(b,g[0],e,i),g[0].contents.push(N),g.unshift(N)}else if("span"===e.local){g[0]instanceof w||g[0]instanceof S||U(i,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var F=new w;F.initFromNode(b,g[0],e,y[0],i),g[0].contents.push(F),g.unshift(F)}else if("br"===e.local){g[0]instanceof w||g[0]instanceof S||U(i,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var j=new x;j.initFromNode(b,g[0],e,i),g[0].contents.push(j),g.unshift(j)}else if("set"===e.local){g[0]instanceof w||g[0]instanceof S||g[0]instanceof T||g[0]instanceof E||g[0]instanceof M||g[0]instanceof x||U(i,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var G=new C;G.initFromNode(b,g[0],e,i),g[0].sets.push(G),g.unshift(G)}else g.unshift(new o(e));else g.unshift(new o(e));if(g[0]instanceof o)if(e.uri===n.ns_tt&&"metadata"===e.local)_++;else if(_>0&&p&&"onOpenTag"in p){var H=[];for(var V in e.attributes)H[e.attributes[V].uri+" "+e.attributes[V].local]={uri:e.attributes[V].uri,local:e.attributes[V].local,value:e.attributes[V].value};p.onOpenTag(e.uri,e.local,H)}},m.write(e).close(),delete b.head.styling.styles;var R=!1;for(var I in b.head.layout.regions){R=!0;break}if(!R){var O=M.prototype.createDefaultRegion();b.head.layout.regions[O.id]=O}for(var D in b.head.layout.regions)a(b,b.head.layout.regions[D],null,null);return b.body&&a(b,b.body,null,null),b.body&&function e(t){if(!("contents"in t))return;for(var n=("styleAttrs"in t?t.styleAttrs[r.byName.ruby.qname]:null),i="span"===t.kind&&("container"===n||"textContainer"===n||"baseContainer"===n),a=t.contents.length-1;a>=0;a--)!i||"styleAttrs"in t.contents[a]&&r.byName.ruby.qname in t.contents[a].styleAttrs?e(t.contents[a]):delete t.contents[a]}(b.body),b},s.prototype.initFromNode=function(e,t){var r=function(e,t){var r=D(e,n.ns_ttp,"cellResolution"),i=15,a=32;if(null!==r){var o=/(\d+) (\d+)/.exec(r);null!==o?(a=parseInt(o[1]),i=parseInt(o[2])):F(t,"Malformed cellResolution value (using initial value instead)")}return{w:a,h:i}}(e,t);this.cellLength={h:new i.ComputedLength(0,1/r.h),w:new i.ComputedLength(1/r.w,0)};var a=function(e,t){var r,i=D(e,n.ns_ttp,"frameRate"),a=30;if(null!==i){null!==(r=/(\d+)/.exec(i))?a=parseInt(r[1]):F(t,"Malformed frame rate attribute (using initial value instead)")}var o=D(e,n.ns_ttp,"frameRateMultiplier"),s=1;if(null!==o){null!==(r=/(\d+) (\d+)/.exec(o))?s=parseInt(r[1])/parseInt(r[2]):F(t,"Malformed frame rate multiplier attribute (using initial value instead)")}var u=s*a,l=1,c=D(e,n.ns_ttp,"tickRate");if(null===c)null!==i&&(l=u);else{null!==(r=/(\d+)/.exec(c))?l=parseInt(r[1]):F(t,"Malformed tick rate attribute (using initial value instead)")}return{effectiveFrameRate:u,tickRate:l}}(e,t);this.effectiveFrameRate=a.effectiveFrameRate,this.tickRate=a.tickRate,this.aspectRatio=function(e,t){var r=D(e,n.ns_ittp,"aspectRatio");null===r&&(r=D(e,n.ns_ttp,"displayAspectRatio"));var i=null;if(null!==r){var a=/(\d+)\s+(\d+)/.exec(r);if(null!==a){var o=parseInt(a[1]),s=parseInt(a[2]);0!==o&&0!==s?i=o/s:B(t,"Illegal aspectRatio values (ignoring)")}else B(t,"Malformed aspectRatio attribute (ignoring)")}return i}(e,t);var o=D(e,n.ns_ttp,"timeBase");null!==o&&"media"!==o&&U(t,"Unsupported time base");var s=function(e,t){var r=D(e,n.ns_tts,"extent");if(null===r)return null;var a=r.split(" ");if(2!==a.length)return F(t,"Malformed extent (ignoring)"),null;var o=i.parseLength(a[0]),s=i.parseLength(a[1]);if(!s||!o)return F(t,"Malformed extent values (ignoring)"),null;return{h:s,w:o}}(e,t);null===s?this.pxLength={h:null,w:null}:("px"===s.h.unit&&"px"===s.w.unit||U(t,"Extent on TT must be in px or absent"),this.pxLength={h:new i.ComputedLength(0,1/s.h.value),w:new i.ComputedLength(1/s.w.value,0)}),this.dimensions={h:new i.ComputedLength(0,1),w:new i.ComputedLength(1,0)}},s.prototype._registerEvent=function(e){if(!(e.end<=e.begin)){var t=j(this.events,e.begin);if(t.found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY){var n=j(this.events,e.end);n.found||this.events.splice(n.index,0,e.end)}}},s.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},s.prototype.getMediaTimeEvents=function(){return this.events},c.prototype.initFromNode=function(e,t){this.id=R(e),this.styleAttrs=O(e,t),this.styleRefs=I(e)},d.prototype.initFromNode=function(e,t){for(var r in this.styleAttrs={},e.attributes)if(e.attributes[r].uri===n.ns_itts||e.attributes[r].uri===n.ns_ebutts||e.attributes[r].uri===n.ns_tts){var i=e.attributes[r].uri+" "+e.attributes[r].local;this.styleAttrs[i]=e.attributes[r].value}},f.prototype.initFromNode=function(e,t,n,r){this.src="src"in n.attributes?n.attributes.src.value:null,this.src||B(r,"Invalid image@src attribute"),this.type="type"in n.attributes?n.attributes.type.value:null,this.type||B(r,"Invalid image@type attribute"),v.prototype.initFromNode.call(this,e,t,n,r),b.prototype.initFromNode.call(this,e,t,n,r),y.prototype.initFromNode.call(this,e,t,n,r),g.prototype.initFromNode.call(this,e,t,n,r)},m.prototype.initFromNode=function(e,t,n,r){this.id=R(n)},g.prototype.initFromNode=function(e,t,n,r){this.regionID=function(e){return e&&"region"in e.attributes?e.attributes.region.value:""}(n)},v.prototype.initFromNode=function(e,t,n,r){this.styleAttrs=O(n,r),null!==e.head&&null!==e.head.styling&&N(e.head.styling,I(n),this.styleAttrs,r)},y.prototype.initFromNode=function(e,t,n,r){this.sets=[]},_.prototype.initFromNode=function(e,t,n,r){this.contents=[]},b.prototype.initFromNode=function(e,t,n,r){var i=function(e,t,n,r){var i=null;n&&"begin"in n.attributes&&null===(i=P(e.tickRate,e.effectiveFrameRate,n.attributes.begin.value))&&F(r,"Malformed begin value "+n.attributes.begin.value+" (using 0)");var a=null;n&&"dur"in n.attributes&&null===(a=P(e.tickRate,e.effectiveFrameRate,n.attributes.dur.value))&&F(r,"Malformed dur value "+n.attributes.dur.value+" (ignoring)");var o=null;n&&"end"in n.attributes&&null===(o=P(e.tickRate,e.effectiveFrameRate,n.attributes.end.value))&&F(r,"Malformed end value (ignoring)");return{explicit_begin:i,explicit_end:o,explicit_dur:a}}(e,0,n,r);this.explicit_begin=i.explicit_begin,this.explicit_end=i.explicit_end,this.explicit_dur=i.explicit_dur,this.timeContainer=function(e,t){var n=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return n&&"par"!==n?"seq"===n?"seq":(B(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(n,r)},E.prototype.initFromNode=function(e,t,n){v.prototype.initFromNode.call(this,e,null,t,n),b.prototype.initFromNode.call(this,e,null,t,n),y.prototype.initFromNode.call(this,e,null,t,n),g.prototype.initFromNode.call(this,e,null,t,n),_.prototype.initFromNode.call(this,e,null,t,n)},T.prototype.initFromNode=function(e,t,n,r){v.prototype.initFromNode.call(this,e,t,n,r),b.prototype.initFromNode.call(this,e,t,n,r),y.prototype.initFromNode.call(this,e,t,n,r),g.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r)},S.prototype.initFromNode=function(e,t,n,r){v.prototype.initFromNode.call(this,e,t,n,r),b.prototype.initFromNode.call(this,e,t,n,r),y.prototype.initFromNode.call(this,e,t,n,r),g.prototype.initFromNode.call(this,e,t,n,r),_.prototype.initFromNode.call(this,e,t,n,r)},w.prototype.initFromNode=function(e,t,n,r,i){v.prototype.initFromNode.call(this,e,t,n,i),b.prototype.initFromNode.call(this,e,t,n,i),y.prototype.initFromNode.call(this,e,t,n,i),g.prototype.initFromNode.call(this,e,t,n,i),_.prototype.initFromNode.call(this,e,t,n,i),this.space=r},A.prototype.initFromText=function(e,t,n,r,i){b.prototype.initFromNode.call(this,e,t,null,i),this.text=n,this.space=r},x.prototype.initFromNode=function(e,t,n,r){g.prototype.initFromNode.call(this,e,t,n,r),b.prototype.initFromNode.call(this,e,t,n,r)},M.prototype.createDefaultRegion=function(){var e=new M;return m.call(e,""),v.call(e,{}),y.call(e,[]),b.call(e,0,Number.POSITIVE_INFINITY,null),e},M.prototype.initFromNode=function(e,t,n){m.prototype.initFromNode.call(this,e,null,t,n),v.prototype.initFromNode.call(this,e,null,t,n),b.prototype.initFromNode.call(this,e,null,t,n),y.prototype.initFromNode.call(this,e,null,t,n),null!==e.head&&null!==e.head.styling&&N(e.head.styling,I(t),this.styleAttrs,n)},C.prototype.initFromNode=function(e,t,n,r){b.prototype.initFromNode.call(this,e,t,n,r);var i=O(n,r);for(var a in this.qname=null,this.value=null,i){if(this.qname){B(r,"More than one style specified on set");break}this.qname=a,this.value=i[a]}}}(t,"undefined"==typeof sax?n(890):sax,"undefined"==typeof imscNames?n(104):imscNames,"undefined"==typeof imscStyles?n(132):imscStyles,"undefined"==typeof imscUtils?n(105):imscUtils)},function(e,t,n){(function(e){!function(t){t.parser=function(e,t){return new a(e,t)},t.SAXParser=a,t.SAXStream=s,t.createStream=function(e,t){return new s(e,t)},t.MAX_BUFFER_LENGTH=65536;var r,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function a(e,n){if(!(this instanceof a))return new a(e,n);var r=this;!function(e){for(var t=0,n=i.length;t<n;t++)e[i[t]]=""}(r),r.q=r.c="",r.bufferCheckPosition=t.MAX_BUFFER_LENGTH,r.opt=n||{},r.opt.lowercase=r.opt.lowercase||r.opt.lowercasetags,r.looseCase=r.opt.lowercase?"toLowerCase":"toUpperCase",r.tags=[],r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.strict=!!e,r.noscript=!(!e&&!r.opt.noscript),r.state=x.BEGIN,r.strictEntities=r.opt.strictEntities,r.ENTITIES=r.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),r.attribList=[],r.opt.xmlns&&(r.ns=Object.create(m)),r.trackPosition=!1!==r.opt.position,r.trackPosition&&(r.position=r.line=r.column=0),C(r,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),a.prototype={end:function(){P(this)},write:function(e){var n=this;if(this.error)throw this.error;if(n.closed)return D(n,"Cannot write after close. Assign an onready handler.");if(null===e)return P(n);"object"==typeof e&&(e=e.toString());var r=0,a="";for(;a=H(e,r++),n.c=a,a;)switch(n.trackPosition&&(n.position++,"\n"===a?(n.line++,n.column=0):n.column++),n.state){case x.BEGIN:if(n.state=x.BEGIN_WHITESPACE,"\ufeff"===a)continue;G(n,a);continue;case x.BEGIN_WHITESPACE:G(n,a);continue;case x.TEXT:if(n.sawRoot&&!n.closedRoot){for(var o=r-1;a&&"<"!==a&&"&"!==a;)(a=H(e,r++))&&n.trackPosition&&(n.position++,"\n"===a?(n.line++,n.column=0):n.column++);n.textNode+=e.substring(o,r-1)}"<"!==a||n.sawRoot&&n.closedRoot&&!n.strict?(!T(u,a)||n.sawRoot&&!n.closedRoot||L(n,"Text data outside of root node."),"&"===a?n.state=x.TEXT_ENTITY:n.textNode+=a):(n.state=x.OPEN_WAKA,n.startTagPosition=n.position);continue;case x.SCRIPT:"<"===a?n.state=x.SCRIPT_ENDING:n.script+=a;continue;case x.SCRIPT_ENDING:"/"===a?n.state=x.CLOSE_TAG:(n.script+="<"+a,n.state=x.SCRIPT);continue;case x.OPEN_WAKA:if("!"===a)n.state=x.SGML_DECL,n.sgmlDecl="";else if(E(u,a));else if(E(g,a))n.state=x.OPEN_TAG,n.tagName=a;else if("/"===a)n.state=x.CLOSE_TAG,n.tagName="";else if("?"===a)n.state=x.PROC_INST,n.procInstName=n.procInstBody="";else{if(L(n,"Unencoded <"),n.startTagPosition+1<n.position){var s=n.position-n.startTagPosition;a=new Array(s).join(" ")+a}n.textNode+="<"+a,n.state=x.TEXT}continue;case x.SGML_DECL:"[CDATA["===(n.sgmlDecl+a).toUpperCase()?(R(n,"onopencdata"),n.state=x.CDATA,n.sgmlDecl="",n.cdata=""):n.sgmlDecl+a==="--"?(n.state=x.COMMENT,n.comment="",n.sgmlDecl=""):"DOCTYPE"===(n.sgmlDecl+a).toUpperCase()?(n.state=x.DOCTYPE,(n.doctype||n.sawRoot)&&L(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):">"===a?(R(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=x.TEXT):E(d,a)?(n.state=x.SGML_DECL_QUOTED,n.sgmlDecl+=a):n.sgmlDecl+=a;continue;case x.SGML_DECL_QUOTED:a===n.q&&(n.state=x.SGML_DECL,n.q=""),n.sgmlDecl+=a;continue;case x.DOCTYPE:">"===a?(n.state=x.TEXT,R(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=a,"["===a?n.state=x.DOCTYPE_DTD:E(d,a)&&(n.state=x.DOCTYPE_QUOTED,n.q=a));continue;case x.DOCTYPE_QUOTED:n.doctype+=a,a===n.q&&(n.q="",n.state=x.DOCTYPE);continue;case x.DOCTYPE_DTD:n.doctype+=a,"]"===a?n.state=x.DOCTYPE:E(d,a)&&(n.state=x.DOCTYPE_DTD_QUOTED,n.q=a);continue;case x.DOCTYPE_DTD_QUOTED:n.doctype+=a,a===n.q&&(n.state=x.DOCTYPE_DTD,n.q="");continue;case x.COMMENT:"-"===a?n.state=x.COMMENT_ENDING:n.comment+=a;continue;case x.COMMENT_ENDING:"-"===a?(n.state=x.COMMENT_ENDED,n.comment=O(n.opt,n.comment),n.comment&&R(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+a,n.state=x.COMMENT);continue;case x.COMMENT_ENDED:">"!==a?(L(n,"Malformed comment"),n.comment+="--"+a,n.state=x.COMMENT):n.state=x.TEXT;continue;case x.CDATA:"]"===a?n.state=x.CDATA_ENDING:n.cdata+=a;continue;case x.CDATA_ENDING:"]"===a?n.state=x.CDATA_ENDING_2:(n.cdata+="]"+a,n.state=x.CDATA);continue;case x.CDATA_ENDING_2:">"===a?(n.cdata&&R(n,"oncdata",n.cdata),R(n,"onclosecdata"),n.cdata="",n.state=x.TEXT):"]"===a?n.cdata+="]":(n.cdata+="]]"+a,n.state=x.CDATA);continue;case x.PROC_INST:"?"===a?n.state=x.PROC_INST_ENDING:E(u,a)?n.state=x.PROC_INST_BODY:n.procInstName+=a;continue;case x.PROC_INST_BODY:if(!n.procInstBody&&E(u,a))continue;"?"===a?n.state=x.PROC_INST_ENDING:n.procInstBody+=a;continue;case x.PROC_INST_ENDING:">"===a?(R(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=x.TEXT):(n.procInstBody+="?"+a,n.state=x.PROC_INST_BODY);continue;case x.OPEN_TAG:E(v,a)?n.tagName+=a:(N(n),">"===a?B(n):"/"===a?n.state=x.OPEN_TAG_SLASH:(T(u,a)&&L(n,"Invalid character in tag name"),n.state=x.ATTRIB));continue;case x.OPEN_TAG_SLASH:">"===a?(B(n,!0),U(n)):(L(n,"Forward-slash in opening tag not followed by >"),n.state=x.ATTRIB);continue;case x.ATTRIB:if(E(u,a))continue;">"===a?B(n):"/"===a?n.state=x.OPEN_TAG_SLASH:E(g,a)?(n.attribName=a,n.attribValue="",n.state=x.ATTRIB_NAME):L(n,"Invalid attribute name");continue;case x.ATTRIB_NAME:"="===a?n.state=x.ATTRIB_VALUE:">"===a?(L(n,"Attribute without value"),n.attribValue=n.attribName,F(n),B(n)):E(u,a)?n.state=x.ATTRIB_NAME_SAW_WHITE:E(v,a)?n.attribName+=a:L(n,"Invalid attribute name");continue;case x.ATTRIB_NAME_SAW_WHITE:if("="===a)n.state=x.ATTRIB_VALUE;else{if(E(u,a))continue;L(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",R(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",">"===a?B(n):E(g,a)?(n.attribName=a,n.state=x.ATTRIB_NAME):(L(n,"Invalid attribute name"),n.state=x.ATTRIB)}continue;case x.ATTRIB_VALUE:if(E(u,a))continue;E(d,a)?(n.q=a,n.state=x.ATTRIB_VALUE_QUOTED):(L(n,"Unquoted attribute value"),n.state=x.ATTRIB_VALUE_UNQUOTED,n.attribValue=a);continue;case x.ATTRIB_VALUE_QUOTED:if(a!==n.q){"&"===a?n.state=x.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=a;continue}F(n),n.q="",n.state=x.ATTRIB_VALUE_CLOSED;continue;case x.ATTRIB_VALUE_CLOSED:E(u,a)?n.state=x.ATTRIB:">"===a?B(n):"/"===a?n.state=x.OPEN_TAG_SLASH:E(g,a)?(L(n,"No whitespace between attributes"),n.attribName=a,n.attribValue="",n.state=x.ATTRIB_NAME):L(n,"Invalid attribute name");continue;case x.ATTRIB_VALUE_UNQUOTED:if(T(h,a)){"&"===a?n.state=x.ATTRIB_VALUE_ENTITY_U:n.attribValue+=a;continue}F(n),">"===a?B(n):n.state=x.ATTRIB;continue;case x.CLOSE_TAG:if(n.tagName)">"===a?U(n):E(v,a)?n.tagName+=a:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=x.SCRIPT):(T(u,a)&&L(n,"Invalid tagname in closing tag"),n.state=x.CLOSE_TAG_SAW_WHITE);else{if(E(u,a))continue;T(g,a)?n.script?(n.script+="</"+a,n.state=x.SCRIPT):L(n,"Invalid tagname in closing tag."):n.tagName=a}continue;case x.CLOSE_TAG_SAW_WHITE:if(E(u,a))continue;">"===a?U(n):L(n,"Invalid characters in closing tag");continue;case x.TEXT_ENTITY:case x.ATTRIB_VALUE_ENTITY_Q:case x.ATTRIB_VALUE_ENTITY_U:var l,c;switch(n.state){case x.TEXT_ENTITY:l=x.TEXT,c="textNode";break;case x.ATTRIB_VALUE_ENTITY_Q:l=x.ATTRIB_VALUE_QUOTED,c="attribValue";break;case x.ATTRIB_VALUE_ENTITY_U:l=x.ATTRIB_VALUE_UNQUOTED,c="attribValue"}";"===a?(n[c]+=j(n),n.entity="",n.state=l):E(n.entity.length?_:y,a)?n.entity+=a:(L(n,"Invalid character in entity name"),n[c]+="&"+n.entity+a,n.entity="",n.state=l);continue;default:throw new Error(n,"Unknown state: "+n.state)}n.position>=n.bufferCheckPosition&&function(e){for(var n=Math.max(t.MAX_BUFFER_LENGTH,10),r=0,a=0,o=i.length;a<o;a++){var s=e[i[a]].length;if(s>n)switch(i[a]){case"textNode":I(e);break;case"cdata":R(e,"oncdata",e.cdata),e.cdata="";break;case"script":R(e,"onscript",e.script),e.script="";break;default:D(e,"Max buffer length exceeded: "+i[a])}r=Math.max(r,s)}var u=t.MAX_BUFFER_LENGTH-r;e.bufferCheckPosition=u+e.position}(n);return n},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;I(e=this),""!==e.cdata&&(R(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(R(e,"onscript",e.script),e.script="")}};try{r=n(894).Stream}catch(e){r=function(){}}var o=t.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function s(e,t){if(!(this instanceof s))return new s(e,t);r.apply(this),this._parser=new a(e,t),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,o.forEach((function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){if(!t)return n.removeAllListeners(e),n._parser["on"+e]=t,t;n.on(e,t)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(r.prototype,{constructor:{value:s}}),s.prototype.write=function(t){if("function"==typeof e&&"function"==typeof e.isBuffer&&e.isBuffer(t)){if(!this._decoder){var r=n(136).StringDecoder;this._decoder=new r("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},s.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},s.prototype.on=function(e,t){var n=this;return n._parser["on"+e]||-1===o.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),r.prototype.on.call(n,e,t)};var u="\r\n\t ",l="0124356789",c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",d="'\"",h=u+">",f="http://www.w3.org/XML/1998/namespace",p="http://www.w3.org/2000/xmlns/",m={xml:f,xmlns:p};u=b(u),l=b(l),c=b(c);var g=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,v=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function b(e){return e.split("").reduce((function(e,t){return e[t]=!0,e}),{})}function E(e,t){return function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}(e)?!!t.match(e):e[t]}function T(e,t){return!E(e,t)}d=b(d),h=b(h);var S,w,A,x=0;for(var M in t.STATE={BEGIN:x++,BEGIN_WHITESPACE:x++,TEXT:x++,TEXT_ENTITY:x++,OPEN_WAKA:x++,SGML_DECL:x++,SGML_DECL_QUOTED:x++,DOCTYPE:x++,DOCTYPE_QUOTED:x++,DOCTYPE_DTD:x++,DOCTYPE_DTD_QUOTED:x++,COMMENT_STARTING:x++,COMMENT:x++,COMMENT_ENDING:x++,COMMENT_ENDED:x++,CDATA:x++,CDATA_ENDING:x++,CDATA_ENDING_2:x++,PROC_INST:x++,PROC_INST_BODY:x++,PROC_INST_ENDING:x++,OPEN_TAG:x++,OPEN_TAG_SLASH:x++,ATTRIB:x++,ATTRIB_NAME:x++,ATTRIB_NAME_SAW_WHITE:x++,ATTRIB_VALUE:x++,ATTRIB_VALUE_QUOTED:x++,ATTRIB_VALUE_CLOSED:x++,ATTRIB_VALUE_UNQUOTED:x++,ATTRIB_VALUE_ENTITY_Q:x++,ATTRIB_VALUE_ENTITY_U:x++,CLOSE_TAG:x++,CLOSE_TAG_SAW_WHITE:x++,SCRIPT:x++,SCRIPT_ENDING:x++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var n=t.ENTITIES[e],r="number"==typeof n?String.fromCharCode(n):n;t.ENTITIES[e]=r})),t.STATE)t.STATE[t.STATE[M]]=M;function C(e,t,n){e[t]&&e[t](n)}function R(e,t,n){e.textNode&&I(e),C(e,t,n)}function I(e){e.textNode=O(e.opt,e.textNode),e.textNode&&C(e,"ontext",e.textNode),e.textNode=""}function O(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function D(e,t){return I(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,C(e,"onerror",t),e}function P(e){return e.sawRoot&&!e.closedRoot&&L(e,"Unclosed root tag"),e.state!==x.BEGIN&&e.state!==x.BEGIN_WHITESPACE&&e.state!==x.TEXT&&D(e,"Unexpected end"),I(e),e.c="",e.closed=!0,C(e,"onend"),a.call(e,e.strict,e.opt),e}function L(e,t){if("object"!=typeof e||!(e instanceof a))throw new Error("bad call to strictFail");e.strict&&D(e,t)}function N(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,R(e,"onopentagstart",n)}function k(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i}}function F(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=k(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==f)L(e,"xml: prefix must be bound to "+f+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==p)L(e,"xmlns: prefix must be bound to "+p+"\nActual: "+e.attribValue);else{var i=e.tag,a=e.tags[e.tags.length-1]||e;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,R(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function B(e,t){if(e.opt.xmlns){var n=e.tag,r=k(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(L(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var i=e.tags[e.tags.length-1]||e;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach((function(t){R(e,"onopennamespace",{prefix:t,uri:n.ns[t]})}));for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a],u=s[0],l=s[1],c=k(u,!0),d=c.prefix,h=c.local,f=""===d?"":n.ns[d]||"",p={name:u,value:l,prefix:d,local:h,uri:f};d&&"xmlns"!==d&&!f&&(L(e,"Unbound namespace prefix: "+JSON.stringify(d)),p.uri=d),e.tag.attributes[u]=p,R(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),R(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=x.TEXT:e.state=x.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function U(e){if(!e.tagName)return L(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=x.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=x.SCRIPT);R(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--;){if(e.tags[t].name===r)break;L(e,"Unexpected close tag")}if(t<0)return L(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=x.TEXT);e.tagName=n;for(var i=e.tags.length;i-- >t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,R(e,"onclosetag",e.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var u=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==u.ns&&Object.keys(a.ns).forEach((function(t){var n=a.ns[t];R(e,"onclosenamespace",{prefix:t,uri:n})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=x.TEXT}function j(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),i=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),i=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),i.toLowerCase()!==n?(L(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function G(e,t){"<"===t?(e.state=x.OPEN_WAKA,e.startTagPosition=e.position):T(u,t)&&(L(e,"Non-whitespace before first tag."),e.textNode=t,e.state=x.TEXT)}function H(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}x=t.STATE,String.fromCodePoint||(S=String.fromCharCode,w=Math.floor,A=function(){var e,t,n=16384,r=[],i=-1,a=arguments.length;if(!a)return"";for(var o="";++i<a;){var s=Number(arguments[i]);if(!isFinite(s)||s<0||s>1114111||w(s)!==s)throw RangeError("Invalid code point: "+s);s<=65535?r.push(s):(e=55296+((s-=65536)>>10),t=s%1024+56320,r.push(e,t)),(i+1===a||r.length>n)&&(o+=S.apply(null,r),r.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:A,configurable:!0,writable:!0}):String.fromCodePoint=A)}(t)}).call(this,n(106).Buffer)},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=l(e),r=n[0],o=n[1],s=new a(function(e,t,n){return 3*(t+n)/4-n}(0,r,o)),u=0,c=o>0?r-4:r,d=0;d<c;d+=4)t=i[e.charCodeAt(d)]<<18|i[e.charCodeAt(d+1)]<<12|i[e.charCodeAt(d+2)]<<6|i[e.charCodeAt(d+3)],s[u++]=t>>16&255,s[u++]=t>>8&255,s[u++]=255&t;2===o&&(t=i[e.charCodeAt(d)]<<2|i[e.charCodeAt(d+1)]>>4,s[u++]=255&t);1===o&&(t=i[e.charCodeAt(d)]<<10|i[e.charCodeAt(d+1)]<<4|i[e.charCodeAt(d+2)]>>2,s[u++]=t>>8&255,s[u++]=255&t);return s},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],o=16383,s=0,u=n-i;s<u;s+=o)a.push(c(e,s,s+o>u?u:s+o));1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var i,a,o=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,d=n?i-1:0,h=n?-1:1,f=e[t+d];for(d+=h,a=f&(1<<-c)-1,f>>=-c,c+=s;c>0;a=256*a+e[t+d],d+=h,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;c>0;o=256*o+e[t+d],d+=h,c-=8);if(0===a)a=1-l;else{if(a===u)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),a-=l}return(f?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,u,l=8*a-i-1,c=(1<<l)-1,d=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+d>=1?h/u:h*Math.pow(2,1-d))*u>=2&&(o++,u/=2),o+d>=c?(s=0,o=c):o+d>=1?(s=(t*u-1)*Math.pow(2,i),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+f]=255&s,f+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[n+f]=255&o,f+=p,o/=256,l-=8);e[n+f-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){e.exports=i;var r=n(133).EventEmitter;function i(){r.call(this)}n(72)(i,r),i.Readable=n(134),i.Writable=n(903),i.Duplex=n(904),i.Transform=n(905),i.PassThrough=n(906),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",a),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",u));var o=!1;function s(){o||(o=!0,e.end())}function u(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(c(),0===r.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",i),e.removeListener("drain",a),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",l),e.removeListener("error",l),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",l),e.on("error",l),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){},function(e,t,n){"use strict";var r=n(109).Buffer,i=n(898);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t,n,i,a=r.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,n=a,i=s,t.copy(n,i),s+=o.data.length,o=o.next;return a},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new a(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(900),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(27))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i,a,o,s,u=1,l={},c=!1,d=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){a.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,r=function(e){var t=d.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),r=function(t){e.postMessage(o+t,"*")}),h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return l[u]=i,r(u),u++},h.clearImmediate=f}function f(e){delete l[e]}function p(e){if(c)setTimeout(p,0,e);else{var t=l[e];if(t){c=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{f(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(27),n(107))},function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,n(27))},function(e,t,n){"use strict";e.exports=a;var r=n(181),i=n(92);function a(e){if(!(this instanceof a))return new a(e);r.call(this,e)}i.inherits=n(72),i.inherits(a,r),a.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){e.exports=n(135)},function(e,t,n){e.exports=n(60)},function(e,t,n){e.exports=n(134).Transform},function(e,t,n){e.exports=n(134).PassThrough},function(e,t,n){!function(e,t,n){function r(e,t,s){var l;if("region"===s.kind)(l=document.createElement("div")).style.position="absolute";else if("body"===s.kind)l=document.createElement("div");else if("div"===s.kind)l=document.createElement("div");else if("image"===s.kind){if(l=document.createElement("img"),null!==e.imgResolver&&null!==s.src){var c=e.imgResolver(s.src,l);c&&(l.src=c),l.height=e.regionH,l.width=e.regionW}}else if("p"===s.kind)l=document.createElement("p");else if("span"===s.kind){if("container"===s.styleAttrs[n.byName.ruby.qname])l=document.createElement("ruby"),e.ruby=!0;else if("base"===s.styleAttrs[n.byName.ruby.qname])l=document.createElement("rb");else if("text"===s.styleAttrs[n.byName.ruby.qname])l=document.createElement("rt");else if("baseContainer"===s.styleAttrs[n.byName.ruby.qname])l=document.createElement("rbc");else if("textContainer"===s.styleAttrs[n.byName.ruby.qname])l=document.createElement("rtc");else{if("delimiter"===s.styleAttrs[n.byName.ruby.qname])return;l=document.createElement("span")}var d=s.styleAttrs[n.byName.textEmphasis.qname];d&&"none"!==d.style&&(e.textEmphasis=!0)}else"br"===s.kind&&(l=document.createElement("br"));if(l){for(var h in t.appendChild(l),l.style.margin="0",u){var f=u[h],p=s.styleAttrs[f.qname];void 0!==p&&null!==f.map&&f.map(e,l,s,p)}var m=l;if("region"===s.kind){var g=s.styleAttrs[n.byName.writingMode.qname];"lrtb"===g||"lr"===g?(e.ipd="lr",e.bpd="tb"):"rltb"===g||"rl"===g?(e.ipd="rl",e.bpd="tb"):"tblr"===g?(e.ipd="tb",e.bpd="lr"):"tbrl"!==g&&"tb"!==g||(e.ipd="tb",e.bpd="rl")}var v=s.styleAttrs[n.byName.linePadding.qname];if(v&&!v.isZero()){var y=v.toUsedLength(e.w,e.h);if(y>0){var _=Math.ceil(y)+"px";"tb"===e.bpd?(m.style.paddingLeft=_,m.style.paddingRight=_):(m.style.paddingTop=_,m.style.paddingBottom=_),e.lp=v}}var b=s.styleAttrs[n.byName.multiRowAlign.qname];if(b&&"auto"!==b){var E=document.createElement("span");E.style.display="inline-block",E.style.textAlign=b,l.appendChild(E),m=E,e.mra=b}var T=s.styleAttrs[n.byName.rubyReserve.qname];if(T&&"none"!==T[0]&&(e.rubyReserve=T),s.styleAttrs[n.byName.fillLineGap.qname]&&(e.flg=!0),"span"===s.kind&&s.text)if(n.byName.textCombine.qname in s.styleAttrs&&"all"===s.styleAttrs[n.byName.textCombine.qname][0])l.textContent=s.text;else for(var S="",w=0;w<s.text.length;w++){S+=s.text.charAt(w);var A=s.text.charCodeAt(w);if(A<55296||A>56319||w===s.text.length){var x=document.createElement("span");x.textContent=S,l.appendChild(x),S=""}}for(var M in s.contents)r(e,m,s.contents[M]);var C=[];if((e.lp||e.mra||e.flg||e.ruby||e.textEmphasis||e.rubyReserve)&&"p"===s.kind&&(o(e,m,C,null),e.rubyReserve&&(!function(e,t){for(var n=0;n<e.length;n++){var r,i,a=document.createElement("ruby"),o=document.createElement("rb");o.textContent="",a.appendChild(o);var s=t.rubyReserve[1].toUsedLength(t.w,t.h)+"px";"both"===t.rubyReserve[0]?((r=document.createElement("rtc")).style.rubyPosition="under",r.textContent="",r.style.fontSize=s,(i=document.createElement("rtc")).style.rubyPosition="over",i.textContent="",i.style.fontSize=s,a.appendChild(r),a.appendChild(i)):((r=document.createElement("rtc")).textContent="",r.style.fontSize=s,"after"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&n>0?r.style.rubyPosition="tb"===t.bpd||"rl"===t.bpd?"under":"over":r.style.rubyPosition="tb"===t.bpd||"rl"===t.bpd?"over":"under",a.appendChild(r));e[n].elements[0].node.parentElement.insertBefore(a,e[n].elements[0].node)}}(C,e),e.rubyReserve=null),(e.ruby||e.rubyReserve)&&(!function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].rbc.length;r++){var i;if(!e[n].rbc[r].style.rubyPosition)i="tb"===t.bpd||"rl"===t.bpd?0===n?"over":"under":0===n?"under":"over",e[n].rbc[r].style.rubyPosition=i}}(C,e),e.ruby=null),e.textEmphasis&&(!function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].te.length;r++){var i;if(!e[n].te[r].style.textEmphasisPosition||"none"===e[n].te[r].style.textEmphasisPosition)i="tb"===t.bpd?0===n?"left over":"left under":"rl"===t.bpd?0===n?"right under":"left under":0===n?"left under":"right under",e[n].te[r].style.textEmphasisPosition=i}}(C,e),e.textEmphasis=null),e.mra&&(!function(e){for(var t=0;t<e.length-1;t++){var n=e[t].elements.length;if(0!==n&&!1===e[t].br){var r=document.createElement("br"),i=e[t].elements[n-1].node;i.parentElement.insertBefore(r,i.nextSibling)}}}(C),e.mra=null),e.lp&&(!function(e,t,n){for(var r in e){var i=e[r].elements.length,a=e[r].elements[e[r].start_elem],o=e[r].elements[e[r].end_elem],s=Math.ceil(t)+"px",u="-"+Math.ceil(t)+"px";0!==i&&("lr"===n.ipd?(a.node.style.borderLeftColor=a.bgcolor||"#00000000",a.node.style.borderLeftStyle="solid",a.node.style.borderLeftWidth=s,a.node.style.marginLeft=u):"rl"===n.ipd?(a.node.style.borderRightColor=a.bgcolor||"#00000000",a.node.style.borderRightStyle="solid",a.node.style.borderRightWidth=s,a.node.style.marginRight=u):"tb"===n.ipd&&(a.node.style.borderTopColor=a.bgcolor||"#00000000",a.node.style.borderTopStyle="solid",a.node.style.borderTopWidth=s,a.node.style.marginTop=u),"lr"===n.ipd?(o.node.style.borderRightColor=o.bgcolor||"#00000000",o.node.style.borderRightStyle="solid",o.node.style.borderRightWidth=s,o.node.style.marginRight=u):"rl"===n.ipd?(o.node.style.borderLeftColor=o.bgcolor||"#00000000",o.node.style.borderLeftStyle="solid",o.node.style.borderLeftWidth=s,o.node.style.marginLeft=u):"tb"===n.ipd&&(o.node.style.borderBottomColor=o.bgcolor||"#00000000",o.node.style.borderBottomStyle="solid",o.node.style.borderBottomWidth=s,o.node.style.marginBottom=u))}}(C,e.lp.toUsedLength(e.w,e.h),e),e.lp=null),e.flg)){var R=a(m.getBoundingClientRect(),e);!function(e,t,n,r){for(var i=Math.sign(n-t),a=0;a<=e.length;a++){var o,s,u;if(o=0===a?t:a===e.length?n:(e[a].before+e[a-1].after)/2,a>0)for(var l=0;l<e[a-1].elements.length;l++)null!==e[a-1].elements[l].bgcolor&&i*((u=e[a-1].elements[l]).after-o)<0&&(s=Math.ceil(Math.abs(o-u.after))+"px",u.node.style.backgroundColor=u.bgcolor,"lr"===r.bpd?u.node.style.paddingRight=s:"rl"===r.bpd?u.node.style.paddingLeft=s:"tb"===r.bpd&&(u.node.style.paddingBottom=s));if(a<e.length)for(var c=0;c<e[a].elements.length;c++)null!==(u=e[a].elements[c]).bgcolor&&i*(u.before-o)>0&&(s=Math.ceil(Math.abs(u.before-o))+"px",u.node.style.backgroundColor=u.bgcolor,"lr"===r.bpd?u.node.style.paddingLeft=s:"rl"===r.bpd?u.node.style.paddingRight=s:"tb"===r.bpd&&(u.node.style.paddingTop=s))}}(C,R.before,R.after,e),e.flg=null}if("region"===s.kind&&(o(e,m,C),"tb"===e.bpd&&e.enableRollUp&&s.contents.length>0&&"after"===s.styleAttrs[n.byName.displayAlign.qname])){var I=new i(""===s.id?"_":s.id,C);if(e.currentISDState[I.id]=I,e.previousISDState&&I.id in e.previousISDState&&e.previousISDState[I.id].plist.length>0&&I.plist.length>1&&I.plist[I.plist.length-2].text===e.previousISDState[I.id].plist[e.previousISDState[I.id].plist.length-1].text){var O=l.firstElementChild,D=I.plist[I.plist.length-1].after-I.plist[I.plist.length-1].before;O.style.bottom="-"+D+"px",O.style.transition="transform 0.4s",O.style.position="relative",O.style.transform="translateY(-"+D+"px)"}}}else!function(e,t){if(e&&e.error&&e.error(t))throw t}(e.errorHandler,"Error processing ISD element kind: "+s.kind)}function i(e,t){this.id=e,this.plist=t}function a(e,t){var n={before:null,after:null,start:null,end:null};return"tb"===t.bpd?(n.before=e.top,n.after=e.bottom,"lr"===t.ipd?(n.start=e.left,n.end=e.right):(n.start=e.right,n.end=e.left)):"lr"===t.bpd?(n.before=e.left,n.after=e.right,n.start=e.top,n.end=e.bottom):"rl"===t.bpd&&(n.before=e.right,n.after=e.left,n.start=e.top,n.end=e.bottom),n}function o(e,t,n,r){if("rt"!==t.localName&&"rtc"!==t.localName){var i,s,u,l,c=t.style.backgroundColor||r;if(0===t.childElementCount)if("span"===t.localName||"rb"===t.localName){var d=t.getBoundingClientRect();if(0===d.height||0===d.width)return;var h=a(d,e);if(0!==n.length&&(i=h.before,s=h.after,u=n[n.length-1].before,l=n[n.length-1].after,s<l&&i>u||l<=s&&u>=i)){var f=Math.sign(h.after-h.before),p=Math.sign(h.end-h.start);f*(h.before-n[n.length-1].before)<0&&(n[n.length-1].before=h.before),f*(h.after-n[n.length-1].after)>0&&(n[n.length-1].after=h.after),p*(h.start-n[n.length-1].start)<0&&(n[n.length-1].start=h.start,n[n.length-1].start_elem=n[n.length-1].elements.length),p*(h.end-n[n.length-1].end)>0&&(n[n.length-1].end=h.end,n[n.length-1].end_elem=n[n.length-1].elements.length)}else n.push({before:h.before,after:h.after,start:h.start,end:h.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});n[n.length-1].text+=t.textContent,n[n.length-1].elements.push({node:t,bgcolor:c,before:h.before,after:h.after})}else"br"===t.localName&&0!==n.length&&(n[n.length-1].br=!0);else for(var m=t.firstChild;m;)m.nodeType===Node.ELEMENT_NODE&&(o(e,m,n,c),"ruby"===m.localName||"rtc"===m.localName?n.length>0&&n[n.length-1].rbc.push(m):"span"===m.localName&&m.style.textEmphasisStyle&&"none"!==m.style.textEmphasisStyle&&n.length>0&&n[n.length-1].te.push(m)),m=m.nextSibling}}function s(e,t){this.qname=e,this.map=t}e.render=function(e,t,n,i,a,o,s,u,l){var c=i||t.clientHeight,d=a||t.clientWidth;if(null!==e.aspectRatio){var h=c*e.aspectRatio;h>d?c=Math.round(d/e.aspectRatio):d=h}var f=document.createElement("div");f.style.position="relative",f.style.width=d+"px",f.style.height=c+"px",f.style.margin="auto",f.style.top=0,f.style.bottom=0,f.style.left=0,f.style.right=0,f.style.zIndex=0;var p={h:c,w:d,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:o||!1,isd:e,errorHandler:s,previousISDState:u,enableRollUp:l||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};for(var m in t.appendChild(f),e.contents)r(p,f,e.contents[m]);return p.currentISDState};var u=[new s("http://www.w3.org/ns/ttml#styling backgroundColor",(function(e,t,n,r){0!==r[3]&&(t.style.backgroundColor="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")")})),new s("http://www.w3.org/ns/ttml#styling color",(function(e,t,n,r){t.style.color="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")"})),new s("http://www.w3.org/ns/ttml#styling direction",(function(e,t,n,r){t.style.direction=r})),new s("http://www.w3.org/ns/ttml#styling display",(function(e,t,n,r){})),new s("http://www.w3.org/ns/ttml#styling displayAlign",(function(e,t,n,r){t.style.display="flex",t.style.flexDirection="column","before"===r?t.style.justifyContent="flex-start":"center"===r?t.style.justifyContent="center":"after"===r&&(t.style.justifyContent="flex-end")})),new s("http://www.w3.org/ns/ttml#styling extent",(function(e,t,n,r){e.regionH=r.h.toUsedLength(e.w,e.h),e.regionW=r.w.toUsedLength(e.w,e.h);var i=0,a=0,o=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];o&&(i=o[0].toUsedLength(e.w,e.h)+o[2].toUsedLength(e.w,e.h),a=o[1].toUsedLength(e.w,e.h)+o[3].toUsedLength(e.w,e.h)),t.style.height=e.regionH-i+"px",t.style.width=e.regionW-a+"px"})),new s("http://www.w3.org/ns/ttml#styling fontFamily",(function(e,t,n,r){var i=[];for(var a in r)"monospaceSerif"===r[a]?(i.push("Courier New"),i.push('"Liberation Mono"'),i.push("Courier"),i.push("monospace")):"proportionalSansSerif"===r[a]?(i.push("Arial"),i.push("Helvetica"),i.push('"Liberation Sans"'),i.push("sans-serif")):"monospace"===r[a]?i.push("monospace"):"sansSerif"===r[a]?i.push("sans-serif"):"serif"===r[a]?i.push("serif"):"monospaceSansSerif"===r[a]?(i.push("Consolas"),i.push("monospace")):"proportionalSerif"===r[a]?i.push("serif"):i.push(r[a]);t.style.fontFamily=i.join(",")})),new s("http://www.w3.org/ns/ttml#styling shear",(function(e,t,n,r){if(0!==r){var i=-.9*r;"tb"===e.bpd?t.style.transform="skewX("+i+"deg)":t.style.transform="skewY("+i+"deg)"}})),new s("http://www.w3.org/ns/ttml#styling fontSize",(function(e,t,n,r){t.style.fontSize=r.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling fontStyle",(function(e,t,n,r){t.style.fontStyle=r})),new s("http://www.w3.org/ns/ttml#styling fontWeight",(function(e,t,n,r){t.style.fontWeight=r})),new s("http://www.w3.org/ns/ttml#styling lineHeight",(function(e,t,n,r){t.style.lineHeight="normal"===r?"normal":r.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling opacity",(function(e,t,n,r){t.style.opacity=r})),new s("http://www.w3.org/ns/ttml#styling origin",(function(e,t,n,r){t.style.top=r.h.toUsedLength(e.w,e.h)+"px",t.style.left=r.w.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling overflow",(function(e,t,n,r){t.style.overflow=r})),new s("http://www.w3.org/ns/ttml#styling padding",(function(e,t,n,r){var i=[];i[0]=r[0].toUsedLength(e.w,e.h)+"px",i[1]=r[3].toUsedLength(e.w,e.h)+"px",i[2]=r[2].toUsedLength(e.w,e.h)+"px",i[3]=r[1].toUsedLength(e.w,e.h)+"px",t.style.padding=i.join(" ")})),new s("http://www.w3.org/ns/ttml#styling position",(function(e,t,n,r){t.style.top=r.h.toUsedLength(e.w,e.h)+"px",t.style.left=r.w.toUsedLength(e.w,e.h)+"px"})),new s("http://www.w3.org/ns/ttml#styling rubyAlign",(function(e,t,n,r){t.style.rubyAlign=r})),new s("http://www.w3.org/ns/ttml#styling rubyPosition",(function(e,t,n,r){var i;"before"!==r&&"after"!==r||(i="tb"===e.bpd||"rl"===e.bpd?"before"===r?"over":"under":"before"===r?"under":"over",t.parentElement.style.rubyPosition=i)})),new s("http://www.w3.org/ns/ttml#styling showBackground",null),new s("http://www.w3.org/ns/ttml#styling textAlign",(function(e,t,r,i){var a,o=r.styleAttrs[n.byName.direction.qname];a="start"===i?"rtl"===o?"right":"left":"end"===i?"rtl"===o?"left":"right":i,t.style.textAlign=a})),new s("http://www.w3.org/ns/ttml#styling textDecoration",(function(e,t,n,r){t.style.textDecoration=r.join(" ").replace("lineThrough","line-through")})),new s("http://www.w3.org/ns/ttml#styling textOutline",(function(e,t,n,r){})),new s("http://www.w3.org/ns/ttml#styling textShadow",(function(e,t,r,i){var a=r.styleAttrs[n.byName.textOutline.qname];if("none"===i&&"none"===a)t.style.textShadow="";else{var o=[];if("none"!==a&&o.push("rgba("+a.color[0].toString()+","+a.color[1].toString()+","+a.color[2].toString()+","+(a.color[3]/255).toString()+") 0px 0px "+a.thickness.toUsedLength(e.w,e.h)+"px"),"none"!==i)for(var s in i)o.push(i[s].x_off.toUsedLength(e.w,e.h)+"px "+i[s].y_off.toUsedLength(e.w,e.h)+"px "+i[s].b_radius.toUsedLength(e.w,e.h)+"px rgba("+i[s].color[0].toString()+","+i[s].color[1].toString()+","+i[s].color[2].toString()+","+(i[s].color[3]/255).toString()+")");t.style.textShadow=o.join(",")}})),new s("http://www.w3.org/ns/ttml#styling textCombine",(function(e,t,n,r){t.style.textCombineUpright=r.join(" ")})),new s("http://www.w3.org/ns/ttml#styling textEmphasis",(function(e,t,n,r){var i;"none"!==r.style?("auto"===r.style?t.style.textEmphasisStyle="filled":t.style.textEmphasisStyle=r.style+" "+r.symbol,("before"===r.position||"after"===r.position)&&(i="tb"===e.bpd?"before"===r.position?"left over":"left under":"rl"===e.bpd?"before"===r.position?"right under":"left under":"before"===r.position?"left under":"right under",t.style.textEmphasisPosition=i)):t.style.textEmphasisStyle="none"})),new s("http://www.w3.org/ns/ttml#styling unicodeBidi",(function(e,t,n,r){var i;i="bidiOverride"===r?"bidi-override":r,t.style.unicodeBidi=i})),new s("http://www.w3.org/ns/ttml#styling visibility",(function(e,t,n,r){t.style.visibility=r})),new s("http://www.w3.org/ns/ttml#styling wrapOption",(function(e,t,n,r){"wrap"===r?"preserve"===n.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===n.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap"})),new s("http://www.w3.org/ns/ttml#styling writingMode",(function(e,t,n,r){"lrtb"===r||"lr"===r||"rltb"===r||"rl"===r?e.writingMode="horizontal-tb":"tblr"===r?e.writingMode="vertical-lr":"tbrl"!==r&&"tb"!==r||(e.writingMode="vertical-rl"),t.style.writingMode=e.writingMode})),new s("http://www.w3.org/ns/ttml#styling zIndex",(function(e,t,n,r){t.style.zIndex=r})),new s("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",(function(e,t,n,r){e.displayForcedOnlyMode&&!1===r&&(t.style.visibility="hidden")}))],l={};for(var c in u)l[u[c].qname]=u[c]}(t,"undefined"==typeof imscNames?n(104):imscNames,"undefined"==typeof imscStyles?n(132):imscStyles,"undefined"==typeof imscUtils?n(105):imscUtils)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e=0;function t(e){for(var t="",n=0;n<e.length;++n){t+=e[n].uchar}return t.length-t.replace(/^\s+/,"").length}function n(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function r(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function i(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?r(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?r(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function a(e){return e.replace(/^\s+/g,"")}function o(e){return e.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(r,s,u,l){var c=null,d=!1,h=-1,f={start:s,end:u,spans:[]},p="style_cea608_white_black",m={},g={},v=[],y=void 0,_=void 0;for(y=0;y<15;++y){var b=l.rows[y],E="",T=null;if(!1===b.isEmpty()){var S=t(b.chars);null===c&&(c={x:S,y1:y,y2:y+1,p:[]}),S!==h&&d&&(c.p.push(f),f={start:s,end:u,spans:[]},c.y2=y,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===m.hasOwnProperty(c.name)?(v.push(c),m[c.name]=c):m[c.name].p.contat(c.p),c={x:S,y1:y,y2:y+1,p:[]});for(var w=0;w<b.chars.length;++w){var A=b.chars[w],x=A.penState;if(null===T||!x.equals(T)){E.trim().length>0&&(f.spans.push({name:p,line:E,row:y}),E="");var M="style_cea608_"+x.foreground+"_"+x.background;x.underline&&(M+="_underline"),x.italics&&(M+="_italics"),g.hasOwnProperty(M)||(g[M]=JSON.parse(JSON.stringify(x))),T=x,p=M}E+=A.uchar}E.trim().length>0&&f.spans.push({name:p,line:E,row:y}),d=!0,h=S}else d=!1,h=-1,c&&(c.p.push(f),f={start:s,end:u,spans:[]},c.y2=y,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===m.hasOwnProperty(c.name)?(v.push(c),m[c.name]=c):m[c.name].p.contat(c.p),c=null)}c&&(c.p.push(f),c.y2=y+1,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===m.hasOwnProperty(c.name)?(v.push(c),m[c.name]=c):m[c.name].p.contat(c.p),c=null);var C=[];for(y=0;y<v.length;++y){var R=v[y],I="sub_cea608_"+e++,O=document.createElement("div");O.id=I;var D=n(R);O.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+D;var P=document.createElement("div");P.className="paragraph bodyStyle",P.style.cssText=i(r);var L=document.createElement("div");L.className="cueUniWrapper",L.style.cssText="unicode-bidi: normal; direction: ltr;";for(var N=0;N<R.p.length;++N){var k=R.p[N],F=0;for(_=0;_<k.spans.length;++_){var B=k.spans[_];if(B.line.length>0){if(0!==_&&F!=B.row){var U=document.createElement("br");U.className="lineBreak",L.appendChild(U)}var j=!1;F===B.row&&(j=!0),F=B.row;var G=g[B.name],H=document.createElement("span");H.className="spanPadding "+B.name+" customSpanColor",H.style.cssText=i(r,G),0!==_&&j?_===k.spans.length-1?H.textContent=o(B.line):H.textContent=B.line:k.spans.length>1&&_<k.spans.length-1&&B.row===k.spans[_+1].row?H.textContent=a(B.line):H.textContent=B.line.trim(),L.appendChild(H)}}}P.appendChild(L),O.appendChild(P);var V={bodyStyle:["%",90]};for(var z in g)g.hasOwnProperty(z)&&(V[z]=["%",90]);C.push({type:"html",start:s,end:u,cueHTMLElement:O,cueID:I,cellResolution:[32,15],isFromCEA608:!0,fontSize:V,lineHeight:{},linePadding:{}})}return C}}}o.__dashjs_factory_name="EmbeddedTextHtmlRender",t.default=a.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(17));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=this.context,t=void 0,n=void 0,r=void 0,a=void 0,o=void 0,s=void 0;function u(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e}function l(e){var t=e.split(a),n=t[1].split(s);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:c(n)}}function c(e){var t={};return e.forEach((function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1];n&&-1!=n.search(/%/)&&(n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line=n),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n)}})),t}function d(e,t){for(var n,r=t,i="",o="";""!==e[r]&&r<e.length;)r++;if((n=r-t)>1)for(var s=0;s<n;s++){if((o=e[t+s]).match(a)){i="";break}i+=o,s!==n-1&&(i+="\n")}else(o=e[t]).match(a)||(i=o);return i}return t={parse:function(e){var t,i=[],s=void 0;if(!e)return i;t=(e=e.split(r)).length,s=-1;for(var c=0;c<t;c++){var h=e[c];if(h.length>0&&"WEBVTT"!==h&&h.match(a)){var f=l(h),p=f.cuePoints,m=f.styles,g=d(e,c+1),v=u(p[0].replace(o,"")),y=u(p[1].replace(o,""));!isNaN(v)&&!isNaN(y)&&v>=s&&y>v?""!==g?(s=v,i.push({start:v,end:y,data:g,styles:m})):n.error("Skipping cue due to empty/malformed cue text"):n.error("Skipping cue due to incorrect cue timing")}}return i}},n=(0,i.default)(e).getInstance().getLogger(t),r=/(?:\r\n|\r|\n)/gm,a=/-->/,o=/(^[\s]+|[\s]+$)/g,s=/\s\b/g,t}o.__dashjs_factory_name="VTTParser",t.default=r.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(2)),i=u(n(17)),a=u(n(16)),o=u(n(18)),s=n(103);function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,r=void 0,u=0;return n={parse:function(e,n,i,a,l){var c="",d=[],h=void 0,f=void 0,p=void 0,m={},g={},v="",y="",_={onOpenTag:function(e,t,n){if("image"===t&&"http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e){if(!n[" imagetype"]||"PNG"!==n[" imagetype"].value)return void r.warn("smpte-tt imagetype != PNG. Discarded");v=n["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){v&&(g[v]=y.trim()),y="",v=""},onText:function(e){v&&(y+=e)}};if(!e)throw c="no ttml data to parse",new Error(c);m.data=e,t.trigger(o.default.TTML_TO_PARSE,m);var b=(0,s.fromXML)(m.data,(function(e){c=e}),_);t.trigger(o.default.TTML_PARSED,{ttmlString:m.data,ttmlDoc:b});var E,T=b.getMediaTimeEvents();for(p=0;p<T.length;p++){var S=(0,s.generateISD)(b,T[p],(function(e){c=e}));S.contents.some((function(e){return e.contents.length}))&&(h=T[p]+n<i?i:T[p]+n)<(f=T[p+1]+n>a?a:T[p+1]+n)&&d.push({start:h,end:f,type:"html",cueID:(E=void 0,E="cue_TTML_"+u,u++,E),isd:S,images:l,embeddedImages:g})}if(""!==c)throw r.error(c),new Error(c);return d}},r=(0,i.default)(e).getInstance().getLogger(n),n}l.__dashjs_factory_name="TTMLParser",t.default=r.default.getSingletonFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(17)),i=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=this.context,n=void 0,i=void 0,a=void 0,o=[],s=e;function u(e,t){o=o.filter((function(n){return!((isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e))}))}return n={getAllBufferRanges:function(){for(var e=[],t=0;t<o.length;t++){var n=o[t];0===e.length||n.start>e[e.length-1].end?e.push({start:n.start,end:n.end}):e[e.length-1].end=n.end}var r={start:function(t){return e[t].start},end:function(t){return e[t].end}};return Object.defineProperty(r,"length",{get:function(){return e.length}}),r},append:function(e){"InitializationSegment"!==e.segmentType?(o.push(e),o.sort((function(e,t){return e.start-t.start})),a=null):a=e,i.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),s&&s({chunk:e})},remove:u,abort:function(){},discharge:function(e,t){var n=function(e,t){return o.filter((function(n){return(isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e)}))}(e,t);return a&&(n.push(a),a=null),u(e,t),n},reset:function(){o=[],a=null,s=null},updateTimestampOffset:function(){},hasDiscontinuitiesAfter:function(){return!1},waitForUpdateEnd:function(e){e()},getBuffer:function(){return this}},i=(0,r.default)(t).getInstance().getLogger(n),n}o.__dashjs_factory_name="PreBufferSink";var s=i.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(2)),i=u(n(17)),a=u(n(51)),o=u(n(9)),s=u(n(36));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var t=this.context,n=e.dashMetrics,r=void 0,u=void 0;return r={getMaxIndex:function(e){var r=(0,a.default)(t).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return r;!function(){if(!n||!n.hasOwnProperty("getCurrentBufferState"))throw new Error(o.default.MISSING_CONFIG_ERROR)}();var i=e.getMediaInfo(),l=e.getMediaType(),c=n.getCurrentBufferState(l),d=e.getScheduleController(),h=e.getAbrController(),f=e.getStreamInfo(),p=f&&f.manifestInfo?f.manifestInfo.isDynamic:null,m=h.getThroughputHistory(),g=m.getSafeAverageThroughput(l,p),v=m.getAverageLatency(l),y=e.useBufferOccupancyABR();return isNaN(g)||!c||y||h.getAbandonmentStateFor(l)!==s.default.ABANDON_LOAD&&(c.state===s.default.BUFFER_LOADED||p)&&(r.quality=h.getQualityForBitrate(i,g,v),d.setTimeToLoadDelay(0),u.debug("["+l+"] requesting switch to index: ",r.quality,"Average throughput",Math.round(g),"kbps"),r.reason={throughput:g,latency:v}),r},reset:function(){}},u=(0,i.default)(t).getInstance().getLogger(r),r}l.__dashjs_factory_name="ThroughputRule",t.default=r.default.getClassFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(16)),i=c(n(18)),a=c(n(2)),o=c(n(17)),s=c(n(51)),u=c(n(9)),l=c(n(36));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,n=(0,r.default)(t).getInstance(),a=e.dashMetrics,c=void 0,d=void 0,h=void 0;function f(){(h={})[u.default.VIDEO]={ignoreCount:2},h[u.default.AUDIO]={ignoreCount:2}}function p(){f()}function m(e){isNaN(e.startTime)||e.mediaType!==u.default.AUDIO&&e.mediaType!==u.default.VIDEO||h[e.mediaType].ignoreCount>0&&h[e.mediaType].ignoreCount--}return c={getMaxIndex:function(e){var n=(0,s.default)(t).create();if(!e||!e.hasOwnProperty("getMediaType"))return n;!function(){if(!a||!a.hasOwnProperty("getCurrentBufferLevel")||!a.hasOwnProperty("getCurrentBufferState"))throw new Error(u.default.MISSING_CONFIG_ERROR)}();var r=e.getMediaType(),i=a.getCurrentBufferState(r),o=e.getRepresentationInfo().fragmentDuration;if(function(e){return h[e].ignoreCount>0}(r)||!o)return n;if(i&&i.state===l.default.BUFFER_EMPTY)d.debug("["+r+"] Switch to index 0; buffer is empty."),n.quality=0,n.reason="InsufficientBufferRule: Buffer is empty";else{var c=e.getMediaInfo(),f=e.getAbrController(),p=f.getThroughputHistory(),m=a.getCurrentBufferLevel(r),g=p.getAverageThroughput(r),v=p.getAverageLatency(r),y=g*(m/o)*.5;n.quality=f.getQualityForBitrate(c,y,v),n.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return n},reset:function(){f(),n.off(i.default.PLAYBACK_SEEKING,p,c),n.off(i.default.BYTES_APPENDED_END_FRAGMENT,m,c)}},d=(0,o.default)(t).getInstance().getLogger(c),f(),n.on(i.default.PLAYBACK_SEEKING,p,c),n.on(i.default.BYTES_APPENDED_END_FRAGMENT,m,c),c}d.__dashjs_factory_name="InsufficientBufferRule",t.default=a.default.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(51)),i=o(n(2)),a=o(n(17));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t=this.context,n=e.mediaPlayerModel,i=e.dashMetrics,o=e.settings,u=void 0,l=void 0,c=void 0,d=void 0,h=void 0;function f(){c={},d={},h=[]}return u={shouldAbandon:function(e){var a=(0,r.default)(t).create(r.default.NO_CHANGE,{name:s.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return a;var u=e.getMediaInfo(),f=e.getMediaType(),p=e.getCurrentRequest();if(!isNaN(p.index)){!function(e,t){c[e]=c[e]||{},c[e][t]=c[e][t]||{}}(f,p.index);var m=n.getStableBufferTime();if(i.getCurrentBufferLevel(f)>m)return a;var g=c[f][p.index];if(null===g||null===p.firstByteDate||d.hasOwnProperty(g.id))return a;if(void 0===g.firstByteTime&&(h[f]=[],g.firstByteTime=p.firstByteDate.getTime(),g.segmentDuration=p.duration,g.bytesTotal=p.bytesTotal,g.id=p.index),g.bytesLoaded=p.bytesLoaded,g.elapsedTime=(new Date).getTime()-g.firstByteTime,g.bytesLoaded>0&&g.elapsedTime>0&&function(e,t){h[e]=h[e]||[],h[e].push(t)}(f,Math.round(8*g.bytesLoaded/g.elapsedTime)),h[f].length>=5&&g.elapsedTime>500&&g.bytesLoaded<g.bytesTotal){var v=h[f].reduce((function(e,t){return e+t}),0);if(g.measuredBandwidthInKbps=Math.round(v/h[f].length),g.estimatedTimeOfDownload=+(8*g.bytesTotal/g.measuredBandwidthInKbps/1e3).toFixed(2),g.estimatedTimeOfDownload<1.8*g.segmentDuration||0===e.getRepresentationInfo().quality)return a;if(!d.hasOwnProperty(g.id)){var y=e.getAbrController(),_=g.bytesTotal-g.bytesLoaded,b=y.getBitrateList(u),E=y.getQualityForBitrate(u,g.measuredBandwidthInKbps*o.get().streaming.abr.bandwidthSafetyFactor),T=y.getMinAllowedIndexFor(f),S=void 0!==T?Math.max(T,E):E;_>g.bytesTotal*b[S].bitrate/b[y.getQualityFor(f)].bitrate&&(a.quality=S,a.reason.throughput=g.measuredBandwidthInKbps,a.reason.fragmentID=g.id,d[g.id]=g,l.debug("["+f+"] frag id",g.id," is asking to abandon and switch to quality to ",S," measured bandwidth was",g.measuredBandwidthInKbps),delete c[f][g.id])}}else g.bytesLoaded===g.bytesTotal&&delete c[f][g.id]}return a},reset:f},l=(0,a.default)(t).getInstance().getLogger(u),f(),u}s.__dashjs_factory_name="AbandonRequestsRule",t.default=i.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(2)),i=o(n(51)),a=o(n(17));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=void 0,n=void 0;return t={getMaxIndex:function(t){var r=(0,i.default)(e).create();if(!t||!t.hasOwnProperty("getDroppedFramesHistory"))return r;var a=t.getDroppedFramesHistory();if(a){for(var o=a.getFrameHistory(),s=0,u=0,l=i.default.NO_CHANGE,c=1;c<o.length;c++)if(o[c]&&(s=o[c].droppedVideoFrames,(u=o[c].totalVideoFrames)>375&&s/u>.15)){l=c-1,n.debug("index: "+l+" Dropped Frames: "+s+" Total Frames: "+u);break}return(0,i.default)(e).create(l,{droppedFrames:s})}return r}},n=(0,a.default)(e).getInstance().getLogger(t),t}s.__dashjs_factory_name="DroppedFramesRule",t.default=r.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(2)),i=o(n(17)),a=o(n(51));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=void 0,n=void 0;return t={getMaxIndex:function(t){for(var r=t?t.getSwitchHistory():null,i=r?r.getSwitchRequests():[],o=0,s=0,u=0,l=(0,a.default)(e).create(),c=0;c<i.length;c++)if(void 0!==i[c]&&(o+=i[c].drops,s+=i[c].noDrops,u+=i[c].dropSize,o+s>=6&&o/s>.075)){l.quality=c>0&&i[c].drops>0?c-1:c,l.reason={index:l.quality,drops:o,noDrops:s,dropSize:u},n.debug("Switch history rule index: "+l.quality+" samples: "+(o+s)+" drops: "+o);break}return l}},n=(0,i.default)(e).getInstance().getLogger(t),t}s.__dashjs_factory_name="SwitchHistoryRule",t.default=r.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(36)),i=c(n(51)),a=c(n(2)),o=n(34),s=c(n(16)),u=c(n(18)),l=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var d=10;function h(e){e=e||{};var t=this.context,n=e.dashMetrics,a=e.mediaPlayerModel,c=(0,s.default)(t).getInstance(),h=void 0,f=void 0,p=void 0;function m(e,t,n){var r=n.reduce((function(e,t,r){return t>n[e]?r:e}),0);if(0===r)return null;var i=Math.max(e,d+2*t.length),a=(n[r]-1)/(i/d-1);return{gp:a,Vp:d/a}}function g(e){var t={},n=e.getMediaInfo().bitrateList.map((function(e){return e.bandwidth})),r=function(e){return e.map((function(e){return Math.log(e)}))}(n);r=r.map((function(e){return e-r[0]+1}));var i=a.getStableBufferTime(),o=m(i,n,r);return o?(t.state=1,t.bitrates=n,t.utilities=r,t.stableBufferTime=i,t.Vp=o.Vp,t.gp=o.gp,t.lastQuality=0,v(t)):t.state=0,t}function v(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function y(e,t){var r=a.getStableBufferTime();if(e.stableBufferTime!==r){var i=m(r,e.bitrates,e.utilities);if(i.Vp!==e.Vp||i.gp!==e.gp){var o=n.getCurrentBufferLevel(t),s=o+e.placeholderBuffer;s-=d,s*=i.Vp/e.Vp,s+=d,e.stableBufferTime=r,e.Vp=i.Vp,e.gp=i.gp,e.placeholderBuffer=Math.max(0,s-o)}}}function _(e,t){return e.Vp*(e.utilities[t]+e.gp)}function b(e,t){for(var n=e.bitrates[t],r=e.utilities[t],i=0,a=t-1;a>=0;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],u=e.Vp*(e.gp+(n*s-o*r)/(n-o));i=Math.max(i,u)}return i}function E(){for(var e in p)p.hasOwnProperty(e)&&2===p[e].state&&(p[e].placeholderBuffer=0)}function T(){for(var e in p)if(p.hasOwnProperty(e)){var t=p[e];0!==t.state&&(t.state=1,v(t))}}function S(){}function w(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=p[e.chunk.mediaInfo.type];if(t&&0!==t.state){var n=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,x(t,e.chunk.mediaInfo.type)}}}function A(e){if(e&&e.metric===r.default.HTTP_REQUEST&&e.value&&e.value.type===o.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=p[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),x(t,e.mediaType))}}function x(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=.99,!isNaN(e.lastSegmentFinishTimeMs)){var r=n.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),i=_(e,e.lastQuality),a=Math.max(0,i-r);e.placeholderBuffer=Math.min(a,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function M(e){if(e){var t=p[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function C(e){if(e){var t=p[e.mediaType];if(t&&0!==t.state){var r=n.getCurrentBufferLevel(e.mediaType),i=void 0;i=t.abrQuality>0?b(t,t.abrQuality):d;var a=Math.max(0,i-r);t.placeholderBuffer=Math.min(t.placeholderBuffer,a)}}}function R(){p={}}return h={getMaxIndex:function(e){var r=(0,i.default)(t).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return r;var a=e.getMediaInfo(),o=e.getMediaType(),s=e.getScheduleController(),u=e.getStreamInfo(),l=e.getAbrController(),c=l.getThroughputHistory(),d=u?u.id:null,h=u&&u.manifestInfo&&u.manifestInfo.isDynamic,m=e.useBufferOccupancyABR();if(r.reason=r.reason||{},!m)return r;s.setTimeToLoadDelay(0);var E=function(e){var t=e.getMediaType(),n=p[t];return n?0!==n.state&&y(n,t):(n=g(e),p[t]=n),n}(e);if(0===E.state)return r;var T=n.getCurrentBufferLevel(o),S=c.getAverageThroughput(o,h),w=c.getSafeAverageThroughput(o,h),A=c.getAverageLatency(o),x=void 0;if(r.reason.state=E.state,r.reason.throughput=S,r.reason.latency=A,isNaN(S))return r;switch(E.state){case 1:x=l.getQualityForBitrate(a,w,A),r.quality=x,r.reason.throughput=w,E.placeholderBuffer=Math.max(0,b(E,x)-T),E.lastQuality=x,!isNaN(E.lastSegmentDurationS)&&T>=E.lastSegmentDurationS&&(E.state=2);break;case 2:!function(e,t){var n=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var r=.001*(n-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,r)}}else{var i=.001*(n-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,i)}e.lastCallTimeMs=n,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,y(e,t)}(E,o),x=function(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||o>=i)&&(i=o,r=a)}return r}(E,T+E.placeholderBuffer);var M=l.getQualityForBitrate(a,w,A);x>E.lastQuality&&x>M&&(x=Math.max(M,E.lastQuality));var C=Math.max(0,T+E.placeholderBuffer-_(E,x));C<=E.placeholderBuffer?(E.placeholderBuffer-=C,C=0):(C-=E.placeholderBuffer,E.placeholderBuffer=0,x<l.getTopQualityIndexFor(o,d)?s.setTimeToLoadDelay(1e3*C):C=0),r.quality=x,r.reason.throughput=S,r.reason.latency=A,r.reason.bufferLevel=T,r.reason.placeholderBuffer=E.placeholderBuffer,r.reason.delay=C,E.lastQuality=x;break;default:f.debug("BOLA ABR rule invoked in bad state."),r.quality=l.getQualityForBitrate(a,w,A),r.reason.state=E.state,r.reason.throughput=w,r.reason.latency=A,E.state=1,v(E)}return r},reset:function(){R(),c.off(u.default.BUFFER_EMPTY,E,h),c.off(u.default.PLAYBACK_SEEKING,T,h),c.off(u.default.PERIOD_SWITCH_STARTED,S,h),c.off(u.default.MEDIA_FRAGMENT_LOADED,w,h),c.off(u.default.METRIC_ADDED,A,h),c.off(u.default.QUALITY_CHANGE_REQUESTED,M,h),c.off(u.default.FRAGMENT_LOADING_ABANDONED,C,h)}},f=(0,l.default)(t).getInstance().getLogger(h),R(),c.on(u.default.BUFFER_EMPTY,E,h),c.on(u.default.PLAYBACK_SEEKING,T,h),c.on(u.default.PERIOD_SWITCH_STARTED,S,h),c.on(u.default.MEDIA_FRAGMENT_LOADED,w,h),c.on(u.default.METRIC_ADDED,A,h),c.on(u.default.QUALITY_CHANGE_REQUESTED,M,h),c.on(u.default.FRAGMENT_LOADING_ABANDONED,C,h),h}h.__dashjs_factory_name="BolaRule",t.default=a.default.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).abrController,n=e.switchHistory,r=e.droppedFramesHistory,i=e.currentRequest,a=e.useBufferOccupancyABR,o=e.streamProcessor?e.streamProcessor.getScheduleController():null,s=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null;function u(){return s?s.mediaInfo:null}return{getMediaType:function(){var e=u();return e?e.type:null},getMediaInfo:u,getDroppedFramesHistory:function(){return r},getCurrentRequest:function(){return i},getSwitchHistory:function(){return n},getStreamInfo:function(){var e=u();return e?e.streamInfo:null},getScheduleController:function(){return o},getAbrController:function(){return t},getRepresentationInfo:function(){return s},useBufferOccupancyABR:function(){return a}}}o.__dashjs_factory_name="RulesContext",t.default=a.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(51));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=[],t=[];return{push:function(n){n.newValue===i.default.NO_CHANGE&&(n.newValue=n.oldValue),e[n.oldValue]||(e[n.oldValue]={noDrops:0,drops:0,dropSize:0});var r=n.newValue-n.oldValue,a=r<0?1:0,o=a?-r:0,s=a?0:1;if(e[n.oldValue].drops+=a,e[n.oldValue].dropSize+=o,e[n.oldValue].noDrops+=s,t.push({idx:n.oldValue,noDrop:s,drop:a,dropSize:o}),t.length>8){var u=t.shift();e[u.idx].drops-=u.drop,e[u.idx].dropSize-=u.dropSize,e[u.idx].noDrops-=u.noDrop}},getSwitchRequests:function(){return e},reset:function(){e=[],t=[]}}}o.__dashjs_factory_name="SwitchRequestHistory";var s=r.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e=[],t=0,n=0;return{push:function(r,i){var a=i&&i.droppedVideoFrames?i.droppedVideoFrames:0,o=i&&i.totalVideoFrames?i.totalVideoFrames:0,s=a-t;t=a;var u=o-n;n=o,isNaN(r)||(e[r]?(e[r].droppedVideoFrames+=s,e[r].totalVideoFrames+=u):e[r]={droppedVideoFrames:s,totalVideoFrames:u})},getFrameHistory:function(){return e},reset:function(r){e=[],t=r.droppedVideoFrames,n=r.totalVideoFrames}}}o.__dashjs_factory_name="DroppedFramesHistory";var s=a.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(9)),i=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).settings,n=void 0,i=void 0,a=void 0,o=void 0,s=void 0;function u(e,t,n,r){var i=Math.pow(.5,n/r.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var a=Math.pow(.5,n/r.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=n}function l(e,u,l){return t.get().streaming.abr.movingAverageMethod!==r.default.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var n=e?s.throughputHalfLife:s.latencyHalfLife,r=e?a[t]:o[t];if(!r||r.totalWeight<=0)return NaN;var i=r.fastEstimate/(1-Math.pow(.5,r.totalWeight/n.fast)),u=r.slowEstimate/(1-Math.pow(.5,r.totalWeight/n.slow));return e?Math.min(i,u):Math.max(i,u)}(e,u):function(e,t,r){var a=function(e,t,r){var a=void 0,o=void 0;if(e?(a=n[t],o=r?3:4):(a=i[t],o=4),a){if(o>=a.length)o=a.length;else if(e)for(var s=1;s<o;++s){var u=a[a.length-s]/a[a.length-s-1];if((u>=1.3||u<=1/1.3)&&(o+=1)===a.length)break}}else o=0;return o}(e,t,r),o=(e?n:i)[t];if(0===a||!o||0===o.length)return NaN;return(o=o.slice(-a)).reduce((function(e,t){return e+t}))/o.length}(e,u,l)}function c(e,t){return l(!0,e,t)}function d(e){n[e]=n[e]||[],i[e]=i[e]||[],a[e]=a[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},o[e]=o[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function h(){n={},i={},a={},o={}}var f={push:function(e,l,c){if(l.trace&&l.trace.length){var h=l.tresponse.getTime()-l.trequest.getTime()||1,f=l._tfinish.getTime()-l.tresponse.getTime()||1,p=l.trace.reduce((function(e,t){return e+t.b[0]}),0),m=void 0;m=t.get().streaming.lowLatencyEnabled?l.trace.reduce((function(e,t){return e+t.d}),0):c?f:h+f;var g=Math.round(8*p/m);if(d(e),function(e,n,i){return e===r.default.VIDEO?i<t.get().streaming.cacheLoadThresholds[r.default.VIDEO]:e===r.default.AUDIO?i<t.get().streaming.cacheLoadThresholds[r.default.AUDIO]:void 0}(e,0,f)){if(n[e].length>0&&!n[e].hasCachedEntries)return;n[e].hasCachedEntries=!0}else n[e]&&n[e].hasCachedEntries&&function(e){delete n[e],delete i[e],delete a[e],delete o[e],d(e)}(e);n[e].push(g),n[e].length>20&&n[e].shift(),i[e].push(h),i[e].length>20&&i[e].shift(),u(a[e],g,.001*f,s.throughputHalfLife),u(o[e],h,1,s.latencyHalfLife)}},getAverageThroughput:c,getSafeAverageThroughput:function(e,n){var r=c(e,n);return isNaN(r)||(r*=t.get().streaming.abr.bandwidthSafetyFactor),r},getAverageLatency:function(e){return l(!1,e)},reset:h};return s={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},h(),f}o.__dashjs_factory_name="ThroughputHistory",t.default=i.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(9)),i=s(n(2)),a=s(n(175)),o=s(n(923));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){e=e||{};var t,n=this.context,i=void 0;function s(){return i.getBuffer()}return t={getBufferControllerType:function(){return i.getBufferControllerType()},initialize:function(e,t){return i.initialize(e,t)},createBuffer:function(e){return i.createBuffer(e)},getType:function(){return i.getType()},getBuffer:s,setBuffer:function(e){i.setBuffer(e)},getBufferLevel:function(){return i.getBufferLevel()},setMediaSource:function(e){i.setMediaSource(e)},getMediaSource:function(){return i.getMediaSource()},getIsBufferingCompleted:function(){return i.getIsBufferingCompleted()},getIsPruningInProgress:function(){return i.getIsPruningInProgress()},dischargePreBuffer:function(){return i.dischargePreBuffer()},appendInitSegment:function(e){i.appendInitSegment(e)},getRangeAt:function(e){return i.getRangeAt(e)},reset:function(e){i.reset(e)},updateTimestampOffset:function(e){var t=s();t.timestampOffset===e||isNaN(e)||(t.timestampOffset=e)}},i=e.type===r.default.FRAGMENTED_TEXT?(0,a.default)(n).create({streamInfo:e.streamInfo,type:e.type,mediaPlayerModel:e.mediaPlayerModel,manifestModel:e.manifestModel,fragmentModel:e.fragmentModel,errHandler:e.errHandler,mediaController:e.mediaController,representationController:e.representationController,adapter:e.adapter,textController:e.textController,abrController:e.abrController,playbackController:e.playbackController,settings:e.settings}):(0,o.default)(n).create({streamInfo:e.streamInfo,type:e.type,mimeType:e.mimeType,fragmentModel:e.fragmentModel,errHandler:e.errHandler}),t}u.__dashjs_factory_name="TextBufferController",t.default=i.default.getClassFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(9)),i=h(n(16)),a=h(n(18)),o=h(n(2)),s=h(n(138)),u=h(n(176)),l=h(n(130)),c=h(n(25)),d=h(n(35));function h(e){return e&&e.__esModule?e:{default:e}}var f="NotFragmentedTextBufferController";function p(e){e=e||{};var t=this.context,n=(0,i.default)(t).getInstance(),o=(0,l.default)(t).getInstance(),h=e.errHandler,p=e.streamInfo,m=e.type,g=e.mimeType,v=e.fragmentModel,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0;function w(e){E=e}function A(e){e.sender.getStreamId()!==p.id||e.sender.getType()!==m||e.error||null===S.extract(p.id,e.currentRepresentation.id)&&(_=!1,n.trigger(a.default.INIT_FRAGMENT_NEEDED,{sender:y,streamId:p.id,mediaType:m,representationId:e.currentRepresentation.id}))}function x(e){e.chunk.streamId===p.id&&e.chunk.mediaInfo.type===m&&e.chunk.bytes&&(S.save(e.chunk),T.append(e.chunk),_=!0,n.trigger(a.default.STREAM_COMPLETED,{request:e.request}))}return y={getBufferControllerType:function(){return f},initialize:function(e){w(e),S=(0,s.default)(t).getInstance()},createBuffer:function(e){var n=e[0];try{if(T=(0,u.default)(t).create(E,n),!b){var i=T.getBuffer();i.hasOwnProperty(r.default.INITIALIZE)&&i.initialize(g,p,e,v),b=!0}return T}catch(e){if(n&&(n.isText||-1!==n.codec.indexOf('codecs="stpp')||-1!==n.codec.indexOf('codecs="wvtt')))try{T=o.getTextSourceBuffer()}catch(e){h.error(new c.default(d.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,d.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+m+" : "+e.message))}else h.error(new c.default(d.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,d.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+m))}},getType:function(){return m},getBuffer:function(){return T},getBufferLevel:function(){return 0},setMediaSource:w,getMediaSource:function(){return E},getIsBufferingCompleted:function(){return _},getIsPruningInProgress:function(){return!1},dischargePreBuffer:function(){},appendInitSegment:function(e){return null!==S.extract(p.id,e)},getRangeAt:function(){return null},reset:function(e){n.off(a.default.DATA_UPDATE_COMPLETED,A,y),n.off(a.default.INIT_FRAGMENT_LOADED,x,y),!e&&T&&(T.abort(),T.reset(),T=null)},updateTimestampOffset:function(e){T.timestampOffset===e||isNaN(e)||(T.timestampOffset=e)}},b=!1,E=null,_=!1,n.on(a.default.DATA_UPDATE_COMPLETED,A,y),n.on(a.default.INIT_FRAGMENT_LOADED,x,y),y}p.__dashjs_factory_name=f,t.default=o.default.getClassFactory(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(9)),i=h(n(36)),a=h(n(925)),o=h(n(90)),s=h(n(16)),u=h(n(18)),l=h(n(2)),c=h(n(17)),d=h(n(137));function h(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var t=this.context,n=(0,s.default)(t).getInstance(),l=e.adapter,h=e.dashMetrics,f=e.mediaPlayerModel,p=e.fragmentModel,m=e.abrController,g=e.playbackController,v=e.textController,y=e.streamId,_=e.type,b=e.mimeType,E=e.mediaController,T=e.bufferController,S=e.settings,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0,V=void 0;function z(){return!1===C}function W(){z()||x&&!T.getIsBufferingCompleted()&&(A.debug("Schedule Controller starts"),C=!1,h.createPlaylistTraceMetrics(x.id,1e3*g.getTime(),g.getPlaybackRate()),M&&(M=!1),K(0))}function q(){C||(A.debug("Schedule Controller stops"),C=!0,clearTimeout(O))}function Y(){if(C||R||g.isPaused()&&!S.get().streaming.scheduleWhilePaused||(_===r.default.FRAGMENTED_TEXT||_===r.default.TEXT)&&!v.isTextEnabled()||T.getIsBufferingCompleted())q();else{!function(){var e=g.getTime(),t=1.5;if(isNaN(x.fragmentDuration)){var n=h.getCurrentSchedulingInfo(x.mediaInfo.type);t=n?1.5*n.duration:1.5}var r=p.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:e+t,threshold:0})[0];if(r&&-1===B.indexOf(r)&&!l.getIsTextTrack(b)){var a=S.get().streaming.fastSwitchEnabled,s=T.getBufferLevel(),u=m.getAbandonmentStateFor(_),c=!E.isCurrentTrack(r.mediaInfo)&&E.getSwitchMode(r.mediaInfo.type)===d.default.TRACK_SWITCH_MODE_NEVER_REPLACE,f=r.quality<x.quality;a&&(c||f)&&s>=t&&u!==i.default.ABANDON_LOAD?(Q(r),V=!0,A.debug("Reloading outdated fragment at index: ",r.index)):r.quality>x.quality&&!j&&de(g.getTime()+s)}}();var e=B.length>0;if(j||isNaN(F)||U||e||function(e,t){k[t]=k[t]||{};var n=m.getTopQualityIndexFor(e,t);return k[t][e]!=n&&(A.info("Top quality "+e+" index has changed from "+k[t][e]+" to "+n),k[t][e]=n,!0)}(_,y)||L.execute(_,x,P)){X(!0),!e&&H&&m.checkPlaybackQuality(_),function(){if(x.quality===F&&!U||j){var e=B.shift();e&&e.isInitializationRequest()?(n.trigger(u.default.INIT_FRAGMENT_NEEDED,{sender:w,streamId:y,mediaType:_,representationId:e.representationId}),H=!1):(n.trigger(u.default.MEDIA_FRAGMENT_NEEDED,{sender:w,streamId:y,mediaType:_,seekTarget:D,replacement:e}),H=!0)}else U?(A.debug("Switch track for "+_+", representation id = "+x.id),(j=E.getSwitchMode(_)===d.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE)&&T.replaceBuffer&&T.replaceBuffer(),U=!1):A.debug("Quality has changed, get init request for representationid = "+x.id),n.trigger(u.default.INIT_FRAGMENT_NEEDED,{sender:w,streamId:y,mediaType:_,representationId:x.id}),F=x.quality,H=!1}()}else K(500)}}function K(e){clearTimeout(O),O=setTimeout(Y,e)}function X(e){R!==e?R=e:A.debug("isFragmentProcessingInProgress is already equal to",e)}function Q(e){B.push(e)}function Z(e){if(g&&p){var t=p.getRequests({state:o.default.FRAGMENT_MODEL_EXECUTED,time:g.getTime(),threshold:0})[0];t&&g.getTime()>=t.startTime&&((!N.mediaInfo||t.mediaInfo.type===N.mediaInfo.type&&t.mediaInfo.id!==N.mediaInfo.id)&&e&&n.trigger(u.default.TRACK_CHANGE_RENDERED,{mediaType:_,oldMediaInfo:N.mediaInfo,newMediaInfo:t.mediaInfo}),t.quality===N.quality&&t.adaptationIndex===N.adaptationIndex||!e||n.trigger(u.default.QUALITY_CHANGE_RENDERED,{mediaType:_,oldQuality:N.quality,newQuality:t.quality}),N={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function J(e){e.request.mediaInfo.streamInfo.id===y&&e.request.mediaType===_&&(q(),X(!1),A.info("Stream is complete"))}function $(e){e.request.mediaInfo.streamInfo.id===y&&e.request.mediaType===_&&(A.info("OnFragmentLoadingCompleted - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),l.getIsTextTrack(b)&&X(!1),e.error&&e.request.serviceLocation&&!C&&(Q(e.request),X(!1),K(0)),j&&(G=e.request))}function ee(){Z(!0)}function te(e){if(e.streamId===y&&e.mediaType===_)if(j&&!isNaN(e.startTime)&&(j=!1,p.addExecutedRequest(G)),X(!1),V&&!isNaN(e.startTime)){var t=g.getTime(),n=e.startTime+x.fragmentDuration,r=1.5*x.fragmentDuration;K(t+r>=n?0:1e3*(n-(t+r))),V=!1}else K(0)}function ne(e){e.streamId===y&&e.mediaType===_&&(A.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),g.isSeeking()||U||(A.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),Q(e.request)),X(!1),K(0))}function re(e){e.sender.getType()===_&&e.sender.getStreamId()}function ie(e){_===e.mediaType&&y===e.streamId&&q()}function ae(e){e.streamId===y&&e.mediaType===_&&e.hasEnoughSpaceToAppend&&e.quotaExceeded&&C&&W()}function oe(e){e.streamId===y&&e.mediaType===_&&(q(),X(!1))}function se(){p.abortRequests(),q()}function ue(){!C&&S.get().streaming.scheduleWhilePaused||W()}function le(e){de(e.seekTime),he(0),C&&W();var t=x.DVRWindow&&g?x.DVRWindow.end-g.getTime():NaN;h.updateManifestUpdateInfo({latency:t}),R?(A.debug("Abort requests"),p.abortRequests()):K(0)}function ce(e){h.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()})}function de(e){D=e}function he(e){I=e}function fe(){H=!0,R=!1,I=0,D=NaN,M=!0,F=NaN,N={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},k={},B=[],C=!0,U=!1,j=!1,G=null,V=!1}return w={initialize:function(e){P=e,L=(0,a.default)(t).create({abrController:m,dashMetrics:h,mediaPlayerModel:f,textController:v,settings:S}),n.on(u.default.DATA_UPDATE_STARTED,re,this),n.on(u.default.FRAGMENT_LOADING_COMPLETED,$,this),n.on(u.default.STREAM_COMPLETED,J,this),n.on(u.default.BUFFER_CLEARED,ae,this),n.on(u.default.BYTES_APPENDED_END_FRAGMENT,te,this),n.on(u.default.QUOTA_EXCEEDED,oe,this),n.on(u.default.PLAYBACK_SEEKING,le,this),n.on(u.default.PLAYBACK_STARTED,ue,this),n.on(u.default.PLAYBACK_RATE_CHANGED,ce,this),n.on(u.default.PLAYBACK_TIME_UPDATED,ee,this),n.on(u.default.URL_RESOLUTION_FAILED,se,this),n.on(u.default.FRAGMENT_LOADING_ABANDONED,ne,this),n.on(u.default.BUFFERING_COMPLETED,ie,this)},getType:function(){return _},getStreamId:function(){return y},setCurrentRepresentation:function(e){x=e},setSeekTarget:de,setTimeToLoadDelay:he,getTimeToLoadDelay:function(){return I},switchTrackAsked:function(){U=!0},isStarted:z,start:W,stop:q,reset:function(){n.off(u.default.DATA_UPDATE_STARTED,re,this),n.off(u.default.FRAGMENT_LOADING_COMPLETED,$,this),n.off(u.default.STREAM_COMPLETED,J,this),n.off(u.default.BUFFER_CLEARED,ae,this),n.off(u.default.BYTES_APPENDED_END_FRAGMENT,te,this),n.off(u.default.QUOTA_EXCEEDED,oe,this),n.off(u.default.PLAYBACK_SEEKING,le,this),n.off(u.default.PLAYBACK_STARTED,ue,this),n.off(u.default.PLAYBACK_RATE_CHANGED,ce,this),n.off(u.default.PLAYBACK_TIME_UPDATED,ee,this),n.off(u.default.URL_RESOLUTION_FAILED,se,this),n.off(u.default.FRAGMENT_LOADING_ABANDONED,ne,this),n.off(u.default.BUFFERING_COMPLETED,ie,this),q(),Z(!1),fe()},getBufferTarget:function(){return L.getBufferTarget(_,x,P)},processInitRequest:function(e){e&&(X(!0),p.executeRequest(e))},processMediaRequest:function(e){e?(A.debug("Next fragment request url is "+e.url),p.executeRequest(e)):(g.getIsDynamic()&&A.debug("Next fragment seems to be at the bleeding live edge and is not available yet. Rescheduling."),X(!1),K(S.get().streaming.lowLatencyEnabled?100:500))}},A=(0,c.default)(t).getInstance().getLogger(w),fe(),w}f.__dashjs_factory_name="ScheduleController",t.default=l.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(9)),i=o(n(2)),a=o(n(36));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=(e=e||{}).dashMetrics,n=e.mediaPlayerModel,i=e.textController,o=e.abrController,s=e.settings;function u(e,u,l){var c=NaN;if(!e||!u)return c;if(e===r.default.FRAGMENTED_TEXT)if(i.isTextEnabled())if(isNaN(u.fragmentDuration)){var d=t.getCurrentSchedulingInfo(a.default.SCHEDULING_INFO);c=d?d.duration:0}else c=u.fragmentDuration;else c=0;else if(e===r.default.AUDIO&&l){var h=t.getCurrentBufferLevel(r.default.VIDEO);c=isNaN(u.fragmentDuration)?h:Math.max(h,u.fragmentDuration)}else{var f=u.mediaInfo.streamInfo;if(o.isPlayingAtTopQuality(f))c=f.manifestInfo.duration>=s.get().streaming.longFormContentDurationThreshold?s.get().streaming.bufferTimeAtTopQualityLongForm:s.get().streaming.bufferTimeAtTopQuality;else c=n.getStableBufferTime()}return c}return{execute:function(e,n,r){return!e||!n||t.getCurrentBufferLevel(e)<u(e,n,r)},getBufferTarget:u}}s.__dashjs_factory_name="BufferLevelRule",t.default=i.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(9)),i=o(n(25)),a=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=(e=e||{}).eventBus,n=e.events,a=e.errors,o=e.abrController,s=e.dashMetrics,u=e.playbackController,l=e.timelineConverter,c=e.type,d=e.streamId,h=e.dashConstants,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;function y(){if(!(o&&s&&u&&l))throw new Error(r.default.MISSING_CONFIG_ERROR)}function _(){return m}function b(){return v}function E(){p=null,m=!0,g=[]}function T(){return c}function S(){y();var e=new Date,t=b(),n=1e3*u.getTime();t&&s.addRepresentationSwitch(t.adaptation.type,e,n,t.id)}function w(e){return null==e||e>=g.length?null:g[e]}function A(e,t){var n;(e.segmentAvailabilityRange=l.calcSegmentAvailabilityRange(e,t),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime)?C(new i.default(a.SEGMENTS_UNAVAILABLE_ERROR_CODE,a.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE,{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end})):t&&(n=e.segmentAvailabilityRange.end,l.setExpectedLiveEdge(n),s.updateManifestUpdateInfo({presentationStartTime:n}))}function x(e,r){y();for(var i=0,a=g.length;i<a;i++)A(g[i],e),r&&t.trigger(n.REPRESENTATION_UPDATE_STARTED,{sender:f,representation:g[i]})}function M(){m=!0,t.trigger(n.DATA_UPDATE_STARTED,{sender:f})}function C(e){m=!1;var r={sender:f,data:p,currentRepresentation:v};e&&(r.error=e),t.trigger(n.DATA_UPDATE_COMPLETED,r)}function R(e){var r=e;t.trigger(n.AST_IN_FUTURE,{delay:r}),setTimeout((function(){_()||(M(),g.forEach((function(e){e.segmentAvailabilityRange=null})),x(u.getIsDynamic(),!0))}),r)}function I(e){if(e.sender.getType()===T()&&e.sender.getStreamInfo().id===d&&_())if(e.error)C(e.error);else{var t,n=e.sender.getStreamInfo(),r=e.representation,l=s.getCurrentManifestUpdate(),c=!1,f=0,p=void 0;if(r.adaptation.period.mpd.manifest.type!==h.DYNAMIC||r.adaptation.period.mpd.manifest.ignorePostponeTimePeriod||(f=function(e,t){try{var n=u.getStreamController().getActiveStreamInfo(),r=e.segmentAvailabilityRange.start;n&&n.id&&n.id!==t.id&&(r=Math.min(u.getTime(),r));var i=e.segmentAvailabilityRange.end-r;return 1e3*(u.getLiveDelay()-i)}catch(e){return 0}}(r,n)),f>0)return R(f),void C(new i.default(a.SEGMENTS_UPDATE_FAILED_ERROR_CODE,a.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE));if(l){for(var m=0;m<l.representationInfo.length;m++)if((p=l.representationInfo[m]).index===r.index&&p.mediaType===T()){c=!0;break}c||s.addManifestUpdateRepresentationInfo(r,T())}(function(){for(var e=0,t=g.length;e<t;e++){var n=g[e].segmentInfoType;if(null===g[e].segmentAvailabilityRange||!g[e].hasInitialization()||(n===h.SEGMENT_BASE||n===h.BASE_URL)&&!g[e].segments)return!1}return!0})()&&(o.setPlaybackQuality(T(),n,(t=v,g.indexOf(t))),s.updateManifestUpdateInfo({latency:v.segmentAvailabilityRange.end-u.getTime()}),s.getCurrentRepresentationSwitch(b().adaptation.type)||S(),C())}}function O(e){e.isDynamic&&x(e.isDynamic)}function D(e){e.mediaType===T()&&d===e.streamInfo.id&&(v=w(e.newQuality),S())}function P(e){if(e.newDuration){var t=b();if(t&&t.adaptation.period)t.adaptation.period.duration=e.newDuration}}return f={getData:function(){return p},isUpdating:_,updateData:function(e,t,n,i){y(),M(),g=t,v=w(i),p=e,n===r.default.VIDEO||n===r.default.AUDIO||n===r.default.FRAGMENTED_TEXT?x(u.getIsDynamic(),!0):C()},updateRepresentation:A,getCurrentRepresentation:b,getRepresentationForQuality:w,getType:T,getStreamId:function(){return d},reset:function(){t.off(n.QUALITY_CHANGE_REQUESTED,D,f),t.off(n.REPRESENTATION_UPDATE_COMPLETED,I,f),t.off(n.WALLCLOCK_TIME_UPDATED,O,f),t.off(n.MANIFEST_VALIDITY_CHANGED,P,f),E()}},E(),t.on(n.QUALITY_CHANGE_REQUESTED,D,f),t.on(n.REPRESENTATION_UPDATE_COMPLETED,I,f),t.on(n.WALLCLOCK_TIME_UPDATED,O,f),t.on(n.MANIFEST_VALIDITY_CHANGED,P,f),f}s.__dashjs_factory_name="RepresentationController",t.default=a.default.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(9));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).timelineConverter;return{getLiveEdge:function(e){!function(){if(!t||!t.hasOwnProperty("getExpectedLiveEdge"))throw new Error(i.default.MISSING_CONFIG_ERROR)}();var n=e.DVRWindow?e.DVRWindow.end:0,r=n;return e.useCalculatedLiveEdgeTime&&(r=t.getExpectedLiveEdge(),t.setClientTimeOffset(r-n)),r},reset:function(){t=null}}}o.__dashjs_factory_name="LiveEdgeFinder",t.default=r.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(2)),i=u(n(929)),a=u(n(930)),o=u(n(931)),s=u(n(932));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var t,n=this.context,r=e.events,u=e.eventBus,l=e.dashConstants,c=void 0;function d(e){return e?e.segments?c[l.SEGMENT_BASE]:c[e.segmentInfoType]:null}return t={initialize:function(t){c[l.SEGMENT_TIMELINE]=(0,i.default)(n).create(e,t),c[l.SEGMENT_TEMPLATE]=(0,a.default)(n).create(e,t),c[l.SEGMENT_LIST]=(0,o.default)(n).create(e,t),c[l.SEGMENT_BASE]=(0,s.default)(n).create(e,t)},update:function(e,t,n,i,a){i||u.trigger(r.SEGMENTBASE_INIT_REQUEST_NEEDED,{mimeType:n,representation:e}),a||u.trigger(r.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,{mimeType:n,mediaType:t,representation:e})},getSegmentByIndex:function(e,t,n){var r=d(e);return r?r.getSegmentByIndex(e,t,n):null},getSegmentByTime:function(e,t){var n=d(e);return n?n.getSegmentByTime(e,t):null}},c={},t}l.__dashjs_factory_name="SegmentsController";var c=r.default.getClassFactory(l);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(2)),i=o(n(9)),a=n(73);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=(e=e||{}).timelineConverter;function r(){if(!n||!n.hasOwnProperty("calcMediaTimeFromPresentationTime")||!n.hasOwnProperty("calcSegmentAvailabilityRange"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function o(e,r){var i,a,o,s=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,u=s.SegmentTimeline,l=s.SegmentURL_asArray,c=0,d=0,h=-1,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0;o=e.timescale;var _=!1;for(p=0,a=(i=u.S_asArray).length;p<a&&!_;p++){if(g=0,(f=i[p]).hasOwnProperty("r")&&(g=f.r),f.hasOwnProperty("t")&&(d=(c=f.t)/o),g<0){if((y=i[p+1])&&y.hasOwnProperty("t"))v=y.t/o;else{var b=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:n.calcSegmentAvailabilityRange(e,t).end;v=n.calcMediaTimeFromPresentationTime(b,e),e.segmentDuration=f.d/o}g=Math.ceil((v-d)/(f.d/o))-1}for(m=0;m<=g&&!_;m++)(_=r(c,d,s,l,f,o,++h,p))&&(e.segmentDuration=f.d/o,(m<g-1||p<a-1)&&h++),d=(c+=f.d)/o}e.availableSegmentsNumber=h}return{getSegmentByIndex:function(e,i,s){if(r(),!e)return null;var u=null,l=!1;return o(e,(function(r,i,o,c,d,h,f,p){if(l||s<0){var m=o.media,g=d.mediaRange;return c&&(m=c[p].media||"",g=c[p].mediaRange),u=(0,a.getTimeBasedSegment)(n,t,e,r,d.d,h,m,g,f,d.tManifest),!0}return i>=s-.5*d.d/h&&(l=!0),!1})),u},getSegmentByTime:function(e,i){if(r(),!e)return null;void 0===i&&(i=null);var s=null,u=n.calcMediaTimeFromPresentationTime(i,e);return o(e,(function(r,i,o,l,c,d,h,f){if(u<i+c.d/d){var p=o.media,m=c.mediaRange;return l&&(p=l[f].media||"",m=l[f].mediaRange),s=(0,a.getTimeBasedSegment)(n,t,e,r,c.d,d,p,m,h,c.tManifest),!0}return!1})),s}}}s.__dashjs_factory_name="TimelineSegmentsGetter";var u=r.default.getClassFactory(s);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(2)),i=o(n(9)),a=n(73);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=(e=e||{}).timelineConverter;function r(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function o(e,i){if(r(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;i=Math.max(i,0);var s=(0,a.getIndexBasedSegment)(n,t,e,i);if(s){s.replacementTime=(i-1)*e.segmentDuration;var u=o.media;u=(0,a.replaceTokenForTemplate)(u,"Number",s.replacementNumber),u=(0,a.replaceTokenForTemplate)(u,"Time",s.replacementTime),s.media=u}var l=e.segmentDuration,c=e.segmentAvailabilityRange;return isNaN(l)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((c.end-c.start)/l),s}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(r(),!e)return null;var i=e.segmentDuration;if(isNaN(i))return null;var a=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/i))}}}s.__dashjs_factory_name="TemplateSegmentsGetter";var u=r.default.getClassFactory(s);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(2)),i=o(n(9)),a=n(73);function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=(e=e||{}).timelineConverter;function r(){if(!n||!n.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function o(e,i){if(r(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,s=o.SegmentURL_asArray.length,u=e.startNumber,l=null;if(i<s){var c=o.SegmentURL_asArray[i];(l=(0,a.getIndexBasedSegment)(n,t,e,i))&&(l.replacementTime=(u+i-1)*e.segmentDuration,l.media=c.media?c.media:"",l.mediaRange=c.mediaRange,l.index=i,l.indexRange=c.indexRange)}return e.availableSegmentsNumber=s,l}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(r(),!e)return null;var i=e.segmentDuration;if(isNaN(i))return null;var a=n.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/i))}}}s.__dashjs_factory_name="ListSegmentsGetter";var u=r.default.getClassFactory(s);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(9));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(e=e||{}).timelineConverter;function n(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function r(e,t){if(n(),!e)return null;var r=e.segments?e.segments.length:-1,i=void 0;if(t<r&&(i=e.segments[t])&&i.availabilityIdx===t)return i;for(var a=0;a<r;a++)if((i=e.segments[a])&&i.availabilityIdx===t)return i;return null}return{getSegmentByIndex:r,getSegmentByTime:function(e,i){return n(),r(e,function(e,t){if(!e)return-1;var n=e.segments,r=n?n.length:null,i=-1,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0;if(n&&r>0)for(l=0;l<r;l++)if(s=(o=n[l]).presentationStartTime,t+(a=(u=o.duration)/2)>=s&&t-a<s+u){i=o.availabilityIdx;break}return i}(e,t.calcPeriodRelativeTimeFromMpdRelativeTime(e,i)))}}}o.__dashjs_factory_name="SegmentBaseGetter";var s=r.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e=void 0,t=/^[a-z][a-z0-9+\-_.]*:/i,n=/^https?:\/\//i,r=/^https:\/\//i,i=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,a=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},o=function(e,t){var n=s;if(!t)return e;if(!c(e))return e;d(e)&&(n=u),h(e)&&(n=l);var r=n(t),i="/"!==r.charAt(r.length-1)&&"/"!==e.charAt(0)?"/":"";return[r,e].join(i)};function s(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function u(e){var t=e.match(i);return t?t[1]:""}function l(e){var n=e.match(t);return n?n[0]:""}function c(e){return!t.test(e)}function d(e){return c(e)&&"/"===e.charAt(0)}function h(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y");e=a}catch(e){}finally{e=e||o}}(),{parseBaseUrl:s,parseOrigin:u,parseScheme:l,isRelative:c,isPathAbsolute:d,isSchemeRelative:h,isHTTPURL:function(e){return n.test(e)},isHTTPS:function(e){return r.test(e)},removeHostname:function(e){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1)},resolve:function(t,n){return e(t,n)}}}o.__dashjs_factory_name="DefaultURLUtils",t.default=a.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(9)),i=f(n(935)),a=f(n(90)),o=f(n(936)),s=f(n(140)),u=f(n(16)),l=f(n(18)),c=f(n(35)),d=f(n(2)),h=f(n(17));function f(e){return e&&e.__esModule?e:{default:e}}function p(e){e=e||{};var t=this.context,n=(0,u.default)(t).getInstance(),d=e.errHandler,f=e.mediaPlayerModel,p=e.dashMetrics,m=(0,h.default)(t).getInstance(),g=void 0,v=void 0,y=void 0;function _(){for(var e in y)y[e].reset();y={}}function b(e){if(e.sender){var t=e.request,a=e.response,o=t.isInitializationRequest(),s=t.mediaInfo.streamInfo;if(e.error&&(e.request.mediaType!==r.default.AUDIO&&e.request.mediaType!==r.default.VIDEO&&e.request.mediaType!==r.default.FRAGMENTED_TEXT||n.trigger(l.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation})),a&&s){var u=function(e,t,n,r){var a=new i.default;return a.streamId=n,a.mediaInfo=t.mediaInfo,a.segmentType=t.type,a.start=t.startTime,a.duration=t.duration,a.end=a.start+a.duration,a.bytes=e,a.index=t.index,a.quality=t.quality,a.representationId=t.representationId,a.endFragment=r,a}(a,t,s.id,e.type!==l.default.FRAGMENT_LOADING_PROGRESS);n.trigger(o?l.default.INIT_FRAGMENT_LOADED:l.default.MEDIA_FRAGMENT_LOADED,{chunk:u,request:t})}else v.warn("No "+t.mediaType+" bytes to push or stream is inactive.")}}return g={getModel:function(r,i){var u=y[i];return u||(u=(0,a.default)(t).create({streamId:r,dashMetrics:p,fragmentLoader:(0,o.default)(t).create({dashMetrics:p,mediaPlayerModel:f,errHandler:d,requestModifier:(0,s.default)(t).getInstance(),settings:e.settings,boxParser:e.boxParser,eventBus:n,events:l.default,errors:c.default,dashConstants:e.dashConstants,urlUtils:e.urlUtils}),debug:m,eventBus:n,events:l.default}),y[i]=u),u},reset:function(){n.off(l.default.FRAGMENT_LOADING_COMPLETED,b,this),n.off(l.default.FRAGMENT_LOADING_PROGRESS,b,this),_()}},v=m.getLogger(g),_(),n.on(l.default.FRAGMENT_LOADING_COMPLETED,b,g),n.on(l.default.FRAGMENT_LOADING_PROGRESS,b,g),g}p.__dashjs_factory_name="FragmentController",t.default=d.default.getClassFactory(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(9)),i=u(n(93)),a=u(n(946)),o=u(n(25)),s=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){e=e||{};var t=this.context,n=e.eventBus,s=e.events,u=e.urlUtils,l=e.errors,c=void 0,d=void 0;return c={checkForExistence:function(e){var t=function(t){n.trigger(s.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var r=new a.default(e.url);d.load({request:r,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)},load:function(e){var t=function(t,r){n.trigger(s.LOADING_COMPLETED,{request:e,response:t||null,error:r||null,sender:c})};e?d.load({request:e,progress:function(t){n.trigger(s.LOADING_PROGRESS,{request:e,stream:t.stream}),t.data&&n.trigger(s.LOADING_DATA_PROGRESS,{request:e,response:t.data||null,error:null,sender:c})},success:function(e){t(e)},error:function(e,n,r){t(void 0,new o.default(l.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,r,n))},abort:function(e){e&&n.trigger(s.LOADING_ABANDONED,{request:e,mediaType:e.mediaType,sender:c})}}):t(void 0,new o.default(l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){d&&d.abort()},reset:function(){d&&(d.abort(),d=null)}},d=(0,i.default)(t).create({errHandler:e.errHandler,errors:l,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings.get().streaming.lowLatencyEnabled,urlUtils:u,constants:r.default,boxParser:e.boxParser,dashConstants:e.dashConstants}),c}l.__dashjs_factory_name="FragmentLoader",t.default=s.default.getClassFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(142)),i=c(n(938)),a=n(34),o=c(n(2)),s=c(n(25)),u=c(n(188)),l=c(n(145));function c(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){e=e||{};var t,n,o=this.context,c=e.errHandler,h=e.dashMetrics,f=e.mediaPlayerModel,p=e.requestModifier,m=e.boxParser,g=e.useFetch||!1,v=e.errors,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0;function S(e,t){var n=e.request,u=[],d=!0,v=!0,w=new Date,A=w,x=0,M=void 0;if(!p||!h||!c)throw new Error("config object is not correct or missing");var C=function(e){v=!1,n.requestStartDate=w,n.requestEndDate=new Date,n.firstByteDate=n.firstByteDate||w,n.checkExistenceOnly||(h.addHttpRequest(n,M.response?M.response.responseURL:null,M.response?M.response.status:null,M.response&&M.response.getAllResponseHeaders?M.response.getAllResponseHeaders():M.response?M.response.responseHeaders:[],e?u:null),n.type===a.HTTPRequest.MPD_TYPE&&h.addManifestUpdate(n.type,n.requestStartDate,n.requestEndDate))},R=function(){if(-1!==y.indexOf(M)&&(y.splice(y.indexOf(M),1),v))if(C(!1),t>0){t--;var r={config:e};b.push(r),r.timeout=setTimeout((function(){-1!==b.indexOf(r)&&(b.splice(b.indexOf(r),1),S(e,t))}),f.getRetryIntervalsForType(n.type))}else c.error(new s.default(E[n.type],n.url+" is not available",{request:n,response:M.response})),e.error&&e.error(n,"error",M.response.statusText),e.complete&&e.complete(n,M.response.statusText)},I=void 0;I=g&&window.fetch&&"arraybuffer"===n.responseType&&n.type===a.HTTPRequest.MEDIA_SEGMENT_TYPE?(0,i.default)(o).create({requestModifier:p,boxParser:m}):(0,r.default)(o).create({requestModifier:p});var O=p.modifyRequestURL(n.url),D=function(e){try{var t=[],n=T.getQueryParameter(e);return n&&t.push(n),t}catch(e){return[]}}(n);O=l.default.addAditionalQueryParameterToUrl(O,D);var P=n.checkExistenceOnly?a.HTTPRequest.HEAD:a.HTTPRequest.GET,L=f.getXHRWithCredentialsForType(n.type);M={url:O,method:P,withCredentials:L,request:n,onload:function(){M.response.status>=200&&M.response.status<=299&&(C(!0),e.success&&e.success(M.response.response,M.response.statusText,M.response.responseURL),e.complete&&e.complete(n,M.response.statusText))},onend:R,onerror:R,progress:function(t){var r=new Date;d&&(d=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(n.firstByteDate=r)),t.lengthComputable&&(n.bytesLoaded=t.loaded,n.bytesTotal=t.total),t.noTrace||(u.push({s:A,d:t.time?t.time:r.getTime()-A.getTime(),b:[t.loaded?t.loaded-x:0]}),A=r,x=t.loaded),e.progress&&t&&e.progress(t)},onabort:function(){e.abort&&e.abort(n)},loader:I};var N=(new Date).getTime();if(isNaN(n.delayLoadingTime)||N>=n.delayLoadingTime)y.push(M),I.load(M);else{var k={httpRequest:M};_.push(k),k.delayTimeout=setTimeout((function(){if(-1!==_.indexOf(k)){_.splice(_.indexOf(k),1);try{w=new Date,A=w,y.push(k.httpRequest),I.load(k.httpRequest)}catch(e){k.httpRequest.onerror()}}}),n.delayLoadingTime-N)}}return t={load:function(e){e.request?S(e,f.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error")},abort:function(){b.forEach((function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)})),b=[],_.forEach((function(e){return clearTimeout(e.delayTimeout)})),_=[],y.forEach((function(e){e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e)})),y=[]}},y=[],_=[],b=[],T=(0,u.default)(o).getInstance(),d(n={},a.HTTPRequest.MPD_TYPE,v.DOWNLOAD_ERROR_ID_MANIFEST_CODE),d(n,a.HTTPRequest.XLINK_EXPANSION_TYPE,v.DOWNLOAD_ERROR_ID_XLINK_CODE),d(n,a.HTTPRequest.INIT_SEGMENT_TYPE,v.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),d(n,a.HTTPRequest.MEDIA_SEGMENT_TYPE,v.DOWNLOAD_ERROR_ID_CONTENT_CODE),d(n,a.HTTPRequest.INDEX_SEGMENT_TYPE,v.DOWNLOAD_ERROR_ID_CONTENT_CODE),d(n,a.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,v.DOWNLOAD_ERROR_ID_CONTENT_CODE),d(n,a.HTTPRequest.OTHER_TYPE,v.DOWNLOAD_ERROR_ID_CONTENT_CODE),E=n,t}h.__dashjs_factory_name="HTTPLoader";var f=o.default.getClassFactory(h);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).requestModifier,n=e.boxParser;function r(e,t){e.reader.read().then(t).catch((function(t){e.onerror&&200===e.response.status&&e.onerror(t)}))}function i(e,t){if((e=e.filter((function(n){return n.bytes>t/4/e.length}))).length>1){var n=0,r=(e[e.length-1].ts-e[0].ts)/e.length;return e.forEach((function(t,i){var a=e[i+1];if(a){var o=a.ts-t.ts;n+=o<r?o:0}})),n}return null}return{load:function(e){var a=new Date,o=e.request,s=new Headers;o.range&&s.append("Range","bytes="+o.range),o.requestStartDate||(o.requestStartDate=a),t&&t.modifyRequestHeader({setRequestHeader:function(e,t){s.append(e,t)}});var u=void 0;"function"==typeof window.AbortController&&(u=new AbortController,e.abortController=u,u.signal.onabort=e.onabort);var l={method:e.method,headers:s,credentials:e.withCredentials?"include":void 0,signal:u?u.signal:void 0};fetch(e.url,l).then((function(t){e.response||(e.response={}),e.response.status=t.status,e.response.statusText=t.statusText,e.response.responseURL=t.url,t.ok||e.onerror();var a="",o=!0,s=!1,u=void 0;try{for(var l,c=t.headers.keys()[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var d=l.value;a+=d+": "+t.headers.get(d)+"\r\n"}}catch(e){s=!0,u=e}finally{try{!o&&c.return&&c.return()}finally{if(s)throw u}}if(e.response.responseHeaders=a,!t.body)return t.arrayBuffer().then((function(t){e.response.response=t;var n={loaded:t.byteLength,total:t.byteLength,stream:!1};e.progress(n),e.onload(),e.onend()}));var h=parseInt(t.headers.get("Content-Length"),10),f=0,p=!1,m=new Uint8Array,g=0;e.reader=t.body.getReader();var v=[];r(e,(function t(a){var o=a.value;if(a.done)return m&&(e.progress({loaded:f,total:isNaN(h)?f:h,lengthComputable:!0,time:i(v,f),stream:!0}),e.response.response=m.buffer),e.onload(),void e.onend();if(o&&o.length>0){m=function(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(m,o),f+=o.length,v.push({ts:Date.now(),bytes:o.length});var s=n.findLastTopIsoBoxCompleted(["moov","mdat"],m,g);if(s.found){var u=s.lastCompletedOffset+s.size,l=void 0;u===m.length?(l=m,m=new Uint8Array):(l=new Uint8Array(m.subarray(0,u)),m=m.subarray(u)),e.progress({data:l.buffer,lengthComputable:!1,noTrace:!0}),g=0}else g=s.lastCompletedOffset,p||(e.progress({lengthComputable:!1,noTrace:!0}),p=!0)}r(e,t)}))})).catch((function(t){e.onerror&&e.onerror(t)}))},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort()}catch(e){}},calculateDownloadedTime:i}}o.__dashjs_factory_name="FetchLoader";var s=a.default.getClassFactory(o);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(33),o=(r=a)&&r.__esModule?r:{default:r};var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return i(e,[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==o.default.BASE_URL&&this.segmentInfoType!==o.default.SEGMENT_BASE&&!this.indexRange}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.period=null,this.index=-1,this.type=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};r.DEFAULT_ID="defaultId",t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""}},function(e,t,n){"use strict";var r=Array.isArray,i=Object.keys,a=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var o,s,u,l=r(t),c=r(n);if(l&&c){if((s=t.length)!=n.length)return!1;for(o=s;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(l!=c)return!1;var d=t instanceof Date,h=n instanceof Date;if(d!=h)return!1;if(d&&h)return t.getTime()==n.getTime();var f=t instanceof RegExp,p=n instanceof RegExp;if(f!=p)return!1;if(f&&p)return t.toString()==n.toString();var m=i(t);if((s=m.length)!==i(n).length)return!1;for(o=s;0!=o--;)if(!a.call(n,m[o]))return!1;for(o=s;0!=o--;)if(!e(t[u=m[o]],n[u]))return!1;return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(59);var a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.checkForExistenceOnly=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(2)),i=l(n(9)),a=l(n(948)),o=l(n(193)),s=l(n(185)),u=n(73);function l(e){return e&&e.__esModule?e:{default:e}}function c(e){var t,n=this.context,r=void 0;function l(){r&&r.reset()}return t={provide:function(e,t){if("function"==typeof t){var n,i=r.getCurrentTrack(),o=void 0;if(!i||i.segmentDuration<=0||null==e)t(null);else{isNaN(i.segmentDuration)&&(o=r.getThumbnailRequestForTime(e))&&(i.segmentDuration=o.duration),n=e%i.segmentDuration;var s=Math.floor(n*i.tilesHor*i.tilesVert/i.segmentDuration),l=new a.default;if(l.width=Math.floor(i.widthPerTile),l.height=Math.floor(i.heightPerTile),l.x=Math.floor(s%i.tilesHor)*i.widthPerTile,l.y=Math.floor(s/i.tilesHor)*i.heightPerTile,"readThumbnail"in i)return i.readThumbnail(e,(function(e){l.url=e,t(l)}));if(o)l.url=o.url,i.segmentDuration=NaN;else{var c=Math.floor(e/i.segmentDuration);l.url=function(e,t){var n=t+e.startNumber,r=(0,u.replaceTokenForTemplate)(e.templateUrl,"Number",n);return r=(0,u.replaceTokenForTemplate)(r,"Time",(n-1)*e.segmentDuration),r=(0,u.replaceTokenForTemplate)(r,"Bandwidth",e.bandwidth),(0,u.unescapeDollarsInTemplate)(r)}(i,c)}t(l)}}},setTrackByIndex:function(e){r.setTrackByIndex(e)},getCurrentTrackIndex:function(){return r.getCurrentTrackIndex()},getBitrateList:function(){var e=r.getTracks(),t=0;return e.map((function(e){var n=new s.default;return n.mediaType=i.default.IMAGE,n.qualityIndex=t++,n.bitrate=e.bitrate,n.width=e.width,n.height=e.height,n}))},reset:l},l(),r=(0,o.default)(n).create({streamInfo:e.streamInfo,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants}),t}c.__dashjs_factory_name="ThumbnailController",t.default=r.default.getClassFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(25)),i=n(34),a=d(n(16)),o=d(n(18)),s=d(n(35)),u=d(n(2)),l=d(n(17)),c=d(n(46));function d(e){return e&&e.__esModule?e:{default:e}}function h(){var e=this.context,t=(0,a.default)(e).getInstance(),n=(0,c.default)(e).getInstance(),u=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;function y(e){f=e}function _(e){h=e}function b(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t=void 0,n=void 0,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&(parseInt(r[6],10)||0),r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]&&(n=60*parseInt(r[9],10)+parseInt(r[10],10),t+=("+"===r[8]?-1:1)*n*60*1e3),new Date(t).getTime()}(e)),t}function E(e){return Date.parse(e)}function T(e){return Date.parse(e)}function S(e,t,n){n()}function w(e,t,n){var r=b(e);isNaN(r)?n():t(r)}function A(e,t,r,a,o){var s,u,l=!1,c=new XMLHttpRequest,d=o?i.HTTPRequest.HEAD:i.HTTPRequest.GET,h=t.match(/\S+/g);if(t=h.shift(),s=function(){l||(l=!0,h.length?A(e,h.join(" "),r,a,o):a())},u=function(){var t=void 0,n=void 0;200===c.status&&(t=o?c.getResponseHeader("Date"):c.response,n=e(t),isNaN(n)||(r(n),l=!0))},n.isRelative(t)){var f=v.resolve();f&&(t=n.resolve(t,f.url))}c.open(d,t),c.timeout=5e3,c.onload=u,c.onloadend=s,c.send()}function x(e,t,n){A(T,e,t,n,!0)}function M(e,n,i){y(!1),t.trigger(o.default.TIME_SYNCHRONIZATION_COMPLETED,{time:n,offset:i,error:e?new r.default(s.default.TIME_SYNC_FAILED_ERROR_CODE,s.default.TIME_SYNC_FAILED_ERROR_MESSAGE):null})}return u={initialize:function(e,t){p=t,h=0,f=!1,m={"urn:mpeg:dash:utc:http-head:2014":x,"urn:mpeg:dash:utc:http-xsdate:2014":A.bind(null,b),"urn:mpeg:dash:utc:http-iso:2014":A.bind(null,E),"urn:mpeg:dash:utc:direct:2014":w,"urn:mpeg:dash:utc:http-head:2012":x,"urn:mpeg:dash:utc:http-xsdate:2012":A.bind(null,b),"urn:mpeg:dash:utc:http-iso:2012":A.bind(null,E),"urn:mpeg:dash:utc:direct:2012":w,"urn:mpeg:dash:utc:http-ntp:2014":S,"urn:mpeg:dash:utc:ntp:2014":S,"urn:mpeg:dash:utc:sntp:2014":S},f||function e(t,n){var r=n||0,i=t[r],a=function(e,t){var n,r,i=!e||!t;i&&p?(n=g.getLatestMPDRequestHeaderValueByID("Date"),r=null!==n?new Date(n).getTime():Number.NaN,isNaN(r)?M(!0):(_(r-(new Date).getTime()),M(!1,r/1e3,h))):M(i,e,t)};y(!0),i?m.hasOwnProperty(i.schemeIdUri)?m[i.schemeIdUri](i.value,(function(e){var t=(new Date).getTime(),n=function(e,t){return e-t}(e,t);_(n),d.info("Local time: "+new Date(t)),d.info("Server time: "+new Date(e)),d.info("Server Time - Local Time (ms): "+n),a(e,n)}),(function(){e(t,r+1)})):e(t,r+1):(_(0),a())}(e)},getOffsetToDeviceTimeMs:function(){return h},setConfig:function(e){e&&(e.dashMetrics&&(g=e.dashMetrics),e.baseURLController&&(v=e.baseURLController))},reset:function(){y(!1)}},d=(0,l.default)(e).getInstance().getLogger(u),u}h.__dashjs_factory_name="TimeSyncController";var f=u.default.getSingletonFactory(h);f.HTTP_TIMEOUT_MS=5e3,u.default.updateSingletonFactory(h.__dashjs_factory_name,f),t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(17));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0,t=void 0,n=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){var n=window.URL.createObjectURL(e);return t.setSource(n),n},detachMediaSource:function(e){e.setSource(null)},setDuration:function(e,t){return e.duration!=t&&(e.duration=t),e.duration},setSeekable:function(e,t,n){e&&"function"==typeof e.setLiveSeekableRange&&"function"==typeof e.clearLiveSeekableRange&&"open"===e.readyState&&t>=0&&t<n&&(e.clearLiveSeekableRange(),e.setLiveSeekableRange(t,n))},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var n=e.sourceBuffers,r=0;r<n.length;r++){if(n[r].updating)return;if(0===n[r].buffered.length)return}t.info("call to mediaSource endOfStream"),e.endOfStream()}}},t=(0,i.default)(n).getInstance().getLogger(e),e}o.__dashjs_factory_name="MediaSourceController",t.default=r.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(2)),i=u(n(17)),a=u(n(16)),o=u(n(18)),s=u(n(142));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e="urn:mpeg:dash:event:2012",t=this.context,n=(0,a.default)(t).getInstance(),r=void 0,u=void 0,l=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;function y(){if(!p||!m)throw new Error("setConfig function has to be called previously")}function _(){v=!1,l={},c={},d={},h=null,g=!1,f=Date.now()/1e3}function b(){try{null!==h&&v&&(clearInterval(h),h=null,v=!1,function(){try{x(c),x(l)}catch(e){}}())}catch(e){throw e}}function E(e){try{if(1==e.eventStream.value){var t=e.eventStream.timescale||1,r=e.calculatedPresentationTime/t,i=void 0;i=4294967295==e.calculatedPresentationTime?NaN:(e.calculatedPresentationTime+e.duration)/t,u.info("Manifest validity changed: Valid until: "+r+"; remaining duration: "+i),n.trigger(o.default.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:r,newDuration:i,newManifestValidAfter:NaN})}}catch(e){}}function T(){try{if(!g){var e=m.getTime(),t=e-f;t=f>0?Math.max(0,t):0,S(c,t,e),S(l,t,e),function(){try{if(d)for(var e=m.getTime(),t=Object.keys(d),n=0;n<t.length;n++){var r=t[n],i=d[r];null!==i&&(i.duration+i.calculatedPresentationTime)/i.eventStream.timescale<e&&(u.debug("Remove Event "+r+" at time "+e),i=null,delete d[r])}}catch(e){}}(),f=e}g=!1}catch(e){g=!1}}function S(e,t,n){try{if(e)for(var r=Object.keys(e),i=0;i<r.length;i++){var a=r[i],o=e[a];if(void 0!==o){var s=o.calculatedPresentationTime/o.eventStream.timescale;s<=n&&s+t>=n?M(a,o,e):(w(n,t,s)||A(o))&&(u.debug("Deleting event "+a+" as it is expired or invalid"),delete e[a])}}}catch(e){}}function w(e,t,n){try{return e-t>n}catch(e){return!1}}function A(e){try{var t=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime/1e3>t}catch(e){return!1}}function x(e){try{var t=Object.keys(e),n=m.getTime();if(!t||0===t.length)return;var r=e[t[0]].eventStream&&e[t[0]].eventStream.period&&!isNaN(e[t[0]].eventStream.period.duration)?e[t[0]].eventStream.period.duration:NaN,i=e[t[0]].eventStream&&e[t[0]].eventStream.period&&!isNaN(e[t[0]].eventStream.period.start)?e[t[0]].eventStream.period.start:NaN;if(isNaN(r)||isNaN(i))return;t.forEach((function(t){var r=e[t],i=r.calculatedPresentationTime/r.eventStream.timescale;Math.abs(i-n)<300&&M(t,r,e)}))}catch(e){}}function M(r,i,a){try{var o=m.getTime();i.duration>0&&(d[r]=i),i.eventStream.schemeIdUri===e&&1==i.eventStream.value?0===i.duration&&0===i.presentationTimeDelta||(u.debug("Starting manifest refresh event "+r+" at "+o),function(){try{y(),p.refreshManifest()}catch(e){}}()):"urn:mpeg:dash:event:callback:2015"===i.eventStream.schemeIdUri&&1==i.eventStream.value?(u.debug("Starting callback event "+r+" at "+o),function(e){try{(0,s.default)(t).create({}).load({method:"get",url:e,request:{responseType:"arraybuffer"}})}catch(e){throw e}}(i.messageData)):(u.debug("Starting event "+r+" at "+o),n.trigger(i.eventStream.schemeIdUri,{event:i})),delete a[r]}catch(e){}}return r={addInlineEvents:function(e){try{if(y(),e)for(var t=0;t<e.length;t++){var n=e[t];l[n.id]=n,u.debug("Add inline event with id "+n.id)}u.debug("Added "+e.length+" inline events")}catch(e){throw e}},addInbandEvents:function(t){try{y();for(var n=0;n<t.length;n++){var r=t[n];r.id in c?u.debug("Repeated event with id "+r.id):(r.eventStream.schemeIdUri===e&&void 0===c[r.id]&&E(r),c[r.id]=r,u.debug("Add inband event with id "+r.id))}T()}catch(e){throw e}},start:function(){try{y(),u.debug("Start Event Controller"),v||isNaN(100)||(v=!0,h=setInterval(T,100))}catch(e){throw e}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(p=e.manifestUpdater),e.playbackController&&(m=e.playbackController)}catch(e){throw e}},reset:function(){b(),_()}},u=(0,i.default)(t).getInstance().getLogger(r),_(),r}l.__dashjs_factory_name="EventController",t.default=r.default.getSingletonFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(953)),i=c(n(954)),a=c(n(46)),o=c(n(191)),s=c(n(2)),u=c(n(16)),l=c(n(18));function c(e){return e&&e.__esModule?e:{default:e}}function d(){var e=void 0,t=void 0,n=this.context,s=(0,u.default)(n).getInstance(),c=(0,a.default)(n).getInstance(),d=void 0,h=void 0;function f(e){d.invalidateSelectedIndexes(e.entry)}return e={reset:function(){d.reset(),h.reset()},initialize:function(e){var n;d.setConfig({adapter:t}),n=e,d.update(n),h.chooseSelector(t.getIsDVB(n))},resolve:function(e){var t=d.getForPath(e).reduce((function(e,t){var n=h.select(t);return n?(c.isRelative(n.url)?e.url=c.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e):new o.default}),new o.default);if(!c.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(d=e.baseURLTreeModel),e.baseURLSelector&&(h=e.baseURLSelector),e.adapter&&(t=e.adapter)}},d=(0,r.default)(n).create(),h=(0,i.default)(n).create(),s.on(l.default.SERVICE_LOCATION_BLACKLIST_CHANGED,f,e),e}d.__dashjs_factory_name="BaseURLController",t.default=s.default.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(192)),i=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}var o=NaN,s=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={baseUrls:t||null,selectedIdx:n||o},this.children=[]};function u(){var e,t=void 0,n=void 0,i=this.context,a=(0,r.default)(i).getInstance();function u(e,t,r){var i=n.getBaseURLsFromElement(r);e[t]?a.areEqual(i,e[t].data.baseUrls)||(e[t].data.baseUrls=i,e[t].data.selectedIdx=o):e[t]=new s(i)}function l(e){!function(){if(!n||!n.hasOwnProperty("getBaseURLsFromElement")||!n.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var r=n.getBaseURLsFromElement(e);a.areEqual(r,t.data.baseUrls)||(t.data.baseUrls=r,t.data.selectedIdx=o),e&&e.Period_asArray&&e.Period_asArray.forEach((function(e,r){u(t.children,r,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach((function(e,i){u(t.children[r].children,i,e),e.Representation_asArray&&e.Representation_asArray.sort(n.getRepresentationSortFunction()).forEach((function(e,n){u(t.children[r].children[i].children,n,e)}))}))}))}function c(){t=new s}return e={reset:c,update:function(e){l(e)},getForPath:function(e){var n=t,r=[n.data];return e&&e.forEach((function(e){(n=n.children[e])&&r.push(n.data)})),r.filter((function(e){return e.baseUrls.length}))},invalidateSelectedIndexes:function(e){!function e(n,r){var i=r||t;n(i.data),i.children&&i.children.forEach((function(t){return e(n,t)}))}((function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=o)}))},setConfig:function(e){e.adapter&&(n=e.adapter)}},c(),e}u.__dashjs_factory_name="BaseURLTreeModel",t.default=i.default.getClassFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(35)),i=h(n(16)),a=h(n(18)),o=h(n(955)),s=h(n(956)),u=h(n(957)),l=h(n(2)),c=h(n(25)),d=n(54);function h(e){return e&&e.__esModule?e:{default:e}}function f(){var e,t=this.context,n=(0,i.default)(t).getInstance(),l=void 0,h=void 0,f=void 0,p=void 0;function m(){l.reset()}return e={chooseSelector:function(e){(0,d.checkParameterType)(e,"boolean"),p=e?f:h},select:function(e){if(e){var t=e.baseUrls,i=e.selectedIdx;if(!isNaN(i))return t[i];var o=p.select(t);return o?(e.selectedIdx=t.indexOf(o),o):(n.trigger(a.default.URL_RESOLUTION_FAILED,{error:new c.default(r.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,r.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(p===h&&m()))}},reset:m,setConfig:function(e){e.selector&&(p=e.selector)}},l=(0,o.default)(t).create({updateEventName:a.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:a.default.SERVICE_LOCATION_BLACKLIST_ADD}),h=(0,u.default)(t).create({blacklistController:l}),f=(0,s.default)(t).create({blacklistController:l}),p=h,e}f.__dashjs_factory_name="BaseURLSelector",t.default=l.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2)),i=a(n(16));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t=[],n=(0,i.default)(this.context).getInstance(),r=e.updateEventName,a=e.addBlacklistEventName;function o(e){-1===t.indexOf(e)&&(t.push(e),n.trigger(r,{entry:e}))}function s(e){o(e.entry)}return function(){a&&n.on(a,s,this)}(),{add:o,contains:function(e){return!!(t.length&&e&&e.length)&&-1!==t.indexOf(e)},reset:function(){t=[]}}}o.__dashjs_factory_name="BlackListController",t.default=r.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).blacklistController;return{select:function(e){return e&&function(e){var t=0,n=[],r=0,i=void 0,a=void 0;if((a=e.sort((function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n})).filter((function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority}))).length)return a.length>1&&(a.forEach((function(e){t+=e.dvb_weight,n.push(t)})),i=Math.floor(Math.random()*(t-1)),n.every((function(e,t){return r=t,!(i<e)}))),a[r]}((n=[],e.filter((function(e){return!t.contains(e.serviceLocation)||(e.dvb_priority&&n.push(e.dvb_priority),!1)})).filter((function(e){return!n.length||!e.dvb_priority||-1===n.indexOf(e.dvb_priority)}))));var n}}}o.__dashjs_factory_name="DVBSelector",t.default=a.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).blacklistController;return{select:function(e){var n=0,r=void 0;return e&&e.some((function(e,r){return n=r,!t.contains(e.serviceLocation)}))&&(r=e[n]),r}}}o.__dashjs_factory_name="BasicSelector",t.default=a.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=g(n(9)),i=g(n(33)),a=g(n(959)),o=g(n(93)),s=g(n(46)),u=g(n(195)),l=g(n(25)),c=n(34),d=g(n(16)),h=g(n(18)),f=g(n(35)),p=g(n(2)),m=g(n(961));function g(e){return e&&e.__esModule?e:{default:e}}function v(e){e=e||{};var t=this.context,n=e.debug,p=(0,d.default)(t).getInstance(),g=(0,s.default)(t).getInstance(),v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=e.mssHandler,S=e.errHandler;function w(e){p.trigger(h.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}return v={load:function(e){var i=new u.default(e,c.HTTPRequest.MPD_TYPE);_.load({request:i,success:function(i,a,o){if(b){var s=void 0,u=void 0,c=void 0;if(o&&o!==e?(u=g.parseBaseUrl(o),s=o):(g.isRelative(e)&&(e=g.resolve(e,window.location.href)),u=g.parseBaseUrl(e)),null===E&&(E=function(e){var r=null;return e.indexOf("SmoothStreamingMedia")>-1?(T&&(r=T.createMssParser(),T.registerEvents()),r):e.indexOf("MPD")>-1?(0,m.default)(t).create({debug:n}):r}(i)),null!==E){b.setMatchers(E.getMatchers()),b.setIron(E.getIron());try{c=E.parse(i)}catch(t){return void p.trigger(h.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}c?(c.url=s||e,c.originalUrl||(c.originalUrl=c.url),c.hasOwnProperty(r.default.LOCATION)&&(u=g.parseBaseUrl(c.Location_asArray[0]),y.debug("BaseURI set by Location to: "+u)),c.baseUri=u,c.loadedTime=new Date,b.resolveManifestOnLoad(c),p.trigger(h.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:i})):p.trigger(h.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}else p.trigger(h.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}},error:function(t,n,r){p.trigger(h.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(f.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+(e+", ")+r)})}})},reset:function(){p.off(h.default.XLINK_READY,w,v),b&&(b.reset(),b=null),_&&(_.abort(),_=null),T&&T.reset()}},y=n.getLogger(v),p.on(h.default.XLINK_READY,w,v),_=(0,o.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings.get().streaming.lowLatencyEnabled,urlUtils:g,constants:r.default,dashConstants:i.default,errors:f.default}),b=(0,a.default)(t).create({errHandler:S,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),E=null,v}v.__dashjs_factory_name="ManifestLoader";var y=p.default.getClassFactory(v);t.default=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(960)),i=c(n(16)),a=c(n(18)),o=c(n(2)),s=c(n(196)),u=c(n(46)),l=c(n(33));function c(e){return e&&e.__esModule?e:{default:e}}var d="onLoad";function h(e){e=e||{};var t=this.context,n=(0,i.default)(t).getInstance(),o=(0,u.default)(t).getInstance(),c=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0;function v(e,t,n){var r={},i=void 0,a=void 0;r.elements=e,r.type=t,r.resolveType=n,0===r.elements.length&&_(r);for(var s=0;s<r.elements.length;s++)i=r.elements[s],a=o.isHTTPURL(i.url)?i.url:i.originalContent.BaseURL+i.url,g.load(a,i,r)}function y(e){var t,n=void 0,r="";if(n=e.element,t=e.resolveObject,n.resolvedContent){var i=0;0===n.resolvedContent.indexOf("<?xml")&&(i=n.resolvedContent.indexOf("?>")+2),r=n.resolvedContent.substr(0,i)+"<response>"+n.resolvedContent.substr(i)+"</response>",n.resolvedContent=m.xml_str2json(r)}(function(e){var t=void 0;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0})(t)&&_(t)}function _(e){var t=[],r=void 0,i=void 0;if(function(e){var t=[],n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;for(a=e.elements.length-1;a>=0;a--){if(r=(n=e.elements[a]).type+"_asArray",n.resolvedContent){if(n.resolvedContent)for(o=0;o<n.resolvedContent[r].length;o++)i=n.resolvedContent[r][o],t.push(i)}else delete n.originalContent["xlink:actuate"],delete n.originalContent["xlink:href"],t.push(n.originalContent);for(n.parentElement[r].splice(n.index,1),s=0;s<t.length;s++)n.parentElement[r].splice(n.index+s,0,t[s]);t=[]}e.elements.length>0&&f.run(p)}(e),"onActuate"===e.resolveType&&n.trigger(a.default.XLINK_READY,{manifest:p}),e.resolveType===d)switch(e.type){case l.default.PERIOD:for(r=0;r<p[l.default.PERIOD+"_asArray"].length;r++)(i=p[l.default.PERIOD+"_asArray"][r]).hasOwnProperty(l.default.ADAPTATION_SET+"_asArray")&&(t=t.concat(b(i[l.default.ADAPTATION_SET+"_asArray"],i,l.default.ADAPTATION_SET,d))),i.hasOwnProperty(l.default.EVENT_STREAM+"_asArray")&&(t=t.concat(b(i[l.default.EVENT_STREAM+"_asArray"],i,l.default.EVENT_STREAM,d)));v(t,l.default.ADAPTATION_SET,d);break;case l.default.ADAPTATION_SET:n.trigger(a.default.XLINK_READY,{manifest:p})}}function b(e,t,n,r){var i=[],a=void 0,o=void 0,s=void 0;for(o=e.length-1;o>=0;o--)(a=e[o]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===a["xlink:href"]&&e.splice(o,1);for(o=0;o<e.length;o++)(a=e[o]).hasOwnProperty("xlink:href")&&a.hasOwnProperty("xlink:actuate")&&a["xlink:actuate"]===r&&(s=E(a["xlink:href"],t,n,o,r,a),i.push(s));return i}function E(e,t,n,r,i,a){return{url:e,parentElement:t,type:n,index:r,resolveType:i,originalContent:a,resolvedContent:null,resolved:!1}}return c={resolveManifestOnLoad:function(e){m=new s.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:h}),v(b((p=e).Period_asArray,p,l.default.PERIOD,d),l.default.PERIOD,d)},setMatchers:function(e){e&&(h=e)},setIron:function(e){e&&(f=e)},reset:function(){n.off(a.default.XLINK_ELEMENT_LOADED,y,c),g&&(g.reset(),g=null)}},n.on(a.default.XLINK_ELEMENT_LOADED,y,c),g=(0,r.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),c}h.__dashjs_factory_name="XlinkController",t.default=o.default.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(25)),i=d(n(93)),a=n(34),o=d(n(195)),s=d(n(16)),u=d(n(18)),l=d(n(2)),c=d(n(35));function d(e){return e&&e.__esModule?e:{default:e}}function h(e){e=e||{};var t=this.context,n=(0,s.default)(t).getInstance(),l=(0,i.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,useFetch:e.settings?e.settings.get().streaming.lowLatencyEnabled:null,errors:c.default});return{load:function(e,t,i){var s=function(a,o){t.resolved=!0,t.resolvedContent=a||null,n.trigger(u.default.XLINK_ELEMENT_LOADED,{element:t,resolveObject:i,error:a||o?null:new r.default(c.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,c.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)})};if("urn:mpeg:dash:resolve-to-zero:2013"===e)s(null,!0);else{var d=new o.default(e,a.HTTPRequest.XLINK_EXPANSION_TYPE);l.load({request:d,success:function(e){s(e)},error:function(){s(null)}})}},reset:function(){l&&(l.abort(),l=null)}}}h.__dashjs_factory_name="XlinkLoader",t.default=l.default.getClassFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(2)),i=h(n(962)),a=h(n(196)),o=h(n(963)),s=h(n(964)),u=h(n(965)),l=h(n(966)),c=h(n(967)),d=h(n(969));function h(e){return e&&e.__esModule?e:{default:e}}function f(e){e=e||{};var t=this.context,n=e.debug,r=void 0,h=void 0,f=void 0,p=void 0,m=void 0;return r={parse:function(e){var t=void 0,n=window.performance.now();if(!(t=p.xml_str2json(e)))throw new Error("parsing the manifest failed");var r=window.performance.now();m.run(t);var i=window.performance.now();return h.info("Parsing complete: ( xml2json: "+(r-n).toPrecision(3)+"ms, objectiron: "+(i-r).toPrecision(3)+"ms, total: "+((i-n)/1e3).toPrecision(3)+"s)"),t.protocol="DASH",t},getMatchers:function(){return f},getIron:function(){return m}},h=n.getLogger(r),f=[new s.default,new u.default,new l.default,new o.default],p=new a.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!0,matchers:f}),m=(0,i.default)(t).create({adaptationset:new c.default,period:new d.default}),r}f.__dashjs_factory_name="DashParser",t.default=r.default.getClassFactory(f)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(2),o=(r=a)&&r.__esModule?r:{default:r};function s(e){function t(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function n(e,n,r){for(var a=0,o=e.length;a<o;++a){var s=e[a];if(n[s.name])if(r[s.name]){if(s.merge){var u=n[s.name],l=r[s.name];"object"===(void 0===u?"undefined":i(u))&&"object"===(void 0===l?"undefined":i(l))?t(u,l):r[s.name]=u+l}}else r[s.name]=n[s.name]}}function r(e,t){for(var i=0,a=e.children.length;i<a;++i){var o=e.children[i],s=t[o.name+"_asArray"];if(s)for(var u=0,l=s.length;u<l;++u){var c=s[u];n(e.properties,t,c),r(o,c)}}}return{run:function(t){if(null===t||"object"!==(void 0===t?"undefined":i(t)))return t;if("period"in e)for(var n=e.period,a=t.Period_asArray,o=0,s=a.length;o<s;++o){var u=a[o];if(r(n,u),"adaptationset"in e){var l=u.AdaptationSet_asArray;if(l)for(var c=e.adaptationset,d=0,h=l.length;d<h;++d)r(c,l[d])}}return t}}}s.__dashjs_factory_name="ObjectIron";var u=o.default.getClassFactory(s);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(110)),i=a(n(33));function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e,t){var n,r=(o(n={},i.default.MPD,[i.default.ID,i.default.PROFILES]),o(n,i.default.PERIOD,[i.default.ID]),o(n,i.default.BASE_URL,[i.default.SERVICE_LOCATION,i.default.BYTE_RANGE]),o(n,i.default.SEGMENT_BASE,[i.default.INDEX_RANGE]),o(n,i.default.INITIALIZATION,[i.default.RANGE]),o(n,i.default.REPRESENTATION_INDEX,[i.default.RANGE]),o(n,i.default.SEGMENT_LIST,[i.default.INDEX_RANGE]),o(n,i.default.BITSTREAM_SWITCHING,[i.default.RANGE]),o(n,i.default.SEGMENT_URL,[i.default.MEDIA_RANGE,i.default.INDEX_RANGE]),o(n,i.default.SEGMENT_TEMPLATE,[i.default.INDEX_RANGE,i.default.MEDIA,i.default.INDEX,i.default.INITIALIZATION_MINUS,i.default.BITSTREAM_SWITCHING_MINUS]),o(n,i.default.ASSET_IDENTIFIER,[i.default.VALUE,i.default.ID]),o(n,i.default.EVENT_STREAM,[i.default.VALUE]),o(n,i.default.ADAPTATION_SET,[i.default.PROFILES,i.default.MIME_TYPE,i.default.SEGMENT_PROFILES,i.default.CODECS,i.default.CONTENT_TYPE]),o(n,i.default.FRAME_PACKING,[i.default.VALUE,i.default.ID]),o(n,i.default.AUDIO_CHANNEL_CONFIGURATION,[i.default.VALUE,i.default.ID]),o(n,i.default.CONTENT_PROTECTION,[i.default.VALUE,i.default.ID]),o(n,i.default.ESSENTIAL_PROPERTY,[i.default.VALUE,i.default.ID]),o(n,i.default.SUPPLEMENTAL_PROPERTY,[i.default.VALUE,i.default.ID]),o(n,i.default.INBAND_EVENT_STREAM,[i.default.VALUE,i.default.ID]),o(n,i.default.ACCESSIBILITY,[i.default.VALUE,i.default.ID]),o(n,i.default.ROLE,[i.default.VALUE,i.default.ID]),o(n,i.default.RATING,[i.default.VALUE,i.default.ID]),o(n,i.default.VIEWPOINT,[i.default.VALUE,i.default.ID]),o(n,i.default.CONTENT_COMPONENT,[i.default.CONTENT_TYPE]),o(n,i.default.REPRESENTATION,[i.default.ID,i.default.DEPENDENCY_ID,i.default.MEDIA_STREAM_STRUCTURE_ID]),o(n,i.default.SUBSET,[i.default.ID]),o(n,i.default.METRICS,[i.default.METRICS_MINUS]),o(n,i.default.REPORTING,[i.default.VALUE,i.default.ID]),n);if(r.hasOwnProperty(t)){var a=r[t];return void 0!==a&&a.indexOf(e.name)>=0}return!1}),(function(e){return String(e)})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(110)),i=o(n(9)),a=o(n(33));function o(e){return e&&e.__esModule?e:{default:e}}var s=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){for(var t=[a.default.MIN_BUFFER_TIME,a.default.MEDIA_PRESENTATION_DURATION,a.default.MINIMUM_UPDATE_PERIOD,a.default.TIMESHIFT_BUFFER_DEPTH,a.default.MAX_SEGMENT_DURATION,a.default.MAX_SUBSEGMENT_DURATION,a.default.SUGGESTED_PRESENTATION_DELAY,a.default.START,i.default.START_TIME,a.default.DURATION],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return s.test(e.value);return!1}),(function(e){var t=s.exec(e),n=31536e3*parseFloat(t[3]||0)+2592e3*parseFloat(t[5]||0)+86400*parseFloat(t[7]||0)+3600*parseFloat(t[9]||0)+60*parseFloat(t[11]||0)+parseFloat(t[13]||0);return void 0!==t[1]&&(n=-n),n})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(110),a=(r=i)&&r.__esModule?r:{default:r};var o=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){return o.test(e.value)}),(function(e){var t=o.exec(e),n=void 0;if(n=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&1e3*parseFloat(t[7])||0),t[9]&&t[10]){var r=60*parseInt(t[9],10)+parseInt(t[10],10);n+=("+"===t[8]?-1:1)*r*60*1e3}return new Date(n)})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(a.default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(110),a=(r=i)&&r.__esModule?r:{default:r};var o=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(function(e){return o.test(e.value)}),(function(e){return parseFloat(e)})))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(a.default);t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(197)),i=a(n(33));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[i.default.PROFILES,i.default.WIDTH,i.default.HEIGHT,i.default.SAR,i.default.FRAMERATE,i.default.AUDIO_SAMPLING_RATE,i.default.MIME_TYPE,i.default.SEGMENT_PROFILES,i.default.CODECS,i.default.MAXIMUM_SAP_PERIOD,i.default.START_WITH_SAP,i.default.MAX_PLAYOUT_RATE,i.default.CODING_DEPENDENCY,i.default.SCAN_TYPE,i.default.FRAME_PACKING,i.default.AUDIO_CHANNEL_CONFIGURATION,i.default.CONTENT_PROTECTION,i.default.ESSENTIAL_PROPERTY,i.default.SUPPLEMENTAL_PROPERTY,i.default.INBAND_EVENT_STREAM];return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.default.ADAPTATION_SET,e,[new r.default(i.default.REPRESENTATION,e,[new r.default(i.default.SUB_REPRESENTATION,e)])]))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n;this._name=t,this._merge=(n=t)&&n.length&&n.charAt(0)===n.charAt(0).toUpperCase()}return r(e,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(197)),i=a(n(33));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[i.default.SEGMENT_BASE,i.default.SEGMENT_TEMPLATE,i.default.SEGMENT_LIST];return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,i.default.PERIOD,e,[new r.default(i.default.ADAPTATION_SET,e,[new r.default(i.default.REPRESENTATION,e)])]))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default);t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(16)),i=o(n(18)),a=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=(0,r.default)(e).getInstance();return{error:function(e){t.trigger(i.default.ERROR,{error:e})}}}s.__dashjs_factory_name="ErrorHandler",t.default=a.default.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e,t=void 0;return e={supportsMediaSource:function(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t},supportsEncryptedMedia:function(){return t},supportsCodec:function(e){return!(!("MediaSource"in window)||!MediaSource.isTypeSupported(e))||!(!("WebKitMediaSource"in window)||!WebKitMediaSource.isTypeSupported(e))},setEncryptedMediaSupported:function(e){t=e}},t=!1,e}o.__dashjs_factory_name="Capabilities",t.default=a.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(973)),i=a(n(2));function a(e){return e&&e.__esModule?e:{default:e}}function o(){var e=void 0;return{initialize:function(t){if(e=new r.default,!t)return null;var n=t.indexOf("#");if(-1!==n)for(var i=t.substr(n+1).split("&"),a=0,o=i.length;a<o;++a){var s=i[a],u=s.indexOf("=");if(-1!==u){var l=s.substring(0,u);e.hasOwnProperty(l)&&(e[l]=s.substr(u+1))}}},getURIFragmentData:function(){return e}}}o.__dashjs_factory_name="URIFragmentModel",t.default=i.default.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(16)),i=o(n(18)),a=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}function s(){var e=this.context,t=(0,r.default)(e).getInstance(),n=void 0;return{getValue:function(){return n},setValue:function(e){n=e,e&&t.trigger(i.default.MANIFEST_LOADED,{data:e})}}}s.__dashjs_factory_name="ManifestModel",t.default=a.default.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(189)),i=l(n(2)),a=l(n(9)),o=l(n(184)),s=l(n(144)),u=n(54);function l(e){return e&&e.__esModule?e:{default:e}}function c(){var e,t=void 0,n=void 0,i=void 0,l={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso&ms"},c=this.context,d=(0,s.default)(c).getInstance();function h(e){var t=void 0;for(t=0;t<i.length;t++)if(i[t].rulename===e)return t;return-1}function f(){return d.get().streaming.lowLatencyEnabled?d.get().streaming.liveDelay||3:d.get().streaming.liveDelay}function p(e,n){m(e,n);var i=new r.default;i.schemeIdUri=e,i.value=n,t.push(i)}function m(e,n){(0,u.checkParameterType)(e,"string"),(0,u.checkParameterType)(n,"string"),t.forEach((function(r,i){r.schemeIdUri===e&&r.value===n&&t.splice(i,1)}))}return e={getABRCustomRules:function(){return i},addABRCustomRule:function(e,t,n){if("string"!=typeof e||e!==o.default.ABANDON_FRAGMENT_RULES&&e!==o.default.QUALITY_SWITCH_RULES||"string"!=typeof t)throw a.default.BAD_ARGUMENT_ERROR;var r=h(t);-1===r?i.push({type:e,rulename:t,rule:n}):(i[r].type=e,i[r].rule=n)},removeABRCustomRule:function(e){if(e){var t=h(e);-1!==t&&i.splice(t,1)}else i=[]},getStableBufferTime:function(){if(d.get().streaming.lowLatencyEnabled)return.6*f();var e=d.get().streaming.stableBufferTime;return e>-1?e:d.get().streaming.fastSwitchEnabled?20:12},getRetryAttemptsForType:function(e){var t=isNaN(d.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:d.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return d.get().streaming.lowLatencyEnabled?d.get().streaming.retryAttempts[e]*t:d.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){var t=isNaN(d.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:d.get().streaming.retryIntervals.lowLatencyReductionFactor;return d.get().streaming.lowLatencyEnabled?d.get().streaming.retryIntervals[e]/t:d.get().streaming.retryIntervals[e]},getLiveDelay:f,getLiveCatchupLatencyThreshold:function(){try{var e=d.get().streaming.liveCatchupLatencyThreshold,t=f();if(null!==e&&!isNaN(e))return Math.max(e,t);var n=d.get().streaming.liveCatchUpMinDrift,r=!isNaN(t)&&t?isNaN(n)?f():d.get().streaming.liveCatchUpMinDrift+f():NaN;return r&&!isNaN(r)?2*r:NaN}catch(e){return NaN}},addUTCTimingSource:p,removeUTCTimingSource:m,getUTCTimingSources:function(){return t},clearDefaultUTCTimingSources:function(){t=[]},restoreDefaultUTCTimingSources:function(){p(l.scheme,l.value)},setXHRWithCredentialsForType:function e(t,r){t?n[t]=!!r:Object.keys(n).forEach((function(t){e(t,r)}))},getXHRWithCredentialsForType:function(e){var t=n[e];return void 0===t?n.default:t},getDefaultUtcTimingSource:function(){return l},reset:function(){}},t=[],n={default:!1},i=[],e}c.__dashjs_factory_name="MediaPlayerModel",t.default=i.default.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(2)),i=s(n(16)),a=s(n(18)),o=s(n(17));function s(e){return e&&e.__esModule?e:{default:e}}function u(){var e=void 0,t=void 0,n=void 0,r=void 0,s=void 0,u=this.context,l=(0,i.default)(u).getInstance(),c=[];function d(){n&&(n.playbackRate=s||1,n.removeEventListener("canplay",d))}function h(e){n&&(n.readyState<=2&&e>0?n.addEventListener("canplay",d):n.playbackRate=e)}function f(){return c.length>0}function p(e){var t=c.indexOf(e),r=void 0;null!==e&&(-1!==t&&c.splice(t,1),n&&!1===f()&&0===n.playbackRate&&(h(s||1),n.paused||((r=document.createEvent("Event")).initEvent("playing",!0,!1),n.dispatchEvent(r))))}function m(){if(n&&f()&&0===n.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),n.dispatchEvent(e)}}function g(){return n?n.buffered:null}function v(e,t,r,i,a){if(n)for(var o=0;o<n.textTracks.length;o++)if(n.textTracks[o].kind===e&&(!t||n.textTracks[o].label==t)&&n.textTracks[o].language===r&&n.textTracks[o].isTTML===i&&n.textTracks[o].isEmbedded===a)return n.textTracks[o];return null}return e={initialize:function(){l.on(a.default.PLAYBACK_PLAYING,m,this)},setCurrentTime:function(e,t){if(n){if(n.currentTime==e)return;try{e=t?function(e){var t=g(),n=e,r=9999999999;if(t)for(var i=0;i<t.length;i++){var a=t.start(i),o=t.end(i),s=Math.abs(a-e),u=Math.abs(o-e);if(e>=a&&e<=o)return e;s<r&&(r=s,n=a),u<r&&(r=u,n=o)}return n}(e):e,n.currentTime=e}catch(t){0===n.readyState&&t.code===t.INVALID_STATE_ERR&&setTimeout((function(){n.currentTime=e}),400)}}},play:function(){if(n){n.autoplay=!0;var e=n.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch((function(e){"NotAllowedError"===e.name&&l.trigger(a.default.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing ("+e+")")}))}},isPaused:function(){return n?n.paused:null},pause:function(){n&&(n.pause(),n.autoplay=!1)},isSeeking:function(){return n?n.seeking:null},getTime:function(){return n?n.currentTime:null},getPlaybackRate:function(){return n?n.playbackRate:null},setPlaybackRate:h,getPlayedRanges:function(){return n?n.played:null},getEnded:function(){return n?n.ended:null},setStallState:function(e,t){!function(e,t){t?function(e){var t=void 0;if(null===e||n.seeking||-1!==c.indexOf(e))return;c.push(e),n&&1===c.length&&((t=document.createEvent("Event")).initEvent("waiting",!0,!1),s=n.playbackRate,h(0),n.dispatchEvent(t))}(e):p(e)}(e,t)},getElement:function(){return n},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw"element is not video or audio DOM type!";(n=e)&&(n.preload="auto")},setSource:function(e){n&&(e?n.src=e:(n.removeAttribute("src"),n.load()))},getSource:function(){return n?n.src:null},getTTMLRenderingDiv:function(){return r},setTTMLRenderingDiv:function(e){(r=e).style.position="absolute",r.style.display="flex",r.style.overflow="hidden",r.style.pointerEvents="none",r.style.top=0,r.style.left=0},getPlaybackQuality:function(){if(!n)return null;var e="webkitDroppedFrameCount"in n&&"webkitDecodedFrameCount"in n,t=null;return"getVideoPlaybackQuality"in n?t=n.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:n.webkitDroppedFrameCount,totalVideoFrames:n.webkitDroppedFrameCount+n.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:function(e,t){n&&n.addEventListener(e,t)},removeEventListener:function(e,t){n&&n.removeEventListener(e,t)},getReadyState:function(){return n?n.readyState:NaN},getBufferRange:g,getClientWidth:function(){return n?n.clientWidth:NaN},getClientHeight:function(){return n?n.clientHeight:NaN},getTextTracks:function(){return n?n.textTracks:[]},getTextTrack:v,addTextTrack:function(e,t,r,i,a){if(!n)return null;var o=v(e,t,r,i,a);return o||((o=n.addTextTrack(e,t,r)).isEmbedded=a,o.isTTML=i),o},appendChild:function(e){n&&(n.appendChild(e),void 0!==e.isTTML&&(n.textTracks[n.textTracks.length-1].isTTML=e.isTTML,n.textTracks[n.textTracks.length-1].isEmbedded=e.isEmbedded))},removeChild:function(e){n&&n.removeChild(e)},getVideoWidth:function(){return n?n.videoWidth:NaN},getVideoHeight:function(){return n?n.videoHeight:NaN},getVideoRelativeOffsetTop:function(){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().top-e.parentNode.getBoundingClientRect().top:NaN},getVideoRelativeOffsetLeft:function(){var e=n.parentNode.host||n.parentNode;return e?n.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN},reset:function(){l.off(a.default.PLAYBACK_PLAYING,m,this)}},t=(0,o.default)(u).getInstance().getLogger(e),e}u.__dashjs_factory_name="VideoModel",t.default=r.default.getSingletonFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(2)),i=o(n(17)),a=o(n(9));function o(e){return e&&e.__esModule?e:{default:e}}var s=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],u="dashjs_?_bitrate",l="dashjs_?_settings",c="localStorage",d="lastBitrate",h="lastMediaSettings";function f(e){e=e||{};var t=this.context,n=e.settings,r=void 0,o=void 0,f=void 0;function p(e){if(void 0!==f)return f;f=!1;var t=void 0;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return o.warn("DOMStorage access denied: "+e.message),f}if(!t||e!==c&&"sessionStorage"!==e)return f;try{t.setItem("1","1"),t.removeItem("1"),f=!0}catch(e){o.warn("DOMStorage is supported, but cannot be used: "+e.message)}return f}function m(){var e=6e5;return Math.round((new Date).getTime()/e)*e}function g(e,t){return p(e)&&n.get().streaming[t+"CachingInfo"].enabled}function v(){if(!n)throw new Error(a.default.MISSING_CONFIG_ERROR)}return r={getSavedBitrateSettings:function(e){var t=NaN;if(v(),g(c,d)){var r=u.replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(r))||{},a=(new Date).getTime()-parseInt(i.timestamp,10)>=n.get().streaming.lastBitrateCachingInfo.ttl||!1,s=parseFloat(i.bitrate);isNaN(s)||a?a&&localStorage.removeItem(r):(t=s,o.debug("Last saved bitrate for "+e+" was "+s))}catch(e){return null}}return t},setSavedBitrateSettings:function(e,t){if(g(c,d)&&t){var n=u.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({bitrate:t.toFixed(3),timestamp:m()}))}catch(e){o.error(e.message)}}},getSavedMediaSettings:function(e){var t=null;if(v(),g(c,h)){var r=l.replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(r))||{},a=(new Date).getTime()-parseInt(i.timestamp,10)>=n.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;t=i.settings,a&&(localStorage.removeItem(r),t=null)}catch(e){return null}}return t},setSavedMediaSettings:function(e,t){if(g(c,h)){var n=l.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({settings:t,timestamp:m()}))}catch(e){o.error(e.message)}}}},o=(0,i.default)(t).getInstance().getLogger(r),p(c)&&s.forEach((function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){o.error(e.message)}}})),r}f.__dashjs_factory_name="DOMStorage";var p=r.default.getSingletonFactory(f);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(2)),i=o(n(979)),a=o(n(980));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t=this.context,n=e.eventBus,r=e.events,o=e.dashMetrics,s=e.mediaPlayerModel,u=e.errHandler,l=e.baseURLController,c=e.debug,d=e.boxParser,h=e.requestModifier,f=e.errors,p=void 0,m=void 0,g=void 0;function v(e){return"webm"===(e?e.split("/")[1]:"").toLowerCase()}function y(e){v(e.mimeType)?g.loadInitialization(e.representation):m.loadInitialization(e.representation)}function _(e){v(e.mimeType)?g.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null,e.callback):m.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null,e.callback)}return p={initialize:function(){n.on(r.SEGMENTBASE_INIT_REQUEST_NEEDED,y,p),n.on(r.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,_,p),m.initialize(),g.initialize()},reset:function(){n.off(r.SEGMENTBASE_INIT_REQUEST_NEEDED,y,p),n.off(r.SEGMENTBASE_SEGMENTSLIST_REQUEST_NEEDED,_,p)}},m=(0,i.default)(t).getInstance(),g=(0,a.default)(t).getInstance(),m.setConfig({baseURLController:l,dashMetrics:o,mediaPlayerModel:s,errHandler:u,eventBus:n,events:r,errors:f,debug:c,boxParser:d,requestModifier:h}),g.setConfig({baseURLController:l,dashMetrics:o,mediaPlayerModel:s,errHandler:u,eventBus:n,events:r,errors:f,debug:c,requestModifier:h}),p}s.__dashjs_factory_name="SegmentBaseController";var u=r.default.getSingletonFactory(s);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(139)),i=u(n(25)),a=u(n(2)),o=u(n(59)),s=u(n(93));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e=this.context,t=void 0,n=void 0,a=void 0,u=void 0,l=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0;function E(){if(!b||!b.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function T(e){if(e.url){var t=new o.default;return t.setInfo(e),t}}function S(e,t,n){e?m.trigger(p.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):m.trigger(p.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new i.default(g.SEGMENT_BASE_LOADER_ERROR_CODE,g.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}return t={setConfig:function(e){e.baseURLController&&(b=e.baseURLController),e.dashMetrics&&(c=e.dashMetrics),e.mediaPlayerModel&&(h=e.mediaPlayerModel),e.errHandler&&(a=e.errHandler),e.settings&&(d=e.settings),e.boxParser&&(u=e.boxParser),e.events&&(p=e.events),e.eventBus&&(m=e.eventBus),e.debug&&(n=e.debug.getLogger(t)),e.requestModifier&&(l=e.requestModifier),e.errors&&(g=e.errors),e.urlUtils&&(_=e.urlUtils),e.constants&&(v=e.constants),e.dashConstants&&(y=e.dashConstants)},initialize:function(){f=(0,s.default)(e).create({errHandler:a,dashMetrics:c,mediaPlayerModel:h,requestModifier:l,useFetch:d?d.get().streaming.lowLatencyEnabled:null,boxParser:u,errors:g,urlUtils:_,constants:v,dashConstants:y})},loadInitialization:function e(t,r){E();var i=null,a=t?b.resolve(t.path):null,o=r||{init:!0,url:a?a.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:t&&t.adaptation?t.adaptation.type:null};n.debug("Start searching for initialization.");var s=T(o);f.load({request:s,success:function(n){o.bytesLoaded=o.range.end,(i=u.findInitRange(n))?(t.range=i,m.trigger(p.INITIALIZATION_LOADED,{representation:t})):(o.range.end=o.bytesLoaded+o.bytesToLoad,e(t,o))},error:function(){m.trigger(p.INITIALIZATION_LOADED,{representation:t})}}),n.debug("Perform init search: "+o.url)},loadSegments:function e(t,i,a,o,s){if(E(),a&&(void 0===a.start||void 0===a.end)){var l=a?a.toString().split("-"):null;a=l?{start:parseFloat(l[0]),end:parseFloat(l[1])}:null}o=o||S;var c=null,d=null,h=!!a,p=t?b.resolve(t.path):null,m={init:!1,url:p?p.url:void 0,range:h?a:{start:0,end:1500},searching:!h,bytesLoaded:s?s.bytesLoaded:0,bytesToLoad:1500,mediaType:t&&t.adaptation?t.adaptation.type:null},g=T(m);f.load({request:g,success:function(a){var s=m.bytesToLoad,l=a.byteLength;if(m.bytesLoaded=m.range.end-m.range.start,c=u.parse(a),(d=c.getBox("sidx"))&&d.isComplete){var h=d.references,f=void 0,p=void 0;if(null!=h&&h.length>0&&(f=1===h[0].reference_type),f){n.debug("Initiate multiple SIDX load."),m.range.end=m.range.start+d.size;var g=void 0,v=void 0,y=void 0,_=void 0,b=[],E=0,T=(d.offset||m.range.start)+d.size,S=function(e){e?(b=b.concat(e),++E>=v&&(b.sort((function(e,t){return e.startTime-t.startTime<0?-1:0})),o(b,t,i))):o(null,t,i)};for(g=0,v=h.length;g<v;g++)y=T,_=T+h[g].referenced_size-1,T+=h[g].referenced_size,e(t,null,{start:y,end:_},S,m)}else n.debug("Parsing segments from SIDX. representation "+t.adaptation.type+" - id: "+t.id+" for range : "+m.range.start+" - "+m.range.end),p=function(e,t){for(var n=e.references,i=n.length,a=e.timescale,o=e.earliest_presentation_time,s=t.range.start+e.offset+e.first_offset+e.size,u=[],l=void 0,c=void 0,d=void 0,h=void 0,f=0;f<i;f++)d=n[f].subsegment_duration,h=n[f].referenced_size,(l=new r.default).duration=d,l.startTime=o,l.timescale=a,c=s+h-1,l.mediaRange=s+"-"+c,u.push(l),o+=d,s+=h;return u}(d,m),o(p,t,i)}else{if(d)m.range.start=d.offset||m.range.start,m.range.end=m.range.start+(d.size||s);else{if(l<m.bytesLoaded)return void o(null,t,i);var w=c.getLastBox();w&&w.size?(m.range.start=w.offset+w.size,m.range.end=m.range.start+s):m.range.end+=s}e(t,i,m.range,o,m)}},error:function(){o(null,t,i)}}),n.debug("Perform SIDX load: "+m.url+" with range : "+m.range.start+" - "+m.range.end)},reset:function(){f.abort(),f=null,a=null,u=null,l=null}}}l.__dashjs_factory_name="SegmentBaseLoader",t.default=a.default.getSingletonFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(981)),i=c(n(9)),a=c(n(2)),o=c(n(139)),s=c(n(59)),u=c(n(93)),l=c(n(25));function c(e){return e&&e.__esModule?e:{default:e}}function d(){var e=this.context,t=void 0,n=void 0,a=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0;function b(t,i,s,u){var l,c,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0;for(h=[],p=0,c=(l=function(t){var n=[],i=(0,r.default)(e).create({data:t}),o=void 0,s=void 0;for(i.consumeTagAndSize(a.Segment.Cues);i.moreData()&&i.consumeTagAndSize(a.Segment.Cues.CuePoint,!0);){for((o={}).CueTime=i.parseTag(a.Segment.Cues.CuePoint.CueTime),o.CueTracks=[];i.moreData()&&i.consumeTag(a.Segment.Cues.CuePoint.CueTrackPositions,!0);){var u=i.getMatroskaCodedNum(),l=i.getPos();if((s={}).Track=i.parseTag(a.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===s.Track)throw new Error("Cue track cannot be 0");s.ClusterPosition=i.parseTag(a.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),o.CueTracks.push(s),i.setPos(l+u)}if(0===o.CueTracks.length)throw new Error("Mandatory cuetrack not found");n.push(o)}if(0===n.length)throw new Error("mandatory cuepoint not found");return n}(t)).length;p<c;p+=1)f=new o.default,d=0,d=p<l.length-1?l[p+1].CueTime-l[p].CueTime:u-l[p].CueTime,f.duration=d,f.startTime=l[p].CueTime,f.timescale=1e3,m=l[p].CueTracks[0].ClusterPosition+i,g=p<l.length-1?l[p+1].CueTracks[0].ClusterPosition+i-1:s-1,f.mediaRange=m+"-"+g,h.push(f);return n.debug("Parsed cues: "+h.length+" cues."),h}function E(){if(!_||!_.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function T(e,t,n){e?g.trigger(v.SEGMENTS_LOADED,{segments:e,representation:t,mediaType:n}):g.trigger(v.SEGMENTS_LOADED,{segments:null,representation:t,mediaType:n,error:new l.default(y.SEGMENT_BASE_LOADER_ERROR_CODE,y.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function S(e){var t=new s.default;return t.setInfo(e),t}return t={setConfig:function(e){if(!(e.baseURLController&&e.dashMetrics&&e.mediaPlayerModel&&e.errHandler))throw new Error(i.default.MISSING_CONFIG_ERROR);_=e.baseURLController,h=e.dashMetrics,f=e.mediaPlayerModel,c=e.errHandler,m=e.settings,v=e.events,g=e.eventBus,y=e.errors,n=e.debug.getLogger(t),d=e.requestModifier},initialize:function(){p=(0,u.default)(e).create({errHandler:c,dashMetrics:h,mediaPlayerModel:f,requestModifier:d,useFetch:m?m.get().streaming.lowLatencyEnabled:null,errors:y})},loadInitialization:function(e,t){E();var r=null,i=e?_.resolve(e.path):null,a=e?e.range.split("-"):null,o=t||{range:{start:a?parseFloat(a[0]):null,end:a?parseFloat(a[1]):null},request:r,url:i?i.url:void 0,init:!0,mediaType:e&&e.adaptation?e.adaptation.type:null};n.info("Start loading initialization."),r=S(o),p.load({request:r,success:function(){g.trigger(v.INITIALIZATION_LOADED,{representation:e})},error:function(){g.trigger(v.INITIALIZATION_LOADED,{representation:e})}}),n.debug("Perform init load: "+o.url)},loadSegments:function(t,i,o,s){E();var u=null,l=t?_.resolve(t.path):null,c=l?l.url:void 0,d={bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:u,url:c,init:!1,mediaType:t&&t.adaptation?t.adaptation.type:null};s=s||T,u=S(d),n.debug("Parsing ebml header"),p.load({request:u,success:function(u){!function(t,i,o,s){if(t&&0!==t.byteLength){var u,l=(0,r.default)(e).create({data:t}),c=void 0,d=void 0,h=void 0,f=o?o.split("-"):null,m=null,g={url:i,range:{start:f?parseFloat(f[0]):null,end:f?parseFloat(f[1]):null},request:m};for(n.debug("Parse EBML header: "+g.url),l.skipOverElement(a.EBML),l.consumeTag(a.Segment),h=l.getMatroskaCodedNum(),h+=l.getPos(),u=l.getPos();l.moreData()&&!l.consumeTagAndSize(a.Segment.Info,!0);)if(!(l.skipOverElement(a.Segment.SeekHead,!0)||l.skipOverElement(a.Segment.Tracks,!0)||l.skipOverElement(a.Segment.Cues,!0)||l.skipOverElement(a.Void,!0)))throw new Error("no valid top level element found");for(;void 0===c;){var v=l.getMatroskaCodedNum(!0),y=l.getMatroskaCodedNum();switch(v){case a.Segment.Info.Duration.tag:c=l[a.Segment.Info.Duration.parse](y);break;default:l.setPos(l.getPos()+y)}}m=S(g),p.load({request:m,success:function(e){d=b(e,u,h,c),s(d)},error:function(){n.error("Download Error: Cues "+g.url),s(null)}}),n.debug("Perform cues load: "+g.url+" bytes="+g.range.start+"-"+g.range.end)}else s(null)}(u,c,o,(function(e){s(e,t,i)}))},error:function(){s(null,t,i)}})},reset:function(){c=null,d=null}},a={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},t}d.__dashjs_factory_name="WebmSegmentBaseLoader",t.default=a.default.getSingletonFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t=void 0,n=new DataView(e.data),r=0;function i(e,t){var i=!0,a=0;if(void 0===t&&(t=!1),e.tag>16777215?(n.getUint32(r)!==e.tag&&(i=!1),a=4):e.tag>65535?(256*n.getUint16(r)+n.getUint8(r+2)!==e.tag&&(i=!1),a=3):e.tag>255?(n.getUint16(r)!==e.tag&&(i=!1),a=2):(n.getUint8(r)!==e.tag&&(i=!1),a=1),!i&&e.required&&!t)throw new Error("required tag not found");return i&&(r+=a),i}function a(e){var t=1,i=128,a=-1,o=0,s=n.getUint8(r),u=0;for(u=0;u<8;u+=1){if((s&i)===i){o=void 0===e?s&~i:s,a=u;break}i>>=1}for(u=0;u<a;u+=1,t+=1)o=o<<8|255&n.getUint8(r+t);return r+=t,o}return t={getPos:function(){return r},setPos:function(e){r=e},consumeTag:i,consumeTagAndSize:function(e,t){var n=i(e,t);return n&&a(),n},parseTag:function(e){var n;return i(e),n=a(),t[e.parse](n)},skipOverElement:function(e,t){var n=i(e,t),o=void 0;return n&&(o=a(),r+=o),n},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t=void 0;switch(e){case 4:t=n.getFloat32(r),r+=4;break;case 8:t=n.getFloat64(r),r+=8}return t},getMatroskaUint:function(e){for(var t=0,i=0;i<e;i+=1)t<<=8,t|=255&n.getUint8(r+i);return r+=e,t},moreData:function(){return r<n.byteLength}}}o.__dashjs_factory_name="EBMLParser",t.default=a.default.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(33)),i=d(n(983)),a=d(n(984)),o=d(n(985)),s=d(n(986)),u=d(n(190)),l=d(n(2)),c=d(n(146));function d(e){return e&&e.__esModule?e:{default:e}}function h(){var e,t=void 0,n=void 0,l=void 0,d=void 0,h=void 0,f=void 0,p=this.context;function m(e,i,a){var o,s=t.getAdaptationsForType(n[0].mpd.manifest,e,i);if(!s||0===s.length)return null;if(s.length>1&&a){var u=g(a,i);if(d[a.id]&&d[a.id][i])for(var l=0,c=s.length;l<c;l++)if(d[a.id][i].isMediaInfoEqual(u[l]))return s[l];for(var h=0,f=s.length;h<f;h++)if(o=s[h],t.getRolesForAdaptation(o).filter((function(e){return e.value===r.default.MAIN}))[0])return s[h]}return s[0]}function g(e,r,i){var a,o=n,s=i,u=[],c=void 0,d=void 0,f=void 0,p=void 0,m=void 0,g=void 0;if(s)x(),o=v(s);else{if(!(n.length>0))return u;s=n[0].mpd.manifest}var y=T(e,o);y&&(g=y.id);var _=t.getAdaptationsForType(s,e?e.index:null,r!==h.EMBEDDED_TEXT?r:h.VIDEO);if(!_||0===_.length)return u;for(l[g]=l[g]||t.getAdaptationsForPeriod(y),p=0,a=_.length;p<a;p++)if(c=_[p],f=t.getIndexForAdaptation(c,s,e.index),d=S(l[g][f]),r===h.EMBEDDED_TEXT){var b=d.accessibility.length;for(m=0;m<b;m++)if(d){var E=d.accessibility[m];if(0===E.indexOf("cea-608:")){var A=E.substring(8).split(";");if("CC"===A[0].substring(0,2))for(m=0;m<A.length;m++)d||(d=S.call(this,l[g][f])),w(d,A[m].substring(0,3),A[m].substring(4)),u.push(d),d=null;else for(m=0;m<A.length;m++)d||(d=S.call(this,l[g][f])),w(d,"CC"+(m+1),A[m]),u.push(d),d=null}else 0===E.indexOf("cea-608")&&(w(d,h.CC1,"eng"),u.push(d),d=null)}}else r===h.IMAGE?(d.type=h.IMAGE,u.push(d),d=null):d&&u.push(d);return u}function v(e){var n=y(e);return t.getRegularPeriods(n)}function y(e){var n=b(e);return t.getMpd(n)}function _(){n=[],l={},d={}}function b(e){return e||(n.length>0?n[0].mpd.manifest:null)}function E(e){return e&&e.streamInfo&&void 0!==e.streamInfo.id&&l[e.streamInfo.id]?l[e.streamInfo.id][e.index]:null}function T(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r];if(e&&e.id===i.id)return i}return null}function S(e){if(!e)return null;var n,r=new a.default,i=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];return r.id=e.id,r.index=e.index,r.type=e.type,r.streamInfo=A(e.period),r.representationCount=t.getRepresentationCount(i),r.labels=t.getLabelsForAdaptation(i),r.lang=t.getLanguageForAdaptation(i),n=t.getViewpointForAdaptation(i),r.viewpoint=n?n.value:void 0,r.accessibility=t.getAccessibilityForAdaptation(i).map((function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==f&&(n=t?"cea-608:"+t:"cea-608",r.embeddedCaptions=!0),n})),r.audioChannelConfiguration=t.getAudioChannelConfigurationForAdaptation(i).map((function(e){return e.value})),0===r.audioChannelConfiguration.length&&Array.isArray(i.Representation_asArray)&&i.Representation_asArray.length>0&&(r.audioChannelConfiguration=t.getAudioChannelConfigurationForRepresentation(i.Representation_asArray[0]).map((function(e){return e.value}))),r.roles=t.getRolesForAdaptation(i).map((function(e){return e.value})),r.codec=t.getCodec(i),r.mimeType=t.getMimeType(i),r.contentProtection=t.getContentProtectionData(i),r.bitrateList=t.getBitrateListForAdaptation(i),r.contentProtection&&r.contentProtection.forEach((function(e){e.KID=t.getKID(e)})),r.isText=t.getIsTextTrack(r.mimeType),r.supplementalProperties=t.getSupplementalPropperties(i),r}function w(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=h.EMBEDDED_TEXT,e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=n,e.roles=["caption"]}function A(e){var n,r,i=new o.default;return i.id=e.id,i.index=e.index,i.start=e.start,i.duration=e.duration,i.manifestInfo=(n=e.mpd,(r=new s.default).DVRWindowSize=n.timeShiftBufferDepth,r.loadedTime=n.manifest.loadedTime,r.availableFrom=n.availabilityStartTime,r.minBufferTime=n.manifest.minBufferTime,r.maxFragmentDuration=n.maxSegmentDuration,r.duration=t.getDuration(n.manifest),r.isDynamic=t.getIsDynamic(n.manifest),r.serviceDescriptions=t.getServiceDescriptions(n.manifest),r.protocol=n.manifest.protocol,r),i.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(i.start+i.duration-i.manifestInfo.duration)<1,i}function x(){if(!h)throw new Error("setConfig function has to be called previously")}function M(e){return n.length>0?n[0].mpd.manifest.Period_asArray[e]:null}function C(e,t,n){var r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;if(e)for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)for(a=r[o].Representation_asArray,s=0;s<a.length;s+=1)if(t===(i=a[s]).id)return n?s:i;return null}return e={getBandwidthForRepresentation:function(e,t){var n;return(n=C(M(t),e))?n.bandwidth:null},getIndexForRepresentation:function(e,t){return function(e,t){var n=C(e,t,!0);return null!==n?n:-1}(M(t),e)},getMaxIndexForBufferType:function(e,n){return function(e,n){var r=void 0,i=void 0,a=void 0,o=void 0;if(!e||!n)return-1;for(i=e.AdaptationSet_asArray,o=0;o<i.length;o+=1)if(a=(r=i[o]).Representation_asArray,t.getIsTypeOf(r,n))return a.length;return-1}(M(n),e)},convertDataToRepresentationInfo:function(e){if(e){var n=new i.default,r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],a=t.getRepresentationFor(e.index,r);return n.id=e.id,n.quality=e.index,n.bandwidth=t.getBandwidth(a),n.DVRWindow=e.segmentAvailabilityRange,n.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),n.MSETimeOffset=e.MSETimeOffset,n.useCalculatedLiveEdgeTime=e.useCalculatedLiveEdgeTime,n.mediaInfo=S(e.adaptation),n}return null},getDataForMedia:E,getStreamsInfo:function(e,t){var r=[],i=n;if(e&&(x(),i=v(e)),i.length>0){(!t||t>i.length)&&(t=i.length);for(var a=0;a<t;a++)r.push(A(i[a]))}return r},getMediaInfoForType:function(e,r){if(0===n.length||!e)return null;var i=T(e,n);if(!i)return null;var a=i.id;l[a]=l[a]||t.getAdaptationsForPeriod(i);var o=m(e.index,r,e);if(!o)return null;var s=t.getIndexForAdaptation(o,n[0].mpd.manifest,e.index);return S(l[a][s])},getAllMediaInfoForType:g,getAdaptationForType:m,getRealAdaptation:function(e,r){var i,a=void 0,o=T(e,n);return i=r?r.id:null,n.length>0&&o&&(a=i?t.getAdaptationForId(i,n[0].mpd.manifest,o.index):t.getAdaptationForIndex(r?r.index:null,n[0].mpd.manifest,o.index)),a},getVoRepresentations:function(e){var n=E(e);return t.getRepresentationsForAdaptation(n)},getEventsFor:function(e,r){var s=[];if(n.length>0){var u=n[0].mpd.manifest;e instanceof o.default?s=t.getEventsForPeriod(T(e,n)):e instanceof a.default?s=t.getEventStreamForAdaptationSet(u,E(e)):e instanceof i.default&&(s=t.getEventStreamForRepresentation(u,r))}return s},getEvent:function(e,t,n){if(!e||!t)return null;var r=new u.default,i=e.scheme_id_uri,a=e.value,o=e.timescale,s=e.presentation_time_delta,l=e.event_duration,c=e.id,d=e.message_data,h=n*o+s;return t[i+"/"+a]?(r.eventStream=t[i+"/"+a],r.eventStream.value=a,r.eventStream.timescale=o,r.duration=l,r.id=c,r.calculatedPresentationTime=h,r.messageData=d,r.presentationTimeDelta=s,r):null},setConfig:function(e){e&&(e.constants&&(h=e.constants),e.cea608parser&&(f=e.cea608parser),e.errHandler&&t.setConfig({errHandler:e.errHandler}),e.BASE64&&t.setConfig({BASE64:e.BASE64}))},updatePeriods:function(e){if(!e)return null;x(),n=v(e),l={}},getUseCalculatedLiveEdgeTimeForMediaInfo:function(e){var n=E(e);return t.getUseCalculatedLiveEdgeTimeForAdaptation(n)},getIsTextTrack:function(e){return t.getIsTextTrack(e)},getUTCTimingSources:function(){var e=b();return t.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=n.length>0?n[0].mpd:null;return t.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){var n=y(e);return t.getAvailabilityStartTime(n)},getIsDynamic:function(e){var n=b(e);return t.getIsDynamic(n)},getDuration:function(e){var n=b(e);return t.getDuration(n)},getRegularPeriods:v,getLocation:function(e){return t.getLocation(e)},getManifestUpdatePeriod:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.getManifestUpdatePeriod(e,n)},getIsDVB:function(e){return t.hasProfile(e,"urn:dvb:dash:profile:dvb-dash:2014")},getBaseURLsFromElement:function(e){return t.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return t.getRepresentationSortFunction()},getCodec:function(e,n,r){return t.getCodec(e,n,r)},getVoAdaptations:function(){return l},getVoPeriods:function(){return n},setCurrentMediaInfo:function(e,t,n){d[e]=d[e]||{},d[e][t]=d[e][t]||{},d[e][t]=n},reset:_},t=(0,c.default)(p).getInstance(),_(),e}h.__dashjs_factory_name="DashAdapter",t.default=l.default.getSingletonFactory(h)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null}return r(e,[{key:"isMediaInfoEqual",value:function(e){if(!e)return!1;var t=this.id===e.id,n=this.viewpoint===e.viewpoint,r=this.lang===e.lang,i=this.roles.toString()===e.roles.toString(),a=this.accessibility.toString()===e.accessibility.toString(),o=this.audioChannelConfiguration.toString()===e.audioChannelConfiguration.toString();return t&&n&&r&&i&&a&&o}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(9)),i=n(34),a=c(n(2)),o=c(n(36)),s=c(n(988)),u=c(n(989)),l=n(141);function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t,n=this.context,a=void 0,c=void 0,d=void 0,h=e.metricsModel;function f(e){var t=h.getMetricsFor(e,!0);if(!t)return null;var n=t.HttpList,r=null,i=void 0;if(!n||n.length<=0)return null;for(i=n.length-1;i>=0;){if(n[i].responsecode){r=n[i];break}i--}return r}function p(e){var t=h.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[]}function m(e,t){if(!e)return null;var n=e[t];return n&&0!==n.length?n[n.length-1]:null}function g(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var a=n[r],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}return t={getCurrentRepresentationSwitch:function(e){return m(h.getMetricsFor(e,!0),o.default.TRACK_SWITCH)},getCurrentBufferState:function(e){return m(h.getMetricsFor(e,!0),o.default.BUFFER_STATE)},getCurrentBufferLevel:function(e){var t=m(h.getMetricsFor(e,!0),o.default.BUFFER_LEVEL);return t?s.default.round10(t.level/1e3,-3):0},getCurrentHttpRequest:f,getHttpRequests:p,getCurrentDroppedFrames:function(){return m(h.getMetricsFor(r.default.VIDEO,!0),o.default.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return m(h.getMetricsFor(e,!0),o.default.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return m(e?h.getMetricsFor(e,!0):h.getMetricsFor(r.default.VIDEO,!0)||h.getMetricsFor(r.default.AUDIO,!0),o.default.DVR_INFO)},getCurrentManifestUpdate:function(){return m(h.getMetricsFor(r.default.STREAM),o.default.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){var n={},r=f(e);return r&&(n=g(r._responseHeaders)),void 0===n[t]?null:n[t]},getLatestMPDRequestHeaderValueByID:function(e){var t,n={},a=void 0,o=void 0;for(o=(t=p(r.default.STREAM)).length-1;o>=0;o--)if((a=t[o]).type===i.HTTPRequest.MPD_TYPE){n=g(a._responseHeaders);break}return void 0===n[e]?null:n[e]},addRepresentationSwitch:function(e,t,n,r,i){h.addRepresentationSwitch(e,t,n,r,i)},addDVRInfo:function(e,t,n,r){h.addDVRInfo(e,t,n,r)},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();h.updateManifestUpdateInfo(t,e)},addManifestUpdateStreamInfo:function(e){if(e){var t=this.getCurrentManifestUpdate();h.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration)}},addManifestUpdateRepresentationInfo:function(e,t){if(e){var n=this.getCurrentManifestUpdate();h.addManifestUpdateRepresentationInfo(n,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType)}},addManifestUpdate:function(e){h.addManifestUpdate(r.default.STREAM,e.type,e.requestStartDate,e.requestEndDate)},addHttpRequest:function(e,t,n,r,i){h.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,n,e.duration,r,i)},addSchedulingInfo:function(e,t){h.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t)},addRequestsQueue:function(e,t,n){h.addRequestsQueue(e,t,n)},addBufferLevel:function(e,t,n){h.addBufferLevel(e,t,n)},addBufferState:function(e,t,n){h.addBufferState(e,t,n)},addDroppedFrames:function(e){h.addDroppedFrames(r.default.VIDEO,e)},addPlayList:function(){d&&(h.addPlayList(d),d=null)},addDVBErrors:function(e){h.addDVBErrors(e)},createPlaylistMetrics:function(e,t){(d=new l.PlayList).start=new Date,d.mstart=e,d.starttype=t},createPlaylistTraceMetrics:function(e,t,n){!0===a&&(a=!1,(c=new l.PlayListTrace).representationid=e,c.start=new Date,c.mstart=t,c.playbackspeed=null!==n?n.toString():null)},updatePlayListTraceMetrics:function(e){if(c)for(var t in c)c[t]=e[t]},pushPlayListTraceMetrics:function(e,t){if(!1===a&&d&&c&&c.start){var n=c.start,r=e.getTime()-n.getTime();c.duration=r,c.stopreason=t,d.trace.push(c),a=!0}},clearAllCurrentMetrics:function(){h.clearAllCurrentMetrics()}},h=h||(0,u.default)(n).getInstance({settings:e.settings}),a=!0,c=null,d=null,t}d.__dashjs_factory_name="DashMetrics",t.default=a.default.getSingletonFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"round10",value:function(e,t){return function(e,t,n){if(void 0===n||0==+n)return Math[e](t);if(n=+n,null===(t=+t)||isNaN(t)||!("number"==typeof n&&n%1==0))return NaN;return t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))}("round",e,t)}}]),e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=y(n(9)),i=y(n(36)),a=y(n(990)),o=n(34),s=y(n(991)),u=y(n(992)),l=y(n(993)),c=y(n(994)),d=y(n(995)),h=n(996),f=y(n(997)),p=y(n(16)),m=y(n(998)),g=y(n(18)),v=y(n(2));function y(e){return e&&e.__esModule?e:{default:e}}function _(e){var t,n=(e=e||{}).settings,v=this.context,y=(0,p.default)(v).getInstance(),_=void 0;function b(){y.trigger(g.default.METRICS_CHANGED)}function E(e){y.trigger(g.default.METRIC_CHANGED,{mediaType:e}),b()}function T(e,t,n){y.trigger(g.default.METRIC_UPDATED,{mediaType:e,metric:t,value:n}),E(e)}function S(e,t,n){y.trigger(g.default.METRIC_ADDED,{mediaType:e,metric:t,value:n}),E(e)}function w(e,t){var n=null;return e?(_.hasOwnProperty(e)?n=_[e]:t||(n=new a.default,_[e]=n),n):n}function A(e,t,r){var i=w(e);null!==i&&(i[t].push(r),i[t].length>n.get().streaming.metricsMaxListDepth&&i[t].shift())}function x(e,t,n){A(e,t,n),S(e,t,n)}return t={clearCurrentMetricsForType:function(e){delete _[e],E(e)},clearAllCurrentMetrics:function(){_={},b()},getMetricsFor:w,addHttpRequest:function e(t,n,r,a,s,u,l,c,d,h,f,p,m,g,v){var y=new o.HTTPRequest;u&&u!==a&&(e(t,null,r,a,s,null,null,c,d,null,null,null,m,null,null),y.actualurl=u),y.tcpid=n,y.type=r,y.url=a,y.range=c,y.trequest=d,y.tresponse=h,y.responsecode=p,y._tfinish=f,y._stream=t,y._mediaduration=m,y._quality=s,y._responseHeaders=g,y._serviceLocation=l,v?v.forEach((function(e){!function(e,t,n,r){var i=new o.HTTPRequestTrace;i.s=t,i.d=n,i.b=r,e.trace.push(i),e.interval||(e.interval=0),e.interval+=n}(y,e.s,e.d,e.b)})):(delete y.interval,delete y.trace),x(t,i.default.HTTP_REQUEST,y)},addRepresentationSwitch:function(e,t,n,r,a){var o=new s.default;o.t=t,o.mt=n,o.to=r,a?o.lto=a:delete o.lto,x(e,i.default.TRACK_SWITCH,o)},addBufferLevel:function(e,t,n){var r=new u.default;r.t=t,r.level=n,x(e,i.default.BUFFER_LEVEL,r)},addBufferState:function(e,t,n){var r=new l.default;r.target=n,r.state=t,x(e,i.default.BUFFER_STATE,r)},addDVRInfo:function(e,t,n,r){var a=new c.default;a.time=t,a.range=r,a.manifestInfo=n,x(e,i.default.DVR_INFO,a)},addDroppedFrames:function(e,t){var n=new d.default,r=w(e).DroppedFrames;t&&(n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,r.length>0&&r[r.length-1]==n||x(e,i.default.DROPPED_FRAMES,n))},addSchedulingInfo:function(e,t,n,r,a,o,s,u,l){var c=new f.default;c.mediaType=e,c.t=t,c.type=n,c.startTime=r,c.availabilityStartTime=a,c.duration=o,c.quality=s,c.range=u,c.state=l,x(e,i.default.SCHEDULING_INFO,c)},addRequestsQueue:function(e,t,n){var r=new m.default;r.loadingRequests=t,r.executedRequests=n,w(e).RequestsQueue=r,S(e,i.default.REQUESTS_QUEUE,r)},addManifestUpdate:function(e,t,n,a,o,s,u,l,c,d){var f=new h.ManifestUpdate;f.mediaType=e,f.type=t,f.requestTime=n,f.fetchTime=a,f.availabilityStartTime=o,f.presentationStartTime=s,f.clientTimeOffset=u,f.currentTime=l,f.buffered=c,f.latency=d,A(r.default.STREAM,i.default.MANIFEST_UPDATE,f),S(e,i.default.MANIFEST_UPDATE,f)},updateManifestUpdateInfo:function(e,t){if(e){for(var n in t)e[n]=t[n];T(e.mediaType,i.default.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,n,r,a){if(e){var o=new h.ManifestUpdateStreamInfo;o.id=t,o.index=n,o.start=r,o.duration=a,e.streamInfo.push(o),T(e.mediaType,i.default.MANIFEST_UPDATE_STREAM_INFO,e)}},addManifestUpdateRepresentationInfo:function(e,t,n,r,a,o,s,u){if(e&&e.representationInfo){var l=new h.ManifestUpdateRepresentationInfo;l.id=t,l.index=n,l.streamIndex=r,l.mediaType=a,l.startNumber=s,l.fragmentInfoType=u,l.presentationTimeOffset=o,e.representationInfo.push(l),T(e.mediaType,i.default.MANIFEST_UPDATE_TRACK_INFO,e)}},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach((function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel})):delete e.trace,x(r.default.STREAM,i.default.PLAY_LIST,e)},addDVBErrors:function(e){x(r.default.STREAM,i.default.DVB_ERRORS,e)}},_={},t}_.__dashjs_factory_name="MetricsModel",t.default=v.default.getSingletonFactory(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.level=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(36),a=(r=i)&&r.__esModule?r:{default:r};t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=null,this.state=a.default.BUFFER_EMPTY}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.range=null,this.manifestInfo=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.droppedFrames=null}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});t.ManifestUpdate=function e(){r(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},t.ManifestUpdateStreamInfo=function e(){r(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},t.ManifestUpdateRepresentationInfo=function e(){r(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingRequests=[],this.executedRequests=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(16)),i=u(n(18)),a=u(n(2)),o=u(n(33)),s=u(n(146));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e,t=this.context,n=(0,r.default)(t).getInstance(),a=void 0,u=void 0,l=void 0,c=void 0;function d(e){u=e}function h(e,t,n,r){return r?n&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:n?new Date(t.availabilityStartTime.getTime()+1e3*(e-u)):t.availabilityStartTime}function f(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*u)/1e3}function p(e){l||void 0!==e.offset&&(d(e.offset/1e3),l=!0)}function m(){u=0,l=!1,c=NaN}function g(){n.off(i.default.TIME_SYNCHRONIZATION_COMPLETED,p,this),m()}return e={initialize:function(){m(),n.on(i.default.TIME_SYNCHRONIZATION_COMPLETED,p,this)},isTimeSyncCompleted:function(){return l},setTimeSyncCompleted:function(e){l=e},getClientTimeOffset:function(){return u},setClientTimeOffset:d,getExpectedLiveEdge:function(){return c},setExpectedLiveEdge:function(e){c=e},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return h.call(this,e,t,n)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return h.call(this,e,t,n,!0)},calcPresentationTimeFromWallTime:f,calcPresentationTimeFromMediaTime:function(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)},calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcSegmentAvailabilityRange:function(e,t){var n=e.adaptation.period,r={start:n.start,end:n.start+n.duration};if(!t)return r;if(!l&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var i=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0);if(e.segmentInfoType===o.default.SEGMENT_TIMELINE&&n.mpd.timeShiftBufferDepth===Number.POSITIVE_INFINITY)return function(e){var t=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],n=a.getRepresentationFor(e.index,t),r=n.SegmentTemplate.SegmentTimeline,i=n.SegmentTemplate.timescale,o=r.S_asArray,s={start:0,end:0},u=0,l=void 0,c=void 0,d=void 0,h=void 0;for(s.start=o[0].t/i,d=0,h=o.length;d<h;d++)c=0,(l=o[d]).hasOwnProperty("r")&&(c=l.r),u+=l.d/i*(1+c);return s.end=s.start+u,s}(e);var s=f(new Date,n),u=n.start+n.duration;r.start=Math.max(s-n.mpd.timeShiftBufferDepth,n.start);var c=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<i?i-e.availabilityTimeOffset:i;return r.end=s>=u&&s-c<u?u:s-c,r},getPeriodEnd:function(e,t){var n=e.adaptation.period;if(!t)return n.start+n.duration;if(!l&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var r=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),i=f(new Date,n),a=n.start+n.duration,o=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<r?r-e.availabilityTimeOffset:r;return Math.min(i-o,a)},calcWallTimeForSegment:function(e,t){var n=void 0,r=void 0,i=void 0;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i},reset:g},a=(0,s.default)(t).getInstance(),g(),e}l.__dashjs_factory_name="TimelineConverter",t.default=a.default.getSingletonFactory(l)},function(e,t,n){"use strict";var r={encode:function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},decode:function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?(r=(31&r)<<6,r|=63&e[n++]):r<240?(r=(15&r)<<12,r|=(63&e[n++])<<6,r|=63&e[n++]):(r=(7&r)<<18,r|=(63&e[n++])<<12,r|=(63&e[n++])<<6,r|=63&e[n++])),t.push(String.fromCharCode(r))}return t.join("")}},i={};!function(e){var t=function(t){for(var n=0,r=[],i=0|t.length/3;0<i--;){var a=(t[n]<<16)+(t[n+1]<<8)+t[n+2];n+=3,r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push(e.charAt(63&a>>6)),r.push(e.charAt(63&a))}if(2==t.length-n){a=(t[n]<<16)+(t[n+1]<<8);r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push(e.charAt(63&a>>6)),r.push("=")}else if(1==t.length-n){a=t[n]<<16;r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push("==")}return r.join("")},n=function(){for(var t=[],n=0;n<e.length;++n)t[e.charCodeAt(n)]=n;return t["=".charCodeAt(0)]=0,t}(),o=function(e){for(var t=0,r=[],i=0|e.length/4;0<i--;){var a=(n[e.charCodeAt(t)]<<18)+(n[e.charCodeAt(t+1)]<<12)+(n[e.charCodeAt(t+2)]<<6)+n[e.charCodeAt(t+3)];r.push(255&a>>16),r.push(255&a>>8),r.push(255&a),t+=4}return r&&("="==e.charAt(t-2)?(r.pop(),r.pop()):"="==e.charAt(t-1)&&r.pop()),r},u={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}};i.decodeArray=function(e){var t=o(e);return new Uint8Array(t)},i.encodeASCII=function(e){var n=u.encode(e);return t(n)},i.decodeASCII=function(e){var t=o(e);return u.decode(t)},i.encode=function(e){var n=r.encode(e);return t(n)},i.decode=function(e){var t=o(e);return r.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),t.decode=i.decode,t.decodeArray=i.decodeArray,t.encode=i.encode,t.encodeASCII=i.encodeASCII},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1002)),i=u(n(111)),a=u(n(1004)),o=u(n(199)),s=u(n(198));function u(e){return e&&e.__esModule?e:{default:e}}function l(){var e=this.context;return{createMetricsReporting:function(t){return(0,r.default)(e).getInstance({eventBus:t.eventBus,dashMetrics:t.dashMetrics,metricsConstants:t.metricsConstants,events:t.events}),(0,a.default)(e).create(t)},getReportingFactory:function(){return(0,s.default)(e).getInstance()},getMetricsHandlerFactory:function(){return(0,o.default)(e).getInstance()}}}l.__dashjs_factory_name="MetricsReporting";var c=dashjs.FactoryMaker.getClassFactory(l);c.events=i.default,dashjs.FactoryMaker.updateClassFactory(l.__dashjs_factory_name,c),t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(1003)),i=a(n(111));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=void 0,n=void 0,a=(e=e||{}).eventBus,o=e.dashMetrics,s=e.metricsConstants,u=e.events;function l(e){var t=new r.default;if(n){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.mpdurl||(t.mpdurl=n.originalUrl||n.url),t.terror||(t.terror=new Date),o.addDVBErrors(t)}}function c(e){e.error||(n=e.manifest)}function d(e){l({errorcode:r.default.BASE_URL_CHANGED,servicelocation:e.entry})}function h(){l({errorcode:r.default.BECAME_REPORTER})}function f(e){switch(e.metric){case s.HTTP_REQUEST:(0===(t=e.value).responsecode||t.responsecode>=400||t.responsecode<100||t.responsecode>=600)&&l({errorcode:t.responsecode||r.default.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation})}var t}function p(e){var t=void 0;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=r.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=r.default.CORRUPT_MEDIA_OTHER;break;default:return}l({errorcode:t})}function m(){a.on(u.MANIFEST_UPDATED,c,t),a.on(u.SERVICE_LOCATION_BLACKLIST_CHANGED,d,t),a.on(u.METRIC_ADDED,f,t),a.on(u.METRIC_UPDATED,f,t),a.on(u.PLAYBACK_ERROR,p,t),a.on(i.default.BECAME_REPORTING_PLAYER,h,t)}return t={initialise:m,reset:function(){a.off(u.MANIFEST_UPDATED,c,t),a.off(u.SERVICE_LOCATION_BLACKLIST_CHANGED,d,t),a.off(u.METRIC_ADDED,f,t),a.off(u.METRIC_UPDATED,f,t),a.off(u.PLAYBACK_ERROR,p,t),a.off(i.default.BECAME_REPORTING_PLAYER,h,t)}},m(),t}o.__dashjs_factory_name="DVBErrorsTranslator",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};r.SSL_CONNECTION_FAILED_PREFIX="SSL",r.DNS_RESOLUTION_FAILED="C00",r.HOST_UNREACHABLE="C01",r.CONNECTION_REFUSED="C02",r.CONNECTION_ERROR="C03",r.CORRUPT_MEDIA_ISOBMFF="M00",r.CORRUPT_MEDIA_OTHER="M01",r.BASE_URL_CHANGED="F00",r.BECAME_REPORTER="S00",t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1005)),i=o(n(1016)),a=o(n(111));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t={},n=this.context,o=e.eventBus,s=e.events;function u(s){if(!s.error){var u=Object.keys(t);(0,i.default)(n).getInstance({adapter:e.adapter,constants:e.constants}).getMetrics(s.manifest).forEach((function(i){var a=JSON.stringify(i);if(t.hasOwnProperty(a))u.splice(a,1);else try{var o=(0,r.default)(n).create(e);o.initialize(i),t[a]=o}catch(e){}})),u.forEach((function(e){t[e].reset(),delete t[e]})),o.trigger(a.default.METRICS_INITIALISATION_COMPLETE)}}function l(){Object.keys(t).forEach((function(e){t[e].reset()})),t={}}return o.on(s.MANIFEST_UPDATED,u),o.on(s.STREAM_TEARDOWN_COMPLETE,l),{reset:function(){o.off(s.MANIFEST_UPDATED,u),o.off(s.STREAM_TEARDOWN_COMPLETE,l)}}}s.__dashjs_factory_name="MetricsCollectionController",t.default=dashjs.FactoryMaker.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1006)),i=o(n(1007)),a=o(n(1011));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){e=e||{};var t=void 0,n=void 0,o=void 0,s=this.context;function u(){t&&t.reset(),n&&n.reset(),o&&o.reset()}return{initialize:function(l){try{(o=(0,r.default)(s).create({mediaElement:e.mediaElement})).initialize(l.Range),(n=(0,i.default)(s).create({debug:e.debug,metricsConstants:e.metricsConstants})).initialize(l.Reporting,o),(t=(0,a.default)(s).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events})).initialize(l.metrics,n)}catch(e){throw u(),e}},reset:u}}s.__dashjs_factory_name="MetricsController",t.default=dashjs.FactoryMaker.getClassFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(177),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t,n=!1,r=this.context,i=void 0,o=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach((function(e){var t=e.starttime,n=t+e.duration;i.add(t,n)})),n=!!e[0]._useWallClockTime)},reset:function(){i.clear()},isEnabled:function(){var e,t=i.length;if(!t)return!0;e=n?(new Date).getTime()/1e3:o.currentTime;for(var r=0;r<t;r+=1){var a=i.start(r),s=i.end(r);if(a<=e&&e<s)return!0}return!1}},i=(0,a.default)(r).create(),t}o.__dashjs_factory_name="RangeController",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(198),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=[],n=(0,a.default)(this.context).getInstance(e);return{initialize:function(e,r){e.some((function(e){var i=n.create(e,r);if(i)return t.push(i),!0}))},reset:function(){t.forEach((function(e){return e.reset()})),t=[]},report:function(e,n){t.forEach((function(t){return t.report(e,n)}))}}}o.__dashjs_factory_name="ReportingController",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(1009)),i=a(n(1010));function a(e){return e&&e.__esModule?e:{default:e}}function o(e){e=e||{};var t,n=this.context,a=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=[],h=e.metricsConstants;function f(){s=!1,u=!1,l=null,c=null}return t={report:function(e,t){Array.isArray(t)||(t=[t]),u&&c.isEnabled()&&t.forEach((function(t){var n=a.serialise(t);e!==h.DVB_ERRORS&&(n="metricname="+e+"&"+n),function(e,t,n){var r=new XMLHttpRequest,i=function(){var e=d.indexOf(r);-1!==e&&(d.splice(e,1),r.status>=200&&r.status<300?t&&t():n&&n())};d.push(r);try{r.open("GET",e),r.onloadend=i,r.onerror=i,r.send()}catch(e){r.onerror()}}(n=l+"?"+n,null,(function(){u=!1}))}))},initialize:function(e,t){var n=void 0;if(c=t,!(l=e["dvb:reportingUrl"]))throw new Error("required parameter missing (dvb:reportingUrl)");s||((n=e["dvb:probability"]||e["dvb:priority"]||0)&&(1e3===n||n/1e3>=o.random())&&(u=!0),s=!0)},reset:function(){f()}},a=(0,r.default)(n).getInstance(),o=(0,i.default)(n).getInstance(),f(),t}o.__dashjs_factory_name="DVBReporting",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";function r(){return{serialise:function e(t){var n=[],r=[],i=void 0,a=void 0;for(i in t)if(t.hasOwnProperty(i)&&0!==i.indexOf("_")){if(null==(a=t[i])&&(a=""),Array.isArray(a)){if(!a.length)continue;r=[],a.forEach((function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);r.push(n?t:e(t))})),a=r.map(encodeURIComponent).join(",")}else"string"==typeof a?a=encodeURIComponent(a):a instanceof Date?a=a.toISOString():"number"==typeof a&&(a=Math.round(a));n.push(i+"="+a)}return n.join("&")}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="MetricSerialiser",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},function(e,t,n){"use strict";function r(){var e,t=window.crypto||window.msCrypto,n=Uint32Array,r=Math.pow(2,8*n.BYTES_PER_ELEMENT)-1,i=void 0,a=void 0;function o(){t&&(i||(i=new n(10)),t.getRandomValues(i),a=0)}return e={random:function(e,n){var s=void 0;return e||(e=0),n||(n=1),t?(a===i.length&&o(),s=i[a]/r,a+=1):s=Math.random(),s*(n-e)+e}},o(),e}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="RNG",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(199),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t=[],n=void 0,r=this.context,i=e.eventBus,o=e.events,s=(0,a.default)(r).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function u(e){t.forEach((function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)}))}return n={initialize:function(e,r){e.split(",").forEach((function(e,n,i){var a;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var o=i[n+1];o&&-1===o.indexOf("(")&&-1!==o.indexOf(")")&&(e+=","+o,delete i[n+1])}(a=s.create(e,r))&&t.push(a)})),i.on(o.METRIC_ADDED,u,n),i.on(o.METRIC_UPDATED,u,n)},reset:function(){i.off(o.METRIC_ADDED,u,n),i.off(o.METRIC_UPDATED,u,n),t.forEach((function(e){return e.reset()})),t=[]}}}o.__dashjs_factory_name="MetricsHandlersController",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(200),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t=void 0,n=void 0,r=void 0,i=void 0,o=void 0,s=this.context,u=(0,a.default)(s).getInstance(),l=[],c=e.metricsConstants;function d(){var e=function(){try{return Object.keys(l).map((function(e){return l[e]})).reduce((function(e,t){return e.level<t.level?e:t}))}catch(e){return}}();e&&o!==e.t&&(o=e.t,t.report(r,e))}return{initialize:function(e,a,o){a&&(n=u.validateN(o),t=a,r=u.reconstructFullMetricName(e,o),i=setInterval(d,n))},reset:function(){clearInterval(i),i=null,n=0,t=null,o=null},handleNewMetric:function(e,t,n){e===c.BUFFER_LEVEL&&(l[n]=t)}}}o.__dashjs_factory_name="BufferLevelHandler",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(111),a=(r=i)&&r.__esModule?r:{default:r};t.default=dashjs.FactoryMaker.getClassFactory((function(e){var t=void 0,n=(e=e||{}).eventBus,r=e.metricsConstants;function i(){n.off(a.default.METRICS_INITIALISATION_COMPLETE,i,this),n.trigger(a.default.BECAME_REPORTING_PLAYER)}return{initialize:function(e,r){r&&(t=r,n.on(a.default.METRICS_INITIALISATION_COMPLETE,i,this))},reset:function(){t=null},handleNewMetric:function(e,n){e===r.DVB_ERRORS&&t&&t.report(e,n)}}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(200),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t=void 0,n=void 0,r=void 0,i=void 0,o=void 0,s=[],u=(0,a.default)(this.context).getInstance(),l=e.metricsConstants;function c(){var e=s;e.length&&t&&t.report(i,e),s=[]}return{initialize:function(e,a,s,l){a&&(n=u.validateN(s),t=a,l&&l.length&&(r=l),i=u.reconstructFullMetricName(e,s,l),o=setInterval(c,n))},reset:function(){clearInterval(o),o=null,n=null,r=null,s=[],t=null},handleNewMetric:function(e,t){e===l.HTTP_REQUEST&&(r&&r!==t.type||s.push(t))}}}o.__dashjs_factory_name="HttpListHandler",t.default=dashjs.FactoryMaker.getClassFactory(o)},function(e,t,n){"use strict";function r(){var e=void 0,t=void 0;return{initialize:function(n,r){e=n,t=r},reset:function(){t=null,e=void 0},handleNewMetric:function(n,r){n===e&&t&&t.report(e,r)}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="GenericMetricHandler",t.default=dashjs.FactoryMaker.getClassFactory(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1017)),i=o(n(1018)),a=o(n(1019));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=(e=e||{}).adapter,n=e.constants;return{getMetrics:function(e){var o=[];return e&&e.Metrics_asArray&&e.Metrics_asArray.forEach((function(s){var u=new r.default,l=t.getIsDynamic(e);s.hasOwnProperty("metrics")&&(u.metrics=s.metrics,s.Range_asArray&&s.Range_asArray.forEach((function(r){var a=new i.default;a.starttime=function(e,r,i){var a=void 0,o=void 0,s=0;return r?s=t.getAvailabilityStartTime(e)/1e3:(a=t.getRegularPeriods(e)).length&&(s=a[0].start),o=s,i&&i.hasOwnProperty(n.START_TIME)&&(o+=i.starttime),o}(e,l,r),r.hasOwnProperty("duration")?a.duration=r.duration:a.duration=t.getDuration(e),a._useWallClockTime=l,u.Range.push(a)})),s.Reporting_asArray&&(s.Reporting_asArray.forEach((function(e){var t=new a.default;if(e.hasOwnProperty(n.SCHEME_ID_URI)){for(var r in t.schemeIdUri=e.schemeIdUri,e)e.hasOwnProperty(r)&&(t[r]=e[r]);u.Reporting.push(t)}})),o.push(u)))})),o}}}s.__dashjs_factory_name="ManifestParsing",t.default=dashjs.FactoryMaker.getSingletonFactory(s)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics="",this.Range=[],this.Reporting=[]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(1021)),i=c(n(112)),a=c(n(1031)),o=c(n(94)),s=c(n(1032)),u=c(n(1033)),l=c(n(1034));function c(e){return e&&e.__esModule?e:{default:e}}var d=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],h=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function f(){var e=void 0,t=this.context;function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r[Object.keys(r)[0]]])return r}return null}return e={createProtectionSystem:function(a){var o=null,c=(0,i.default)(t).getInstance();c.setConfig({debug:a.debug,BASE64:a.BASE64}),c.initialize();var f=function(r){var i=r.debug,a=i.getLogger(e),o=r.eventBus,c=r.errHandler,f=r.videoModel?r.videoModel.getElement():null;return f&&void 0===f.onencrypted||f&&void 0===f.mediaKeys?n(f,h)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,u.default)(t).create({debug:i,eventBus:o,events:r.events,api:n(f,h)})):n(f,d)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,l.default)(t).create({debug:i,eventBus:o,errHandler:c,events:r.events,api:n(f,d)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,s.default)(t).create({debug:i,eventBus:o,events:r.events}))}(a);return!o&&f&&(o=(0,r.default)(t).create({protectionModel:f,protectionKeyController:c,eventBus:a.eventBus,debug:a.debug,events:a.events,BASE64:a.BASE64,constants:a.constants}),a.capabilities.setEncryptedMediaSupported(!0)),o}}}f.__dashjs_factory_name="Protection";var p=dashjs.FactoryMaker.getClassFactory(f);p.events=a.default,p.errors=o.default,dashjs.FactoryMaker.updateClassFactory(f.__dashjs_factory_name,p),t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=l(n(74)),a=l(n(1022)),o=l(n(148)),s=l(n(94)),u=l(n(25));function l(e){return e&&e.__esModule?e:{default:e}}function c(e){var t=(e=e||{}).protectionKeyController,n=e.protectionModel,l=e.eventBus,c=e.events,d=e.debug,h=e.BASE64,f=e.constants,p=[],m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0;function S(){if(!(l&&l.hasOwnProperty("on")&&t&&t.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function w(e,r){var a=i.default.getPSSHForKeySystem(T,e),o=M(T);if(a){for(var d=n.getAllInitData(),h=0;h<d.length;h++)if(t.initDataEquals(a,d[h]))return void g.warn("DRM: Ignoring initData because we have already seen it!");try{n.createKeySession(a,o,R(T),r)}catch(e){l.trigger(c.KEY_SESSION_CREATED,{data:null,error:new u.default(s.default.KEY_SESSION_CREATED_ERROR_CODE,s.default.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)})}}else e?n.createKeySession(e,o,R(T),r):l.trigger(c.KEY_SESSION_CREATED,{data:null,error:new u.default(s.default.KEY_SESSION_CREATED_ERROR_CODE,s.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(T?T.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function A(e,t){S(),n.loadKeySession(e,t,R(T))}function x(e){S(),e?(n.setMediaElement(e),l.on(c.NEED_KEY,L,this)):null===e&&(n.setMediaElement(e),l.off(c.NEED_KEY,L,this))}function M(e){var t=null;if(e){var n=e.systemString;_&&(t=n in _?_[n]:null)}return t}function C(e){var t=M(e),n=[],r=[],i=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:E,s=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:E,u=R(e),l=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",c=t&&t.persistentState?t.persistentState:"temporary"===u?"optional":"required";return y.forEach((function(e){e.type===f.AUDIO?n.push(new a.default(e.codec,i)):e.type===f.VIDEO&&r.push(new a.default(e.codec,s))})),new o.default(n,r,l,c,[u])}function R(e){var t=M(e);return t&&t.sessionType?t.sessionType:b}function I(e,r){var i=this,a=[];e=e.sort((function(t,n){return(_&&_[t.ks.systemString]&&_[t.ks.systemString].priority>=0?_[t.ks.systemString].priority:e.length)-(_&&_[n.ks.systemString]&&_[n.ks.systemString].priority>=0?_[n.ks.systemString].priority:e.length)}));var o=void 0;if(T)for(o=0;o<e.length;o++){if(T===e[o].ks)if("break"===function(){a.push({ks:e[o].ks,configs:[C(T)]});return l.on(c.KEY_SYSTEM_ACCESS_COMPLETE,(function t(n){l.off(c.KEY_SYSTEM_ACCESS_COMPLETE,t,i),n.error?r||l.trigger(c.KEY_SYSTEM_SELECTED,{error:new u.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+n.error)}):(g.info("DRM: KeySystem Access Granted"),l.trigger(c.KEY_SYSTEM_SELECTED,{data:n.data}),e[o].sessionId?A(e[o].sessionId,e[o].initData):e[o].initData&&w(e[o].initData,e[o].cdmData))}),i),n.requestKeySystemAccess(a),"break"}())break}else if(void 0===T){T=null,v.push(e);for(var d=0;d<e.length;d++)a.push({ks:e[d].ks,configs:[C(e[d].ks)]});var f=void 0,p=function e(t){l.off(c.KEY_SYSTEM_ACCESS_COMPLETE,e,i),t.error?(T=void 0,l.off(c.INTERNAL_KEY_SYSTEM_SELECTED,m,i),r||l.trigger(c.KEY_SYSTEM_SELECTED,{data:null,error:new u.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+t.error)})):(f=t.data,g.info("DRM: KeySystem Access Granted ("+f.keySystem.systemString+")!  Selecting key system..."),n.selectKeySystem(f))},m=function e(a){if(l.off(c.INTERNAL_KEY_SYSTEM_SELECTED,e,i),l.off(c.KEY_SYSTEM_ACCESS_COMPLETE,p,i),a.error)T=void 0,r||l.trigger(c.KEY_SYSTEM_SELECTED,{data:null,error:new u.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+a.error)});else{if(!n)return;T=n.getKeySystem(),l.trigger(c.KEY_SYSTEM_SELECTED,{data:f});var d=M(T);d&&d.serverCertificate&&d.serverCertificate.length>0&&n.setServerCertificate(h.decodeArray(d.serverCertificate).buffer);for(var m=0;m<v.length;m++)for(o=0;o<v[m].length;o++)if(T===v[m][o].ks){if(t.isClearKey(T)&&d&&d.hasOwnProperty("clearkeys")){var g={kids:Object.keys(d.clearkeys)};v[m][o].initData=(new TextEncoder).encode(JSON.stringify(g))}v[m][o].sessionId?A(v[m][o].sessionId,v[m][o].initData):null!==v[m][o].initData&&w(v[m][o].initData,v[m][o].cdmData);break}}};l.on(c.INTERNAL_KEY_SYSTEM_SELECTED,m,i),l.on(c.KEY_SYSTEM_ACCESS_COMPLETE,p,i),n.requestKeySystemAccess(a)}else v.push(e)}function O(e,t){l.trigger(c.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function D(e){e.error?l.trigger(c.KEY_STATUSES_CHANGED,{data:null,error:e.error}):g.debug("DRM: key status = "+e.status)}function P(e){g.debug("DRM: onKeyMessage");var a=e.data;l.trigger(c.KEY_MESSAGE,{data:a});var o=a.messageType?a.messageType:"license-request",d=a.message,h=a.sessionToken,f=M(T),p=T?T.systemString:null,m=t.getLicenseServer(T,f,o),v={sessionToken:h,messageType:o};if(d&&0!==d.byteLength){if(!m)return g.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+h.getSessionID()),void O(v);if(t.isClearKey(T)){var y=t.processClearKeyLicenseRequest(T,f,d);if(y)return g.debug("DRM: ClearKey license request handled by application!"),O(v),void n.updateKeySession(h,y)}var _=null;if(f&&f.serverURL){var b=f.serverURL;"string"==typeof b&&""!==b?_=b:"object"===(void 0===b?"undefined":r(b))&&b.hasOwnProperty(o)&&(_=b[o])}else f&&f.laURL&&""!==f.laURL?_=f.laURL:(_=T.getLicenseServerURLFromInitData(i.default.getPSSHData(h.initData)))||(_=e.data.laURL);if(_=m.getServerURLFromMessage(_,d,o)){var E={},S=!1,w=function(e){if(e)for(var t in e)"authorization"===t.toLowerCase()&&(S=!0),E[t]=e[t]};f&&w(f.httpRequestHeaders),w(T.getRequestHeadersFromMessage(d)),f&&"boolean"==typeof f.withCredentials&&(S=f.withCredentials);var A=function(e,t,n,r){var i=e.response?m.getErrorResponse(e.response,n,r):"NONE";O(t,new u.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+i))},x=T.getLicenseRequestFromMessage(d),C=m.getHTTPMethod(o),R=m.getResponseType(p,o),I=f&&!isNaN(f.httpTimeout)?f.httpTimeout:8e3;!function e(t,n,r,i,a,o,s,u,l,c,d){var h=new XMLHttpRequest;h.open(r,t,!0),h.responseType=i,h.withCredentials=a,u>0&&(h.timeout=u);for(var f in n)h.setRequestHeader(f,n[f]);var p=function(){s--,setTimeout((function(){e(t,n,r,i,a,o,s,u,l,c,d)}),1e3)};h.onload=function(){200===this.status||s<=0?l(this):(g.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+s),p())},h.ontimeout=h.onerror=function(){s<=0?d(this):(g.warn("License request network request failed . Retrying it... Pending retries: "+s),p())},h.onabort=function(){c(this)},h.send(o)}(_,E,C,R,S,x,3,I,(function(e){if(n)if(200===e.status){var t=m.getLicenseMessage(e.response,p,o);null!==t?(O(v),n.updateKeySession(h,t)):A(e,v,p,o)}else A(e,v,p,o)}),(function(e){O(v,new u.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+p+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))}),(function(e){O(v,new u.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+p+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))}))}else O(v,new u.default(s.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))}else O(v,new u.default(s.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function L(e,r){if(g.debug("DRM: onNeedKey"),"cenc"===e.key.initDataType)if(0===y.length&&(g.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(r=void 0===r?1:r+1)<5))p.push(setTimeout((function(){L(e,r)}),500));else{var a=e.key.initData;if(ArrayBuffer.isView(a)&&(a=a.buffer),T){var o=i.default.getPSSHForKeySystem(T,a);if(o)for(var s=n.getAllInitData(),u=0;u<s.length;u++)if(t.initDataEquals(o,s[u]))return void g.warn("DRM: Ignoring initData because we have already seen it!")}g.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(a)));var l=t.getSupportedKeySystems(a,_);0!==l.length?I(l,!1):g.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!")}else g.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType)}return m={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");S(),l.on(c.INTERNAL_KEY_MESSAGE,P,this),l.on(c.INTERNAL_KEY_STATUS_CHANGED,D,this),y.push(e);var n=t.getSupportedKeySystemsFromContentProtection(e.contentProtection);n&&n.length>0&&I(n,!0)},createKeySession:w,loadKeySession:A,removeKeySession:function(e){S(),n.removeKeySession(e)},closeKeySession:function(e){S(),n.closeKeySession(e)},setServerCertificate:function(e){S(),n.setServerCertificate(e)},setMediaElement:x,setSessionType:function(e){b=e},setRobustnessLevel:function(e){E=e},setProtectionData:function(e){_=e,t.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return S(),t.getSupportedKeySystemsFromContentProtection(e)},getKeySystems:function(){return t?t.getKeySystems():[]},setKeySystems:function(e){t&&t.setKeySystems(e)},stop:function(){n&&n.stop()},reset:function(){S(),l.off(c.INTERNAL_KEY_MESSAGE,P,this),l.off(c.INTERNAL_KEY_STATUS_CHANGED,D,this),x(null),T=void 0,n&&(n.reset(),n=null),p.forEach((function(e){return clearTimeout(e)})),p=[],y=[]}},g=d.getLogger(m),v=[],y=[],b="temporary",E="",m}c.__dashjs_factory_name="ProtectionController",t.default=dashjs.FactoryMaker.getClassFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentType=t,this.robustness=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(149)),i=s(n(150)),a=s(n(74)),o=s(n(61));function s(e){return e&&e.__esModule?e:{default:e}}var u="e2719d58-a985-b3c9-781a-b030af78d30e",l=o.default.CLEARKEY_KEYSTEM_STRING;function c(e){var t=(e=e||{}).BASE64;return{uuid:u,schemeIdURI:"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e",systemString:l,getInitData:function(e){return a.default.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var a=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),o=[],s=0;s<a.kids.length;s++){var u=a.kids[s],l=e.clearkeys&&e.clearkeys.hasOwnProperty(u)?e.clearkeys[u]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+u+") is not known!");o.push(new r.default(u,l))}n=new i.default(o)}return n}}}c.__dashjs_factory_name="KeySystemClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(149)),i=s(n(150)),a=s(n(74)),o=s(n(61));function s(e){return e&&e.__esModule?e:{default:e}}var u="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",l=o.default.CLEARKEY_KEYSTEM_STRING;function c(e){var t=void 0,n=e.BASE64,o=e.debug.getLogger(t);return t={uuid:u,schemeIdURI:"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",systemString:l,getInitData:function(e){return a.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var a=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),s=[],u=0;u<a.kids.length;u++){var l=a.kids[u],c=e.clearkeys&&e.clearkeys.hasOwnProperty(l)?e.clearkeys[l]:null;if(!c)throw new Error("DRM: ClearKey keyID ("+l+") is not known!");s.push(new r.default(l,c))}n=new i.default(s),o.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return n}}}c.__dashjs_factory_name="KeySystemW3CClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(74)),i=a(n(61));function a(e){return e&&e.__esModule?e:{default:e}}var o="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",s=i.default.WIDEVINE_KEYSTEM_STRING;function u(e){var t=null,n=(e=e||{}).BASE64;return{uuid:o,schemeIdURI:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",systemString:s,init:function(e){e&&(t=e)},getInitData:function(e){return r.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(e){return t&&t.sessionId?t.sessionId:e&&e.sessionId?e.sessionId:null}}}u.__dashjs_factory_name="KeySystemWidevine",t.default=dashjs.FactoryMaker.getSingletonFactory(u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(74)),i=a(n(61));function a(e){return e&&e.__esModule?e:{default:e}}var o="9a04f079-9840-4286-ab92-e65be0885f95",s=i.default.PLAYREADY_KEYSTEM_STRING,u=void 0;function l(e){var t="utf-16",n=(e=e||{}).BASE64;function i(){if(!n||!n.hasOwnProperty("decodeArray")||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:o,schemeIdURI:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",systemString:s,getInitData:function(e){var t,a,o,s=new Uint8Array([112,115,115,104,0,0,0,0]),u=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=0,c=null,d=void 0,h=void 0;if(i(),!e)return null;if("pssh"in e)return r.default.parseInitDataFromContentProtection(e,n);if("pro"in e)c=n.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;c=n.decodeArray(e.prheader.__text)}return t=c.length,a=4+s.length+u.length+4+t,o=new ArrayBuffer(a),d=new Uint8Array(o),(h=new DataView(o)).setUint32(l,a),l+=4,d.set(s,l),l+=s.length,d.set(u,l),l+=u.length,h.setUint32(l,t),l+=4,d.set(c,l),l+=t,d.buffer},getRequestHeadersFromMessage:function(e){var n,r=void 0,i={},a=new DOMParser,o="utf-16"===t?new Uint16Array(e):new Uint8Array(e);n=String.fromCharCode.apply(null,o);for(var s=(r=a.parseFromString(n,"application/xml")).getElementsByTagName("name"),u=r.getElementsByTagName("value"),l=0;l<s.length;l++)i[s[l].childNodes[0].nodeValue]=u[l].childNodes[0].nodeValue;return i.hasOwnProperty("Content")&&(i["Content-Type"]=i.Content,delete i.Content),i.hasOwnProperty("Content-Type")||(i["Content-Type"]="text/xml; charset=utf-8"),i},getLicenseRequestFromMessage:function(e){var r=null,a=new DOMParser,o="utf-16"===t?new Uint16Array(e):new Uint8Array(e);i();var s=String.fromCharCode.apply(null,o),u=a.parseFromString(s,"application/xml");if(!u.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var l=u.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return l&&(r=n.decode(l)),r},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,i=new DOMParser,a=0;a<n;a++){var o=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===o){var u=e.slice(r,r+s),l=String.fromCharCode.apply(null,new Uint16Array(u)),c=i.parseFromString(l,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var d=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(d)return d}if(c.getElementsByTagName("LUI_URL")[0]){var h=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(h)return h}}else r+=s}return null},getCDMData:function(){var e=void 0,t=void 0,r=void 0,a=void 0;if(i(),u&&u.cdmData){for(e=[],a=0;a<u.cdmData.length;++a)e.push(u.cdmData.charCodeAt(a)),e.push(0);for(e=String.fromCharCode.apply(null,e),e=n.encode(e),t='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",e),r=[],a=0;a<t.length;++a)r.push(t.charCodeAt(a)),r.push(0);return new Uint8Array(r).buffer}return null},getSessionId:function(e){return u&&u.sessionId?u.sessionId:e&&e.sessionId?e.sessionId:null},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');t=e},init:function(e){e&&(u=e)}}}l.__dashjs_factory_name="KeySystemPlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(l)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(61),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).BASE64,n={};n[a.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return t.decodeArray(e.license)},getErrorResponse:function(e){return e}},n[a.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}};return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return n[e].responseType},getLicenseMessage:function(e,r){return function(){if(!t||!t.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),n[r].getLicenseMessage(e)},getErrorResponse:function(e,t){return n[t].getErrorResponse(e)}}}o.__dashjs_factory_name="DRMToday",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},function(e,t,n){"use strict";function r(){var e="http://schemas.xmlsoap.org/soap/envelope/";function t(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}function n(n){if(window.DOMParser){var r=t(n),i=(new window.DOMParser).parseFromString(r,"text/xml"),a=i?i.getElementsByTagNameNS(e,"Envelope")[0]:null,o=a?a.getElementsByTagNameNS(e,"Body")[0]:null;if(o?o.getElementsByTagNameNS(e,"Fault")[0]:null)return null}return n}function r(n){var r="",i="",a="",o=-1,s=-1;if(window.DOMParser){var u=t(n),l=(new window.DOMParser).parseFromString(u,"text/xml"),c=l?l.getElementsByTagNameNS(e,"Envelope")[0]:null,d=c?c.getElementsByTagNameNS(e,"Body")[0]:null,h=d?d.getElementsByTagNameNS(e,"Fault")[0]:null,f=h?h.getElementsByTagName("detail")[0]:null,p=f?f.getElementsByTagName("Exception")[0]:null,m=null;if(null===h)return u;r=(m=h.getElementsByTagName("faultstring")[0].firstChild)?m.nodeValue:null,null!==p&&(i=(m=p.getElementsByTagName("StatusCode")[0])?m.firstChild.nodeValue:null,o=(a=(m=p.getElementsByTagName("Message")[0])?m.firstChild.nodeValue:null)?a.lastIndexOf("[")+1:-1,s=a?a.indexOf("]"):-1,a=a?a.substring(o,s):"")}var g="code: "+i+", name: "+r;return a&&(g+=", message: "+a),g}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return n.call(this,e)},getErrorResponse:function(e){return r.call(this,e)}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="PlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},function(e,t,n){"use strict";function r(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="Widevine",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(149)),i=a(n(150));function a(e){return e&&e.__esModule?e:{default:e}}function o(){return{getServerURLFromMessage:function(e,t){var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t)));e+="/?";for(var r=0;r<n.kids.length;r++)e+=n.kids[r]+"&";return e=e.substring(0,e.length-1)},getHTTPMethod:function(){return"GET"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var a=e.keys[n],o=a.kid.replace(/=/g,""),s=a.k.replace(/=/g,"");t.push(new r.default(o,s))}return new i.default(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}o.__dashjs_factory_name="ClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(102);var a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(112)),i=c(n(151)),a=c(n(94)),o=c(n(25)),s=c(n(152)),u=c(n(153)),l=c(n(61));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,n=e.eventBus,c=e.events,d=e.debug,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0;function b(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function E(e){for(var t=0;t<v.length;t++)if(v[t]===e){v.splice(t,1);break}}function T(e){var t=void 0,n=void 0;return e&&e.length>0&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function S(e,t,r,i){var u={session:e,initData:t,sessionId:i,handleEvent:function(e){switch(e.type){case"keystatuseschange":n.trigger(c.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach((function(){var e=T(arguments);switch(e.status){case"expired":n.trigger(c.INTERNAL_KEY_STATUS_CHANGED,{error:new o.default(a.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,a.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:n.trigger(c.INTERNAL_KEY_STATUS_CHANGED,e)}}));break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;n.trigger(c.INTERNAL_KEY_MESSAGE,{data:new s.default(this,t,void 0,e.messageType)})}},getSessionID:function(){return e.sessionId},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getUsable:function(){var t=!1;return e.keyStatuses.forEach((function(){var e=T(arguments);"usable"===e.status&&(t=!0)})),t},getSessionType:function(){return r}};return e.addEventListener("keystatuseschange",u),e.addEventListener("message",u),e.closed.then((function(){E(u),f.debug("DRM: Session closed.  SessionID = "+u.getSessionID()),n.trigger(c.KEY_SESSION_CLOSED,{data:u.getSessionID()})})),v.push(u),u}return h={getAllInitData:function(){for(var e=[],t=0;t<v.length;t++)v[t].initData&&e.push(v[t].initData);return e},requestKeySystemAccess:function(e){!function e(t,r){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess)return void n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Insecure origins are not allowed"});!function(r){var i=t[r].ks,a=t[r].configs,o=i.systemString;o===l.default.PLAYREADY_KEYSTEM_STRING&&"required"===a[0].persistentState&&(o+=".recommendation"),navigator.requestMediaKeySystemAccess(o,a).then((function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,r=new u.default(i,t);r.mksa=e,n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{data:r})})).catch((function(i){++r<t.length?e(t,r):n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! "+i.message})}))}(r)}(e,0)},getKeySystem:function(){return p},selectKeySystem:function(e){e.mksa.createMediaKeys().then((function(t){p=e.keySystem,g=t,m?m.setMediaKeys(g).then((function(){n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED)})):n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED)})).catch((function(){n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})}))},setMediaElement:function(e){m!==e&&(m&&(m.removeEventListener("encrypted",y),m.setMediaKeys&&m.setMediaKeys(null)),(m=e)&&(m.addEventListener("encrypted",y),m.setMediaKeys&&g&&m.setMediaKeys(g)))},setServerCertificate:function(e){if(!p||!g)throw new Error("Can not set server certificate until you have selected a key system");g.setServerCertificate(e).then((function(){f.info("DRM: License server certificate successfully updated."),n.trigger(c.SERVER_CERTIFICATE_UPDATED)})).catch((function(e){n.trigger(c.SERVER_CERTIFICATE_UPDATED,{error:new o.default(a.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,a.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})}))},createKeySession:function(e,t,r){if(!p||!g)throw new Error("Can not create sessions until you have selected a key system");var i=g.createSession(r),s=S(i,e,r),u=this.getKeySystem().systemString===l.default.CLEARKEY_KEYSTEM_STRING&&t&&t.clearkeys?"keyids":"cenc";i.generateRequest(u,e).then((function(){f.debug("DRM: Session created.  SessionID = "+s.getSessionID()),n.trigger(c.KEY_SESSION_CREATED,{data:s})})).catch((function(e){E(s),n.trigger(c.KEY_SESSION_CREATED,{data:null,error:new o.default(a.default.KEY_SESSION_CREATED_ERROR_CODE,a.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})}))},updateKeySession:function(e,t){var r=e.session;_.isClearKey(p)&&(t=t.toJWK()),r.update(t).catch((function(t){n.trigger(c.KEY_ERROR,{data:new o.default(a.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)})}))},loadKeySession:function(e,t,r){if(!p||!g)throw new Error("Can not load sessions until you have selected a key system");for(var i=0;i<v.length;i++)if(e===v[i].sessionId)return void f.warn("DRM: Ignoring session ID because we have already seen it!");var s=g.createSession(r),u=S(s,t,r,e);s.load(e).then((function(t){t?(f.debug("DRM: Session loaded.  SessionID = "+u.getSessionID()),n.trigger(c.KEY_SESSION_CREATED,{data:u})):(E(u),n.trigger(c.KEY_SESSION_CREATED,{data:null,error:new o.default(a.default.KEY_SESSION_CREATED_ERROR_CODE,a.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+e+")")}))})).catch((function(t){E(u),n.trigger(c.KEY_SESSION_CREATED,{data:null,error:new o.default(a.default.KEY_SESSION_CREATED_ERROR_CODE,a.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+e+")! "+t.name)})}))},removeKeySession:function(e){e.session.remove().then((function(){f.debug("DRM: Session removed.  SessionID = "+e.getSessionID()),n.trigger(c.KEY_SESSION_REMOVED,{data:e.getSessionID()})}),(function(t){n.trigger(c.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionID()+"). "+t.name})}))},closeKeySession:function(e){b(e).catch((function(t){E(e),n.trigger(c.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionID()+") "+t.name})}))},stop:function(){for(var e=void 0,t=0;t<v.length;t++)(e=v[t]).getUsable()||b(e).catch((function(){E(e)}))},reset:function(){var e=v.length,t=void 0;0!==e?function(){for(var r=function(e){E(e),0===v.length&&(m?(m.removeEventListener("encrypted",y),m.setMediaKeys(null).then((function(){n.trigger(c.TEARDOWN_COMPLETE)}))):n.trigger(c.TEARDOWN_COMPLETE))},i=0;i<e;i++)!function(e){t.session.closed.then((function(){r(e)})),b(t).catch((function(){r(e)}))}(t=v[i])}():n.trigger(c.TEARDOWN_COMPLETE)}},f=d.getLogger(h),p=null,m=null,g=null,v=[],_=(0,r.default)(t).getInstance(),y={handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;n.trigger(c.NEED_KEY,{key:new i.default(t,e.initDataType)})}}}},h}d.__dashjs_factory_name="ProtectionModel_21Jan2015",t.default=dashjs.FactoryMaker.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(112)),i=c(n(151)),a=c(n(25)),o=c(n(94)),s=c(n(152)),u=c(n(148)),l=c(n(153));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,n=e.eventBus,c=e.events,d=e.debug,h=e.api,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0;function T(){try{for(var e=0;e<_.length;e++)S(_[e]);m&&m.removeEventListener(h.needkey,b),n.trigger(c.TEARDOWN_COMPLETE)}catch(e){n.trigger(c.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function S(e){var t=e.session;t.removeEventListener(h.error,e),t.removeEventListener(h.message,e),t.removeEventListener(h.ready,e),t.removeEventListener(h.close,e);for(var n=0;n<_.length;n++)if(_[n]===e){_.splice(n,1);break}t[h.release]()}function w(){var e=null,t=function(){m.removeEventListener("loadedmetadata",e),m[h.setMediaKeys](v),n.trigger(c.VIDEO_ELEMENT_SELECTED)};m.readyState>=1?t():(e=t.bind(this),m.addEventListener("loadedmetadata",e))}return f={getAllInitData:function(){for(var e=[],t=0;t<_.length;t++)e.push(_[t].initData);return e},requestKeySystemAccess:function(e){for(var t=!1,r=0;r<e.length;r++)for(var i=e[r].ks.systemString,a=e[r].configs,o=null,s=null,d=0;d<a.length;d++){var f=a[d].audioCapabilities,p=a[d].videoCapabilities;if(f&&0!==f.length){o=[];for(var m=0;m<f.length;m++)window[h.MediaKeys].isTypeSupported(i,f[m].contentType)&&o.push(f[m])}if(p&&0!==p.length){s=[];for(var g=0;g<p.length;g++)window[h.MediaKeys].isTypeSupported(i,p[g].contentType)&&s.push(p[g])}if(!(!o&&!s||o&&0===o.length||s&&0===s.length)){t=!0;var v=new u.default(o,s),y=E.getKeySystemBySystemString(i);n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{data:new l.default(y,v)});break}}t||n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return g},selectKeySystem:function(e){try{v=e.mediaKeys=new window[h.MediaKeys](e.keySystem.systemString),g=e.keySystem,y=e,m&&w(),n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED)}catch(e){n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+g.systemString+")! Could not create MediaKeys -- TODO"})}},setMediaElement:function(e){m!==e&&(m&&m.removeEventListener(h.needkey,b),(m=e)&&(m.addEventListener(h.needkey,b),v&&w()))},createKeySession:function(e,t,r,i){if(!g||!v||!y)throw new Error("Can not create sessions until you have selected a key system");var u=null;if(y.ksConfiguration.videoCapabilities&&y.ksConfiguration.videoCapabilities.length>0&&(u=y.ksConfiguration.videoCapabilities[0]),null===u&&y.ksConfiguration.audioCapabilities&&y.ksConfiguration.audioCapabilities.length>0&&(u=y.ksConfiguration.audioCapabilities[0]),null===u)throw new Error("Can not create sessions for unknown content types.");var l=u.contentType,d=v.createSession(l,new Uint8Array(e),i?new Uint8Array(i):null),f=function(e,t){return{session:e,initData:t,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case h.error:var t="KeyError";n.trigger(c.KEY_ERROR,{data:new a.default(o.default.MEDIA_KEYERR_CODE,t,this)});break;case h.message:var r=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;n.trigger(c.INTERNAL_KEY_MESSAGE,{data:new s.default(this,r,e.destinationURL)});break;case h.ready:p.debug("DRM: Key added."),n.trigger(c.KEY_ADDED);break;case h.close:p.debug("DRM: Session closed.  SessionID = "+this.getSessionID()),n.trigger(c.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}(d,e);d.addEventListener(h.error,f),d.addEventListener(h.message,f),d.addEventListener(h.ready,f),d.addEventListener(h.close,f),_.push(f),p.debug("DRM: Session created.  SessionID = "+f.getSessionID()),n.trigger(c.KEY_SESSION_CREATED,{data:f})},updateKeySession:function(e,t){var n=e.session;E.isClearKey(g)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))},closeKeySession:S,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:T,reset:T},p=d.getLogger(f),m=null,g=null,v=null,y=null,_=[],E=(0,r.default)(t).getInstance(),b={handleEvent:function(e){switch(e.type){case h.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;n.trigger(c.NEED_KEY,{key:new i.default(t,"cenc")})}}}},f}d.__dashjs_factory_name="ProtectionModel_3Feb2014",t.default=dashjs.FactoryMaker.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(112)),i=c(n(151)),a=c(n(25)),o=c(n(152)),s=c(n(148)),u=c(n(153)),l=c(n(94));function c(e){return e&&e.__esModule?e:{default:e}}function d(e){e=e||{};var t=this.context,n=e.eventBus,c=e.events,d=e.debug,h=e.api,f=e.errHandler,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0;function S(){g&&x();for(var e=0;e<b.length;e++)w(b[e]);n.trigger(c.TEARDOWN_COMPLETE)}function w(e){try{g[h.cancelKeyRequest](v.systemString,e.sessionID)}catch(t){n.trigger(c.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionID+") "+t.message})}}function A(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionID==t)return e[r];return null}return null}function x(){g.removeEventListener(h.keyerror,T),g.removeEventListener(h.needkey,T),g.removeEventListener(h.keymessage,T),g.removeEventListener(h.keyadded,T)}return p={getAllInitData:function(){for(var e=[],t=0;t<_.length;t++)e.push(_[t].initData);for(var n=0;n<b.length;n++)e.push(b[n].initData);return e},requestKeySystemAccess:function(e){var t=g;t||(t=document.createElement("video"));for(var r=!1,i=0;i<e.length;i++)for(var a=e[i].ks.systemString,o=e[i].configs,l=null,d=null,h=0;h<o.length;h++){var f=o[h].videoCapabilities;if(f&&0!==f.length){d=[];for(var p=0;p<f.length;p++)""!==t.canPlayType(f[p].contentType,a)&&d.push(f[p])}if(d&&(!d||0!==d.length)){r=!0;var m=new s.default(l,d),v=y.getKeySystemBySystemString(a);n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{data:new u.default(v,m)});break}}r||n.trigger(c.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return v},selectKeySystem:function(e){v=e.keySystem,n.trigger(c.INTERNAL_KEY_SYSTEM_SELECTED)},setMediaElement:function(e){if(g!==e){if(g){x();for(var t=0;t<b.length;t++)w(b[t]);b=[]}(g=e)&&(g.addEventListener(h.keyerror,T),g.addEventListener(h.needkey,T),g.addEventListener(h.keymessage,T),g.addEventListener(h.keyadded,T),n.trigger(c.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!v)throw new Error("Can not create sessions until you have selected a key system");if(E||0===b.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return _.push(t),g[h.generateKeyRequest](v.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var n=e.sessionID;if(y.isClearKey(v))for(var r=0;r<t.keyPairs.length;r++)g[h.addKey](v.systemString,t.keyPairs[r].key,t.keyPairs[r].keyID,n);else g[h.addKey](v.systemString,new Uint8Array(t),new Uint8Array(e.initData),n)},closeKeySession:w,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:S,reset:S},m=d.getLogger(p),g=null,v=null,_=[],b=[],y=(0,r.default)(t).getInstance(),T={handleEvent:function(e){var t=null;switch(e.type){case h.needkey:var r=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;n.trigger(c.NEED_KEY,{key:new i.default(r,"cenc")});break;case h.keyerror:if((t=A(b,e.sessionId))||(t=A(_,e.sessionId)),t){var s=l.default.MEDIA_KEYERR_CODE,u="";switch(e.errorCode.code){case 1:s=l.default.MEDIA_KEYERR_UNKNOWN_CODE,u+="MEDIA_KEYERR_UNKNOWN - "+l.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:s=l.default.MEDIA_KEYERR_CLIENT_CODE,u+="MEDIA_KEYERR_CLIENT - "+l.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:s=l.default.MEDIA_KEYERR_SERVICE_CODE,u+="MEDIA_KEYERR_SERVICE - "+l.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:s=l.default.MEDIA_KEYERR_OUTPUT_CODE,u+="MEDIA_KEYERR_OUTPUT - "+l.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:s=l.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,u+="MEDIA_KEYERR_HARDWARECHANGE - "+l.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:s=l.default.MEDIA_KEYERR_DOMAIN_CODE,u+="MEDIA_KEYERR_DOMAIN - "+l.default.MEDIA_KEYERR_DOMAIN_MESSAGE}u+="  System Code = "+e.systemCode,n.trigger(c.KEY_ERROR,{data:new a.default(s,u,t)})}else m.error("No session token found for key error");break;case h.keyadded:(t=A(b,e.sessionId))||(t=A(_,e.sessionId)),t?(m.debug("DRM: Key added."),n.trigger(c.KEY_ADDED,{data:t})):m.debug("No session token found for key added");break;case h.keymessage:if((E=null!==e.sessionId&&void 0!==e.sessionId)?!(t=A(b,e.sessionId))&&_.length>0&&(t=_.shift(),b.push(t),t.sessionID=e.sessionId,n.trigger(c.KEY_SESSION_CREATED,{data:t})):_.length>0&&(t=_.shift(),b.push(t),0!==_.length&&f.error(new a.default(l.default.MEDIA_KEY_MESSAGE_ERROR_CODE,l.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t){var d=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=d,n.trigger(c.INTERNAL_KEY_MESSAGE,{data:new o.default(t,d,e.defaultURL)})}else m.warn("No session token found for key message")}}},p}d.__dashjs_factory_name="ProtectionModel_01b",t.default=dashjs.FactoryMaker.getClassFactory(d)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(173),a=(r=i)&&r.__esModule?r:{default:r};var o=function(){var e="application/dash+xml",t=void 0;function n(n,r,i){if(!n||!/^VIDEO$/i.test(n.nodeName))return null;if(n._dashjs_player)return n._dashjs_player;var o=void 0,s=n.id||n.name||"video element";if(!(r=r||[].slice.call(n.querySelectorAll("source")).filter((function(t){return t.type==e}))[0])&&n.src)(r=document.createElement("source")).src=n.src;else if(!r&&!n.src)return null;return i=i||{},(o=(0,a.default)(i).create()).initialize(n,r.src,n.autoplay),t||(t=o.getDebug().getLogger()),t.debug("Converted "+s+" to dash.js player and added content: "+r.src),n._dashjs_player=o,o}function r(e){return/^VIDEO$/i.test(e.nodeName)?e:r(e.parentNode)}return{create:n,createAll:function(e,t){var i=[];e=e||"[data-dashjs-player]";for(var a=(t=t||document).querySelectorAll(e),o=0;o<a.length;o++){var s=n(a[o],null);i.push(s)}for(var u=t.querySelectorAll('source[type="application/dash+xml"]'),l=0;l<u.length;l++){var c=n(r(u[l]),null);i.push(c)}return i}}}(),s=void 0;!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?o.createAll():s=window.setInterval((function(){window.dashjs&&(window.clearInterval(s),o.createAll())}),500):window.addEventListener("load",(function e(){window.removeEventListener("load",e),o.createAll()}))),t.default=o},function(e,t){},function(e,t,n){var r=n(1038),i=n(8);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){(function(t){var n;n="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=n}).call(this,n(27))},function(e,t){e.exports=function(e){var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)};var n=Object.prototype.toString},function(e,t,n){var r=n(1),i=Object.create||function(){function e(){}return function(t){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return e.prototype=t,new e}}();function a(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function o(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}var n=e.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):n[1]>59?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function s(){this.values=i(null)}function u(e,t,n,r){var i=r?e.split(r):[e];for(var a in i)if("string"==typeof i[a]){var o=i[a].split(n);if(2===o.length)t(o[0],o[1])}}function l(e,t,n){var r=e;function i(){var t=o(e);if(null===t)throw new a(a.Errors.BadTimeStamp,"Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function l(){e=e.replace(/^\s+/,"")}if(l(),t.startTime=i(),l(),"--\x3e"!==e.substr(0,3))throw new a(a.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+r);e=e.substr(3),l(),t.endTime=i(),l(),function(e,t){var r=new s;u(e,(function(e,t){switch(e){case"region":for(var i=n.length-1;i>=0;i--)if(n[i].id===t){r.set(e,n[i].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),o=a[0];r.integer(e,o),r.percent(e,o)&&r.set("snapToLines",!1),r.alt(e,o,["auto"]),2===a.length&&r.alt("lineAlign",a[1],["start","center","end"]);break;case"position":a=t.split(","),r.percent(e,a[0]),2===a.length&&r.alt("positionAlign",a[1],["start","center","end"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start","center","end","left","right"])}}),/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");try{t.line=r.get("line","auto")}catch(e){}t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100);try{t.align=r.get("align","center")}catch(e){t.align=r.get("align","middle")}try{t.position=r.get("position","auto")}catch(e){t.position=r.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},t.align)}t.positionAlign=r.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}(e,t)}a.prototype=i(Error.prototype),a.prototype.constructor=a,a.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},s.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var c=r.createElement("textarea"),d={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},h={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},f={v:"title",lang:"lang"},p={rt:"ruby"};function m(e,t){function n(){if(!t)return null;var e,n=t.match(/^([^<]*)(<[^>]*>?)?/);return e=n[1]?n[1]:n[2],t=t.substr(e.length),e}function r(e){return c.innerHTML=e,e=c.textContent,c.textContent="",e}function i(e,t){return!p[t.localName]||p[t.localName]===e.localName}function a(t,n){var r=d[t];if(!r)return null;var i=e.document.createElement(r),a=f[t];return a&&n&&(i[a]=n.trim()),i}for(var s,u=e.document.createElement("div"),l=u,m=[];null!==(s=n());)if("<"!==s[0])l.appendChild(e.document.createTextNode(r(s)));else{if("/"===s[1]){m.length&&m[m.length-1]===s.substr(2).replace(">","")&&(m.pop(),l=l.parentNode);continue}var g,v=o(s.substr(1,s.length-2));if(v){g=e.document.createProcessingInstruction("timestamp",v),l.appendChild(g);continue}var y=s.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!y)continue;if(!(g=a(y[1],y[3])))continue;if(!i(l,g))continue;if(y[2]){var _=y[2].split(".");_.forEach((function(e){var t=/^bg_/.test(e),n=t?e.slice(3):e;if(h.hasOwnProperty(n)){var r=t?"background-color":"color",i=h[n];g.style[r]=i}})),g.className=_.join(" ")}m.push(y[1]),l.appendChild(g),l=g}return u}var g=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function v(e){for(var t=0;t<g.length;t++){var n=g[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function y(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function r(e,t){for(var n=t.childNodes.length-1;n>=0;n--)e.push(t.childNodes[n])}function i(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var a=n.match(/^.*(\n|\r)/);return a?(e.length=0,a[0]):n}return"ruby"===t.tagName?i(e):t.childNodes?(r(e,t),i(e)):void 0}for(r(t,e);n=i(t);)for(var a=0;a<n.length;a++)if(v(n.charCodeAt(a)))return"rtl";return"ltr"}function _(){}function b(e,t,n){_.call(this),this.cue=t,this.cueDiv=m(e,t.text);var r={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(r,this.cueDiv),this.div=e.document.createElement("div"),r={direction:y(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(r),this.div.appendChild(this.cueDiv);var i=0;switch(t.positionAlign){case"start":i=t.position;break;case"center":i=t.position-t.size/2;break;case"end":i=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(i,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(i,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function E(e){var t,n,r,i;if(e.div){n=e.div.offsetHeight,r=e.div.offsetWidth,i=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||i,this.height=e.height||n,this.bottom=e.bottom||i+(e.height||n),this.width=e.width||r,this.lineHeight=void 0!==t?t:e.lineHeight}function T(e,t,n,r){var i=new E(t),a=t.cue,o=function(e){if("number"==typeof e.line&&(e.snapToLines||e.line>=0&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,r=0,i=0;i<n.length&&n[i]!==t;i++)"showing"===n[i].mode&&r++;return-1*++r}(a),s=[];if(a.snapToLines){var u;switch(a.vertical){case"":s=["+y","-y"],u="height";break;case"rl":s=["+x","-x"],u="width";break;case"lr":s=["-x","+x"],u="width"}var l=i.lineHeight,c=l*Math.round(o),d=n[u]+l,h=s[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/l)*l),o<0&&(c+=""===a.vertical?n.height:n.width,s=s.reverse()),i.move(h,c)}else{var f=i.lineHeight/n.height*100;switch(a.lineAlign){case"center":o-=f/2;break;case"end":o-=f}switch(a.vertical){case"":t.applyStyles({top:t.formatStyle(o,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(o,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],i=new E(t)}var p=function(e,t){for(var i,a=new E(e),o=1,s=0;s<t.length;s++){for(;e.overlapsOppositeAxis(n,t[s])||e.within(n)&&e.overlapsAny(r);)e.move(t[s]);if(e.within(n))return e;var u=e.intersectPercentage(n);o>u&&(i=new E(e),o=u),e=new E(a)}return i||a}(i,s);t.move(p.toCSSCompatValues(n))}function S(){}_.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},_.prototype.formatStyle=function(e,t){return 0===e?0:e+t},b.prototype=i(_.prototype),b.prototype.constructor=b,E.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},E.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},E.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},E.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},E.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},E.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},E.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},E.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||n}},S.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},S.convertCueToDOMTree=function(e,t){return e&&t?m(e,t):null};S.processCues=function(e,t,n){if(!e||!t||!n)return null;for(;n.firstChild;)n.removeChild(n.firstChild);var r=e.document.createElement("div");if(r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin="1.5%",n.appendChild(r),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var i=[],a=E.getSimpleBoxPosition(r),o={font:Math.round(.05*a.height*100)/100+"px sans-serif"};!function(){for(var n,s,u=0;u<t.length;u++)s=t[u],n=new b(e,s,o),r.appendChild(n.div),T(0,n,a,i),s.displayState=n.div,i.push(E.getSimpleBoxPosition(n))}()}else for(var s=0;s<t.length;s++)r.appendChild(t[s].displayState)},S.Parser=function(e,t,n){n||(n=t,t={}),t||(t={}),this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]},S.Parser.prototype={reportOrThrowError:function(e){if(!(e instanceof a))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function n(){for(var e=t.buffer,n=0;n<e.length&&"\r"!==e[n]&&"\n"!==e[n];)++n;var r=e.substr(0,n);return"\r"===e[n]&&++n,"\n"===e[n]&&++n,t.buffer=e.substr(n),r}function r(e){e.match(/X-TIMESTAMP-MAP/)?u(e,(function(e,n){switch(e){case"X-TIMESTAMP-MAP":!function(e){var n=new s;u(e,(function(e,t){switch(e){case"MPEGT":n.integer(e+"S",t);break;case"LOCA":n.set(e+"L",o(t))}}),/[^\d]:/,/,/),t.ontimestampmap&&t.ontimestampmap({MPEGTS:n.get("MPEGTS"),LOCAL:n.get("LOCAL")})}(n)}}),/=/):u(e,(function(e,n){switch(e){case"Region":!function(e){var n=new s;if(u(e,(function(e,t){switch(e){case"id":n.set(e,t);break;case"width":n.percent(e,t);break;case"lines":n.integer(e,t);break;case"regionanchor":case"viewportanchor":var r=t.split(",");if(2!==r.length)break;var i=new s;if(i.percent("x",r[0]),i.percent("y",r[1]),!i.has("x")||!i.has("y"))break;n.set(e+"X",i.get("x")),n.set(e+"Y",i.get("y"));break;case"scroll":n.alt(e,t,["up"])}}),/=/,/\s/),n.has("id")){var r=new(t.vttjs.VTTRegion||t.window.VTTRegion);r.width=n.get("width",100),r.lines=n.get("lines",3),r.regionAnchorX=n.get("regionanchorX",0),r.regionAnchorY=n.get("regionanchorY",100),r.viewportAnchorX=n.get("viewportanchorX",0),r.viewportAnchorY=n.get("viewportanchorY",100),r.scroll=n.get("scroll",""),t.onregion&&t.onregion(r),t.regionList.push({id:n.get("id"),region:r})}}(n)}}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var i;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var c=(i=n()).match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new a(a.Errors.BadSignature);t.state="HEADER"}for(var d=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(d?d=!1:i=n(),t.state){case"HEADER":/:/.test(i)?r(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,"");try{t.cue.align="center"}catch(e){t.cue.align="middle"}if(t.state="CUE",-1===i.indexOf("--\x3e")){t.cue.id=i;continue}case"CUE":try{l(i,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var h=-1!==i.indexOf("--\x3e");if(!i||h&&(d=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=i.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":i||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),(e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new a(a.Errors.BadSignature)}catch(t){e.reportOrThrowError(t)}return e.onflush&&e.onflush(),this}},e.exports=S},function(e,t){var n={"":1,lr:1,rl:1},r={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function i(e){return"string"==typeof e&&(!!r[e.toLowerCase()]&&e.toLowerCase())}function a(e,t,r){this.hasBeenReset=!1;var a="",o=!1,s=e,u=t,l=r,c=null,d="",h=!0,f="auto",p="start",m="auto",g="auto",v=100,y="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return a},set:function(e){a=""+e}},pauseOnExit:{enumerable:!0,get:function(){return o},set:function(e){o=!!e}},startTime:{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");s=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");u=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return l},set:function(e){l=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return c},set:function(e){c=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return d},set:function(e){var t=function(e){return"string"==typeof e&&!!n[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");d=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return h},set:function(e){h=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return f},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("Line: an invalid number or illegal string was specified.");f=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return p},set:function(e){var t=i(e);t?(p=t,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return m},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");m=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return g},set:function(e){var t=i(e);t?(g=t,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return v},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");v=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return y},set:function(e){var t=i(e);if(!t)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");y=t,this.hasBeenReset=!0}}}),this.displayState=void 0}a.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},e.exports=a},function(e,t){var n={"":!0,up:!0};function r(e){return"number"==typeof e&&e>=0&&e<=100}e.exports=function(){var e=100,t=3,i=0,a=100,o=0,s=100,u="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!r(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");t=e}},regionAnchorY:{enumerable:!0,get:function(){return a},set:function(e){if(!r(e))throw new Error("RegionAnchorX must be between 0 and 100.");a=e}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(e){if(!r(e))throw new Error("RegionAnchorY must be between 0 and 100.");i=e}},viewportAnchorY:{enumerable:!0,get:function(){return s},set:function(e){if(!r(e))throw new Error("ViewportAnchorY must be between 0 and 100.");s=e}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(e){if(!r(e))throw new Error("ViewportAnchorX must be between 0 and 100.");o=e}},scroll:{enumerable:!0,get:function(){return u},set:function(e){var t=function(e){return"string"==typeof e&&!!n[e.toLowerCase()]&&e.toLowerCase()}(e);!1===t?console.warn("Scroll: an invalid or illegal string was specified."):u=t}}})}},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}},function(e,t){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+n.source+r.source+"*(?::"+n.source+r.source+"*)?$");function a(){}function o(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function s(e,t,n,r,i,a){for(var o,s=++t,u=0;;){var l=e.charAt(s);switch(l){case"=":if(1===u)o=e.slice(t,s),u=3;else{if(2!==u)throw new Error("attribute equal must after attrName");u=3}break;case"'":case'"':if(3===u||1===u){if(1===u&&(a.warning('attribute value must after "="'),o=e.slice(t,s)),t=s+1,!((s=e.indexOf(l,t))>0))throw new Error("attribute value no end '"+l+"' match");c=e.slice(t,s).replace(/&#?\w+;/g,i),n.add(o,c,t-1),u=5}else{if(4!=u)throw new Error('attribute value must after "="');c=e.slice(t,s).replace(/&#?\w+;/g,i),n.add(o,c,t),a.warning('attribute "'+o+'" missed start quot('+l+")!!"),t=s+1,u=5}break;case"/":switch(u){case 0:n.setTagName(e.slice(t,s));case 5:case 6:case 7:u=7,n.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),0==u&&n.setTagName(e.slice(t,s)),s;case">":switch(u){case 0:n.setTagName(e.slice(t,s));case 5:case 6:case 7:break;case 4:case 1:"/"===(c=e.slice(t,s)).slice(-1)&&(n.closed=!0,c=c.slice(0,-1));case 2:2===u&&(c=o),4==u?(a.warning('attribute "'+c+'" missed quot(")!!'),n.add(o,c.replace(/&#?\w+;/g,i),t)):("http://www.w3.org/1999/xhtml"===r[""]&&c.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),n.add(c,c,t));break;case 3:throw new Error("attribute value missed!!")}return s;case"":l=" ";default:if(l<=" ")switch(u){case 0:n.setTagName(e.slice(t,s)),u=6;break;case 1:o=e.slice(t,s),u=2;break;case 4:var c=e.slice(t,s).replace(/&#?\w+;/g,i);a.warning('attribute "'+c+'" missed quot(")!!'),n.add(o,c,t);case 5:u=6}else switch(u){case 2:n.tagName;"http://www.w3.org/1999/xhtml"===r[""]&&o.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),n.add(o,o,t),t=s,u=1;break;case 5:a.warning('attribute space is required"'+o+'"!!');case 6:u=1,t=s;break;case 3:u=4,t=s;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}s++}}function u(e,t,n){for(var r=e.tagName,i=null,a=e.length;a--;){var o=e[a],s=o.qName,u=o.value;if((f=s.indexOf(":"))>0)var l=o.prefix=s.slice(0,f),c=s.slice(f+1),h="xmlns"===l&&c;else c=s,l=null,h="xmlns"===s&&"";o.localName=c,!1!==h&&(null==i&&(i={},d(n,n={})),n[h]=i[h]=u,o.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(h,u))}for(a=e.length;a--;){(l=(o=e[a]).prefix)&&("xml"===l&&(o.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==l&&(o.uri=n[l||""]))}var f;(f=r.indexOf(":"))>0?(l=e.prefix=r.slice(0,f),c=e.localName=r.slice(f+1)):(l=null,c=e.localName=r);var p=e.uri=n[l||""];if(t.startElement(p,c,r,e),!e.closed)return e.currentNSMap=n,e.localNSMap=i,!0;if(t.endElement(p,c,r),i)for(l in i)t.endPrefixMapping(l)}function l(e,t,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var a=e.indexOf("</"+n+">",t),o=e.substring(t+1,a);if(/[&<]/.test(o))return/^script$/i.test(n)?(i.characters(o,0,o.length),a):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),a)}return t+1}function c(e,t,n,r){var i=r[n];return null==i&&((i=e.lastIndexOf("</"+n+">"))<t&&(i=e.lastIndexOf("</"+n)),r[n]=i),i<t}function d(e,t){for(var n in e)t[n]=e[n]}function h(e,t,n,r){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(i=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,i-t-4),i+3):(r.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var i=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,i-t-9),n.endCDATA(),i+3}var a=function(e,t){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=t,i.exec(e);for(;n=i.exec(e);)if(r.push(n),n[1])return r}(e,t),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var s=a[1][0],u=o>3&&/^public$/i.test(a[2][0])&&a[3][0],l=o>4&&a[4][0],c=a[o-1];return n.startDTD(s,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),l&&l.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),c.index+c[0].length}}return-1}function f(e,t,n){var r=e.indexOf("?>",t);if(r){var i=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){i[0].length;return n.processingInstruction(i[1],i[2]),r+2}return-1}return-1}function p(e){}function m(e,t){return e.__proto__=t,e}a.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),d(t,t={}),function(e,t,n,r,i){function a(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}function d(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?a(parseInt(t.substr(1).replace("x","0x"))):(i.error("entity not found:"+e),e)}function m(t){if(t>S){var n=e.substring(S,t).replace(/&#?\w+;/g,d);b&&g(S),r.characters(n,0,t-S),S=t}}function g(t,n){for(;t>=y&&(n=_.exec(e));)v=n.index,y=v+n[0].length,b.lineNumber++;b.columnNumber=t-v+1}var v=0,y=0,_=/.*(?:\r\n?|\n)|.*$/g,b=r.locator,E=[{currentNSMap:t}],T={},S=0;for(;;){try{var w=e.indexOf("<",S);if(w<0){if(!e.substr(S).match(/^\s*$/)){var A=r.doc,x=A.createTextNode(e.substr(S));A.appendChild(x),r.currentElement=x}return}switch(w>S&&m(w),e.charAt(w+1)){case"/":var M=e.indexOf(">",w+3),C=e.substring(w+2,M),R=E.pop();M<0?(C=e.substring(w+2).replace(/[\s<].*/,""),i.error("end tag name: "+C+" is not complete:"+R.tagName),M=w+1+C.length):C.match(/\s</)&&(C=C.replace(/[\s<].*/,""),i.error("end tag name: "+C+" maybe not complete"),M=w+1+C.length);var I=R.localNSMap,O=R.tagName==C;if(O||R.tagName&&R.tagName.toLowerCase()==C.toLowerCase()){if(r.endElement(R.uri,R.localName,C),I)for(var D in I)r.endPrefixMapping(D);O||i.fatalError("end tag name: "+C+" is not match the current start tagName:"+R.tagName)}else E.push(R);M++;break;case"?":b&&g(w),M=f(e,w,r);break;case"!":b&&g(w),M=h(e,w,r,i);break;default:b&&g(w);var P=new p,L=E[E.length-1].currentNSMap,N=(M=s(e,w,P,L,d,i),P.length);if(!P.closed&&c(e,M,P.tagName,T)&&(P.closed=!0,n.nbsp||i.warning("unclosed xml attribute")),b&&N){for(var k=o(b,{}),F=0;F<N;F++){var B=P[F];g(B.offset),B.locator=o(b,{})}r.locator=k,u(P,r,L)&&E.push(P),r.locator=b}else u(P,r,L)&&E.push(P);"http://www.w3.org/1999/xhtml"!==P.uri||P.closed?M++:M=l(e,M,P.tagName,d,r)}}catch(e){i.error("element parse error: "+e),M=-1}M>S?S=M:m(Math.max(w,S)+1)}}(e,t,n,r,this.errorHandler),r.endDocument()}},p.prototype={setTagName:function(e){if(!i.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,n){if(!i.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},m({},m.prototype)instanceof m||(m=function(e,t){function n(){}for(t in n.prototype=t,n=new n,e)n[t]=e[t];return n}),t.XMLReader=a},function(e,t,n){"use strict";var r=n(204),i=n(203),a=function(){a.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new c(0,0),new c(0,1),new c(1,0),new c(1,1)],this.reset(),this.ccStreams_.forEach((function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))}),this)};a.prototype=new r,a.prototype.push=function(e){var t,n,r;if("sei_rbsp"===e.nalUnitType&&(t=i.parseSei(e.escapedRBSP)).payloadType===i.USER_DATA_REGISTERED_ITU_T_T35&&(n=i.parseUserData(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));r=i.parseCaptionPackets(e.pts,n),this.captionPackets_=this.captionPackets_.concat(r),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},a.prototype.flushCCStreams=function(e){this.ccStreams_.forEach((function(t){return"flush"===e?t.flush():t.partialFlush()}),this)},a.prototype.flushStream=function(e){this.captionPackets_.length?(this.captionPackets_.forEach((function(e,t){e.presortIndex=t})),this.captionPackets_.sort((function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts})),this.captionPackets_.forEach((function(e){e.type<2&&this.dispatchCea608Packet(e)}),this),this.captionPackets_.length=0,this.flushCCStreams(e)):this.flushCCStreams(e)},a.prototype.flush=function(){return this.flushStream("flush")},a.prototype.partialFlush=function(){return this.flushStream("partialFlush")},a.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach((function(e){e.reset()}))},a.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},a.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},a.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},a.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var o={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},s=function(e){return null===e?"":(e=o[e]||e,String.fromCharCode(e))},u=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],l=function(){for(var e=[],t=15;t--;)e.push("");return e},c=function(e,t){c.prototype.init.call(this),this.field_=e||0,this.dataChannel_=t||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,r,i,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,i=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=l();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=l();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=l()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(r,i))a=s((r=(3&r)<<8)|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(r,i))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=s((r=(3&r)<<8)|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(r,i))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&i)&&this.addFormatting(e.pts,["i"]),1==(1&i)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(r,i))this.column_+=3&i;else if(this.isPAC(r,i)){var o=u.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&i&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(i)&&14==(14&i)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(r)&&(0===i&&(i=null),a=s(r),a+=s(i),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};c.prototype=new r,c.prototype.flushDisplayed=function(e){var t=this.displayed_.map((function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}})).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},c.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=l(),this.nonDisplayed_=l(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},c.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},c.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&t>=48&&t<=63},c.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&t>=32&&t<=63},c.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&t>=32&&t<=47},c.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&t>=33&&t<=35},c.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&t>=64&&t<=127},c.prototype.isColorPAC=function(e){return e>=64&&e<=79||e>=96&&e<=127},c.prototype.isNormalChar=function(e){return e>=32&&e<=127},c.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=l(),this.displayed_=l()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},c.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce((function(e,t){return e+"<"+t+">"}),"");this[this.mode_](e,n)},c.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce((function(e,t){return e+"</"+t+">"}),"");this.formatting_=[],this[this.mode_](e,t)}},c.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},c.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},c.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},c.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},e.exports={CaptionStream:a,Cea608Stream:c}},function(e,t,n){"use strict";var r=n(204),i="shared",a=function(e,t){var n=1;for(e>t&&(n=-1);Math.abs(t-e)>4294967296;)e+=8589934592*n;return e},o=function(e){var t,n;o.prototype.init.call(this),this.type_=e||i,this.push=function(e){this.type_!==i&&e.type!==this.type_||(void 0===n&&(n=e.dts),e.dts=a(e.dts,n),e.pts=a(e.pts,n),t=e.dts,this.trigger("data",e))},this.flush=function(){n=t,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){n=void 0,t=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};o.prototype=new r,e.exports={TimestampRolloverStream:o,handleRollover:a}},function(e,t,n){"use strict";var r=n(205),i=function(e){var t=31&e[1];return t<<=8,t|=e[2]},a=function(e){return!!(64&e[1])},o=function(e){var t=0;return(48&e[3])>>>4>1&&(t+=e[4]+1),t},s=function(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}};e.exports={parseType:function(e,t){var n=i(e);return 0===n?"pat":n===t?"pmt":t?"pes":null},parsePat:function(e){var t=a(e),n=4+o(e);return t&&(n+=e[n]+1),(31&e[n+10])<<8|e[n+11]},parsePmt:function(e){var t={},n=a(e),r=4+o(e);if(n&&(r+=e[r]+1),1&e[r+5]){var i;i=3+((15&e[r+1])<<8|e[r+2])-4;for(var s=12+((15&e[r+10])<<8|e[r+11]);s<i;){var u=r+s;t[(31&e[u+1])<<8|e[u+2]]=e[u],s+=5+((15&e[u+3])<<8|e[u+4])}return t}},parsePayloadUnitStartIndicator:a,parsePesType:function(e,t){switch(t[i(e)]){case r.H264_STREAM_TYPE:return"video";case r.ADTS_STREAM_TYPE:return"audio";case r.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!a(e))return null;var t=4+o(e);if(t>=e.byteLength)return null;var n,r=null;return 192&(n=e[t+7])&&((r={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,r.pts*=4,r.pts+=(6&e[t+13])>>>1,r.dts=r.pts,64&n&&(r.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,r.dts*=4,r.dts+=(6&e[t+18])>>>1)),r},videoPacketContainsKeyFrame:function(e){for(var t=4+o(e),n=e.subarray(t),r=0,i=0,a=!1;i<n.byteLength-3;i++)if(1===n[i+2]){r=i+5;break}for(;r<n.byteLength;)switch(n[r]){case 0:if(0!==n[r-1]){r+=2;break}if(0!==n[r-2]){r++;break}i+3!==r-2&&"slice_layer_without_partitioning_rbsp_idr"===s(31&n[i+3])&&(a=!0);do{r++}while(1!==n[r]&&r<n.length);i=r-2,r+=3;break;case 1:if(0!==n[r-1]||0!==n[r-2]){r+=3;break}"slice_layer_without_partitioning_rbsp_idr"===s(31&n[i+3])&&(a=!0),i=r-2,r+=3;break;default:r+=3}return n=n.subarray(i),r-=i,i=0,n&&n.byteLength>3&&"slice_layer_without_partitioning_rbsp_idr"===s(31&n[i+3])&&(a=!0),a}}},function(e,t,n){"use strict";var r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=function(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]};e.exports={isLikelyAacData:function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},parseId3TagSize:function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?n+20:n+10},parseAdtsSize:function(e,t){var n=(224&e[t+5])>>5,r=e[t+4]<<3;return 6144&e[t+3]|r|n},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return r[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,n,r;t=10,64&e[5]&&(t+=4,t+=i(e.subarray(10,14)));do{if((n=i(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){r=e.subarray(t+10,t+n+10);for(var a=0;a<r.byteLength;a++)if(0===r[a]){if("com.apple.streaming.transportStreamTimestamp"===unescape(function(e,t,n){var r,i="";for(r=t;r<n;r++)i+="%"+("00"+e[r].toString(16)).slice(-2);return i}(r,0,a))){var o=r.subarray(a+1),s=(1&o[3])<<30|o[4]<<22|o[5]<<14|o[6]<<6|o[7]>>>2;return s*=4,s+=3&o[7]}break}}t+=10,t+=n}while(t<e.byteLength);return null}}},function(e,t){var n,r,i,a,o,s,u,l=9e4;n=function(e){return e*l},r=function(e,t){return e*t},i=function(e){return e/l},a=function(e,t){return e/t},o=function(e,t){return n(a(e,t))},s=function(e,t){return r(i(e),t)},u=function(e,t,n){return i(n?e:e-t)},e.exports={ONE_SECOND_IN_TS:l,secondsToVideoTs:n,secondsToAudioTs:r,videoTsToSeconds:i,audioTsToSeconds:a,audioTsToVideoTs:o,videoTsToAudioTs:s,metadataTsToSeconds:u}},function(e,t,n){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(206)),a=r(n(3)),o=r(n(13)),s=n(224),u="undefined"!=typeof window&&window||e,l=u.dashjs;l||(l=u.dashjs={}),l.MediaPlayer=i.default,l.FactoryMaker=a.default,l.Debug=o.default,l.Version=(0,s.getVersionString)(),t.default=l,t.MediaPlayer=i.default,t.FactoryMaker=a.default,t.Debug=o.default}).call(this,n(27))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(62)),o=r(n(12)),s=r(n(14)),u=r(n(3)),l=r(n(13));function c(){var e=this.context,t=(0,o.default)(e).getInstance(),n=void 0,r=void 0,u=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0;function P(e){!S&&e.fromStreamInfo&&void 0!==_[e.fromStreamInfo.id]&&(delete E[e.fromStreamInfo.id],delete _[e.fromStreamInfo.id])}function L(){return parseFloat((N()-G()).toFixed(5))}function N(){var e=X(!0),t=S&&T?e-T.start:0;return e+(T?T.duration-t:t)}function k(){T&&m&&m.getElement()?m.play():A=!0}function F(){return T&&m?m.isPaused():null}function B(){T&&m&&m.pause()}function U(){return T&&m?m.isSeeking():null}function j(e,n,i){T&&m&&(!0===i?e!==m.getTime()&&(m.removeEventListener("seeking",ae),r.info("Requesting seek to time: "+e),m.setCurrentTime(e,n)):(t.trigger(s.default.PLAYBACK_SEEK_ASKED),r.info("Requesting seek to time: "+e),m.setCurrentTime(e,n)))}function G(){return T&&m?m.getTime():null}function H(){var e=G();if(S&&!isNaN(M)){var t=M/1e3;e>t&&(e-=t)}return e}function V(){return T&&m?m.getPlaybackRate():null}function z(){return T&&m?m.getEnded():null}function W(){return S}function q(){if(!S||isNaN(M))return NaN;var e=H();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*g.getClientTimeOffset();return Math.max(((t-M-1e3*e)/1e3).toFixed(3),0)}function Y(){v=NaN,A=!1,_={},b=0,M=0,E={},m&&(t.off(s.default.DATA_UPDATE_COMPLETED,$,this),t.off(s.default.BUFFER_LEVEL_STATE_CHANGED,ye,this),t.off(s.default.BYTES_APPENDED_END_FRAGMENT,ge,this),t.off(s.default.LOADING_PROGRESS,ve,this),t.off(s.default.PERIOD_SWITCH_STARTED,P,this),t.off(s.default.PLAYBACK_PROGRESS,pe,this),t.off(s.default.PLAYBACK_TIME_UPDATED,pe,this),t.off(s.default.PLAYBACK_ENDED,he,this),Z(),m.removeEventListener("canplay",ee),m.removeEventListener("play",te),m.removeEventListener("waiting",ne),m.removeEventListener("playing",re),m.removeEventListener("pause",ie),m.removeEventListener("error",fe),m.removeEventListener("seeking",ae),m.removeEventListener("seeked",oe),m.removeEventListener("timeupdate",se),m.removeEventListener("progress",ue),m.removeEventListener("ratechange",le),m.removeEventListener("loadedmetadata",ce),m.removeEventListener("stalled",_e),m.removeEventListener("ended",de)),y=null,m=null,T=null,S=null}function K(){var e=D.getURIFragmentData(),t=void 0;if(e){t={};var n=parseInt(e.r,10);n>=0&&T&&n<T.manifestInfo.DVRWindowSize&&null===e.t&&(e.t=Math.max(Math.floor(Date.now()/1e3)-T.manifestInfo.DVRWindowSize,T.manifestInfo.availableFrom.getTime()/1e3+T.start)+n),t.fragS=parseFloat(e.s),t.fragT=parseFloat(e.t)}return t}function X(e,t){var n=void 0,r=NaN;if(e)r=T?T.start:r;else{var i=K();r=i?isNaN(i.fragS)?i.fragT:i.fragS:0}if(S)!isNaN(r)&&T&&((n=r-T.manifestInfo.availableFrom.getTime()/1e3)>v||n<(isNaN(t)?NaN:t-T.manifestInfo.DVRWindowSize))&&(n=null),n=n||v;else if(T)if(!isNaN(r)&&r<Math.max(T.manifestInfo.duration,T.duration)&&r>=0)n=r;else{var a=_[T.id];n=void 0!==a?Math.max(void 0!==a.audio?a.audio:0,void 0!==a.video?a.video:0,T.start):T.start}return n}function Q(){if(null===y){y=setInterval((function(){var e;t.trigger(s.default.WALLCLOCK_TIME_UPDATED,{isDynamic:S,time:new Date}),W()&&F()&&(e=Date.now(),(!x||e>x+500)&&(x=e,se()))}),w.getWallclockTimeUpdateInterval())}}function Z(){clearInterval(y),y=null}function J(){if(!F()&&S&&0!==m.getReadyState()){var e=H(),t=function(e){var t=c.getReadOnlyMetricsFor(i.default.VIDEO)||c.getReadOnlyMetricsFor(i.default.AUDIO),n=d.getCurrentDVRInfo(t),r=n?n.range:null,a=void 0;if(!r)return NaN;if(e>r.end)a=Math.max(r.end-2*T.manifestInfo.minBufferTime,r.start);else{if(!(e+.25<r.start))return e;a=r.start}return a}(e);!isNaN(t)&&t!==e&&j(t)}}function $(e){if(!e.error){var t=p.convertDataToRepresentationInfo(e.currentRepresentation).mediaInfo.streamInfo;T.id===t.id&&(T=t,J())}}function ee(){t.trigger(s.default.CAN_PLAY)}function te(){r.info("Native video element event: play"),J(),Q(),t.trigger(s.default.PLAYBACK_STARTED,{startTime:G()})}function ne(){r.info("Native video element event: waiting"),t.trigger(s.default.PLAYBACK_WAITING,{playingTime:G()})}function re(){r.info("Native video element event: playing"),t.trigger(s.default.PLAYBACK_PLAYING,{playingTime:G()})}function ie(){r.info("Native video element event: pause"),t.trigger(s.default.PLAYBACK_PAUSED,{ended:z()})}function ae(){var e=G();r.info("Seeking to: "+e),Q(),t.trigger(s.default.PLAYBACK_SEEKING,{seekTime:e})}function oe(){r.info("Native video element event: seeked"),t.trigger(s.default.PLAYBACK_SEEKED),m.addEventListener("seeking",ae)}function se(){T&&t.trigger(s.default.PLAYBACK_TIME_UPDATED,{timeToEnd:L(),time:G()})}function ue(){t.trigger(s.default.PLAYBACK_PROGRESS)}function le(){var e=V();r.info("Native video element event: ratechange: ",e),t.trigger(s.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function ce(){r.info("Native video element event: loadedmetadata"),t.trigger(s.default.PLAYBACK_METADATA_LOADED),Q()}function de(){r.info("Native video element event: ended"),B(),Z(),t.trigger(s.default.PLAYBACK_ENDED,{isLast:u.getActiveStreamInfo().isLast})}function he(e){y&&e.isLast&&(r.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended"),m.setCurrentTime(N()),B(),Z())}function fe(e){var n=e.target||e.srcElement;t.trigger(s.default.PLAYBACK_ERROR,{error:n.error})}function pe(){S&&w.getLowLatencyEnabled()&&w.getCatchUpPlaybackRate()>0&&!F()&&!U()&&(w.getCatchUpPlaybackRate()>0&&G()>0&&Math.abs(q()-w.getLiveDelay())>w.getLowLatencyMinDrift()?function(){if(m){var e=w.getCatchUpPlaybackRate(),t=w.getLiveDelay(),n=q()-t,a=5*n,o=1-e+2*e/(1+Math.pow(Math.E,-a));if(I)(function(){var e=null;return u.getActiveStreamProcessors().forEach((function(t){var n=t.getBufferLevel();e=null===e?n:Math.min(e,n)})),e})()>t/2?I=!1:n>0&&(o=1);Math.abs(m.getPlaybackRate()-o)>O&&m.setPlaybackRate(o),w.getLowLatencyMaxDriftBeforeSeeking()>0&&!R&&n>w.getLowLatencyMaxDriftBeforeSeeking()?(r.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),R=!0,s=c.getReadOnlyMetricsFor(i.default.VIDEO)||c.getReadOnlyMetricsFor(i.default.AUDIO),j(((l=d.getCurrentDVRInfo(s))?l.range:null).end-w.getLiveDelay(),!0,!1)):R=!1}var s,l}():me())}function me(){m&&m.setPlaybackRate(1)}function ge(e){var t,n=void 0,r=e.bufferedRanges;if(r&&r.length&&(!_[T.id]||!0!==_[T.id].started)){var a=e.sender.getType();void 0===E[T.id]&&(E[T.id]=[]),E[T.id][a]=r,void 0===_[T.id]&&(_[T.id]=[],_[T.id].started=!1),void 0===_[T.id][a]&&(_[T.id][a]=Math.max(r.start(0),T.start));var o=u.isTrackTypePresent(i.default.VIDEO),s=u.isTrackTypePresent(i.default.AUDIO);t=X(!1),s&&o?isNaN(_[T.id].audio)||isNaN(_[T.id].video)||(_[T.id].audio<_[T.id].video?(n=_[T.id].video>t?_[T.id].video:t,r=E[T.id].audio):(n=_[T.id].audio>t?_[T.id].audio:t,r=E[T.id].video),function(e,t){if(t&&t.length>0)for(var n=0,r=t.length;n<r;n++)if(e>=t.start(n)&&e<t.end(n))return!0;return!1}(n,r)&&(U()||C||0===n||j(n,!0,!0),_[T.id].started=!0)):_[T.id][a]&&(n=_[T.id][a]>t?_[T.id][a]:t,U()||C||j(n,!1,!0),_[T.id].started=!0)}}function ve(e){if(!1===e.stream&&w.getLowLatencyEnabled()&&!isNaN(e.request.duration)){var t=1.2*e.request.duration;t>w.getLiveDelay()&&(r.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",t.toFixed(2)),w.setLiveDelay(t))}}function ye(e){e.streamInfo.id===T.id&&(w.getLowLatencyEnabled()?e.state!==a.default.BUFFER_EMPTY||U()||I||(I=!0,me()):m.setStallState(e.mediaType,e.state===a.default.BUFFER_EMPTY))}function _e(e){t.trigger(s.default.PLAYBACK_STALLED,{e})}return n={initialize:function(e,n){T=e,m.addEventListener("canplay",ee),m.addEventListener("play",te),m.addEventListener("waiting",ne),m.addEventListener("playing",re),m.addEventListener("pause",ie),m.addEventListener("error",fe),m.addEventListener("seeking",ae),m.addEventListener("seeked",oe),m.addEventListener("timeupdate",se),m.addEventListener("progress",ue),m.addEventListener("ratechange",le),m.addEventListener("loadedmetadata",ce),m.addEventListener("stalled",_e),m.addEventListener("ended",de),S=T.manifestInfo.isDynamic,R=!1,I=!1,v=T.start,C=n;var r="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",i=/safari/.test(r)&&!/chrome/.test(r);O=i?.25:.02,t.on(s.default.DATA_UPDATE_COMPLETED,$,this),t.on(s.default.BYTES_APPENDED_END_FRAGMENT,ge,this),t.on(s.default.LOADING_PROGRESS,ve,this),t.on(s.default.BUFFER_LEVEL_STATE_CHANGED,ye,this),t.on(s.default.PERIOD_SWITCH_STARTED,P,this),t.on(s.default.PLAYBACK_PROGRESS,pe,this),t.on(s.default.PLAYBACK_TIME_UPDATED,pe,this),t.on(s.default.PLAYBACK_ENDED,he,this),A&&(A=!1,k())},setConfig:function(e){e&&(e.streamController&&(u=e.streamController),e.metricsModel&&(c=e.metricsModel),e.dashMetrics&&(d=e.dashMetrics),e.manifestModel&&(h=e.manifestModel),e.dashManifestModel&&(f=e.dashManifestModel),e.mediaPlayerModel&&(w=e.mediaPlayerModel),e.adapter&&(p=e.adapter),e.videoModel&&(m=e.videoModel),e.timelineConverter&&(g=e.timelineConverter),e.uriFragmentModel&&(D=e.uriFragmentModel))},getStartTimeFromUriParameters:K,getStreamStartTime:X,getTimeToStreamEnd:L,getTime:G,getNormalizedTime:H,getPlaybackRate:V,getPlayedRanges:function(){return T&&m?m.getPlayedRanges():null},getEnded:z,getIsDynamic:W,getStreamController:function(){return u},setLiveStartTime:function(e){v=e},getLiveStartTime:function(){return v},computeLiveDelay:function(e,t){var n=f.getMpd(h.getValue()),r=void 0,a=void 0;if(r=w.getUseSuggestedPresentationDelay()&&n.hasOwnProperty(i.default.SUGGESTED_PRESENTATION_DELAY)?n.suggestedPresentationDelay:w.getLowLatencyEnabled()?0:w.getLiveDelay()?w.getLiveDelay():isNaN(e)?2*T.manifestInfo.minBufferTime:e*w.getLiveDelayFragmentCount(),n.availabilityStartTime&&(M=n.availabilityStartTime.getTime()),t>0){var o=Math.max(t-10,t/2);a=Math.min(r,o)}else a=r;return b=a,a},getLiveDelay:function(){return b},getCurrentLiveLatency:q,play:k,isPaused:F,pause:B,isSeeking:U,seek:j,reset:Y},r=(0,l.default)(e).getInstance().getLogger(n),Y(),n}c.__dashjs_factory_name="PlaybackController",t.default=u.default.getSingletonFactory(c),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(114),a=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.BUFFERING_COMPLETED="bufferingCompleted",this.BUFFER_CLEARED="bufferCleared",this.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",this.BYTES_APPENDED="bytesAppended",this.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",this.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",this.CURRENT_TRACK_CHANGED="currentTrackChanged",this.DATA_UPDATE_COMPLETED="dataUpdateCompleted",this.DATA_UPDATE_STARTED="dataUpdateStarted",this.INITIALIZATION_LOADED="initializationLoaded",this.INIT_FRAGMENT_LOADED="initFragmentLoaded",this.INIT_REQUESTED="initRequested",this.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",this.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",this.LOADING_COMPLETED="loadingCompleted",this.LOADING_PROGRESS="loadingProgress",this.LOADING_DATA_PROGRESS="loadingDataProgress",this.LOADING_ABANDONED="loadingAborted",this.MANIFEST_UPDATED="manifestUpdated",this.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",this.QUOTA_EXCEEDED="quotaExceeded",this.REPRESENTATION_UPDATED="representationUpdated",this.SEGMENTS_LOADED="segmentsLoaded",this.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",this.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",this.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",this.STREAMS_COMPOSED="streamsComposed",this.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",this.STREAM_COMPLETED="streamCompleted",this.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",this.TIMED_TEXT_REQUESTED="timedTextRequested",this.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",this.URL_RESOLUTION_FAILED="urlResolutionFailed",this.VIDEO_CHUNK_RECEIVED="videoChunkReceived",this.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",this.XLINK_ELEMENT_LOADED="xlinkElementLoaded",this.XLINK_READY="xlinkReady"}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default);t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=n(32),o=r(n(1056)),s=r(n(95)),u=r(n(208)),l=r(n(3)),c=r(n(13)),d=r(n(156)),h=r(n(1060)),f=r(n(71)),p=r(n(209)),m=r(n(12)),g=r(n(14)),v=r(n(26)),y=r(n(29));function _(){var e=this.context,t=(0,m.default)(e).getInstance(),n=!1,r=void 0,l=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0,V=void 0;function z(){R=null,O=NaN,D=[],N=null,I=!1,M=[],w=null}function W(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&X(t.bytes,t)}function q(){F=[],(C=(0,d.default)(e).getInstance()).setConfig({videoModel:P}),C.initialize(),_=(0,s.default)(e).getInstance(),k=null,!1,B=0,G=[],j=[],U=null,n=!0,H=(0,h.default)(e).getInstance();var r=L.getActiveStreamProcessors();for(var i in r)if("video"===r[i].getType()){V=r[i].getRepresentationInfo().MSETimeOffset;break}t.on(g.default.VIDEO_CHUNK_RECEIVED,W,this)}function Y(e){k=e}function K(e,t){var n,r,a=new o.default,s={subtitle:"subtitles",caption:"captions"};a.captionData=e,a.lang=t.lang,a.labels=t.labels,a.id=t.id?t.id:t.index,a.index=t.index,a.isTTML=(n=!1,t.codec&&t.codec.search(i.default.STPP)>=0&&(n=!0),t.mimeType&&t.mimeType.search(i.default.TTML)>=0&&(n=!0),n),a.defaultTrack=function(e){var t=!1;F.length>1&&e.isEmbedded?t=e.id&&e.id===i.default.CC1:1===F.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===F.length&&(t=e.index===M[0].index);return t}(t),a.isFragmented=!E.getIsTextTrack(t.mimeType),a.isEmbedded=!!t.isEmbedded,a.kind=r=(r=t.roles.length>0?s[t.roles[0]]:s.caption)===s.caption||r===s.subtitle?r:s.caption,a.roles=t.roles,a.accessibility=t.accessibility;var u=(M?M.length:0)+F.length;C.addTextTrack(a,u)}function X(e,t){var n=void 0,r=void 0,o=void 0,s=void 0,u=void 0,c=void 0,d=void 0,h=t.mediaInfo,m=h.type,g=h.mimeType,E=h.codec||g;if(E){if(m===i.default.FRAGMENTED_TEXT)if(I)if(r=(c=_.getSamplesInfo(e)).sampleList,null===N&&r.length>0&&(N=r[0].cts-t.start*O),E.search(i.default.STPP)>=0)for(w=null!==w?w:Q(E),o=0;o<r.length;o++){var S=(Y=r[o]).cts,A=S-N;this.buffered.add(A/O,(A+Y.duration)/O);var x=new DataView(e,Y.offset,Y.subSizes[0]);d=f.default.Utils.dataViewToString(x,i.default.UTF8);var M=[],D=Y.offset+Y.subSizes[0];for(s=1;s<Y.subSizes.length;s++){var L=new Uint8Array(e,D,Y.subSizes[s]),z=String.fromCharCode.apply(null,L);M.push(z),D+=Y.subSizes[s]}try{var W=T.getValue().ttmlTimeIsRelative?S/O:0;n=w.parse(d,W,S/O,(S+Y.duration)/O,M),C.addCaptions(k,N/O,n)}catch(e){R.removeExecutedRequestsBeforeTime(),this.remove(),l.error("TTML parser error: "+e.message)}}else{var q=[];for(o=0;o<r.length;o++){var Y;(Y=r[o]).cts-=N,this.buffered.add(Y.cts/O,(Y.cts+Y.duration)/O);var X=e.slice(Y.offset,Y.offset+Y.size),Z=f.default.parseBuffer(X);for(s=0;s<Z.boxes.length;s++){var J=Z.boxes[s];if(l.debug("VTT box1: "+J.type),"vtte"!==J.type&&"vttc"===J.type)for(l.debug("VTT vttc boxes.length = "+J.boxes.length),u=0;u<J.boxes.length;u++){var $=J.boxes[u];if(l.debug("VTT box2: "+$.type),"payl"===$.type){var ee=$.cue_text;l.debug("VTT cue_text = "+ee);var te=Y.cts/O,ne=(Y.cts+Y.duration)/O;q.push({start:te,end:ne,data:ee,styles:{}}),l.debug("VTT "+te+"-"+ne+" : "+ee)}}}}q.length>0&&C.addCaptions(k,0,q)}else I=!0,O=_.getMediaTimescaleFromMoov(e);else if(m===i.default.TEXT){x=new DataView(e,0,e.byteLength);d=f.default.Utils.dataViewToString(x,i.default.UTF8);try{n=Q(E).parse(d,0),C.addCaptions(C.getCurrentTrackIdx(),0,n)}catch(e){b.timedTextError(e,"parse",d),b.error(new v.default(y.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,y.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,d))}}else if(m===i.default.VIDEO)if(t.segmentType===a.HTTPRequest.INIT_SEGMENT_TYPE){if(0===B)for(B=_.getMediaTimescaleFromMoov(e),o=0;o<F.length;o++)K(null,F[o])}else{if(0===B)return void l.warn("CEA-608: No timescale for embeddedTextTrack yet");var re=function(e,t){return function(e,n,r){var i=null;i=P.getTTMLRenderingDiv()?H.createHTMLCaptionsFromScreen(P.getElement(),e,n,r):[{start:e,end:n,data:r.getDisplayText(),styles:{}}],i&&C.addCaptions(t,0,i)}},ie=(c=_.getSamplesInfo(e)).lastSequenceNumber;if(!G[0]&&!G[1]){var ae=void 0,oe=void 0;for(o=0;o<F.length;o++){if(F[o].id===i.default.CC1?(0,oe=C.getTrackIdxForId(i.default.CC1)):F[o].id===i.default.CC3&&(1,oe=C.getTrackIdxForId(i.default.CC3)),-1===oe)return void l.warn("CEA-608: data before track is ready.");ae=re(0,oe),G[o]=new p.default.Cea608Parser(o+1,{newCue:ae},null)}}if(B&&-1==j.indexOf(ie)){if(null!==U&&ie!==U+c.numSequences)for(o=0;o<G.length;o++)G[o]&&G[o].reset();for(var se=function(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},r=new DataView(e),i=0;i<t.length;i++)for(var a=t[i],o=p.default.findCea608Nalus(r,a.offset,a.size),s=null,u=0,l=0;l<o.length;l++)for(var c=p.default.extractCea608DataFromRange(r,o[l]),d=0;d<2;d++)c[d].length>0&&(a.cts!==s?u=0:u+=1,n.fields[d].push([a.cts+V*B,c[d],u]),s=a.cts);return n.fields.forEach((function(e){e.sort((function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]}))})),n}(e,c.sampleList),ue=0;ue<G.length;ue++){var le=se.fields[ue],ce=G[ue];if(ce)for(o=0;o<le.length;o++)ce.addData(le[o][0]/B,le[o][1])}U=ie,j.push(ie)}}}else l.error("No text type defined")}function Q(e){var t=void 0;return e.search(i.default.VTT)>=0?t=A:(e.search(i.default.TTML)>=0||e.search(i.default.STPP)>=0)&&(t=x),t}return r={initialize:function(t,a){n||q(),C.setConfig({videoModel:P}),C.initialize(),_||(_=(0,s.default)(e).getInstance()),function(t,n){var a=!E.getIsTextTrack(t);if(n){if(M=M.concat(n.getMediaInfoArr()),a){R=n.getFragmentModel(),r.buffered=(0,u.default)(e).create(),D=S.getTracksFor(i.default.FRAGMENTED_TEXT,L.getActiveStreamInfo());for(var o=S.getCurrentTrackFor(i.default.FRAGMENTED_TEXT,L.getActiveStreamInfo()),s=0;s<D.length;s++)if(D[s]===o){Y(s);break}}for(s=0;s<M.length;s++)K(null,M[s])}}(t,a)},append:X,abort:function(){C.deleteAllTextTracks(),_=null,M=[],R=null,I=!1,D=[]},addEmbeddedTrack:function(e){if(n||q(),e)if(e.id===i.default.CC1||e.id===i.default.CC3){for(var t=0;t<F.length;t++)if(F[t].id===e.id)return;F.push(e)}else l.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){t.off(g.default.VIDEO_CHUNK_RECEIVED,W,this),C&&C.deleteAllTextTracks(),n=!1,F=[],G=[null,null],j=[],U=null},setConfig:function(e){e&&(e.errHandler&&(b=e.errHandler),e.dashManifestModel&&(E=e.dashManifestModel),e.manifestModel&&(T=e.manifestModel),e.mediaController&&(S=e.mediaController),e.videoModel&&(P=e.videoModel),e.streamController&&(L=e.streamController),e.textTracks&&(C=e.textTracks),e.vttParser&&(A=e.vttParser),e.ttmlParser&&(x=e.ttmlParser))},getConfig:function(){return{fragmentModel:R,fragmentedTracks:D,videoModel:P}},setCurrentFragmentedTrackIdx:Y,remove:function(e,t){void 0===e&&e===t&&(e=this.buffered.start(0),t=this.buffered.end(this.buffered.length-1)),this.buffered.remove(e,t)},reset:function(){z(),L=null,P=null,C=null}},l=(0,c.default)(e).getInstance().getLogger(r),z(),r}_.__dashjs_factory_name="TextSourceBuffer",t.default=l.default.getSingletonFactory(_),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.captionData=null,this.label=null,this.lang=null,this.defaultTrack=!1,this.kind=null,this.isFragmented=!1,this.isEmbedded=!1},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1058)),a=r(n(3));function o(){var e=void 0;function t(t){var r=[];if(!t||!e||"function"!=typeof e.fetchAll)return r;for(var i=e.fetchAll(t),a=void 0,o=0,s=i.length;o<s;o++)(a=n(i[o]))&&r.push(a);return r}function n(e){if(!e)return null;var t=new i.default(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return{getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&"function"==typeof e.fetch?n(e.fetch(t)):null},getBoxes:t,setData:function(t){e=t},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var n=t(e.boxes[e.boxes.length-1].type);return n.length>0?n[n.length-1]:null}}}o.__dashjs_factory_name="IsoFile",t.default=a.default.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var n=0;n<t.boxes.length;n++)this.boxes.push(new e(t.boxes[n]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(n=0;n<t.references.length;n++){var r={reference_type:t.references[n].reference_type,referenced_size:t.references[n].referenced_size,subsegment_duration:t.references[n].subsegment_duration};this.references.push(r)}}break;case"emsg":this.id=t.id,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];n=0;for(var i=t.samples.length;n<i;n++){var a={sample_size:t.samples[n].sample_size,sample_duration:t.samples[n].sample_duration,sample_composition_time_offset:t.samples[n].sample_composition_time_offset};this.samples.push(a)}}}}return r(e,[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastCompletedOffset=t,this.found=n,this.size=r},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e=0;function t(e){for(var t="",n=0;n<e.length;++n){t+=e[n].uchar}return t.length-t.replace(/^\s+/,"").length}function n(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function r(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function i(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?r(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?r(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function a(e){return e.replace(/^\s+/g,"")}function o(e){return e.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(r,s,u,l){var c=null,d=!1,h=-1,f={start:s,end:u,spans:[]},p="style_cea608_white_black",m={},g={},v=[],y=void 0,_=void 0;for(y=0;y<15;++y){var b=l.rows[y],E="",T=null;if(!1===b.isEmpty()){var S=t(b.chars);null===c&&(c={x:S,y1:y,y2:y+1,p:[]}),S!==h&&d&&(c.p.push(f),f={start:s,end:u,spans:[]},c.y2=y,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===m.hasOwnProperty(c.name)?(v.push(c),m[c.name]=c):m[c.name].p.contat(c.p),c={x:S,y1:y,y2:y+1,p:[]});for(var w=0;w<b.chars.length;++w){var A=b.chars[w],x=A.penState;if(null===T||!x.equals(T)){E.trim().length>0&&(f.spans.push({name:p,line:E,row:y}),E="");var M="style_cea608_"+x.foreground+"_"+x.background;x.underline&&(M+="_underline"),x.italics&&(M+="_italics"),g.hasOwnProperty(M)||(g[M]=JSON.parse(JSON.stringify(x))),T=x,p=M}E+=A.uchar}E.trim().length>0&&f.spans.push({name:p,line:E,row:y}),d=!0,h=S}else d=!1,h=-1,c&&(c.p.push(f),f={start:s,end:u,spans:[]},c.y2=y,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===m.hasOwnProperty(c.name)?(v.push(c),m[c.name]=c):m[c.name].p.contat(c.p),c=null)}c&&(c.p.push(f),c.y2=y+1,c.name="region_"+c.x+"_"+c.y1+"_"+c.y2,!1===m.hasOwnProperty(c.name)?(v.push(c),m[c.name]=c):m[c.name].p.contat(c.p),c=null);var C=[];for(y=0;y<v.length;++y){var R=v[y],I="sub_cea608_"+e++,O=document.createElement("div");O.id=I;var D=n(R);O.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+D;var P=document.createElement("div");P.className="paragraph bodyStyle",P.style.cssText=i(r);var L=document.createElement("div");L.className="cueUniWrapper",L.style.cssText="unicode-bidi: normal; direction: ltr;";for(var N=0;N<R.p.length;++N){var k=R.p[N],F=0;for(_=0;_<k.spans.length;++_){var B=k.spans[_];if(B.line.length>0){if(0!==_&&F!=B.row){var U=document.createElement("br");U.className="lineBreak",L.appendChild(U)}var j=!1;F===B.row&&(j=!0),F=B.row;var G=g[B.name],H=document.createElement("span");H.className="spanPadding "+B.name+" customSpanColor",H.style.cssText=i(r,G),0!==_&&j?_===k.spans.length-1?H.textContent=o(B.line):H.textContent=B.line:k.spans.length>1&&_<k.spans.length-1&&B.row===k.spans[_+1].row?H.textContent=a(B.line):H.textContent=B.line.trim(),L.appendChild(H)}}}P.appendChild(L),O.appendChild(P);var V={bodyStyle:["%",90]};for(var z in g)g.hasOwnProperty(z)&&(V[z]=["%",90]);C.push({type:"html",start:s,end:u,cueHTMLElement:O,cueID:I,cellResolution:[32,15],isFromCEA608:!0,fontSize:V,lineHeight:{},linePadding:{}})}return C}}}o.__dashjs_factory_name="EmbeddedTextHtmlRender",t.default=a.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(13));function o(){var e=this.context,t=void 0,n=void 0,r=void 0,i=void 0,o=void 0,s=void 0;function u(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2===n&&(e+=3600*parseInt(t[0],10)),e}function l(e){var t=e.split(i),n=t[1].split(s);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:c(n)}}function c(e){var t={};return e.forEach((function(e){if(e.split(/:/).length>1){var n=e.split(/:/)[1];n&&-1!=n.search(/%/)&&(n=parseInt(n.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=n),(e.match(/line/)||e.match(/L/))&&(t.line=n),(e.match(/position/)||e.match(/P/))&&(t.position=n),(e.match(/size/)||e.match(/S/))&&(t.size=n)}})),t}function d(e,t){for(var n,r=t,a="",o="";""!==e[r]&&r<e.length;)r++;if((n=r-t)>1)for(var s=0;s<n;s++){if((o=e[t+s]).match(i)){a="";break}a+=o,s!==n-1&&(a+="\n")}else(o=e[t]).match(i)||(a=o);return a}return t={parse:function(e){var t,a=[],s=void 0;if(!e)return a;t=(e=e.split(r)).length,s=-1;for(var c=0;c<t;c++){var h=e[c];if(h.length>0&&"WEBVTT"!==h&&h.match(i)){var f=l(h),p=f.cuePoints,m=f.styles,g=d(e,c+1),v=u(p[0].replace(o,"")),y=u(p[1].replace(o,""));!isNaN(v)&&!isNaN(y)&&v>=s&&y>v?""!==g?(s=v,a.push({start:v,end:y,data:g,styles:m})):n.error("Skipping cue due to empty/malformed cue text"):n.error("Skipping cue due to incorrect cue timing")}}return a}},n=(0,a.default)(e).getInstance().getLogger(t),r=/(?:\r\n|\r|\n)/gm,i=/-->/,o=/(^[\s]+|[\s]+$)/g,s=/\s\b/g,t}o.__dashjs_factory_name="VTTParser",t.default=i.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(13)),o=r(n(12)),s=r(n(14)),u=n(103);function l(){var e=this.context,t=(0,o.default)(e).getInstance(),n=void 0,r=void 0,i=0;return n={parse:function(e,n,a,o,l){var c="",d=[],h=void 0,f=void 0,p=void 0,m={},g={},v="",y="",_={onOpenTag:function(e,t,n){if("image"===t&&"http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e){if(!n[" imagetype"]||"PNG"!==n[" imagetype"].value)return void r.warn("smpte-tt imagetype != PNG. Discarded");v=n["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){v&&(g[v]=y.trim()),y="",v=""},onText:function(e){v&&(y+=e)}};if(!e)throw c="no ttml data to parse",new Error(c);m.data=e,t.trigger(s.default.TTML_TO_PARSE,m);var b=(0,u.fromXML)(m.data,(function(e){c=e}),_);t.trigger(s.default.TTML_PARSED,{ttmlString:m.data,ttmlDoc:b});var E,T=b.getMediaTimeEvents();for(p=0;p<T.length;p++){var S=(0,u.generateISD)(b,T[p],(function(e){c=e}));S.contents.some((function(e){return e.contents.length}))&&(h=T[p]+n<a?a:T[p]+n)<(f=T[p+1]+n>o?o:T[p+1]+n)&&d.push({start:h,end:f,type:"html",cueID:(E=void 0,E="cue_TTML_"+i,i++,E),isd:S,images:l,embeddedImages:g})}if(""!==c)throw r.error(c),new Error(c);return d}},r=(0,a.default)(e).getInstance().getLogger(n),n}l.__dashjs_factory_name="TTMLParser",t.default=i.default.getSingletonFactory(l),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(13)),a=r(n(3));function o(e){var t=this.context,n=void 0,r=void 0,a=void 0,o=[],s=e;function u(e,t){o=o.filter((function(n){return!((isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e))}))}return n={getAllBufferRanges:function(){for(var e=[],t=0;t<o.length;t++){var n=o[t];0===e.length||n.start>e[e.length-1].end?e.push({start:n.start,end:n.end}):e[e.length-1].end=n.end}var r={start:function(t){return e[t].start},end:function(t){return e[t].end}};return Object.defineProperty(r,"length",{get:function(){return e.length}}),r},append:function(e){"InitializationSegment"!==e.segmentType?(o.push(e),o.sort((function(e,t){return e.start-t.start})),a=null):a=e,r.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),s&&s({chunk:e})},remove:u,abort:function(){},discharge:function(e,t){var n=function(e,t){return o.filter((function(n){return(isNaN(t)||n.start<t)&&(isNaN(e)||n.end>e)}))}(e,t);return a&&(n.push(a),a=null),u(e,t),n},reset:function(){o=[],a=null,s=null},updateTimestampOffset:function(){},hasDiscontinuitiesAfter:function(){return!1}},r=(0,i.default)(t).getInstance().getLogger(n),n}o.__dashjs_factory_name="PreBufferSink";var s=a.default.getClassFactory(o);t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(62)),a=r(n(115)),o=r(n(3)),s=r(n(13)),u=r(n(52)),l=r(n(11));function c(e){e=e||{};var t=this.context,n=e.metricsModel,r=void 0,o=void 0;return r={getMaxIndex:function(e){var r=(0,u.default)(t).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return r;!function(){if(!n||!n.hasOwnProperty("getReadOnlyMetricsFor"))throw new Error(l.default.MISSING_CONFIG_ERROR)}();var s=e.getMediaInfo(),c=e.getMediaType(),d=n.getReadOnlyMetricsFor(c),h=e.getScheduleController(),f=e.getAbrController(),p=e.getStreamInfo(),m=p&&p.manifestInfo?p.manifestInfo.isDynamic:null,g=f.getThroughputHistory(),v=g.getSafeAverageThroughput(c,m),y=g.getAverageLatency(c),_=d.BufferState.length>0?d.BufferState[d.BufferState.length-1]:null,b=e.useBufferOccupancyABR();return!d||isNaN(v)||!_||b||f.getAbandonmentStateFor(c)!==a.default.ABANDON_LOAD&&(_.state===i.default.BUFFER_LOADED||m)&&(r.quality=f.getQualityForBitrate(s,v,y),h.setTimeToLoadDelay(0),o.debug("requesting switch to index: ",r.quality,"type: ",c,"Average throughput",Math.round(v),"kbps"),r.reason={throughput:v,latency:y}),r},reset:function(){}},o=(0,s.default)(t).getInstance().getLogger(r),r}c.__dashjs_factory_name="ThroughputRule",t.default=o.default.getClassFactory(c),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(62)),a=r(n(12)),o=r(n(14)),s=r(n(3)),u=r(n(13)),l=r(n(52)),c=r(n(11));function d(e){e=e||{};var t=this.context,n=(0,a.default)(t).getInstance(),r=e.metricsModel,s=e.dashMetrics,d=void 0,h=void 0,f=void 0;function p(){f={}}function m(){p()}return d={getMaxIndex:function(e){var n=(0,l.default)(t).create();if(!e||!e.hasOwnProperty("getMediaType"))return n;!function(){if(!(r&&r.hasOwnProperty("getReadOnlyMetricsFor")&&s&&s.hasOwnProperty("getCurrentBufferLevel")))throw new Error(c.default.MISSING_CONFIG_ERROR)}();var a=e.getMediaType(),o=r.getReadOnlyMetricsFor(a),u=o.BufferState.length>0?o.BufferState[o.BufferState.length-1]:null,d=e.getRepresentationInfo().fragmentDuration;if(!u||!function(e,t){f[e]=f[e]||{};var n=!1;f[e].firstBufferLoadedEvent?n=!0:t&&t.state===i.default.BUFFER_LOADED&&(f[e].firstBufferLoadedEvent=!0,n=!0);return n}(a,u)||!d)return n;if(u.state===i.default.BUFFER_EMPTY)h.debug("Switch to index 0; buffer is empty."),n.quality=0,n.reason="InsufficientBufferRule: Buffer is empty";else{var p=e.getMediaInfo(),m=e.getAbrController(),g=m.getThroughputHistory(),v=s.getCurrentBufferLevel(o),y=g.getAverageThroughput(a),_=g.getAverageLatency(a),b=y*(v/d)*.5;n.quality=m.getQualityForBitrate(p,b,_),n.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return n},reset:function(){p(),n.off(o.default.PLAYBACK_SEEKING,m,d)}},h=(0,u.default)(t).getInstance().getLogger(d),p(),n.on(o.default.PLAYBACK_SEEKING,m,d),d}d.__dashjs_factory_name="InsufficientBufferRule",t.default=s.default.getClassFactory(d),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(52)),a=r(n(3)),o=r(n(13));function s(e){e=e||{};var t=this.context,n=e.mediaPlayerModel,r=e.metricsModel,a=e.dashMetrics,u=void 0,l=void 0,c=void 0,d=void 0,h=void 0;function f(){c={},d={},h=[]}return u={shouldAbandon:function(e){var o=(0,i.default)(t).create(i.default.NO_CHANGE,{name:s.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return o;var u=e.getMediaInfo(),f=e.getMediaType(),p=e.getCurrentRequest();if(!isNaN(p.index)){!function(e,t){c[e]=c[e]||{},c[e][t]=c[e][t]||{}}(f,p.index);var m=n.getStableBufferTime();if(a.getCurrentBufferLevel(r.getReadOnlyMetricsFor(f))>m)return o;var g=c[f][p.index];if(null===g||null===p.firstByteDate||d.hasOwnProperty(g.id))return o;if(void 0===g.firstByteTime&&(h[f]=[],g.firstByteTime=p.firstByteDate.getTime(),g.segmentDuration=p.duration,g.bytesTotal=p.bytesTotal,g.id=p.index),g.bytesLoaded=p.bytesLoaded,g.elapsedTime=(new Date).getTime()-g.firstByteTime,g.bytesLoaded>0&&g.elapsedTime>0&&function(e,t){h[e]=h[e]||[],h[e].push(t)}(f,Math.round(8*g.bytesLoaded/g.elapsedTime)),h[f].length>=5&&g.elapsedTime>500&&g.bytesLoaded<g.bytesTotal){var v=h[f].reduce((function(e,t){return e+t}),0);if(g.measuredBandwidthInKbps=Math.round(v/h[f].length),g.estimatedTimeOfDownload=+(8*g.bytesTotal/g.measuredBandwidthInKbps/1e3).toFixed(2),g.estimatedTimeOfDownload<1.8*g.segmentDuration||0===e.getRepresentationInfo().quality)return o;if(!d.hasOwnProperty(g.id)){var y=e.getAbrController(),_=g.bytesTotal-g.bytesLoaded,b=y.getBitrateList(u),E=y.getQualityForBitrate(u,g.measuredBandwidthInKbps*n.getBandwidthSafetyFactor());_>g.bytesTotal*b[E].bitrate/b[y.getQualityFor(f,u.streamInfo)].bitrate&&(o.quality=E,o.reason.throughput=g.measuredBandwidthInKbps,o.reason.fragmentID=g.id,d[g.id]=g,l.debug("( ",f,"frag id",g.id,") is asking to abandon and switch to quality to ",E," measured bandwidth was",g.measuredBandwidthInKbps),delete c[f][g.id])}}else g.bytesLoaded===g.bytesTotal&&delete c[f][g.id]}return o},reset:f},l=(0,o.default)(t).getInstance().getLogger(u),f(),u}s.__dashjs_factory_name="AbandonRequestsRule",t.default=a.default.getClassFactory(s),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(52)),o=r(n(13));function s(){var e=this.context,t=void 0,n=void 0;return t={getMaxIndex:function(t){var r=t.getDroppedFramesHistory();if(r){for(var i=r.getFrameHistory(),o=0,s=0,u=a.default.NO_CHANGE,l=1;l<i.length;l++)if(i[l]&&(o=i[l].droppedVideoFrames,(s=i[l].totalVideoFrames)>375&&o/s>.15)){u=l-1,n.debug("index: "+u+" Dropped Frames: "+o+" Total Frames: "+s);break}return(0,a.default)(e).create(u,{droppedFrames:o})}return(0,a.default)(e).create()}},n=(0,o.default)(e).getInstance().getLogger(t),t}s.__dashjs_factory_name="DroppedFramesRule",t.default=i.default.getClassFactory(s),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(13)),o=r(n(52));function s(){var e=this.context,t=void 0,n=void 0;return t={getMaxIndex:function(t){for(var r=t?t.getSwitchHistory():null,i=r?r.getSwitchRequests():[],a=0,s=0,u=0,l=(0,o.default)(e).create(),c=0;c<i.length;c++)if(void 0!==i[c]&&(a+=i[c].drops,s+=i[c].noDrops,u+=i[c].dropSize,a+s>=6&&a/s>.075)){l.quality=c>0&&i[c].drops>0?c-1:c,l.reason={index:l.quality,drops:a,noDrops:s,dropSize:u},n.debug("Switch history rule index: "+l.quality+" samples: "+(a+s)+" drops: "+a);break}return l}},n=(0,a.default)(e).getInstance().getLogger(t),t}s.__dashjs_factory_name="SwitchHistoryRule",t.default=i.default.getClassFactory(s),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(75)),a=r(n(52)),o=r(n(3)),s=n(32),u=r(n(12)),l=r(n(14)),c=r(n(13)),d=10;function h(e){e=e||{};var t=this.context,n=e.dashMetrics,r=e.metricsModel,o=e.mediaPlayerModel,h=(0,u.default)(t).getInstance(),f=void 0,p=void 0,m=void 0;function g(e,t,n){var r=n.reduce((function(e,t,r){return t>n[e]?r:e}),0);if(0===r)return null;var i=Math.max(e,d+2*t.length),a=(n[r]-1)/(i/d-1);return{gp:a,Vp:d/a}}function v(e){var t={},n=e.getMediaInfo().bitrateList.map((function(e){return e.bandwidth})),r=function(e){return e.map((function(e){return Math.log(e)}))}(n);r=r.map((function(e){return e-r[0]+1}));var i=o.getStableBufferTime(),a=g(i,n,r);return a?(t.state=1,t.bitrates=n,t.utilities=r,t.stableBufferTime=i,t.Vp=a.Vp,t.gp=a.gp,t.lastQuality=0,y(t)):t.state=0,t}function y(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function _(e,t){var i=o.getStableBufferTime();if(e.stableBufferTime!==i){var a=g(i,e.bitrates,e.utilities);if(a.Vp!==e.Vp||a.gp!==e.gp){var s=n.getCurrentBufferLevel(r.getReadOnlyMetricsFor(t)),u=s+e.placeholderBuffer;u-=d,u*=a.Vp/e.Vp,u+=d,e.stableBufferTime=i,e.Vp=a.Vp,e.gp=a.gp,e.placeholderBuffer=Math.max(0,u-s)}}}function b(e,t){return e.Vp*(e.utilities[t]+e.gp)}function E(e,t){for(var n=e.bitrates[t],r=e.utilities[t],i=0,a=t-1;a>=0;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],u=e.Vp*(e.gp+(n*s-o*r)/(n-o));i=Math.max(i,u)}return i}function T(){for(var e in m)m.hasOwnProperty(e)&&2===m[e].state&&(m[e].placeholderBuffer=0)}function S(){for(var e in m)if(m.hasOwnProperty(e)){var t=m[e];0!==t.state&&(t.state=1,y(t))}}function w(){}function A(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=m[e.chunk.mediaInfo.type];if(t&&0!==t.state){var n=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,M(t,e.chunk.mediaInfo.type)}}}function x(e){if(e&&e.metric===i.default.HTTP_REQUEST&&e.value&&e.value.type===s.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=m[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),M(t,e.mediaType))}}function M(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=.99,!isNaN(e.lastSegmentFinishTimeMs)){var i=n.getCurrentBufferLevel(r.getReadOnlyMetricsFor(t))+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),a=b(e,e.lastQuality),o=Math.max(0,a-i);e.placeholderBuffer=Math.min(o,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function C(e){if(e){var t=m[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function R(e){if(e){var t=m[e.mediaType];if(t&&0!==t.state){var i=n.getCurrentBufferLevel(r.getReadOnlyMetricsFor(e.mediaType)),a=void 0;a=t.abrQuality>0?E(t,t.abrQuality):d;var o=Math.max(0,a-i);t.placeholderBuffer=Math.min(t.placeholderBuffer,o)}}}function I(){m={}}return f={getMaxIndex:function(e){var i=e.getMediaInfo(),o=e.getMediaType(),s=r.getReadOnlyMetricsFor(o),u=e.getScheduleController(),l=e.getStreamInfo(),c=e.getAbrController(),d=c.getThroughputHistory(),h=l?l.id:null,f=l&&l.manifestInfo&&l.manifestInfo.isDynamic,g=e.useBufferOccupancyABR(),T=(0,a.default)(t).create();if(T.reason=T.reason||{},!g)return T;u.setTimeToLoadDelay(0);var S=function(e){var t=e.getMediaType(),n=m[t];return n?0!==n.state&&_(n,t):(n=v(e),m[t]=n),n}(e);if(0===S.state)return T;var w=n.getCurrentBufferLevel(s),A=d.getAverageThroughput(o,f),x=d.getSafeAverageThroughput(o,f),M=d.getAverageLatency(o),C=void 0;if(T.reason.state=S.state,T.reason.throughput=A,T.reason.latency=M,isNaN(A))return T;switch(S.state){case 1:C=c.getQualityForBitrate(i,x,M),T.quality=C,T.reason.throughput=x,S.placeholderBuffer=Math.max(0,E(S,C)-w),S.lastQuality=C,!isNaN(S.lastSegmentDurationS)&&w>=S.lastSegmentDurationS&&(S.state=2);break;case 2:!function(e,t){var n=Date.now();if(isNaN(e.lastSegmentFinishTimeMs))isNaN(e.lastCallTimeMs)||(r=.001*(n-e.lastCallTimeMs),e.placeholderBuffer+=Math.max(0,r));else{var r=.001*(n-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,r)}e.lastCallTimeMs=n,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,_(e,t)}(S,o),C=function(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||o>=i)&&(i=o,r=a)}return r}(S,w+S.placeholderBuffer);var R=c.getQualityForBitrate(i,x,M);C>S.lastQuality&&C>R&&(C=Math.max(R,S.lastQuality));var I=Math.max(0,w+S.placeholderBuffer-b(S,C));I<=S.placeholderBuffer?(S.placeholderBuffer-=I,I=0):(I-=S.placeholderBuffer,S.placeholderBuffer=0,C<c.getTopQualityIndexFor(o,h)?u.setTimeToLoadDelay(1e3*I):I=0),T.quality=C,T.reason.throughput=A,T.reason.latency=M,T.reason.bufferLevel=w,T.reason.placeholderBuffer=S.placeholderBuffer,T.reason.delay=I,S.lastQuality=C;break;default:p.debug("BOLA ABR rule invoked in bad state."),T.quality=c.getQualityForBitrate(i,x,M),T.reason.state=S.state,T.reason.throughput=x,T.reason.latency=M,S.state=1,y(S)}return T},reset:function(){I(),h.off(l.default.BUFFER_EMPTY,T,f),h.off(l.default.PLAYBACK_SEEKING,S,f),h.off(l.default.PERIOD_SWITCH_STARTED,w,f),h.off(l.default.MEDIA_FRAGMENT_LOADED,A,f),h.off(l.default.METRIC_ADDED,x,f),h.off(l.default.QUALITY_CHANGE_REQUESTED,C,f),h.off(l.default.FRAGMENT_LOADING_ABANDONED,R,f)}},p=(0,c.default)(t).getInstance().getLogger(f),I(),h.on(l.default.BUFFER_EMPTY,T,f),h.on(l.default.PLAYBACK_SEEKING,S,f),h.on(l.default.PERIOD_SWITCH_STARTED,w,f),h.on(l.default.MEDIA_FRAGMENT_LOADED,A,f),h.on(l.default.METRIC_ADDED,x,f),h.on(l.default.QUALITY_CHANGE_REQUESTED,C,f),h.on(l.default.FRAGMENT_LOADING_ABANDONED,R,f),f}h.__dashjs_factory_name="BolaRule",t.default=o.default.getClassFactory(h),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).abrController,n=e.switchHistory,r=e.droppedFramesHistory,i=e.currentRequest,a=e.useBufferOccupancyABR,o=e.streamProcessor?e.streamProcessor.getScheduleController():null,s=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null;function u(){return s?s.mediaInfo:null}return{getMediaType:function(){var e=u();return e?e.type:null},getMediaInfo:u,getDroppedFramesHistory:function(){return r},getCurrentRequest:function(){return i},getSwitchHistory:function(){return n},getStreamInfo:function(){var e=u();return e?e.streamInfo:null},getScheduleController:function(){return o},getAbrController:function(){return t},getRepresentationInfo:function(){return s},useBufferOccupancyABR:function(){return a}}}o.__dashjs_factory_name="RulesContext",t.default=a.default.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(52));function o(){var e=[],t=[];return{push:function(n){n.newValue===a.default.NO_CHANGE&&(n.newValue=n.oldValue),e[n.oldValue]||(e[n.oldValue]={noDrops:0,drops:0,dropSize:0});var r=n.newValue-n.oldValue,i=r<0?1:0,o=i?-r:0,s=i?0:1;if(e[n.oldValue].drops+=i,e[n.oldValue].dropSize+=o,e[n.oldValue].noDrops+=s,t.push({idx:n.oldValue,noDrop:s,drop:i,dropSize:o}),t.length>8){var u=t.shift();e[u.idx].drops-=u.drop,e[u.idx].dropSize-=u.dropSize,e[u.idx].noDrops-=u.noDrop}},getSwitchRequests:function(){return e},reset:function(){e=[],t=[]}}}o.__dashjs_factory_name="SwitchRequestHistory";var s=i.default.getClassFactory(o);t.default=s,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e=[],t=0,n=0;return{push:function(r,i){var a=i&&i.droppedVideoFrames?i.droppedVideoFrames:0,o=i&&i.totalVideoFrames?i.totalVideoFrames:0,s=a-t;t=a;var u=o-n;n=o,isNaN(r)||(e[r]?(e[r].droppedVideoFrames+=s,e[r].totalVideoFrames+=u):e[r]={droppedVideoFrames:s,totalVideoFrames:u})},getFrameHistory:function(){return e},reset:function(r){e=[],t=r.droppedVideoFrames,n=r.totalVideoFrames}}}o.__dashjs_factory_name="DroppedFramesHistory";var s=a.default.getClassFactory(o);t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(3));function o(e){var t=(e=e||{}).mediaPlayerModel,n=void 0,r=void 0,a=void 0,o=void 0,s=void 0;function u(e,t,n,r){var i=Math.pow(.5,n/r.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var a=Math.pow(.5,n/r.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=n}function l(e,u,l){return t.getMovingAverageMethod()!==i.default.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var n=e?s.throughputHalfLife:s.latencyHalfLife,r=e?a[t]:o[t];if(!r||r.totalWeight<=0)return NaN;var i=r.fastEstimate/(1-Math.pow(.5,r.totalWeight/n.fast)),u=r.slowEstimate/(1-Math.pow(.5,r.totalWeight/n.slow));return e?Math.min(i,u):Math.max(i,u)}(e,u):function(e,t,i){var a=function(e,t,i){var a=void 0,o=void 0;if(e?(a=n[t],o=i?3:4):(a=r[t],o=4),a){if(o>=a.length)o=a.length;else if(e)for(var s=1;s<o;++s){var u=a[s]/a[s-1];if((u>=1.3||u<=1/1.3)&&(o+=1)===a.length)break}}else o=0;return o}(e,t,i),o=(e?n:r)[t];if(0===a||!o||0===o.length)return NaN;return(o=o.slice(-a)).reduce((function(e,t){return e+t}))/o.length}(e,u,l)}function c(e,t){return l(!0,e,t)}function d(e){n[e]=n[e]||[],r[e]=r[e]||[],a[e]=a[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},o[e]=o[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function h(){n={},r={},a={},o={}}var f={push:function(e,l,c){if(l.trace&&l.trace.length){var h=l.tresponse.getTime()-l.trequest.getTime()||1,f=l._tfinish.getTime()-l.tresponse.getTime()||1,p=l.trace.reduce((function(e,t){return e+t.b[0]}),0),m=void 0;m=t.getLowLatencyEnabled()?l.trace.reduce((function(e,t){return e+t.d}),0):c?f:h+f;var g=Math.round(8*p/m);if(d(e),function(e,n,r){return e===i.default.VIDEO?r<t.getCacheLoadThresholdForType(i.default.VIDEO):e===i.default.AUDIO?r<t.getCacheLoadThresholdForType(i.default.AUDIO):void 0}(e,0,f)){if(n[e].length>0&&!n[e].hasCachedEntries)return;n[e].hasCachedEntries=!0}else n[e]&&n[e].hasCachedEntries&&function(e){delete n[e],delete r[e],delete a[e],delete o[e],d(e)}(e);n[e].push(g),n[e].length>20&&n[e].shift(),r[e].push(h),r[e].length>20&&r[e].shift(),u(a[e],g,.001*f,s.throughputHalfLife),u(o[e],h,1,s.latencyHalfLife)}},getAverageThroughput:c,getSafeAverageThroughput:function(e,n){var r=c(e,n);return isNaN(r)||(r*=t.getBandwidthSafetyFactor()),r},getAverageLatency:function(e){return l(!1,e)},reset:h};return s={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},h(),f}o.__dashjs_factory_name="ThroughputHistory",t.default=a.default.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(75)),o=r(n(1075)),s=r(n(1100)),u=r(n(12)),l=r(n(14)),c=r(n(3)),d=n(213),h=r(n(13)),f=r(n(158)),p=r(n(55)),m=r(n(216)),g=r(n(1101)),v=r(n(217)),y=r(n(1108)),_=r(n(26)),b=r(n(29));function E(){var e=this.context,t=(0,u.default)(e).getInstance(),n=void 0,r=void 0,c=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0,V=void 0,z=void 0,W=void 0,q=void 0,Y=void 0,K=void 0,X=void 0,Q=void 0,Z=void 0,J=void 0,$=void 0,ee=void 0,te=void 0,ne=void 0,re=void 0,ie=void 0,ae=void 0,oe=void 0,se=void 0,ue=void 0,le=void 0,ce=void 0;function de(){if(De(i.default.VIDEO)){var e=K.getPlaybackQuality();e&&x.addDroppedFrames(i.default.VIDEO,e)}}function he(){if(!(!Q.getJumpGaps()||0===Te()||X.isSeeking()||Z||z||W||q)&&++ae>=40){var e=X.getTime();le===e?function(e){for(var n=Te(),i=Q.getSmallGapLimit(),a=void 0,o=0;o<n.length;o++){var s=n[o].getBuffer().getAllBufferRanges(),u=void 0;if(s&&!(s.length<=1)){for(var c=0;c<s.length;c++)if(e<s.start(c)){u=s.start(c);break}if(u>0){var d=u-e;d>0&&d<=i&&(void 0===a||u>a)&&(a=u)}}}var h=X.getTimeToStreamEnd();void 0===a&&!isNaN(h)&&h<i&&(a=e+h);a>0&&(!isNaN(h)&&a>=e+h?(r.info("Jumping media gap (discontinuity) at time ",e,". Jumping to end of the stream"),t.trigger(l.default.PLAYBACK_ENDED,{isLast:Fe().isLast})):(r.info("Jumping media gap (discontinuity) at time ",e,". Jumping to time position",a),X.seek(a,!0,!0)))}(e):le=e,ae=0}}function fe(e){var t=Ee(e.seekTime);re&&(ge(),ne=!1),ie&&(r.debug("[PreloadTimer] stop period preload timer."),clearTimeout(ie),ie=void 0),t===j&&ue&&ue.deactivate(!0),t&&(t!==j||ue&&!j.isActive())?(Le(d.PlayListTrace.END_OF_PERIOD_STOP_REASON),Ae(j,t,e.seekTime)):Le(d.PlayListTrace.USER_REQUEST_STOP_REASON),Ne(d.PlayList.SEEK_START_REASON)}function pe(){r.debug("[onPlaybackStarted]"),J?(J=!1,Ne(d.PlayList.INITIAL_PLAYOUT_START_REASON)):Z&&(Z=!1,Ne(d.PlayList.RESUME_FROM_PAUSE_START_REASON),ve())}function me(e){r.debug("[onPlaybackPaused]"),e.ended||(Z=!0,Le(d.PlayListTrace.USER_REQUEST_STOP_REASON),ve())}function ge(){r.debug("[toggleEndPeriodTimer] stop end period timer."),clearTimeout(re),re=void 0}function ve(){if(ne)if(re)ge();else{var e=X.getTimeToStreamEnd(),n=e>0?1e3*e:0,i=n<2e3?n/4:n-2e3;r.debug("[toggleEndPeriodTimer] Going to fire preload in",i,"milliseconds"),ie=setTimeout(be,i),r.debug("[toggleEndPeriodTimer] start-up of timer to notify PLAYBACK_ENDED event. It will be triggered in",n,"milliseconds"),re=setTimeout((function(){t.trigger(l.default.PLAYBACK_ENDED,{isLast:Fe().isLast})}),n)}}function ye(e){if(e.sender&&(e.sender.getType()===i.default.AUDIO||e.sender.getType()===i.default.VIDEO)){var t=Fe().isLast;Y&&!t&&void 0===re&&(r.info("[onTrackBufferingCompleted] end of period detected. Track",e.sender.getType(),"has finished"),ne=!0,!1===Z&&ve())}}function _e(){var e=Fe().isLast;Y&&e&&(r.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),C.signalEndOfStream(Y))}function be(){var e,t=Fe().isLast;Y&&!t&&(e=we(),(se=j.isProtectionCompatible(e)&&(ce||j.isMediaCodecCompatible(e)))&&(r.info("[onStreamCanLoadNext] Preloading next stream"),j.stopEventController(),j.deactivate(!0),e.preload(Y,oe),ue=e,e.getProcessors().forEach((function(t){A.setIndexHandlerTime(t,e.getStartTime())}))))}function Ee(e){var t=0,n=null,r=U.length;r>0&&(t+=U[0].getStartTime());for(var i=0;i<r;i++)if(n=U[i],e<(t=parseFloat((t+n.getDuration()).toFixed(5))))return n;return null}function Te(){return j?j.getProcessors():[]}function Se(){var e=we();e?(te=void 0,ee=void 0,Ae(j,e,NaN)):r.debug("StreamController no next stream found"),Le(e?d.PlayListTrace.END_OF_PERIOD_STOP_REASON:d.PlayListTrace.END_OF_CONTENT_STOP_REASON),re=void 0,ne=!1}function we(){if(j){var e=(t=Fe().start,n=Fe().duration,{v:U.filter((function(e){return e.getStreamInfo().start===parseFloat((t+n).toFixed(5))}))[0]});if("object"==typeof e)return e.v}var t,n}function Ae(e,n,r){z||!n||e===n&&n.isActive()||(z=!0,t.trigger(l.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:e?e.getStreamInfo():null,toStreamInfo:n.getStreamInfo()}),se=!1,e&&(e.stopEventController(),se=j.isProtectionCompatible(n)&&(ce||j.isMediaCodecCompatible(n))&&!r||n.getPreloaded(),e.deactivate(se)),j=n,ue=!1,X.initialize(Fe(),se),K.getElement()?xe(r,e,!1,se):function(e){Me(e,se)}(r))}function xe(e,n,i,a){var o=void 0;function s(){Y&&(r.debug("MediaSource is open!"),window.URL.revokeObjectURL(o),Y.removeEventListener("sourceopen",s),Y.removeEventListener("webkitsourceopen",s),Ce(),n||t.trigger(l.default.SOURCE_INITIALIZED),i?j.setMediaSource(Y):Me(e,a))}Y?a?(Me(e,a),n||t.trigger(l.default.SOURCE_INITIALIZED)):(C.detachMediaSource(K),Y.addEventListener("sourceopen",s,!1),Y.addEventListener("webkitsourceopen",s,!1),o=C.attachMediaSource(Y,K),r.debug("MediaSource attached to element.  Waiting on open...")):((Y=C.createMediaSource()).addEventListener("sourceopen",s,!1),Y.addEventListener("webkitsourceopen",s,!1),o=C.attachMediaSource(Y,K),r.debug("MediaSource attached to element.  Waiting on open..."))}function Me(e,n){if(oe=j.activate(Y,n?oe:void 0),te=Pe(i.default.AUDIO),ee=Pe(i.default.VIDEO),oe){var a=Object.keys(oe);a.length>0&&oe[a[0]].changeType&&(r.debug("SourceBuffer changeType method supported. Use it to switch codecs in periods transitions"),ce=!0)}var o;J||(isNaN(e)?(o=X.getStreamStartTime(!0),n||Te().forEach((function(e){A.setIndexHandlerTime(e,o)}))):X.seek(e)),j.startEventController(),!V&&J||X.play(),z=!1,t.trigger(l.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:Fe()})}function Ce(e){var t=e||Fe().manifestInfo.duration,n=C.setDuration(Y,t);r.debug("Duration successfully set to: "+n)}function Re(e){for(var t=0,n=U.length;t<n;t++)if(U[t].getId()===e.id)return U[t];return null}function Ie(){var r=S.getValue();G&&(t.trigger(l.default.PROTECTION_CREATED,{controller:G,manifest:r}),G.setMediaElement(K.getElement()),H&&G.setProtectionData(H)),function(){try{var r=A.getStreamsInfo();if(0===r.length)throw new Error("There are no streams");var a=M.getCurrentManifestUpdate(x.getMetricsFor(i.default.STREAM));x.updateManifestUpdateInfo(a,{currentTime:X.getTime(),buffered:K.getBufferRange(),presentationStartTime:r[0].start,clientTimeOffset:B.getClientTimeOffset()});for(var s=0,u=r.length;s<u;s++){var d=r[s],h=Re(d);h?h.updateData(d):(h=(0,o.default)(e).create({manifestModel:S,dashManifestModel:w,mediaPlayerModel:Q,metricsModel:x,dashMetrics:M,manifestUpdater:E,adapter:A,timelineConverter:B,capabilities:c,errHandler:F,baseURLController:I,domStorage:O,abrController:D,playbackController:X,mediaController:P,textController:L,videoModel:K,streamController:n}),U.push(h),h.initialize(d,G)),x.addManifestUpdateStreamInfo(a,d.id,d.index,d.start,d.duration)}if(!j){var f=X.getStartTimeFromUriParameters(),p=null;f&&(p=Ee(isNaN(f.fragS)?f.fragT:f.fragS)),Ae(null,null!==p?p:U[0],NaN)}t.trigger(l.default.STREAMS_COMPOSED)}catch(e){F.manifestError(e.message,"nostreamscomposed",S.getValue()),F.error(new _.default(b.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+"nostreamscomposed",S.getValue())),q=!0,Ge()}}()}function Oe(e){e.error?(q=!0,Ge()):function(){var t=e.manifest;A.updatePeriods(t);var n=A.getStreamsInfo(void 0,1)[0],a=A.getMediaInfoForType(n,i.default.VIDEO)||A.getMediaInfoForType(n,i.default.AUDIO),o=void 0;a&&(o=w.getUseCalculatedLiveEdgeTimeForAdaptation(A.getDataForMedia(a)))&&(r.debug("SegmentTimeline detected using calculated Live Edge Time"),Q.setUseManifestDateHeaderTimeSource(!1));var s=w.getUTCTimingSources(e.manifest),u=!w.getIsDynamic(t)||o?s:s.concat(Q.getUTCTimingSources()),l=k.isHTTPS(e.manifest.url);u.forEach((function(e){e.value.replace(/.*?:\/\//g,"")===Q.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(l?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),l?"https://":"http://"),r.debug("Matching default timing source protocol to manifest protocol: ",e.value))})),I.initialize(t),R.setConfig({metricsModel:x,dashMetrics:M,baseURLController:I}),R.initialize(u,Q.getUseManifestDateHeaderTimeSource())}()}function De(e){var t=void 0;if(!e)return t;switch(e){case i.default.VIDEO:t=ee;break;case i.default.AUDIO:t=te}return t}function Pe(e){var t=!1;return Te().forEach((function(n){n.getMediaInfo().type===e&&(t=!0)})),t}function Le(e,t){t=t||new Date,$&&(Te().forEach((function(n){var r=n.getScheduleController();r&&r.finalisePlayList(t,e)})),x.addPlayList($),$=null)}function Ne(e){($=new d.PlayList).start=new Date,$.mstart=1e3*X.getTime(),$.starttype=e,Te().forEach((function(e){var t=e.getScheduleController();t&&t.setPlayList($)}))}function ke(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE";break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}W=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),r.fatal("Video Element Error: "+t),e.error&&r.fatal(e.error),F.mediaSourceError(t),F.error(new _.default(e.error.code,t)),Ge()}}function Fe(){return j?j.getStreamInfo():null}function Be(){if(!(T&&T.hasOwnProperty("load")&&B&&B.hasOwnProperty("initialize")&&B.hasOwnProperty("reset")&&B.hasOwnProperty("getClientTimeOffset")&&S&&F&&x&&X))throw new Error("setConfig function has to be called previously")}function Ue(e){isNaN(e.newDuration)||Ce(e.newDuration)}function je(){U=[],G=null,z=!1,j=null,W=!1,q=!1,ee=void 0,te=void 0,J=!0,Z=!1,V=!0,$=null,re=void 0,ne=!1,ae=0}function Ge(){Be(),R.reset(),Le(W||q?d.PlayListTrace.FAILURE_STOP_REASON:d.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,n=U?U.length:0;e<n;e++){U[e].reset(W)}!function(){t.off(l.default.PLAYBACK_TIME_UPDATED,de,this),t.off(l.default.PLAYBACK_SEEKING,fe,this),t.off(l.default.PLAYBACK_ERROR,ke,this),t.off(l.default.PLAYBACK_STARTED,pe,this),t.off(l.default.PLAYBACK_PAUSED,me,this),t.off(l.default.PLAYBACK_ENDED,Se,this),t.off(l.default.MANIFEST_UPDATED,Oe,this),t.off(l.default.BUFFERING_COMPLETED,ye,this),t.off(l.default.STREAM_BUFFERING_COMPLETED,_e,this),t.off(l.default.MANIFEST_VALIDITY_CHANGED,Ue,this),t.off(l.default.TIME_SYNCHRONIZATION_COMPLETED,Ie,this),t.off(l.default.WALLCLOCK_TIME_UPDATED,he,this),t.off(m.default.METRIC_ADDED,He,this)}(),I.reset(),E.reset(),x.clearAllCurrentMetrics(),S.setValue(null),T.reset(),B.reset(),N.reset(),Y&&(C.detachMediaSource(K),Y=null),K=null,G&&(G.setMediaElement(null),G=null,H=null,S.getValue()&&t.trigger(l.default.PROTECTION_DESTROYED,{data:S.getValue().url})),t.trigger(l.default.STREAM_TEARDOWN_COMPLETE),je()}function He(e){e.metric===a.default.DVR_INFO&&e.mediaType===i.default.AUDIO&&C.setSeekable(Y,e.value.range.start,e.value.range.end)}return n={initialize:function(n,r){Be(),V=n,H=r,B.initialize(),(E=(0,s.default)(e).create()).setConfig({manifestModel:S,dashManifestModel:w,mediaPlayerModel:Q,manifestLoader:T,errHandler:F}),E.initialize(),I.setConfig({dashManifestModel:w}),function(){t.on(l.default.PLAYBACK_TIME_UPDATED,de,this),t.on(l.default.PLAYBACK_SEEKING,fe,this),t.on(l.default.PLAYBACK_ERROR,ke,this),t.on(l.default.PLAYBACK_STARTED,pe,this),t.on(l.default.PLAYBACK_PAUSED,me,this),t.on(l.default.PLAYBACK_ENDED,Se,this),t.on(l.default.MANIFEST_UPDATED,Oe,this),t.on(l.default.BUFFERING_COMPLETED,ye,this),t.on(l.default.STREAM_BUFFERING_COMPLETED,_e,this),t.on(l.default.MANIFEST_VALIDITY_CHANGED,Ue,this),t.on(l.default.TIME_SYNCHRONIZATION_COMPLETED,Ie,this),t.on(l.default.WALLCLOCK_TIME_UPDATED,he,this),t.on(m.default.METRIC_ADDED,He,this)}()},getActiveStreamInfo:Fe,isTrackTypePresent:De,switchToVideoElement:function(e){j&&(X.initialize(Fe()),xe(e,null,!0,!1))},getStreamById:function(e){return U.filter((function(t){return t.getId()===e}))[0]},getStreamForTime:Ee,getTimeRelativeToStreamId:function(e,t){for(var n=null,r=0,i=0,a=null,o=U.length,s=0;s<o;s++){if(i=(n=U[s]).getStartTime(),a=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(a)&&(r+=a)}return null},load:function(e){Be(),T.load(e)},loadWithManifest:function(e){!function(){if(!E||!E.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}(),E.setManifest(e)},getActiveStreamProcessors:Te,setConfig:function(e){e&&(e.capabilities&&(c=e.capabilities),e.manifestLoader&&(T=e.manifestLoader),e.manifestModel&&(S=e.manifestModel),e.dashManifestModel&&(w=e.dashManifestModel),e.mediaPlayerModel&&(Q=e.mediaPlayerModel),e.protectionController&&(G=e.protectionController),e.adapter&&(A=e.adapter),e.metricsModel&&(x=e.metricsModel),e.dashMetrics&&(M=e.dashMetrics),e.errHandler&&(F=e.errHandler),e.timelineConverter&&(B=e.timelineConverter),e.videoModel&&(K=e.videoModel),e.playbackController&&(X=e.playbackController),e.domStorage&&(O=e.domStorage),e.abrController&&(D=e.abrController),e.mediaController&&(P=e.mediaController),e.textController&&(L=e.textController))},setProtectionData:function(e){H=e},reset:Ge},r=(0,h.default)(e).getInstance().getLogger(n),R=(0,g.default)(e).getInstance(),I=(0,v.default)(e).getInstance(),C=(0,y.default)(e).getInstance(),N=(0,f.default)(e).getInstance(),k=(0,p.default)(e).getInstance(),je(),n}E.__dashjs_factory_name="StreamController",t.default=c.default.getSingletonFactory(E),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(1076)),o=r(n(1092)),s=r(n(1093)),u=r(n(1097)),l=r(n(12)),c=r(n(14)),d=r(n(13)),h=r(n(29)),f=r(n(3)),p=r(n(26));function m(e){e=e||{};var t=this.context,n=(0,l.default)(t).getInstance(),r=e.manifestModel,f=e.dashManifestModel,m=e.mediaPlayerModel,g=e.manifestUpdater,v=e.adapter,y=e.capabilities,_=e.errHandler,b=e.timelineConverter,E=e.metricsModel,T=e.abrController,S=e.playbackController,w=e.mediaController,A=e.textController,x=e.videoModel,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function H(e){for(var t=R?R.length:0,r=0;r<t;r++){R[r].getFragmentModel().removeExecutedRequestsBeforeTime(q()+W()),R[r].reset(false,e)}R=[],I=!1,O=!1,ce(!1),n.off(c.default.CURRENT_TRACK_CHANGED,Z,M)}function V(){H(),D=null,P={},L=!1}function z(){S&&S.pause(),k&&(k.reset(),k=null),V(),n.off(c.default.DATA_UPDATE_COMPLETED,ae,M),n.off(c.default.BUFFERING_COMPLETED,ie,M),N&&(n.off(c.default.KEY_ERROR,X,M),n.off(c.default.SERVER_CERTIFICATE_UPDATED,X,M),n.off(c.default.LICENSE_REQUEST_COMPLETE,X,M),n.off(c.default.KEY_SYSTEM_SELECTED,X,M),n.off(c.default.KEY_SESSION_CREATED,X,M),n.off(c.default.KEY_STATUSES_CHANGED,X,M)),ce(!1)}function W(){return D?D.duration:NaN}function q(){return D?D.start:NaN}function Y(){return D}function K(){if(!(T&&T.hasOwnProperty("getBitrateList")&&v&&v.hasOwnProperty("getAllMediaInfoForType")&&v.hasOwnProperty("getEventsFor")))throw new Error(i.default.MISSING_CONFIG_ERROR)}function X(e){e.error&&(_.mediaKeySessionError(e.error.message),_.error(e.error),C.fatal(e.error.message),z())}function Q(e){var t,n=e.type,a=void 0;if(n===i.default.MUXED&&e)return a="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",C.fatal(a),_.manifestError(a,"multiplexedrep",r.getValue()),_.error(new p.default(h.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,a,r.getValue())),!1;if(n===i.default.TEXT||n===i.default.FRAGMENTED_TEXT||n===i.default.EMBEDDED_TEXT||n===i.default.IMAGE)return!0;if(t=e.codec,C.debug(n+" codec: "+t),e.contentProtection&&!y.supportsEncryptedMedia())_.capabilityError("encryptedmedia"),_.error(new p.default(h.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,h.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE));else if(!y.supportsCodec(t))return a=n+"Codec ("+t+") is not supported.",C.error(a),!1;return!0}function Z(e){if(e.newMediaInfo.streamInfo.id===D.id){var t=oe(e.newMediaInfo);if(t){var n=S.getTime();C.info("Stream -  Process track changed at current time "+n);var a=e.newMediaInfo,o=r.getValue();v.setCurrentMediaInfo(D.id,a.type,a),C.debug("Stream -  Update stream controller"),o.refreshManifestOnSwitchTrack?(C.debug("Stream -  Refreshing manifest for switch track"),j=e,g.refreshManifest()):(t.selectMediaInfo(a),a.type!==i.default.FRAGMENTED_TEXT?(T.updateTopQualityIndex(a),t.switchTrackAsked(),t.getFragmentModel().abortRequests()):(t.getScheduleController().setSeekTarget(NaN),v.setIndexHandlerTime(t,n),v.resetIndexHandler(t)))}}}function J(n,o){var s=v.getAllMediaInfoForType(D,n),l=null,c=void 0;if(s&&0!==s.length){for(var d=0,h=s.length;d<h;d++)if(l=s[d],n===i.default.EMBEDDED_TEXT)A.addEmbeddedTrack(l);else{if(!Q(l))continue;w.addTrack(l)}n!==i.default.EMBEDDED_TEXT&&0!==w.getTracksFor(n,D).length&&(n!==i.default.IMAGE?((n!==i.default.FRAGMENTED_TEXT||n===i.default.FRAGMENTED_TEXT&&A.getTextDefaultEnabled())&&(w.checkInitialMediaSettingsForType(n,D),c=w.getCurrentTrackFor(n,D)),n!==i.default.FRAGMENTED_TEXT||A.getTextDefaultEnabled()||(c=w.getTracksFor(n,D)[0]),function(n,o,s,u){var l=(0,a.default)(t).create({type:n.type,mimeType:n.mimeType,timelineConverter:b,adapter:v,manifestModel:r,dashManifestModel:f,mediaPlayerModel:m,metricsModel:E,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,stream:M,abrController:T,domStorage:e.domStorage,playbackController:S,mediaController:w,streamController:e.streamController,textController:A,errHandler:_});if(l.initialize(s),T.updateTopQualityIndex(n),u?(l.setBuffer(u.buffer),l.getIndexHandler().setCurrentTime(u.currentTime),R[u.replaceIdx]=l):R.push(l),!u||!u.ignoreMediaInfo)if(n.type===i.default.TEXT||n.type===i.default.FRAGMENTED_TEXT){for(var c=void 0,d=0;d<o.length;d++)o[d].index===n.index&&(c=d),l.addMediaInfo(o[d]);l.selectMediaInfo(o[c])}else l.addMediaInfo(n,!0)}(c,s,o)):F=(0,u.default)(t).create({dashManifestModel:f,adapter:v,baseURLController:e.baseURLController,stream:M,timelineConverter:e.timelineConverter}))}else C.info("No "+n+" data.")}function $(){B||((B=(0,o.default)(t).create()).setConfig({manifestUpdater:g,playbackController:S}),ee())}function ee(){var e=v.getEventsFor(D);B.addInlineEvents(e)}function te(e){var t=v.getAdaptationForType(r.getValue(),D.index,e,D);t&&Array.isArray(t.Representation_asArray)&&(t.Representation_asArray=t.Representation_asArray.filter((function(e,n){if(0===n)return!0;var r=f.getCodec(t,n,!0);return!!y.supportsCodec(r)||(C.error("[Stream] codec not supported: "+r),!1)})))}function ne(){for(var e=R.length,t=!!P.audio||!!P.video?new p.default(h.default.DATA_UPDATE_FAILED_ERROR_CODE,h.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,r=0;r<e;r++)if(R[r].isUpdating()||L)return;if(O){if(N)for(r=0;r<e&&R[r];r++)R[r].getType()!==i.default.AUDIO&&R[r].getType()!==i.default.VIDEO&&R[r].getType()!==i.default.FRAGMENTED_TEXT||N.initializeForMedia(R[r].getMediaInfo());n.trigger(c.default.STREAM_INITIALIZED,{streamInfo:D,error:t})}}function re(e){for(var t={},n=0,r=R.length;n<r;n++)t[R[n].getType()]=R[n].createBuffer(e).getBuffer();return t}function ie(e){if(e.streamInfo===D){var t=se(),r=t.length;if(0!==r){for(var a=0;a<r;a++)if(!t[a].isBufferingCompleted()&&(t[a].getType()===i.default.AUDIO||t[a].getType()===i.default.VIDEO))return void C.warn("onBufferingCompleted - One streamProcessor has finished but",t[a].getType(),"one is not buffering completed");C.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),n.trigger(c.default.STREAM_BUFFERING_COMPLETED,{streamInfo:D})}else C.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}}function ae(e){var t=e.sender.getStreamProcessor();t.getStreamInfo()===D&&(P[t.getType()]=e.error,ne())}function oe(e){return e?se().filter((function(t){return t.getType()===e.type}))[0]:null}function se(){for(var e=R.length,t=[],n=void 0,r=void 0,a=0;a<e;a++)(n=(r=R[a]).getType())!==i.default.AUDIO&&n!==i.default.VIDEO&&n!==i.default.FRAGMENTED_TEXT&&n!==i.default.TEXT||t.push(r);return t}function ue(e,t){if(!e)return!1;var n=e.getStreamInfo(),i=Y();if(!n||!i)return!1;var a=v.getAdaptationForType(r.getValue(),n.index,t,n),o=v.getAdaptationForType(r.getValue(),i.index,t,i);return a&&o?!a.ContentProtection&&!o.ContentProtection:!a&&!o}function le(e,t){if(!e)return!1;var n=e.getStreamInfo(),i=Y();if(!n||!i)return!1;var a=v.getAdaptationForType(r.getValue(),n.index,t,n),o=v.getAdaptationForType(r.getValue(),i.index,t,i);if(!a||!o)return!a&&!o;var s=a&&o&&a.mimeType===o.mimeType,u=o.Representation_asArray.map((function(e){return e.codecs})),l=a.Representation_asArray.map((function(e){return e.codecs})),c=l.some((function(e){return u.indexOf(e)>-1})),d=l.some((function(e){return u.some((function(t){return function(e,t){for(var n=e.split(".")[0],r=0===t.indexOf(n),i=void 0,a=0;a<G.length;a++)if(G[a].codec===n){i=G[a];break}if(i)return r||i.compatibleCodecs.some((function(e){return 0===t.indexOf(e)}));return r}(t,e)}))}));return c||d&&s}function ce(e){U=e}function de(){return U}return M={initialize:function(e,t){D=e,(N=t)&&(n.on(c.default.KEY_ERROR,X,M),n.on(c.default.SERVER_CERTIFICATE_UPDATED,X,M),n.on(c.default.LICENSE_REQUEST_COMPLETE,X,M),n.on(c.default.KEY_SYSTEM_SELECTED,X,M),n.on(c.default.KEY_SESSION_CREATED,X,M),n.on(c.default.KEY_STATUSES_CHANGED,X,M))},activate:function(e,t){if(!I){var a=void 0;return n.on(c.default.CURRENT_TRACK_CHANGED,Z,M),de()?(!function(){if(L=!0,K(),te(i.default.VIDEO),te(i.default.AUDIO),O=!0,L=!1,0===R.length){var e="No streams to play.";_.manifestError(e,"nostreams",r.getValue()),C.debug(e)}else ne()}(),a=t):a=function(e,t){K();var n=x.getElement();$(),L=!0,te(i.default.VIDEO),te(i.default.AUDIO),(null===n||n&&/^VIDEO$/i.test(n.nodeName))&&J(i.default.VIDEO,e);J(i.default.AUDIO,e),J(i.default.TEXT,e),J(i.default.FRAGMENTED_TEXT,e),J(i.default.EMBEDDED_TEXT,e),J(i.default.MUXED,e),J(i.default.IMAGE,e);var a=re(t);if(O=!0,L=!1,0===R.length){var o="No streams to play.";_.manifestError(o,"nostreams",r.getValue()),_.error(new p.default(h.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,o,r.getValue())),C.fatal(o)}else ne();return a}(e,t),I=!0,a}return t},deactivate:H,isActive:function(){return I},getDuration:W,getStartTime:q,getId:function(){return D?D.id:null},getStreamInfo:Y,preload:function(e,t){$(),J(i.default.VIDEO,e),J(i.default.AUDIO,e),J(i.default.TEXT,e),J(i.default.FRAGMENTED_TEXT,e),J(i.default.EMBEDDED_TEXT,e),J(i.default.MUXED,e),J(i.default.IMAGE,e),re(t),n.on(c.default.CURRENT_TRACK_CHANGED,Z,M);for(var r=0;r<R.length&&R[r];r++)R[r].getScheduleController().start();ce(!0)},getFragmentController:function(){return k},getThumbnailController:function(){return F},getBitrateListFor:function(e){if(K(),e===i.default.IMAGE)return F?F.getBitrateList():[];var t=function(e){for(var t=R.length,n=null,r=0;r<t;r++)if((n=R[r]).getType()===e)return n.getMediaInfo();return null}(e);return T.getBitrateList(t)},startEventController:function(){B&&B.start()},stopEventController:function(){B&&B.stop()},updateData:function(e){C.info("Manifest updated... updating data system wide."),I=!1,L=!0,D=e,B&&ee(),te(i.default.VIDEO),te(i.default.AUDIO);for(var t=0,n=R.length;t<n;t++){var r=R[t],a=v.getMediaInfoForType(D,r.getType());T.updateTopQualityIndex(a),r.addMediaInfo(a,!0)}if(j&&"fragmentedText"!==(a=j.newMediaInfo).type){var o=oe(j.oldMediaInfo);if(!o)return;o.switchTrackAsked(),j=void 0}L=!1,ne()},reset:z,getProcessors:se,setMediaSource:function(e){for(var t=0;t<R.length;)Q(R[t].getMediaInfo())?(R[t].setMediaSource(e),t++):(R[t].reset(),R.splice(t,1));for(t=0;t<R.length;t++)R[t].dischargePreBuffer();if(0===R.length){var n="No streams to play.";_.manifestError(n,"nostreams",r.getValue()),_.error(new p.default(h.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,n+"nostreams",r.getValue())),C.fatal(n)}},isMediaCodecCompatible:function(e){return le(e,i.default.VIDEO)&&le(e,i.default.AUDIO)},isProtectionCompatible:function(e){return ue(e,i.default.VIDEO)&&ue(e,i.default.AUDIO)},getPreloaded:de,addInbandEvents:function(e){B&&B.addInbandEvents(e)}},C=(0,d.default)(t).getInstance().getLogger(M),V(),k=(0,s.default)(t).create({mediaPlayerModel:m,metricsModel:E,errHandler:_}),n.on(c.default.BUFFERING_COMPLETED,ie,M),n.on(c.default.DATA_UPDATE_COMPLETED,ae,M),M}m.__dashjs_factory_name="Stream",t.default=f.default.getClassFactory(m),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(1077)),o=r(n(62)),s=r(n(1078)),u=r(n(1080)),l=r(n(1083)),c=r(n(3)),d=r(n(1084));function h(e){e=e||{};var t=this.context,n=e.type,r=e.errHandler,c=e.mimeType,h=e.timelineConverter,f=e.adapter,p=e.manifestModel,m=e.mediaPlayerModel,g=e.stream,v=e.abrController,y=e.playbackController,_=e.streamController,b=e.mediaController,E=e.textController,T=e.domStorage,S=e.metricsModel,w=e.dashMetrics,A=e.dashManifestModel,x=void 0,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0;function k(){L=[]}function F(){C=[],M=null,k()}function B(){return g?g.getStreamInfo():null}function U(){return M}return x={initialize:function(a){(N=(0,d.default)(t).create({mimeType:c,timelineConverter:h,dashMetrics:w,metricsModel:S,mediaPlayerModel:m,baseURLController:e.baseURLController,errHandler:r})).initialize(x),v.registerStreamType(n,x),(P=g.getFragmentController().getModel(n)).setStreamProcessor(x),R=function(e){var n=null;n=e===i.default.VIDEO||e===i.default.AUDIO?(0,o.default)(t).create({type:e,metricsModel:S,mediaPlayerModel:m,manifestModel:p,errHandler:r,streamController:_,mediaController:b,adapter:f,textController:E,abrController:v,playbackController:y,streamProcessor:x}):(0,s.default)(t).create({type:e,mimeType:c,metricsModel:S,mediaPlayerModel:m,manifestModel:p,errHandler:r,streamController:_,mediaController:b,adapter:f,textController:E,abrController:v,playbackController:y,streamProcessor:x});return n}(n),I=(0,u.default)(t).create({type:n,mimeType:c,metricsModel:S,adapter:f,dashMetrics:w,dashManifestModel:A,timelineConverter:h,mediaPlayerModel:m,abrController:v,playbackController:y,streamController:_,textController:E,streamProcessor:x,mediaController:b}),(D=(0,l.default)(t).create()).setConfig({abrController:v,domStorage:T,metricsModel:S,dashMetrics:w,dashManifestModel:A,manifestModel:p,playbackController:y,timelineConverter:h,streamProcessor:x}),R.initialize(a),I.initialize(),D.initialize()},isUpdating:function(){return!!D&&D.isUpdating()},getType:function(){return n},getBufferController:function(){return R},getFragmentModel:function(){return P},getScheduleController:function(){return I},getLiveEdgeFinder:function(){return O},getFragmentController:function(){return g?g.getFragmentController():null},getRepresentationController:function(){return D},getIndexHandler:function(){return N},getRepresentationInfo:function(e){return f.getRepresentationInfo(D,e)},getBufferLevel:function(){return R.getBufferLevel()},switchInitData:function(e,t){R&&R.switchInitData(B().id,e,t)},isBufferingCompleted:function(){return!!R&&R.getIsBufferingCompleted()},timeIsBuffered:function(e){return!!R&&null!==R.getRangeAt(e,0)},createBuffer:function(e){return R.getBuffer()||R.createBuffer(M,e)},getStreamInfo:B,selectMediaInfo:function(e){e===M||e&&M&&e.type!==M.type||(M=e),f.updateData(this)},addMediaInfo:function(e,t){-1===C.indexOf(e)&&C.push(e),t&&this.selectMediaInfo(e)},switchTrackAsked:function(){I.switchTrackAsked()},getMediaInfoArr:function(){return C},getMediaInfo:U,getMediaSource:function(){return R.getMediaSource()},setMediaSource:function(e){R.setMediaSource(e,U())},dischargePreBuffer:function(){R.dischargePreBuffer()},getBuffer:function(){return R.getBuffer()},setBuffer:function(e){R.setBuffer(e)},registerExternalController:function(e){L.push(e)},unregisterExternalController:function(e){var t=L.indexOf(e);-1!==t&&L.splice(t,1)},getExternalControllers:function(){return L},unregisterAllExternalController:k,addInbandEvents:function(e){g&&g.addInbandEvents(e)},reset:function(e,t){N.reset(),R&&(R.reset(e,t),R=null),I&&(I.reset(),I=null),D&&(D.reset(),D=null),v&&v.unRegisterStreamType(n),L.forEach((function(e){e.reset()})),F(),n=null,g=null,O&&(O.reset(),O=null)}},y&&y.getIsDynamic()&&(O=(0,a.default)(t).create({timelineConverter:h,streamProcessor:x})),F(),x}h.__dashjs_factory_name="StreamProcessor",t.default=c.default.getClassFactory(h),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(11));function o(e){var t=(e=e||{}).timelineConverter,n=e.streamProcessor;return{getLiveEdge:function(){!function(){if(!(t&&t.hasOwnProperty("getExpectedLiveEdge")&&n&&n.hasOwnProperty("getRepresentationInfo")))throw new Error(a.default.MISSING_CONFIG_ERROR)}();var e=n.getRepresentationInfo(),r=e.DVRWindow?e.DVRWindow.end:0,i=r;return e.useCalculatedLiveEdgeTime&&(i=t.getExpectedLiveEdge(),t.setClientTimeOffset(i-r)),i},reset:function(){t=null,n=null}}}o.__dashjs_factory_name="LiveEdgeFinder",t.default=i.default.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(3)),o=r(n(62)),s=r(n(1079));function u(e){e=e||{};var t,n=this.context,r=void 0;function a(){return r.getBuffer()}return t={getBufferControllerType:function(){return r.getBufferControllerType()},initialize:function(e,t){return r.initialize(e,t)},createBuffer:function(e){return r.createBuffer(e)},getType:function(){return r.getType()},getStreamProcessor:function(){r.getStreamProcessor()},setSeekStartTime:function(e){r.setSeekStartTime(e)},getBuffer:a,setBuffer:function(e){r.setBuffer(e)},getBufferLevel:function(){return r.getBufferLevel()},setMediaSource:function(e){r.setMediaSource(e)},getMediaSource:function(){return r.getMediaSource()},getIsBufferingCompleted:function(){return r.getIsBufferingCompleted()},getIsPruningInProgress:function(){return r.getIsPruningInProgress()},dischargePreBuffer:function(){return r.dischargePreBuffer()},switchInitData:function(e,t){r.switchInitData(e,t)},getRangeAt:function(e){return r.getRangeAt(e)},reset:function(e){r.reset(e)},updateTimestampOffset:function(e){var t=a();t.timestampOffset===e||isNaN(e)||(t.timestampOffset=e)}},r=e.type===i.default.FRAGMENTED_TEXT?(0,o.default)(n).create({type:e.type,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,manifestModel:e.manifestModel,errHandler:e.errHandler,streamController:e.streamController,mediaController:e.mediaController,adapter:e.adapter,textController:e.textController,abrController:e.abrController,playbackController:e.playbackController,streamProcessor:e.streamProcessor}):(0,s.default)(n).create({type:e.type,mimeType:e.mimeType,errHandler:e.errHandler,streamProcessor:e.streamProcessor}),t}u.__dashjs_factory_name="TextBufferController",t.default=a.default.getClassFactory(u),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(12)),o=r(n(14)),s=r(n(3)),u=r(n(158)),l=r(n(207)),c=r(n(155)),d=r(n(26)),h=r(n(29)),f="NotFragmentedTextBufferController";function p(e){e=e||{};var t=this.context,n=(0,a.default)(t).getInstance(),r=(0,c.default)(t).getInstance(),s=e.errHandler,p=e.type,m=e.mimeType,g=e.streamProcessor,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0;function S(e){b=e}function w(e){e.sender.getStreamProcessor()===g&&(T.extract(g.getStreamInfo().id,e.sender.getCurrentRepresentation().id)||n.trigger(o.default.TIMED_TEXT_REQUESTED,{index:0,sender:e.sender}))}function A(e){e.fragmentModel===g.getFragmentModel()&&e.chunk.bytes&&(T.save(e.chunk),E.append(e.chunk),n.trigger(o.default.STREAM_COMPLETED,{request:e.request,fragmentModel:e.fragmentModel}))}return v={getBufferControllerType:function(){return f},initialize:function(e){S(e),T=(0,u.default)(t).getInstance()},createBuffer:function(e){try{if(E=(0,l.default)(t).create(b,e),!_){var n=E.getBuffer();n.hasOwnProperty(i.default.INITIALIZE)&&n.initialize(m,g),_=!0}return E}catch(t){if(e.isText||-1!==e.codec.indexOf('codecs="stpp')||-1!==e.codec.indexOf('codecs="wvtt'))try{E=r.getTextSourceBuffer()}catch(e){s.mediaSourceError("Error creating "+p+" source buffer."),s.error(new d.default(h.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,h.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+p+" : "+e.message))}else s.mediaSourceError("Error creating "+p+" source buffer."),s.error(new d.default(h.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,h.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+p))}},getType:function(){return p},getStreamProcessor:function(){return g},setSeekStartTime:function(){},getBuffer:function(){return E},getBufferLevel:function(){return 0},setMediaSource:S,getMediaSource:function(){return b},getIsBufferingCompleted:function(){return y},getIsPruningInProgress:function(){return!1},dischargePreBuffer:function(){},switchInitData:function(e,t){T.extract(e,t)||n.trigger(o.default.TIMED_TEXT_REQUESTED,{index:0,sender:v})},getRangeAt:function(){return null},reset:function(e){n.off(o.default.DATA_UPDATE_COMPLETED,w,v),n.off(o.default.INIT_FRAGMENT_LOADED,A,v),!e&&E&&(E.abort(),E.reset(),E=null)},updateTimestampOffset:function(e){E.timestampOffset===e||isNaN(e)||(E.timestampOffset=e)}},_=!1,b=null,y=!1,n.on(o.default.DATA_UPDATE_COMPLETED,w,v),n.on(o.default.INIT_FRAGMENT_LOADED,A,v),v}p.__dashjs_factory_name=f,t.default=s.default.getClassFactory(p),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=n(213),o=r(n(115)),s=r(n(62)),u=r(n(1081)),l=r(n(1082)),c=r(n(113)),d=r(n(12)),h=r(n(14)),f=r(n(3)),p=r(n(13)),m=r(n(157)),g=n(64);function v(e){e=e||{};var t=this.context,n=(0,d.default)(t).getInstance(),r=e.metricsModel,f=e.adapter,v=e.dashMetrics,y=e.dashManifestModel,_=e.timelineConverter,b=e.mediaPlayerModel,E=e.abrController,T=e.playbackController,S=e.streamController,w=e.textController,A=e.type,x=e.streamProcessor,M=e.mediaController,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0,V=void 0,z=void 0,W=void 0,q=void 0,Y=void 0,K=void 0,X=void 0,Q=void 0;function Z(){O&&!x.isBufferingCompleted()?(R.debug("Schedule Controller starts"),xe(),P=!1,D&&(D=!1),ee(0)):R.warn("Start denied to Schedule Controller")}function J(){P||(R.debug("Schedule Controller stops"),P=!0,clearTimeout(U))}function $(){var e=x.getBufferController();if(P||F||!e||T.isPaused()&&!b.getScheduleWhilePaused()||!(A!==i.default.FRAGMENTED_TEXT&&A!==i.default.TEXT||w.isTextEnabled()))R.debug("Schedule stop!");else if(e.getIsBufferingCompleted())R.debug("Schedule stop because buffering is completed!");else{!function(){var e=T.getTime(),t=1.5*O.fragmentDuration,n=I.getRequests({state:c.default.FRAGMENT_MODEL_EXECUTED,time:e+t,threshold:0})[0];if(n&&-1===q.indexOf(n)&&!y.getIsTextTrack(A)){var r=b.getFastSwitchEnabled(),i=x.getBufferLevel(),a=E.getAbandonmentStateFor(A),s=!M.isCurrentTrack(n.mediaInfo)&&M.getSwitchMode(n.mediaInfo.type)===m.default.TRACK_SWITCH_MODE_NEVER_REPLACE,u=n.quality<O.quality;r&&(s||u)&&i>=t&&a!==o.default.ABANDON_LOAD?(ie(n),Q=!0,R.debug("Reloading outdated fragment at index: ",n.index)):n.quality>O.quality&&!K&&Se(T.getTime()+x.getBufferLevel())}}();var t=q.length>0,n=x.getStreamInfo();if(K||isNaN(W)||Y||t||function(e,t){z[t]=z[t]||{};var n=E.getTopQualityIndexFor(e,t);return z[t][e]!=n&&(R.info("Top quality "+e+" index has changed from "+z[t][e]+" to "+n),z[t][e]=n,!0)}(O.mediaInfo.type,n.id)||G.execute(x,S.isTrackTypePresent(i.default.VIDEO))){ne(!0),t||Y||E.checkPlaybackQuality(A),function(){var e=x.getFragmentController();if(O.quality===W&&!Y||K){var t=q.shift();if(e.isInitializationRequest(t))x.switchInitData(t.representationId);else{var r=void 0;x.getBufferController().getIsPruningInProgress()||(r=H.execute(x,j,t),Se(NaN),r&&!t&&(isNaN(r.startTime+r.duration)||f.setIndexHandlerTime(x,r.startTime+r.duration),r.delayLoadingTime=(new Date).getTime()+B,we(0)),!r&&n.manifestInfo&&n.manifestInfo.isDynamic&&R.debug("Next fragment seems to be at the bleeding live edge and is not available yet. Rescheduling.")),r?(R.debug("Next fragment request url is "+r.url),I.executeRequest(r)):(ne(!1),ee(b.getLowLatencyEnabled()?100:500))}}else R.debug("Quality has changed, get init request for representationid = "+O.id),Y?(K=M.getSwitchMode(A)===m.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,R.debug("Switch track has been asked, get init request for "+A+" with representationid = "+O.id+"bufferResetInProgress = "+K),x.switchInitData(O.id,K),Y=!1):x.switchInitData(O.id),W=O.quality}()}else ee(500)}}function ee(e){clearTimeout(U),U=setTimeout($,e)}function te(e){e.sender&&e.sender.getStreamProcessor()===x&&re(O.quality)}function ne(e){F!==e?F=e:R.debug("isFragmentProcessingInProgress is already equal to",e)}function re(e){var t=f.getInitRequest(x,e);t&&(ne(!0),t.url=(0,g.replaceTokenForTemplate)(t.url,"Bandwidth",O?O.bandwidth:null),I.executeRequest(t))}function ie(e){q.push(e)}function ae(e){if(A===e.mediaType&&x.getStreamInfo().id===e.streamInfo.id){if(null==(O=x.getRepresentationInfo(e.newQuality)))throw new Error("Unexpected error! - currentRepresentationInfo is null or undefined");Ae(new Date,a.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),xe()}}function oe(e){if(T&&I){var t=I.getRequests({state:c.default.FRAGMENT_MODEL_EXECUTED,time:T.getTime(),threshold:0})[0];t&&T.getTime()>=t.startTime&&((!V.mediaInfo||t.mediaInfo.type===V.mediaInfo.type&&t.mediaInfo.id!==V.mediaInfo.id)&&e&&n.trigger(h.default.TRACK_CHANGE_RENDERED,{mediaType:A,oldMediaInfo:V.mediaInfo,newMediaInfo:t.mediaInfo}),t.quality===V.quality&&t.adaptationIndex===V.adaptationIndex||!e||n.trigger(h.default.QUALITY_CHANGE_RENDERED,{mediaType:A,oldQuality:V.quality,newQuality:t.quality}),V={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function se(e){e.error||e.sender.getStreamProcessor()!==x||(O=f.convertDataToRepresentationInfo(e.currentRepresentation))}function ue(e){e.error||x.getStreamInfo().id!==e.streamInfo.id||(O=x.getRepresentationInfo(),D&&(T.getIsDynamic()?(_.setTimeSyncCompleted(!0),function(){var e=x.getLiveEdgeFinder();if(e){var t=e.getLiveEdge(),n=O.mediaInfo.streamInfo.manifestInfo.DVRWindowSize/2,a=t-T.computeLiveDelay(O.fragmentDuration,n),o=f.getFragmentRequest(x,O,a,{ignoreIsFinished:!0});if(o)if(b.getLowLatencyEnabled()){var s=o.duration<b.getLiveDelay()?o.startTime:o.startTime+o.duration-b.getLiveDelay();T.setLiveStartTime(s)}else T.setLiveStartTime(o.startTime);else R.debug("setLiveEdgeSeekTarget : getFragmentRequest returned undefined request object");j=T.getStreamStartTime(!1,t),x.getBufferController().setSeekStartTime(j),j>O.mediaInfo.streamInfo.start+O.mediaInfo.streamInfo.duration&&T.seek(j);var u=v.getCurrentManifestUpdate(r.getMetricsFor(i.default.STREAM));r.updateManifestUpdateInfo(u,{currentTime:j,presentationStartTime:t,latency:t-j,clientTimeOffset:_.getClientTimeOffset()})}}()):(j=T.getStreamStartTime(!1),x.getBufferController().setSeekStartTime(j))),P&&Z())}function le(e){e.fragmentModel===I&&(J(),ne(!1),R.info("Stream is complete"))}function ce(e){e.sender===I&&(R.info("OnFragmentLoadingCompleted - Url:",e.request?e.request.url:"undefined",", Range:",e.request.range?e.request.range:"undefined"),y.getIsTextTrack(A)&&ne(!1),e.error&&e.request.serviceLocation&&!P&&(ie(e.request),ne(!1),ee(0)),K&&(X=e.request))}function de(){oe(!0)}function he(e){if(e.sender.getStreamProcessor()===x)if(K&&!isNaN(e.startTime)&&(K=!1,I.addExecutedRequest(X)),ne(!1),Q&&!isNaN(e.startTime)){var t=T.getTime(),n=e.startTime+O.fragmentDuration,r=1.5*O.fragmentDuration;ee(t+r>=n?0:1e3*(n-(t+r))),Q=!1}else ee(0)}function fe(e){e.streamProcessor===x&&(R.info("onFragmentLoadingAbandoned for "+A+", request: "+e.request.url+" has been aborted"),T.isSeeking()||Y||(R.info("onFragmentLoadingAbandoned for "+A+", request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),ie(e.request)),ne(!1),ee(0))}function pe(e){e.sender.getStreamProcessor()===x&&J()}function me(e){if(e.sender.getStreamProcessor()===x){var t=x.getStreamInfo();t&&(e.unintended?I.removeExecutedRequestsAfterTime(e.from,t.duration):I.syncExecutedRequestsWithBufferedRange(x.getBufferController().getBuffer().getAllBufferRanges(),t.duration)),e.hasEnoughSpaceToAppend&&P&&Z()}}function ge(e){e.sender.getStreamProcessor()!==x||e.state!==s.default.BUFFER_EMPTY||T.isSeeking()||(R.info("Buffer is empty! Stalling!"),Ae(new Date,a.PlayListTrace.REBUFFERING_REASON))}function ve(e){e.sender.getStreamProcessor()===x&&(J(),ne(!1))}function ye(){I.abortRequests(),J()}function _e(e){e.sender.getStreamProcessor()===x&&w.isTextEnabled()&&re(e.index)}function be(){!P&&b.getScheduleWhilePaused()||Z()}function Ee(e){j=e.seekTime,we(0),P&&Z();var t=v.getCurrentManifestUpdate(r.getMetricsFor(i.default.STREAM)),n=O.DVRWindow&&T?O.DVRWindow.end-T.getTime():NaN;r.updateManifestUpdateInfo(t,{latency:n}),F?(R.debug("onPlaybackSeeking for "+A+", call fragmentModel.abortRequests in order to seek quicker"),I.abortRequests()):ee(0)}function Te(e){N&&(N.playbackspeed=e.playbackRate.toString())}function Se(e){j=e}function we(e){B=e}function Ae(e,t){if(L&&!1===k){var n=N.start,r=e.getTime()-n.getTime();N.duration=r,N.stopreason=t,L.trace.push(N),k=!0}}function xe(){L&&!0===k&&O&&(k=!1,(N=new a.PlayListTrace).representationid=O.id,N.start=new Date,N.mstart=1e3*T.getTime(),N.playbackspeed=T.getPlaybackRate().toString())}function Me(){F=!1,B=0,j=NaN,L=null,N=null,k=!0,D=!0,W=NaN,V={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},z={},q=[],P=!0,Y=!1,K=!1,X=null,Q=!1}return C={initialize:function(){I=x.getFragmentModel(),G=(0,u.default)(t).create({abrController:E,dashMetrics:v,metricsModel:r,mediaPlayerModel:b,textController:w}),H=(0,l.default)(t).create({adapter:f,textController:w,playbackController:T}),y.getIsTextTrack(e.mimeType)&&n.on(h.default.TIMED_TEXT_REQUESTED,_e,this),n.on(h.default.QUALITY_CHANGE_REQUESTED,ae,this),n.on(h.default.DATA_UPDATE_STARTED,pe,this),n.on(h.default.DATA_UPDATE_COMPLETED,se,this),n.on(h.default.FRAGMENT_LOADING_COMPLETED,ce,this),n.on(h.default.STREAM_COMPLETED,le,this),n.on(h.default.STREAM_INITIALIZED,ue,this),n.on(h.default.BUFFER_LEVEL_STATE_CHANGED,ge,this),n.on(h.default.BUFFER_CLEARED,me,this),n.on(h.default.BYTES_APPENDED_END_FRAGMENT,he,this),n.on(h.default.INIT_REQUESTED,te,this),n.on(h.default.QUOTA_EXCEEDED,ve,this),n.on(h.default.PLAYBACK_SEEKING,Ee,this),n.on(h.default.PLAYBACK_STARTED,be,this),n.on(h.default.PLAYBACK_RATE_CHANGED,Te,this),n.on(h.default.PLAYBACK_TIME_UPDATED,de,this),n.on(h.default.URL_RESOLUTION_FAILED,ye,this),n.on(h.default.FRAGMENT_LOADING_ABANDONED,fe,this)},getType:function(){return A},setSeekTarget:Se,setTimeToLoadDelay:we,replaceRequest:ie,switchTrackAsked:function(){Y=!0},isStarted:function(){return!1===P},start:Z,stop:J,reset:function(){n.off(h.default.DATA_UPDATE_STARTED,pe,this),n.off(h.default.DATA_UPDATE_COMPLETED,se,this),n.off(h.default.BUFFER_LEVEL_STATE_CHANGED,ge,this),n.off(h.default.QUALITY_CHANGE_REQUESTED,ae,this),n.off(h.default.FRAGMENT_LOADING_COMPLETED,ce,this),n.off(h.default.STREAM_COMPLETED,le,this),n.off(h.default.STREAM_INITIALIZED,ue,this),n.off(h.default.QUOTA_EXCEEDED,ve,this),n.off(h.default.BYTES_APPENDED_END_FRAGMENT,he,this),n.off(h.default.BUFFER_CLEARED,me,this),n.off(h.default.INIT_REQUESTED,te,this),n.off(h.default.PLAYBACK_RATE_CHANGED,Te,this),n.off(h.default.PLAYBACK_SEEKING,Ee,this),n.off(h.default.PLAYBACK_STARTED,be,this),n.off(h.default.PLAYBACK_TIME_UPDATED,de,this),n.off(h.default.URL_RESOLUTION_FAILED,ye,this),n.off(h.default.FRAGMENT_LOADING_ABANDONED,fe,this),y.getIsTextTrack(A)&&n.off(h.default.TIMED_TEXT_REQUESTED,_e,this),J(),oe(!1),Me()},setPlayList:function(e){L=e},getBufferTarget:function(){return G.getBufferTarget(x,S.isTrackTypePresent(i.default.VIDEO))},finalisePlayList:function(e,t){Ae(e,t),L=null}},R=(0,p.default)(t).getInstance().getLogger(C),Me(),C}v.__dashjs_factory_name="ScheduleController",t.default=f.default.getClassFactory(v),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(3));function o(e){var t=(e=e||{}).dashMetrics,n=e.metricsModel,r=e.mediaPlayerModel,a=e.textController,o=e.abrController;function s(e,s){var u=NaN;if(!e)return u;var l=e.getType(),c=e.getRepresentationInfo();if(l===i.default.FRAGMENTED_TEXT)u=a.isTextEnabled()?c.fragmentDuration:0;else if(l===i.default.AUDIO&&s){var d=t.getCurrentBufferLevel(n.getReadOnlyMetricsFor(i.default.VIDEO));u=isNaN(c.fragmentDuration)?d:Math.max(d,c.fragmentDuration)}else{var h=c.mediaInfo.streamInfo;if(o.isPlayingAtTopQuality(h))u=h.manifestInfo.duration>=r.getLongFormContentDurationThreshold()?r.getBufferTimeAtTopQualityLongForm():r.getBufferTimeAtTopQuality();else u=r.getStableBufferTime()}return u}return{execute:function(e,r){return!e||t.getCurrentBufferLevel(n.getReadOnlyMetricsFor(e.getType()))<s(e,r)},getBufferTarget:s}}o.__dashjs_factory_name="BufferLevelRule",t.default=a.default.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(13)),o=r(n(3)),s=r(n(63));function u(e){e=e||{};var t=this.context,n=e.adapter,r=e.textController,o=e.playbackController,u=void 0,l=void 0;return u={execute:function(e,t,a){if(!e)return null;var u=e.getRepresentationInfo(),c=e.getType(),d=!isNaN(t),h=e.getBufferController(),f=o.getNormalizedTime(),p=d?t:n.getIndexHandlerTime(e),m=!1,g=void 0;if(isNaN(p)||c===i.default.FRAGMENTED_TEXT&&!r.isTextEnabled())return null;if(h){var v=h.getRangeAt(p),y=h.getRangeAt(f),_=h.getBuffer().hasDiscontinuitiesAfter(f);null===v&&null===y||d||((!v||y&&y.start!=v.start&&y.end!=v.end)&&(_&&c!==i.default.FRAGMENTED_TEXT&&(e.getFragmentModel().removeExecutedRequestsAfterTime(y.end),m=!0),v=y),p!==v.end&&(l.debug("Prior to making a request for time, NextFragmentRequestRule is aligning index handler's currentTime with bufferedRange.end for",c,".",p,"was changed to",v.end),p=v.end))}if(a)p=a.startTime+a.duration/2,g=n.getFragmentRequest(e,u,p,{timeThreshold:0,ignoreIsFinished:!0});else for(g=n.getFragmentRequest(e,u,p,{keepIdx:!d&&!m});g&&g.action!==s.default.ACTION_COMPLETE&&e.getFragmentModel().isFragmentLoaded(g);)g=n.getFragmentRequest(e,u);return g}},l=(0,a.default)(t).getInstance().getLogger(u),u}u.__dashjs_factory_name="NextFragmentRequestRule",t.default=o.default.getClassFactory(u),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(29)),o=r(n(39)),s=r(n(26)),u=r(n(12)),l=r(n(14)),c=r(n(3)),d=r(n(160));function h(){var e=this.context,t=(0,u.default)(e).getInstance(),n=void 0,r=void 0,c=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0;function A(){return h}function x(){return p}function M(){r=null,c=-1,h=!0,f=[],m=null,v=null,y=null,_=null,b=null,E=null,T=null}function C(){var e=new Date,t=x(),n=1e3*v.getTime();y.addRepresentationSwitch(t.adaptation.type,e,n,t.id)}function R(){var e=S.getStreamInfo(),t=e?e.manifestInfo:null,n=t?t.isDynamic:null,r=b.calcSegmentAvailabilityRange(p,n);y.addDVRInfo(S.getType(),v.getTime(),t,r)}function I(e){return null==e||e>=f.length?null:f[e]}function O(e){var r=e;h=!1,t.trigger(l.default.AST_IN_FUTURE,{delay:r}),setTimeout((function(){if(!A()){h=!0,t.trigger(l.default.DATA_UPDATE_STARTED,{sender:n}),f.forEach((function(e){e.segmentAvailabilityRange=null}));for(var e=0;e<f.length;e++)g.updateRepresentation(f[e],!0)}}),r)}function D(e){if(e.sender.getStreamProcessor()===S&&A()){var n,u=e.representation,c=y.getMetricsFor(i.default.STREAM),g=y.getMetricsFor(x().adaptation.type),_=T.getCurrentManifestUpdate(c),b=!1,E=0,w=void 0,M=void 0;if(u.adaptation.period.mpd.manifest.type===o.default.DYNAMIC&&!u.adaptation.period.mpd.manifest.ignorePostponeTimePeriod){var I=u.segmentAvailabilityRange.end-u.segmentAvailabilityRange.start;E=1e3*(v.computeLiveDelay(p.segmentDuration,S.getStreamInfo().manifestInfo.DVRWindowSize)-I)}if(E>0)return R(),O(E),M=new s.default(a.default.SEGMENTS_UPDATE_FAILED_ERROR_CODE,a.default.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE),void t.trigger(l.default.DATA_UPDATE_COMPLETED,{sender:this,data:r,currentRepresentation:p,error:M});if(_){for(var D=0;D<_.representationInfo.length;D++)if((w=_.representationInfo[D]).index===u.index&&w.mediaType===S.getType()){b=!0;break}b||y.addManifestUpdateRepresentationInfo(_,u.id,u.index,u.adaptation.period.index,S.getType(),u.presentationTimeOffset,u.startNumber,u.segmentInfoType)}(function(){for(var e=0,t=f.length;e<t;e++){var n=f[e].segmentInfoType;if(null===f[e].segmentAvailabilityRange||!d.default.hasInitialization(f[e])||(n===o.default.SEGMENT_BASE||n===o.default.BASE_URL)&&!f[e].segments)return!1}return!0})()&&(h=!1,m.setPlaybackQuality(S.getType(),S.getStreamInfo(),(n=p,f.indexOf(n))),y.updateManifestUpdateInfo(_,{latency:p.segmentAvailabilityRange.end-v.getTime()}),T.getCurrentRepresentationSwitch(g)||C(),t.trigger(l.default.DATA_UPDATE_COMPLETED,{sender:this,data:r,currentRepresentation:p}))}}function P(e){e.isDynamic&&function(e){for(var t=void 0,n=0,r=f.length;n<r;n++)(t=f[n]).segmentAvailabilityRange=b.calcSegmentAvailabilityRange(t,e)}(e.isDynamic)}function L(e){e.sender.getStreamProcessor()===S&&(w.getValue().doNotUpdateDVRWindowOnBufferUpdated||R())}function N(e){if(e.mediaType===S.getType()&&S.getStreamInfo().id===e.streamInfo.id&&e.oldQuality!==e.newQuality){p=I(e.newQuality);var t=m.getThroughputHistory().getAverageThroughput(e.mediaType);isNaN(t)||_.setSavedBitrateSettings(e.mediaType,t),C()}}function k(e){if(e.newDuration){var t=x();if(t&&t.adaptation.period)t.adaptation.period.duration=e.newDuration}}return n={initialize:function(){g=S.getIndexHandler()},setConfig:function(e){e.abrController&&(m=e.abrController),e.domStorage&&(_=e.domStorage),e.metricsModel&&(y=e.metricsModel),e.dashMetrics&&(T=e.dashMetrics),e.dashManifestModel&&(E=e.dashManifestModel),e.playbackController&&(v=e.playbackController),e.timelineConverter&&(b=e.timelineConverter),e.manifestModel&&(w=e.manifestModel),e.streamProcessor&&(S=e.streamProcessor)},getData:function(){return r},getDataIndex:function(){return c},isUpdating:A,updateData:function(e,n,a){var o=S.getStreamInfo(),s=m.getTopQualityIndexFor(a,o.id),u=m.getMinAllowedIndexFor(a),d=void 0,v=null;if(h=!0,t.trigger(l.default.DATA_UPDATE_STARTED,{sender:this}),f=function(e){return c=E.getIndexForAdaptation(r,e.period.mpd.manifest,e.period.index),E.getRepresentationsForAdaptation(e)}(n),null!==r&&r.id==e.id||a===i.default.FRAGMENTED_TEXT?d=m.getQualityFor(a,o):(v=m.getThroughputHistory().getAverageThroughput(a)||m.getInitialBitrateFor(a,o),d=m.getQualityForBitrate(S.getMediaInfo(),v)),void 0!==u&&d<u&&(d=u),d>s&&(d=s),p=I(d),r=e,a!==i.default.VIDEO&&a!==i.default.AUDIO&&a!==i.default.FRAGMENTED_TEXT)return h=!1,void t.trigger(l.default.DATA_UPDATE_COMPLETED,{sender:this,data:r,currentRepresentation:p});for(var y=0;y<f.length;y++)g.updateRepresentation(f[y],!0)},getStreamProcessor:function(){return S},getCurrentRepresentation:x,getRepresentationForQuality:I,reset:function(){t.off(l.default.QUALITY_CHANGE_REQUESTED,N,n),t.off(l.default.REPRESENTATION_UPDATED,D,n),t.off(l.default.WALLCLOCK_TIME_UPDATED,P,n),t.off(l.default.BUFFER_LEVEL_UPDATED,L,n),t.off(l.default.MANIFEST_VALIDITY_CHANGED,k,n),M()}},M(),t.on(l.default.QUALITY_CHANGE_REQUESTED,N,n),t.on(l.default.REPRESENTATION_UPDATED,D,n),t.on(l.default.WALLCLOCK_TIME_UPDATED,P,n),t.on(l.default.BUFFER_LEVEL_UPDATED,L,n),t.on(l.default.MANIFEST_VALIDITY_CHANGED,k,n),n}h.__dashjs_factory_name="RepresentationController",t.default=c.default.getClassFactory(h),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(39)),o=r(n(63)),s=r(n(26)),u=n(32),l=r(n(14)),c=r(n(12)),d=r(n(29)),h=r(n(3)),f=r(n(13)),p=r(n(55)),m=r(n(160)),g=n(64),v=r(n(1085)),y=r(n(214)),_=r(n(1090));function b(e){e=e||{};var t,n=this.context,r=(0,c.default)(n).getInstance(),h=(0,p.default)(n).getInstance(),b=void 0,E=e.timelineConverter,T=e.dashMetrics,S=e.metricsModel,w=e.mediaPlayerModel,A=e.errHandler,x=e.baseURLController,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0;function L(){return D?D.getType():null}function N(){var e=D?D.getStreamInfo():null;return e?e.manifestInfo.isDynamic:null}function k(){return D?D.getMediaInfo():null}function F(){R=-1}function B(){F(),O=0,I=null,D=null,P=null}function U(e,t,n){var r=x.resolve(n.path),i=void 0,a=void 0;return r&&t!==r.url&&h.isRelative(t)?(i=r.url,a=r.serviceLocation,t&&(i=h.resolve(t,i))):i=t,!h.isRelative(i)&&(e.url=i,e.serviceLocation=a,!0)}function j(e){var t=!1,n=N();if(n||R!==e.availableSegmentsNumber){var r=(0,g.getSegmentByIndex)(R,e);if(r){var i=parseFloat((r.presentationStartTime-e.adaptation.period.start).toFixed(5)),o=e.adaptation.period.duration;C.debug(e.segmentInfoType+": "+i+" / "+o),t=(e.segmentInfoType!==a.default.SEGMENT_TIMELINE||!n)&&i>=o}else C.debug("isMediaFinished - no segment found")}else t=!0;return t}function G(e){P.getSegments(e,I,R,H)}function H(e,t){if(e.segments=t,t&&t.length>0&&N()){var n=t[t.length-1].presentationStartTime,r=S.getMetricsFor(i.default.STREAM);E.setExpectedLiveEdge(n),S.updateManifestUpdateInfo(T.getCurrentManifestUpdate(r),{presentationStartTime:n})}}function V(e){if(!e)throw new Error("no representation");e.segments=null,G(e)}function z(e,t,n){var r=t.segments,i=r?r.length:null,a=-1,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0;if(r&&i>0)for(n=null==n?w.getSegmentOverlapToleranceTime():n,c=0;c<i;c++)if(u=(s=r[c]).presentationStartTime,l=s.duration,e+(o=null==n?l/2:n)>=u&&e-o<u+l){a=s.availabilityIdx;break}return a}function W(e){if(null==e)return null;var t=new o.default,n=e.representation,r=n.adaptation.period.mpd.manifest.Period_asArray[n.adaptation.period.index].AdaptationSet_asArray[n.adaptation.index].Representation_asArray[n.index].bandwidth,i=e.media;return i=(0,g.replaceTokenForTemplate)(i,"Number",e.replacementNumber),i=(0,g.replaceTokenForTemplate)(i,"Time",e.replacementTime),i=(0,g.replaceTokenForTemplate)(i,"Bandwidth",r),i=(0,g.replaceIDForTemplate)(i,n.id),i=(0,g.unescapeDollarsInTemplate)(i),t.mediaType=L(),t.type=u.HTTPRequest.MEDIA_SEGMENT_TYPE,t.range=e.mediaRange,t.startTime=e.presentationStartTime,t.duration=e.duration,t.timescale=n.timescale,t.availabilityStartTime=e.availabilityStartTime,t.availabilityEndTime=e.availabilityEndTime,t.wallStartTime=e.wallStartTime,t.quality=n.index,t.index=e.availabilityIdx,t.mediaInfo=k(),t.adaptationIndex=n.adaptation.index,t.representationId=n.id,U(t,i,n)?t:void 0}function q(e){var t=e.representation;t.segments&&r.trigger(l.default.REPRESENTATION_UPDATED,{sender:this,representation:t})}function Y(e){if(!e.error&&L()===e.mediaType){var t,n=e.segments,i=e.representation,a=[],o=0,s=void 0,u=void 0,c=void 0;for(s=0,t=n.length;s<t;s++)u=n[s],c=(0,g.getTimeBasedSegment)(E,N(),i,u.startTime,u.duration,u.timescale,u.media,u.mediaRange,o),a.push(c),c=null,o++;i.segmentAvailabilityRange={start:a[0].presentationStartTime,end:a[t-1].presentationStartTime},i.availableSegmentsNumber=t,H(i,a),m.default.hasInitialization(i)&&r.trigger(l.default.REPRESENTATION_UPDATED,{sender:this,representation:i})}}return M={initialize:function(t){D=t,b.initialize(),P=(0,v.default)(n).create(e,N())},getStreamProcessor:function(){return D},getInitRequest:function(e){return e?function(e,t){var n=new o.default,r=e.adaptation.period,i=r.start,a=N();if(n.mediaType=t,n.type=u.HTTPRequest.INIT_SEGMENT_TYPE,n.range=e.range,n.availabilityStartTime=E.calcAvailabilityStartTimeFromPresentationTime(i,r.mpd,a),n.availabilityEndTime=E.calcAvailabilityEndTimeFromPresentationTime(i+r.duration,r.mpd,a),n.quality=e.index,n.mediaInfo=k(),n.representationId=e.id,U(n,e.initialization,e))return n}(e,L()):null},getSegmentRequestForTime:function(e,t,n){var r=void 0;if(!e)return null;var i=L(),s=R,u=!!n&&n.keepIdx,l=n?n.timeThreshold:null,c=!(!n||!n.ignoreIsFinished);return I!==t&&(I=t,C.debug("Getting the request for "+i+" time : "+t)),G(e),(R=z(t,e,l))<0&&(G(e),R=z(t,e,l)),R>=0&&C.debug("Index for "+i+" time "+t+" is "+R),!c&&j(e)?((r=new o.default).action=o.default.ACTION_COMPLETE,r.index=R,r.mediaType=i,r.mediaInfo=k(),C.debug("Signal complete in getSegmentRequestForTime -",i)):r=W((0,g.getSegmentByIndex)(R,e)),u&&s>=0&&(R=e.segmentInfoType===a.default.SEGMENT_TIMELINE&&N()?R:s),r},getNextSegmentRequest:function(e){var t=void 0,n=void 0;if(!e||-1===R)return null;var r=L(),i=N();return I=null,R++,C.debug("Getting the next request at index: "+R+", type: "+r),!(0,g.getSegmentByIndex)(R,e)&&i?(C.debug("No segment found at index: "+R+". Wait for next loop"),G(e),R--,null):(j(e)?((t=new o.default).action=o.default.ACTION_COMPLETE,t.index=R,t.mediaType=r,t.mediaInfo=k(),C.debug("Signal complete -",r)):(G(e),t=W(n=(0,g.getSegmentByIndex)(R,e)),!n&&i&&R--),t)},updateRepresentation:function(e,t){var n=m.default.hasInitialization(e),i=m.default.hasSegments(e),a=void 0;if(e.segmentDuration||e.segments||V(e),e.segmentAvailabilityRange=E.calcSegmentAvailabilityRange(e,N()),e.segmentAvailabilityRange.end<e.segmentAvailabilityRange.start&&!e.useCalculatedLiveEdgeTime)return a=new s.default(d.default.SEGMENTS_UNAVAILABLE_ERROR_CODE,d.default.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE,{availabilityDelay:e.segmentAvailabilityRange.start-e.segmentAvailabilityRange.end}),void r.trigger(l.default.REPRESENTATION_UPDATED,{sender:this,representation:e,error:a});t||F(),e.segmentDuration&&V(e),n||b.loadInitialization(e),i||b.loadSegments(e,L(),e.indexRange),n&&i&&r.trigger(l.default.REPRESENTATION_UPDATED,{sender:this,representation:e})},updateSegmentList:V,setCurrentTime:function(e){O=e},getCurrentTime:function(){return O},reset:function(){B(),r.off(l.default.INITIALIZATION_LOADED,q,M),r.off(l.default.SEGMENTS_LOADED,Y,M)},resetIndex:F},C=(0,f.default)(n).getInstance().getLogger(M),B(),t=e.mimeType,(b="webm"===t.split("/")[1].toLowerCase()?(0,_.default)(n).getInstance():(0,y.default)(n).getInstance()).setConfig({baseURLController:x,metricsModel:S,mediaPlayerModel:w,errHandler:A}),r.on(l.default.INITIALIZATION_LOADED,q,M),r.on(l.default.SEGMENTS_LOADED,Y,M),M}b.__dashjs_factory_name="DashHandler",t.default=h.default.getClassFactory(b),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(39)),a=r(n(3)),o=r(n(1086)),s=r(n(1087)),u=r(n(1088));function l(e,t){var n,r=this.context,a=void 0,l=void 0,c=void 0;return n={getSegments:function(e,t,n,r,o){var s=void 0,u=e.segmentInfoType;u!==i.default.SEGMENT_BASE&&u!==i.default.BASE_URL&&function(e,t){var n=e.segments,r=!1,i=void 0,a=void 0;n&&0!==n.length?(a=n[0].availabilityIdx,i=n[n.length-1].availabilityIdx,r=t<a||t>i):r=!0;return r}(e,n)?(u===i.default.SEGMENT_TIMELINE?s=a.getSegments(e,t,n,o):u===i.default.SEGMENT_TEMPLATE?s=l.getSegments(e,t,n,o):u===i.default.SEGMENT_LIST&&(s=c.getSegments(e,t,n,o)),r&&r(e,s)):s=e.segments}},a=(0,o.default)(r).create(e,t),l=(0,s.default)(r).create(e,t),c=(0,u.default)(r).create(e,t),n}l.__dashjs_factory_name="SegmentsGetter";var c=a.default.getClassFactory(l);t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(11)),o=n(64);function s(e,t){var n=(e=e||{}).timelineConverter;return{getSegments:function(e,r,i,s){if(function(){if(!n||!n.hasOwnProperty("calcMediaTimeFromPresentationTime")||!n.hasOwnProperty("calcSegmentAvailabilityRange"))throw new Error(a.default.MISSING_CONFIG_ERROR)}(),!e)throw new Error("no representation");void 0===r&&(r=null);var u=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,l=u.SegmentTimeline,c=u.SegmentURL_asArray,d=e.availableSegmentsNumber>0,h=void 0;h=s||(i>-1||null!==r?10:1/0);var f,p,m,g=0,v=0,y=-1,_=[],b=null,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=function(r,i){var a=u.media,s=r.mediaRange;return c&&(a=c[i].media||"",s=c[i].mediaRange),(0,o.getTimeBasedSegment)(n,t,e,g,r.d,C,a,s,y,r.tManifest)};for(C=e.timescale,f=l.S_asArray,m=i,null!==r&&(b=n.calcMediaTimeFromPresentationTime(r,e)),T=0,p=f.length;T<p;T++){if(w=0,(E=f[T]).hasOwnProperty("r")&&(w=E.r),E.hasOwnProperty("t")&&(v=(g=E.t)/C),w<0){if((x=f[T+1])&&x.hasOwnProperty("t"))A=x.t/C;else{var I=e.segmentAvailabilityRange?e.segmentAvailabilityRange.end:n.calcSegmentAvailabilityRange(e,t).end;A=n.calcMediaTimeFromPresentationTime(I,e),e.segmentDuration=E.d/C}w=Math.ceil((A-v)/(E.d/C))-1}if(M){if(d)break;y+=w+1}else for(S=0;S<=w;S++)if(y++,_.length>h){if(M=!0,d)break}else null!==b?v>=b-E.d/C*1.5&&_.push(R(E,y)):y>=m&&_.push(R(E,y)),v=(g+=E.d)/C}return d||(e.availableSegmentsNumber=y+1),_}}}s.__dashjs_factory_name="TimelineSegmentsGetter";var u=i.default.getClassFactory(s);t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r},o=n(64);function s(e,t){var n=e.timelineConverter;return{getSegments:function(e,r,i,a){var s,u,l,c=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate,d=e.segmentDuration,h=e.segmentAvailabilityRange,f=[],p=null,m=null,g=void 0,v=void 0;for(l=e.startNumber,s=(g=isNaN(d)&&!t?{start:l,end:l}:(0,o.decideSegmentListRangeForTemplate)(n,t,e,r,i,a)).start,u=g.end,v=s;v<=u;v++)(m=(0,o.getIndexBasedSegment)(n,t,e,v)).replacementTime=(l+v-1)*e.segmentDuration,p=c.media,p=(0,o.replaceTokenForTemplate)(p,"Number",m.replacementNumber),p=(0,o.replaceTokenForTemplate)(p,"Time",m.replacementTime),m.media=p,f.push(m),m=null;return isNaN(d)?e.availableSegmentsNumber=1:e.availableSegmentsNumber=Math.ceil((h.end-h.start)/d),f}}}s.__dashjs_factory_name="TemplateSegmentsGetter";var u=a.default.getClassFactory(s);t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r},o=n(64);function s(e,t){var n=(e=e||{}).timelineConverter;return{getSegments:function(e,r,i,a){var s,u,l,c,d=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,h=d.SegmentURL_asArray.length,f=[],p=void 0,m=void 0,g=void 0;for(c=e.startNumber,s=(0,o.decideSegmentListRangeForTemplate)(n,t,e,r,i,a),u=Math.max(s.start,0),l=Math.min(s.end,d.SegmentURL_asArray.length-1),p=u;p<=l;p++)g=d.SegmentURL_asArray[p],(m=(0,o.getIndexBasedSegment)(n,t,e,p)).replacementTime=(c+p-1)*e.segmentDuration,m.media=g.media?g.media:"",m.mediaRange=g.mediaRange,m.index=g.index,m.indexRange=g.indexRange,f.push(m),m=null;return e.availableSegmentsNumber=h,f}}}s.__dashjs_factory_name="ListSegmentsGetter";var u=a.default.getClassFactory(s);t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).requestModifier,n=e.boxParser;function r(e,t){e.reader.read().then(t).catch((function(t){e.onerror&&200===e.response.status&&e.onerror(t)}))}function i(e,t){if((e=e.filter((function(n){return n.bytes>t/4/e.length}))).length>1){var n=(r=0,i=(e[e.length-1].ts-e[0].ts)/e.length,e.forEach((function(t,n){var a=e[n+1];if(a){var o=a.ts-t.ts;r+=o<i?o:0}})),{v:r});if("object"==typeof n)return n.v}var r,i;return null}return{load:function(e){var a=new Date,o=e.request,s=new Headers;o.range&&s.append("Range","bytes="+o.range),o.requestStartDate||(o.requestStartDate=a),t&&t.modifyRequestHeader({setRequestHeader:function(e,t){s.append(e,t)}});var u=void 0;"function"==typeof window.AbortController&&(u=new AbortController,e.abortController=u);var l={method:e.method,headers:s,credentials:e.withCredentials?"include":void 0,signal:u?u.signal:void 0};fetch(e.url,l).then((function(t){e.response||(e.response={}),e.response.status=t.status,e.response.statusText=t.statusText,e.response.responseURL=t.url,t.ok||e.onerror();var a="",o=!0,s=!1,u=void 0;try{for(var l,c=t.headers.keys()[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var d=l.value;a+=d+": "+t.headers.get(d)+"\n"}}catch(e){s=!0,u=e}finally{try{!o&&c.return&&c.return()}finally{if(s)throw u}}if(e.response.responseHeaders=a,!t.body)return t.arrayBuffer().then((function(t){e.response.response=t;var n={loaded:t.byteLength,total:t.byteLength,stream:!1};e.progress(n),e.onload(),e.onend()}));var h=parseInt(t.headers.get("Content-Length"),10),f=0,p=!1,m=new Uint8Array,g=0;e.reader=t.body.getReader();var v=[];r(e,(function t(a){var o=a.value;if(a.done)return m&&(e.progress({loaded:f,total:isNaN(h)?f:h,lengthComputable:!0,time:i(v,f),stream:!0}),e.response.response=m.buffer),e.onload(),void e.onend();if(o&&o.length>0){m=function(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(m,o),f+=o.length,v.push({ts:Date.now(),bytes:o.length});var s=n.findLastTopIsoBoxCompleted(["moov","mdat"],m,g);if(s.found){var u=s.lastCompletedOffset+s.size,l=void 0;u===m.length?(l=m,m=new Uint8Array):(l=new Uint8Array(m.subarray(0,u)),m=m.subarray(u)),e.progress({data:l.buffer,lengthComputable:!1,noTrace:!0}),g=0}else g=s.lastCompletedOffset,p||(e.progress({lengthComputable:!1,noTrace:!0}),p=!0)}r(e,t)}))})).catch((function(t){e.onerror&&e.onerror(t)}))},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel()}catch(e){}},calculateDownloadedTime:i}}o.__dashjs_factory_name="FetchLoader";var s=a.default.getClassFactory(o);t.default=s,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(14)),a=r(n(12)),o=r(n(1091)),s=r(n(11)),u=r(n(3)),l=r(n(13)),c=r(n(116)),d=r(n(159)),h=n(32),f=r(n(63)),p=r(n(96)),m=r(n(26)),g=r(n(29));function v(){var e=this.context,t=(0,a.default)(e).getInstance(),n=void 0,r=void 0,u=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0;function S(t,n,i,a){var s,l,c=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0;for(h=[],p=0,l=(s=function(t){var n=[],r=void 0,i=void 0,a=(0,o.default)(e).create({data:t});for(a.consumeTagAndSize(u.Segment.Cues);a.moreData()&&a.consumeTagAndSize(u.Segment.Cues.CuePoint,!0);){for((r={}).CueTime=a.parseTag(u.Segment.Cues.CuePoint.CueTime),r.CueTracks=[];a.moreData()&&a.consumeTag(u.Segment.Cues.CuePoint.CueTrackPositions,!0);){var s=a.getMatroskaCodedNum(),l=a.getPos();if((i={}).Track=a.parseTag(u.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===i.Track)throw new Error("Cue track cannot be 0");i.ClusterPosition=a.parseTag(u.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),r.CueTracks.push(i),a.setPos(l+s)}if(0===r.CueTracks.length)throw new Error("Mandatory cuetrack not found");n.push(r)}if(0===n.length)throw new Error("mandatory cuepoint not found");return n}(t)).length;p<l;p+=1)f=new d.default,c=0,c=p<s.length-1?s[p+1].CueTime-s[p].CueTime:a-s[p].CueTime,f.duration=c,f.startTime=s[p].CueTime,f.timescale=1e3,m=s[p].CueTracks[0].ClusterPosition+n,g=p<s.length-1?s[p+1].CueTracks[0].ClusterPosition+n-1:i-1,f.mediaRange=m+"-"+g,h.push(f);return r.debug("Parsed cues: "+h.length+" cues."),h}function w(){if(!T||!T.hasOwnProperty("resolve"))throw new Error("setConfig function has to be called previously")}function A(e,n,r){e?t.trigger(i.default.SEGMENTS_LOADED,{segments:e,representation:n,mediaType:r}):t.trigger(i.default.SEGMENTS_LOADED,{segments:null,representation:n,mediaType:r,error:new m.default(g.default.SEGMENT_BASE_LOADER_ERROR_CODE,g.default.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function x(e){var t=new f.default;return t.type=e.init?h.HTTPRequest.INIT_SEGMENT_TYPE:h.HTTPRequest.MEDIA_SEGMENT_TYPE,t.url=e.url,t.range=e.range.start+"-"+e.range.end,t}return n={setConfig:function(e){if(!(e.baseURLController&&e.metricsModel&&e.mediaPlayerModel&&e.errHandler))throw new Error(s.default.MISSING_CONFIG_ERROR);T=e.baseURLController,_=e.metricsModel,b=e.mediaPlayerModel,v=e.errHandler},initialize:function(){y=(0,c.default)(e).getInstance(),E=(0,p.default)(e).create({errHandler:v,metricsModel:_,mediaPlayerModel:b,requestModifier:y})},loadInitialization:function(e,n){w();var a=null,o=T.resolve(e.path),s=o?o.url:void 0,u=e.range.split("-"),l=n||{range:{start:parseFloat(u[0]),end:parseFloat(u[1])},request:a,url:s,init:!0};r.info("Start loading initialization."),a=x(l),E.load({request:a,success:function(){t.trigger(i.default.INITIALIZATION_LOADED,{representation:e})},error:function(){t.trigger(i.default.INITIALIZATION_LOADED,{representation:e})}}),r.debug("Perform init load: "+l.url)},loadSegments:function(t,n,i,a){w();var s=null,l=T.resolve(t.path),c=l?l.url:void 0;a=a||A,s=x({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:s,url:c,init:!1}),r.debug("Parsing ebml header"),E.load({request:s,success:function(s){!function(t,n,i,a){var s,l=(0,o.default)(e).create({data:t}),c=void 0,d=void 0,h=i.split("-"),f=null,p={url:n,range:{start:parseFloat(h[0]),end:parseFloat(h[1])},request:f},m=void 0;for(r.debug("Parse EBML header: "+p.url),l.skipOverElement(u.EBML),l.consumeTag(u.Segment),m=l.getMatroskaCodedNum(),m+=l.getPos(),s=l.getPos();l.moreData()&&!l.consumeTagAndSize(u.Segment.Info,!0);)if(!(l.skipOverElement(u.Segment.SeekHead,!0)||l.skipOverElement(u.Segment.Tracks,!0)||l.skipOverElement(u.Segment.Cues,!0)||l.skipOverElement(u.Void,!0)))throw new Error("no valid top level element found");for(;void 0===c;){var g=l.getMatroskaCodedNum(!0),v=l.getMatroskaCodedNum();switch(g){case u.Segment.Info.Duration.tag:c=l[u.Segment.Info.Duration.parse](v);break;default:l.setPos(l.getPos()+v)}}f=x(p),E.load({request:f,success:function(e){d=S(e,s,m,c),a(d)},error:function(){r.error("Download Error: Cues "+p.url),a(null)}}),r.debug("Perform cues load: "+p.url+" bytes="+p.range.start+"-"+p.range.end)}(s,c,i,(function(e){a(e,t,n)}))},error:function(){a(null,t,n)}})},reset:function(){v=null,y=null}},r=(0,l.default)(e).getInstance().getLogger(n),u={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},n}v.__dashjs_factory_name="WebmSegmentBaseLoader",t.default=u.default.getSingletonFactory(v),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t=void 0,n=new DataView(e.data),r=0;function i(e,t){var i=!0,a=0;if(void 0===t&&(t=!1),e.tag>16777215?(n.getUint32(r)!==e.tag&&(i=!1),a=4):e.tag>65535?(256*n.getUint16(r)+n.getUint8(r+2)!==e.tag&&(i=!1),a=3):e.tag>255?(n.getUint16(r)!==e.tag&&(i=!1),a=2):(n.getUint8(r)!==e.tag&&(i=!1),a=1),!i&&e.required&&!t)throw new Error("required tag not found");return i&&(r+=a),i}function a(e){var t=1,i=128,a=-1,o=0,s=n.getUint8(r),u=0;for(u=0;u<8;u+=1){if((s&i)===i){o=void 0===e?s&~i:s,a=u;break}i>>=1}for(u=0;u<a;u+=1,t+=1)o=o<<8|255&n.getUint8(r+t);return r+=t,o}return t={getPos:function(){return r},setPos:function(e){r=e},consumeTag:i,consumeTagAndSize:function(e,t){var n=i(e,t);return n&&a(),n},parseTag:function(e){var n;return i(e),n=a(),t[e.parse](n)},skipOverElement:function(e,t){var n=i(e,t),o=void 0;return n&&(o=a(),r+=o),n},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t=void 0;switch(e){case 4:t=n.getFloat32(r),r+=4;break;case 8:t=n.getFloat64(r),r+=8}return t},getMatroskaUint:function(e){for(var t=0,i=0;i<e;i+=1)t<<=8,t|=255&n.getUint8(r+i);return r+=e,t},moreData:function(){return r<n.byteLength}}}o.__dashjs_factory_name="EBMLParser",t.default=a.default.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(13)),o=r(n(12)),s=r(n(14)),u=r(n(161));function l(){var e="urn:mpeg:dash:event:2012",t=this.context,n=(0,o.default)(t).getInstance(),r=void 0,i=void 0,l=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0;function y(){v=!1,l={},c={},d={},h=null,f=100,p=Date.now()/1e3}function _(){if(!m||!g)throw new Error("setConfig function has to be called previously")}function b(){null!==h&&v&&(clearInterval(h),h=null,v=!1)}function E(e){if(1==e.eventStream.value){var t=e.eventStream.timescale||1,r=e.presentationTime/t,a=void 0;a=4294967295==e.presentationTime?NaN:(e.presentationTime+e.duration)/t,i.info("Manifest validity changed: Valid until: "+r+"; remaining duration: "+a),n.trigger(s.default.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:r,newDuration:a,newManifestValidAfter:NaN})}}function T(){var e=g.getTime(),t=e-p;p=e,S(c,t,e),S(l,t,e),function(){if(d)for(var e=g.getTime(),t=Object.keys(d),n=0;n<t.length;n++){var r=t[n],a=d[r];null!==a&&(a.duration+a.presentationTime)/a.eventStream.timescale<e&&(i.debug("Remove Event "+r+" at time "+e),a=null,delete d[r])}}()}function S(r,a,o){var s,l;if(r)for(var c=Object.keys(r),h=0;h<c.length;h++){var f=c[h],p=r[f];void 0!==p&&(0===(s=p.presentationTime/p.eventStream.timescale)||s<=o&&s+a>o)&&(i.debug("Start Event "+f+" at "+o),p.duration>0&&(d[f]=p),p.eventStream.schemeIdUri==e&&1==p.eventStream.value?0===p.duration&&0===p.presentationTimeDelta||(_(),m.refreshManifest()):"urn:mpeg:dash:event:callback:2015"==p.eventStream.schemeIdUri&&1==p.eventStream.value?(l=p.messageData,(0,u.default)(t).create({}).load({method:"get",url:l,request:{responseType:"arraybuffer"}})):n.trigger(p.eventStream.schemeIdUri,{event:p}),delete r[f])}}return r={addInlineEvents:function(e){if(_(),l={},e)for(var t=0;t<e.length;t++){var n=e[t];l[n.id]=n,i.debug("Add inline event with id "+n.id)}i.debug("Added "+e.length+" inline events")},addInbandEvents:function(t){_();for(var n=0;n<t.length;n++){var r=t[n];r.id in c?i.debug("Repeated event with id "+r.id):(r.eventStream.schemeIdUri===e&&void 0===c[r.id]&&E(r),c[r.id]=r,i.debug("Add inband event with id "+r.id))}},stop:b,start:function(){_(),i.debug("Start Event Controller"),v||isNaN(f)||(v=!0,h=setInterval(T,f))},setConfig:function(e){e&&(e.manifestUpdater&&(m=e.manifestUpdater),e.playbackController&&(g=e.playbackController))},reset:function(){b(),y()}},i=(0,a.default)(t).getInstance().getLogger(r),y(),r}l.__dashjs_factory_name="EventController",t.default=i.default.getClassFactory(l),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=n(32),o=r(n(1094)),s=r(n(113)),u=r(n(1095)),l=r(n(116)),c=r(n(12)),d=r(n(14)),h=r(n(3)),f=r(n(13));function p(e){e=e||{};var t=this.context,n=(0,c.default)(t).getInstance(),r=e.errHandler,h=e.mediaPlayerModel,p=e.metricsModel,m=void 0,g=void 0,v=void 0;function y(e){return e&&e.type&&e.type===a.HTTPRequest.INIT_SEGMENT_TYPE}function _(){for(var e in v)v[e].reset();v={}}function b(e){if(v[e.request.mediaType]===e.sender){var t=e.request,r=e.response,a=y(t),s=t.mediaInfo.streamInfo;if(e.error&&(e.request.mediaType!==i.default.AUDIO&&e.request.mediaType!==i.default.VIDEO&&e.request.mediaType!==i.default.FRAGMENTED_TEXT||n.trigger(d.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation})),r&&s){var u=function(e,t,n,r){var i=new o.default;return i.streamId=n,i.mediaInfo=t.mediaInfo,i.segmentType=t.type,i.start=t.startTime,i.duration=t.duration,i.end=i.start+i.duration,i.bytes=e,i.index=t.index,i.quality=t.quality,i.representationId=t.representationId,i.endFragment=r,i}(r,t,s.id,e.type!==d.default.FRAGMENT_LOADING_PROGRESS);n.trigger(a?d.default.INIT_FRAGMENT_LOADED:d.default.MEDIA_FRAGMENT_LOADED,{chunk:u,fragmentModel:e.sender})}else g.warn("No "+t.mediaType+" bytes to push or stream is inactive.")}}return m={getModel:function(e){var n=v[e];return n||(n=(0,s.default)(t).create({metricsModel:p,fragmentLoader:(0,u.default)(t).create({metricsModel:p,mediaPlayerModel:h,errHandler:r,requestModifier:(0,l.default)(t).getInstance()})}),v[e]=n),n},isInitializationRequest:y,reset:function(){n.off(d.default.FRAGMENT_LOADING_COMPLETED,b,this),n.off(d.default.FRAGMENT_LOADING_PROGRESS,b,this),_()}},g=(0,f.default)(t).getInstance().getLogger(m),_(),n.on(d.default.FRAGMENT_LOADING_COMPLETED,b,m),n.on(d.default.FRAGMENT_LOADING_PROGRESS,b,m),m}p.__dashjs_factory_name="FragmentController",t.default=h.default.getClassFactory(p),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(96)),a=r(n(1096)),o=r(n(26)),s=r(n(12)),u=r(n(95)),l=r(n(14)),c=r(n(29)),d=r(n(3));function h(e){e=e||{};var t,n=this.context,r=(0,s.default)(n).getInstance(),d=void 0,h=void 0;return d={checkForExistence:function(e){var t=function(t){r.trigger(l.default.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var n=new a.default(e.url);h.load({request:n,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)},load:function(e){var t=function(t,n){r.trigger(l.default.LOADING_COMPLETED,{request:e,response:t||null,error:n||null,sender:d})};e?h.load({request:e,progress:function(t){r.trigger(l.default.LOADING_PROGRESS,{request:e,stream:t.stream}),t.data&&r.trigger(l.default.LOADING_DATA_PROGRESS,{request:e,response:t.data||null,error:null,sender:d})},success:function(e){t(e)},error:function(e,n,r){t(void 0,new o.default(c.default.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,r,n))},abort:function(e){e&&r.trigger(l.default.LOADING_ABANDONED,{request:e,mediaType:e.mediaType,sender:d})}}):t(void 0,new o.default(c.default.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,c.default.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){h&&h.abort()},reset:function(){h&&(h.abort(),h=null)}},t=(0,u.default)(n).getInstance(),h=(0,i.default)(n).create({errHandler:e.errHandler,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,boxParser:t,useFetch:e.mediaPlayerModel.getLowLatencyEnabled()}),d}h.__dashjs_factory_name="FragmentLoader",t.default=d.default.getClassFactory(h),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(63),a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.url=e||null,this.checkForExistenceOnly=!0}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default);t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(11)),o=r(n(1098)),s=r(n(215)),u=r(n(212)),l=n(64);function c(e){var t,n=this.context,r=void 0;function i(){r&&r.reset()}return t={get:function(e,t){var n=r.getCurrentTrack();if(!n||n.segmentDuration<=0||null==e)return null;var i=Math.floor(e/n.segmentDuration),a=e%n.segmentDuration,s=Math.floor(a*n.tilesHor*n.tilesVert/n.segmentDuration),u=new o.default;return u.width=Math.floor(n.widthPerTile),u.height=Math.floor(n.heightPerTile),u.x=Math.floor(s%n.tilesHor)*n.widthPerTile,u.y=Math.floor(s/n.tilesHor)*n.heightPerTile,"readThumbnail"in n?n.readThumbnail(e,(function(e){u.url=e,t&&t(u)})):(u.url=function(e,t){var n=t+e.startNumber,r=(0,l.replaceTokenForTemplate)(e.templateUrl,"Number",n);return r=(0,l.replaceTokenForTemplate)(r,"Time",(n-1)*e.segmentDuration),r=(0,l.replaceTokenForTemplate)(r,"Bandwidth",e.bandwidth),(0,l.unescapeDollarsInTemplate)(r)}(n,i),t&&t(u),u)},setTrackByIndex:function(e){r.setTrackByIndex(e)},getCurrentTrackIndex:function(){return r.getCurrentTrackIndex()},getBitrateList:function(){var e=r.getTracks(),t=0;return e.map((function(e){var n=new u.default;return n.mediaType=a.default.IMAGE,n.qualityIndex=t++,n.bitrate=e.bitrate,n.width=e.width,n.height=e.height,n}))},reset:i},i(),r=(0,s.default)(n).create({dashManifestModel:e.dashManifestModel,adapter:e.adapter,baseURLController:e.baseURLController,stream:e.stream,timelineConverter:e.timelineConverter}),t}c.__dashjs_factory_name="ThumbnailController",t.default=i.default.getClassFactory(c),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(12)),a=r(n(14)),o=r(n(3)),s=r(n(13)),u=r(n(29));function l(){var e=this.context,t=(0,i.default)(e).getInstance(),n=void 0,r=void 0,o=void 0,l=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0;function v(){o=NaN,d=!1,c=!0,y()}function y(){null!==l&&(clearInterval(l),l=null)}function _(e){y(),isNaN(e)&&!isNaN(o)&&(e=1e3*o),isNaN(e)||(r.debug("Refresh manifest in "+e+" milliseconds."),l=setTimeout(T,e))}function b(){d=!0;var e=f.getValue(),t=e.url,n=p.getLocation(e);n&&(t=n),h.load(t)}function E(e){f.setValue(e);var n=new Date,i=(n.getTime()-e.loadedTime.getTime())/1e3;1e3*(o=p.getManifestUpdatePeriod(e,i))>2147483647&&(o=2147483.647),t.trigger(a.default.MANIFEST_UPDATED,{manifest:e}),r.info("Manifest has been refreshed at "+n+"["+n.getTime()/1e3+"] "),c||_()}function T(){c&&!g.getScheduleWhilePaused()||(d?_(g.getManifestUpdateRetryInterval()):b())}function S(e){e.error?e.error.code===u.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&m.error(e.error):E(e.manifest)}function w(){c=!1,_()}function A(){c=!0,y()}function x(){d=!1}return n={initialize:function(){v(),t.on(a.default.STREAMS_COMPOSED,x,this),t.on(a.default.PLAYBACK_STARTED,w,this),t.on(a.default.PLAYBACK_PAUSED,A,this),t.on(a.default.INTERNAL_MANIFEST_LOADED,S,this)},setManifest:function(e){E(e)},refreshManifest:b,setConfig:function(e){e&&(e.manifestModel&&(f=e.manifestModel),e.dashManifestModel&&(p=e.dashManifestModel),e.mediaPlayerModel&&(g=e.mediaPlayerModel),e.manifestLoader&&(h=e.manifestLoader),e.errHandler&&(m=e.errHandler))},reset:function(){t.off(a.default.PLAYBACK_STARTED,w,this),t.off(a.default.PLAYBACK_PAUSED,A,this),t.off(a.default.STREAMS_COMPOSED,x,this),t.off(a.default.INTERNAL_MANIFEST_LOADED,S,this),v()}},r=(0,s.default)(e).getInstance().getLogger(n),n}l.__dashjs_factory_name="ManifestUpdater",t.default=o.default.getClassFactory(l),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(26)),o=n(32),s=r(n(12)),u=r(n(14)),l=r(n(29)),c=r(n(3)),d=r(n(13)),h=r(n(55));function f(){var e=this.context,t=(0,s.default)(e).getInstance(),n=(0,h.default)(e).getInstance(),r=void 0,c=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0;function b(e){p=e}function E(e){f=e}function T(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t=void 0,n=void 0,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&(parseInt(r[6],10)||0),r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]&&(n=60*parseInt(r[9],10)+parseInt(r[10],10),t+=("+"===r[8]?-1:1)*n*60*1e3),new Date(t).getTime()}(e)),t}function S(e){return Date.parse(e)}function w(e){return Date.parse(e)}function A(e,t,n){n()}function x(e,t,n){var r=T(e);isNaN(r)?n():t(r)}function M(e,t,r,i,a){var s,u,l=!1,c=new XMLHttpRequest,d=a?o.HTTPRequest.HEAD:o.HTTPRequest.GET,h=t.match(/\S+/g);if(t=h.shift(),s=function(){l||(l=!0,h.length?M(e,h.join(" "),r,i,a):i())},u=function(){var t=void 0,n=void 0;200===c.status&&(t=a?c.getResponseHeader("Date"):c.response,n=e(t),isNaN(n)||(r(n),l=!0))},n.isRelative(t)){var f=_.resolve();f&&(t=n.resolve(t,f.url))}c.open(d,t),c.timeout=5e3,c.onload=u,c.onloadend=s,c.send()}function C(e,t,n){M(w,e,t,n,!0)}function R(e,n,r){b(!1),t.trigger(u.default.TIME_SYNCHRONIZATION_COMPLETED,{time:n,offset:r,error:e?new a.default(l.default.TIME_SYNC_FAILED_ERROR_CODE,l.default.TIME_SYNC_FAILED_ERROR_MESSAGE):null})}return r={initialize:function(e,t){m=t,f=0,p=!1,g={"urn:mpeg:dash:utc:http-head:2014":C,"urn:mpeg:dash:utc:http-xsdate:2014":M.bind(null,T),"urn:mpeg:dash:utc:http-iso:2014":M.bind(null,S),"urn:mpeg:dash:utc:direct:2014":x,"urn:mpeg:dash:utc:http-head:2012":C,"urn:mpeg:dash:utc:http-xsdate:2012":M.bind(null,T),"urn:mpeg:dash:utc:http-iso:2012":M.bind(null,S),"urn:mpeg:dash:utc:direct:2012":x,"urn:mpeg:dash:utc:http-ntp:2014":A,"urn:mpeg:dash:utc:ntp:2014":A,"urn:mpeg:dash:utc:sntp:2014":A},p||function e(t,n){var r=n||0,a=t[r],o=function(e,t){var n,r,a,o=!e||!t;o&&m?(n=v.getReadOnlyMetricsFor(i.default.STREAM),r=y.getLatestMPDRequestHeaderValueByID(n,"Date"),a=null!==r?new Date(r).getTime():Number.NaN,isNaN(a)?R(!0):(E(a-(new Date).getTime()),R(!1,a/1e3,f))):R(o,e,t)};b(!0),a?g.hasOwnProperty(a.schemeIdUri)?g[a.schemeIdUri](a.value,(function(e){var t=(new Date).getTime(),n=function(e,t){return e-t}(e,t);E(n),c.info("Local time: "+new Date(t)),c.info("Server time: "+new Date(e)),c.info("Server Time - Local Time (ms): "+n),o(e,n)}),(function(){e(t,r+1)})):e(t,r+1):(E(0),o())}(e)},getOffsetToDeviceTimeMs:function(){return f},setConfig:function(e){e&&(e.metricsModel&&(v=e.metricsModel),e.dashMetrics&&(y=e.dashMetrics),e.baseURLController&&(_=e.baseURLController))},reset:function(){b(!1)}},c=(0,d.default)(e).getInstance().getLogger(r),r}f.__dashjs_factory_name="TimeSyncController";var p=c.default.getSingletonFactory(f);p.HTTP_TIMEOUT_MS=5e3,c.default.updateSingletonFactory(f.__dashjs_factory_name,p),t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(218)),a=r(n(3)),o=NaN,s=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={baseUrls:t||null,selectedIdx:n||o},this.children=[]};function u(){var e,t=void 0,n=void 0,r=this.context,a=(0,i.default)(r).getInstance();function u(e,t,r){var i=n.getBaseURLsFromElement(r);e[t]?a.areEqual(i,e[t].data.baseUrls)||(e[t].data.baseUrls=i,e[t].data.selectedIdx=o):e[t]=new s(i)}function l(e){!function(){if(!n||!n.hasOwnProperty("getBaseURLsFromElement")||!n.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var r=n.getBaseURLsFromElement(e);a.areEqual(r,t.data.baseUrls)||(t.data.baseUrls=r,t.data.selectedIdx=o),e&&e.Period_asArray&&e.Period_asArray.forEach((function(e,r){u(t.children,r,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach((function(e,i){u(t.children[r].children,i,e),e.Representation_asArray&&e.Representation_asArray.sort(n.getRepresentationSortFunction()).forEach((function(e,n){u(t.children[r].children[i].children,n,e)}))}))}))}function c(){t=new s}return e={reset:c,update:function(e){l(e)},getForPath:function(e){var n=t,r=[n.data];return e&&e.forEach((function(e){(n=n.children[e])&&r.push(n.data)})),r.filter((function(e){return e.baseUrls.length}))},invalidateSelectedIndexes:function(e){!function e(n,r){var i=r||t;n(i.data),i.children&&i.children.forEach((function(t){return e(n,t)}))}((function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=o)}))},setConfig:function(e){e.dashManifestModel&&(n=e.dashManifestModel)}},c(),e}u.__dashjs_factory_name="BaseURLTreeModel",t.default=a.default.getClassFactory(u),e.exports=t.default},function(e,t,n){"use strict";var r=Array.isArray,i=Object.keys,a=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var o,s,u,l=r(t),c=r(n);if(l&&c){if((s=t.length)!=n.length)return!1;for(o=s;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(l!=c)return!1;var d=t instanceof Date,h=n instanceof Date;if(d!=h)return!1;if(d&&h)return t.getTime()==n.getTime();var f=t instanceof RegExp,p=n instanceof RegExp;if(f!=p)return!1;if(f&&p)return t.toString()==n.toString();var m=i(t);if((s=m.length)!==i(n).length)return!1;for(o=s;0!=o--;)if(!a.call(n,m[o]))return!1;for(o=s;0!=o--;)if(!e(t[u=m[o]],n[u]))return!1;return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(29)),a=r(n(12)),o=r(n(14)),s=r(n(1105)),u=r(n(1106)),l=r(n(1107)),c=r(n(3)),d=r(n(26)),h=r(n(11));function f(){var e,t=this.context,n=(0,a.default)(t).getInstance(),r=void 0,c=void 0,f=void 0,p=void 0,m=void 0;function g(){c.reset()}return e={chooseSelectorFromManifest:function(e){!function(){if(!r||!r.hasOwnProperty("getIsDVB"))throw new Error(h.default.MISSING_CONFIG_ERROR)}(),m=r.getIsDVB(e)?p:f},select:function(e){if(e){var t=e.baseUrls,r=e.selectedIdx;if(!isNaN(r))return t[r];var a=m.select(t);return a?(e.selectedIdx=t.indexOf(a),a):(n.trigger(o.default.URL_RESOLUTION_FAILED,{error:new d.default(i.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,i.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(m===f&&g()))}},reset:g,setConfig:function(e){e.selector&&(m=e.selector),e.dashManifestModel&&(r=e.dashManifestModel)}},c=(0,s.default)(t).create({updateEventName:o.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:o.default.SERVICE_LOCATION_BLACKLIST_ADD}),f=(0,l.default)(t).create({blacklistController:c}),p=(0,u.default)(t).create({blacklistController:c}),m=f,e}f.__dashjs_factory_name="BaseURLSelector",t.default=c.default.getClassFactory(f),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(12));function o(e){e=e||{};var t=[],n=(0,a.default)(this.context).getInstance(),r=e.updateEventName,i=e.addBlacklistEventName;function o(e){-1===t.indexOf(e)&&(t.push(e),n.trigger(r,{entry:e}))}function s(e){o(e.entry)}return function(){i&&n.on(i,s,this)}(),{add:o,contains:function(e){return!!(t.length&&e&&e.length)&&-1!==t.indexOf(e)},reset:function(){t=[]}}}o.__dashjs_factory_name="BlackListController",t.default=i.default.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).blacklistController;return{select:function(e){return e&&function(e){var t=0,n=[],r=0,i=void 0,a=void 0;if((a=e.sort((function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n})).filter((function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority}))).length)return a.length>1&&(a.forEach((function(e){t+=e.dvb_weight,n.push(t)})),i=Math.floor(Math.random()*(t-1)),n.every((function(e,t){return r=t,!(i<e)}))),a[r]}((n=[],e.filter((function(e){return!t.contains(e.serviceLocation)||(e.dvb_priority&&n.push(e.dvb_priority),!1)})).filter((function(e){return!n.length||!e.dvb_priority||-1===n.indexOf(e.dvb_priority)}))));var n}}}o.__dashjs_factory_name="DVBSelector",t.default=a.default.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).blacklistController;return{select:function(e){var n=0,r=void 0;return e&&e.some((function(e,r){return n=r,!t.contains(e.serviceLocation)}))&&(r=e[n]),r}}}o.__dashjs_factory_name="BasicSelector",t.default=a.default.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(13));function o(){var e=void 0,t=void 0,n=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?new MediaSource:e?new WebKitMediaSource:null},attachMediaSource:function(e,t){var n=window.URL.createObjectURL(e);return t.setSource(n),n},detachMediaSource:function(e){e.setSource(null)},setDuration:function(e,t){return e.duration!=t&&(e.duration=t),e.duration},setSeekable:function(e,t,n){e&&"function"==typeof e.setLiveSeekableRange&&"function"==typeof e.clearLiveSeekableRange&&"open"===e.readyState&&t>=0&&t<n&&(e.clearLiveSeekableRange(),e.setLiveSeekableRange(t,n))},signalEndOfStream:function(e){var n=e.sourceBuffers,r=n.length;if("open"===e.readyState){for(var i=0;i<r;i++){if(n[i].updating)return;if(0===n[i].buffered.length)return}t.info("call to mediaSource endOfStream"),e.endOfStream()}}},t=(0,a.default)(n).getInstance().getLogger(e),e}o.__dashjs_factory_name="MediaSourceController",t.default=i.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(1110)),o=r(n(96)),s=r(n(55)),u=r(n(220)),l=r(n(26)),c=n(32),d=r(n(12)),h=r(n(14)),f=r(n(29)),p=r(n(3)),m=r(n(1112)),g=r(n(13));function v(e){e=e||{};var t=this.context,n=(0,d.default)(t).getInstance(),r=(0,s.default)(t).getInstance(),p=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=e.mssHandler,T=e.errHandler;function S(e){n.trigger(h.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}return p={load:function(e){var a=new u.default(e,c.HTTPRequest.MPD_TYPE);y.load({request:a,success:function(a,o,s){if(_){var u=void 0,c=void 0,d=void 0;if(s&&s!==e?(c=r.parseBaseUrl(s),u=s):(r.isRelative(e)&&(e=r.resolve(e,window.location.href)),c=r.parseBaseUrl(e)),null===b&&(b=function(e){var n=null;return e.indexOf("SmoothStreamingMedia")>-1?(E&&(n=E.createMssParser(),E.registerEvents()),n):e.indexOf("MPD")>-1?(0,m.default)(t).create():n}(a)),null!==b){_.setMatchers(b.getMatchers()),_.setIron(b.getIron());try{d=b.parse(a)}catch(t){return void n.trigger(h.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}d?(d.url=u||e,d.originalUrl||(d.originalUrl=d.url),d.hasOwnProperty(i.default.LOCATION)&&(c=r.parseBaseUrl(d.Location_asArray[0]),v.debug("BaseURI set by Location to: "+c)),d.baseUri=c,d.loadedTime=new Date,_.resolveManifestOnLoad(d)):n.trigger(h.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}else n.trigger(h.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+""+e)})}},error:function(t,r,i){n.trigger(h.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new l.default(f.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,f.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+(e+", ")+i)})}})},reset:function(){n.off(h.default.XLINK_READY,S,p),_&&(_.reset(),_=null),y&&(y.abort(),y=null),E&&E.reset()}},v=(0,g.default)(t).getInstance().getLogger(p),n.on(h.default.XLINK_READY,S,p),y=(0,o.default)(t).create({errHandler:T,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier}),_=(0,a.default)(t).create({errHandler:T,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier}),b=null,p}v.__dashjs_factory_name="ManifestLoader";var y=p.default.getClassFactory(v);t.default=y,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1111)),a=r(n(12)),o=r(n(14)),s=r(n(3)),u=r(n(221)),l=r(n(55)),c=r(n(39)),d="onLoad";function h(e){e=e||{};var t=this.context,n=(0,a.default)(t).getInstance(),r=(0,l.default)(t).getInstance(),s=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0;function v(e,t,n){var i={},a=void 0,o=void 0;i.elements=e,i.type=t,i.resolveType=n,0===i.elements.length&&_(i);for(var s=0;s<i.elements.length;s++)a=i.elements[s],o=r.isHTTPURL(a.url)?a.url:a.originalContent.BaseURL+a.url,g.load(o,a,i)}function y(e){var t,n=void 0,r="";if(n=e.element,t=e.resolveObject,n.resolvedContent){var i=0;0===n.resolvedContent.indexOf("<?xml")&&(i=n.resolvedContent.indexOf("?>")+2),r=n.resolvedContent.substr(0,i)+"<response>"+n.resolvedContent.substr(i)+"</response>",n.resolvedContent=m.xml_str2json(r)}(function(e){var t=void 0;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0})(t)&&_(t)}function _(e){var t=[],r=void 0,i=void 0;if(function(e){var t=[],n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;for(a=e.elements.length-1;a>=0;a--){if(r=(n=e.elements[a]).type+"_asArray",n.resolvedContent){if(n.resolvedContent)for(o=0;o<n.resolvedContent[r].length;o++)i=n.resolvedContent[r][o],t.push(i)}else delete n.originalContent["xlink:actuate"],delete n.originalContent["xlink:href"],t.push(n.originalContent);for(n.parentElement[r].splice(n.index,1),s=0;s<t.length;s++)n.parentElement[r].splice(n.index+s,0,t[s]);t=[]}e.elements.length>0&&f.run(p)}(e),"onActuate"===e.resolveType&&n.trigger(o.default.XLINK_READY,{manifest:p}),e.resolveType===d)switch(e.type){case c.default.PERIOD:for(r=0;r<p[c.default.PERIOD+"_asArray"].length;r++)(i=p[c.default.PERIOD+"_asArray"][r]).hasOwnProperty(c.default.ADAPTATION_SET+"_asArray")&&(t=t.concat(b(i[c.default.ADAPTATION_SET+"_asArray"],i,c.default.ADAPTATION_SET,d))),i.hasOwnProperty(c.default.EVENT_STREAM+"_asArray")&&(t=t.concat(b(i[c.default.EVENT_STREAM+"_asArray"],i,c.default.EVENT_STREAM,d)));v(t,c.default.ADAPTATION_SET,d);break;case c.default.ADAPTATION_SET:n.trigger(o.default.XLINK_READY,{manifest:p})}}function b(e,t,n,r){var i=[],a=void 0,o=void 0,s=void 0;for(o=e.length-1;o>=0;o--)(a=e[o]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===a["xlink:href"]&&e.splice(o,1);for(o=0;o<e.length;o++)(a=e[o]).hasOwnProperty("xlink:href")&&a.hasOwnProperty("xlink:actuate")&&a["xlink:actuate"]===r&&(s=E(a["xlink:href"],t,n,o,r,a),i.push(s));return i}function E(e,t,n,r,i,a){return{url:e,parentElement:t,type:n,index:r,resolveType:i,originalContent:a,resolvedContent:null,resolved:!1}}return s={resolveManifestOnLoad:function(e){m=new u.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:h}),v(b((p=e).Period_asArray,p,c.default.PERIOD,d),c.default.PERIOD,d)},setMatchers:function(e){e&&(h=e)},setIron:function(e){e&&(f=e)},reset:function(){n.off(o.default.XLINK_ELEMENT_LOADED,y,s),g&&(g.reset(),g=null)}},n.on(o.default.XLINK_ELEMENT_LOADED,y,s),g=(0,i.default)(t).create({errHandler:e.errHandler,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier}),s}h.__dashjs_factory_name="XlinkController",t.default=s.default.getClassFactory(h),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(26)),a=r(n(96)),o=n(32),s=r(n(220)),u=r(n(12)),l=r(n(14)),c=r(n(3)),d=r(n(29));function h(e){e=e||{};var t=this.context,n=(0,u.default)(t).getInstance(),r=(0,a.default)(t).create({errHandler:e.errHandler,metricsModel:e.metricsModel,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier});return{load:function(e,t,a){var u=function(r,o){t.resolved=!0,t.resolvedContent=r||null,n.trigger(l.default.XLINK_ELEMENT_LOADED,{element:t,resolveObject:a,error:r||o?null:new i.default(d.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,d.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)})};if("urn:mpeg:dash:resolve-to-zero:2013"===e)u(null,!0);else{var c=new s.default(e,o.HTTPRequest.XLINK_EXPANSION_TYPE);r.load({request:c,success:function(e){u(e)},error:function(){u(null)}})}},reset:function(){r&&(r.abort(),r=null)}}}h.__dashjs_factory_name="XlinkLoader",t.default=c.default.getClassFactory(h),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(13)),o=r(n(1113)),s=r(n(221)),u=r(n(1114)),l=r(n(1115)),c=r(n(1116)),d=r(n(1117)),h=r(n(1118)),f=r(n(1120));function p(){var e=this.context,t=void 0,n=void 0,r=void 0,i=void 0,p=void 0;return t={parse:function(e){var t,r=window.performance.now();if(!(t=i.xml_str2json(e)))throw new Error("parsing the manifest failed");var a=window.performance.now();p.run(t);var o=window.performance.now();return n.info("Parsing complete: ( xml2json: "+(a-r).toPrecision(3)+"ms, objectiron: "+(o-a).toPrecision(3)+"ms, total: "+((o-r)/1e3).toPrecision(3)+"s)"),t},getMatchers:function(){return r},getIron:function(){return p}},n=(0,a.default)(e).getInstance().getLogger(t),r=[new l.default,new c.default,new d.default,new u.default],i=new s.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:r}),p=(0,o.default)(e).create({adaptationset:new h.default,period:new f.default}),t}p.__dashjs_factory_name="DashParser",t.default=i.default.getClassFactory(p),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(e){function t(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function n(e,n,r){for(var i=0,a=e.length;i<a;++i){var o=e[i];if(n[o.name])if(r[o.name]){if(o.merge){var s=n[o.name],u=r[o.name];"object"==typeof s&&"object"==typeof u?t(s,u):r[o.name]=s+u}}else r[o.name]=n[o.name]}}function r(e,t){for(var i=0,a=e.children.length;i<a;++i){var o=e.children[i],s=t[o.name+"_asArray"];if(s)for(var u=0,l=s.length;u<l;++u){var c=s[u];n(e.properties,t,c),r(o,c)}}}return{run:function(t){if(null===t||"object"!=typeof t)return t;if("period"in e)for(var n=e.period,i=t.Period_asArray,a=0,o=i.length;a<o;++a){var s=i[a];if(r(n,s),"adaptationset"in e){var u=s.AdaptationSet_asArray;if(u)for(var l=e.adaptationset,c=0,d=u.length;c<d;++c)r(l,u[c])}}return t}}}o.__dashjs_factory_name="ObjectIron";var s=a.default.getClassFactory(o);t.default=s,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=r(n(117)),o=r(n(39)),s=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,(function(e,t){var n,r=(i(n={},o.default.MPD,[o.default.ID,o.default.PROFILES]),i(n,o.default.PERIOD,[o.default.ID]),i(n,o.default.BASE_URL,[o.default.SERVICE_LOCATION,o.default.BYTE_RANGE]),i(n,o.default.SEGMENT_BASE,[o.default.INDEX_RANGE]),i(n,o.default.INITIALIZATION,[o.default.RANGE]),i(n,o.default.REPRESENTATION_INDEX,[o.default.RANGE]),i(n,o.default.SEGMENT_LIST,[o.default.INDEX_RANGE]),i(n,o.default.BITSTREAM_SWITCHING,[o.default.RANGE]),i(n,o.default.SEGMENT_URL,[o.default.MEDIA_RANGE,o.default.INDEX_RANGE]),i(n,o.default.SEGMENT_TEMPLATE,[o.default.INDEX_RANGE,o.default.MEDIA,o.default.INDEX,o.default.INITIALIZATION_MINUS,o.default.BITSTREAM_SWITCHING_MINUS]),i(n,o.default.ASSET_IDENTIFIER,[o.default.VALUE,o.default.ID]),i(n,o.default.EVENT_STREAM,[o.default.VALUE]),i(n,o.default.ADAPTATION_SET,[o.default.PROFILES,o.default.MIME_TYPE,o.default.SEGMENT_PROFILES,o.default.CODECS,o.default.CONTENT_TYPE]),i(n,o.default.FRAME_PACKING,[o.default.VALUE,o.default.ID]),i(n,o.default.AUDIO_CHANNEL_CONFIGURATION,[o.default.VALUE,o.default.ID]),i(n,o.default.CONTENT_PROTECTION,[o.default.VALUE,o.default.ID]),i(n,o.default.ESSENTIAL_PROPERTY,[o.default.VALUE,o.default.ID]),i(n,o.default.SUPPLEMENTAL_PROPERTY,[o.default.VALUE,o.default.ID]),i(n,o.default.INBAND_EVENT_STREAM,[o.default.VALUE,o.default.ID]),i(n,o.default.ACCESSIBILITY,[o.default.VALUE,o.default.ID]),i(n,o.default.ROLE,[o.default.VALUE,o.default.ID]),i(n,o.default.RATING,[o.default.VALUE,o.default.ID]),i(n,o.default.VIEWPOINT,[o.default.VALUE,o.default.ID]),i(n,o.default.CONTENT_COMPONENT,[o.default.CONTENT_TYPE]),i(n,o.default.REPRESENTATION,[o.default.ID,o.default.DEPENDENCY_ID,o.default.MEDIA_STREAM_STRUCTURE_ID]),i(n,o.default.SUBSET,[o.default.ID]),i(n,o.default.METRICS,[o.default.METRICS_MINUS]),i(n,o.default.REPORTING,[o.default.VALUE,o.default.ID]),n);if(r.hasOwnProperty(t)){var a=r[t];return void 0!==a&&a.indexOf(e.name)>=0}return!1}),(function(e){return String(e)}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(a.default);t.default=s,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return e&&e.__esModule?e:{default:e}}var i=r(n(117)),a=r(n(11)),o=r(n(39)),s=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,u=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,(function(e){for(var t=[o.default.MIN_BUFFER_TIME,o.default.MEDIA_PRESENTATION_DURATION,o.default.MINIMUM_UPDATE_PERIOD,o.default.TIMESHIFT_BUFFER_DEPTH,o.default.MAX_SEGMENT_DURATION,o.default.MAX_SUBSEGMENT_DURATION,a.default.SUGGESTED_PRESENTATION_DELAY,o.default.START,a.default.START_TIME,o.default.DURATION],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return s.test(e.value);return!1}),(function(e){var t=s.exec(e),n=31536e3*parseFloat(t[2]||0)+2592e3*parseFloat(t[4]||0)+86400*parseFloat(t[6]||0)+3600*parseFloat(t[8]||0)+60*parseFloat(t[10]||0)+parseFloat(t[12]||0);return void 0!==t[1]&&(n=-n),n}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(117),a=(r=i)&&r.__esModule?r:{default:r},o=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,s=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,(function(e){return o.test(e.value)}),(function(e){var t=o.exec(e),n=void 0;if(n=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&1e3*parseFloat(t[7])||0),t[9]&&t[10]){var r=60*parseInt(t[9],10)+parseInt(t[10],10);n+=("+"===t[8]?-1:1)*r*60*1e3}return new Date(n)}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(a.default);t.default=s,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(117),a=(r=i)&&r.__esModule?r:{default:r},o=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,s=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,(function(e){return o.test(e.value)}),(function(e){return parseFloat(e)}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(a.default);t.default=s,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return e&&e.__esModule?e:{default:e}}var i=r(n(222)),a=r(n(39)),o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[a.default.PROFILES,a.default.WIDTH,a.default.HEIGHT,a.default.SAR,a.default.FRAMERATE,a.default.AUDIO_SAMPLING_RATE,a.default.MIME_TYPE,a.default.SEGMENT_PROFILES,a.default.CODECS,a.default.MAXIMUM_SAP_PERIOD,a.default.START_WITH_SAP,a.default.MAX_PLAYOUT_RATE,a.default.CODING_DEPENDENCY,a.default.SCAN_TYPE,a.default.FRAME_PACKING,a.default.AUDIO_CHANNEL_CONFIGURATION,a.default.CONTENT_PROTECTION,a.default.ESSENTIAL_PROPERTY,a.default.SUPPLEMENTAL_PROPERTY,a.default.INBAND_EVENT_STREAM];(function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}})(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,a.default.ADAPTATION_SET,e,[new i.default(a.default.REPRESENTATION,e,[new i.default(a.default.SUB_REPRESENTATION,e)])])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=o,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n;this._name=t,this._merge=(n=t)&&n.length&&n.charAt(0)===n.charAt(0).toUpperCase()}return r(e,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return e&&e.__esModule?e:{default:e}}var i=r(n(222)),a=r(n(39)),o=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=[a.default.SEGMENT_BASE,a.default.SEGMENT_TEMPLATE,a.default.SEGMENT_LIST];(function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}})(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,a.default.PERIOD,e,[new i.default(a.default.ADAPTATION_SET,e,[new i.default(a.default.REPRESENTATION,e)])])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=o,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(12)),a=r(n(14)),o=r(n(3));function s(){var e=this.context,t=(0,i.default)(e).getInstance();return{capabilityError:function(e){t.trigger(a.default.ERROR,{error:"capability",event:e})},downloadError:function(e,n,r){t.trigger(a.default.ERROR,{error:"download",event:{id:e,url:n,request:r}})},manifestError:function(e,n,r,i){t.trigger(a.default.ERROR,{error:"manifestError",event:{message:e,id:n,manifest:r,event:i}})},timedTextError:function(e,n,r){t.trigger(a.default.ERROR,{error:"cc",event:{message:e,id:n,cc:r}})},mediaSourceError:function(e){t.trigger(a.default.ERROR,{error:"mediasource",event:e})},mediaKeySessionError:function(e){t.trigger(a.default.ERROR,{error:"key_session",event:e})},mediaKeyMessageError:function(e){t.trigger(a.default.ERROR,{error:"key_message",event:e})},error:function(e){t.trigger(a.default.ERROR,{error:e})}}}s.__dashjs_factory_name="ErrorHandler",t.default=o.default.getSingletonFactory(s),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(3),a=(r=i)&&r.__esModule?r:{default:r};function o(){var e,t=void 0;return e={supportsMediaSource:function(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t},supportsEncryptedMedia:function(){return t},supportsCodec:function(e){return!(!("MediaSource"in window)||!MediaSource.isTypeSupported(e))||!(!("WebKitMediaSource"in window)||!WebKitMediaSource.isTypeSupported(e))},setEncryptedMediaSupported:function(e){t=e}},t=!1,e}o.__dashjs_factory_name="Capabilities",t.default=a.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1124)),a=r(n(3));function o(){var e=void 0;return{initialize:function(t){if(e=new i.default,!t)return null;var n=t.indexOf("#");if(-1!==n)for(var r=t.substr(n+1).split("&"),a=0,o=r.length;a<o;++a){var s=r[a],u=s.indexOf("=");if(-1!==u){var l=s.substring(0,u);e.hasOwnProperty(l)&&(e[l]=s.substr(u+1))}}},getURIFragmentData:function(){return e}}}o.__dashjs_factory_name="URIFragmentModel",t.default=a.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(12)),a=r(n(14)),o=r(n(3));function s(){var e=this.context,t=(0,i.default)(e).getInstance(),n=void 0;return{getValue:function(){return n},setValue:function(e){n=e,e&&t.trigger(a.default.MANIFEST_LOADED,{data:e})}}}s.__dashjs_factory_name="ManifestModel",t.default=o.default.getSingletonFactory(s),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(223)),o=r(n(3)),s=n(32),u=r(n(11)),l=r(n(211)),c=n(76),d=1e3;function h(){var e,t,n,r=void 0,o=void 0,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0,S=void 0,w=void 0,A=void 0,x=void 0,M=void 0,C=void 0,R=void 0,I=void 0,O=void 0,D=void 0,P=void 0,L=void 0,N=void 0,k=void 0,F=void 0,B=void 0,U=void 0,j=void 0,G=void 0,H=void 0,V=void 0,z=void 0,W=void 0,q={scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"http://time.akamai.com/?iso&ms"};function Y(e){var t=void 0;for(t=0;t<N.length;t++)if(N[t].rulename===e)return t;return-1}function K(){return j?p||3:p}function X(e,t){Q(e,t);var n=new a.default;n.schemeIdUri=e,n.value=t,h.push(n)}function Q(e,t){(0,c.checkParameterType)(e,"string"),(0,c.checkParameterType)(t,"string"),h.forEach((function(n,r){n.schemeIdUri===e&&n.value===t&&h.splice(r,1)}))}function Z(){return j}return e={setABRStrategy:function(e){if(e!==u.default.ABR_STRATEGY_DYNAMIC&&e!==u.default.ABR_STRATEGY_BOLA&&e!==u.default.ABR_STRATEGY_THROUGHPUT)throw u.default.BAD_ARGUMENT_ERROR;O=e},getABRStrategy:function(){return O},setUseDefaultABRRules:function(e){(0,c.checkParameterType)(e,"boolean"),D=e},getUseDefaultABRRules:function(){return D},getABRCustomRules:function(){return N},addABRCustomRule:function(e,t,n){if("string"!=typeof e||e!==l.default.ABANDON_FRAGMENT_RULES&&e!==l.default.QUALITY_SWITCH_RULES||"string"!=typeof t)throw u.default.BAD_ARGUMENT_ERROR;var r=Y(t);-1===r?N.push({type:e,rulename:t,rule:n}):(N[r].type=e,N[r].rule=n)},removeABRCustomRule:function(e){if(e){var t=Y(e);-1!==t&&N.splice(t,1)}else N=[]},setBandwidthSafetyFactor:function(e){(0,c.checkParameterType)(e,"number"),x=e},getBandwidthSafetyFactor:function(){return x},setAbandonLoadTimeout:function(e){(0,c.checkParameterType)(e,"number"),M=e},getAbandonLoadTimeout:function(){return M},setLastBitrateCachingInfo:function(e,t){if("boolean"!=typeof e||void 0!==t&&("number"!=typeof t||isNaN(t)))throw u.default.BAD_ARGUMENT_ERROR;_.enabled=e,void 0!==t&&(_.ttl=t)},getLastBitrateCachingInfo:function(){return _},setLastMediaSettingsCachingInfo:function(e,t){if("boolean"!=typeof e||void 0!==t&&("number"!=typeof t||isNaN(t)))throw u.default.BAD_ARGUMENT_ERROR;b.enabled=e,void 0!==t&&(b.ttl=t)},getLastMediaSettingsCachingInfo:function(){return b},setStableBufferTime:function(e){(0,c.checkParameterType)(e,"number"),E=e},getStableBufferTime:function(){return Z()?.6*K():isNaN(E)?L?20:12:E},setBufferTimeAtTopQuality:function(e){(0,c.checkParameterType)(e,"number"),T=e},getBufferTimeAtTopQuality:function(){return T},setBufferTimeAtTopQualityLongForm:function(e){(0,c.checkParameterType)(e,"number"),S=e},getBufferTimeAtTopQualityLongForm:function(){return S},setLongFormContentDurationThreshold:function(e){(0,c.checkParameterType)(e,"number"),w=e},getLongFormContentDurationThreshold:function(){return w},setSegmentOverlapToleranceTime:function(e){(0,c.checkParameterType)(e,"number"),A=e},getSegmentOverlapToleranceTime:function(){return A},getCacheLoadThresholdForType:function(e){return F[e]},setCacheLoadThresholdForType:function(e,t){(0,c.checkParameterType)(t,"number"),(0,c.checkIsVideoOrAudioType)(e),F[e]=t},setBufferToKeep:function(e){(0,c.checkParameterType)(e,"number"),g=e},getBufferToKeep:function(){return g},setBufferAheadToKeep:function(e){(0,c.checkParameterType)(e,"number"),v=e},getBufferAheadToKeep:function(){return v},setBufferPruningInterval:function(e){(0,c.checkParameterType)(e,"number"),y=e},getBufferPruningInterval:function(){return y},setRetryAttemptsForType:function(e,t){if("number"!=typeof t||"string"!=typeof e||e!==s.HTTPRequest.MPD_TYPE&&e!==s.HTTPRequest.MEDIA_SEGMENT_TYPE)throw u.default.BAD_ARGUMENT_ERROR;C[e]=t},getRetryAttemptsForType:function(e){return Z()?5*C[e]:C[e]},setRetryIntervalForType:function(e,t){(0,c.checkParameterType)(t,"number"),R[e]=t},getRetryIntervalForType:function(e){return Z()?R[e]/10:R[e]},setWallclockTimeUpdateInterval:function(e){(0,c.checkParameterType)(e,"number"),I=e},getWallclockTimeUpdateInterval:function(){return I},setScheduleWhilePaused:function(e){(0,c.checkParameterType)(e,"boolean"),m=e},getScheduleWhilePaused:function(){return m},getUseSuggestedPresentationDelay:function(){return o},setUseSuggestedPresentationDelay:function(e){(0,c.checkParameterType)(e,"boolean"),o=e},setLiveDelayFragmentCount:function(e){(0,c.checkParameterType)(e,"number"),f=e},getLiveDelayFragmentCount:function(){return f},getLiveDelay:K,setLiveDelay:function(e){void 0!==e&&(0,c.checkParameterType)(e,"number"),p=e},setUseManifestDateHeaderTimeSource:function(e){(0,c.checkParameterType)(e,"boolean"),r=e},getUseManifestDateHeaderTimeSource:function(){return r},addUTCTimingSource:X,removeUTCTimingSource:Q,getUTCTimingSources:function(){return h},clearDefaultUTCTimingSources:function(){h=[]},restoreDefaultUTCTimingSources:function(){X(q.scheme,q.value)},setXHRWithCredentialsForType:function e(t,n){t?P[t]=!!n:Object.keys(P).forEach((function(t){e(t,n)}))},getXHRWithCredentialsForType:function(e){var t=P[e];return void 0===t?P.default:t},setFastSwitchEnabled:function(e){(0,c.checkParameterType)(e,"boolean"),L=e},getFastSwitchEnabled:function(){return L},setMovingAverageMethod:function(e){if(e!==u.default.MOVING_AVERAGE_SLIDING_WINDOW&&e!==u.default.MOVING_AVERAGE_EWMA)throw u.default.BAD_ARGUMENT_ERROR;k=e},getMovingAverageMethod:function(){return k},setJumpGaps:function(e){(0,c.checkParameterType)(e,"boolean"),B=e},getJumpGaps:function(){return B},setSmallGapLimit:function(e){(0,c.checkParameterType)(e,"number"),U=e},getSmallGapLimit:function(){return U},getLowLatencyEnabled:Z,setLowLatencyEnabled:function(e){(0,c.checkParameterType)(e,"boolean"),j=e},setCatchUpPlaybackRate:function(e){(0,c.checkParameterType)(e,"number"),(0,c.checkRange)(e,0,.5),W=e},getCatchUpPlaybackRate:function(){return W},setLowLatencyMinDrift:function(e){(0,c.checkParameterType)(e,"number"),V=e},getLowLatencyMinDrift:function(){return V},setLowLatencyMaxDriftBeforeSeeking:function(e){(0,c.checkParameterType)(e,"number"),z=e},getLowLatencyMaxDriftBeforeSeeking:function(){return z},setManifestUpdateRetryInterval:function(e){(0,c.checkParameterType)(e,"number"),G=e},getManifestUpdateRetryInterval:function(){return G},setKeepProtectionMediaKeys:function(e){(0,c.checkParameterType)(e,"boolean"),H=e},getKeepProtectionMediaKeys:function(){return H},getDefaultUtcTimingSource:function(){return q},reset:function(){}},h=[],o=!1,r=!0,m=!0,O=u.default.ABR_STRATEGY_DYNAMIC,D=!0,L=!1,_={enabled:!0,ttl:36e4},b={enabled:!0,ttl:36e4},f=4,p=void 0,g=20,v=80,y=10,E=NaN,T=30,S=60,w=600,A=.2,x=.9,M=1e4,I=50,B=!1,U=.8,G=100,P={default:!1},N=[],k=u.default.MOVING_AVERAGE_SLIDING_WINDOW,j=!1,V=.02,z=0,W=.5,i(t={},s.HTTPRequest.MPD_TYPE,3),i(t,s.HTTPRequest.XLINK_EXPANSION_TYPE,1),i(t,s.HTTPRequest.MEDIA_SEGMENT_TYPE,3),i(t,s.HTTPRequest.INIT_SEGMENT_TYPE,3),i(t,s.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),i(t,s.HTTPRequest.INDEX_SEGMENT_TYPE,3),i(t,s.HTTPRequest.OTHER_TYPE,3),C=t,i(n={},s.HTTPRequest.MPD_TYPE,500),i(n,s.HTTPRequest.XLINK_EXPANSION_TYPE,500),i(n,s.HTTPRequest.MEDIA_SEGMENT_TYPE,d),i(n,s.HTTPRequest.INIT_SEGMENT_TYPE,d),i(n,s.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,d),i(n,s.HTTPRequest.INDEX_SEGMENT_TYPE,d),i(n,s.HTTPRequest.OTHER_TYPE,d),R=n,(F={})[u.default.VIDEO]=50,F[u.default.AUDIO]=5,H=!1,e}h.__dashjs_factory_name="MediaPlayerModel",t.default=o.default.getSingletonFactory(h),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(75)),o=r(n(1128)),s=n(32),u=r(n(1129)),l=r(n(1130)),c=r(n(1131)),d=r(n(1132)),h=r(n(1133)),f=n(1134),p=r(n(1135)),m=r(n(12)),g=r(n(1136)),v=r(n(14)),y=r(n(3));function _(){var e,t=this.context,n=(0,m.default)(t).getInstance(),r=void 0;function y(){n.trigger(v.default.METRICS_CHANGED)}function _(e){n.trigger(v.default.METRIC_CHANGED,{mediaType:e}),y()}function b(e,t,r){n.trigger(v.default.METRIC_UPDATED,{mediaType:e,metric:t,value:r}),_(e)}function E(e,t,r){n.trigger(v.default.METRIC_ADDED,{mediaType:e,metric:t,value:r}),_(e)}function T(e){var t=void 0;return r.hasOwnProperty(e)?t=r[e]:(t=new o.default,r[e]=t),t}function S(e,t,n){var r=T(e);r[t].push(n),r[t].length>1e3&&r[t].shift()}function w(e,t,n){S(e,t,n),E(e,t,n)}return e={clearCurrentMetricsForType:function(e){delete r[e],_(e)},clearAllCurrentMetrics:function(){r={},y()},getReadOnlyMetricsFor:function(e){return r.hasOwnProperty(e)?r[e]:null},getMetricsFor:T,addHttpRequest:function e(t,n,r,i,o,u,l,c,d,h,f,p,m,g){var v=new s.HTTPRequest;o&&o!==i&&(e(t,null,r,i,null,null,l,c,null,null,null,p,null,null),v.actualurl=o),v.tcpid=n,v.type=r,v.url=i,v.range=l,v.trequest=c,v.tresponse=d,v.responsecode=f,v._tfinish=h,v._stream=t,v._mediaduration=p,v._responseHeaders=m,v._serviceLocation=u,g?g.forEach((function(e){!function(e,t,n,r){var i=new s.HTTPRequestTrace;i.s=t,i.d=n,i.b=r,e.trace.push(i),e.interval||(e.interval=0),e.interval+=n}(v,e.s,e.d,e.b)})):(delete v.interval,delete v.trace),w(t,a.default.HTTP_REQUEST,v)},addRepresentationSwitch:function(e,t,n,r,i){var o=new u.default;o.t=t,o.mt=n,o.to=r,i?o.lto=i:delete o.lto,w(e,a.default.TRACK_SWITCH,o)},addBufferLevel:function(e,t,n){var r=new l.default;r.t=t,r.level=n,w(e,a.default.BUFFER_LEVEL,r)},addBufferState:function(e,t,n){var r=new c.default;r.target=n,r.state=t,w(e,a.default.BUFFER_STATE,r)},addDVRInfo:function(e,t,n,r){var i=new d.default;i.time=t,i.range=r,i.manifestInfo=n,w(e,a.default.DVR_INFO,i)},addDroppedFrames:function(e,t){var n=new h.default,r=T(e).DroppedFrames;n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,r.length>0&&r[r.length-1]==n||w(e,a.default.DROPPED_FRAMES,n)},addSchedulingInfo:function(e,t,n,r,i,o,s,u,l){var c=new p.default;c.mediaType=e,c.t=t,c.type=n,c.startTime=r,c.availabilityStartTime=i,c.duration=o,c.quality=s,c.range=u,c.state=l,w(e,a.default.SCHEDULING_INFO,c)},addRequestsQueue:function(e,t,n){var r=new g.default;r.loadingRequests=t,r.executedRequests=n,T(e).RequestsQueue=r,E(e,a.default.REQUESTS_QUEUE,r)},addManifestUpdate:function(e,t,n,r,o,s,u,l,c,d){var h=new f.ManifestUpdate;h.mediaType=e,h.type=t,h.requestTime=n,h.fetchTime=r,h.availabilityStartTime=o,h.presentationStartTime=s,h.clientTimeOffset=u,h.currentTime=l,h.buffered=c,h.latency=d,S(i.default.STREAM,a.default.MANIFEST_UPDATE,h),E(e,a.default.MANIFEST_UPDATE,h)},updateManifestUpdateInfo:function(e,t){if(e){for(var n in t)e[n]=t[n];b(e.mediaType,a.default.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,n,r,i){if(e){var o=new f.ManifestUpdateStreamInfo;o.id=t,o.index=n,o.start=r,o.duration=i,e.streamInfo.push(o),b(e.mediaType,a.default.MANIFEST_UPDATE_STREAM_INFO,e)}},addManifestUpdateRepresentationInfo:function(e,t,n,r,i,o,s,u){if(e){var l=new f.ManifestUpdateRepresentationInfo;l.id=t,l.index=n,l.streamIndex=r,l.mediaType=i,l.startNumber=s,l.fragmentInfoType=u,l.presentationTimeOffset=o,e.representationInfo.push(l),b(e.mediaType,a.default.MANIFEST_UPDATE_TRACK_INFO,e)}},addPlayList:function(e){var t=i.default.STREAM;e.trace&&Array.isArray(e.trace)?e.trace.forEach((function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel})):delete e.trace,w(t,a.default.PLAY_LIST,e)},addDVBErrors:function(e){w(i.default.STREAM,a.default.DVB_ERRORS,e)}},r={},e}_.__dashjs_factory_name="MetricsModel",t.default=y.default.getSingletonFactory(_),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.level=null},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(62),a=(r=i)&&r.__esModule?r:{default:r};t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=null,this.state=a.default.BUFFER_EMPTY},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.range=null,this.manifestInfo=null},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.droppedFrames=null},e.exports=t.default},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});t.ManifestUpdate=function e(){r(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},t.ManifestUpdateStreamInfo=function e(){r(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},t.ManifestUpdateRepresentationInfo=function e(){r(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingRequests=[],this.executedRequests=[]},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(12)),o=r(n(14)),s=r(n(13));function u(){var e=void 0,t=void 0,n=void 0,r=void 0,i=void 0,u=this.context,l=(0,a.default)(u).getInstance(),c=[];function d(){n&&(n.playbackRate=i||1,n.removeEventListener("canplay",d))}function h(e){n&&(n.readyState<=2&&e>0?n.addEventListener("canplay",d):n.playbackRate=e)}function f(){return c.length>0}function p(e){var t=c.indexOf(e),r=void 0;null!==e&&(-1!==t&&c.splice(t,1),n&&!1===f()&&0===n.playbackRate&&(h(i||1),n.paused||((r=document.createEvent("Event")).initEvent("playing",!0,!1),n.dispatchEvent(r))))}function m(){if(n&&f()&&0===n.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),n.dispatchEvent(e)}}function g(){return n?n.buffered:null}return e={initialize:function(){l.on(o.default.PLAYBACK_PLAYING,m,this)},setCurrentTime:function(e,t){if(n){if(n.currentTime==e)return;try{e=t?function(e){var t=g(),n=e,r=9999999999;if(t)for(var i=0;i<t.length;i++){var a=t.start(i),o=t.end(i),s=Math.abs(a-e),u=Math.abs(o-e);if(e>=a&&e<=o)return e;s<r&&(r=s,n=a),u<r&&(r=u,n=o)}return n}(e):e,n.currentTime=e}catch(t){0===n.readyState&&t.code===t.INVALID_STATE_ERR&&setTimeout((function(){n.currentTime=e}),400)}}},play:function(){if(n){n.autoplay=!0;var e=n.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch((function(e){"NotAllowedError"===e.name&&l.trigger(o.default.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing ("+e+")")}))}},isPaused:function(){return n?n.paused:null},pause:function(){n&&(n.pause(),n.autoplay=!1)},isSeeking:function(){return n?n.seeking:null},getTime:function(){return n?n.currentTime:null},getPlaybackRate:function(){return n?n.playbackRate:null},setPlaybackRate:h,getPlayedRanges:function(){return n?n.played:null},getEnded:function(){return n?n.ended:null},setStallState:function(e,t){!function(e,t){t?function(e){var t=void 0;if(null===e||n.seeking||-1!==c.indexOf(e))return;c.push(e),n&&1===c.length&&((t=document.createEvent("Event")).initEvent("waiting",!0,!1),i=n.playbackRate,h(0),n.dispatchEvent(t))}(e):p(e)}(e,t)},getElement:function(){return n},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw"element is not video or audio DOM type!";(n=e)&&(n.preload="auto")},setSource:function(e){n&&(e?n.src=e:(n.removeAttribute("src"),n.load()))},getSource:function(){return n?n.src:null},getTTMLRenderingDiv:function(){return r},setTTMLRenderingDiv:function(e){(r=e).style.position="absolute",r.style.display="flex",r.style.overflow="hidden",r.style.pointerEvents="none",r.style.top=0,r.style.left=0},getPlaybackQuality:function(){if(!n)return null;var e="webkitDroppedFrameCount"in n&&"webkitDecodedFrameCount"in n,t=null;return"getVideoPlaybackQuality"in n?t=n.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:n.webkitDroppedFrameCount,totalVideoFrames:n.webkitDroppedFrameCount+n.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:function(e,t){n&&n.addEventListener(e,t)},removeEventListener:function(e,t){n&&n.removeEventListener(e,t)},getReadyState:function(){return n?n.readyState:NaN},getBufferRange:g,getClientWidth:function(){return n?n.clientWidth:NaN},getClientHeight:function(){return n?n.clientHeight:NaN},getTextTracks:function(){return n?n.textTracks:[]},getTextTrack:function(e,t,r,i,a){if(n)for(var o=0;o<n.textTracks.length;o++)if(n.textTracks[o].kind===e&&(!t||n.textTracks[o].label==t)&&n.textTracks[o].language===r&&n.textTracks[o].isTTML===i&&n.textTracks[o].isEmbedded===a)return n.textTracks[o];return null},addTextTrack:function(e,t,r){return n?n.addTextTrack(e,t,r):null},appendChild:function(e){n&&(n.appendChild(e),void 0!==e.isTTML&&(n.textTracks[n.textTracks.length-1].isTTML=e.isTTML,n.textTracks[n.textTracks.length-1].isEmbedded=e.isEmbedded))},removeChild:function(e){n&&n.removeChild(e)},getVideoWidth:function(){return n?n.videoWidth:NaN},getVideoHeight:function(){return n?n.videoHeight:NaN},getVideoRelativeOffsetTop:function(){return n&&n.parentNode?n.getBoundingClientRect().top-n.parentNode.getBoundingClientRect().top:NaN},getVideoRelativeOffsetLeft:function(){return n&&n.parentNode?n.getBoundingClientRect().left-n.parentNode.getBoundingClientRect().left:NaN},reset:function(){l.off(o.default.PLAYBACK_PLAYING,m,this)}},t=(0,s.default)(u).getInstance().getLogger(e),e}u.__dashjs_factory_name="VideoModel",t.default=i.default.getSingletonFactory(u),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(3)),a=r(n(13)),o=r(n(11)),s=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],u="dashjs_?_bitrate",l="dashjs_?_settings",c="localStorage",d="LastBitrate",h="LastMediaSettings";function f(e){e=e||{};var t=this.context,n=e.mediaPlayerModel,r=void 0,i=void 0,f=void 0;function p(e){if(void 0!==f)return f;f=!1;var t=void 0;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return i.warn("DOMStorage access denied: "+e.message),f}if(!t||e!==c&&"sessionStorage"!==e)return f;try{t.setItem("1","1"),t.removeItem("1"),f=!0}catch(e){i.warn("DOMStorage is supported, but cannot be used: "+e.message)}return f}function m(){var e=6e5;return Math.round((new Date).getTime()/e)*e}function g(e,t){return p(e)&&n["get"+t+"CachingInfo"]().enabled}function v(){if(!n||!n.hasOwnProperty("getLastMediaSettingsCachingInfo"))throw new Error(o.default.MISSING_CONFIG_ERROR)}return r={getSavedBitrateSettings:function(e){var t=NaN;if(v(),g(c,d)){var r=u.replace(/\?/,e);try{var a=JSON.parse(localStorage.getItem(r))||{},o=(new Date).getTime()-parseInt(a.timestamp,10)>=n.getLastMediaSettingsCachingInfo().ttl||!1,s=parseFloat(a.bitrate);isNaN(s)||o?o&&localStorage.removeItem(r):(t=s,i.debug("Last saved bitrate for "+e+" was "+s))}catch(e){return null}}return t},setSavedBitrateSettings:function(e,t){if(g(c,d)&&t){var n=u.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({bitrate:t.toFixed(3),timestamp:m()}))}catch(e){i.error(e.message)}}},getSavedMediaSettings:function(e){if(v(),!g(c,h))return null;var t=null,r=l.replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(r))||{},a=(new Date).getTime()-parseInt(i.timestamp,10)>=n.getLastMediaSettingsCachingInfo().ttl||!1;t=i.settings,a&&(localStorage.removeItem(r),t=null)}catch(e){return null}return t},setSavedMediaSettings:function(e,t){if(g(c,h)){var n=l.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({settings:t,timestamp:m()}))}catch(e){i.error(e.message)}}}},i=(0,a.default)(t).getInstance().getLogger(r),p(c)&&s.forEach((function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){i.error(e.message)}}})),r}f.__dashjs_factory_name="DOMStorage";var p=i.default.getSingletonFactory(f);t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(39)),o=r(n(1140)),s=r(n(1141)),u=r(n(1142)),l=r(n(1143)),c=r(n(225)),d=r(n(3)),h=r(n(209)),f=n(76);function p(){var e,t=void 0,n=void 0,r=void 0,d=void 0;function p(e,t){return t&&e?t.getRepresentationForQuality(e.quality):null}function m(e){return e&&e.streamInfo&&void 0!==e.streamInfo.id&&r[e.streamInfo.id]?r[e.streamInfo.id][e.index]:null}function g(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r];if(e.id===i.id)return i}return null}function v(e){var n=new o.default,r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],i=t.getRepresentationFor(e.index,r);return n.id=e.id,n.quality=e.index,n.bandwidth=t.getBandwidth(i),n.DVRWindow=e.segmentAvailabilityRange,n.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),n.MSETimeOffset=e.MSETimeOffset,n.useCalculatedLiveEdgeTime=e.useCalculatedLiveEdgeTime,n.mediaInfo=y(e.adaptation),n}function y(e){var n,r=new s.default,i=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];return r.id=e.id,r.index=e.index,r.type=e.type,r.streamInfo=b(e.period),r.representationCount=t.getRepresentationCount(i),r.labels=t.getLabelsForAdaptation(i),r.lang=t.getLanguageForAdaptation(i),n=t.getViewpointForAdaptation(i),r.viewpoint=n?n.value:void 0,r.accessibility=t.getAccessibilityForAdaptation(i).map((function(e){var t=e.value,n=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==h.default&&(n=t?"cea-608:"+t:"cea-608",r.embeddedCaptions=!0),n})),r.audioChannelConfiguration=t.getAudioChannelConfigurationForAdaptation(i).map((function(e){return e.value})),r.roles=t.getRolesForAdaptation(i).map((function(e){return e.value})),r.codec=t.getCodec(i),r.mimeType=t.getMimeType(i),r.contentProtection=t.getContentProtectionData(i),r.bitrateList=t.getBitrateListForAdaptation(i),r.contentProtection&&r.contentProtection.forEach((function(e){e.KID=t.getKID(e)})),r.isText=t.getIsTextTrack(r.mimeType),r}function _(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=i.default.EMBEDDED_TEXT,e.codec="cea-608-in-SEI",e.isText=!0,e.isEmbedded=!0,e.lang=n,e.roles=["caption"]}function b(e){var n,r,i=new u.default;return i.id=e.id,i.index=e.index,i.start=e.start,i.duration=e.duration,i.manifestInfo=(n=e.mpd,(r=new l.default).DVRWindowSize=n.timeShiftBufferDepth,r.loadedTime=n.manifest.loadedTime,r.availableFrom=n.availabilityStartTime,r.minBufferTime=n.manifest.minBufferTime,r.maxFragmentDuration=n.maxSegmentDuration,r.duration=t.getDuration(n.manifest),r.isDynamic=t.getIsDynamic(n.manifest),r),i.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(i.start+i.duration-i.manifestInfo.duration)<1,i}function E(e,n,r,i){var o,s=t.getAdaptationsForType(e,n,r);if(!s||0===s.length)return null;if(s.length>1&&i){var u=T(i,r);if(d[i.id]&&d[i.id][r])for(var l=0,c=s.length;l<c;l++)if(d[i.id][r].isMediaInfoEqual(u[l]))return s[l];for(l=0,c=s.length;l<c;l++)if(o=s[l],t.getRolesForAdaptation(o).filter((function(e){return e.value===a.default.MAIN}))[0])return s[l]}return s[0]}function T(e,a,o){var s,u=n,l=o,c=[],d=void 0,h=void 0,f=void 0,p=void 0,m=void 0;if(l){S();var v=t.getMpd(l);u=t.getRegularPeriods(v)}else{if(!(n.length>0))return c;l=n[0].mpd.manifest}var b=g(e,u),E=b.id,T=t.getAdaptationsForType(l,e.index,a!==i.default.EMBEDDED_TEXT?a:i.default.VIDEO);if(!T)return c;for(r[E]=r[E]||t.getAdaptationsForPeriod(b),p=0,s=T.length;p<s;p++)if(d=T[p],f=t.getIndexForAdaptation(d,l,e.index),h=y(r[E][f]),a===i.default.EMBEDDED_TEXT){var w=h.accessibility.length;for(m=0;m<w;m++)if(h){var A=h.accessibility[m];if(0===A.indexOf("cea-608:")){var x=A.substring(8).split(";");if("CC"===x[0].substring(0,2))for(m=0;m<x.length;m++)h||(h=y.call(this,r[E][f])),_(h,x[m].substring(0,3),x[m].substring(4)),c.push(h),h=null;else for(m=0;m<x.length;m++)h||(h=y.call(this,r[E][f])),_(h,"CC"+(m+1),x[m]),c.push(h),h=null}else 0===A.indexOf("cea-608")&&(_(h,i.default.CC1,"eng"),c.push(h),h=null)}}else a===i.default.IMAGE?(h.type=i.default.IMAGE,c.push(h),h=null):h&&c.push(h);return c}function S(){if(!t||!t.hasOwnProperty("getMpd")||!t.hasOwnProperty("getRegularPeriods"))throw new Error("setConfig function has to be called previously")}function w(e){if(!(e&&e.hasOwnProperty("getRepresentationController")&&e.hasOwnProperty("getIndexHandler")&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getType")&&e.hasOwnProperty("getStreamInfo")))throw new Error("streamProcessor parameter is missing or malformed!")}function A(){n=[],r={},d={}}return e={convertDataToRepresentationInfo:v,getDataForMedia:m,getStreamsInfo:function(e,r){var i=[],a=n;if(e){S();var o=t.getMpd(e);a=t.getRegularPeriods(o)}r||(r=a.length);for(var s=0;s<r;s++)i.push(b(a[s]));return i},getMediaInfoForType:function(e,i){if(0===n.length)return null;var a=n[0].mpd.manifest,o=E(a,e.index,i,e);if(!o)return null;var s=g(e,n),u=s.id,l=t.getIndexForAdaptation(o,a,e.index);return r[u]=r[u]||t.getAdaptationsForPeriod(s),y(r[u][l])},getAllMediaInfoForType:T,getRepresentationInfo:function(e,t){!function(e){if(!e||!e.hasOwnProperty("getRepresentationForQuality")||!e.hasOwnProperty("getCurrentRepresentation"))throw new Error("representationController parameter is missing or malformed!")}(e);var n=void 0;return void 0!==t?((0,f.checkInteger)(t),n=e.getRepresentationForQuality(t)):n=e.getCurrentRepresentation(),n?v(n):null},getAdaptationForType:E,updateData:function(e){w(e);var r,i=g(e.getStreamInfo(),n),a=e.getMediaInfo(),o=m(a),s=e.getType(),u=void 0;r=a?a.id:null,n.length>0&&(u=r?t.getAdaptationForId(r,n[0].mpd.manifest,i.index):t.getAdaptationForIndex(a.index,n[0].mpd.manifest,i.index),e.getRepresentationController().updateData(u,o,s))},getInitRequest:function(e,t){var n,r=void 0,i=void 0;return w(e),(0,f.checkInteger)(t),r=e.getRepresentationController(),i=e.getIndexHandler(),n=r?r.getRepresentationForQuality(t):null,i?i.getInitRequest(n):null},getFragmentRequest:function(e,t,n,r){var i,a=void 0,o=null;return w(e),i=p(t,e.getRepresentationController()),(a=e.getIndexHandler())&&(o=void 0!==n&&void 0!==r?a.getSegmentRequestForTime(i,n,r):a.getNextSegmentRequest(i)),o},getIndexHandlerTime:function(e){w(e);var t=e.getIndexHandler();return t?t.getCurrentTime():NaN},setIndexHandlerTime:function(e,t){w(e);var n=e.getIndexHandler();n&&n.setCurrentTime(t)},getEventsFor:function(e,r){var i=[];if(0===n.length)return i;var a=n[0].mpd.manifest;return e instanceof u.default?i=t.getEventsForPeriod(g(e,n)):e instanceof s.default?i=t.getEventStreamForAdaptationSet(a,m(e)):e instanceof o.default&&(i=t.getEventStreamForRepresentation(a,p(e,r.getRepresentationController()))),i},getEvent:function(e,t,n){if(!e||!t)return null;var r=new c.default,i=e.scheme_id_uri,a=e.value,o=e.timescale,s=e.presentation_time_delta,u=e.event_duration,l=e.id,d=e.message_data,h=n*o+s;return t[i+"/"+a]?(r.eventStream=t[i+"/"+a],r.eventStream.value=a,r.eventStream.timescale=o,r.duration=u,r.id=l,r.presentationTime=h,r.messageData=d,r.presentationTimeDelta=s,r):null},setConfig:function(e){e&&e.dashManifestModel&&(t=e.dashManifestModel)},updatePeriods:function(e){if(!e)return null;S();var i=t.getMpd(e);n=t.getRegularPeriods(i),r={}},reset:A,resetIndexHandler:function(e){w(e);var t=e.getIndexHandler();t&&t.resetIndex()},setCurrentMediaInfo:function(e,t,n){d[e]=d[e]||{},d[e][t]=d[e][t]||{},d[e][t]=n}},A(),e}p.__dashjs_factory_name="DashAdapter",t.default=d.default.getSingletonFactory(p),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.quality=null,this.DVRWindow=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null}return r(e,[{key:"isMediaInfoEqual",value:function(e){if(!e)return!1;var t=this.id===e.id,n=this.viewpoint===e.viewpoint,r=this.lang===e.lang,i=this.roles.toString()===e.roles.toString(),a=this.accessibility.toString()===e.accessibility.toString(),o=this.audioChannelConfiguration.toString()===e.audioChannelConfiguration.toString();return t&&n&&r&&i&&a&&o}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DVRWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(11)),a=r(n(39)),o=r(n(160)),s=r(n(1145)),u=r(n(1146)),l=r(n(1147)),c=r(n(223)),d=r(n(225)),h=r(n(219)),f=r(n(1148)),p=r(n(218)),m=r(n(55)),g=r(n(3)),v=r(n(13)),y=r(n(26)),_=r(n(29)),b=n(215);function E(e){e=e||{};var t=void 0,n=void 0,r=this.context,g=(0,m.default)(r).getInstance(),E=e.timelineConverter,T=e.errHandler,S=e.BASE64,w=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function A(e,t){var n=void 0,r=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=!1,d=!1;if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.hasOwnProperty("ContentComponent_asArray")&&(s=e.ContentComponent_asArray),u=t!==i.default.TEXT?new RegExp(t):new RegExp("(vtt|ttml)"),e.Representation_asArray&&e.Representation_asArray.length&&e.Representation_asArray.length>0){var h=N(e.Representation_asArray[0]);if(h&&h.length>0&&b.THUMBNAILS_SCHEME_ID_URIS.indexOf(h[0].schemeIdUri)>=0)return t===i.default.IMAGE;if(e.Representation_asArray[0].hasOwnProperty(a.default.CODECS)&&(0===(l=e.Representation_asArray[0].codecs).search(i.default.STPP)||0===l.search(i.default.WVTT)))return t===i.default.FRAGMENTED_TEXT}if(s){if(s.length>1)return t===i.default.MUXED;s[0]&&s[0].contentType===t&&(c=!0,d=!0)}if(e.hasOwnProperty(a.default.MIME_TYPE)&&(c=u.test(e.mimeType),d=!0),!d)for(n=0,r=e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0;!d&&n<r;)(o=e.Representation_asArray[n]).hasOwnProperty(a.default.MIME_TYPE)&&(c=u.test(o.mimeType),d=!0),n++;return c}function x(e){return A(e,i.default.AUDIO)}function M(e){return A(e,i.default.VIDEO)}function C(e){return A(e,i.default.FRAGMENTED_TEXT)}function R(e){return A(e,i.default.IMAGE)}function I(e){return"text/vtt"===e||"application/ttml+xml"===e}function O(){return function(e,t){return e.bandwidth-t.bandwidth}}function D(e){return e&&void 0!==e.Representation_asArray&&null!==e.Representation_asArray&&e.Representation_asArray.sort((function(e,t){return e.bandwidth-t.bandwidth})),e}function P(e,t){return e&&e.Period_asArray&&w(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function L(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===a.default.DYNAMIC),t}function N(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map((function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}})):null}function k(e){if(e&&e.period&&w(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&w(e.index))return D(t.AdaptationSet_asArray[e.index])}}function F(e){var t=e.S_asArray[e.S_asArray.length-1];return!t.hasOwnProperty("r")||t.r>=0}function B(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=u.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty(a.default.ID)&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n}function U(e,t){var n=[],r=void 0;if(!e)return n;for(r=0;r<e.length;r++){var o=new f.default;if(o.timescale=1,o.representation=t,!e[r].hasOwnProperty(i.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");o.schemeIdUri=e[r].schemeIdUri,e[r].hasOwnProperty(a.default.TIMESCALE)&&(o.timescale=e[r].timescale),e[r].hasOwnProperty(a.default.VALUE)&&(o.value=e[r].value),n.push(o)}return n}function j(e){var t=[],n=e.BaseURL_asArray||[e.baseUri],r=!1;return n.some((function(n){if(n){var i=new h.default,o=n.__text||n;return g.isRelative(o)&&(r=!0,e.baseUri&&(o=g.resolve(o,e.baseUri))),i.url=o,n.hasOwnProperty(a.default.SERVICE_LOCATION)&&n.serviceLocation.length?i.serviceLocation=n.serviceLocation:i.serviceLocation=o,n.hasOwnProperty(a.default.DVB_PRIORITY)&&(i.dvb_priority=n[a.default.DVB_PRIORITY]),n.hasOwnProperty(a.default.DVB_WEIGHT)&&(i.dvb_weight=n[a.default.DVB_WEIGHT]),n.hasOwnProperty(a.default.AVAILABILITY_TIME_OFFSET)&&(i.availabilityTimeOffset=n[a.default.AVAILABILITY_TIME_OFFSET]),n.hasOwnProperty(a.default.AVAILABILITY_TIME_COMPLETE)&&(i.availabilityTimeComplete="false"!==n[a.default.AVAILABILITY_TIME_COMPLETE]),t.push(i),r}})),t}return t={getIsTypeOf:A,getIsTextTrack:I,getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(a.default.LANG)&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(a.default.VIEWPOINT)?e.Viewpoint:null},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(a.default.ROLE_ASARRAY)?e.Role_asArray:[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(a.default.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(a.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(e,t,n){var r=P(t,n);return r.length>0&&w(e)?r[e]:null},getIndexForAdaptation:function(e,t,n){var i=P(t,n),a=i.length;if(e)for(var o=0;o<a;o++){if((0,p.default)(r).getInstance().areEqual(i[o],e))return o}return-1},getAdaptationForId:function(e,t,n){var r,i=P(t,n),o=void 0;for(o=0,r=i.length;o<r;o++)if(i[o].hasOwnProperty(a.default.ID)&&i[o].id===e)return i[o];return null},getAdaptationsForType:function(e,t,n){var r,i=P(e,t),a=void 0,o=[];for(a=0,r=i.length;a<r;a++)A(i[a],n)&&o.push(D(i[a]));return o},getCodec:function(e,t,n){var r=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var i=w(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];i&&(r=i.mimeType+';codecs="'+i.codecs+'"',n&&void 0!==i.width&&(r+=';width="'+i.width+'";height="'+i.height+'"'))}return r},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(a.default.CENC_DEFAULT_KID)?e[a.default.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e.Label_asArray||!e.Label_asArray.length)return[];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(a.default.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:L,getIsDVB:function(e){return function(e,t){var n=!1;return e&&e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf(t)),n}(e,"urn:dvb:dash:profile:dvb-dash:2014")},getDuration:function(e){return e&&e.hasOwnProperty(a.default.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=NaN;return e&&e.hasOwnProperty(a.default.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)},getRepresentationCount:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length?D(e).Representation_asArray.map((function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null}})):null},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&w(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t=[],n=k(e),r=void 0,i=void 0;if(e&&e.period&&w(e.period.index)){var s=j(e.period.mpd.manifest);s&&(i=s[0])}if(n&&n.Representation_asArray)for(var u=0,l=n.Representation_asArray.length;u<l;++u){var c=n.Representation_asArray[u],d=new o.default;if(d.index=u,d.adaptation=e,c.hasOwnProperty(a.default.ID)&&(d.id=c.id),c.hasOwnProperty(a.default.CODECS)&&(d.codecs=c.codecs),c.hasOwnProperty(a.default.CODEC_PRIVATE_DATA)&&(d.codecPrivateData=c.codecPrivateData),c.hasOwnProperty(a.default.BANDWITH)&&(d.bandwidth=c.bandwidth),c.hasOwnProperty(a.default.WIDTH)&&(d.width=c.width),c.hasOwnProperty(a.default.HEIGHT)&&(d.height=c.height),c.hasOwnProperty(a.default.SCAN_TYPE)&&(d.scanType=c.scanType),c.hasOwnProperty(a.default.MAX_PLAYOUT_RATE)&&(d.maxPlayoutRate=c.maxPlayoutRate),c.hasOwnProperty(a.default.SEGMENT_BASE)?(r=c.SegmentBase,d.segmentInfoType=a.default.SEGMENT_BASE):c.hasOwnProperty(a.default.SEGMENT_LIST)?(r=c.SegmentList).hasOwnProperty(a.default.SEGMENT_TIMELINE)?(d.segmentInfoType=a.default.SEGMENT_TIMELINE,d.useCalculatedLiveEdgeTime=F(r.SegmentTimeline)):(d.segmentInfoType=a.default.SEGMENT_LIST,d.useCalculatedLiveEdgeTime=!0):c.hasOwnProperty(a.default.SEGMENT_TEMPLATE)?((r=c.SegmentTemplate).hasOwnProperty(a.default.SEGMENT_TIMELINE)?(d.segmentInfoType=a.default.SEGMENT_TIMELINE,d.useCalculatedLiveEdgeTime=F(r.SegmentTimeline)):d.segmentInfoType=a.default.SEGMENT_TEMPLATE,r.hasOwnProperty(a.default.INITIALIZATION_MINUS)&&(d.initialization=r.initialization.split("$Bandwidth$").join(c.bandwidth).split("$RepresentationID$").join(c.id))):d.segmentInfoType=a.default.BASE_URL,d.essentialProperties=N(c),r){if(r.hasOwnProperty(a.default.INITIALIZATION)){var h=r.Initialization;h.hasOwnProperty(a.default.SOURCE_URL)?d.initialization=h.sourceURL:h.hasOwnProperty(a.default.RANGE)&&(d.range=h.range)}else c.hasOwnProperty(a.default.MIME_TYPE)&&I(c.mimeType)&&(d.range=0);r.hasOwnProperty(a.default.TIMESCALE)&&(d.timescale=r.timescale),r.hasOwnProperty(a.default.DURATION)&&(d.segmentDuration=r.duration/d.timescale),r.hasOwnProperty(a.default.MEDIA)&&(d.media=r.media),r.hasOwnProperty(a.default.START_NUMBER)&&(d.startNumber=r.startNumber),r.hasOwnProperty(a.default.INDEX_RANGE)&&(d.indexRange=r.indexRange),r.hasOwnProperty(a.default.PRESENTATION_TIME_OFFSET)&&(d.presentationTimeOffset=r.presentationTimeOffset/d.timescale),r.hasOwnProperty(a.default.AVAILABILITY_TIME_OFFSET)?d.availabilityTimeOffset=r.availabilityTimeOffset:i&&void 0!==i.availabilityTimeOffset&&(d.availabilityTimeOffset=i.availabilityTimeOffset),r.hasOwnProperty(a.default.AVAILABILITY_TIME_COMPLETE)?d.availabilityTimeComplete="false"!==r.availabilityTimeComplete:i&&void 0!==i.availabilityTimeComplete&&(d.availabilityTimeComplete=i.availabilityTimeComplete)}d.MSETimeOffset=E.calcMSETimeOffset(d),d.path=[e.period.index,e.index,u],t.push(d)}return t},getAdaptationsForPeriod:function(e){var t=e&&w(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,n=[],r=void 0,o=void 0,u=void 0;if(t&&t.AdaptationSet_asArray)for(u=0;u<t.AdaptationSet_asArray.length;u++)o=t.AdaptationSet_asArray[u],r=new s.default,o.hasOwnProperty(a.default.ID)&&(r.id=o.id),r.index=u,r.period=e,A(o,i.default.MUXED)?r.type=i.default.MUXED:x(o)?r.type=i.default.AUDIO:M(o)?r.type=i.default.VIDEO:C(o)?r.type=i.default.FRAGMENTED_TEXT:R(o)?r.type=i.default.IMAGE:r.type=i.default.TEXT,n.push(r);return n},getRegularPeriods:function(e){var t,r=!!e&&L(e.manifest),i=[],o=null,s=null,l=null,c=null,d=void 0;for(d=0,t=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;d<t;d++)(s=e.manifest.Period_asArray[d]).hasOwnProperty(a.default.START)?(c=new u.default).start=s.start:null!==o&&o.hasOwnProperty(a.default.DURATION)&&null!==l?(c=new u.default).start=parseFloat((l.start+l.duration).toFixed(5)):0!==d||r||((c=new u.default).start=0),null!==l&&isNaN(l.duration)&&(null!==c?l.duration=parseFloat((c.start-l.start).toFixed(5)):n.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==c&&(c.id=B(s,d),c.index=d,c.mpd=e,s.hasOwnProperty(a.default.DURATION)&&(c.duration=s.duration),i.push(c),o=s,l=c),s=null,c=null;return 0===i.length||null!==l&&isNaN(l.duration)&&(l.duration=parseFloat((function(e){var t=L(e.mpd.manifest),n=void 0;e.mpd.manifest.mediaPresentationDuration?n=e.mpd.manifest.mediaPresentationDuration:e.duration?n=e.duration:t?n=Number.POSITIVE_INFINITY:T.error(new y.default(_.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e));return n}(l)-l.start).toFixed(5))),i},getMpd:function(e){var t=new l.default;return e&&(t.manifest=e,e.hasOwnProperty(a.default.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):t.availabilityStartTime=new Date(e.loadedTime.getTime()),e.hasOwnProperty(a.default.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(a.default.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(a.default.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(i.default.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(a.default.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(a.default.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration)),t},getEventsForPeriod:function(e){var t=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,n=t?t.Period_asArray:null,r=n&&e&&w(e.index)?n[e.index].EventStream_asArray:null,o=[],s=void 0,u=void 0;if(r)for(s=0;s<r.length;s++){var l=new f.default;if(l.period=e,l.timescale=1,!r[s].hasOwnProperty(i.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(l.schemeIdUri=r[s].schemeIdUri,r[s].hasOwnProperty(a.default.TIMESCALE)&&(l.timescale=r[s].timescale),r[s].hasOwnProperty(a.default.VALUE)&&(l.value=r[s].value),u=0;r[s].Event_asArray&&u<r[s].Event_asArray.length;u++){var c=new d.default;c.presentationTime=0,c.eventStream=l,r[s].Event_asArray[u].hasOwnProperty(a.default.PRESENTATION_TIME)&&(c.presentationTime=r[s].Event_asArray[u].presentationTime),r[s].Event_asArray[u].hasOwnProperty(a.default.DURATION)&&(c.duration=r[s].Event_asArray[u].duration),r[s].Event_asArray[u].hasOwnProperty(a.default.ID)&&(c.id=r[s].Event_asArray[u].id),r[s].Event_asArray[u].Signal&&r[s].Event_asArray[u].Signal.Binary?c.messageData=S.decodeArray(r[s].Event_asArray[u].Signal.Binary):c.messageData=r[s].Event_asArray[u].messageData||r[s].Event_asArray[u].__text,o.push(c)}}return o},getEventStreamForAdaptationSet:function(e,t){var n=void 0,r=void 0,i=void 0;return e&&e.Period_asArray&&t&&t.period&&w(t.period.index)&&(r=e.Period_asArray[t.period.index])&&r.AdaptationSet_asArray&&w(t.index)&&(i=r.AdaptationSet_asArray[t.index])&&(n=i.InbandEventStream_asArray),U(n,null)},getEventStreamForRepresentation:function(e,t){var n=void 0,r=void 0,i=void 0,a=void 0;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&w(t.adaptation.period.index)&&(r=e.Period_asArray[t.adaptation.period.index])&&r.AdaptationSet_asArray&&w(t.adaptation.index)&&(i=r.AdaptationSet_asArray[t.adaptation.index])&&i.Representation_asArray&&w(t.index)&&(a=i.Representation_asArray[t.index])&&(n=a.InbandEventStream_asArray),U(n,t)},getUTCTimingSources:function(e){var t=L(e),n=!!e&&e.hasOwnProperty(a.default.AVAILABILITY_START_TIME),r=e?e.UTCTiming_asArray:null,o=[];return(t||n)&&r&&r.forEach((function(e){var t=new c.default;e.hasOwnProperty(i.default.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(a.default.VALUE)&&(t.value=e.value.toString(),o.push(t)))})),o},getBaseURLsFromElement:j,getRepresentationSortFunction:O,getLocation:function(e){if(e&&e.hasOwnProperty(i.default.LOCATION))return e.Location=e.Location_asArray[0],e.Location},getUseCalculatedLiveEdgeTimeForAdaptation:function(e){var t=k(e).Representation_asArray[0],n=void 0;return t.hasOwnProperty(a.default.SEGMENT_LIST)?!(n=t.SegmentList).hasOwnProperty(a.default.SEGMENT_TIMELINE)||F(n.SegmentTimeline):!(!t.hasOwnProperty(a.default.SEGMENT_TEMPLATE)||!(n=t.SegmentTemplate).hasOwnProperty(a.default.SEGMENT_TIMELINE))&&F(n.SegmentTimeline)}},n=(0,v.default)(r).getInstance().getLogger(t),t}E.__dashjs_factory_name="DashManifestModel",t.default=g.default.getSingletonFactory(E),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.period=null,this.index=-1,this.type=null},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};r.DEFAULT_ID="defaultId",t.default=r,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(32),a=r(n(3)),o=r(n(75)),s=r(n(1150));function u(e){var t=(e=e||{}).dashManifestModel,n=e.manifestModel;function r(e){var t=n.getValue();return t?t.Period_asArray[e]:-1}function a(e){return c(e,o.default.BUFFER_LEVEL)}function u(e){if(!e)return null;var t=e.HttpList,n=null,r=void 0;if(!t||t.length<=0)return null;for(r=t.length-1;r>=0;){if(t[r].responsecode){n=t[r];break}r--}return n}function l(e){return e&&e.HttpList?e.HttpList:[]}function c(e,t){if(!e)return null;var n=e[t];return!n||n.length<=0?null:n[n.length-1]}function d(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var a=n[r],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}function h(e,t,n){var r=void 0,i=void 0,a=void 0,o=void 0,s=void 0;if(e)for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)for(a=r[o].Representation_asArray,s=0;s<a.length;s+=1)if(t===(i=a[s]).id)return n?s:i;return null}function f(e,n){return t.getIsTypeOf(e,n)}return{getBandwidthForRepresentation:function(e,t){var n;return null===(n=h(r(t),e))?null:n.bandwidth},getIndexForRepresentation:function(e,t){return function(e,t){var n=h(e,t,!0);if(null!==n)return n;return-1}(r(t),e)},getMaxIndexForBufferType:function(e,t){return function(e,t){var n=void 0,r=void 0,i=void 0,a=void 0;if(!e||!t)return-1;for(r=e.AdaptationSet_asArray,a=0;a<r.length;a+=1)if(i=(n=r[a]).Representation_asArray,f(n,t))return i.length;return-1}(r(t),e)},getCurrentRepresentationSwitch:function(e){return c(e,o.default.TRACK_SWITCH)},getLatestBufferLevelVO:a,getCurrentBufferLevel:function(e){var t=a(e);return t?s.default.round10(t.level/1e3,-3):0},getCurrentHttpRequest:u,getHttpRequests:l,getCurrentDroppedFrames:function(e){return c(e,o.default.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return c(e,o.default.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return c(e,o.default.DVR_INFO)},getCurrentManifestUpdate:function(e){return c(e,o.default.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){var n={},r=u(e);return r&&(n=d(r._responseHeaders)),void 0===n[t]?null:n[t]},getLatestMPDRequestHeaderValueByID:function(e,t){var n,r={},a=void 0,o=void 0;for(o=(n=l(e)).length-1;o>=0;o--)if((a=n[o]).type===i.HTTPRequest.MPD_TYPE){r=d(a._responseHeaders);break}return void 0===r[t]?null:r[t]},getRequestsQueue:function(e){return e?e.RequestsQueue:null}}}u.__dashjs_factory_name="DashMetrics",t.default=a.default.getSingletonFactory(u),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"round10",value:function(e,t){return function(e,t,n){if(void 0===n||0==+n)return Math[e](t);if(n=+n,null===(t=+t)||isNaN(t)||!("number"==typeof n&&n%1==0))return NaN;return t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))}("round",e,t)}}]),e}();t.default=i,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(12)),a=r(n(14)),o=r(n(3));function s(){var e=this.context,t=(0,i.default)(e).getInstance(),n=void 0,r=void 0,o=void 0;function s(e){n=e}function u(e,t,r,i){return i?r&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:r?new Date(t.availabilityStartTime.getTime()+1e3*(e-n)):t.availabilityStartTime}function l(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*n)/1e3}function c(e){r||void 0!==e.offset&&(s(e.offset/1e3),r=!0)}function d(){n=0,r=!1,o=NaN}return{initialize:function(){d(),t.on(a.default.TIME_SYNCHRONIZATION_COMPLETED,c,this)},isTimeSyncCompleted:function(){return r},setTimeSyncCompleted:function(e){r=e},getClientTimeOffset:function(){return n},setClientTimeOffset:s,getExpectedLiveEdge:function(){return o},setExpectedLiveEdge:function(e){o=e},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return u.call(this,e,t,n)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return u.call(this,e,t,n,!0)},calcPresentationTimeFromWallTime:l,calcPresentationTimeFromMediaTime:function(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)},calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcSegmentAvailabilityRange:function(e,t){var n=e.adaptation.period,i={start:n.start,end:n.start+n.duration};if(!t)return i;if(!r&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var a=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),o=l(new Date,n),s=n.start+n.duration;i.start=Math.max(o-n.mpd.timeShiftBufferDepth,n.start);var u=void 0!==e.availabilityTimeOffset&&e.availabilityTimeOffset<a?a-e.availabilityTimeOffset:a;return i.end=o>=s&&o-u<s?s:o-u,i},calcWallTimeForSegment:function(e,t){var n=void 0,r=void 0,i=void 0;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i},calcMSETimeOffset:function(e){var t=e.presentationTimeOffset;return e.adaptation.period.start-t},reset:function(){t.off(a.default.TIME_SYNCHRONIZATION_COMPLETED,c,this),d()}}}s.__dashjs_factory_name="TimelineConverter",t.default=o.default.getSingletonFactory(s),e.exports=t.default},function(e,t,n){"use strict";var r={encode:function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|63&r)):r<65536?(t.push(224|r>>12),t.push(128|63&r>>6),t.push(128|63&r)):(t.push(240|r>>18),t.push(128|63&r>>12),t.push(128|63&r>>6),t.push(128|63&r))}return t},decode:function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?(r=(31&r)<<6,r|=63&e[n++]):r<240?(r=(15&r)<<12,r|=(63&e[n++])<<6,r|=63&e[n++]):(r=(7&r)<<18,r|=(63&e[n++])<<12,r|=(63&e[n++])<<6,r|=63&e[n++])),t.push(String.fromCharCode(r))}return t.join("")}},i={};!function(e){var t=function(t){for(var n=0,r=[],i=0|t.length/3;0<i--;){var a=(t[n]<<16)+(t[n+1]<<8)+t[n+2];n+=3,r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push(e.charAt(63&a>>6)),r.push(e.charAt(63&a))}if(2==t.length-n){a=(t[n]<<16)+(t[n+1]<<8);r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push(e.charAt(63&a>>6)),r.push("=")}else if(1==t.length-n){a=t[n]<<16;r.push(e.charAt(63&a>>18)),r.push(e.charAt(63&a>>12)),r.push("==")}return r.join("")},n=function(){for(var t=[],n=0;n<e.length;++n)t[e.charCodeAt(n)]=n;return t["=".charCodeAt(0)]=0,t}(),o=function(e){for(var t=0,r=[],i=0|e.length/4;0<i--;){var a=(n[e.charCodeAt(t)]<<18)+(n[e.charCodeAt(t+1)]<<12)+(n[e.charCodeAt(t+2)]<<6)+n[e.charCodeAt(t+3)];r.push(255&a>>16),r.push(255&a>>8),r.push(255&a),t+=4}return r&&("="==e.charAt(t-2)?(r.pop(),r.pop()):"="==e.charAt(t-1)&&r.pop()),r},u={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}};i.decodeArray=function(e){var t=o(e);return new Uint8Array(t)},i.encodeASCII=function(e){var n=u.encode(e);return t(n)},i.decodeASCII=function(e){var t=o(e);return u.decode(t)},i.encode=function(e){var n=r.encode(e);return t(n)},i.decode=function(e){var t=o(e);return r.decode(t)}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),t.decode=i.decode,t.decodeArray=i.decodeArray,t.encode=i.encode,t.encodeASCII=i.encodeASCII},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1154)),a=r(n(118)),o=r(n(1156)),s=r(n(227)),u=r(n(226));function l(){var e=this.context;return{createMetricsReporting:function(t){return(0,i.default)(e).getInstance({eventBus:t.eventBus,metricsModel:t.metricsModel,metricsConstants:t.metricsConstants,events:t.events}),(0,o.default)(e).create(t)},getReportingFactory:function(){return(0,u.default)(e).getInstance()},getMetricsHandlerFactory:function(){return(0,s.default)(e).getInstance()}}}l.__dashjs_factory_name="MetricsReporting";var c=dashjs.FactoryMaker.getClassFactory(l);c.events=a.default,dashjs.FactoryMaker.updateClassFactory(l.__dashjs_factory_name,c),t.default=c,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1155)),a=r(n(118));function o(e){var t=void 0,n=void 0,r=(e=e||{}).eventBus,o=e.metricsModel,s=e.metricsConstants,u=e.events;function l(e){var t=new i.default;if(n){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.mpdurl||(t.mpdurl=n.originalUrl||n.url),t.terror||(t.terror=new Date),o.addDVBErrors(t)}}function c(e){e.error||(n=e.manifest)}function d(e){l({errorcode:i.default.BASE_URL_CHANGED,servicelocation:e.entry})}function h(){l({errorcode:i.default.BECAME_REPORTER})}function f(e){switch(e.metric){case s.HTTP_REQUEST:(0===(t=e.value).responsecode||t.responsecode>=400||t.responsecode<100||t.responsecode>=600)&&l({errorcode:t.responsecode||i.default.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation})}var t}function p(e){var t=void 0;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=i.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=i.default.CORRUPT_MEDIA_OTHER;break;default:return}l({errorcode:t})}function m(){r.on(u.MANIFEST_UPDATED,c,t),r.on(u.SERVICE_LOCATION_BLACKLIST_CHANGED,d,t),r.on(u.METRIC_ADDED,f,t),r.on(u.METRIC_UPDATED,f,t),r.on(u.PLAYBACK_ERROR,p,t),r.on(a.default.BECAME_REPORTING_PLAYER,h,t)}return t={initialise:m,reset:function(){r.off(u.MANIFEST_UPDATED,c,t),r.off(u.SERVICE_LOCATION_BLACKLIST_CHANGED,d,t),r.off(u.METRIC_ADDED,f,t),r.off(u.METRIC_UPDATED,f,t),r.off(u.PLAYBACK_ERROR,p,t),r.off(a.default.BECAME_REPORTING_PLAYER,h,t)}},m(),t}o.__dashjs_factory_name="DVBErrorsTranslator",t.default=dashjs.FactoryMaker.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};r.SSL_CONNECTION_FAILED_PREFIX="SSL",r.DNS_RESOLUTION_FAILED="C00",r.HOST_UNREACHABLE="C01",r.CONNECTION_REFUSED="C02",r.CONNECTION_ERROR="C03",r.CORRUPT_MEDIA_ISOBMFF="M00",r.CORRUPT_MEDIA_OTHER="M01",r.BASE_URL_CHANGED="F00",r.BECAME_REPORTER="S00",t.default=r,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1157)),a=r(n(1168)),o=r(n(118));function s(e){e=e||{};var t={},n=this.context,r=e.eventBus,s=e.events;function u(s){if(!s.error){var u=Object.keys(t);(0,a.default)(n).getInstance({dashManifestModel:e.dashManifestModel,constants:e.constants}).getMetrics(s.manifest).forEach((function(r){var a=JSON.stringify(r);if(t.hasOwnProperty(a))u.splice(a,1);else try{var o=(0,i.default)(n).create(e);o.initialize(r),t[a]=o}catch(e){}})),u.forEach((function(e){t[e].reset(),delete t[e]})),r.trigger(o.default.METRICS_INITIALISATION_COMPLETE)}}function l(){Object.keys(t).forEach((function(e){t[e].reset()})),t={}}return r.on(s.MANIFEST_UPDATED,u),r.on(s.STREAM_TEARDOWN_COMPLETE,l),{reset:function(){r.off(s.MANIFEST_UPDATED,u),r.off(s.STREAM_TEARDOWN_COMPLETE,l)}}}s.__dashjs_factory_name="MetricsCollectionController",t.default=dashjs.FactoryMaker.getClassFactory(s),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1158)),a=r(n(1159)),o=r(n(1163));function s(e){e=e||{};var t=void 0,n=void 0,r=void 0,s=this.context;function u(){t&&t.reset(),n&&n.reset(),r&&r.reset()}return{initialize:function(l){try{(r=(0,i.default)(s).create({mediaElement:e.mediaElement})).initialize(l.Range),(n=(0,a.default)(s).create({debug:e.debug,metricsConstants:e.metricsConstants})).initialize(l.Reporting,r),(t=(0,o.default)(s).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events})).initialize(l.metrics,n)}catch(e){throw u(),e}},reset:u}}s.__dashjs_factory_name="MetricsController",t.default=dashjs.FactoryMaker.getClassFactory(s),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(208),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t,n=!1,r=this.context,i=void 0,o=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach((function(e){var t=e.starttime,n=t+e.duration;i.add(t,n)})),n=!!e[0]._useWallClockTime)},reset:function(){i.clear()},isEnabled:function(){var e,t=i.length;if(!t)return!0;e=n?(new Date).getTime()/1e3:o.currentTime;for(var r=0;r<t;r+=1){var a=i.start(r),s=i.end(r);if(a<=e&&e<s)return!0}return!1}},i=(0,a.default)(r).create(),t}o.__dashjs_factory_name="RangeController",t.default=dashjs.FactoryMaker.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(226),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=[],n=(0,a.default)(this.context).getInstance(e);return{initialize:function(e,r){e.some((function(e){var i=n.create(e,r);if(i)return t.push(i),!0}))},reset:function(){t.forEach((function(e){return e.reset()})),t=[]},report:function(e,n){t.forEach((function(t){return t.report(e,n)}))}}}o.__dashjs_factory_name="ReportingController",t.default=dashjs.FactoryMaker.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1161)),a=r(n(1162));function o(e){e=e||{};var t,n=this.context,r=void 0,o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,d=[],h=e.metricsConstants;function f(){s=!1,u=!1,l=null,c=null}return t={report:function(e,t){Array.isArray(t)||(t=[t]),u&&c.isEnabled()&&t.forEach((function(t){var n=r.serialise(t);e!==h.DVB_ERRORS&&(n="metricname="+e+"&"+n),function(e,t,n){var r=new XMLHttpRequest,i=function(){var e=d.indexOf(r);-1!==e&&(d.splice(e,1),r.status>=200&&r.status<300?t&&t():n&&n())};d.push(r);try{r.open("GET",e),r.onloadend=i,r.onerror=i,r.send()}catch(e){r.onerror()}}(n=l+"?"+n,null,(function(){u=!1}))}))},initialize:function(e,t){var n=void 0;if(c=t,!(l=e["dvb:reportingUrl"]))throw new Error("required parameter missing (dvb:reportingUrl)");s||((n=e["dvb:probability"]||e["dvb:priority"]||0)&&(1e3===n||n/1e3>=o.random())&&(u=!0),s=!0)},reset:function(){f()}},r=(0,i.default)(n).getInstance(),o=(0,a.default)(n).getInstance(),f(),t}o.__dashjs_factory_name="DVBReporting",t.default=dashjs.FactoryMaker.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(){return{serialise:function e(t){var n=[],r=[],i=void 0,a=void 0;for(i in t)if(t.hasOwnProperty(i)&&0!==i.indexOf("_")){if(null==(a=t[i])&&(a=""),Array.isArray(a)){if(!a.length)continue;r=[],a.forEach((function(t){var n="Object"!==Object.prototype.toString.call(t).slice(8,-1);r.push(n?t:e(t))})),a=r.map(encodeURIComponent).join(",")}else"string"==typeof a?a=encodeURIComponent(a):a instanceof Date?a=a.toISOString():"number"==typeof a&&(a=Math.round(a));n.push(i+"="+a)}return n.join("&")}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="MetricSerialiser",t.default=dashjs.FactoryMaker.getSingletonFactory(r),e.exports=t.default},function(e,t,n){"use strict";function r(){var e,t=window.crypto||window.msCrypto,n=Uint32Array,r=Math.pow(2,8*n.BYTES_PER_ELEMENT)-1,i=void 0,a=void 0;function o(){t&&(i||(i=new n(10)),t.getRandomValues(i),a=0)}return e={random:function(e,n){var s=void 0;return e||(e=0),n||(n=1),t?(a===i.length&&o(),s=i[a]/r,a+=1):s=Math.random(),s*(n-e)+e}},o(),e}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="RNG",t.default=dashjs.FactoryMaker.getSingletonFactory(r),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(227),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t=[],n=void 0,r=this.context,i=e.eventBus,o=e.events,s=(0,a.default)(r).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function u(e){t.forEach((function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)}))}return n={initialize:function(e,r){e.split(",").forEach((function(e,n,i){var a;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var o=i[n+1];o&&-1===o.indexOf("(")&&-1!==o.indexOf(")")&&(e+=","+o,delete i[n+1])}(a=s.create(e,r))&&t.push(a)})),i.on(o.METRIC_ADDED,u,n),i.on(o.METRIC_UPDATED,u,n)},reset:function(){i.off(o.METRIC_ADDED,u,n),i.off(o.METRIC_UPDATED,u,n),t.forEach((function(e){return e.reset()})),t=[]}}}o.__dashjs_factory_name="MetricsHandlersController",t.default=dashjs.FactoryMaker.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(228),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t=void 0,n=void 0,r=void 0,i=void 0,o=void 0,s=this.context,u=(0,a.default)(s).getInstance(),l=[],c=e.metricsConstants;function d(){var e=function(){try{return Object.keys(l).map((function(e){return l[e]})).reduce((function(e,t){return e.level<t.level?e:t}))}catch(e){return}}();e&&o!==e.t&&(o=e.t,t.report(r,e))}return{initialize:function(e,a,o){a&&(n=u.validateN(o),t=a,r=u.reconstructFullMetricName(e,o),i=setInterval(d,n))},reset:function(){clearInterval(i),i=null,n=0,t=null,o=null},handleNewMetric:function(e,t,n){e===c.BUFFER_LEVEL&&(l[n]=t)}}}o.__dashjs_factory_name="BufferLevelHandler",t.default=dashjs.FactoryMaker.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(118),a=(r=i)&&r.__esModule?r:{default:r};t.default=dashjs.FactoryMaker.getClassFactory((function(e){var t=void 0,n=(e=e||{}).eventBus,r=e.metricsConstants;function i(){n.off(a.default.METRICS_INITIALISATION_COMPLETE,i,this),n.trigger(a.default.BECAME_REPORTING_PLAYER)}return{initialize:function(e,r){r&&(t=r,n.on(a.default.METRICS_INITIALISATION_COMPLETE,i,this))},reset:function(){t=null},handleNewMetric:function(e,n){e===r.DVB_ERRORS&&t&&t.report(e,n)}}})),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(228),a=(r=i)&&r.__esModule?r:{default:r};function o(e){e=e||{};var t=void 0,n=void 0,r=void 0,i=void 0,o=void 0,s=[],u=(0,a.default)(this.context).getInstance(),l=e.metricsConstants;function c(){var e=s;e.length&&t&&t.report(i,e),s=[]}return{initialize:function(e,a,s,l){a&&(n=u.validateN(s),t=a,l&&l.length&&(r=l),i=u.reconstructFullMetricName(e,s,l),o=setInterval(c,n))},reset:function(){clearInterval(o),o=null,n=null,r=null,s=[],t=null},handleNewMetric:function(e,t){e===l.HTTP_REQUEST&&(r&&r!==t.type||s.push(t))}}}o.__dashjs_factory_name="HttpListHandler",t.default=dashjs.FactoryMaker.getClassFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(){var e=void 0,t=void 0;return{initialize:function(n,r){e=n,t=r},reset:function(){t=null,e=void 0},handleNewMetric:function(n,r){n===e&&t&&t.report(e,r)}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="GenericMetricHandler",t.default=dashjs.FactoryMaker.getClassFactory(r),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1169)),a=r(n(1170)),o=r(n(1171));function s(e){var t=(e=e||{}).dashManifestModel,n=e.constants;return{getMetrics:function(e){var r=[];return e.Metrics_asArray&&e.Metrics_asArray.forEach((function(s){var u=new i.default,l=t.getIsDynamic(e);s.hasOwnProperty("metrics")&&(u.metrics=s.metrics,s.Range_asArray&&s.Range_asArray.forEach((function(r){var i=new a.default;i.starttime=function(e,r,i){var a,o,s=t.getMpd(e),u=0;return r?u=s.availabilityStartTime.getTime()/1e3:(a=this.getRegularPeriods(s)).length&&(u=a[0].start),o=u,i&&i.hasOwnProperty(n.START_TIME)&&(o+=i.starttime),o}(e,l,r),r.hasOwnProperty("duration")?i.duration=r.duration:i.duration=t.getDuration(e),i._useWallClockTime=l,u.Range.push(i)})),s.Reporting_asArray&&(s.Reporting_asArray.forEach((function(e){var t=new o.default;if(e.hasOwnProperty(n.SCHEME_ID_URI)){for(var r in t.schemeIdUri=e.schemeIdUri,e)e.hasOwnProperty(r)&&(t[r]=e[r]);u.Reporting.push(t)}})),r.push(u)))})),r}}}s.__dashjs_factory_name="ManifestParsing",t.default=dashjs.FactoryMaker.getSingletonFactory(s),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics="",this.Range=[],this.Reporting=[]},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1173)),a=r(n(119)),o=r(n(1183)),s=r(n(97)),u=r(n(1184)),l=r(n(1185)),c=r(n(1186)),d=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],h=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function f(){var e=void 0,t=this.context;function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r[Object.keys(r)[0]]])return r}return null}return e={createProtectionSystem:function(r){var o=null,s=(0,a.default)(t).getInstance();s.setConfig({debug:r.debug,BASE64:r.BASE64}),s.initialize();var f=function(r){var i=r.debug,a=i.getLogger(e),o=r.eventBus,s=r.errHandler,f=r.videoModel?r.videoModel.getElement():null;return f&&void 0===f.onencrypted||f&&void 0===f.mediaKeys?n(f,h)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,l.default)(t).create({debug:i,eventBus:o,events:r.events,api:n(f,h)})):n(f,d)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,c.default)(t).create({debug:i,eventBus:o,errHandler:s,events:r.events,api:n(f,d)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,u.default)(t).create({debug:i,eventBus:o,events:r.events}))}(r);return!o&&f&&(o=(0,i.default)(t).create({protectionModel:f,protectionKeyController:s,eventBus:r.eventBus,debug:r.debug,events:r.events,BASE64:r.BASE64,constants:r.constants}),r.capabilities.setEncryptedMediaSupported(!0)),o}}}f.__dashjs_factory_name="Protection";var p=dashjs.FactoryMaker.getClassFactory(f);p.events=o.default,p.errors=s.default,dashjs.FactoryMaker.updateClassFactory(f.__dashjs_factory_name,p),t.default=p,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(77)),a=r(n(1174)),o=r(n(162)),s=r(n(97)),u=r(n(26));function l(e){var t=(e=e||{}).protectionKeyController,n=e.protectionModel,r=e.eventBus,l=e.events,c=e.debug,d=e.BASE64,h=e.constants,f=[],p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0;function T(e,a){var o=i.default.getPSSHForKeySystem(E,e),c=A(E);if(o){for(var d=n.getAllInitData(),h=0;h<d.length;h++)if(t.initDataEquals(o,d[h]))return void m.warn("DRM: Ignoring initData because we have already seen it!");try{n.createKeySession(o,c,M(E),a)}catch(e){r.trigger(l.KEY_SESSION_CREATED,{data:null,error:new u.default(s.default.KEY_SESSION_CREATED_ERROR_CODE,s.default.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)})}}else e?n.createKeySession(e,c,M(E),a):r.trigger(l.KEY_SESSION_CREATED,{data:null,error:new u.default(s.default.KEY_SESSION_CREATED_ERROR_CODE,s.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+E.systemString+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function S(e,t){n.loadKeySession(e,t,M(E))}function w(e){e?(n.setMediaElement(e),r.on(l.NEED_KEY,D,this)):null===e&&(n.setMediaElement(e),r.off(l.NEED_KEY,D,this))}function A(e){var t=null;if(e){var n=e.systemString;y&&(t=n in y?y[n]:null)}return t}function x(e){var t=A(e),n=[],r=[],i=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:b,s=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:b,u=M(e),l=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",c=t&&t.persistentState?t.persistentState:"temporary"===u?"optional":"required";return v.forEach((function(e){e.type===h.AUDIO?n.push(new a.default(e.codec,i)):e.type===h.VIDEO&&r.push(new a.default(e.codec,s))})),new o.default(n,r,l,c,[u])}function M(e){var t=A(e);return t&&t.sessionType?t.sessionType:_}function C(e,i){var a=this,o=[],c=void 0;if(E)for(c=0;c<e.length;c++){if(E===e[c].ks)if("break"===function(){o.push({ks:e[c].ks,configs:[x(E)]});return r.on(l.KEY_SYSTEM_ACCESS_COMPLETE,(function t(n){r.off(l.KEY_SYSTEM_ACCESS_COMPLETE,t,a),n.error?i||r.trigger(l.KEY_SYSTEM_SELECTED,{error:new u.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+n.error)}):(m.info("DRM: KeySystem Access Granted"),r.trigger(l.KEY_SYSTEM_SELECTED,{data:n.data}),e[c].sessionId?S(e[c].sessionId,e[c].initData):e[c].initData&&T(e[c].initData,e[c].cdmData))}),a),n.requestKeySystemAccess(o),"break"}())break}else if(void 0===E){var h;!function(){E=null,g.push(e);for(var f=0;f<e.length;f++)o.push({ks:e[f].ks,configs:[x(e[f].ks)]});var p=void 0,v=function e(t){r.off(l.KEY_SYSTEM_ACCESS_COMPLETE,e,a),t.error?(E=void 0,r.off(l.INTERNAL_KEY_SYSTEM_SELECTED,h,a),i||r.trigger(l.KEY_SYSTEM_SELECTED,{data:null,error:new u.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+t.error)})):(p=t.data,m.info("DRM: KeySystem Access Granted ("+p.keySystem.systemString+")!  Selecting key system..."),n.selectKeySystem(p))};h=function e(o){if(r.off(l.INTERNAL_KEY_SYSTEM_SELECTED,e,a),r.off(l.KEY_SYSTEM_ACCESS_COMPLETE,v,a),o.error)E=void 0,i||r.trigger(l.KEY_SYSTEM_SELECTED,{data:null,error:new u.default(s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,s.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+o.error)});else{if(!n)return;E=n.getKeySystem(),r.trigger(l.KEY_SYSTEM_SELECTED,{data:p});var h=A(E);h&&h.serverCertificate&&h.serverCertificate.length>0&&n.setServerCertificate(d.decodeArray(h.serverCertificate).buffer);for(var f=0;f<g.length;f++)for(c=0;c<g[f].length;c++)if(E===g[f][c].ks){if(t.isClearKey(E)&&h&&h.hasOwnProperty("clearkeys")){var m={kids:Object.keys(h.clearkeys)};g[f][c].initData=(new TextEncoder).encode(JSON.stringify(m))}g[f][c].sessionId?S(g[f][c].sessionId,g[f][c].initData):null!==g[f][c].initData&&T(g[f][c].initData,g[f][c].cdmData);break}}},r.on(l.INTERNAL_KEY_SYSTEM_SELECTED,h,a),r.on(l.KEY_SYSTEM_ACCESS_COMPLETE,v,a),n.requestKeySystemAccess(o)}()}else g.push(e)}function R(e,t){r.trigger(l.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function I(e){e.error?r.trigger(l.KEY_STATUSES_CHANGED,{data:null,error:e.error}):m.debug("DRM: key status = "+e.status)}function O(e){m.debug("DRM: onKeyMessage");var a=e.data;r.trigger(l.KEY_MESSAGE,{data:a});var o=a.messageType?a.messageType:"license-request",c=a.message,d=a.sessionToken,h=A(E),f=E?E.systemString:null,p=t.getLicenseServer(E,h,o),g={sessionToken:d,messageType:o};if(c&&0!==c.byteLength){if(!p)return m.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+d.getSessionID()),void R(g);if(t.isClearKey(E)){var v=t.processClearKeyLicenseRequest(E,h,c);if(v)return m.debug("DRM: ClearKey license request handled by application!"),R(g),void n.updateKeySession(d,v)}var y=null;if(h&&h.serverURL){var _=h.serverURL;"string"==typeof _&&""!==_?y=_:"object"==typeof _&&_.hasOwnProperty(o)&&(y=_[o])}else h&&h.laURL&&""!==h.laURL?y=h.laURL:(y=E.getLicenseServerURLFromInitData(i.default.getPSSHData(d.initData)))||(y=e.data.laURL);if(y=p.getServerURLFromMessage(y,c,o)){var b={},T=!1,S=function(e){if(e)for(var t in e)"authorization"===t.toLowerCase()&&(T=!0),b[t]=e[t]};h&&S(h.httpRequestHeaders),S(E.getRequestHeadersFromMessage(c)),h&&"boolean"==typeof h.withCredentials&&(T=h.withCredentials);var w=function(e,t,n,r){var i=e.response?p.getErrorResponse(e.response,n,r):"NONE";R(t,new u.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+i))},x=E.getLicenseRequestFromMessage(c),M=p.getHTTPMethod(o),C=p.getResponseType(f,o),I=h&&!isNaN(h.httpTimeout)?h.httpTimeout:8e3;!function e(t,n,r,i,a,o,s,u,l,c,d){var h=new XMLHttpRequest;h.open(r,t,!0),h.responseType=i,h.withCredentials=a,u>0&&(h.timeout=u);for(var f in n)h.setRequestHeader(f,n[f]);var p=function(){s--,setTimeout((function(){e(t,n,r,i,a,o,s,u,l,c,d)}),1e3)};h.onload=function(){200===this.status||s<=0?l(this):(m.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+s),p())},h.ontimeout=h.onerror=function(){s<=0?d(this):(m.warn("License request network request failed . Retrying it... Pending retries: "+s),p())},h.onabort=function(){c(this)},h.send(o)}(y,b,M,C,T,x,3,I,(function(e){if(n)if(200===e.status){var t=p.getLicenseMessage(e.response,f,o);null!==t?(R(g),n.updateKeySession(d,t)):w(e,g,f,o)}else w(e,g,f,o)}),(function(e){R(g,new u.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+f+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))}),(function(e){R(g,new u.default(s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+f+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))}))}else R(g,new u.default(s.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))}else R(g,new u.default(s.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,s.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function D(e,r){if(m.debug("DRM: onNeedKey"),"cenc"===e.key.initDataType)if(0===v.length&&(m.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(r=void 0===r?1:r+1)<5))f.push(setTimeout((function(){D(e,r)}),500));else{var a=e.key.initData;if(ArrayBuffer.isView(a)&&(a=a.buffer),E){var o=i.default.getPSSHForKeySystem(E,a);if(o)for(var s=n.getAllInitData(),u=0;u<s.length;u++)if(t.initDataEquals(o,s[u]))return void m.warn("DRM: Ignoring initData because we have already seen it!")}m.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(a)));var l=t.getSupportedKeySystems(a,y);0!==l.length?C(l,!1):m.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!")}else m.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType)}return p={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");!function(){if(!(r&&r.hasOwnProperty("on")&&t&&t.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}(),r.on(l.INTERNAL_KEY_MESSAGE,O,this),r.on(l.INTERNAL_KEY_STATUS_CHANGED,I,this),v.push(e);var n=t.getSupportedKeySystemsFromContentProtection(e.contentProtection);n&&n.length>0&&C(n,!0)},createKeySession:T,loadKeySession:S,removeKeySession:function(e){n.removeKeySession(e)},closeKeySession:function(e){n.closeKeySession(e)},setServerCertificate:function(e){n.setServerCertificate(e)},setMediaElement:w,setSessionType:function(e){_=e},setRobustnessLevel:function(e){b=e},setProtectionData:function(e){y=e,t.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return t.getSupportedKeySystemsFromContentProtection(e)},getKeySystems:function(){return t?t.getKeySystems():[]},stop:function(){n&&n.stop()},reset:function(){r.off(l.INTERNAL_KEY_MESSAGE,O,this),r.off(l.INTERNAL_KEY_STATUS_CHANGED,I,this),w(null),E=void 0,n&&(n.reset(),n=null),f.forEach((function(e){return clearTimeout(e)})),f=[],v=[]}},m=c.getLogger(p),g=[],v=[],_="temporary",b="",p}l.__dashjs_factory_name="ProtectionController",t.default=dashjs.FactoryMaker.getClassFactory(l),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentType=t,this.robustness=n},e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(163)),a=r(n(164)),o=r(n(77)),s=r(n(65)),u="e2719d58-a985-b3c9-781a-b030af78d30e",l=s.default.CLEARKEY_KEYSTEM_STRING;function c(e){var t=(e=e||{}).BASE64;return{uuid:u,schemeIdURI:"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e",systemString:l,getInitData:function(e){return o.default.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),o=[],s=0;s<r.kids.length;s++){var u=r.kids[s],l=e.clearkeys&&e.clearkeys.hasOwnProperty(u)?e.clearkeys[u]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+u+") is not known!");o.push(new i.default(u,l))}n=new a.default(o)}return n}}}c.__dashjs_factory_name="KeySystemClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(c),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(163)),a=r(n(164)),o=r(n(77)),s=r(n(65)),u="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",l=s.default.CLEARKEY_KEYSTEM_STRING;function c(e){var t=void 0,n=e.BASE64,r=e.debug.getLogger(t);return t={uuid:u,schemeIdURI:"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",systemString:l,getInitData:function(e){return o.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var o=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),s=[],u=0;u<o.kids.length;u++){var l=o.kids[u],c=e.clearkeys&&e.clearkeys.hasOwnProperty(l)?e.clearkeys[l]:null;if(!c)throw new Error("DRM: ClearKey keyID ("+l+") is not known!");s.push(new i.default(l,c))}n=new a.default(s),r.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return n}}}c.__dashjs_factory_name="KeySystemW3CClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(c),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(77)),a=r(n(65)),o="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",s=a.default.WIDEVINE_KEYSTEM_STRING;function u(e){var t=null,n=(e=e||{}).BASE64;return{uuid:o,schemeIdURI:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",systemString:s,init:function(e){e&&(t=e)},getInitData:function(e){return i.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getSessionId:function(e){return t&&t.sessionId?t.sessionId:e&&e.sessionId?e.sessionId:null}}}u.__dashjs_factory_name="KeySystemWidevine",t.default=dashjs.FactoryMaker.getSingletonFactory(u),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(77)),a=r(n(65)),o="9a04f079-9840-4286-ab92-e65be0885f95",s=a.default.PLAYREADY_KEYSTEM_STRING,u=void 0;function l(e){var t="utf16",n=(e=e||{}).BASE64;function r(){if(!n||!n.hasOwnProperty("decodeArray")||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:o,schemeIdURI:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",systemString:s,getInitData:function(e){var t,a,o,s=new Uint8Array([112,115,115,104,0,0,0,0]),u=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=0,c=null,d=void 0,h=void 0;if(r(),"pssh"in e)return i.default.parseInitDataFromContentProtection(e,n);if("pro"in e)c=n.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;c=n.decodeArray(e.prheader.__text)}return t=c.length,a=4+s.length+u.length+4+t,o=new ArrayBuffer(a),d=new Uint8Array(o),(h=new DataView(o)).setUint32(l,a),l+=4,d.set(s,l),l+=s.length,d.set(u,l),l+=u.length,h.setUint32(l,t),l+=4,d.set(c,l),l+=t,d.buffer},getRequestHeadersFromMessage:function(e){var n,r=void 0,i={},a=new DOMParser,o="utf16"===t?new Uint16Array(e):new Uint8Array(e);n=String.fromCharCode.apply(null,o);for(var s=(r=a.parseFromString(n,"application/xml")).getElementsByTagName("name"),u=r.getElementsByTagName("value"),l=0;l<s.length;l++)i[s[l].childNodes[0].nodeValue]=u[l].childNodes[0].nodeValue;return i.hasOwnProperty("Content")&&(i["Content-Type"]=i.Content,delete i.Content),i.hasOwnProperty("Content-Type")||(i["Content-Type"]="text/xml; charset="+t),i},getLicenseRequestFromMessage:function(e){var i=null,a=new DOMParser,o="utf16"===t?new Uint16Array(e):new Uint8Array(e);r();var s=String.fromCharCode.apply(null,o),u=a.parseFromString(s,"application/xml");if(u.getElementsByTagName("Challenge")[0]){var l=u.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;l&&(i=n.decode(l))}else if(u.getElementsByTagName("parsererror").length)return e;return i},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,i=new DOMParser,a=0;a<n;a++){var o=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===o){var u=e.slice(r,r+s),l=String.fromCharCode.apply(null,new Uint16Array(u)),c=i.parseFromString(l,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var d=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(d)return d}if(c.getElementsByTagName("LUI_URL")[0]){var h=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(h)return h}}else r+=s}return null},getCDMData:function(){var e=void 0,t=void 0,i=void 0,a=void 0;if(r(),u&&u.cdmData){for(e=[],a=0;a<u.cdmData.length;++a)e.push(u.cdmData.charCodeAt(a)),e.push(0);for(e=String.fromCharCode.apply(null,e),e=n.encode(e),t='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",e),i=[],a=0;a<t.length;++a)i.push(t.charCodeAt(a)),i.push(0);return new Uint8Array(i).buffer}return null},getSessionId:function(e){return u&&u.sessionId?u.sessionId:e&&e.sessionId?e.sessionId:null},setPlayReadyMessageFormat:function(e){if("utf8"!==e&&"utf16"!==e)throw new Error("Illegal PlayReady message format! -- "+e);t=e},init:function(e){e&&(u=e)}}}l.__dashjs_factory_name="KeySystemPlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(l),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(65),a=(r=i)&&r.__esModule?r:{default:r};function o(e){var t=(e=e||{}).BASE64,n={};n[a.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return t.decodeArray(e.license)},getErrorResponse:function(e){return e}},n[a.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}};return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return n[e].responseType},getLicenseMessage:function(e,r){return function(){if(!t||!t.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),n[r].getLicenseMessage(e)},getErrorResponse:function(e,t){return n[t].getErrorResponse(e)}}}o.__dashjs_factory_name="DRMToday",t.default=dashjs.FactoryMaker.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";function r(){var e="http://schemas.xmlsoap.org/soap/envelope/";function t(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}function n(n){if(window.DOMParser){var r=t(n),i=(new window.DOMParser).parseFromString(r,"text/xml"),a=i?i.getElementsByTagNameNS(e,"Envelope")[0]:null,o=a?a.getElementsByTagNameNS(e,"Body")[0]:null;if(o?o.getElementsByTagNameNS(e,"Fault")[0]:null)return null}return n}function r(n){var r="",i="",a="",o=-1,s=-1;if(window.DOMParser){var u=t(n),l=(new window.DOMParser).parseFromString(u,"text/xml"),c=l?l.getElementsByTagNameNS(e,"Envelope")[0]:null,d=c?c.getElementsByTagNameNS(e,"Body")[0]:null,h=d?d.getElementsByTagNameNS(e,"Fault")[0]:null,f=h?h.getElementsByTagName("detail")[0]:null,p=f?f.getElementsByTagName("Exception")[0]:null,m=null;if(null===h)return u;r=(m=h.getElementsByTagName("faultstring")[0].firstChild)?m.nodeValue:null,null!==p&&(i=(m=p.getElementsByTagName("StatusCode")[0])?m.firstChild.nodeValue:null,o=(a=(m=p.getElementsByTagName("Message")[0])?m.firstChild.nodeValue:null)?a.lastIndexOf("[")+1:-1,s=a?a.indexOf("]"):-1,a=a?a.substring(o,s):"")}var g="code: "+i+", name: "+r;return a&&(g+=", message: "+a),g}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return n.call(this,e)},getErrorResponse:function(e){return r.call(this,e)}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="PlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(r),e.exports=t.default},function(e,t,n){"use strict";function r(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}Object.defineProperty(t,"__esModule",{value:!0}),r.__dashjs_factory_name="Widevine",t.default=dashjs.FactoryMaker.getSingletonFactory(r),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(163)),a=r(n(164));function o(){return{getServerURLFromMessage:function(e,t){var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t)));e+="/?";for(var r=0;r<n.kids.length;r++)e+=n.kids[r]+"&";return e=e.substring(0,e.length-1)},getHTTPMethod:function(){return"GET"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var r=e.keys[n],o=r.kid.replace(/=/g,""),s=r.k.replace(/=/g,"");t.push(new i.default(o,s))}return new a.default(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}o.__dashjs_factory_name="ClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(o),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(114),a=new(function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,n){for(var r=!0;r;){var i=e,a=t,o=n;r=!1,null===i&&(i=Function.prototype);var s=Object.getOwnPropertyDescriptor(i,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var l=Object.getPrototypeOf(i);if(null===l)return;e=l,t=a,n=o,r=!0,s=l=void 0}}(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.INTERNAL_KEY_MESSAGE="internalKeyMessage",this.INTERNAL_KEY_SYSTEM_SELECTED="internalKeySystemSelected",this.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",this.KEY_ADDED="public_keyAdded",this.KEY_ERROR="public_keyError",this.KEY_MESSAGE="public_keyMessage",this.KEY_SESSION_CLOSED="public_keySessionClosed",this.KEY_SESSION_CREATED="public_keySessionCreated",this.KEY_SESSION_REMOVED="public_keySessionRemoved",this.KEY_STATUSES_CHANGED="public_keyStatusesChanged",this.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",this.KEY_SYSTEM_SELECTED="public_keySystemSelected",this.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",this.NEED_KEY="needkey",this.PROTECTION_CREATED="public_protectioncreated",this.PROTECTION_DESTROYED="public_protectiondestroyed",this.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",this.TEARDOWN_COMPLETE="protectionTeardownComplete",this.VIDEO_ELEMENT_SELECTED="videoElementSelected"}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(((r=i)&&r.__esModule?r:{default:r}).default));t.default=a,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(119)),a=r(n(165)),o=r(n(97)),s=r(n(26)),u=r(n(166)),l=r(n(167)),c=r(n(65));function d(e){e=e||{};var t=this.context,n=e.eventBus,r=e.events,d=e.debug,h=void 0,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0;function b(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function E(e){for(var t=0;t<v.length;t++)if(v[t]===e){v.splice(t,1);break}}function T(e){var t=void 0,n=void 0;return e&&e.length>0&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function S(e,t,i,a){var l={session:e,initData:t,sessionId:a,handleEvent:function(e){switch(e.type){case"keystatuseschange":n.trigger(r.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach((function(){var e=T(arguments);switch(e.status){case"expired":n.trigger(r.INTERNAL_KEY_STATUS_CHANGED,{error:new s.default(o.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,o.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:n.trigger(r.INTERNAL_KEY_STATUS_CHANGED,e)}}));break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;n.trigger(r.INTERNAL_KEY_MESSAGE,{data:new u.default(this,t,void 0,e.messageType)})}},getSessionID:function(){return e.sessionId},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getUsable:function(){var t=!1;return e.keyStatuses.forEach((function(){var e=T(arguments);"usable"===e.status&&(t=!0)})),t},getSessionType:function(){return i}};return e.addEventListener("keystatuseschange",l),e.addEventListener("message",l),e.closed.then((function(){E(l),f.debug("DRM: Session closed.  SessionID = "+l.getSessionID()),n.trigger(r.KEY_SESSION_CLOSED,{data:l.getSessionID()})})),v.push(l),l}return h={getAllInitData:function(){for(var e=[],t=0;t<v.length;t++)v[t].initData&&e.push(v[t].initData);return e},requestKeySystemAccess:function(e){!function e(t,i){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess)return void n.trigger(r.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Insecure origins are not allowed"});!function(i){var a=t[i].ks,o=t[i].configs,s=a.systemString;s===c.default.PLAYREADY_KEYSTEM_STRING&&"required"===o[0].persistentState&&(s+=".recommendation"),navigator.requestMediaKeySystemAccess(s,o).then((function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,i=new l.default(a,t);i.mksa=e,n.trigger(r.KEY_SYSTEM_ACCESS_COMPLETE,{data:i})})).catch((function(a){++i<t.length?e(t,i):n.trigger(r.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! "+a.message})}))}(i)}(e,0)},getKeySystem:function(){return p},selectKeySystem:function(e){e.mksa.createMediaKeys().then((function(t){p=e.keySystem,g=t,m?m.setMediaKeys(g).then((function(){n.trigger(r.INTERNAL_KEY_SYSTEM_SELECTED)})):n.trigger(r.INTERNAL_KEY_SYSTEM_SELECTED)})).catch((function(){n.trigger(r.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})}))},setMediaElement:function(e){m!==e&&(m&&(m.removeEventListener("encrypted",y),m.setMediaKeys&&m.setMediaKeys(null)),(m=e)&&(m.addEventListener("encrypted",y),m.setMediaKeys&&g&&m.setMediaKeys(g)))},setServerCertificate:function(e){if(!p||!g)throw new Error("Can not set server certificate until you have selected a key system");g.setServerCertificate(e).then((function(){f.info("DRM: License server certificate successfully updated."),n.trigger(r.SERVER_CERTIFICATE_UPDATED)})).catch((function(e){n.trigger(r.SERVER_CERTIFICATE_UPDATED,{error:new s.default(o.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,o.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})}))},createKeySession:function(e,t,i){if(!p||!g)throw new Error("Can not create sessions until you have selected a key system");var a=g.createSession(i),u=S(a,e,i),l=this.getKeySystem().systemString===c.default.CLEARKEY_KEYSTEM_STRING&&t&&t.clearkeys?"keyids":"cenc";a.generateRequest(l,e).then((function(){f.debug("DRM: Session created.  SessionID = "+u.getSessionID()),n.trigger(r.KEY_SESSION_CREATED,{data:u})})).catch((function(e){E(u),n.trigger(r.KEY_SESSION_CREATED,{data:null,error:new s.default(o.default.KEY_SESSION_CREATED_ERROR_CODE,o.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})}))},updateKeySession:function(e,t){var i=e.session;_.isClearKey(p)&&(t=t.toJWK()),i.update(t).catch((function(t){n.trigger(r.KEY_ERROR,{data:new s.default(o.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)})}))},loadKeySession:function(e,t,i){if(!p||!g)throw new Error("Can not load sessions until you have selected a key system");for(var a=0;a<v.length;a++)if(e===v[a].sessionId)return void f.warn("DRM: Ignoring session ID because we have already seen it!");var u=g.createSession(i),l=S(u,t,i,e);u.load(e).then((function(t){t?(f.debug("DRM: Session loaded.  SessionID = "+l.getSessionID()),n.trigger(r.KEY_SESSION_CREATED,{data:l})):(E(l),n.trigger(r.KEY_SESSION_CREATED,{data:null,error:new s.default(o.default.KEY_SESSION_CREATED_ERROR_CODE,o.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+e+")")}))})).catch((function(t){E(l),n.trigger(r.KEY_SESSION_CREATED,{data:null,error:new s.default(o.default.KEY_SESSION_CREATED_ERROR_CODE,o.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+e+")! "+t.name)})}))},removeKeySession:function(e){e.session.remove().then((function(){f.debug("DRM: Session removed.  SessionID = "+e.getSessionID()),n.trigger(r.KEY_SESSION_REMOVED,{data:e.getSessionID()})}),(function(t){n.trigger(r.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionID()+"). "+t.name})}))},closeKeySession:function(e){b(e).catch((function(t){E(e),n.trigger(r.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionID()+") "+t.name})}))},stop:function(){for(var e=void 0,t=0;t<v.length;t++)(e=v[t]).getUsable()||b(e).catch((function(){E(e)}))},reset:function(){var e=v.length,t=void 0;0!==e?function(){for(var i=function(e){E(e),0===v.length&&(m?(m.removeEventListener("encrypted",y),m.setMediaKeys(null).then((function(){n.trigger(r.TEARDOWN_COMPLETE)}))):n.trigger(r.TEARDOWN_COMPLETE))},a=0;a<e;a++)!function(e){t.session.closed.then((function(){i(e)})),b(t).catch((function(){i(e)}))}(t=v[a])}():n.trigger(r.TEARDOWN_COMPLETE)}},f=d.getLogger(h),p=null,m=null,g=null,v=[],_=(0,i.default)(t).getInstance(),y={handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;n.trigger(r.NEED_KEY,{key:new a.default(t,e.initDataType)})}}}},h}d.__dashjs_factory_name="ProtectionModel_21Jan2015",t.default=dashjs.FactoryMaker.getClassFactory(d),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(119)),a=r(n(165)),o=r(n(26)),s=r(n(97)),u=r(n(166)),l=r(n(162)),c=r(n(167));function d(e){e=e||{};var t=this.context,n=e.eventBus,r=e.events,d=e.debug,h=e.api,f=void 0,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0;function T(){try{for(var e=0;e<_.length;e++)S(_[e]);m&&m.removeEventListener(h.needkey,b),n.trigger(r.TEARDOWN_COMPLETE)}catch(e){n.trigger(r.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function S(e){var t=e.session;t.removeEventListener(h.error,e),t.removeEventListener(h.message,e),t.removeEventListener(h.ready,e),t.removeEventListener(h.close,e);for(var n=0;n<_.length;n++)if(_[n]===e){_.splice(n,1);break}t[h.release]()}function w(){var e=null,t=function(){m.removeEventListener("loadedmetadata",e),m[h.setMediaKeys](v),n.trigger(r.VIDEO_ELEMENT_SELECTED)};m.readyState>=1?t():(e=t.bind(this),m.addEventListener("loadedmetadata",e))}return f={getAllInitData:function(){for(var e=[],t=0;t<_.length;t++)e.push(_[t].initData);return e},requestKeySystemAccess:function(e){for(var t=!1,i=0;i<e.length;i++)for(var a=e[i].ks.systemString,o=e[i].configs,s=null,u=null,d=0;d<o.length;d++){var f=o[d].audioCapabilities,p=o[d].videoCapabilities;if(f&&0!==f.length){s=[];for(var m=0;m<f.length;m++)window[h.MediaKeys].isTypeSupported(a,f[m].contentType)&&s.push(f[m])}if(p&&0!==p.length){u=[];for(var g=0;g<p.length;g++)window[h.MediaKeys].isTypeSupported(a,p[g].contentType)&&u.push(p[g])}if(!(!s&&!u||s&&0===s.length||u&&0===u.length)){t=!0;var v=new l.default(s,u),y=E.getKeySystemBySystemString(a);n.trigger(r.KEY_SYSTEM_ACCESS_COMPLETE,{data:new c.default(y,v)});break}}t||n.trigger(r.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return g},selectKeySystem:function(e){try{v=e.mediaKeys=new window[h.MediaKeys](e.keySystem.systemString),g=e.keySystem,y=e,m&&w(),n.trigger(r.INTERNAL_KEY_SYSTEM_SELECTED)}catch(e){n.trigger(r.INTERNAL_KEY_SYSTEM_SELECTED,{error:"Error selecting keys system ("+g.systemString+")! Could not create MediaKeys -- TODO"})}},setMediaElement:function(e){m!==e&&(m&&m.removeEventListener(h.needkey,b),(m=e)&&(m.addEventListener(h.needkey,b),v&&w()))},createKeySession:function(e,t,i,a){if(!g||!v||!y)throw new Error("Can not create sessions until you have selected a key system");var l=null;if(y.ksConfiguration.videoCapabilities&&y.ksConfiguration.videoCapabilities.length>0&&(l=y.ksConfiguration.videoCapabilities[0]),null===l&&y.ksConfiguration.audioCapabilities&&y.ksConfiguration.audioCapabilities.length>0&&(l=y.ksConfiguration.audioCapabilities[0]),null===l)throw new Error("Can not create sessions for unknown content types.");var c=l.contentType,d=v.createSession(c,new Uint8Array(e),a?new Uint8Array(a):null),f=function(e,t){return{session:e,initData:t,getSessionID:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case h.error:var t="KeyError";n.trigger(r.KEY_ERROR,{data:new o.default(s.default.MEDIA_KEYERR_CODE,t,this)});break;case h.message:var i=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;n.trigger(r.INTERNAL_KEY_MESSAGE,{data:new u.default(this,i,e.destinationURL)});break;case h.ready:p.debug("DRM: Key added."),n.trigger(r.KEY_ADDED);break;case h.close:p.debug("DRM: Session closed.  SessionID = "+this.getSessionID()),n.trigger(r.KEY_SESSION_CLOSED,{data:this.getSessionID()})}}}}(d,e);d.addEventListener(h.error,f),d.addEventListener(h.message,f),d.addEventListener(h.ready,f),d.addEventListener(h.close,f),_.push(f),p.debug("DRM: Session created.  SessionID = "+f.getSessionID()),n.trigger(r.KEY_SESSION_CREATED,{data:f})},updateKeySession:function(e,t){var n=e.session;E.isClearKey(g)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t))},closeKeySession:S,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:T,reset:T},p=d.getLogger(f),m=null,g=null,v=null,y=null,_=[],E=(0,i.default)(t).getInstance(),b={handleEvent:function(e){switch(e.type){case h.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;n.trigger(r.NEED_KEY,{key:new a.default(t,"cenc")})}}}},f}d.__dashjs_factory_name="ProtectionModel_3Feb2014",t.default=dashjs.FactoryMaker.getClassFactory(d),e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(119)),a=r(n(165)),o=r(n(26)),s=r(n(166)),u=r(n(162)),l=r(n(167)),c=r(n(97));function d(e){e=e||{};var t=this.context,n=e.eventBus,r=e.events,d=e.debug,h=e.api,f=e.errHandler,p=void 0,m=void 0,g=void 0,v=void 0,y=void 0,_=void 0,b=void 0,E=void 0,T=void 0;function S(){g&&x();for(var e=0;e<b.length;e++)w(b[e]);n.trigger(r.TEARDOWN_COMPLETE)}function w(e){try{g[h.cancelKeyRequest](v.systemString,e.sessionID)}catch(t){n.trigger(r.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionID+") "+t.message})}}function A(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionID==t)return e[r];return null}return null}function x(){g.removeEventListener(h.keyerror,T),g.removeEventListener(h.needkey,T),g.removeEventListener(h.keymessage,T),g.removeEventListener(h.keyadded,T)}return p={getAllInitData:function(){for(var e=[],t=0;t<_.length;t++)e.push(_[t].initData);for(t=0;t<b.length;t++)e.push(b[t].initData);return e},requestKeySystemAccess:function(e){var t=g;t||(t=document.createElement("video"));for(var i=!1,a=0;a<e.length;a++)for(var o=e[a].ks.systemString,s=e[a].configs,c=null,d=null,h=0;h<s.length;h++){var f=s[h].videoCapabilities;if(f&&0!==f.length){d=[];for(var p=0;p<f.length;p++)""!==t.canPlayType(f[p].contentType,o)&&d.push(f[p])}if(d&&(!d||0!==d.length)){i=!0;var m=new u.default(c,d),v=y.getKeySystemBySystemString(o);n.trigger(r.KEY_SYSTEM_ACCESS_COMPLETE,{data:new l.default(v,m)});break}}i||n.trigger(r.KEY_SYSTEM_ACCESS_COMPLETE,{error:"Key system access denied! -- No valid audio/video content configurations detected!"})},getKeySystem:function(){return v},selectKeySystem:function(e){v=e.keySystem,n.trigger(r.INTERNAL_KEY_SYSTEM_SELECTED)},setMediaElement:function(e){if(g!==e){if(g){x();for(var t=0;t<b.length;t++)w(b[t]);b=[]}(g=e)&&(g.addEventListener(h.keyerror,T),g.addEventListener(h.needkey,T),g.addEventListener(h.keymessage,T),g.addEventListener(h.keyadded,T),n.trigger(r.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!v)throw new Error("Can not create sessions until you have selected a key system");if(E||0===b.length){var t={sessionID:null,initData:e,getSessionID:function(){return this.sessionID},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return _.push(t),g[h.generateKeyRequest](v.systemString,new Uint8Array(e)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var n=e.sessionID;if(y.isClearKey(v))for(var r=0;r<t.keyPairs.length;r++)g[h.addKey](v.systemString,t.keyPairs[r].key,t.keyPairs[r].keyID,n);else g[h.addKey](v.systemString,new Uint8Array(t),new Uint8Array(e.initData),n)},closeKeySession:w,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:S,reset:S},m=d.getLogger(p),g=null,v=null,_=[],b=[],y=(0,i.default)(t).getInstance(),T={handleEvent:function(e){var t=null;switch(e.type){case h.needkey:var i=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;n.trigger(r.NEED_KEY,{key:new a.default(i,"cenc")});break;case h.keyerror:if((t=A(b,e.sessionId))||(t=A(_,e.sessionId)),t){var u=c.default.MEDIA_KEYERR_CODE,l="";switch(e.errorCode.code){case 1:u=c.default.MEDIA_KEYERR_UNKNOWN_CODE,l+="MEDIA_KEYERR_UNKNOWN - "+c.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:u=c.default.MEDIA_KEYERR_CLIENT_CODE,l+="MEDIA_KEYERR_CLIENT - "+c.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:u=c.default.MEDIA_KEYERR_SERVICE_CODE,l+="MEDIA_KEYERR_SERVICE - "+c.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:u=c.default.MEDIA_KEYERR_OUTPUT_CODE,l+="MEDIA_KEYERR_OUTPUT - "+c.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:u=c.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,l+="MEDIA_KEYERR_HARDWARECHANGE - "+c.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:u=c.default.MEDIA_KEYERR_DOMAIN_CODE,l+="MEDIA_KEYERR_DOMAIN - "+c.default.MEDIA_KEYERR_DOMAIN_MESSAGE}l+="  System Code = "+e.systemCode,n.trigger(r.KEY_ERROR,{data:new o.default(u,l,t)})}else m.error("No session token found for key error");break;case h.keyadded:(t=A(b,e.sessionId))||(t=A(_,e.sessionId)),t?(m.debug("DRM: Key added."),n.trigger(r.KEY_ADDED,{data:t})):m.debug("No session token found for key added");break;case h.keymessage:if((E=null!==e.sessionId&&void 0!==e.sessionId)?!(t=A(b,e.sessionId))&&_.length>0&&(t=_.shift(),b.push(t),t.sessionID=e.sessionId,n.trigger(r.KEY_SESSION_CREATED,{data:t})):_.length>0&&(t=_.shift(),b.push(t),0!==_.length&&(f.mediaKeyMessageError(c.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE),f.error(new o.default(c.default.MEDIA_KEY_MESSAGE_ERROR_CODE,c.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE)))),t){var d=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=d,n.trigger(r.INTERNAL_KEY_MESSAGE,{data:new s.default(t,d,e.defaultURL)})}else m.warn("No session token found for key message")}}},p}d.__dashjs_factory_name="ProtectionModel_01b",t.default=dashjs.FactoryMaker.getClassFactory(d),e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(206),a=(r=i)&&r.__esModule?r:{default:r};var o=function(){var e="application/dash+xml",t=void 0;function n(n,r,i){if(!n||!/^VIDEO$/i.test(n.nodeName))return null;if(n._dashjs_player)return n._dashjs_player;var o=void 0,s=n.id||n.name||"video element";if(!(r=r||[].slice.call(n.querySelectorAll("source")).filter((function(t){return t.type==e}))[0])&&n.src)(r=document.createElement("source")).src=n.src;else if(!r&&!n.src)return null;return i=i||{},(o=(0,a.default)(i).create()).initialize(n,r.src,n.autoplay),t||(t=o.getDebug().getLogger()),t.debug("Converted "+s+" to dash.js player and added content: "+r.src),n._dashjs_player=o,o}function r(e){for(var t=!0;t;){var n=e;if(t=!1,/^VIDEO$/i.test(n.nodeName))return n;e=n.parentNode,t=!0}}return{create:n,createAll:function(e,t){var i=[];e=e||"[data-dashjs-player]";for(var a=(t=t||document).querySelectorAll(e),o=0;o<a.length;o++){var s=n(a[o],null);i.push(s)}var u=t.querySelectorAll('source[type="application/dash+xml"]');for(o=0;o<u.length;o++){s=n(r(u[o]),null);i.push(s)}return i}}}(),s=void 0;!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?o.createAll():s=window.setInterval((function(){window.dashjs&&(window.clearInterval(s),o.createAll())}),500):window.addEventListener("load",(function e(){window.removeEventListener("load",e),o.createAll()}))),t.default=o,e.exports=t.default},function(e,t,n){"use strict";(function(e){var t=n(5),r=n(99),i=n.n(r);function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function u(e,t){return e(t={exports:{}},t.exports),t.exports}var l=u((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),c={}.hasOwnProperty,d=function(e,t){return c.call(e,t)},h=function(e){try{return!!e()}catch(e){return!0}},f=!h((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),p=u((function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)})),m=(p.version,function(e){return"object"==typeof e?null!==e:"function"==typeof e}),g=function(e){if(!m(e))throw TypeError(e+" is not an object!");return e},v=l.document,y=m(v)&&m(v.createElement),_=function(e){return y?v.createElement(e):{}},b=!f&&!h((function(){return 7!=Object.defineProperty(_("div"),"a",{get:function(){return 7}}).a})),E=function(e,t){if(!m(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!m(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},T=Object.defineProperty,S={f:f?Object.defineProperty:function(e,t,n){if(g(e),t=E(t,!0),g(n),b)try{return T(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},w=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},A=f?function(e,t,n){return S.f(e,t,w(1,n))}:function(e,t,n){return e[t]=n,e},x=0,M=Math.random(),C=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++x+M).toString(36))},R=u((function(e){var t="__core-js_shared__",n=l[t]||(l[t]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:p.version,mode:"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})})),I=R("native-function-to-string",Function.toString),O=u((function(e){var t=C("src"),n="toString",r=(""+I).split(n);p.inspectSource=function(e){return I.call(e)},(e.exports=function(e,n,i,a){var o="function"==typeof i;o&&(d(i,"name")||A(i,"name",n)),e[n]!==i&&(o&&(d(i,t)||A(i,t,e[n]?""+e[n]:r.join(String(n)))),e===l?e[n]=i:a?e[n]?e[n]=i:A(e,n,i):(delete e[n],A(e,n,i)))})(Function.prototype,n,(function(){return"function"==typeof this&&this[t]||I.call(this)}))})),D=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},P=function(e,t,n){if(D(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},L=function(e,t,n){var r,i,a,o,s=e&L.F,u=e&L.G,c=e&L.S,d=e&L.P,h=e&L.B,f=u?l:c?l[t]||(l[t]={}):(l[t]||{}).prototype,m=u?p:p[t]||(p[t]={}),g=m.prototype||(m.prototype={});for(r in u&&(n=t),n)a=((i=!s&&f&&void 0!==f[r])?f:n)[r],o=h&&i?P(a,l):d&&"function"==typeof a?P(Function.call,a):a,f&&O(f,r,a,e&L.U),m[r]!=a&&A(m,r,o),d&&g[r]!=a&&(g[r]=a)};l.core=p,L.F=1,L.G=2,L.S=4,L.P=8,L.B=16,L.W=32,L.U=64,L.R=128;var N=L,k=u((function(e){var t=C("meta"),n=S.f,r=0,i=Object.isExtensible||function(){return!0},a=!h((function(){return i(Object.preventExtensions({}))})),o=function(e){n(e,t,{value:{i:"O"+ ++r,w:{}}})},s=e.exports={KEY:t,NEED:!1,fastKey:function(e,n){if(!m(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!d(e,t)){if(!i(e))return"F";if(!n)return"E";o(e)}return e[t].i},getWeak:function(e,n){if(!d(e,t)){if(!i(e))return!0;if(!n)return!1;o(e)}return e[t].w},onFreeze:function(e){return a&&s.NEED&&i(e)&&!d(e,t)&&o(e),e}}})),F=(k.KEY,k.NEED,k.fastKey,k.getWeak,k.onFreeze,u((function(e){var t=R("wks"),n=l.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:C)("Symbol."+e))}).store=t}))),B=S.f,U=F("toStringTag"),j=function(e,t,n){e&&!d(e=n?e:e.prototype,U)&&B(e,U,{configurable:!0,value:t})},G={f:F},H=S.f,V=function(e){var t=p.Symbol||(p.Symbol=l.Symbol||{});"_"==e.charAt(0)||e in t||H(t,e,{value:G.f(e)})},z={}.toString,W=function(e){return z.call(e).slice(8,-1)},q=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==W(e)?e.split(""):Object(e)},Y=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},K=function(e){return q(Y(e))},X=Math.ceil,Q=Math.floor,Z=function(e){return isNaN(e=+e)?0:(e>0?Q:X)(e)},J=Math.min,$=function(e){return e>0?J(Z(e),9007199254740991):0},ee=Math.max,te=Math.min,ne=function(e,t){return(e=Z(e))<0?ee(e+t,0):te(e,t)},re=function(e){return function(t,n,r){var i,a=K(t),o=$(a.length),s=ne(r,o);if(e&&n!=n){for(;o>s;)if((i=a[s++])!=i)return!0}else for(;o>s;s++)if((e||s in a)&&a[s]===n)return e||s||0;return!e&&-1}},ie=R("keys"),ae=function(e){return ie[e]||(ie[e]=C(e))},oe=re(!1),se=ae("IE_PROTO"),ue=function(e,t){var n,r=K(e),i=0,a=[];for(n in r)n!=se&&d(r,n)&&a.push(n);for(;t.length>i;)d(r,n=t[i++])&&(~oe(a,n)||a.push(n));return a},le="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ce=Object.keys||function(e){return ue(e,le)},de={f:Object.getOwnPropertySymbols},he={f:{}.propertyIsEnumerable},fe=Array.isArray||function(e){return"Array"==W(e)},pe=f?Object.defineProperties:function(e,t){g(e);for(var n,r=ce(t),i=r.length,a=0;i>a;)S.f(e,n=r[a++],t[n]);return e},me=l.document,ge=me&&me.documentElement,ve=ae("IE_PROTO"),ye=function(){},_e=function(){var e,t=_("iframe"),n=le.length;for(t.style.display="none",ge.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),_e=e.F;n--;)delete _e.prototype[le[n]];return _e()},be=Object.create||function(e,t){var n;return null!==e?(ye.prototype=g(e),n=new ye,ye.prototype=null,n[ve]=e):n=_e(),void 0===t?n:pe(n,t)},Ee=le.concat("length","prototype"),Te={f:Object.getOwnPropertyNames||function(e){return ue(e,Ee)}},Se=Te.f,we={}.toString,Ae="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],xe={f:function(e){return Ae&&"[object Window]"==we.call(e)?function(e){try{return Se(e)}catch(e){return Ae.slice()}}(e):Se(K(e))}},Me=Object.getOwnPropertyDescriptor,Ce={f:f?Me:function(e,t){if(e=K(e),t=E(t,!0),b)try{return Me(e,t)}catch(e){}if(d(e,t))return w(!he.f.call(e,t),e[t])}},Re=k.KEY,Ie=Ce.f,Oe=S.f,De=xe.f,Pe=l.Symbol,Le=l.JSON,Ne=Le&&Le.stringify,ke=F("_hidden"),Fe=F("toPrimitive"),Be={}.propertyIsEnumerable,Ue=R("symbol-registry"),je=R("symbols"),Ge=R("op-symbols"),He=Object.prototype,Ve="function"==typeof Pe,ze=l.QObject,We=!ze||!ze.prototype||!ze.prototype.findChild,qe=f&&h((function(){return 7!=be(Oe({},"a",{get:function(){return Oe(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=Ie(He,t);r&&delete He[t],Oe(e,t,n),r&&e!==He&&Oe(He,t,r)}:Oe,Ye=function(e){var t=je[e]=be(Pe.prototype);return t._k=e,t},Ke=Ve&&"symbol"==typeof Pe.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof Pe},Xe=function(e,t,n){return e===He&&Xe(Ge,t,n),g(e),t=E(t,!0),g(n),d(je,t)?(n.enumerable?(d(e,ke)&&e[ke][t]&&(e[ke][t]=!1),n=be(n,{enumerable:w(0,!1)})):(d(e,ke)||Oe(e,ke,w(1,{})),e[ke][t]=!0),qe(e,t,n)):Oe(e,t,n)},Qe=function(e,t){g(e);for(var n,r=function(e){var t=ce(e),n=de.f;if(n)for(var r,i=n(e),a=he.f,o=0;i.length>o;)a.call(e,r=i[o++])&&t.push(r);return t}(t=K(t)),i=0,a=r.length;a>i;)Xe(e,n=r[i++],t[n]);return e},Ze=function(e){var t=Be.call(this,e=E(e,!0));return!(this===He&&d(je,e)&&!d(Ge,e))&&(!(t||!d(this,e)||!d(je,e)||d(this,ke)&&this[ke][e])||t)},Je=function(e,t){if(e=K(e),t=E(t,!0),e!==He||!d(je,t)||d(Ge,t)){var n=Ie(e,t);return!n||!d(je,t)||d(e,ke)&&e[ke][t]||(n.enumerable=!0),n}},$e=function(e){for(var t,n=De(K(e)),r=[],i=0;n.length>i;)d(je,t=n[i++])||t==ke||t==Re||r.push(t);return r},et=function(e){for(var t,n=e===He,r=De(n?Ge:K(e)),i=[],a=0;r.length>a;)!d(je,t=r[a++])||n&&!d(He,t)||i.push(je[t]);return i};Ve||(O((Pe=function(){if(this instanceof Pe)throw TypeError("Symbol is not a constructor!");var e=C(arguments.length>0?arguments[0]:void 0),t=function(n){this===He&&t.call(Ge,n),d(this,ke)&&d(this[ke],e)&&(this[ke][e]=!1),qe(this,e,w(1,n))};return f&&We&&qe(He,e,{configurable:!0,set:t}),Ye(e)}).prototype,"toString",(function(){return this._k})),Ce.f=Je,S.f=Xe,Te.f=xe.f=$e,he.f=Ze,de.f=et,f&&O(He,"propertyIsEnumerable",Ze,!0),G.f=function(e){return Ye(F(e))}),N(N.G+N.W+N.F*!Ve,{Symbol:Pe});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;tt.length>nt;)F(tt[nt++]);for(var rt=ce(F.store),it=0;rt.length>it;)V(rt[it++]);N(N.S+N.F*!Ve,"Symbol",{for:function(e){return d(Ue,e+="")?Ue[e]:Ue[e]=Pe(e)},keyFor:function(e){if(!Ke(e))throw TypeError(e+" is not a symbol!");for(var t in Ue)if(Ue[t]===e)return t},useSetter:function(){We=!0},useSimple:function(){We=!1}}),N(N.S+N.F*!Ve,"Object",{create:function(e,t){return void 0===t?be(e):Qe(be(e),t)},defineProperty:Xe,defineProperties:Qe,getOwnPropertyDescriptor:Je,getOwnPropertyNames:$e,getOwnPropertySymbols:et}),Le&&N(N.S+N.F*(!Ve||h((function(){var e=Pe();return"[null]"!=Ne([e])||"{}"!=Ne({a:e})||"{}"!=Ne(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(m(t)||void 0!==e)&&!Ke(e))return fe(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Ke(t))return t}),r[1]=t,Ne.apply(Le,r)}}),Pe.prototype[Fe]||A(Pe.prototype,Fe,Pe.prototype.valueOf),j(Pe,"Symbol"),j(Math,"Math",!0),j(l.JSON,"JSON",!0),N(N.S,"Object",{create:be}),N(N.S+N.F*!f,"Object",{defineProperty:S.f}),N(N.S+N.F*!f,"Object",{defineProperties:pe});var at=function(e,t){var n=(p.Object||{})[e]||Object[e],r={};r[e]=t(n),N(N.S+N.F*h((function(){n(1)})),"Object",r)},ot=Ce.f;at("getOwnPropertyDescriptor",(function(){return function(e,t){return ot(K(e),t)}}));var st=function(e){return Object(Y(e))},ut=ae("IE_PROTO"),lt=Object.prototype,ct=Object.getPrototypeOf||function(e){return e=st(e),d(e,ut)?e[ut]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?lt:null};at("getPrototypeOf",(function(){return function(e){return ct(st(e))}})),at("keys",(function(){return function(e){return ce(st(e))}})),at("getOwnPropertyNames",(function(){return xe.f}));var dt=k.onFreeze;at("freeze",(function(e){return function(t){return e&&m(t)?e(dt(t)):t}}));var ht=k.onFreeze;at("seal",(function(e){return function(t){return e&&m(t)?e(ht(t)):t}}));var ft=k.onFreeze;at("preventExtensions",(function(e){return function(t){return e&&m(t)?e(ft(t)):t}})),at("isFrozen",(function(e){return function(t){return!m(t)||!!e&&e(t)}})),at("isSealed",(function(e){return function(t){return!m(t)||!!e&&e(t)}})),at("isExtensible",(function(e){return function(t){return!!m(t)&&(!e||e(t))}}));var pt=Object.assign,mt=!pt||h((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=pt({},e)[n]||Object.keys(pt({},t)).join("")!=r}))?function(e,t){for(var n=st(e),r=arguments.length,i=1,a=de.f,o=he.f;r>i;)for(var s,u=q(arguments[i++]),l=a?ce(u).concat(a(u)):ce(u),c=l.length,d=0;c>d;)o.call(u,s=l[d++])&&(n[s]=u[s]);return n}:pt;N(N.S+N.F,"Object",{assign:mt});var gt=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};N(N.S,"Object",{is:gt});var vt=function(e,t){if(g(e),!m(t)&&null!==t)throw TypeError(t+": can't set as prototype!")},yt={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=P(Function.call,Ce.f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return vt(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:vt};N(N.S,"Object",{setPrototypeOf:yt.set});var _t=F("toStringTag"),bt="Arguments"==W(function(){return arguments}()),Et=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),_t))?n:bt?W(t):"Object"==(r=W(t))&&"function"==typeof t.callee?"Arguments":r},Tt={};Tt[F("toStringTag")]="z",Tt+""!="[object z]"&&O(Object.prototype,"toString",(function(){return"[object "+Et(this)+"]"}),!0);var St=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)},wt=[].slice,At={},xt=function(e,t,n){if(!(t in At)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";At[t]=Function("F,a","return new F("+r.join(",")+")")}return At[t](e,n)},Mt=Function.bind||function(e){var t=D(this),n=wt.call(arguments,1),r=function(){var i=n.concat(wt.call(arguments));return this instanceof r?xt(t,i.length,i):St(t,i,e)};return m(t.prototype)&&(r.prototype=t.prototype),r};N(N.P,"Function",{bind:Mt});var Ct=S.f,Rt=Function.prototype,It=/^\s*function ([^ (]*)/,Ot="name";Ot in Rt||f&&Ct(Rt,Ot,{configurable:!0,get:function(){try{return(""+this).match(It)[1]}catch(e){return""}}});var Dt=F("hasInstance"),Pt=Function.prototype;Dt in Pt||S.f(Pt,Dt,{value:function(e){if("function"!=typeof this||!m(e))return!1;if(!m(this.prototype))return e instanceof this;for(;e=ct(e);)if(this.prototype===e)return!0;return!1}});var Lt="\t\n\v\f\r \u2028\u2029\ufeff",Nt="["+Lt+"]",kt=RegExp("^"+Nt+Nt+"*"),Ft=RegExp(Nt+Nt+"*$"),Bt=function(e,t,n){var r={},i=h((function(){return!!Lt[e]()||""!=""[e]()})),a=r[e]=i?t(Ut):Lt[e];n&&(r[n]=a),N(N.P+N.F*i,"String",r)},Ut=Bt.trim=function(e,t){return e=String(Y(e)),1&t&&(e=e.replace(kt,"")),2&t&&(e=e.replace(Ft,"")),e},jt=Bt,Gt=l.parseInt,Ht=jt.trim,Vt=/^[-+]?0[xX]/,zt=8!==Gt(Lt+"08")||22!==Gt(Lt+"0x16")?function(e,t){var n=Ht(String(e),3);return Gt(n,t>>>0||(Vt.test(n)?16:10))}:Gt;N(N.G+N.F*(parseInt!=zt),{parseInt:zt});var Wt=l.parseFloat,qt=jt.trim,Yt=1/Wt(Lt+"-0")!=-1/0?function(e){var t=qt(String(e),3),n=Wt(t);return 0===n&&"-"==t.charAt(0)?-0:n}:Wt;N(N.G+N.F*(parseFloat!=Yt),{parseFloat:Yt});var Kt=yt.set,Xt=function(e,t,n){var r,i=t.constructor;return i!==n&&"function"==typeof i&&(r=i.prototype)!==n.prototype&&m(r)&&Kt&&Kt(e,r),e},Qt=Te.f,Zt=Ce.f,Jt=S.f,$t=jt.trim,en="Number",tn=l.Number,nn=tn,rn=tn.prototype,an=W(be(rn))==en,on="trim"in String.prototype,sn=function(e){var t=E(e,!1);if("string"==typeof t&&t.length>2){var n,r,i,a=(t=on?t.trim():$t(t,3)).charCodeAt(0);if(43===a||45===a){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===a){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var o,s=t.slice(2),u=0,l=s.length;u<l;u++)if((o=s.charCodeAt(u))<48||o>i)return NaN;return parseInt(s,r)}}return+t};if(!tn(" 0o1")||!tn("0b1")||tn("+0x1")){tn=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof tn&&(an?h((function(){rn.valueOf.call(n)})):W(n)!=en)?Xt(new nn(sn(t)),n,tn):sn(t)};for(var un,ln=f?Qt(nn):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),cn=0;ln.length>cn;cn++)d(nn,un=ln[cn])&&!d(tn,un)&&Jt(tn,un,Zt(nn,un));tn.prototype=rn,rn.constructor=tn,O(l,en,tn)}var dn=function(e,t){if("number"!=typeof e&&"Number"!=W(e))throw TypeError(t);return+e},hn=function(e){var t=String(Y(this)),n="",r=Z(e);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n},fn=1..toFixed,pn=Math.floor,mn=[0,0,0,0,0,0],gn="Number.toFixed: incorrect invocation!",vn="0",yn=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*mn[n],mn[n]=r%1e7,r=pn(r/1e7)},_n=function(e){for(var t=6,n=0;--t>=0;)n+=mn[t],mn[t]=pn(n/e),n=n%e*1e7},bn=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==mn[e]){var n=String(mn[e]);t=""===t?n:t+hn.call(vn,7-n.length)+n}return t},En=function(e,t,n){return 0===t?n:t%2==1?En(e,t-1,n*e):En(e*e,t/2,n)};N(N.P+N.F*(!!fn&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!h((function(){fn.call({})}))),"Number",{toFixed:function(e){var t,n,r,i,a=dn(this,gn),o=Z(e),s="",u=vn;if(o<0||o>20)throw RangeError(gn);if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return String(a);if(a<0&&(s="-",a=-a),a>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(a*En(2,69,1))-69)<0?a*En(2,-t,1):a/En(2,t,1),n*=4503599627370496,(t=52-t)>0){for(yn(0,n),r=o;r>=7;)yn(1e7,0),r-=7;for(yn(En(10,r,1),0),r=t-1;r>=23;)_n(1<<23),r-=23;_n(1<<r),yn(1,1),_n(2),u=bn()}else yn(0,n),yn(1<<-t,0),u=bn()+hn.call(vn,o);return u=o>0?s+((i=u.length)<=o?"0."+hn.call(vn,o-i)+u:u.slice(0,i-o)+"."+u.slice(i-o)):s+u}});var Tn=1..toPrecision;N(N.P+N.F*(h((function(){return"1"!==Tn.call(1,void 0)}))||!h((function(){Tn.call({})}))),"Number",{toPrecision:function(e){var t=dn(this,"Number#toPrecision: incorrect invocation!");return void 0===e?Tn.call(t):Tn.call(t,e)}}),N(N.S,"Number",{EPSILON:Math.pow(2,-52)});var Sn=l.isFinite;N(N.S,"Number",{isFinite:function(e){return"number"==typeof e&&Sn(e)}});var wn=Math.floor,An=function(e){return!m(e)&&isFinite(e)&&wn(e)===e};N(N.S,"Number",{isInteger:An}),N(N.S,"Number",{isNaN:function(e){return e!=e}});var xn=Math.abs;N(N.S,"Number",{isSafeInteger:function(e){return An(e)&&xn(e)<=9007199254740991}}),N(N.S,"Number",{MAX_SAFE_INTEGER:9007199254740991}),N(N.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991}),N(N.S+N.F*(Number.parseFloat!=Yt),"Number",{parseFloat:Yt}),N(N.S+N.F*(Number.parseInt!=zt),"Number",{parseInt:zt});var Mn=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)},Cn=Math.sqrt,Rn=Math.acosh;N(N.S+N.F*!(Rn&&710==Math.floor(Rn(Number.MAX_VALUE))&&Rn(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:Mn(e-1+Cn(e-1)*Cn(e+1))}});var In=Math.asinh;N(N.S+N.F*!(In&&1/In(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}});var On=Math.atanh;N(N.S+N.F*!(On&&1/On(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}});var Dn=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1};N(N.S,"Math",{cbrt:function(e){return Dn(e=+e)*Math.pow(Math.abs(e),1/3)}}),N(N.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}});var Pn=Math.exp;N(N.S,"Math",{cosh:function(e){return(Pn(e=+e)+Pn(-e))/2}});var Ln=Math.expm1,Nn=!Ln||Ln(10)>22025.465794806718||Ln(10)<22025.465794806718||-2e-17!=Ln(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:Ln;N(N.S+N.F*(Nn!=Math.expm1),"Math",{expm1:Nn});var kn=Math.pow,Fn=kn(2,-52),Bn=kn(2,-23),Un=kn(2,127)*(2-Bn),jn=kn(2,-126),Gn=Math.fround||function(e){var t,n,r=Math.abs(e),i=Dn(e);return r<jn?i*(r/jn/Bn+1/Fn-1/Fn)*jn*Bn:(n=(t=(1+Bn/Fn)*r)-(t-r))>Un||n!=n?i*(1/0):i*n};N(N.S,"Math",{fround:Gn});var Hn=Math.abs;N(N.S,"Math",{hypot:function(e,t){for(var n,r,i=0,a=0,o=arguments.length,s=0;a<o;)s<(n=Hn(arguments[a++]))?(i=i*(r=s/n)*r+1,s=n):i+=n>0?(r=n/s)*r:n;return s===1/0?1/0:s*Math.sqrt(i)}});var Vn=Math.imul;N(N.S+N.F*h((function(){return-5!=Vn(4294967295,5)||2!=Vn.length})),"Math",{imul:function(e,t){var n=65535,r=+e,i=+t,a=n&r,o=n&i;return 0|a*o+((n&r>>>16)*o+a*(n&i>>>16)<<16>>>0)}}),N(N.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}}),N(N.S,"Math",{log1p:Mn}),N(N.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}}),N(N.S,"Math",{sign:Dn});var zn=Math.exp;N(N.S+N.F*h((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(Nn(e)-Nn(-e))/2:(zn(e-1)-zn(-e-1))*(Math.E/2)}});var Wn=Math.exp;N(N.S,"Math",{tanh:function(e){var t=Nn(e=+e),n=Nn(-e);return t==1/0?1:n==1/0?-1:(t-n)/(Wn(e)+Wn(-e))}}),N(N.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}});var qn=String.fromCharCode,Yn=String.fromCodePoint;N(N.S+N.F*(!!Yn&&1!=Yn.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,i=0;r>i;){if(t=+arguments[i++],ne(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?qn(t):qn(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}}),N(N.S,"String",{raw:function(e){for(var t=K(e.raw),n=$(t.length),r=arguments.length,i=[],a=0;n>a;)i.push(String(t[a++])),a<r&&i.push(String(arguments[a]));return i.join("")}}),jt("trim",(function(e){return function(){return e(this,3)}}));var Kn=function(e){return function(t,n){var r,i,a=String(Y(t)),o=Z(n),s=a.length;return o<0||o>=s?e?"":void 0:(r=a.charCodeAt(o))<55296||r>56319||o+1===s||(i=a.charCodeAt(o+1))<56320||i>57343?e?a.charAt(o):r:e?a.slice(o,o+2):i-56320+(r-55296<<10)+65536}},Xn={},Qn={};A(Qn,F("iterator"),(function(){return this}));var Zn=function(e,t,n){e.prototype=be(Qn,{next:w(1,n)}),j(e,t+" Iterator")},Jn=F("iterator"),$n=!([].keys&&"next"in[].keys()),er="keys",tr="values",nr=function(){return this},rr=function(e,t,n,r,i,a,o){Zn(n,t,r);var s,u,l,c=function(e){if(!$n&&e in p)return p[e];switch(e){case er:case tr:return function(){return new n(this,e)}}return function(){return new n(this,e)}},d=t+" Iterator",h=i==tr,f=!1,p=e.prototype,m=p[Jn]||p["@@iterator"]||i&&p[i],g=m||c(i),v=i?h?c("entries"):g:void 0,y="Array"==t&&p.entries||m;if(y&&(l=ct(y.call(new e)))!==Object.prototype&&l.next&&(j(l,d,!0),"function"!=typeof l[Jn]&&A(l,Jn,nr)),h&&m&&m.name!==tr&&(f=!0,g=function(){return m.call(this)}),($n||f||!p[Jn])&&A(p,Jn,g),Xn[t]=g,Xn[d]=nr,i)if(s={values:h?g:c(tr),keys:a?g:c(er),entries:v},o)for(u in s)u in p||O(p,u,s[u]);else N(N.P+N.F*($n||f),t,s);return s},ir=Kn(!0);rr(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=ir(t,n),this._i+=e.length,{value:e,done:!1})}));var ar=Kn(!1);N(N.P,"String",{codePointAt:function(e){return ar(this,e)}});var or=F("match"),sr=function(e){var t;return m(e)&&(void 0!==(t=e[or])?!!t:"RegExp"==W(e))},ur=function(e,t,n){if(sr(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(Y(e))},lr=F("match"),cr=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[lr]=!1,!"/./"[e](t)}catch(e){}}return!0},dr="endsWith",hr="".endsWith;N(N.P+N.F*cr(dr),"String",{endsWith:function(e){var t=ur(this,e,dr),n=arguments.length>1?arguments[1]:void 0,r=$(t.length),i=void 0===n?r:Math.min($(n),r),a=String(e);return hr?hr.call(t,a,i):t.slice(i-a.length,i)===a}});var fr="includes";N(N.P+N.F*cr(fr),"String",{includes:function(e){return!!~ur(this,e,fr).indexOf(e,arguments.length>1?arguments[1]:void 0)}}),N(N.P,"String",{repeat:hn});var pr="startsWith",mr="".startsWith;N(N.P+N.F*cr(pr),"String",{startsWith:function(e){var t=ur(this,e,pr),n=$(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return mr?mr.call(t,r,n):t.slice(n,n+r.length)===r}});var gr=/"/g,vr=function(e,t,n,r){var i=String(Y(e)),a="<"+t;return""!==n&&(a+=" "+n+'="'+String(r).replace(gr,"&quot;")+'"'),a+">"+i+"</"+t+">"},yr=function(e,t){var n={};n[e]=t(vr),N(N.P+N.F*h((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)};yr("anchor",(function(e){return function(t){return e(this,"a","name",t)}})),yr("big",(function(e){return function(){return e(this,"big","","")}})),yr("blink",(function(e){return function(){return e(this,"blink","","")}})),yr("bold",(function(e){return function(){return e(this,"b","","")}})),yr("fixed",(function(e){return function(){return e(this,"tt","","")}})),yr("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}})),yr("fontsize",(function(e){return function(t){return e(this,"font","size",t)}})),yr("italics",(function(e){return function(){return e(this,"i","","")}})),yr("link",(function(e){return function(t){return e(this,"a","href",t)}})),yr("small",(function(e){return function(){return e(this,"small","","")}})),yr("strike",(function(e){return function(){return e(this,"strike","","")}})),yr("sub",(function(e){return function(){return e(this,"sub","","")}})),yr("sup",(function(e){return function(){return e(this,"sup","","")}})),N(N.S,"Date",{now:function(){return(new Date).getTime()}}),N(N.P+N.F*h((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=st(this),n=E(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}});var _r=Date.prototype.getTime,br=Date.prototype.toISOString,Er=function(e){return e>9?e:"0"+e},Tr=h((function(){return"0385-07-25T07:06:39.999Z"!=br.call(new Date(-50000000000001))}))||!h((function(){br.call(new Date(NaN))}))?function(){if(!isFinite(_r.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+Er(e.getUTCMonth()+1)+"-"+Er(e.getUTCDate())+"T"+Er(e.getUTCHours())+":"+Er(e.getUTCMinutes())+":"+Er(e.getUTCSeconds())+"."+(n>99?n:"0"+Er(n))+"Z"}:br;N(N.P+N.F*(Date.prototype.toISOString!==Tr),"Date",{toISOString:Tr});var Sr=Date.prototype,wr="Invalid Date",Ar="toString",xr=Sr.toString,Mr=Sr.getTime;new Date(NaN)+""!=wr&&O(Sr,Ar,(function(){var e=Mr.call(this);return e==e?xr.call(this):wr}));var Cr="number",Rr=F("toPrimitive"),Ir=Date.prototype;Rr in Ir||A(Ir,Rr,(function(e){if("string"!==e&&e!==Cr&&"default"!==e)throw TypeError("Incorrect hint");return E(g(this),e!=Cr)})),N(N.S,"Array",{isArray:fe});var Or=function(e,t,n,r){try{return r?t(g(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&g(i.call(e)),t}},Dr=F("iterator"),Pr=Array.prototype,Lr=function(e){return void 0!==e&&(Xn.Array===e||Pr[Dr]===e)},Nr=function(e,t,n){t in e?S.f(e,t,w(0,n)):e[t]=n},kr=F("iterator"),Fr=p.getIteratorMethod=function(e){if(null!=e)return e[kr]||e["@@iterator"]||Xn[Et(e)]},Br=F("iterator"),Ur=!1;try{var jr=[7][Br]();jr.return=function(){Ur=!0},Array.from(jr,(function(){throw 2}))}catch(e){}var Gr=function(e,t){if(!t&&!Ur)return!1;var n=!1;try{var r=[7],i=r[Br]();i.next=function(){return{done:n=!0}},r[Br]=function(){return i},e(r)}catch(e){}return n};N(N.S+N.F*!Gr((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,r,i,a=st(e),o="function"==typeof this?this:Array,s=arguments.length,u=s>1?arguments[1]:void 0,l=void 0!==u,c=0,d=Fr(a);if(l&&(u=P(u,s>2?arguments[2]:void 0,2)),null==d||o==Array&&Lr(d))for(n=new o(t=$(a.length));t>c;c++)Nr(n,c,l?u(a[c],c):a[c]);else for(i=d.call(a),n=new o;!(r=i.next()).done;c++)Nr(n,c,l?Or(i,u,[r.value,c],!0):r.value);return n.length=c,n}}),N(N.S+N.F*h((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)Nr(n,e,arguments[e++]);return n.length=t,n}});var Hr=function(e,t){return!!e&&h((function(){t?e.call(null,(function(){}),1):e.call(null)}))},Vr=[].join;N(N.P+N.F*(q!=Object||!Hr(Vr)),"Array",{join:function(e){return Vr.call(K(this),void 0===e?",":e)}});var zr=[].slice;N(N.P+N.F*h((function(){ge&&zr.call(ge)})),"Array",{slice:function(e,t){var n=$(this.length),r=W(this);if(t=void 0===t?n:t,"Array"==r)return zr.call(this,e,t);for(var i=ne(e,n),a=ne(t,n),o=$(a-i),s=new Array(o),u=0;u<o;u++)s[u]="String"==r?this.charAt(i+u):this[i+u];return s}});var Wr=[].sort,qr=[1,2,3];N(N.P+N.F*(h((function(){qr.sort(void 0)}))||!h((function(){qr.sort(null)}))||!Hr(Wr)),"Array",{sort:function(e){return void 0===e?Wr.call(st(this)):Wr.call(st(this),D(e))}});var Yr=F("species"),Kr=function(e,t){return new(function(e){var t;return fe(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!fe(t.prototype)||(t=void 0),m(t)&&null===(t=t[Yr])&&(t=void 0)),void 0===t?Array:t}(e))(t)},Xr=function(e,t){var n=1==e,r=2==e,i=3==e,a=4==e,o=6==e,s=5==e||o,u=t||Kr;return function(t,l,c){for(var d,h,f=st(t),p=q(f),m=P(l,c,3),g=$(p.length),v=0,y=n?u(t,g):r?u(t,0):void 0;g>v;v++)if((s||v in p)&&(h=m(d=p[v],v,f),e))if(n)y[v]=h;else if(h)switch(e){case 3:return!0;case 5:return d;case 6:return v;case 2:y.push(d)}else if(a)return!1;return o?-1:i||a?a:y}},Qr=Xr(0),Zr=Hr([].forEach,!0);N(N.P+N.F*!Zr,"Array",{forEach:function(e){return Qr(this,e,arguments[1])}});var Jr=Xr(1);N(N.P+N.F*!Hr([].map,!0),"Array",{map:function(e){return Jr(this,e,arguments[1])}});var $r=Xr(2);N(N.P+N.F*!Hr([].filter,!0),"Array",{filter:function(e){return $r(this,e,arguments[1])}});var ei=Xr(3);N(N.P+N.F*!Hr([].some,!0),"Array",{some:function(e){return ei(this,e,arguments[1])}});var ti=Xr(4);N(N.P+N.F*!Hr([].every,!0),"Array",{every:function(e){return ti(this,e,arguments[1])}});var ni=function(e,t,n,r,i){D(t);var a=st(e),o=q(a),s=$(a.length),u=i?s-1:0,l=i?-1:1;if(n<2)for(;;){if(u in o){r=o[u],u+=l;break}if(u+=l,i?u<0:s<=u)throw TypeError("Reduce of empty array with no initial value")}for(;i?u>=0:s>u;u+=l)u in o&&(r=t(r,o[u],u,a));return r};N(N.P+N.F*!Hr([].reduce,!0),"Array",{reduce:function(e){return ni(this,e,arguments.length,arguments[1],!1)}}),N(N.P+N.F*!Hr([].reduceRight,!0),"Array",{reduceRight:function(e){return ni(this,e,arguments.length,arguments[1],!0)}});var ri=re(!1),ii=[].indexOf,ai=!!ii&&1/[1].indexOf(1,-0)<0;N(N.P+N.F*(ai||!Hr(ii)),"Array",{indexOf:function(e){return ai?ii.apply(this,arguments)||0:ri(this,e,arguments[1])}});var oi=[].lastIndexOf,si=!!oi&&1/[1].lastIndexOf(1,-0)<0;N(N.P+N.F*(si||!Hr(oi)),"Array",{lastIndexOf:function(e){if(si)return oi.apply(this,arguments)||0;var t=K(this),n=$(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,Z(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}});var ui=[].copyWithin||function(e,t){var n=st(this),r=$(n.length),i=ne(e,r),a=ne(t,r),o=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===o?r:ne(o,r))-a,r-i),u=1;for(a<i&&i<a+s&&(u=-1,a+=s-1,i+=s-1);s-- >0;)a in n?n[i]=n[a]:delete n[i],i+=u,a+=u;return n},li=F("unscopables"),ci=Array.prototype;null==ci[li]&&A(ci,li,{});var di=function(e){ci[li][e]=!0};N(N.P,"Array",{copyWithin:ui}),di("copyWithin");var hi=function(e){for(var t=st(this),n=$(t.length),r=arguments.length,i=ne(r>1?arguments[1]:void 0,n),a=r>2?arguments[2]:void 0,o=void 0===a?n:ne(a,n);o>i;)t[i++]=e;return t};N(N.P,"Array",{fill:hi}),di("fill");var fi=Xr(5),pi="find",mi=!0;pi in[]&&Array(1).find((function(){mi=!1})),N(N.P+N.F*mi,"Array",{find:function(e){return fi(this,e,arguments.length>1?arguments[1]:void 0)}}),di(pi);var gi=Xr(6),vi="findIndex",yi=!0;vi in[]&&Array(1)[vi]((function(){yi=!1})),N(N.P+N.F*yi,"Array",{findIndex:function(e){return gi(this,e,arguments.length>1?arguments[1]:void 0)}}),di(vi);var _i=F("species"),bi=function(e){var t=l[e];f&&t&&!t[_i]&&S.f(t,_i,{configurable:!0,get:function(){return this}})};bi("Array");var Ei=function(e,t){return{value:t,done:!!e}},Ti=rr(Array,"Array",(function(e,t){this._t=K(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,Ei(1)):Ei(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values");Xn.Arguments=Xn.Array,di("keys"),di("values"),di("entries");var Si=function(){var e=g(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},wi=S.f,Ai=Te.f,xi=l.RegExp,Mi=xi,Ci=xi.prototype,Ri=/a/g,Ii=/a/g,Oi=new xi(Ri)!==Ri;if(f&&(!Oi||h((function(){return Ii[F("match")]=!1,xi(Ri)!=Ri||xi(Ii)==Ii||"/a/i"!=xi(Ri,"i")})))){xi=function(e,t){var n=this instanceof xi,r=sr(e),i=void 0===t;return!n&&r&&e.constructor===xi&&i?e:Xt(Oi?new Mi(r&&!i?e.source:e,t):Mi((r=e instanceof xi)?e.source:e,r&&i?Si.call(e):t),n?this:Ci,xi)};for(var Di=function(e){e in xi||wi(xi,e,{configurable:!0,get:function(){return Mi[e]},set:function(t){Mi[e]=t}})},Pi=Ai(Mi),Li=0;Pi.length>Li;)Di(Pi[Li++]);Ci.constructor=xi,xi.prototype=Ci,O(l,"RegExp",xi)}bi("RegExp");var Ni=RegExp.prototype.exec,ki=String.prototype.replace,Fi=Ni,Bi=function(){var e=/a/,t=/b*/g;return Ni.call(e,"a"),Ni.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),Ui=void 0!==/()??/.exec("")[1];(Bi||Ui)&&(Fi=function(e){var t,n,r,i,a=this;return Ui&&(n=new RegExp("^"+a.source+"$(?!\\s)",Si.call(a))),Bi&&(t=a.lastIndex),r=Ni.call(a,e),Bi&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),Ui&&r&&r.length>1&&ki.call(r[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)})),r});var ji=Fi;N({target:"RegExp",proto:!0,forced:ji!==/./.exec},{exec:ji}),f&&"g"!=/./g.flags&&S.f(RegExp.prototype,"flags",{configurable:!0,get:Si});var Gi="toString",Hi=/./.toString,Vi=function(e){O(RegExp.prototype,Gi,e,!0)};h((function(){return"/a/b"!=Hi.call({source:"a",flags:"b"})}))?Vi((function(){var e=g(this);return"/".concat(e.source,"/","flags"in e?e.flags:!f&&e instanceof RegExp?Si.call(e):void 0)})):Hi.name!=Gi&&Vi((function(){return Hi.call(this)}));var zi=Kn(!0),Wi=function(e,t,n){return t+(n?zi(e,t).length:1)},qi=RegExp.prototype.exec,Yi=function(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==Et(e))throw new TypeError("RegExp#exec called on incompatible receiver");return qi.call(e,t)},Ki=F("species"),Xi=!h((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),Qi=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}(),Zi=function(e,t,n){var r=F(e),i=!h((function(){var t={};return t[r]=function(){return 7},7!=""[e](t)})),a=i?!h((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[Ki]=function(){return n}),n[r](""),!t})):void 0;if(!i||!a||"replace"===e&&!Xi||"split"===e&&!Qi){var o=/./[r],s=n(Y,r,""[e],(function(e,t,n,r,a){return t.exec===ji?i&&!a?{done:!0,value:o.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),u=s[0],l=s[1];O(String.prototype,e,u),A(RegExp.prototype,r,2==t?function(e,t){return l.call(e,this,t)}:function(e){return l.call(e,this)})}};Zi("match",1,(function(e,t,n,r){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=r(n,e,this);if(t.done)return t.value;var i=g(e),a=String(this);if(!i.global)return Yi(i,a);var o=i.unicode;i.lastIndex=0;for(var s,u=[],l=0;null!==(s=Yi(i,a));){var c=String(s[0]);u[l]=c,""===c&&(i.lastIndex=Wi(a,$(i.lastIndex),o)),l++}return 0===l?null:u}]}));var Ji=Math.max,$i=Math.min,ea=Math.floor,ta=/\$([$&`']|\d\d?|<[^>]*>)/g,na=/\$([$&`']|\d\d?)/g;Zi("replace",2,(function(e,t,n,r){return[function(r,i){var a=e(this),o=null==r?void 0:r[t];return void 0!==o?o.call(r,a,i):n.call(String(a),r,i)},function(e,t){var a=r(n,e,this,t);if(a.done)return a.value;var o=g(e),s=String(this),u="function"==typeof t;u||(t=String(t));var l=o.global;if(l){var c=o.unicode;o.lastIndex=0}for(var d=[];;){var h=Yi(o,s);if(null===h)break;if(d.push(h),!l)break;""===String(h[0])&&(o.lastIndex=Wi(s,$(o.lastIndex),c))}for(var f,p="",m=0,v=0;v<d.length;v++){h=d[v];for(var y=String(h[0]),_=Ji($i(Z(h.index),s.length),0),b=[],E=1;E<h.length;E++)b.push(void 0===(f=h[E])?f:String(f));var T=h.groups;if(u){var S=[y].concat(b,_,s);void 0!==T&&S.push(T);var w=String(t.apply(void 0,S))}else w=i(y,s,_,b,T,t);_>=m&&(p+=s.slice(m,_)+w,m=_+y.length)}return p+s.slice(m)}];function i(e,t,r,i,a,o){var s=r+e.length,u=i.length,l=na;return void 0!==a&&(a=st(a),l=ta),n.call(o,l,(function(n,o){var l;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(s);case"<":l=a[o.slice(1,-1)];break;default:var c=+o;if(0===c)return n;if(c>u){var d=ea(c/10);return 0===d?n:d<=u?void 0===i[d-1]?o.charAt(1):i[d-1]+o.charAt(1):n}l=i[c-1]}return void 0===l?"":l}))}})),Zi("search",1,(function(e,t,n,r){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=r(n,e,this);if(t.done)return t.value;var i=g(e),a=String(this),o=i.lastIndex;gt(o,0)||(i.lastIndex=0);var s=Yi(i,a);return gt(i.lastIndex,o)||(i.lastIndex=o),null===s?-1:s.index}]}));var ra=F("species"),ia=function(e,t){var n,r=g(e).constructor;return void 0===r||null==(n=g(r)[ra])?t:D(n)},aa=Math.min,oa=[].push,sa=4294967295,ua=!h((function(){RegExp(sa,"y")}));Zi("split",2,(function(e,t,n,r){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!sr(e))return n.call(r,e,t);for(var i,a,o,s=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,c=void 0===t?sa:t>>>0,d=new RegExp(e.source,u+"g");(i=ji.call(d,r))&&!((a=d.lastIndex)>l&&(s.push(r.slice(l,i.index)),i.length>1&&i.index<r.length&&oa.apply(s,i.slice(1)),o=i[0].length,l=a,s.length>=c));)d.lastIndex===i.index&&d.lastIndex++;return l===r.length?!o&&d.test("")||s.push(""):s.push(r.slice(l)),s.length>c?s.slice(0,c):s}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,r){var a=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,a,r):i.call(String(a),n,r)},function(e,t){var a=r(i,e,this,t,i!==n);if(a.done)return a.value;var o=g(e),s=String(this),u=ia(o,RegExp),l=o.unicode,c=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(ua?"y":"g"),d=new u(ua?o:"^(?:"+o.source+")",c),h=void 0===t?sa:t>>>0;if(0===h)return[];if(0===s.length)return null===Yi(d,s)?[s]:[];for(var f=0,p=0,m=[];p<s.length;){d.lastIndex=ua?p:0;var v,y=Yi(d,ua?s:s.slice(p));if(null===y||(v=aa($(d.lastIndex+(ua?0:p)),s.length))===f)p=Wi(s,p,l);else{if(m.push(s.slice(f,p)),m.length===h)return m;for(var _=1;_<=y.length-1;_++)if(m.push(y[_]),m.length===h)return m;p=f=v}}return m.push(s.slice(f)),m}]}));var la,ca,da,ha=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e},fa=u((function(e){var t={},n={},r=e.exports=function(e,r,i,a,o){var s,u,l,c,d=o?function(){return e}:Fr(e),h=P(i,a,r?2:1),f=0;if("function"!=typeof d)throw TypeError(e+" is not iterable!");if(Lr(d)){for(s=$(e.length);s>f;f++)if((c=r?h(g(u=e[f])[0],u[1]):h(e[f]))===t||c===n)return c}else for(l=d.call(e);!(u=l.next()).done;)if((c=Or(l,h,u.value,r))===t||c===n)return c};r.BREAK=t,r.RETURN=n})),pa=l.process,ma=l.setImmediate,ga=l.clearImmediate,va=l.MessageChannel,ya=l.Dispatch,_a=0,ba={},Ea="onreadystatechange",Ta=function(){var e=+this;if(ba.hasOwnProperty(e)){var t=ba[e];delete ba[e],t()}},Sa=function(e){Ta.call(e.data)};ma&&ga||(ma=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return ba[++_a]=function(){St("function"==typeof e?e:Function(e),t)},la(_a),_a},ga=function(e){delete ba[e]},"process"==W(pa)?la=function(e){pa.nextTick(P(Ta,e,1))}:ya&&ya.now?la=function(e){ya.now(P(Ta,e,1))}:va?(da=(ca=new va).port2,ca.port1.onmessage=Sa,la=P(da.postMessage,da,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(la=function(e){l.postMessage(e+"","*")},l.addEventListener("message",Sa,!1)):la=Ea in _("script")?function(e){ge.appendChild(_("script")).onreadystatechange=function(){ge.removeChild(this),Ta.call(e)}}:function(e){setTimeout(P(Ta,e,1),0)});var wa={set:ma,clear:ga},Aa=wa.set,xa=l.MutationObserver||l.WebKitMutationObserver,Ma=l.process,Ca=l.Promise,Ra="process"==W(Ma),Ia=function(){var e,t,n,r=function(){var r,i;for(Ra&&(r=Ma.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(Ra)n=function(){Ma.nextTick(r)};else if(!xa||l.navigator&&l.navigator.standalone)if(Ca&&Ca.resolve){var i=Ca.resolve(void 0);n=function(){i.then(r)}}else n=function(){Aa.call(l,r)};else{var a=!0,o=document.createTextNode("");new xa(r).observe(o,{characterData:!0}),n=function(){o.data=a=!a}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}};function Oa(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=D(t),this.reject=D(n)}var Da,Pa,La,Na,ka={f:function(e){return new Oa(e)}},Fa=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},Ba=l.navigator,Ua=Ba&&Ba.userAgent||"",ja=function(e,t){if(g(e),m(t)&&t.constructor===e)return t;var n=ka.f(e);return(0,n.resolve)(t),n.promise},Ga=function(e,t,n){for(var r in t)O(e,r,t[r],n);return e},Ha=wa.set,Va=Ia(),za="Promise",Wa=l.TypeError,qa=l.process,Ya=qa&&qa.versions,Ka=Ya&&Ya.v8||"",Xa=l.Promise,Qa="process"==Et(qa),Za=function(){},Ja=Pa=ka.f,$a=!!function(){try{var e=Xa.resolve(1),t=(e.constructor={})[F("species")]=function(e){e(Za,Za)};return(Qa||"function"==typeof PromiseRejectionEvent)&&e.then(Za)instanceof t&&0!==Ka.indexOf("6.6")&&-1===Ua.indexOf("Chrome/66")}catch(e){}}(),eo=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},to=function(e,t){if(!e._n){e._n=!0;var n=e._c;Va((function(){for(var r=e._v,i=1==e._s,a=0,o=function(t){var n,a,o,s=i?t.ok:t.fail,u=t.resolve,l=t.reject,c=t.domain;try{s?(i||(2==e._h&&io(e),e._h=1),!0===s?n=r:(c&&c.enter(),n=s(r),c&&(c.exit(),o=!0)),n===t.promise?l(Wa("Promise-chain cycle")):(a=eo(n))?a.call(n,u,l):u(n)):l(r)}catch(e){c&&!o&&c.exit(),l(e)}};n.length>a;)o(n[a++]);e._c=[],e._n=!1,t&&!e._h&&no(e)}))}},no=function(e){Ha.call(l,(function(){var t,n,r,i=e._v,a=ro(e);if(a&&(t=Fa((function(){Qa?qa.emit("unhandledRejection",i,e):(n=l.onunhandledrejection)?n({promise:e,reason:i}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=Qa||ro(e)?2:1),e._a=void 0,a&&t.e)throw t.v}))},ro=function(e){return 1!==e._h&&0===(e._a||e._c).length},io=function(e){Ha.call(l,(function(){var t;Qa?qa.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},ao=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),to(t,!0))},oo=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw Wa("Promise can't be resolved itself");(t=eo(e))?Va((function(){var r={_w:n,_d:!1};try{t.call(e,P(oo,r,1),P(ao,r,1))}catch(e){ao.call(r,e)}})):(n._v=e,n._s=1,to(n,!1))}catch(e){ao.call({_w:n,_d:!1},e)}}};$a||(Xa=function(e){ha(this,Xa,za,"_h"),D(e),Da.call(this);try{e(P(oo,this,1),P(ao,this,1))}catch(e){ao.call(this,e)}},(Da=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=Ga(Xa.prototype,{then:function(e,t){var n=Ja(ia(this,Xa));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=Qa?qa.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&to(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),La=function(){var e=new Da;this.promise=e,this.resolve=P(oo,e,1),this.reject=P(ao,e,1)},ka.f=Ja=function(e){return e===Xa||e===Na?new La(e):Pa(e)}),N(N.G+N.W+N.F*!$a,{Promise:Xa}),j(Xa,za),bi(za),Na=p.Promise,N(N.S+N.F*!$a,za,{reject:function(e){var t=Ja(this);return(0,t.reject)(e),t.promise}}),N(N.S+N.F*!$a,za,{resolve:function(e){return ja(this,e)}}),N(N.S+N.F*!($a&&Gr((function(e){Xa.all(e).catch(Za)}))),za,{all:function(e){var t=this,n=Ja(t),r=n.resolve,i=n.reject,a=Fa((function(){var n=[],a=0,o=1;fa(e,!1,(function(e){var s=a++,u=!1;n.push(void 0),o++,t.resolve(e).then((function(e){u||(u=!0,n[s]=e,--o||r(n))}),i)})),--o||r(n)}));return a.e&&i(a.v),n.promise},race:function(e){var t=this,n=Ja(t),r=n.reject,i=Fa((function(){fa(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}});var so=function(e,t){if(!m(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e},uo=S.f,lo=k.fastKey,co=f?"_s":"size",ho=function(e,t){var n,r=lo(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n},fo={getConstructor:function(e,t,n,r){var i=e((function(e,a){ha(e,i,t,"_i"),e._t=t,e._i=be(null),e._f=void 0,e._l=void 0,e[co]=0,null!=a&&fa(a,n,e[r],e)}));return Ga(i.prototype,{clear:function(){for(var e=so(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[co]=0},delete:function(e){var n=so(this,t),r=ho(n,e);if(r){var i=r.n,a=r.p;delete n._i[r.i],r.r=!0,a&&(a.n=i),i&&(i.p=a),n._f==r&&(n._f=i),n._l==r&&(n._l=a),n[co]--}return!!r},forEach:function(e){so(this,t);for(var n,r=P(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!ho(so(this,t),e)}}),f&&uo(i.prototype,"size",{get:function(){return so(this,t)[co]}}),i},def:function(e,t,n){var r,i,a=ho(e,t);return a?a.v=n:(e._l=a={i:i=lo(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=a),r&&(r.n=a),e[co]++,"F"!==i&&(e._i[i]=a)),e},getEntry:ho,setStrong:function(e,t,n){rr(e,t,(function(e,n){this._t=so(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?Ei(0,"keys"==t?n.k:"values"==t?n.v:[n.k,n.v]):(e._t=void 0,Ei(1))}),n?"entries":"values",!n,!0),bi(t)}},po=function(e,t,n,r,i,a){var o=l[e],s=o,u=i?"set":"add",c=s&&s.prototype,d={},f=function(e){var t=c[e];O(c,e,"delete"==e||"has"==e?function(e){return!(a&&!m(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return a&&!m(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof s&&(a||c.forEach&&!h((function(){(new s).entries().next()})))){var p=new s,g=p[u](a?{}:-0,1)!=p,v=h((function(){p.has(1)})),y=Gr((function(e){new s(e)})),_=!a&&h((function(){for(var e=new s,t=5;t--;)e[u](t,t);return!e.has(-0)}));y||((s=t((function(t,n){ha(t,s,e);var r=Xt(new o,t,s);return null!=n&&fa(n,i,r[u],r),r}))).prototype=c,c.constructor=s),(v||_)&&(f("delete"),f("has"),i&&f("get")),(_||g)&&f(u),a&&c.clear&&delete c.clear}else s=r.getConstructor(t,e,i,u),Ga(s.prototype,n),k.NEED=!0;return j(s,e),d[e]=s,N(N.G+N.W+N.F*(s!=o),d),a||r.setStrong(s,e,i),s},mo="Map",go=po(mo,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=fo.getEntry(so(this,mo),e);return t&&t.v},set:function(e,t){return fo.def(so(this,mo),0===e?0:e,t)}},fo,!0),vo=po("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return fo.def(so(this,"Set"),e=0===e?0:e,e)}},fo),yo=k.getWeak,_o=Xr(5),bo=Xr(6),Eo=0,To=function(e){return e._l||(e._l=new So)},So=function(){this.a=[]},wo=function(e,t){return _o(e.a,(function(e){return e[0]===t}))};So.prototype={get:function(e){var t=wo(this,e);if(t)return t[1]},has:function(e){return!!wo(this,e)},set:function(e,t){var n=wo(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=bo(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}};var Ao={getConstructor:function(e,t,n,r){var i=e((function(e,a){ha(e,i,t,"_i"),e._t=t,e._i=Eo++,e._l=void 0,null!=a&&fa(a,n,e[r],e)}));return Ga(i.prototype,{delete:function(e){if(!m(e))return!1;var n=yo(e);return!0===n?To(so(this,t)).delete(e):n&&d(n,this._i)&&delete n[this._i]},has:function(e){if(!m(e))return!1;var n=yo(e);return!0===n?To(so(this,t)).has(e):n&&d(n,this._i)}}),i},def:function(e,t,n){var r=yo(g(t),!0);return!0===r?To(e).set(t,n):r[e._i]=n,e},ufstore:To},xo=u((function(e){var t,n=Xr(0),r=so,i=!l.ActiveXObject&&"ActiveXObject"in l,a="WeakMap",o=k.getWeak,s=Object.isExtensible,u=Ao.ufstore,c=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(e){if(m(e)){var t=o(e);return!0===t?u(so(this,a)).get(e):t?t[this._i]:void 0}},set:function(e,t){return Ao.def(so(this,a),e,t)}},h=e.exports=po(a,c,d,Ao,!0,!0);r&&i&&(t=Ao.getConstructor(c,a),mt(t.prototype,d),k.NEED=!0,n(["delete","has","get","set"],(function(e){var n=h.prototype,r=n[e];O(n,e,(function(n,i){if(m(n)&&!s(n)){this._f||(this._f=new t);var a=this._f[e](n,i);return"set"==e?this:a}return r.call(this,n,i)}))})))})),Mo="WeakSet";po(Mo,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return Ao.def(so(this,Mo),e,!0)}},Ao,!1,!0);for(var Co,Ro=C("typed_array"),Io=C("view"),Oo=!(!l.ArrayBuffer||!l.DataView),Do=Oo,Po=0,Lo="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");Po<9;)(Co=l[Lo[Po++]])?(A(Co.prototype,Ro,!0),A(Co.prototype,Io,!0)):Do=!1;var No={ABV:Oo,CONSTR:Do,TYPED:Ro,VIEW:Io},ko=function(e){if(void 0===e)return 0;var t=Z(e),n=$(t);if(t!==n)throw RangeError("Wrong length!");return n},Fo=u((function(e,t){var n=Te.f,r=S.f,i="ArrayBuffer",a="DataView",o="Wrong index!",s=l.ArrayBuffer,u=l.DataView,c=l.Math,d=l.RangeError,p=l.Infinity,m=s,g=c.abs,v=c.pow,y=c.floor,_=c.log,b=c.LN2,E="buffer",T="byteLength",w="byteOffset",x=f?"_b":E,M=f?"_l":T,C=f?"_o":w;function R(e,t,n){var r,i,a,o=new Array(n),s=8*n-t-1,u=(1<<s)-1,l=u>>1,c=23===t?v(2,-24)-v(2,-77):0,d=0,h=e<0||0===e&&1/e<0?1:0;for((e=g(e))!=e||e===p?(i=e!=e?1:0,r=u):(r=y(_(e)/b),e*(a=v(2,-r))<1&&(r--,a*=2),(e+=r+l>=1?c/a:c*v(2,1-l))*a>=2&&(r++,a/=2),r+l>=u?(i=0,r=u):r+l>=1?(i=(e*a-1)*v(2,t),r+=l):(i=e*v(2,l-1)*v(2,t),r=0));t>=8;o[d++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;o[d++]=255&r,r/=256,s-=8);return o[--d]|=128*h,o}function I(e,t,n){var r,i=8*n-t-1,a=(1<<i)-1,o=a>>1,s=i-7,u=n-1,l=e[u--],c=127&l;for(l>>=7;s>0;c=256*c+e[u],u--,s-=8);for(r=c&(1<<-s)-1,c>>=-s,s+=t;s>0;r=256*r+e[u],u--,s-=8);if(0===c)c=1-o;else{if(c===a)return r?NaN:l?-p:p;r+=v(2,t),c-=o}return(l?-1:1)*r*v(2,c-t)}function O(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function D(e){return[255&e]}function P(e){return[255&e,e>>8&255]}function L(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function N(e){return R(e,52,8)}function k(e){return R(e,23,4)}function F(e,t,n){r(e.prototype,t,{get:function(){return this[n]}})}function B(e,t,n,r){var i=ko(+n);if(i+t>e[M])throw d(o);var a=e[x]._b,s=i+e[C],u=a.slice(s,s+t);return r?u:u.reverse()}function U(e,t,n,r,i,a){var s=ko(+n);if(s+t>e[M])throw d(o);for(var u=e[x]._b,l=s+e[C],c=r(+i),h=0;h<t;h++)u[l+h]=c[a?h:t-h-1]}if(No.ABV){if(!h((function(){s(1)}))||!h((function(){new s(-1)}))||h((function(){return new s,new s(1.5),new s(NaN),s.name!=i}))){for(var G,H=(s=function(e){return ha(this,s),new m(ko(e))}).prototype=m.prototype,V=n(m),z=0;V.length>z;)(G=V[z++])in s||A(s,G,m[G]);H.constructor=s}var W=new u(new s(2)),q=u.prototype.setInt8;W.setInt8(0,2147483648),W.setInt8(1,2147483649),!W.getInt8(0)&&W.getInt8(1)||Ga(u.prototype,{setInt8:function(e,t){q.call(this,e,t<<24>>24)},setUint8:function(e,t){q.call(this,e,t<<24>>24)}},!0)}else s=function(e){ha(this,s,i);var t=ko(e);this._b=hi.call(new Array(t),0),this[M]=t},u=function(e,t,n){ha(this,u,a),ha(e,s,a);var r=e[M],i=Z(t);if(i<0||i>r)throw d("Wrong offset!");if(i+(n=void 0===n?r-i:$(n))>r)throw d("Wrong length!");this[x]=e,this[C]=i,this[M]=n},f&&(F(s,T,"_l"),F(u,E,"_b"),F(u,T,"_l"),F(u,w,"_o")),Ga(u.prototype,{getInt8:function(e){return B(this,1,e)[0]<<24>>24},getUint8:function(e){return B(this,1,e)[0]},getInt16:function(e){var t=B(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=B(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return O(B(this,4,e,arguments[1]))},getUint32:function(e){return O(B(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return I(B(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return I(B(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){U(this,1,e,D,t)},setUint8:function(e,t){U(this,1,e,D,t)},setInt16:function(e,t){U(this,2,e,P,t,arguments[2])},setUint16:function(e,t){U(this,2,e,P,t,arguments[2])},setInt32:function(e,t){U(this,4,e,L,t,arguments[2])},setUint32:function(e,t){U(this,4,e,L,t,arguments[2])},setFloat32:function(e,t){U(this,4,e,k,t,arguments[2])},setFloat64:function(e,t){U(this,8,e,N,t,arguments[2])}});j(s,i),j(u,a),A(u.prototype,No.VIEW,!0),t.ArrayBuffer=s,t.DataView=u})),Bo=l.ArrayBuffer,Uo=Fo.ArrayBuffer,jo=Fo.DataView,Go=No.ABV&&Bo.isView,Ho=Uo.prototype.slice,Vo=No.VIEW,zo="ArrayBuffer";N(N.G+N.W+N.F*(Bo!==Uo),{ArrayBuffer:Uo}),N(N.S+N.F*!No.CONSTR,zo,{isView:function(e){return Go&&Go(e)||m(e)&&Vo in e}}),N(N.P+N.U+N.F*h((function(){return!new Uo(2).slice(1,void 0).byteLength})),zo,{slice:function(e,t){if(void 0!==Ho&&void 0===t)return Ho.call(g(this),e);for(var n=g(this).byteLength,r=ne(e,n),i=ne(void 0===t?n:t,n),a=new(ia(this,Uo))($(i-r)),o=new jo(this),s=new jo(a),u=0;r<i;)s.setUint8(u++,o.getUint8(r++));return a}}),bi(zo),N(N.G+N.W+N.F*!No.ABV,{DataView:Fo.DataView});var Wo=u((function(e){if(f){var t=l,n=h,r=N,i=No,a=Fo,o=P,s=ha,u=w,c=A,p=Ga,g=Z,v=$,y=ko,_=ne,b=E,T=d,x=Et,M=m,R=st,I=Lr,O=be,D=ct,L=Te.f,k=Fr,B=C,U=F,j=Xr,G=re,H=ia,V=Ti,z=Xn,W=Gr,q=bi,Y=hi,K=ui,X=S,Q=Ce,J=X.f,ee=Q.f,te=t.RangeError,ie=t.TypeError,ae=t.Uint8Array,oe="ArrayBuffer",se="SharedArrayBuffer",ue="BYTES_PER_ELEMENT",le=Array.prototype,ce=a.ArrayBuffer,de=a.DataView,he=j(0),fe=j(2),pe=j(3),me=j(4),ge=j(5),ve=j(6),ye=G(!0),_e=G(!1),Ee=V.values,Se=V.keys,we=V.entries,Ae=le.lastIndexOf,xe=le.reduce,Me=le.reduceRight,Re=le.join,Ie=le.sort,Oe=le.slice,De=le.toString,Pe=le.toLocaleString,Le=U("iterator"),Ne=U("toStringTag"),ke=B("typed_constructor"),Fe=B("def_constructor"),Be=i.CONSTR,Ue=i.TYPED,je=i.VIEW,Ge="Wrong length!",He=j(1,(function(e,t){return Ye(H(e,e[Fe]),t)})),Ve=n((function(){return 1===new ae(new Uint16Array([1]).buffer)[0]})),ze=!!ae&&!!ae.prototype.set&&n((function(){new ae(1).set({})})),We=function(e,t){var n=g(e);if(n<0||n%t)throw te("Wrong offset!");return n},qe=function(e){if(M(e)&&Ue in e)return e;throw ie(e+" is not a typed array!")},Ye=function(e,t){if(!M(e)||!(ke in e))throw ie("It is not a typed array constructor!");return new e(t)},Ke=function(e,t){return Xe(H(e,e[Fe]),t)},Xe=function(e,t){for(var n=0,r=t.length,i=Ye(e,r);r>n;)i[n]=t[n++];return i},Qe=function(e,t,n){J(e,t,{get:function(){return this._d[n]}})},Ze=function(e){var t,n,r,i,a,s,u=R(e),l=arguments.length,c=l>1?arguments[1]:void 0,d=void 0!==c,h=k(u);if(null!=h&&!I(h)){for(s=h.call(u),r=[],t=0;!(a=s.next()).done;t++)r.push(a.value);u=r}for(d&&l>2&&(c=o(c,arguments[2],2)),t=0,n=v(u.length),i=Ye(this,n);n>t;t++)i[t]=d?c(u[t],t):u[t];return i},Je=function(){for(var e=0,t=arguments.length,n=Ye(this,t);t>e;)n[e]=arguments[e++];return n},$e=!!ae&&n((function(){Pe.call(new ae(1))})),et=function(){return Pe.apply($e?Oe.call(qe(this)):qe(this),arguments)},tt={copyWithin:function(e,t){return K.call(qe(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return me(qe(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return Y.apply(qe(this),arguments)},filter:function(e){return Ke(this,fe(qe(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return ge(qe(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ve(qe(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){he(qe(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return _e(qe(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return ye(qe(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return Re.apply(qe(this),arguments)},lastIndexOf:function(e){return Ae.apply(qe(this),arguments)},map:function(e){return He(qe(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return xe.apply(qe(this),arguments)},reduceRight:function(e){return Me.apply(qe(this),arguments)},reverse:function(){for(var e,t=this,n=qe(t).length,r=Math.floor(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t},some:function(e){return pe(qe(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return Ie.call(qe(this),e)},subarray:function(e,t){var n=qe(this),r=n.length,i=_(e,r);return new(H(n,n[Fe]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,v((void 0===t?r:_(t,r))-i))}},nt=function(e,t){return Ke(this,Oe.call(qe(this),e,t))},rt=function(e){qe(this);var t=We(arguments[1],1),n=this.length,r=R(e),i=v(r.length),a=0;if(i+t>n)throw te(Ge);for(;a<i;)this[t+a]=r[a++]},it={entries:function(){return we.call(qe(this))},keys:function(){return Se.call(qe(this))},values:function(){return Ee.call(qe(this))}},at=function(e,t){return M(e)&&e[Ue]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},ot=function(e,t){return at(e,t=b(t,!0))?u(2,e[t]):ee(e,t)},ut=function(e,t,n){return!(at(e,t=b(t,!0))&&M(n)&&T(n,"value"))||T(n,"get")||T(n,"set")||n.configurable||T(n,"writable")&&!n.writable||T(n,"enumerable")&&!n.enumerable?J(e,t,n):(e[t]=n.value,e)};Be||(Q.f=ot,X.f=ut),r(r.S+r.F*!Be,"Object",{getOwnPropertyDescriptor:ot,defineProperty:ut}),n((function(){De.call({})}))&&(De=Pe=function(){return Re.call(this)});var lt=p({},tt);p(lt,it),c(lt,Le,it.values),p(lt,{slice:nt,set:rt,constructor:function(){},toString:De,toLocaleString:et}),Qe(lt,"buffer","b"),Qe(lt,"byteOffset","o"),Qe(lt,"byteLength","l"),Qe(lt,"length","e"),J(lt,Ne,{get:function(){return this[Ue]}}),e.exports=function(e,a,o,u){var l=e+((u=!!u)?"Clamped":"")+"Array",d="get"+e,h="set"+e,f=t[l],p=f||{},m=f&&D(f),g=!f||!i.ABV,_={},b=f&&f.prototype,E=function(e,t){J(e,t,{get:function(){return function(e,t){var n=e._d;return n.v[d](t*a+n.o,Ve)}(this,t)},set:function(e){return function(e,t,n){var r=e._d;u&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),r.v[h](t*a+r.o,n,Ve)}(this,t,e)},enumerable:!0})};g?(f=o((function(e,t,n,r){s(e,f,l,"_d");var i,o,u,d,h=0,p=0;if(M(t)){if(!(t instanceof ce||(d=x(t))==oe||d==se))return Ue in t?Xe(f,t):Ze.call(f,t);i=t,p=We(n,a);var m=t.byteLength;if(void 0===r){if(m%a)throw te(Ge);if((o=m-p)<0)throw te(Ge)}else if((o=v(r)*a)+p>m)throw te(Ge);u=o/a}else u=y(t),i=new ce(o=u*a);for(c(e,"_d",{b:i,o:p,l:o,e:u,v:new de(i)});h<u;)E(e,h++)})),b=f.prototype=O(lt),c(b,"constructor",f)):n((function(){f(1)}))&&n((function(){new f(-1)}))&&W((function(e){new f,new f(null),new f(1.5),new f(e)}),!0)||(f=o((function(e,t,n,r){var i;return s(e,f,l),M(t)?t instanceof ce||(i=x(t))==oe||i==se?void 0!==r?new p(t,We(n,a),r):void 0!==n?new p(t,We(n,a)):new p(t):Ue in t?Xe(f,t):Ze.call(f,t):new p(y(t))})),he(m!==Function.prototype?L(p).concat(L(m)):L(p),(function(e){e in f||c(f,e,p[e])})),f.prototype=b,b.constructor=f);var T=b[Le],S=!!T&&("values"==T.name||null==T.name),w=it.values;c(f,ke,!0),c(b,Ue,l),c(b,je,!0),c(b,Fe,f),(u?new f(1)[Ne]==l:Ne in b)||J(b,Ne,{get:function(){return l}}),_[l]=f,r(r.G+r.W+r.F*(f!=p),_),r(r.S,l,{BYTES_PER_ELEMENT:a}),r(r.S+r.F*n((function(){p.of.call(f,1)})),l,{from:Ze,of:Je}),ue in b||c(b,ue,a),r(r.P,l,tt),q(l),r(r.P+r.F*ze,l,{set:rt}),r(r.P+r.F*!S,l,it),b.toString!=De&&(b.toString=De),r(r.P+r.F*n((function(){new f(1).slice()})),l,{slice:nt}),r(r.P+r.F*(n((function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()}))||!n((function(){b.toLocaleString.call([1,2])}))),l,{toLocaleString:et}),z[l]=S?T:w,S||c(b,Le,w)}}else e.exports=function(){}}));Wo("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Wo("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Wo("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0),Wo("Int16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Wo("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Wo("Int32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Wo("Uint32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Wo("Float32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}})),Wo("Float64",8,(function(e){return function(t,n,r){return e(this,t,n,r)}}));var qo=(l.Reflect||{}).apply,Yo=Function.apply;N(N.S+N.F*!h((function(){qo((function(){}))})),"Reflect",{apply:function(e,t,n){var r=D(e),i=g(n);return qo?qo(r,t,i):Yo.call(r,t,i)}});var Ko=(l.Reflect||{}).construct,Xo=h((function(){function e(){}return!(Ko((function(){}),[],e)instanceof e)})),Qo=!h((function(){Ko((function(){}))}));N(N.S+N.F*(Xo||Qo),"Reflect",{construct:function(e,t){D(e),g(t);var n=arguments.length<3?e:D(arguments[2]);if(Qo&&!Xo)return Ko(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(Mt.apply(e,r))}var i=n.prototype,a=be(m(i)?i:Object.prototype),o=Function.apply.call(e,a,t);return m(o)?o:a}}),N(N.S+N.F*h((function(){Reflect.defineProperty(S.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,n){g(e),t=E(t,!0),g(n);try{return S.f(e,t,n),!0}catch(e){return!1}}});var Zo=Ce.f;N(N.S,"Reflect",{deleteProperty:function(e,t){var n=Zo(g(e),t);return!(n&&!n.configurable)&&delete e[t]}});var Jo=function(e){this._t=g(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};Zn(Jo,"Object",(function(){var e,t=this,n=t._k;do{if(t._i>=n.length)return{value:void 0,done:!0}}while(!((e=n[t._i++])in t._t));return{value:e,done:!1}})),N(N.S,"Reflect",{enumerate:function(e){return new Jo(e)}}),N(N.S,"Reflect",{get:function e(t,n){var r,i,a=arguments.length<3?t:arguments[2];return g(t)===a?t[n]:(r=Ce.f(t,n))?d(r,"value")?r.value:void 0!==r.get?r.get.call(a):void 0:m(i=ct(t))?e(i,n,a):void 0}}),N(N.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return Ce.f(g(e),t)}}),N(N.S,"Reflect",{getPrototypeOf:function(e){return ct(g(e))}}),N(N.S,"Reflect",{has:function(e,t){return t in e}});var $o=Object.isExtensible;N(N.S,"Reflect",{isExtensible:function(e){return g(e),!$o||$o(e)}});var es=l.Reflect,ts=es&&es.ownKeys||function(e){var t=Te.f(g(e)),n=de.f;return n?t.concat(n(e)):t};N(N.S,"Reflect",{ownKeys:ts});var ns=Object.preventExtensions;N(N.S,"Reflect",{preventExtensions:function(e){g(e);try{return ns&&ns(e),!0}catch(e){return!1}}}),N(N.S,"Reflect",{set:function e(t,n,r){var i,a,o=arguments.length<4?t:arguments[3],s=Ce.f(g(t),n);if(!s){if(m(a=ct(t)))return e(a,n,r,o);s=w(0)}if(d(s,"value")){if(!1===s.writable||!m(o))return!1;if(i=Ce.f(o,n)){if(i.get||i.set||!1===i.writable)return!1;i.value=r,S.f(o,n,i)}else S.f(o,n,w(0,r));return!0}return void 0!==s.set&&(s.set.call(o,r),!0)}}),yt&&N(N.S,"Reflect",{setPrototypeOf:function(e,t){yt.check(e,t);try{return yt.set(e,t),!0}catch(e){return!1}}});var rs=re(!0);N(N.P,"Array",{includes:function(e){return rs(this,e,arguments.length>1?arguments[1]:void 0)}}),di("includes");var is=F("isConcatSpreadable");var as=function e(t,n,r,i,a,o,s,u){for(var l,c,d=a,h=0,f=!!s&&P(s,u,3);h<i;){if(h in r){if(l=f?f(r[h],h,n):r[h],c=!1,m(l)&&(c=void 0!==(c=l[is])?!!c:fe(l)),c&&o>0)d=e(t,n,l,$(l.length),d,o-1)-1;else{if(d>=9007199254740991)throw TypeError();t[d]=l}d++}h++}return d};N(N.P,"Array",{flatMap:function(e){var t,n,r=st(this);return D(e),t=$(r.length),n=Kr(r,0),as(n,r,r,t,0,1,e,arguments[1]),n}}),di("flatMap"),N(N.P,"Array",{flatten:function(){var e=arguments[0],t=st(this),n=$(t.length),r=Kr(t,0);return as(r,t,t,n,0,void 0===e?1:Z(e)),r}}),di("flatten");var os=Kn(!0);N(N.P,"String",{at:function(e){return os(this,e)}});var ss=function(e,t,n,r){var i=String(Y(e)),a=i.length,o=void 0===n?" ":String(n),s=$(t);if(s<=a||""==o)return i;var u=s-a,l=hn.call(o,Math.ceil(u/o.length));return l.length>u&&(l=l.slice(0,u)),r?l+i:i+l},us=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(Ua);N(N.P+N.F*us,"String",{padStart:function(e){return ss(this,e,arguments.length>1?arguments[1]:void 0,!0)}});var ls=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(Ua);N(N.P+N.F*ls,"String",{padEnd:function(e){return ss(this,e,arguments.length>1?arguments[1]:void 0,!1)}}),jt("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart"),jt("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd");var cs=RegExp.prototype,ds=function(e,t){this._r=e,this._s=t};Zn(ds,"RegExp String",(function(){var e=this._r.exec(this._s);return{value:e,done:null===e}})),N(N.P,"String",{matchAll:function(e){if(Y(this),!sr(e))throw TypeError(e+" is not a regexp!");var t=String(this),n="flags"in cs?String(e.flags):Si.call(e),r=new RegExp(e.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=$(e.lastIndex),new ds(r,t)}}),V("asyncIterator"),V("observable"),N(N.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=K(e),i=Ce.f,a=ts(r),o={},s=0;a.length>s;)void 0!==(n=i(r,t=a[s++]))&&Nr(o,t,n);return o}});var hs=he.f,fs=function(e){return function(t){for(var n,r=K(t),i=ce(r),a=i.length,o=0,s=[];a>o;)hs.call(r,n=i[o++])&&s.push(e?[n,r[n]]:r[n]);return s}},ps=fs(!1);N(N.S,"Object",{values:function(e){return ps(e)}});var ms=fs(!0);N(N.S,"Object",{entries:function(e){return ms(e)}});var gs=!h((function(){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete l[e]}));f&&N(N.P+gs,"Object",{__defineGetter__:function(e,t){S.f(st(this),e,{get:D(t),enumerable:!0,configurable:!0})}}),f&&N(N.P+gs,"Object",{__defineSetter__:function(e,t){S.f(st(this),e,{set:D(t),enumerable:!0,configurable:!0})}});var vs=Ce.f;f&&N(N.P+gs,"Object",{__lookupGetter__:function(e){var t,n=st(this),r=E(e,!0);do{if(t=vs(n,r))return t.get}while(n=ct(n))}});var ys=Ce.f;f&&N(N.P+gs,"Object",{__lookupSetter__:function(e){var t,n=st(this),r=E(e,!0);do{if(t=ys(n,r))return t.set}while(n=ct(n))}});var _s=function(e,t){var n=[];return fa(e,!1,n.push,n,t),n},bs=function(e){return function(){if(Et(this)!=e)throw TypeError(e+"#toJSON isn't generic");return _s(this)}};N(N.P+N.R,"Map",{toJSON:bs("Map")}),N(N.P+N.R,"Set",{toJSON:bs("Set")});var Es=function(e){N(N.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})};Es("Map"),Es("Set"),Es("WeakMap"),Es("WeakSet");var Ts=function(e){N(N.S,e,{from:function(e){var t,n,r,i,a=arguments[1];return D(this),(t=void 0!==a)&&D(a),null==e?new this:(n=[],t?(r=0,i=P(a,arguments[2],2),fa(e,!1,(function(e){n.push(i(e,r++))}))):fa(e,!1,n.push,n),new this(n))}})};Ts("Map"),Ts("Set"),Ts("WeakMap"),Ts("WeakSet"),N(N.G,{global:l}),N(N.S,"System",{global:l}),N(N.S,"Error",{isError:function(e){return"Error"===W(e)}}),N(N.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}}),N(N.S,"Math",{DEG_PER_RAD:Math.PI/180});var Ss=180/Math.PI;N(N.S,"Math",{degrees:function(e){return e*Ss}});var ws=Math.scale||function(e,t,n,r,i){return 0===arguments.length||e!=e||t!=t||n!=n||r!=r||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-r)/(n-t)+r};N(N.S,"Math",{fscale:function(e,t,n,r,i){return Gn(ws(e,t,n,r,i))}}),N(N.S,"Math",{iaddh:function(e,t,n,r){var i=e>>>0,a=n>>>0;return(t>>>0)+(r>>>0)+((i&a|(i|a)&~(i+a>>>0))>>>31)|0}}),N(N.S,"Math",{isubh:function(e,t,n,r){var i=e>>>0,a=n>>>0;return(t>>>0)-(r>>>0)-((~i&a|~(i^a)&i-a>>>0)>>>31)|0}}),N(N.S,"Math",{imulh:function(e,t){var n=65535,r=+e,i=+t,a=r&n,o=i&n,s=r>>16,u=i>>16,l=(s*o>>>0)+(a*o>>>16);return s*u+(l>>16)+((a*u>>>0)+(l&n)>>16)}}),N(N.S,"Math",{RAD_PER_DEG:180/Math.PI});var As=Math.PI/180;N(N.S,"Math",{radians:function(e){return e*As}}),N(N.S,"Math",{scale:ws}),N(N.S,"Math",{umulh:function(e,t){var n=65535,r=+e,i=+t,a=r&n,o=i&n,s=r>>>16,u=i>>>16,l=(s*o>>>0)+(a*o>>>16);return s*u+(l>>>16)+((a*u>>>0)+(l&n)>>>16)}}),N(N.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}}),N(N.P+N.R,"Promise",{finally:function(e){var t=ia(this,p.Promise||l.Promise),n="function"==typeof e;return this.then(n?function(n){return ja(t,e()).then((function(){return n}))}:e,n?function(n){return ja(t,e()).then((function(){throw n}))}:e)}}),N(N.S,"Promise",{try:function(e){var t=ka.f(this),n=Fa(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}});var xs=R("metadata"),Ms=xs.store||(xs.store=new xo),Cs=function(e,t,n){var r=Ms.get(e);if(!r){if(!n)return;Ms.set(e,r=new go)}var i=r.get(t);if(!i){if(!n)return;r.set(t,i=new go)}return i},Rs={store:Ms,map:Cs,has:function(e,t,n){var r=Cs(t,n,!1);return void 0!==r&&r.has(e)},get:function(e,t,n){var r=Cs(t,n,!1);return void 0===r?void 0:r.get(e)},set:function(e,t,n,r){Cs(n,r,!0).set(e,t)},keys:function(e,t){var n=Cs(e,t,!1),r=[];return n&&n.forEach((function(e,t){r.push(t)})),r},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){N(N.S,"Reflect",e)}},Is=Rs.key,Os=Rs.set;Rs.exp({defineMetadata:function(e,t,n,r){Os(e,t,g(n),Is(r))}});var Ds=Rs.key,Ps=Rs.map,Ls=Rs.store;Rs.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:Ds(arguments[2]),r=Ps(g(t),n,!1);if(void 0===r||!r.delete(e))return!1;if(r.size)return!0;var i=Ls.get(t);return i.delete(n),!!i.size||Ls.delete(t)}});var Ns=Rs.has,ks=Rs.get,Fs=Rs.key,Bs=function(e,t,n){if(Ns(e,t,n))return ks(e,t,n);var r=ct(t);return null!==r?Bs(e,r,n):void 0};Rs.exp({getMetadata:function(e,t){return Bs(e,g(t),arguments.length<3?void 0:Fs(arguments[2]))}});var Us=Rs.keys,js=Rs.key,Gs=function(e,t){var n=Us(e,t),r=ct(e);if(null===r)return n;var i=Gs(r,t);return i.length?n.length?_s(new vo(n.concat(i))):i:n};Rs.exp({getMetadataKeys:function(e){return Gs(g(e),arguments.length<2?void 0:js(arguments[1]))}});var Hs=Rs.get,Vs=Rs.key;Rs.exp({getOwnMetadata:function(e,t){return Hs(e,g(t),arguments.length<3?void 0:Vs(arguments[2]))}});var zs=Rs.keys,Ws=Rs.key;Rs.exp({getOwnMetadataKeys:function(e){return zs(g(e),arguments.length<2?void 0:Ws(arguments[1]))}});var qs=Rs.has,Ys=Rs.key,Ks=function(e,t,n){if(qs(e,t,n))return!0;var r=ct(t);return null!==r&&Ks(e,r,n)};Rs.exp({hasMetadata:function(e,t){return Ks(e,g(t),arguments.length<3?void 0:Ys(arguments[2]))}});var Xs=Rs.has,Qs=Rs.key;Rs.exp({hasOwnMetadata:function(e,t){return Xs(e,g(t),arguments.length<3?void 0:Qs(arguments[2]))}});var Zs=Rs.key,Js=Rs.set;Rs.exp({metadata:function(e,t){return function(n,r){Js(e,t,(void 0!==r?g:D)(n),Zs(r))}}});var $s=Ia(),eu=l.process,tu="process"==W(eu);N(N.G,{asap:function(e){var t=tu&&eu.domain;$s(t?t.bind(e):e)}});var nu=Ia(),ru=F("observable"),iu=fa.RETURN,au=function(e){return null==e?void 0:D(e)},ou=function(e){var t=e._c;t&&(e._c=void 0,t())},su=function(e){return void 0===e._o},uu=function(e){su(e)||(e._o=void 0,ou(e))},lu=function(e,t){g(e),this._c=void 0,this._o=e,e=new cu(this);try{var n=t(e),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:D(n),this._c=n)}catch(t){return void e.error(t)}su(this)&&ou(this)};lu.prototype=Ga({},{unsubscribe:function(){uu(this)}});var cu=function(e){this._s=e};cu.prototype=Ga({},{next:function(e){var t=this._s;if(!su(t)){var n=t._o;try{var r=au(n.next);if(r)return r.call(n,e)}catch(e){try{uu(t)}finally{throw e}}}},error:function(e){var t=this._s;if(su(t))throw e;var n=t._o;t._o=void 0;try{var r=au(n.error);if(!r)throw e;e=r.call(n,e)}catch(e){try{ou(t)}finally{throw e}}return ou(t),e},complete:function(e){var t=this._s;if(!su(t)){var n=t._o;t._o=void 0;try{var r=au(n.complete);e=r?r.call(n,e):void 0}catch(e){try{ou(t)}finally{throw e}}return ou(t),e}}});var du=function(e){ha(this,du,"Observable","_f")._f=D(e)};Ga(du.prototype,{subscribe:function(e){return new lu(e,this._f)},forEach:function(e){var t=this;return new(p.Promise||l.Promise)((function(n,r){D(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:n})}))}}),Ga(du,{from:function(e){var t="function"==typeof this?this:du,n=au(g(e)[ru]);if(n){var r=g(n.call(e));return r.constructor===t?r:new t((function(e){return r.subscribe(e)}))}return new t((function(t){var n=!1;return nu((function(){if(!n){try{if(fa(e,!1,(function(e){if(t.next(e),n)return iu}))===iu)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}})),function(){n=!0}}))},of:function(){for(var e=0,t=arguments.length,n=new Array(t);e<t;)n[e]=arguments[e++];return new("function"==typeof this?this:du)((function(e){var t=!1;return nu((function(){if(!t){for(var r=0;r<n.length;++r)if(e.next(n[r]),t)return;e.complete()}})),function(){t=!0}}))}}),A(du.prototype,ru,(function(){return this})),N(N.G,{Observable:du}),bi("Observable");var hu=[].slice,fu=/MSIE .\./.test(Ua),pu=function(e){return function(t,n){var r=arguments.length>2,i=!!r&&hu.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};N(N.G+N.B+N.F*fu,{setTimeout:pu(l.setTimeout),setInterval:pu(l.setInterval)}),N(N.G+N.B,{setImmediate:wa.set,clearImmediate:wa.clear});for(var mu=F("iterator"),gu=F("toStringTag"),vu=Xn.Array,yu={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},_u=ce(yu),bu=0;bu<_u.length;bu++){var Eu,Tu=_u[bu],Su=yu[Tu],wu=l[Tu],Au=wu&&wu.prototype;if(Au&&(Au[mu]||A(Au,mu,vu),Au[gu]||A(Au,gu,Tu),Xn[Tu]=vu,Su))for(Eu in Ti)Au[Eu]||O(Au,Eu,Ti[Eu],!0)}u((function(e){!function(t){var n,r=Object.prototype,i=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag",l=t.regeneratorRuntime;if(l)e.exports=l;else{(l=t.regeneratorRuntime=e.exports).wrap=_;var c="suspendedStart",d="suspendedYield",h="executing",f="completed",p={},m={};m[o]=function(){return this};var g=Object.getPrototypeOf,v=g&&g(g(I([])));v&&v!==r&&i.call(v,o)&&(m=v);var y=S.prototype=E.prototype=Object.create(m);T.prototype=y.constructor=S,S.constructor=T,S[u]=T.displayName="GeneratorFunction",l.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===T||"GeneratorFunction"===(t.displayName||t.name))},l.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(y),e},l.awrap=function(e){return{__await:e}},w(A.prototype),A.prototype[s]=function(){return this},l.AsyncIterator=A,l.async=function(e,t,n,r){var i=new A(_(e,t,n,r));return l.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(y),y[u]="Generator",y[o]=function(){return this},y.toString=function(){return"[object Generator]"},l.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=I,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var u=i.call(o,"catchLoc"),l=i.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:I(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),p}}}function _(e,t,n,r){var i=t&&t.prototype instanceof E?t:E,a=Object.create(i.prototype),o=new R(r||[]);return a._invoke=function(e,t,n){var r=c;return function(i,a){if(r===h)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw a;return O()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=x(o,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===c)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=b(e,t,n);if("normal"===u.type){if(r=n.done?f:d,u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=f,n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function b(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function E(){}function T(){}function S(){}function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function A(e){function n(t,r,a,o){var s=b(e[t],e,r);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&i.call(l,"__await")?Promise.resolve(l.__await).then((function(e){n("next",e,a,o)}),(function(e){n("throw",e,a,o)})):Promise.resolve(l).then((function(e){u.value=e,a(u)}),o)}o(s.arg)}var r;"object"==typeof t.process&&t.process.domain&&(n=t.process.domain.bind(n)),this._invoke=function(e,t){function i(){return new Promise((function(r,i){n(e,t,r,i)}))}return r=r?r.then(i,i):i()}}function x(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,x(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=b(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,p;var a=i.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,p):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function I(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return a.next=a}}return{next:O}}function O(){return{value:n,done:!0}}}("object"==typeof s?s:"object"==typeof window?window:"object"==typeof self?self:s)}));var xu,Mu,Cu,Ru=(xu=/[\\^$*+?.()|[\]{}]/g,Cu=(Mu="\\$&")===Object(Mu)?function(e){return Mu[e]}:Mu,function(e){return String(e).replace(xu,Cu)});N(N.S,"RegExp",{escape:function(e){return Ru(e)}});p.RegExp.escape;if(s._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");s._babelPolyfill=!0;function Iu(e,t,n){e[t]||Object.defineProperty(e,t,{writable:!0,configurable:!0,value:n})}Iu(String.prototype,"padLeft","".padStart),Iu(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach((function(e){[][e]&&Iu(Array,e,Function.call.bind([][e]))}));const Ou=void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},Du=Symbol("@@webxr-polyfill/EventTarget");class Pu{constructor(){this[Du]={listeners:new Map}}addEventListener(e,t){if("string"!=typeof e)throw new Error("`type` must be a string");if("function"!=typeof t)throw new Error("`listener` must be a function");const n=this[Du].listeners.get(e)||[];n.push(t),this[Du].listeners.set(e,n)}removeEventListener(e,t){if("string"!=typeof e)throw new Error("`type` must be a string");if("function"!=typeof t)throw new Error("`listener` must be a function");const n=this[Du].listeners.get(e)||[];for(let e=n.length;e>=0;e--)n[e]===t&&n.pop()}dispatchEvent(e,t){const n=this[Du].listeners.get(e)||[],r=[];for(let e=0;e<n.length;e++)r[e]=n[e];for(let e of r)e(t);"function"==typeof this["on"+e]&&this["on"+e](t)}}let Lu="undefined"!=typeof Float32Array?Float32Array:Array;function Nu(){let e=new Lu(16);return Lu!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ku(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Fu(e,t){let n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],d=t[9],h=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15],y=n*s-r*o,_=n*u-i*o,b=n*l-a*o,E=r*u-i*s,T=r*l-a*s,S=i*l-a*u,w=c*m-d*p,A=c*g-h*p,x=c*v-f*p,M=d*g-h*m,C=d*v-f*m,R=h*v-f*g,I=y*R-_*C+b*M+E*x-T*A+S*w;return I?(I=1/I,e[0]=(s*R-u*C+l*M)*I,e[1]=(i*C-r*R-a*M)*I,e[2]=(m*S-g*T+v*E)*I,e[3]=(h*T-d*S-f*E)*I,e[4]=(u*x-o*R-l*A)*I,e[5]=(n*R-i*x+a*A)*I,e[6]=(g*b-p*S-v*_)*I,e[7]=(c*S-h*b+f*_)*I,e[8]=(o*C-s*x+l*w)*I,e[9]=(r*x-n*C-a*w)*I,e[10]=(p*T-m*b+v*y)*I,e[11]=(d*b-c*T-f*y)*I,e[12]=(s*A-o*M-u*w)*I,e[13]=(n*M-r*A+i*w)*I,e[14]=(m*_-p*E-g*y)*I,e[15]=(c*E-d*_+h*y)*I,e):null}function Bu(e,t,n){let r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],d=t[8],h=t[9],f=t[10],p=t[11],m=t[12],g=t[13],v=t[14],y=t[15],_=n[0],b=n[1],E=n[2],T=n[3];return e[0]=_*r+b*s+E*d+T*m,e[1]=_*i+b*u+E*h+T*g,e[2]=_*a+b*l+E*f+T*v,e[3]=_*o+b*c+E*p+T*y,_=n[4],b=n[5],E=n[6],T=n[7],e[4]=_*r+b*s+E*d+T*m,e[5]=_*i+b*u+E*h+T*g,e[6]=_*a+b*l+E*f+T*v,e[7]=_*o+b*c+E*p+T*y,_=n[8],b=n[9],E=n[10],T=n[11],e[8]=_*r+b*s+E*d+T*m,e[9]=_*i+b*u+E*h+T*g,e[10]=_*a+b*l+E*f+T*v,e[11]=_*o+b*c+E*p+T*y,_=n[12],b=n[13],E=n[14],T=n[15],e[12]=_*r+b*s+E*d+T*m,e[13]=_*i+b*u+E*h+T*g,e[14]=_*a+b*l+E*f+T*v,e[15]=_*o+b*c+E*p+T*y,e}function Uu(e,t,n){let r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,u=i+i,l=a+a,c=r*s,d=r*u,h=r*l,f=i*u,p=i*l,m=a*l,g=o*s,v=o*u,y=o*l;return e[0]=1-(f+m),e[1]=d+y,e[2]=h-v,e[3]=0,e[4]=d-y,e[5]=1-(c+m),e[6]=p+g,e[7]=0,e[8]=h+v,e[9]=p-g,e[10]=1-(c+f),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function ju(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Gu(e,t){let n=t[0]+t[5]+t[10],r=0;return n>0?(r=2*Math.sqrt(n+1),e[3]=.25*r,e[0]=(t[6]-t[9])/r,e[1]=(t[8]-t[2])/r,e[2]=(t[1]-t[4])/r):t[0]>t[5]&&t[0]>t[10]?(r=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/r,e[0]=.25*r,e[1]=(t[1]+t[4])/r,e[2]=(t[8]+t[2])/r):t[5]>t[10]?(r=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/r,e[0]=(t[1]+t[4])/r,e[1]=.25*r,e[2]=(t[6]+t[9])/r):(r=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/r,e[0]=(t[8]+t[2])/r,e[1]=(t[6]+t[9])/r,e[2]=.25*r),e}function Hu(e,t,n,r,i){let a,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e}function Vu(){let e=new Lu(3);return Lu!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function zu(e){var t=new Lu(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Wu(e,t,n){let r=new Lu(3);return r[0]=e,r[1]=t,r[2]=n,r}function qu(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Yu(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function Ku(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function Xu(e,t){let n=t[0],r=t[1],i=t[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function Qu(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Zu(e,t,n){let r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],u=n[2];return e[0]=i*u-a*s,e[1]=a*o-r*u,e[2]=r*s-i*o,e}function Ju(e,t,n){let r=n[0],i=n[1],a=n[2],o=n[3],s=t[0],u=t[1],l=t[2],c=i*l-a*u,d=a*s-r*l,h=r*u-i*s,f=i*h-a*d,p=a*c-r*h,m=r*d-i*c,g=2*o;return c*=g,d*=g,h*=g,f*=2,p*=2,m*=2,e[0]=s+c+f,e[1]=u+d+p,e[2]=l+h+m,e}const $u=function(e){let t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)};!function(){let e=Vu()}();!function(){let e=function(){let e=new Lu(4);return Lu!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();function el(){let e=new Lu(4);return Lu!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function tl(e,t,n){let r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],u=n[1],l=n[2],c=n[3];return e[0]=r*c+o*s+i*l-a*u,e[1]=i*c+o*u+a*s-r*l,e[2]=a*c+o*l+r*u-i*s,e[3]=o*c-r*s-i*u-a*l,e}function nl(e,t,n,r){let i,a,o,s,u,l=t[0],c=t[1],d=t[2],h=t[3],f=n[0],p=n[1],m=n[2],g=n[3];return a=l*f+c*p+d*m+h*g,a<0&&(a=-a,f=-f,p=-p,m=-m,g=-g),1-a>1e-6?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-r)*i)/o,u=Math.sin(r*i)/o):(s=1-r,u=r),e[0]=s*l+u*f,e[1]=s*c+u*p,e[2]=s*d+u*m,e[3]=s*h+u*g,e}function rl(e,t){let n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=a*s,e}const il=function(e){let t=new Lu(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},al=function(e,t,n,r){let i=new Lu(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i},ol=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},sl=function(e,t){let n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=a*o),e},ul=(function(){let e=Vu(),t=Wu(1,0,0),n=Wu(0,1,0)}(),function(){let e=el(),t=el()}(),function(){let e=function(){let e=new Lu(9);return Lu!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}()}(),Symbol("@@webxr-polyfill/XRRigidTransform"));class ll{constructor(){if(this[ul]={matrix:null,position:null,orientation:null,inverse:null},0===arguments.length)this[ul].matrix=ku(new Float32Array(16));else if(1===arguments.length)arguments[0]instanceof Float32Array?this[ul].matrix=arguments[0]:(this[ul].position=this._getPoint(arguments[0]),this[ul].orientation=DOMPointReadOnly.fromPoint({x:0,y:0,z:0,w:1}));else{if(2!==arguments.length)throw new Error("Too many arguments!");this[ul].position=this._getPoint(arguments[0]),this[ul].orientation=this._getPoint(arguments[1])}if(this[ul].matrix){let e=Vu();ju(e,this[ul].matrix),this[ul].position=DOMPointReadOnly.fromPoint({x:e[0],y:e[1],z:e[2]});let t=el();Gu(t,this[ul].matrix),this[ul].orientation=DOMPointReadOnly.fromPoint({x:t[0],y:t[1],z:t[2],w:t[3]})}else this[ul].matrix=ku(new Float32Array(16)),Uu(this[ul].matrix,al(this[ul].orientation.x,this[ul].orientation.y,this[ul].orientation.z,this[ul].orientation.w),Wu(this[ul].position.x,this[ul].position.y,this[ul].position.z))}_getPoint(e){return e instanceof DOMPointReadOnly?e:DOMPointReadOnly.fromPoint(e)}get matrix(){return this[ul].matrix}get position(){return this[ul].position}get orientation(){return this[ul].orientation}get inverse(){if(null===this[ul].inverse){let e=ku(new Float32Array(16));Fu(e,this[ul].matrix),this[ul].inverse=new ll(e),this[ul].inverse[ul].inverse=this}return this[ul].inverse}}const cl=Symbol("@@webxr-polyfill/XRSpace");class dl{constructor(e=null,t=null){this[cl]={specialType:e,inputSource:t,baseMatrix:null,inverseBaseMatrix:null,lastFrameId:-1}}get _specialType(){return this[cl].specialType}get _inputSource(){return this[cl].inputSource}_ensurePoseUpdated(e,t){t!=this[cl].lastFrameId&&(this[cl].lastFrameId=t,this._onPoseUpdate(e))}_onPoseUpdate(e){"viewer"==this[cl].specialType&&(this._baseMatrix=e.getBasePoseMatrix())}set _baseMatrix(e){this[cl].baseMatrix=e,this[cl].inverseBaseMatrix=null}get _baseMatrix(){return this[cl].baseMatrix||this[cl].inverseBaseMatrix&&(this[cl].baseMatrix=new Float32Array(16),Fu(this[cl].baseMatrix,this[cl].inverseBaseMatrix)),this[cl].baseMatrix}set _inverseBaseMatrix(e){this[cl].inverseBaseMatrix=e,this[cl].baseMatrix=null}get _inverseBaseMatrix(){return this[cl].inverseBaseMatrix||this[cl].baseMatrix&&(this[cl].inverseBaseMatrix=new Float32Array(16),Fu(this[cl].inverseBaseMatrix,this[cl].baseMatrix)),this[cl].inverseBaseMatrix}_getSpaceRelativeTransform(e){if(!this._inverseBaseMatrix||!e._baseMatrix)return null;let t=new Float32Array(16);return Bu(t,this._inverseBaseMatrix,e._baseMatrix),new ll(t)}}const hl=Symbol("@@webxr-polyfill/XRReferenceSpace"),fl=["viewer","local","local-floor","bounded-floor","unbounded"];class pl extends dl{constructor(e,t=null){if(!fl.includes(e))throw new Error("XRReferenceSpaceType must be one of "+fl);if(super(e),"bounded-floor"===e&&!t)throw new Error("XRReferenceSpace cannot use 'bounded-floor' type if the platform does not provide the floor level");(function(e){return"bounded-floor"===e||"local-floor"===e})(e)&&!t&&((t=ku(new Float32Array(16)))[13]=1.6),this._inverseBaseMatrix=t||ku(new Float32Array(16)),this[hl]={type:e,transform:t,originOffset:ku(new Float32Array(16))}}_transformBasePoseMatrix(e,t){Bu(e,this._inverseBaseMatrix,t)}_originOffsetMatrix(){return this[hl].originOffset}_adjustForOriginOffset(e){let t=new Float32Array(16);Fu(t,this[hl].originOffset),Bu(e,t,e)}_getSpaceRelativeTransform(e){let t=super._getSpaceRelativeTransform(e);return this._adjustForOriginOffset(t.matrix),new XRRigidTransform(t.matrix)}getOffsetReferenceSpace(e){let t=new pl(this[hl].type,this[hl].transform,this[hl].bounds);return Bu(t[hl].originOffset,this[hl].originOffset,e.matrix),t}}const ml=Symbol("@@webxr-polyfill/XR"),gl=["inline","immersive-vr","immersive-ar"],vl={inline:{requiredFeatures:["viewer"],optionalFeatures:[]},"immersive-vr":{requiredFeatures:["viewer","local"],optionalFeatures:[]},"immersive-ar":{requiredFeatures:["viewer","local"],optionalFeatures:[]}};let yl;if("performance"in Ou==!1){let e=Date.now();yl=()=>Date.now()-e}else yl=()=>performance.now();var _l=yl;const bl=Symbol("@@webxr-polyfill/XRPose");class El{constructor(e,t){this[bl]={transform:e,emulatedPosition:t}}get transform(){return this[bl].transform}get emulatedPosition(){return this[bl].emulatedPosition}}const Tl=Symbol("@@webxr-polyfill/XRViewerPose");class Sl extends El{constructor(e,t,n=!1){super(e,n),this[Tl]={views:t}}get views(){return this[Tl].views}}const wl=Symbol("@@webxr-polyfill/XRViewport");class Al{constructor(e){this[wl]={target:e}}get x(){return this[wl].target.x}get y(){return this[wl].target.y}get width(){return this[wl].target.width}get height(){return this[wl].target.height}}const xl=["left","right","none"],Ml=Symbol("@@webxr-polyfill/XRView");class Cl{constructor(e,t,n,r){if(!xl.includes(n))throw new Error("XREye must be one of: "+xl);const i=Object.create(null),a=new Al(i);this[Ml]={device:e,eye:n,viewport:a,temp:i,sessionId:r,transform:t}}get eye(){return this[Ml].eye}get projectionMatrix(){return this[Ml].device.getProjectionMatrix(this.eye)}get transform(){return this[Ml].transform}_getViewport(e){if(this[Ml].device.getViewport(this[Ml].sessionId,this.eye,e,this[Ml].temp))return this[Ml].viewport}}const Rl=Symbol("@@webxr-polyfill/XRFrame"),Il="XRFrame access outside the callback that produced it is invalid.";let Ol=0;class Dl{constructor(e,t,n){this[Rl]={id:++Ol,active:!1,animationFrame:!1,device:e,session:t,sessionId:n}}get session(){return this[Rl].session}getViewerPose(e){if(!this[Rl].animationFrame)throw new DOMException("getViewerPose can only be called on XRFrame objects passed to XRSession.requestAnimationFrame callbacks.","InvalidStateError");if(!this[Rl].active)throw new DOMException(Il,"InvalidStateError");const t=this[Rl].device,n=this[Rl].session;n[ql].viewerSpace._ensurePoseUpdated(t,this[Rl].id),e._ensurePoseUpdated(t,this[Rl].id);let r=e._getSpaceRelativeTransform(n[ql].viewerSpace);const i=[];for(let r of n[ql].viewSpaces){r._ensurePoseUpdated(t,this[Rl].id);let n=e._getSpaceRelativeTransform(r),a=new Cl(t,n,r.eye,this[Rl].sessionId);i.push(a)}return new Sl(r,i,!1)}getPose(e,t){if(!this[Rl].active)throw new DOMException(Il,"InvalidStateError");const n=this[Rl].device;if("target-ray"===e._specialType||"grip"===e._specialType)return n.getInputPose(e._inputSource,t,e._specialType);{e._ensurePoseUpdated(n,this[Rl].id),t._ensurePoseUpdated(n,this[Rl].id);let r=t._getSpaceRelativeTransform(e);return r?new XRPose(r,!1):null}}}const Pl=Symbol("@@webxr-polyfill/XRRenderState"),Ll=Object.freeze({depthNear:.1,depthFar:1e3,inlineVerticalFieldOfView:null,baseLayer:null});class Nl{constructor(e={}){const t=Object.assign({},Ll,e);this[Pl]={config:t}}get depthNear(){return this[Pl].config.depthNear}get depthFar(){return this[Pl].config.depthFar}get inlineVerticalFieldOfView(){return this[Pl].config.inlineVerticalFieldOfView}get baseLayer(){return this[Pl].config.baseLayer}}const kl=Symbol("@@webxr-polyfill/polyfilled-xr-compatible"),Fl=Symbol("@@webxr-polyfill/xr-compatible"),Bl=Symbol("@@webxr-polyfill/XRWebGLLayer"),Ul=Object.freeze({antialias:!0,depth:!1,stencil:!1,alpha:!0,multiview:!1,ignoreDepthValues:!1,framebufferScaleFactor:1});const jl=Symbol("@@webxr-polyfill/XRInputSourceEvent");class Gl extends Event{constructor(e,t){super(e,t),this[jl]={frame:t.frame,inputSource:t.inputSource},Object.setPrototypeOf(this,Gl.prototype)}get frame(){return this[jl].frame}get inputSource(){return this[jl].inputSource}}const Hl=Symbol("@@webxr-polyfill/XRSessionEvent");class Vl extends Event{constructor(e,t){super(e,t),this[Hl]={session:t.session},Object.setPrototypeOf(this,Vl.prototype)}get session(){return this[Hl].session}}const zl=Symbol("@@webxr-polyfill/XRInputSourcesChangeEvent");class Wl extends Event{constructor(e,t){super(e,t),this[zl]={session:t.session,added:t.added,removed:t.removed},Object.setPrototypeOf(this,Wl.prototype)}get session(){return this[zl].session}get added(){return this[zl].added}get removed(){return this[zl].removed}}const ql=Symbol("@@webxr-polyfill/XRSession");class Yl extends dl{constructor(e){super(e)}get eye(){return this._specialType}_onPoseUpdate(e){this._inverseBaseMatrix=e.getBaseViewMatrix(this._specialType)}}class Kl extends Pu{constructor(e,t,n){super();let r="inline"!=t,i=new Nl({inlineVerticalFieldOfView:r?null:.5*Math.PI});this[ql]={device:e,mode:t,immersive:r,ended:!1,suspended:!1,frameCallbacks:[],currentFrameCallbacks:null,frameHandle:0,deviceFrameHandle:null,id:n,activeRenderState:i,pendingRenderState:null,viewerSpace:new pl("viewer"),viewSpaces:[],currentInputSources:[]},r?this[ql].viewSpaces.push(new Yl("left"),new Yl("right")):this[ql].viewSpaces.push(new Yl("none")),this[ql].onDeviceFrame=()=>{if(this[ql].ended||this[ql].suspended)return;if(this[ql].deviceFrameHandle=null,this[ql].startDeviceFrameLoop(),null!==this[ql].pendingRenderState&&(this[ql].activeRenderState=new Nl(this[ql].pendingRenderState),this[ql].pendingRenderState=null,this[ql].activeRenderState.baseLayer&&this[ql].device.onBaseLayerSet(this[ql].id,this[ql].activeRenderState.baseLayer)),null===this[ql].activeRenderState.baseLayer)return;const t=new Dl(e,this,this[ql].id),n=this[ql].currentFrameCallbacks=this[ql].frameCallbacks;this[ql].frameCallbacks=[],t[Rl].active=!0,t[Rl].animationFrame=!0,this[ql].device.onFrameStart(this[ql].id,this[ql].activeRenderState),this._checkInputSourcesChange();const r=_l();for(let e=0;e<n.length;e++)try{n[e].cancelled||"function"!=typeof n[e].callback||n[e].callback(r,t)}catch(e){console.error(e)}this[ql].currentFrameCallbacks=null,t[Rl].active=!1,this[ql].device.onFrameEnd(this[ql].id)},this[ql].startDeviceFrameLoop=()=>{null===this[ql].deviceFrameHandle&&(this[ql].deviceFrameHandle=this[ql].device.requestAnimationFrame(this[ql].onDeviceFrame))},this[ql].stopDeviceFrameLoop=()=>{const e=this[ql].deviceFrameHandle;null!==e&&(this[ql].device.cancelAnimationFrame(e),this[ql].deviceFrameHandle=null)},this[ql].onPresentationEnd=t=>{if(t!==this[ql].id)return this[ql].suspended=!1,this[ql].startDeviceFrameLoop(),void this.dispatchEvent("focus",{session:this});this[ql].ended=!0,this[ql].stopDeviceFrameLoop(),e.removeEventListener("@webvr-polyfill/vr-present-end",this[ql].onPresentationEnd),e.removeEventListener("@webvr-polyfill/vr-present-start",this[ql].onPresentationStart),e.removeEventListener("@@webvr-polyfill/input-select-start",this[ql].onSelectStart),e.removeEventListener("@@webvr-polyfill/input-select-end",this[ql].onSelectEnd),this.dispatchEvent("end",new Vl("end",{session:this}))},e.addEventListener("@@webxr-polyfill/vr-present-end",this[ql].onPresentationEnd),this[ql].onPresentationStart=e=>{e!==this[ql].id&&(this[ql].suspended=!0,this[ql].stopDeviceFrameLoop(),this.dispatchEvent("blur",{session:this}))},e.addEventListener("@@webxr-polyfill/vr-present-start",this[ql].onPresentationStart),this[ql].onSelectStart=e=>{e.sessionId===this[ql].id&&this[ql].dispatchInputSourceEvent("selectstart",e.inputSource)},e.addEventListener("@@webxr-polyfill/input-select-start",this[ql].onSelectStart),this[ql].onSelectEnd=e=>{e.sessionId===this[ql].id&&(this[ql].dispatchInputSourceEvent("selectend",e.inputSource),this[ql].dispatchInputSourceEvent("select",e.inputSource))},e.addEventListener("@@webxr-polyfill/input-select-end",this[ql].onSelectEnd),this[ql].onSqueezeStart=e=>{e.sessionId===this[ql].id&&this[ql].dispatchInputSourceEvent("squeezestart",e.inputSource)},e.addEventListener("@@webxr-polyfill/input-squeeze-start",this[ql].onSqueezeStart),this[ql].onSqueezeEnd=e=>{e.sessionId===this[ql].id&&(this[ql].dispatchInputSourceEvent("squeezeend",e.inputSource),this[ql].dispatchInputSourceEvent("squeeze",e.inputSource))},e.addEventListener("@@webxr-polyfill/input-squeeze-end",this[ql].onSqueezeEnd),this[ql].dispatchInputSourceEvent=(t,n)=>{const r=new Dl(e,this,this[ql].id),i=new Gl(t,{frame:r,inputSource:n});r[Rl].active=!0,this.dispatchEvent(t,i),r[Rl].active=!1},this[ql].startDeviceFrameLoop(),this.onblur=void 0,this.onfocus=void 0,this.onresetpose=void 0,this.onend=void 0,this.onselect=void 0,this.onselectstart=void 0,this.onselectend=void 0}get renderState(){return this[ql].activeRenderState}get environmentBlendMode(){return this[ql].device.environmentBlendMode||"opaque"}async requestReferenceSpace(e){if(this[ql].ended)return;if(!fl.includes(e))throw new TypeError("XRReferenceSpaceType must be one of "+fl);if(!this[ql].device.doesSessionSupportReferenceSpace(this[ql].id,e))throw new DOMException(`The ${e} reference space is not supported by this session.`,"NotSupportedError");if("viewer"===e)return this[ql].viewerSpace;let t=await this[ql].device.requestFrameOfReferenceTransform(e);if("bounded-floor"===e){if(!t)throw new DOMException(e+" XRReferenceSpace not supported by this device.","NotSupportedError");if(!this[ql].device.requestStageBounds())throw new DOMException(e+" XRReferenceSpace not supported by this device.","NotSupportedError");throw new DOMException(`The WebXR polyfill does not support the ${e} reference space yet.`,"NotSupportedError")}return new pl(e,t)}requestAnimationFrame(e){if(this[ql].ended)return;const t=++this[ql].frameHandle;return this[ql].frameCallbacks.push({handle:t,callback:e,cancelled:!1}),t}cancelAnimationFrame(e){let t=this[ql].frameCallbacks,n=t.findIndex(t=>t&&t.handle===e);n>-1&&(t[n].cancelled=!0,t.splice(n,1)),t=this[ql].currentFrameCallbacks,t&&(n=t.findIndex(t=>t&&t.handle===e),n>-1&&(t[n].cancelled=!0))}get inputSources(){return this[ql].device.getInputSources()}async end(){if(!this[ql].ended)return this[ql].immersive&&(this[ql].ended=!0,this[ql].device.removeEventListener("@@webvr-polyfill/vr-present-start",this[ql].onPresentationStart),this[ql].device.removeEventListener("@@webvr-polyfill/vr-present-end",this[ql].onPresentationEnd),this[ql].device.removeEventListener("@@webvr-polyfill/input-select-start",this[ql].onSelectStart),this[ql].device.removeEventListener("@@webvr-polyfill/input-select-end",this[ql].onSelectEnd),this.dispatchEvent("end",new Vl("end",{session:this}))),this[ql].stopDeviceFrameLoop(),this[ql].device.endSession(this[ql].id)}updateRenderState(e){if(this[ql].ended){throw new Error("Can't call updateRenderState on an XRSession that has already ended.")}if(e.baseLayer&&e.baseLayer._session!==this){throw new Error("Called updateRenderState with a base layer that was created by a different session.")}if(null!==e.inlineVerticalFieldOfView&&void 0!==e.inlineVerticalFieldOfView){if(this[ql].immersive){throw new Error("inlineVerticalFieldOfView must not be set for an XRRenderState passed to updateRenderState for an immersive session.")}e.inlineVerticalFieldOfView=Math.min(3.13,Math.max(.01,e.inlineVerticalFieldOfView))}if(null===this[ql].pendingRenderState){const e=this[ql].activeRenderState;this[ql].pendingRenderState={depthNear:e.depthNear,depthFar:e.depthFar,inlineVerticalFieldOfView:e.inlineVerticalFieldOfView,baseLayer:e.baseLayer}}Object.assign(this[ql].pendingRenderState,e)}_checkInputSourcesChange(){const e=[],t=[],n=this.inputSources,r=this[ql].currentInputSources;for(const t of n)r.includes(t)||e.push(t);for(const e of r)n.includes(e)||t.push(e);(e.length>0||t.length>0)&&this.dispatchEvent("inputsourceschange",new Wl("inputsourceschange",{session:this,added:e,removed:t})),this[ql].currentInputSources.length=0;for(const e of n)this[ql].currentInputSources.push(e)}}const Xl=Symbol("@@webxr-polyfill/XRInputSource");class Ql{constructor(e){this[Xl]={impl:e,gripSpace:new dl("grip",this),targetRaySpace:new dl("target-ray",this)}}get handedness(){return this[Xl].impl.handedness}get targetRayMode(){return this[Xl].impl.targetRayMode}get gripSpace(){let e=this[Xl].impl.targetRayMode;return"gaze"===e||"screen"===e?null:this[Xl].gripSpace}get targetRaySpace(){return this[Xl].targetRaySpace}get profiles(){return this[Xl].impl.profiles}get gamepad(){return this[Xl].impl.gamepad}}const Zl=Symbol("@@webxr-polyfill/XRReferenceSpaceEvent");class Jl extends Event{constructor(e,t){super(e,t),this[Zl]={referenceSpace:t.referenceSpace,transform:t.transform||null},Object.setPrototypeOf(this,Jl.prototype)}get referenceSpace(){return this[Zl].referenceSpace}get transform(){return this[Zl].transform}}var $l={XR:class extends Pu{constructor(e){super(),this[ml]={device:null,devicePromise:e,immersiveSession:null,inlineSessions:new Set},e.then(e=>{this[ml].device=e})}async isSessionSupported(e){return this[ml].device||await this[ml].devicePromise,"inline"!=e?Promise.resolve(this[ml].device.isSessionSupported(e)):Promise.resolve(!0)}async requestSession(e,t){if(!this[ml].device){if("inline"!=e)throw new Error("Polyfill Error: Must call navigator.xr.isSessionSupported() with any XRSessionMode\nor navigator.xr.requestSession('inline') prior to requesting an immersive\nsession. This is a limitation specific to the WebXR Polyfill and does not apply\nto native implementations of the API.");await this[ml].devicePromise}if(!gl.includes(e))throw new TypeError(`The provided value '${e}' is not a valid enum value of type XRSessionMode`);const n=vl[e],r=n.requiredFeatures.concat(t&&t.requiredFeatures?t.requiredFeatures:[]),i=n.optionalFeatures.concat(t&&t.optionalFeatures?t.optionalFeatures:[]),a=new Set;let o=!1;for(let e of r)this[ml].device.isFeatureSupported(e)?a.add(e):(console.error(`The required feature '${e}' is not supported`),o=!0);if(o)throw new DOMException("Session does not support some required features","NotSupportedError");for(let e of i)this[ml].device.isFeatureSupported(e)?a.add(e):console.log(`The optional feature '${e}' is not supported`);const s=await this[ml].device.requestSession(e,a),u=new XRSession(this[ml].device,e,s);"inline"==e?this[ml].inlineSessions.add(u):this[ml].immersiveSession=u;const l=()=>{"inline"==e?this[ml].inlineSessions.delete(u):this[ml].immersiveSession=null,u.removeEventListener("end",l)};return u.addEventListener("end",l),u}},XRSession:Kl,XRSessionEvent:Vl,XRFrame:Dl,XRView:Cl,XRViewport:Al,XRViewerPose:Sl,XRWebGLLayer:class{constructor(e,t,n={}){const r=Object.assign({},Ul,n);if(!(e instanceof Kl))throw new Error("session must be a XRSession");if(e.ended)throw new Error("InvalidStateError");if(t[kl]&&!0!==t[Fl])throw new Error("InvalidStateError");const i=t.getParameter(t.FRAMEBUFFER_BINDING);this[Bl]={context:t,config:r,framebuffer:i,session:e}}get context(){return this[Bl].context}get antialias(){return this[Bl].config.antialias}get ignoreDepthValues(){return!0}get framebuffer(){return this[Bl].framebuffer}get framebufferWidth(){return this[Bl].context.drawingBufferWidth}get framebufferHeight(){return this[Bl].context.drawingBufferHeight}get _session(){return this[Bl].session}getViewport(e){return e._getViewport(this)}static getNativeFramebufferScaleFactor(e){if(!e)throw new TypeError("getNativeFramebufferScaleFactor must be passed a session.");return e[ql].ended?0:1}},XRSpace:dl,XRReferenceSpace:pl,XRReferenceSpaceEvent:Jl,XRInputSource:Ql,XRInputSourceEvent:Gl,XRInputSourcesChangeEvent:Wl,XRRenderState:Nl,XRRigidTransform:ll,XRPose:El};const ec=e=>"function"!=typeof e.prototype.makeXRCompatible&&(e.prototype.makeXRCompatible=function(){return this[Fl]=!0,Promise.resolve()},!0),tc=e=>{const t=e.prototype.getContext;e.prototype.getContext=function(e,n){const r=t.call(this,e,n);return r&&(r[kl]=!0,n&&"xrCompatible"in n&&(r[Fl]=n.xrCompatible)),r}};var nc="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};var rc,ic=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){e.exports=function(){var e,t,n,r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=.001,s=1,u=function(e,t){return"data:"+e+","+encodeURIComponent(t)},l=function(e,t,n){return e+(t-e)*n},c=function(){var e=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return e}}(),d=function(){var e=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome");return function(){return e}}(),h=(/^((?!chrome|android).)*safari/i.test(navigator.userAgent),function(){var e=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android");return function(){return e}}()),f=(t=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),n=t?parseInt(t[1],10):null,function(){return n}),p=function(){var e=!1;if(65===f()){var t=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(t){var n=t[1].split("."),r=a(n,4),i=(r[0],r[1],r[2]),o=r[3];e=3325===parseInt(i,10)&&parseInt(o,10)<148}}return function(){return e}}(),m=function(){var e=-1!==navigator.userAgent.indexOf("R7 Build");return function(){return e}}(),g=function(){var e=90==window.orientation||-90==window.orientation;return m()?!e:e},v=function(e){return!(isNaN(e)||e<=o||e>s)},y=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},_=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},b=function(e){if(d())return!1;if(e.requestFullscreen)e.requestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else{if(!e.msRequestFullscreen)return!1;e.msRequestFullscreen()}return!0},E=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},T=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},S=function(e,t,n,r){var i=e.createShader(e.VERTEX_SHADER);e.shaderSource(i,t),e.compileShader(i);var a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,n),e.compileShader(a);var o=e.createProgram();for(var s in e.attachShader(o,i),e.attachShader(o,a),r)e.bindAttribLocation(o,r[s],s);return e.linkProgram(o),e.deleteShader(i),e.deleteShader(a),o},w=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i="",a=0;a<r;a++)n[i=e.getActiveUniform(t,a).name.replace("[0]","")]=e.getUniformLocation(t,i);return n},A=function(e,t,n,r,i,a,o){var s=1/(t-n),u=1/(r-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*u,e[14]=(o+a)*l,e[15]=1,e},x=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},M=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},C=function(e){if(c()){var t=e.style.width,n=e.style.height;e.style.width=parseInt(t)+1+"px",e.style.height=parseInt(n)+"px",setTimeout((function(){e.style.width=t,e.style.height=n}),100)}window.canvas=e},R=function(){var e=Math.PI/180,t=.25*Math.PI;function n(n,r,i,a){var o=Math.tan(r?r.upDegrees*e:t),s=Math.tan(r?r.downDegrees*e:t),u=Math.tan(r?r.leftDegrees*e:t),l=Math.tan(r?r.rightDegrees*e:t),c=2/(u+l),d=2/(o+s);return n[0]=c,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=d,n[6]=0,n[7]=0,n[8]=-(u-l)*c*.5,n[9]=(o-s)*d*.5,n[10]=a/(i-a),n[11]=-1,n[12]=0,n[13]=0,n[14]=a*i/(i-a),n[15]=0,n}function r(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,u=i+i,l=a+a,c=r*s,d=r*u,h=r*l,f=i*u,p=i*l,m=a*l,g=o*s,v=o*u,y=o*l;return e[0]=1-(f+m),e[1]=d+y,e[2]=h-v,e[3]=0,e[4]=d-y,e[5]=1-(c+m),e[6]=p+g,e[7]=0,e[8]=h+v,e[9]=p-g,e[10]=1-(c+f),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function i(e,t,n){var r,i,a,o,s,u,l,c,d,h,f,p,m=n[0],g=n[1],v=n[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*v+t[12],e[13]=t[1]*m+t[5]*g+t[9]*v+t[13],e[14]=t[2]*m+t[6]*g+t[10]*v+t[14],e[15]=t[3]*m+t[7]*g+t[11]*v+t[15]):(r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],d=t[8],h=t[9],f=t[10],p=t[11],e[0]=r,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=d,e[9]=h,e[10]=f,e[11]=p,e[12]=r*m+s*g+d*v+t[12],e[13]=i*m+u*g+h*v+t[13],e[14]=a*m+l*g+f*v+t[14],e[15]=o*m+c*g+p*v+t[15]),e}function a(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],d=t[9],h=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15],y=n*s-r*o,_=n*u-i*o,b=n*l-a*o,E=r*u-i*s,T=r*l-a*s,S=i*l-a*u,w=c*m-d*p,A=c*g-h*p,x=c*v-f*p,M=d*g-h*m,C=d*v-f*m,R=h*v-f*g,I=y*R-_*C+b*M+E*x-T*A+S*w;return I?(I=1/I,e[0]=(s*R-u*C+l*M)*I,e[1]=(i*C-r*R-a*M)*I,e[2]=(m*S-g*T+v*E)*I,e[3]=(h*T-d*S-f*E)*I,e[4]=(u*x-o*R-l*A)*I,e[5]=(n*R-i*x+a*A)*I,e[6]=(g*b-p*S-v*_)*I,e[7]=(c*S-h*b+f*_)*I,e[8]=(o*C-s*x+l*w)*I,e[9]=(r*x-n*C-a*w)*I,e[10]=(p*T-m*b+v*y)*I,e[11]=(d*b-c*T-f*y)*I,e[12]=(s*A-o*M-u*w)*I,e[13]=(n*M-r*A+i*w)*I,e[14]=(m*_-p*E-g*y)*I,e[15]=(c*E-d*_+h*y)*I,e):null}var o=new Float32Array([0,0,0,1]),s=new Float32Array([0,0,0]);function u(e,t,u,l,c,d){n(e,l||null,d.depthNear,d.depthFar),r(t,u.orientation||o,u.position||s),c&&i(t,t,c),a(t,t)}return function(e,t,n){return!(!e||!t||(e.pose=t,e.timestamp=t.timestamp,u(e.leftProjectionMatrix,e.leftViewMatrix,t,n._getFieldOfView("left"),n._getEyeOffset("left"),n),u(e.rightProjectionMatrix,e.rightViewMatrix,t,n._getFieldOfView("right"),n._getEyeOffset("right"),n),0))}}(),I=function(){var e=window.self!==window.top,t=O(document.referrer),n=O(window.location.href);return e&&t!==n},O=function(e){var t,n=e.indexOf("://");t=-1!==n?n+3:0;var r=e.indexOf("/",t);return-1===r&&(r=e.length),e.substring(0,r)},D=function(e){return e.w>1?(console.warn("getQuaternionAngle: w > 1"),0):2*Math.acos(e.w)},P=(e={},function(t,n){void 0===e[t]&&(console.warn("webvr-polyfill: "+n),e[t]=!0)}),L=function(e,t){P(e,e+" has been deprecated. This may not work on native WebVR displays. "+(t?"Please use "+t+" instead.":""))};function N(e,t,n){if(t){for(var r=[],i=null,a=0;a<t.length;++a)switch(o=t[a]){case e.TEXTURE_BINDING_2D:case e.TEXTURE_BINDING_CUBE_MAP:if((u=t[++a])<e.TEXTURE0||u>e.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),r.push(null,null);break}i||(i=e.getParameter(e.ACTIVE_TEXTURE)),e.activeTexture(u),r.push(e.getParameter(o),null);break;case e.ACTIVE_TEXTURE:i=e.getParameter(e.ACTIVE_TEXTURE),r.push(null);break;default:r.push(e.getParameter(o))}for(n(e),a=0;a<t.length;++a){var o=t[a],s=r[a];switch(o){case e.ACTIVE_TEXTURE:break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,s);break;case e.COLOR_CLEAR_VALUE:e.clearColor(s[0],s[1],s[2],s[3]);break;case e.COLOR_WRITEMASK:e.colorMask(s[0],s[1],s[2],s[3]);break;case e.CURRENT_PROGRAM:e.useProgram(s);break;case e.ELEMENT_ARRAY_BUFFER_BINDING:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,s);break;case e.RENDERBUFFER_BINDING:e.bindRenderbuffer(e.RENDERBUFFER,s);break;case e.TEXTURE_BINDING_2D:if((u=t[++a])<e.TEXTURE0||u>e.TEXTURE31)break;e.activeTexture(u),e.bindTexture(e.TEXTURE_2D,s);break;case e.TEXTURE_BINDING_CUBE_MAP:var u;if((u=t[++a])<e.TEXTURE0||u>e.TEXTURE31)break;e.activeTexture(u),e.bindTexture(e.TEXTURE_CUBE_MAP,s);break;case e.VIEWPORT:e.viewport(s[0],s[1],s[2],s[3]);break;case e.BLEND:case e.CULL_FACE:case e.DEPTH_TEST:case e.SCISSOR_TEST:case e.STENCIL_TEST:s?e.enable(o):e.disable(o);break;default:console.log("No GL restore behavior for 0x"+o.toString(16))}i&&e.activeTexture(i)}}else n(e)}var k=N,F=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join("\n"),B=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join("\n");function U(e,t,n,r){this.gl=e,this.cardboardUI=t,this.bufferScale=n,this.dirtySubmitFrameBindings=r,this.ctxAttribs=e.getContextAttributes(),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=e.drawingBufferWidth,this.bufferHeight=e.drawingBufferHeight,this.realBindFramebuffer=e.bindFramebuffer,this.realEnable=e.enable,this.realDisable=e.disable,this.realColorMask=e.colorMask,this.realClearColor=e.clearColor,this.realViewport=e.viewport,c()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=S(e,F,B,this.attribs),this.uniforms=w(e,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.indexCount=0,this.renderTarget=e.createTexture(),this.framebuffer=e.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=e.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=e.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=e.createRenderbuffer()),this.patch(),this.onResize()}U.prototype.destroy=function(){var e=this.gl;this.unpatch(),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.indexBuffer),e.deleteTexture(this.renderTarget),e.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&e.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&e.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&e.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},U.prototype.onResize=function(){var e=this.gl,t=this,n=[e.RENDERBUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0];k(e,n,(function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.framebuffer),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.texImage2D(e.TEXTURE_2D,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,t.bufferWidth,t.bufferHeight,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.renderTarget,0),t.ctxAttribs.depth&&t.ctxAttribs.stencil?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthStencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t.depthStencilBuffer)):t.ctxAttribs.depth?(e.bindRenderbuffer(e.RENDERBUFFER,t.depthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t.depthBuffer)):t.ctxAttribs.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,t.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.STENCIL_INDEX8,t.bufferWidth,t.bufferHeight),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,t.stencilBuffer)),!e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),t.realClearColor.apply(e,t.clearColor)})),this.cardboardUI&&this.cardboardUI.onResize()},U.prototype.patch=function(){if(!this.isPatched){var e=this,t=this.gl.canvas,n=this.gl;c()||(t.width=y()*this.bufferScale,t.height=_()*this.bufferScale,Object.defineProperty(t,"width",{configurable:!0,enumerable:!0,get:function(){return e.bufferWidth},set:function(n){e.bufferWidth=n,e.realCanvasWidth.set.call(t,n),e.onResize()}}),Object.defineProperty(t,"height",{configurable:!0,enumerable:!0,get:function(){return e.bufferHeight},set:function(n){e.bufferHeight=n,e.realCanvasHeight.set.call(t,n),e.onResize()}})),this.lastBoundFramebuffer=n.getParameter(n.FRAMEBUFFER_BINDING),null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(t,r){e.lastBoundFramebuffer=r||e.framebuffer,e.realBindFramebuffer.call(n,t,e.lastBoundFramebuffer)},this.cullFace=n.getParameter(n.CULL_FACE),this.depthTest=n.getParameter(n.DEPTH_TEST),this.blend=n.getParameter(n.BLEND),this.scissorTest=n.getParameter(n.SCISSOR_TEST),this.stencilTest=n.getParameter(n.STENCIL_TEST),n.enable=function(t){switch(t){case n.CULL_FACE:e.cullFace=!0;break;case n.DEPTH_TEST:e.depthTest=!0;break;case n.BLEND:e.blend=!0;break;case n.SCISSOR_TEST:e.scissorTest=!0;break;case n.STENCIL_TEST:e.stencilTest=!0}e.realEnable.call(n,t)},n.disable=function(t){switch(t){case n.CULL_FACE:e.cullFace=!1;break;case n.DEPTH_TEST:e.depthTest=!1;break;case n.BLEND:e.blend=!1;break;case n.SCISSOR_TEST:e.scissorTest=!1;break;case n.STENCIL_TEST:e.stencilTest=!1}e.realDisable.call(n,t)},this.colorMask=n.getParameter(n.COLOR_WRITEMASK),n.colorMask=function(t,r,i,a){e.colorMask[0]=t,e.colorMask[1]=r,e.colorMask[2]=i,e.colorMask[3]=a,e.realColorMask.call(n,t,r,i,a)},this.clearColor=n.getParameter(n.COLOR_CLEAR_VALUE),n.clearColor=function(t,r,i,a){e.clearColor[0]=t,e.clearColor[1]=r,e.clearColor[2]=i,e.clearColor[3]=a,e.realClearColor.call(n,t,r,i,a)},this.viewport=n.getParameter(n.VIEWPORT),n.viewport=function(t,r,i,a){e.viewport[0]=t,e.viewport[1]=r,e.viewport[2]=i,e.viewport[3]=a,e.realViewport.call(n,t,r,i,a)},this.isPatched=!0,C(t)}},U.prototype.unpatch=function(){if(this.isPatched){var e=this.gl,t=this.gl.canvas;c()||(Object.defineProperty(t,"width",this.realCanvasWidth),Object.defineProperty(t,"height",this.realCanvasHeight)),t.width=this.bufferWidth,t.height=this.bufferHeight,e.bindFramebuffer=this.realBindFramebuffer,e.enable=this.realEnable,e.disable=this.realDisable,e.colorMask=this.realColorMask,e.clearColor=this.realClearColor,e.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&e.bindFramebuffer(e.FRAMEBUFFER,null),this.isPatched=!1,setTimeout((function(){C(t)}),1)}},U.prototype.setTextureBounds=function(e,t){e||(e=[0,0,.5,1]),t||(t=[.5,0,.5,1]),this.viewportOffsetScale[0]=e[0],this.viewportOffsetScale[1]=e[1],this.viewportOffsetScale[2]=e[2],this.viewportOffsetScale[3]=e[3],this.viewportOffsetScale[4]=t[0],this.viewportOffsetScale[5]=t[1],this.viewportOffsetScale[6]=t[2],this.viewportOffsetScale[7]=t[3]},U.prototype.submitFrame=function(){var e=this.gl,t=this,n=[];if(this.dirtySubmitFrameBindings||n.push(e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0),k(e,n,(function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null),t.cullFace&&t.realDisable.call(e,e.CULL_FACE),t.depthTest&&t.realDisable.call(e,e.DEPTH_TEST),t.blend&&t.realDisable.call(e,e.BLEND),t.scissorTest&&t.realDisable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realDisable.call(e,e.STENCIL_TEST),t.realColorMask.call(e,!0,!0,!0,!0),t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight),(t.ctxAttribs.alpha||c())&&(t.realClearColor.call(e,0,0,0,1),e.clear(e.COLOR_BUFFER_BIT)),e.useProgram(t.program),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.indexBuffer),e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.enableVertexAttribArray(t.attribs.position),e.enableVertexAttribArray(t.attribs.texCoord),e.vertexAttribPointer(t.attribs.position,2,e.FLOAT,!1,20,0),e.vertexAttribPointer(t.attribs.texCoord,3,e.FLOAT,!1,20,8),e.activeTexture(e.TEXTURE0),e.uniform1i(t.uniforms.diffuse,0),e.bindTexture(e.TEXTURE_2D,t.renderTarget),e.uniform4fv(t.uniforms.viewportOffsetScale,t.viewportOffsetScale),e.drawElements(e.TRIANGLES,t.indexCount,e.UNSIGNED_SHORT,0),t.cardboardUI&&t.cardboardUI.renderNoState(),t.realBindFramebuffer.call(t.gl,e.FRAMEBUFFER,t.framebuffer),t.ctxAttribs.preserveDrawingBuffer||(t.realClearColor.call(e,0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),t.dirtySubmitFrameBindings||t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer),t.cullFace&&t.realEnable.call(e,e.CULL_FACE),t.depthTest&&t.realEnable.call(e,e.DEPTH_TEST),t.blend&&t.realEnable.call(e,e.BLEND),t.scissorTest&&t.realEnable.call(e,e.SCISSOR_TEST),t.stencilTest&&t.realEnable.call(e,e.STENCIL_TEST),t.realColorMask.apply(e,t.colorMask),t.realViewport.apply(e,t.viewport),!t.ctxAttribs.alpha&&t.ctxAttribs.preserveDrawingBuffer||t.realClearColor.apply(e,t.clearColor)})),c()){var r=e.canvas;r.width==t.bufferWidth&&r.height==t.bufferHeight||(t.bufferWidth=r.width,t.bufferHeight=r.height,t.onResize())}},U.prototype.updateDeviceInfo=function(e){var t=this.gl,n=this,r=[t.ARRAY_BUFFER_BINDING,t.ELEMENT_ARRAY_BUFFER_BINDING];k(t,r,(function(t){var r=n.computeMeshVertices_(n.meshWidth,n.meshHeight,e);if(t.bindBuffer(t.ARRAY_BUFFER,n.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),!n.indexCount){var i=n.computeMeshIndices_(n.meshWidth,n.meshHeight);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t.STATIC_DRAW),n.indexCount=i.length}}))},U.prototype.computeMeshVertices_=function(e,t,n){for(var r=new Float32Array(2*e*t*5),i=n.getLeftEyeVisibleTanAngles(),a=n.getLeftEyeNoLensTanAngles(),o=n.getLeftEyeVisibleScreenRect(a),s=0,u=0;u<2;u++){for(var c=0;c<t;c++)for(var d=0;d<e;d++,s++){var h=d/(e-1),f=c/(t-1),p=h,m=f,g=l(i[0],i[2],h),v=l(i[3],i[1],f),y=Math.sqrt(g*g+v*v),_=n.distortion.distortInverse(y),b=v*_/y;h=(g*_/y-a[0])/(a[2]-a[0]),f=(b-a[3])/(a[1]-a[3]),h=2*(o.x+h*o.width-.5),f=2*(o.y+f*o.height-.5),r[5*s+0]=h,r[5*s+1]=f,r[5*s+2]=p,r[5*s+3]=m,r[5*s+4]=u}var E=i[2]-i[0];i[0]=-(E+i[0]),i[2]=E-i[2],E=a[2]-a[0],a[0]=-(E+a[0]),a[2]=E-a[2],o.x=1-(o.x+o.width)}return r},U.prototype.computeMeshIndices_=function(e,t){for(var n=new Uint16Array(2*(e-1)*(t-1)*6),r=e/2,i=t/2,a=0,o=0,s=0;s<2;s++)for(var u=0;u<t;u++)for(var l=0;l<e;l++,a++)0!=l&&0!=u&&(l<=r==u<=i?(n[o++]=a,n[o++]=a-e-1,n[o++]=a-e,n[o++]=a-e-1,n[o++]=a,n[o++]=a-1):(n[o++]=a-1,n[o++]=a-e,n[o++]=a,n[o++]=a-e,n[o++]=a-1,n[o++]=a-e-1));return n},U.prototype.getOwnPropertyDescriptor_=function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return void 0!==n.get&&void 0!==n.set||(n.configurable=!0,n.enumerable=!0,n.get=function(){return this.getAttribute(t)},n.set=function(e){this.setAttribute(t,e)}),n};var j=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join("\n"),G=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join("\n"),H=Math.PI/180,V=60,z=12,W=20,q=1,Y=.75,K=.3125,X=4,Q=28,Z=1.5;function J(e){this.gl=e,this.attribs={position:0},this.program=S(e,j,G,this.attribs),this.uniforms=w(e,this.program),this.vertexBuffer=e.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}function $(e){this.coefficients=e}J.prototype.destroy=function(){var e=this.gl;this.listener&&e.canvas.removeEventListener("click",this.listener,!1),e.deleteProgram(this.program),e.deleteBuffer(this.vertexBuffer)},J.prototype.listen=function(e,t){var n=this.gl.canvas;this.listener=function(r){var i=n.clientWidth/2,a=Q*Z;r.clientX>i-a&&r.clientX<i+a&&r.clientY>n.clientHeight-a?e(r):r.clientX<a&&r.clientY<a&&t(r)},n.addEventListener("click",this.listener,!1)},J.prototype.onResize=function(){var e=this.gl,t=this,n=[e.ARRAY_BUFFER_BINDING];k(e,n,(function(e){var n=[],r=e.drawingBufferWidth/2,i=Math.max(screen.width,screen.height)*window.devicePixelRatio,a=e.drawingBufferWidth/i*window.devicePixelRatio,o=X*a/2,s=Q*Z*a,u=Q*a/2,l=(Q*Z-Q)*a;function c(e,t){var i=(90-e)*H,a=Math.cos(i),o=Math.sin(i);n.push(K*a*u+r,K*o*u+u),n.push(t*a*u+r,t*o*u+u)}n.push(r-o,s),n.push(r-o,e.drawingBufferHeight),n.push(r+o,s),n.push(r+o,e.drawingBufferHeight),t.gearOffset=n.length/2;for(var d=0;d<=6;d++){var h=d*V;c(h,q),c(h+z,q),c(h+W,Y),c(h+(V-W),Y),c(h+(V-z),q)}function f(t,r){n.push(l+t,e.drawingBufferHeight-l-r)}t.gearVertexCount=n.length/2-t.gearOffset,t.arrowOffset=n.length/2;var p=o/Math.sin(45*H);f(0,u),f(u,0),f(u+p,p),f(p,u+p),f(p,u-p),f(0,u),f(u,2*u),f(u+p,2*u-p),f(p,u-p),f(0,u),f(p,u-o),f(Q*a,u-o),f(p,u+o),f(Q*a,u+o),t.arrowVertexCount=n.length/2-t.arrowOffset,e.bindBuffer(e.ARRAY_BUFFER,t.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(n),e.STATIC_DRAW)}))},J.prototype.render=function(){var e=this.gl,t=this,n=[e.CULL_FACE,e.DEPTH_TEST,e.BLEND,e.SCISSOR_TEST,e.STENCIL_TEST,e.COLOR_WRITEMASK,e.VIEWPORT,e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING];k(e,n,(function(e){e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.BLEND),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.colorMask(!0,!0,!0,!0),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),t.renderNoState()}))},J.prototype.renderNoState=function(){var e=this.gl;e.useProgram(this.program),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.enableVertexAttribArray(this.attribs.position),e.vertexAttribPointer(this.attribs.position,2,e.FLOAT,!1,8,0),e.uniform4f(this.uniforms.color,1,1,1,1),A(this.projMat,0,e.drawingBufferWidth,0,e.drawingBufferHeight,.1,1024),e.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.drawArrays(e.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),e.drawArrays(e.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)},$.prototype.distortInverse=function(e){for(var t=0,n=1,r=e-this.distort(t);Math.abs(n-t)>1e-4;){var i=e-this.distort(n),a=n-i*((n-t)/(i-r));t=n,n=a,r=i}return n},$.prototype.distort=function(e){for(var t=e*e,n=0,r=0;r<this.coefficients.length;r++)n=t*(n+this.coefficients[r]);return(n+1)*e};var ee=Math.PI/180,te=180/Math.PI,ne=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0};ne.prototype={constructor:ne,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=this.length();if(0!==e){var t=1/e;this.multiplyScalar(t)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(e){this.x*=e,this.y*=e,this.z*=e},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,u=s*t+a*r-o*n,l=s*n+o*t-i*r,c=s*r+i*n-a*t,d=-i*t-a*n-o*r;return this.x=u*s+d*-i+l*-o-c*-a,this.y=l*s+d*-a+c*-i-u*-o,this.z=c*s+d*-o+u*-a-l*-i,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this}};var re,ie,ae,oe=function(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1};function se(e){this.width=e.width||y(),this.height=e.height||_(),this.widthMeters=e.widthMeters,this.heightMeters=e.heightMeters,this.bevelMeters=e.bevelMeters}oe.prototype={constructor:oe,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEulerXYZ:function(e,t,n){var r=Math.cos(e/2),i=Math.cos(t/2),a=Math.cos(n/2),o=Math.sin(e/2),s=Math.sin(t/2),u=Math.sin(n/2);return this.x=o*i*a+r*s*u,this.y=r*s*a-o*i*u,this.z=r*i*u+o*s*a,this.w=r*i*a-o*s*u,this},setFromEulerYXZ:function(e,t,n){var r=Math.cos(e/2),i=Math.cos(t/2),a=Math.cos(n/2),o=Math.sin(e/2),s=Math.sin(t/2),u=Math.sin(n/2);return this.x=o*i*a+r*s*u,this.y=r*s*a-o*i*u,this.z=r*i*u-o*s*a,this.w=r*i*a+o*s*u,this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this.x=e.x*r,this.y=e.y*r,this.z=e.z*r,this.w=Math.cos(n),this},multiply:function(e){return this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e.x,r=e.y,i=e.z,a=e.w,o=t.x,s=t.y,u=t.z,l=t.w;return this.x=n*l+a*o+r*u-i*s,this.y=r*l+a*s+i*o-n*u,this.z=i*l+a*u+n*s-r*o,this.w=a*l-n*o-r*s-i*u,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===e?(this.x=0,this.y=0,this.z=0,this.w=1):(e=1/e,this.x=this.x*e,this.y=this.y*e,this.z=this.z*e,this.w=this.w*e),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this.x,r=this.y,i=this.z,a=this.w,o=a*e.w+n*e.x+r*e.y+i*e.z;if(o<0?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,o=-o):this.copy(e),o>=1)return this.w=a,this.x=n,this.y=r,this.z=i,this;var s=Math.acos(o),u=Math.sqrt(1-o*o);if(Math.abs(u)<.001)return this.w=.5*(a+this.w),this.x=.5*(n+this.x),this.y=.5*(r+this.y),this.z=.5*(i+this.z),this;var l=Math.sin((1-t)*s)/u,c=Math.sin(t*s)/u;return this.w=a*l+this.w*c,this.x=n*l+this.x*c,this.y=r*l+this.y*c,this.z=i*l+this.z*c,this},setFromUnitVectors:(ae=1e-6,function(e,t){return void 0===re&&(re=new ne),(ie=e.dot(t)+1)<ae?(ie=0,Math.abs(e.x)>Math.abs(e.z)?re.set(-e.y,e.x,0):re.set(0,-e.z,e.y)):re.crossVectors(e,t),this.x=re.x,this.y=re.y,this.z=re.z,this.w=ie,this.normalize(),this})};var ue=new se({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),le=new se({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),ce={CardboardV1:new he({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new he({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function de(e,t){this.viewer=ce.CardboardV2,this.updateDeviceParams(e),this.distortion=new $(this.viewer.distortionCoefficients);for(var n=0;n<t.length;n++){var r=t[n];ce[r.id]=new he(r)}}function he(e){this.id=e.id,this.label=e.label,this.fov=e.fov,this.interLensDistance=e.interLensDistance,this.baselineLensDistance=e.baselineLensDistance,this.screenLensDistance=e.screenLensDistance,this.distortionCoefficients=e.distortionCoefficients,this.inverseCoefficients=e.inverseCoefficients}de.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device},de.prototype.getDevice=function(){return this.device},de.prototype.setViewer=function(e){this.viewer=e,this.distortion=new $(this.viewer.distortionCoefficients)},de.prototype.determineDevice_=function(e){if(!e)return c()?(console.warn("Using fallback iOS device measurements."),le):(console.warn("Using fallback Android device measurements."),ue);var t=.0254,n=t/e.xdpi,r=t/e.ydpi;return new se({widthMeters:n*y(),heightMeters:r*_(),bevelMeters:.001*e.bevelMm})},de.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer,t=this.device,n=this.distortion,r=e.screenLensDistance,i=(t.widthMeters-e.interLensDistance)/2,a=e.interLensDistance/2,o=e.baselineLensDistance-t.bevelMeters,s=t.heightMeters-o,u=te*Math.atan(n.distort(i/r)),l=te*Math.atan(n.distort(a/r)),c=te*Math.atan(n.distort(o/r)),d=te*Math.atan(n.distort(s/r));return{leftDegrees:Math.min(u,e.fov),rightDegrees:Math.min(l,e.fov),downDegrees:Math.min(c,e.fov),upDegrees:Math.min(d,e.fov)}},de.prototype.getLeftEyeVisibleTanAngles=function(){var e=this.viewer,t=this.device,n=this.distortion,r=Math.tan(-ee*e.fov),i=Math.tan(ee*e.fov),a=Math.tan(ee*e.fov),o=Math.tan(-ee*e.fov),s=t.widthMeters/4,u=t.heightMeters/2,l=e.baselineLensDistance-t.bevelMeters-u,c=e.interLensDistance/2-s,d=-l,h=e.screenLensDistance,f=n.distort((c-s)/h),p=n.distort((d+u)/h),m=n.distort((c+s)/h),g=n.distort((d-u)/h),v=new Float32Array(4);return v[0]=Math.max(r,f),v[1]=Math.min(i,p),v[2]=Math.min(a,m),v[3]=Math.max(o,g),v},de.prototype.getLeftEyeNoLensTanAngles=function(){var e=this.viewer,t=this.device,n=this.distortion,r=new Float32Array(4),i=n.distortInverse(Math.tan(-ee*e.fov)),a=n.distortInverse(Math.tan(ee*e.fov)),o=n.distortInverse(Math.tan(ee*e.fov)),s=n.distortInverse(Math.tan(-ee*e.fov)),u=t.widthMeters/4,l=t.heightMeters/2,c=e.baselineLensDistance-t.bevelMeters-l,d=e.interLensDistance/2-u,h=-c,f=e.screenLensDistance,p=(d-u)/f,m=(h+l)/f,g=(d+u)/f,v=(h-l)/f;return r[0]=Math.max(i,p),r[1]=Math.min(a,m),r[2]=Math.min(o,g),r[3]=Math.max(s,v),r},de.prototype.getLeftEyeVisibleScreenRect=function(e){var t=this.viewer,n=this.device,r=t.screenLensDistance,i=(n.widthMeters-t.interLensDistance)/2,a=t.baselineLensDistance-n.bevelMeters,o=(e[0]*r+i)/n.widthMeters,s=(e[1]*r+a)/n.heightMeters,u=(e[2]*r+i)/n.widthMeters,l=(e[3]*r+a)/n.heightMeters;return{x:o,y:l,width:u-o,height:s-l}},de.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},de.prototype.getFieldOfViewRightEye=function(e){var t=this.getFieldOfViewLeftEye(e);return{leftDegrees:t.rightDegrees,rightDegrees:t.leftDegrees,upDegrees:t.upDegrees,downDegrees:t.downDegrees}},de.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:te*Math.atan(e.outerDist),rightDegrees:te*Math.atan(e.innerDist),downDegrees:te*Math.atan(e.bottomDist),upDegrees:te*Math.atan(e.topDist)}},de.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_(),t=this.viewer,n=this.device,r=t.screenLensDistance,i=n.widthMeters/r,a=n.heightMeters/r,o=n.width/i,s=n.height/a,u=Math.round((e.eyePosX-e.outerDist)*o),l=Math.round((e.eyePosY-e.bottomDist)*s);return{x:u,y:l,width:Math.round((e.eyePosX+e.innerDist)*o)-u,height:Math.round((e.eyePosY+e.topDist)*s)-l}},de.prototype.getUndistortedParams_=function(){var e=this.viewer,t=this.device,n=this.distortion,r=e.screenLensDistance,i=e.interLensDistance/2/r,a=t.widthMeters/r,o=t.heightMeters/r,s=a/2-i,u=(e.baselineLensDistance-t.bevelMeters)/r,l=e.fov,c=n.distortInverse(Math.tan(ee*l)),d=Math.min(s,c),h=Math.min(i,c),f=Math.min(u,c);return{outerDist:d,innerDist:h,topDist:Math.min(o-u,c),bottomDist:f,eyePosX:s,eyePosY:u}},de.Viewers=ce;var fe={format:1,last_updated:"2019-11-09T17:36:14Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}]};function pe(e,t){if(this.dpdb=fe,this.recalculateDeviceParams_(),e){this.onDeviceParamsUpdated=t;var n=new XMLHttpRequest,r=this;n.open("GET",e,!0),n.addEventListener("load",(function(){r.loading=!1,n.status>=200&&n.status<=299?(r.dpdb=JSON.parse(n.response),r.recalculateDeviceParams_()):console.error("Error loading online DPDB!")})),n.send()}}function me(e){this.xdpi=e.xdpi,this.ydpi=e.ydpi,this.bevelMm=e.bevelMm}function ge(e,t){this.set(e,t)}function ve(e,t){this.kFilter=e,this.isDebug=t,this.currentAccelMeasurement=new ge,this.currentGyroMeasurement=new ge,this.previousGyroMeasurement=new ge,c()?this.filterQ=new oe(-1,0,0,1):this.filterQ=new oe(1,0,0,1),this.previousFilterQ=new oe,this.previousFilterQ.copy(this.filterQ),this.accelQ=new oe,this.isOrientationInitialized=!1,this.estimatedGravity=new ne,this.measuredGravity=new ne,this.gyroIntegralQ=new oe}function ye(e,t){this.predictionTimeS=e,this.isDebug=t,this.previousQ=new oe,this.previousTimestampS=null,this.deltaQ=new oe,this.outQ=new oe}function _e(e,t,n,r){this.yawOnly=n,this.accelerometer=new ne,this.gyroscope=new ne,this.filter=new ve(e,r),this.posePredictor=new ye(t,r),this.isFirefoxAndroid=h(),this.isIOS=c();var i=f();this.isDeviceMotionInRadians=!this.isIOS&&i&&i<66,this.isWithoutDeviceMotion=p(),this.filterToWorldQ=new oe,c()?this.filterToWorldQ.setFromAxisAngle(new ne(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new ne(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new oe,this.worldToScreenQ=new oe,this.originalPoseAdjustQ=new oe,this.originalPoseAdjustQ.setFromAxisAngle(new ne(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),g()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new oe,this.orientationOut_=new Float32Array(4),this.start()}pe.prototype.getDeviceParams=function(){return this.deviceParams},pe.prototype.recalculateDeviceParams_=function(){var e=this.calcDeviceParams_();e?(this.deviceParams=e,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},pe.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e)return console.error("DPDB not available."),null;if(1!=e.format)return console.error("DPDB has unexpected format version."),null;if(!e.devices||!e.devices.length)return console.error("DPDB does not have a devices section."),null;var t=navigator.userAgent||navigator.vendor||window.opera,n=y(),r=_();if(!e.devices)return console.error("DPDB has no devices section."),null;for(var i=0;i<e.devices.length;i++){var a=e.devices[i];if(a.rules)if("ios"==a.type||"android"==a.type){if(c()==("ios"==a.type)){for(var o=!1,s=0;s<a.rules.length;s++){var u=a.rules[s];if(this.ruleMatches_(u,t,n,r)){o=!0;break}}if(o)return new me({xdpi:a.dpi[0]||a.dpi,ydpi:a.dpi[1]||a.dpi,bevelMm:a.bw})}}else console.warn("Device["+i+"] has invalid type.");else console.warn("Device["+i+"] has no rules section.")}return console.warn("No DPDB device match."),null},pe.prototype.ruleMatches_=function(e,t,n,r){if(!e.ua&&!e.res)return!1;if(e.ua&&"SM"===e.ua.substring(0,2)&&(e.ua=e.ua.substring(0,7)),e.ua&&t.indexOf(e.ua)<0)return!1;if(e.res){if(!e.res[0]||!e.res[1])return!1;var i=e.res[0],a=e.res[1];if(Math.min(n,r)!=Math.min(i,a)||Math.max(n,r)!=Math.max(i,a))return!1}return!0},ge.prototype.set=function(e,t){this.sample=e,this.timestampS=t},ge.prototype.copy=function(e){this.set(e.sample,e.timestampS)},ve.prototype.addAccelMeasurement=function(e,t){this.currentAccelMeasurement.set(e,t)},ve.prototype.addGyroMeasurement=function(e,t){this.currentGyroMeasurement.set(e,t);var n=t-this.previousGyroMeasurement.timestampS;v(n)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},ve.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(t);var n=new oe;n.copy(this.filterQ),n.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(n),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var r=new oe;r.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),r.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",te*D(r),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var i=new oe;i.copy(this.filterQ),i.multiply(r),this.filterQ.slerp(i,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},ve.prototype.getOrientation=function(){return this.filterQ},ve.prototype.accelToQuaternion_=function(e){var t=new ne;t.copy(e),t.normalize();var n=new oe;return n.setFromUnitVectors(new ne(0,0,-1),t),n.inverse(),n},ve.prototype.gyroToQuaternionDelta_=function(e,t){var n=new oe,r=new ne;return r.copy(e),r.normalize(),n.setFromAxisAngle(r,e.length()*t),n},ye.prototype.getPrediction=function(e,t,n){if(!this.previousTimestampS)return this.previousQ.copy(e),this.previousTimestampS=n,e;var r=new ne;r.copy(t),r.normalize();var i=t.length();if(i<20*ee)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(te*i).toFixed(1)),this.outQ.copy(e),this.previousQ.copy(e),this.outQ;var a=i*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(r,a),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(e),this.previousTimestampS=n,this.outQ},_e.prototype.getPosition=function(){return null},_e.prototype.getOrientation=function(){var e=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ)return this.deviceOrientationFixQ=this.deviceOrientationFixQ||(n=(new oe).setFromAxisAngle(new ne(0,0,-1),0),r=new oe,-90===window.orientation?r.setFromAxisAngle(new ne(0,1,0),Math.PI/-2):r.setFromAxisAngle(new ne(0,1,0),Math.PI/2),n.multiply(r)),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||((t=new oe).setFromAxisAngle(new ne(1,0,0),-Math.PI/2),t),e=this._deviceOrientationQ,(i=new oe).copy(e),i.multiply(this.deviceOrientationFilterToWorldQ),i.multiply(this.resetQ),i.multiply(this.worldToScreenQ),i.multiplyQuaternions(this.deviceOrientationFixQ,i),this.yawOnly&&(i.x=0,i.z=0,i.normalize()),this.orientationOut_[0]=i.x,this.orientationOut_[1]=i.y,this.orientationOut_[2]=i.z,this.orientationOut_[3]=i.w,this.orientationOut_;var t,n,r,i,a=this.filter.getOrientation();return e=this.posePredictor.getPrediction(a,this.gyroscope,this.previousTimestampS),(i=new oe).copy(this.filterToWorldQ),i.multiply(this.resetQ),i.multiply(e),i.multiply(this.worldToScreenQ),this.yawOnly&&(i.x=0,i.z=0,i.normalize()),this.orientationOut_[0]=i.x,this.orientationOut_[1]=i.y,this.orientationOut_[2]=i.z,this.orientationOut_[3]=i.w,this.orientationOut_},_e.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),g()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},_e.prototype.onDeviceOrientation_=function(e){this._deviceOrientationQ=this._deviceOrientationQ||new oe;var t=e.alpha,n=e.beta,r=e.gamma;t=(t||0)*Math.PI/180,n=(n||0)*Math.PI/180,r=(r||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(n,t,-r)},_e.prototype.onDeviceMotion_=function(e){this.updateDeviceMotion_(e)},_e.prototype.updateDeviceMotion_=function(e){var t=e.accelerationIncludingGravity,n=e.rotationRate,r=e.timeStamp/1e3,i=r-this.previousTimestampS;return i<0?(P("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),void(this.previousTimestampS=r)):i<=o||i>s?(P("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),void(this.previousTimestampS=r)):(this.accelerometer.set(-t.x,-t.y,-t.z),m()?this.gyroscope.set(-n.beta,n.alpha,n.gamma):this.gyroscope.set(n.alpha,n.beta,n.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,r),this.filter.addGyroMeasurement(this.gyroscope,r),void(this.previousTimestampS=r))},_e.prototype.onOrientationChange_=function(e){this.setScreenTransform_()},_e.prototype.onMessage_=function(e){var t=e.data;t&&t.type&&"devicemotion"===t.type.toLowerCase()&&this.updateDeviceMotion_(t.deviceMotionEvent)},_e.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new ne(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new ne(0,0,1),Math.PI/2)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},_e.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),c()&&I()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},_e.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var be=60,Ee=new ne(1,0,0),Te=new ne(0,0,1),Se=new oe;Se.setFromAxisAngle(Ee,-Math.PI/2),Se.multiply((new oe).setFromAxisAngle(Te,Math.PI/2));var we=function(){function e(t){r(this,e),this.config=t,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new oe,this._outQ=new oe,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return i(e,[{key:"init",value:function(){var e=null;try{(e=new RelativeOrientationSensor({frequency:be,referenceFrame:"screen"})).addEventListener("error",this._onSensorError)}catch(e){this.errors.push(e),"SecurityError"===e.name?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):"ReferenceError"===e.name?this.useDeviceMotion():console.error(e)}e&&(this.api="sensor",this.sensor=e,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new _e(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var e=this.sensor.quaternion;this._sensorQ.set(e[0],e[1],e[2],e[3]);var t=this._outQ;return t.copy(Se),t.multiply(this._sensorQ),this.config.YAW_ONLY&&(t.x=t.z=0,t.normalize()),this._out[0]=t.x,this._out[1]=t.y,this._out[2]=t.z,this._out[3]=t.w,this._out}},{key:"_onSensorError",value:function(e){this.errors.push(e.error),"NotAllowedError"===e.error.name?console.error("Permission to access sensor was denied"):"NotReadableError"===e.error.name?console.error("Sensor could not be read"):console.error(e.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),e}(),Ae="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function xe(){this.loadIcon_();var e=document.createElement("div");(a=e.style).position="fixed",a.top=0,a.right=0,a.bottom=0,a.left=0,a.backgroundColor="gray",a.fontFamily="sans-serif",a.zIndex=1e6;var t=document.createElement("img");t.src=this.icon,(a=t.style).marginLeft="25%",a.marginTop="25%",a.width="50%",e.appendChild(t);var n=document.createElement("div");(a=n.style).textAlign="center",a.fontSize="16px",a.lineHeight="24px",a.margin="24px 25%",a.width="50%",n.innerHTML="Place your phone into your Cardboard viewer.",e.appendChild(n);var r=document.createElement("div");(a=r.style).backgroundColor="#CFD8DC",a.position="fixed",a.bottom=0,a.width="100%",a.height="48px",a.padding="14px 24px",a.boxSizing="border-box",a.color="#656A6B",e.appendChild(r);var i=document.createElement("div");i.style.float="left",i.innerHTML="No Cardboard viewer?";var a,o=document.createElement("a");o.href="https://www.google.com/get/cardboard/get-cardboard/",o.innerHTML="get one",o.target="_blank",(a=o.style).float="right",a.fontWeight=600,a.textTransform="uppercase",a.borderLeft="1px solid gray",a.paddingLeft="24px",a.textDecoration="none",a.color="#656A6B",r.appendChild(i),r.appendChild(o),this.overlay=e,this.text=n,this.hide()}xe.prototype.show=function(e){e||this.overlay.parentElement?e&&(this.overlay.parentElement&&this.overlay.parentElement!=e&&this.overlay.parentElement.removeChild(this.overlay),e.appendChild(this.overlay)):document.body.appendChild(this.overlay),this.overlay.style.display="block";var t=this.overlay.querySelector("img").style;g()?(t.width="20%",t.marginLeft="40%",t.marginTop="3%"):(t.width="50%",t.marginLeft="25%",t.marginTop="25%")},xe.prototype.hide=function(){this.overlay.style.display="none"},xe.prototype.showTemporarily=function(e,t){this.show(t),this.timer=setTimeout(this.hide.bind(this),e)},xe.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},xe.prototype.update=function(){this.disableShowTemporarily(),!g()&&x()?this.show():this.hide()},xe.prototype.loadIcon_=function(){this.icon=u("image/svg+xml",Ae)};var Me="CardboardV1",Ce="WEBVR_CARDBOARD_VIEWER",Re="webvr-polyfill-viewer-selector";function Ie(e){try{this.selectedKey=localStorage.getItem(Ce)}catch(e){console.error("Failed to load viewer profile: %s",e)}this.selectedKey||(this.selectedKey=e||Me),this.dialog=this.createDialog_(de.Viewers),this.root=null,this.onChangeCallbacks_=[]}function Oe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function De(e,t){return e(t={exports:{}},t.exports),t.exports}Ie.prototype.show=function(e){this.root=e,e.appendChild(this.dialog),this.dialog.querySelector("#"+this.selectedKey).checked=!0,this.dialog.style.display="block"},Ie.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},Ie.prototype.getCurrentViewer=function(){return de.Viewers[this.selectedKey]},Ie.prototype.getSelectedKey_=function(){var e=this.dialog.querySelector("input[name=field]:checked");return e?e.id:null},Ie.prototype.onChange=function(e){this.onChangeCallbacks_.push(e)},Ie.prototype.fireOnChange_=function(e){for(var t=0;t<this.onChangeCallbacks_.length;t++)this.onChangeCallbacks_[t](e)},Ie.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),this.selectedKey&&de.Viewers[this.selectedKey]){this.fireOnChange_(de.Viewers[this.selectedKey]);try{localStorage.setItem(Ce,this.selectedKey)}catch(e){console.error("Failed to save viewer profile: %s",e)}this.hide()}else console.error("ViewerSelector.onSave_: this should never happen!")},Ie.prototype.createDialog_=function(e){var t=document.createElement("div");t.classList.add(Re),t.style.display="none";var n=document.createElement("div");(a=n.style).position="fixed",a.left=0,a.top=0,a.width="100%",a.height="100%",a.background="rgba(0, 0, 0, 0.3)",n.addEventListener("click",this.hide.bind(this));var r=280,i=document.createElement("div"),a=i.style;for(var o in a.boxSizing="border-box",a.position="fixed",a.top="24px",a.left="50%",a.marginLeft=-r/2+"px",a.width=r+"px",a.padding="24px",a.overflow="hidden",a.background="#fafafa",a.fontFamily="'Roboto', sans-serif",a.boxShadow="0px 5px 20px #666",i.appendChild(this.createH1_("Select your viewer")),e)i.appendChild(this.createChoice_(o,e[o].label));return i.appendChild(this.createButton_("Save",this.onSave_.bind(this))),t.appendChild(n),t.appendChild(i),t},Ie.prototype.createH1_=function(e){var t=document.createElement("h1"),n=t.style;return n.color="black",n.fontSize="20px",n.fontWeight="bold",n.marginTop=0,n.marginBottom="24px",t.innerHTML=e,t},Ie.prototype.createChoice_=function(e,t){var n=document.createElement("div");n.style.marginTop="8px",n.style.color="black";var r=document.createElement("input");r.style.fontSize="30px",r.setAttribute("id",e),r.setAttribute("type","radio"),r.setAttribute("value",e),r.setAttribute("name","field");var i=document.createElement("label");return i.style.marginLeft="4px",i.setAttribute("for",e),i.innerHTML=t,n.appendChild(r),n.appendChild(i),n},Ie.prototype.createButton_=function(e,t){var n=document.createElement("button");n.innerHTML=e;var r=n.style;return r.float="right",r.textTransform="uppercase",r.color="#1094f7",r.fontSize="14px",r.letterSpacing=0,r.border=0,r.background="none",r.marginTop="16px",n.addEventListener("click",t),n},"undefined"!=typeof window?window:void 0!==nc||"undefined"!=typeof self&&self;var Pe=Oe(De((function(e,t){!function(t,n){e.exports=n()}(0,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=n(1),o="undefined"!=typeof navigator&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,s=function(){function e(){i(this,e),o?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",a),this.noSleepVideo.addEventListener("timeupdate",function(e){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return r(e,[{key:"enable",value:function(){o?(this.disable(),this.noSleepTimer=window.setInterval((function(){window.location.href="/",window.setTimeout(window.stop,0)}),15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){o?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),e}();e.exports=s},function(e,t,n){e.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])}))}))),Le=1e3,Ne=[0,0,.5,1],ke=[.5,0,.5,1],Fe=window.requestAnimationFrame,Be=window.cancelAnimationFrame;function Ue(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function je(e){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:e.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:e.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:e.canPresent},maxLayers:{writable:!1,enumerable:!0,value:e.maxLayers},hasOrientation:{enumerable:!0,get:function(){return L("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),e.hasOrientation}}})}function Ge(e){var t=!("wakelock"in(e=e||{}))||e.wakelock;this.isPolyfilled=!0,this.displayId=Le++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return L("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new je({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,t&&x()&&(this.wakelock_=new Pe)}Ge.prototype.getFrameData=function(e){return R(e,this._getPose(),this)},Ge.prototype.getPose=function(){return L("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Ge.prototype.resetPose=function(){return L("VRDisplay.prototype.resetPose"),this._resetPose()},Ge.prototype.getImmediatePose=function(){return L("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Ge.prototype.requestAnimationFrame=function(e){return Fe(e)},Ge.prototype.cancelAnimationFrame=function(e){return Be(e)},Ge.prototype.wrapForFullscreen=function(e){if(c())return e;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var t=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",t.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==e)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=e,this.originalParent_=e.parentElement,this.originalParent_||document.body.appendChild(e),!this.fullscreenWrapper_.parentElement){var n=this.fullscreenElement_.parentElement;n.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),n.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var r=this;function i(){if(r.fullscreenElement_){var e=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];r.fullscreenElement_.setAttribute("style",e.join("; ")+";")}}return i(),this.fullscreenWrapper_},Ge.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var e=this.fullscreenElement_;this.fullscreenElementCachedStyle_?e.setAttribute("style",this.fullscreenElementCachedStyle_):e.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var t=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(e),this.originalParent_===t?t.insertBefore(e,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(e),t.removeChild(this.fullscreenWrapper_),e}},Ge.prototype.requestPresent=function(e){var t=this.isPresenting,n=this;return e instanceof Array||(L("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),e=[e]),new Promise((function(r,i){if(n.capabilities.canPresent)if(0==e.length||e.length>n.capabilities.maxLayers)i(new Error("Invalid number of layers."));else{var a=e[0];if(a.source){var o=a.leftBounds||Ne,s=a.rightBounds||ke;if(t){var u=n.layer_;u.source!==a.source&&(u.source=a.source);for(var l=0;l<4;l++)u.leftBounds[l]=o[l],u.rightBounds[l]=s[l];return n.wrapForFullscreen(n.layer_.source),n.updatePresent_(),void r()}if(n.layer_={predistorted:a.predistorted,source:a.source,leftBounds:o.slice(0),rightBounds:s.slice(0)},n.waitingForPresent_=!1,n.layer_&&n.layer_.source){var h=n.wrapForFullscreen(n.layer_.source),f=function(){var e=T();n.isPresenting=h===e,n.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch((function(e){console.error("screen.orientation.lock() failed due to",e.message)})),n.waitingForPresent_=!1,n.beginPresent_(),r()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),n.removeFullscreenWrapper(),n.disableWakeLock(),n.endPresent_(),n.removeFullscreenListeners_()),n.fireVRDisplayPresentChange_()},p=function(){n.waitingForPresent_&&(n.removeFullscreenWrapper(),n.removeFullscreenListeners_(),n.disableWakeLock(),n.waitingForPresent_=!1,n.isPresenting=!1,i(new Error("Unable to present.")))};n.addFullscreenListeners_(h,f,p),b(h)?(n.enableWakeLock(),n.waitingForPresent_=!0):(c()||d())&&(n.enableWakeLock(),n.isPresenting=!0,n.beginPresent_(),n.fireVRDisplayPresentChange_(),r())}n.waitingForPresent_||c()||(E(),i(new Error("Unable to present.")))}else r()}else i(new Error("VRDisplay is not capable of presenting."))}))},Ge.prototype.exitPresent=function(){var e=this.isPresenting,t=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise((function(n,r){e?(!E()&&c()&&(t.endPresent_(),t.fireVRDisplayPresentChange_()),d()&&(t.removeFullscreenWrapper(),t.removeFullscreenListeners_(),t.endPresent_(),t.fireVRDisplayPresentChange_()),n()):r(new Error("Was not presenting to VRDisplay."))}))},Ge.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Ge.prototype.fireVRDisplayPresentChange_=function(){var e=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(e)},Ge.prototype.fireVRDisplayConnect_=function(){var e=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(e)},Ge.prototype.addFullscreenListeners_=function(e,t,n){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=e,this.fullscreenChangeHandler_=t,this.fullscreenErrorHandler_=n,t&&(document.fullscreenEnabled?e.addEventListener("fullscreenchange",t,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenchange",t,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",t,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenchange",t,!1)),n&&(document.fullscreenEnabled?e.addEventListener("fullscreenerror",n,!1):document.webkitFullscreenEnabled?e.addEventListener("webkitfullscreenerror",n,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",n,!1):document.msFullscreenEnabled&&e.addEventListener("msfullscreenerror",n,!1))},Ge.prototype.removeFullscreenListeners_=function(){if(this.fullscreenEventTarget_){var e=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var t=this.fullscreenChangeHandler_;e.removeEventListener("fullscreenchange",t,!1),e.removeEventListener("webkitfullscreenchange",t,!1),document.removeEventListener("mozfullscreenchange",t,!1),e.removeEventListener("msfullscreenchange",t,!1)}if(this.fullscreenErrorHandler_){var n=this.fullscreenErrorHandler_;e.removeEventListener("fullscreenerror",n,!1),e.removeEventListener("webkitfullscreenerror",n,!1),document.removeEventListener("mozfullscreenerror",n,!1),e.removeEventListener("msfullscreenerror",n,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Ge.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Ge.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Ge.prototype.beginPresent_=function(){},Ge.prototype.endPresent_=function(){},Ge.prototype.submitFrame=function(e){},Ge.prototype.getEyeParameters=function(e){return null};var He={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},Ve={LEFT:"left",RIGHT:"right"};function ze(e){var t=M({},He);e=M(t,e||{}),Ge.call(this,{wakelock:e.MOBILE_WAKE_LOCK}),this.config=e,this.displayName="Cardboard VRDisplay",this.capabilities=new je({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new we(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new pe(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new de(this.dpdb_.getDeviceParams(),e.ADDITIONAL_VIEWERS),this.viewerSelector_=new Ie(e.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new xe),c()&&window.addEventListener("resize",this.onResize_.bind(this))}return ze.prototype=Object.create(Ge.prototype),ze.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},ze.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},ze.prototype._getFieldOfView=function(e){var t;if(e==Ve.LEFT)t=this.deviceInfo_.getFieldOfViewLeftEye();else{if(e!=Ve.RIGHT)return console.error("Invalid eye provided: %s",e),null;t=this.deviceInfo_.getFieldOfViewRightEye()}return t},ze.prototype._getEyeOffset=function(e){var t;if(e==Ve.LEFT)t=[.5*-this.deviceInfo_.viewer.interLensDistance,0,0];else{if(e!=Ve.RIGHT)return console.error("Invalid eye provided: %s",e),null;t=[.5*this.deviceInfo_.viewer.interLensDistance,0,0]}return t},ze.prototype.getEyeParameters=function(e){var t=this._getEyeOffset(e),n=this._getFieldOfView(e),r={offset:t,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(r,"fieldOfView",{enumerable:!0,get:function(){return L("VRFieldOfView","VRFrameData's projection matrices"),n}}),r},ze.prototype.onDeviceParamsUpdated_=function(e){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},ze.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},ze.prototype.beginPresent_=function(){var e=this.layer_.source.getContext("webgl");e||(e=this.layer_.source.getContext("experimental-webgl")),e||(e=this.layer_.source.getContext("webgl2")),e&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(e.canvas.width=y()*this.bufferScale_,e.canvas.height=_()*this.bufferScale_,this.cardboardUI_=new J(e)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new J(e)),this.distorter_=new U(e,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(e){this.viewerSelector_.show(this.layer_.source.parentElement),e.stopPropagation(),e.preventDefault()}.bind(this),function(e){this.exitPresent(),e.stopPropagation(),e.preventDefault()}.bind(this)),this.rotateInstructions_&&(g()&&x()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},ze.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},ze.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},ze.prototype.submitFrame=function(e){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var t=this.layer_.source.getContext("webgl");t||(t=this.layer_.source.getContext("experimental-webgl")),t||(t=this.layer_.source.getContext("webgl2"));var n=t.canvas;n.width==this.lastWidth&&n.height==this.lastHeight||this.cardboardUI_.onResize(),this.lastWidth=n.width,this.lastHeight=n.height,this.cardboardUI_.render()}},ze.prototype.onOrientationChange_=function(e){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},ze.prototype.onResize_=function(e){if(this.layer_){var t=this.layer_.source.getContext("webgl");t||(t=this.layer_.source.getContext("experimental-webgl")),t||(t=this.layer_.source.getContext("webgl2"));var n=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];t.canvas.setAttribute("style",n.join("; ")+";"),C(t.canvas)}},ze.prototype.onViewerChanged_=function(e){this.deviceInfo_.setViewer(e),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},ze.prototype.fireVRDisplayDeviceParamsChange_=function(){var e=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(e)},ze.VRFrameData=Ue,ze.VRDisplay=Ge,ze}()})),ac=(rc=ic)&&rc.__esModule&&Object.prototype.hasOwnProperty.call(rc,"default")?rc.default:rc;class oc extends Pu{constructor(e){super(),this.global=e,this.onWindowResize=this.onWindowResize.bind(this),this.global.window.addEventListener("resize",this.onWindowResize),this.environmentBlendMode="opaque"}onBaseLayerSet(e,t){throw new Error("Not implemented")}isSessionSupported(e){throw new Error("Not implemented")}isFeatureSupported(e){throw new Error("Not implemented")}async requestSession(e,t){throw new Error("Not implemented")}requestAnimationFrame(e){throw new Error("Not implemented")}onFrameStart(e){throw new Error("Not implemented")}onFrameEnd(e){throw new Error("Not implemented")}doesSessionSupportReferenceSpace(e,t){throw new Error("Not implemented")}requestStageBounds(){throw new Error("Not implemented")}async requestFrameOfReferenceTransform(e,t){}cancelAnimationFrame(e){throw new Error("Not implemented")}endSession(e){throw new Error("Not implemented")}getViewport(e,t,n,r){throw new Error("Not implemented")}getProjectionMatrix(e){throw new Error("Not implemented")}getBasePoseMatrix(){throw new Error("Not implemented")}getBaseViewMatrix(e){throw new Error("Not implemented")}getInputSources(){throw new Error("Not implemented")}getInputPose(e,t,n){throw new Error("Not implemented")}onWindowResize(){this.onWindowResize()}}let sc={mapping:"xr-standard",profiles:["oculus-go","generic-trigger-touchpad"],buttons:{length:3,0:1,1:null,2:0},gripTransform:{orientation:[.11*Math.PI,0,0,1]}},uc={mapping:"xr-standard",displayProfiles:{"Oculus Quest":["oculus-touch-v2","oculus-touch","generic-trigger-squeeze-thumbstick"]},profiles:["oculus-touch","generic-trigger-squeeze-thumbstick"],axes:{length:4,0:null,1:null,2:0,3:1},buttons:{length:7,0:1,1:2,2:null,3:0,4:3,5:4,6:null},gripTransform:{position:[0,-.02,.04,1],orientation:[.11*Math.PI,0,0,1]}},lc={mapping:"xr-standard",profiles:["htc-vive","generic-trigger-squeeze-touchpad"],displayProfiles:{"HTC Vive":["htc-vive","generic-trigger-squeeze-touchpad"],"HTC Vive DVT":["htc-vive","generic-trigger-squeeze-touchpad"],"Valve Index":["valve-index","generic-trigger-squeeze-touchpad-thumbstick"]},buttons:{length:3,0:1,1:2,2:0},gripTransform:{position:[0,0,.05,1]},targetRayTransform:{orientation:[-.08*Math.PI,0,0,1]},userAgentOverrides:{Firefox:{axes:{invert:[1,3]}}}},cc={mapping:"xr-standard",profiles:["samsung-gearvr","generic-trigger-touchpad"],buttons:{length:3,0:1,1:null,2:0},gripTransform:{orientation:[.11*Math.PI,0,0,1]}},dc={mapping:"xr-standard",profiles:["samsung-odyssey","microsoft-mixed-reality","generic-trigger-squeeze-touchpad-thumbstick"],buttons:{length:4,0:1,1:0,2:2,3:4},gripTransform:{position:[0,-.02,.04,1],orientation:[.11*Math.PI,0,0,1]}},hc={mapping:"xr-standard",profiles:["microsoft-mixed-reality","generic-trigger-squeeze-touchpad-thumbstick"],buttons:{length:4,0:1,1:0,2:2,3:4},gripTransform:{position:[0,-.02,.04,1],orientation:[.11*Math.PI,0,0,1]}},fc={"Daydream Controller":{mapping:"",profiles:["google-daydream","generic-trigger-touchpad"],buttons:{length:3,0:null,1:null,2:0}},"Gear VR Controller":cc,"HTC Vive Focus Controller":{mapping:"xr-standard",profiles:["htc-vive-focus","generic-trigger-touchpad"],buttons:{length:3,0:1,1:null,2:0}},"Oculus Go Controller":sc,"Oculus Touch (Right)":uc,"Oculus Touch (Left)":uc,"OpenVR Gamepad":lc,"Spatial Controller (Spatial Interaction Source) 045E-065A":hc,"Spatial Controller (Spatial Interaction Source) 045E-065D":dc,"Windows Mixed Reality (Right)":hc,"Windows Mixed Reality (Left)":hc};const pc=Wu(.155,-.465,-.15),mc=Wu(-.155,-.465,-.15),gc=Wu(0,0,-.25),vc=Wu(0,0,.05),yc=Wu(-.08,.14,.08),_c=180/Math.PI;class bc{constructor(){this.hand="right",this.headElbowOffset=pc,this.controllerQ=el(),this.lastControllerQ=el(),this.headQ=el(),this.headPos=Vu(),this.elbowPos=Vu(),this.wristPos=Vu(),this.time=null,this.lastTime=null,this.rootQ=el(),this.position=Vu()}setHandedness(e){this.hand!=e&&(this.hand=e,"left"==this.hand?this.headElbowOffset=mc:this.headElbowOffset=pc)}update(e,t){this.time=_l(),e&&(ol(this.lastControllerQ,this.controllerQ),ol(this.controllerQ,e)),t&&(ju(this.headPos,t),Gu(this.headQ,t));let n=this.getHeadYawOrientation_(),r=this.quatAngle_(this.lastControllerQ,this.controllerQ);r/((this.time-this.lastTime)/1e3)>.61?nl(this.rootQ,this.rootQ,n,Math.min(r/.175,1)):ol(this.rootQ,n);let i=Wu(0,0,-1);Ju(i,i,this.controllerQ);let a=Qu(i,[0,1,0]),o=this.clamp_((a-.12)/.87,0,1),s=il(this.rootQ);rl(s,s),tl(s,s,this.controllerQ);let u=this.elbowPos;qu(u,this.headPos),Yu(u,u,this.headElbowOffset);let l=zu(yc);Ku(l,l,o),Yu(u,u,l);let c=this.quatAngle_(s,el())*_c,d=(1-Math.pow(c/180,4))*(.4+.6*o*.4),h=el();nl(h,h,s,d);let f=rl(el(),h),p=il(s);tl(p,p,f);let m=this.wristPos;qu(m,vc),Ju(m,m,h),Yu(m,m,gc),Ju(m,m,p),Yu(m,m,u);let g=zu(yc);Ku(g,g,o),Yu(this.position,this.wristPos,g),Ju(this.position,this.position,this.rootQ),this.lastTime=this.time}getPosition(){return this.position}getHeadYawOrientation_(){let e=Vu();return function(e,t,n){function r(e,t,n){return e<t?t:e>n?n:e}var i=t[0]*t[0],a=t[1]*t[1],o=t[2]*t[2],s=t[3]*t[3];if("XYZ"===n)e[0]=Math.atan2(2*(t[0]*t[3]-t[1]*t[2]),s-i-a+o),e[1]=Math.asin(r(2*(t[0]*t[2]+t[1]*t[3]),-1,1)),e[2]=Math.atan2(2*(t[2]*t[3]-t[0]*t[1]),s+i-a-o);else if("YXZ"===n)e[0]=Math.asin(r(2*(t[0]*t[3]-t[1]*t[2]),-1,1)),e[1]=Math.atan2(2*(t[0]*t[2]+t[1]*t[3]),s-i-a+o),e[2]=Math.atan2(2*(t[0]*t[1]+t[2]*t[3]),s-i+a-o);else if("ZXY"===n)e[0]=Math.asin(r(2*(t[0]*t[3]+t[1]*t[2]),-1,1)),e[1]=Math.atan2(2*(t[1]*t[3]-t[2]*t[0]),s-i-a+o),e[2]=Math.atan2(2*(t[2]*t[3]-t[0]*t[1]),s-i+a-o);else if("ZYX"===n)e[0]=Math.atan2(2*(t[0]*t[3]+t[2]*t[1]),s-i-a+o),e[1]=Math.asin(r(2*(t[1]*t[3]-t[0]*t[2]),-1,1)),e[2]=Math.atan2(2*(t[0]*t[1]+t[2]*t[3]),s+i-a-o);else if("YZX"===n)e[0]=Math.atan2(2*(t[0]*t[3]-t[2]*t[1]),s-i+a-o),e[1]=Math.atan2(2*(t[1]*t[3]-t[0]*t[2]),s+i-a-o),e[2]=Math.asin(r(2*(t[0]*t[1]+t[2]*t[3]),-1,1));else{if("XZY"!==n)return void console.log("No order given for quaternion to euler conversion.");e[0]=Math.atan2(2*(t[0]*t[3]+t[1]*t[2]),s-i+a-o),e[1]=Math.atan2(2*(t[0]*t[2]+t[1]*t[3]),s+i-a-o),e[2]=Math.asin(r(2*(t[2]*t[3]-t[0]*t[1]),-1,1))}}(e,this.headQ,"YXZ"),function(e,t,n,r){let i=.5*Math.PI/180;t*=i,n*=i,r*=i;let a=Math.sin(t),o=Math.cos(t),s=Math.sin(n),u=Math.cos(n),l=Math.sin(r),c=Math.cos(r);return e[0]=a*u*c-o*s*l,e[1]=o*s*c+a*u*l,e[2]=o*u*l-a*s*c,e[3]=o*u*c+a*s*l,e}(el(),0,e[1]*_c,0)}clamp_(e,t,n){return Math.min(Math.max(e,t),n)}quatAngle_(e,t){let n=[0,0,-1],r=[0,0,-1];return Ju(n,n,e),Ju(r,r,t),function(e,t){let n=Wu(e[0],e[1],e[2]),r=Wu(t[0],t[1],t[2]);Xu(n,n),Xu(r,r);let i=Qu(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}(n,r)}}const Ec=Symbol("@@webxr-polyfill/XRRemappedGamepad"),Tc={pressed:!1,touched:!1,value:0};Object.freeze(Tc);class Sc{constructor(e,t,n){if(n||(n={}),n.userAgentOverrides)for(let e in n.userAgentOverrides)if(navigator.userAgent.includes(e)){let t=n.userAgentOverrides[e];for(let e in t)e in n?Object.assign(n[e],t[e]):n[e]=t[e];break}let r=new Array(n.axes&&n.axes.length?n.axes.length:e.axes.length),i=new Array(n.buttons&&n.buttons.length?n.buttons.length:e.buttons.length),a=null;if(n.gripTransform){let e=n.gripTransform.orientation||[0,0,0,1];a=Nu(),Uu(a,sl(e,e),n.gripTransform.position||[0,0,0])}let o=null;if(n.targetRayTransform){let e=n.targetRayTransform.orientation||[0,0,0,1];o=Nu(),Uu(o,sl(e,e),n.targetRayTransform.position||[0,0,0])}let s=n.profiles;n.displayProfiles&&t.displayName in n.displayProfiles&&(s=n.displayProfiles[t.displayName]),this[Ec]={gamepad:e,map:n,profiles:s||[e.id],mapping:n.mapping||e.mapping,axes:r,buttons:i,gripTransform:a,targetRayTransform:o},this._update()}_update(){let e=this[Ec].gamepad,t=this[Ec].map,n=this[Ec].axes;for(let r=0;r<n.length;++r)t.axes&&r in t.axes?null===t.axes[r]?n[r]=0:n[r]=e.axes[t.axes[r]]:n[r]=e.axes[r];if(t.axes&&t.axes.invert)for(let e of t.axes.invert)e<n.length&&(n[e]*=-1);let r=this[Ec].buttons;for(let n=0;n<r.length;++n)t.buttons&&n in t.buttons?null===t.buttons[n]?r[n]=Tc:r[n]=e.buttons[t.buttons[n]]:r[n]=e.buttons[n]}get id(){return""}get _profiles(){return this[Ec].profiles}get index(){return-1}get connected(){return this[Ec].gamepad.connected}get timestamp(){return this[Ec].gamepad.timestamp}get mapping(){return this[Ec].mapping}get axes(){return this[Ec].axes}get buttons(){return this[Ec].buttons}get hapticActuators(){return this[Ec].gamepad.hapticActuators}}class wc{constructor(e,t,n=0,r=-1){this.polyfill=e,this.display=t,this.nativeGamepad=null,this.gamepad=null,this.inputSource=new Ql(this),this.lastPosition=Vu(),this.emulatedPosition=!1,this.basePoseMatrix=Nu(),this.outputMatrix=Nu(),this.primaryButtonIndex=n,this.primaryActionPressed=!1,this.primarySqueezeButtonIndex=r,this.primarySqueezeActionPressed=!1,this.handedness="",this.targetRayMode="gaze",this.armModel=null}get profiles(){return this.gamepad?this.gamepad._profiles:[]}updateFromGamepad(e){this.nativeGamepad!==e&&(this.nativeGamepad=e,this.gamepad=e?new Sc(e,this.display,fc[e.id]):null),this.handedness=""===e.hand?"none":e.hand,this.gamepad&&this.gamepad._update(),e.pose?(this.targetRayMode="tracked-pointer",this.emulatedPosition=!e.pose.hasPosition):""===e.hand&&(this.targetRayMode="gaze",this.emulatedPosition=!1)}updateBasePoseMatrix(){if(this.nativeGamepad&&this.nativeGamepad.pose){let e=this.nativeGamepad.pose,t=e.position,n=e.orientation;if(!t&&!n)return;t?(this.lastPosition[0]=t[0],this.lastPosition[1]=t[1],this.lastPosition[2]=t[2]):e.hasPosition?t=this.lastPosition:(this.armModel||(this.armModel=new bc),this.armModel.setHandedness(this.nativeGamepad.hand),this.armModel.update(n,this.polyfill.getBasePoseMatrix()),t=this.armModel.getPosition()),Uu(this.basePoseMatrix,n,t)}else!function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]}(this.basePoseMatrix,this.polyfill.getBasePoseMatrix());return this.basePoseMatrix}getXRPose(e,t){switch(this.updateBasePoseMatrix(),t){case"target-ray":e._transformBasePoseMatrix(this.outputMatrix,this.basePoseMatrix),this.gamepad&&this.gamepad[Ec].targetRayTransform&&Bu(this.outputMatrix,this.outputMatrix,this.gamepad[Ec].targetRayTransform);break;case"grip":if(!this.nativeGamepad||!this.nativeGamepad.pose)return null;e._transformBasePoseMatrix(this.outputMatrix,this.basePoseMatrix),this.gamepad&&this.gamepad[Ec].gripTransform&&Bu(this.outputMatrix,this.outputMatrix,this.gamepad[Ec].gripTransform);break;default:return null}return e._adjustForOriginOffset(this.outputMatrix),new XRPose(new XRRigidTransform(this.outputMatrix),this.emulatedPosition)}}const Ac={highRefreshRate:!0},xc={oculus:1,openvr:1,"spatial controller (spatial interaction source)":1};let Mc=0;class Cc{constructor(e,t,n={}){if(this.mode=e,this.enabledFeatures=t,this.outputContext=null,this.immersive="immersive-vr"==e||"immersive-ar"==e,this.ended=null,this.baseLayer=null,this.id=++Mc,this.modifiedCanvasLayer=!1,this.outputContext){const e=n.renderContextType||"2d";this.renderContext=this.outputContext.canvas.getContext(e)}}}class Rc extends oc{constructor(e,t){const{canPresent:n}=t.capabilities;super(e),this.display=t,this.frame=new e.VRFrameData,this.sessions=new Map,this.immersiveSession=null,this.canPresent=n,this.baseModelMatrix=Nu(),this.gamepadInputSources={},this.tempVec3=new Float32Array(3),this.onVRDisplayPresentChange=this.onVRDisplayPresentChange.bind(this),e.window.addEventListener("vrdisplaypresentchange",this.onVRDisplayPresentChange),this.CAN_USE_GAMEPAD=e.navigator&&"getGamepads"in e.navigator,this.HAS_BITMAP_SUPPORT=(e=>!(!e.ImageBitmapRenderingContext||!e.createImageBitmap))(e)}get depthNear(){return this.display.depthNear}set depthNear(e){this.display.depthNear=e}get depthFar(){return this.display.depthFar}set depthFar(e){this.display.depthFar=e}onBaseLayerSet(e,t){const n=this.sessions.get(e),r=t.context.canvas;if(n.immersive){const e=this.display.getEyeParameters("left"),i=this.display.getEyeParameters("right");r.width=2*Math.max(e.renderWidth,i.renderWidth),r.height=Math.max(e.renderHeight,i.renderHeight),this.display.requestPresent([{source:r,attributes:Ac}]).then(()=>{this.global.document.body.contains(r)||(n.modifiedCanvasLayer=!0,this.global.document.body.appendChild(r),(e=>{e.style.display="block",e.style.position="absolute",e.style.width=e.style.height="1px",e.style.top=e.style.left="0px"})(r)),n.baseLayer=t})}else n.baseLayer=t}isSessionSupported(e){return"immersive-ar"!=e&&("immersive-vr"!=e||!1!==this.canPresent)}isFeatureSupported(e){switch(e){case"viewer":case"local":case"local-floor":return!0;case"bounded":case"unbounded":default:return!1}}async requestSession(e,t){if(!this.isSessionSupported(e))return Promise.reject();let n="immersive-vr"==e;if(n){const e=this.global.document.createElement("canvas");e.getContext("webgl");await this.display.requestPresent([{source:e,attributes:Ac}])}const r=new Cc(e,t,{renderContextType:this.HAS_BITMAP_SUPPORT?"bitmaprenderer":"2d"});return this.sessions.set(r.id,r),n&&(this.immersiveSession=r,this.dispatchEvent("@@webxr-polyfill/vr-present-start",r.id)),Promise.resolve(r.id)}requestAnimationFrame(e){return this.display.requestAnimationFrame(e)}getPrimaryButtonIndex(e){let t=0,n=e.id.toLowerCase();for(let e in xc)if(n.includes(e)){t=xc[e];break}return Math.min(t,e.buttons.length-1)}onFrameStart(e,t){this.display.depthNear=t.depthNear,this.display.depthFar=t.depthFar,this.display.getFrameData(this.frame);const n=this.sessions.get(e);if(n.immersive&&this.CAN_USE_GAMEPAD){let e=this.gamepadInputSources;this.gamepadInputSources={};let t=this.global.navigator.getGamepads();for(let r=0;r<t.length;++r){let i=t[r];if(i&&i.displayId>0){let t=e[r];if(t||(t=new wc(this,this.display,this.getPrimaryButtonIndex(i))),t.updateFromGamepad(i),this.gamepadInputSources[r]=t,-1!=t.primaryButtonIndex){let e=i.buttons[t.primaryButtonIndex].pressed;e&&!t.primaryActionPressed?this.dispatchEvent("@@webxr-polyfill/input-select-start",{sessionId:n.id,inputSource:t.inputSource}):!e&&t.primaryActionPressed&&this.dispatchEvent("@@webxr-polyfill/input-select-end",{sessionId:n.id,inputSource:t.inputSource}),t.primaryActionPressed=e}if(-1!=t.primarySqueezeButtonIndex){let e=i.buttons[t.primarySqueezeButtonIndex].pressed;e&&!t.primarySqueezeActionPressed?this.dispatchEvent("@@webxr-polyfill/input-squeeze-start",{sessionId:n.id,inputSource:t.inputSource}):!e&&t.primarySqueezeActionPressed&&this.dispatchEvent("@@webxr-polyfill/input-squeeze-end",{sessionId:n.id,inputSource:t.inputSource}),t.primarySqueezeActionPressed=e}}}}if(!n.immersive&&n.baseLayer){const e=n.baseLayer.context.canvas;Hu(this.frame.leftProjectionMatrix,t.inlineVerticalFieldOfView,e.width/e.height,t.depthNear,t.depthFar)}}onFrameEnd(e){const t=this.sessions.get(e);if(!t.ended&&t.baseLayer){if(t.outputContext&&(!t.immersive||this.display.capabilities.hasExternalDisplay)){const e=t.immersive&&this.display.capabilities.hasExternalDisplay,n=t.baseLayer.context.canvas,r=e?n.width/2:n.width,i=n.height;{const e=t.outputContext.canvas,a=e.width,o=e.height,s=t.renderContext;this.HAS_BITMAP_SUPPORT?n.transferToImageBitmap?s.transferFromImageBitmap(n.transferToImageBitmap()):this.global.createImageBitmap(n,0,0,r,i,{resizeWidth:a,resizeHeight:o}).then(e=>s.transferFromImageBitmap(e)):s.drawImage(n,0,0,r,i,0,0,a,o)}}t.immersive&&t.baseLayer&&this.display.submitFrame()}}cancelAnimationFrame(e){this.display.cancelAnimationFrame(e)}async endSession(e){const t=this.sessions.get(e);if(!t.ended)return t.immersive?this.display.exitPresent():void(t.ended=!0)}doesSessionSupportReferenceSpace(e,t){const n=this.sessions.get(e);return!n.ended&&n.enabledFeatures.has(t)}requestStageBounds(){if(this.display.stageParameters){const e=this.display.stageParameters.sizeX,t=this.display.stageParameters.sizeZ,n=[];return n.push(-e/2),n.push(-t/2),n.push(e/2),n.push(-t/2),n.push(e/2),n.push(t/2),n.push(-e/2),n.push(t/2),n}return null}async requestFrameOfReferenceTransform(e,t){return("local-floor"===e||"bounded-floor"===e)&&this.display.stageParameters&&this.display.stageParameters.sittingToStandingTransform?this.display.stageParameters.sittingToStandingTransform:null}getProjectionMatrix(e){if("left"===e)return this.frame.leftProjectionMatrix;if("right"===e)return this.frame.rightProjectionMatrix;if("none"===e)return this.frame.leftProjectionMatrix;throw new Error("eye must be of type 'left' or 'right'")}getViewport(e,t,n,r){const i=this.sessions.get(e),{width:a,height:o}=n.context.canvas;if(!i.immersive)return r.x=r.y=0,r.width=a,r.height=o,!0;if("left"===t||"none"===t)r.x=0;else{if("right"!==t)return!1;r.x=a/2}return r.y=0,r.width=a/2,r.height=o,!0}getBasePoseMatrix(){let{position:e,orientation:t}=this.frame.pose;return e||t?(e||(e=this.tempVec3,e[0]=e[1]=e[2]=0),Uu(this.baseModelMatrix,t,e),this.baseModelMatrix):this.baseModelMatrix}getBaseViewMatrix(e){if("left"===e||"none"===e)return this.frame.leftViewMatrix;if("right"===e)return this.frame.rightViewMatrix;throw new Error("eye must be of type 'left' or 'right'")}getInputSources(){let e=[];for(let t in this.gamepadInputSources)e.push(this.gamepadInputSources[t].inputSource);return e}getInputPose(e,t,n){if(!t)return null;for(let r in this.gamepadInputSources){let i=this.gamepadInputSources[r];if(i.inputSource===e)return i.getXRPose(t,n)}return null}onWindowResize(){}onVRDisplayPresentChange(e){this.display.isPresenting||this.sessions.forEach(e=>{if(e.immersive&&!e.ended){if(e.modifiedCanvasLayer){const t=e.baseLayer.context.canvas;document.body.removeChild(t),t.setAttribute("style","")}this.immersiveSession===e&&(this.immersiveSession=null),this.dispatchEvent("@@webxr-polyfill/vr-present-end",e.id)}})}}class Ic extends Rc{constructor(e,t){const n=new ac(t||{});super(e,n),this.display=n,this.frame={rightViewMatrix:new Float32Array(16),leftViewMatrix:new Float32Array(16),rightProjectionMatrix:new Float32Array(16),leftProjectionMatrix:new Float32Array(16),pose:null,timestamp:null}}}let Oc=0;class Dc{constructor(e,t){this.mode=e,this.enabledFeatures=t,this.ended=null,this.baseLayer=null,this.id=++Oc}}class Pc extends oc{constructor(e){super(e),this.sessions=new Map,this.projectionMatrix=Nu(),this.identityMatrix=Nu()}onBaseLayerSet(e,t){this.sessions.get(e).baseLayer=t}isSessionSupported(e){return"inline"==e}isFeatureSupported(e){switch(e){case"viewer":return!0;default:return!1}}async requestSession(e,t){if(!this.isSessionSupported(e))return Promise.reject();const n=new Dc(e,t);return this.sessions.set(n.id,n),Promise.resolve(n.id)}requestAnimationFrame(e){return window.requestAnimationFrame(e)}cancelAnimationFrame(e){window.cancelAnimationFrame(e)}onFrameStart(e,t){const n=this.sessions.get(e);if(n.baseLayer){const e=n.baseLayer.context.canvas;Hu(this.projectionMatrix,t.inlineVerticalFieldOfView,e.width/e.height,t.depthNear,t.depthFar)}}onFrameEnd(e){}async endSession(e){this.sessions.get(e).ended=!0}doesSessionSupportReferenceSpace(e,t){const n=this.sessions.get(e);return!n.ended&&n.enabledFeatures.has(t)}requestStageBounds(){return null}async requestFrameOfReferenceTransform(e,t){return null}getProjectionMatrix(e){return this.projectionMatrix}getViewport(e,t,n,r){this.sessions.get(e);const{width:i,height:a}=n.context.canvas;return r.x=r.y=0,r.width=i,r.height=a,!0}getBasePoseMatrix(){return this.identityMatrix}getBaseViewMatrix(e){return this.identityMatrix}getInputSources(){return[]}getInputPose(e,t,n){return null}onWindowResize(){}}const Lc=async function(e,t){if(t.webvr){let t=await async function(e){let t=null;if("getVRDisplays"in e.navigator)try{const n=await e.navigator.getVRDisplays();n&&n.length&&(t=new Rc(e,n[0]))}catch(e){}return t}(e);if(t)return t}let n=(e=>{var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(e.navigator.userAgent||e.navigator.vendor||e.opera),t})(e);return n&&t.cardboard||!n&&t.allowCardboardOnDesktop?(e.VRFrameData||(e.VRFrameData=function(){this.rightViewMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.leftProjectionMatrix=new Float32Array(16),this.pose=null}),new Ic(e,t.cardboardConfig)):new Pc(e)},Nc={global:Ou,webvr:!0,cardboard:!0,cardboardConfig:null,allowCardboardOnDesktop:!1},kc=["navigator","HTMLCanvasElement","WebGLRenderingContext"];class Fc{constructor(e={}){this.config=Object.freeze(Object.assign({},Nc,e)),this.global=this.config.global,this.nativeWebXR="xr"in this.global.navigator,this.injected=!1,this.nativeWebXR?this._injectCompatibilityShims(this.global):this._injectPolyfill(this.global)}_injectPolyfill(e){if(!kc.every(t=>!!e[t]))throw new Error("Global must have the following attributes : "+kc);for(const t of Object.keys($l))void 0!==e[t]?console.warn(t+" already defined on global."):e[t]=$l[t];ec(e.WebGLRenderingContext)&&(tc(e.HTMLCanvasElement),e.OffscreenCanvas&&tc(e.OffscreenCanvas),e.WebGL2RenderingContext&&ec(e.WebGL2RenderingContext),window.isSecureContext||console.warn("WebXR Polyfill Warning:\nThis page is not running in a secure context (https:// or localhost)!\nThis means that although the page may be able to use the WebXR Polyfill it will\nnot be able to use native WebXR implementations, and as such will not be able to\naccess dedicated VR or AR hardware, and will not be able to take advantage of\nany performance improvements a native WebXR implementation may offer. Please\nhost this content on a secure origin for the best user experience.\n"));this.injected=!0,this._patchNavigatorXR()}_patchNavigatorXR(){let e=Lc(this.global,this.config);this.xr=new $l.XR(e),Object.defineProperty(this.global.navigator,"xr",{value:this.xr,configurable:!0})}_injectCompatibilityShims(e){if(!kc.every(t=>!!e[t]))throw new Error("Global must have the following attributes : "+kc);if(e.navigator.xr&&"supportsSession"in e.navigator.xr&&!("isSessionSupported"in e.navigator.xr)){let t=e.navigator.xr.supportsSession;e.navigator.xr.isSessionSupported=function(e){return t.call(this,e).then(()=>!0).catch(()=>!1)},e.navigator.xr.supportsSession=function(e){return console.warn("navigator.xr.supportsSession() is deprecated. Please call navigator.xr.isSessionSupported() instead and check the boolean value returned when the promise resolves."),t.call(this,e)}}}}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t});var Bc=0,Uc=1,jc=2,Gc=0,Hc=1,Vc=2,zc=3,Wc=100,qc=306,Yc=1e3,Kc=1001,Xc=1002,Qc=1003,Zc=1004,Jc=1005,$c=1006,ed=1008,td=1009,nd=1012,rd=1015,id=1016,ad=1020,od=1022,sd=1023,ud=1026,ld=1027,cd=2300,dd=2301,hd=2302,fd=2400,pd=2401,md=2402,gd=3e3,vd=3001,yd=7680,_d=35044,bd=35048;function Ed(){}Object.assign(Ed.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});for(var Td=[],Sd=0;Sd<256;Sd++)Td[Sd]=(Sd<16?"0":"")+Sd.toString(16);var wd,Ad={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Td[255&e]+Td[e>>8&255]+Td[e>>16&255]+Td[e>>24&255]+"-"+Td[255&t]+Td[t>>8&255]+"-"+Td[t>>16&15|64]+Td[t>>24&255]+"-"+Td[63&n|128]+Td[n>>8&255]+"-"+Td[n>>16&255]+Td[n>>24&255]+Td[255&r]+Td[r>>8&255]+Td[r>>16&255]+Td[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Ad.DEG2RAD},radToDeg:function(e){return e*Ad.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){var a=Math.cos,o=Math.sin,s=a(n/2),u=o(n/2),l=a((t+r)/2),c=o((t+r)/2),d=a((t-r)/2),h=o((t-r)/2),f=a((r-t)/2),p=o((r-t)/2);"XYX"===i?e.set(s*c,u*d,u*h,s*l):"YZY"===i?e.set(u*h,s*c,u*d,s*l):"ZXZ"===i?e.set(u*d,u*h,s*c,s*l):"XZX"===i?e.set(s*c,u*p,u*f,s*l):"YXY"===i?e.set(u*f,s*c,u*p,s*l):"ZYZ"===i?e.set(u*p,u*f,s*c,s*l):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function xd(e,t){this.x=e||0,this.y=t||0}function Md(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(xd.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(xd.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}}),Object.assign(Md.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,a,o,s,u){var l=this.elements;return l[0]=e,l[1]=r,l[2]=o,l[3]=t,l[4]=i,l[5]=s,l[6]=n,l[7]=a,l[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},extractBasis:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],u=n[1],l=n[4],c=n[7],d=n[2],h=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],_=r[7],b=r[2],E=r[5],T=r[8];return i[0]=a*p+o*v+s*b,i[3]=a*m+o*y+s*E,i[6]=a*g+o*_+s*T,i[1]=u*p+l*v+c*b,i[4]=u*m+l*y+c*E,i[7]=u*g+l*_+c*T,i[2]=d*p+h*v+f*b,i[5]=d*m+h*y+f*E,i[8]=d*g+h*_+f*T,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8];return t*a*l-t*o*u-n*i*l+n*o*s+r*i*u-r*a*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,r=this.elements,i=n[0],a=n[1],o=n[2],s=n[3],u=n[4],l=n[5],c=n[6],d=n[7],h=n[8],f=h*u-l*d,p=l*c-h*s,m=d*s-u*c,g=i*f+a*p+o*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return r[0]=f*y,r[1]=(o*d-h*a)*y,r[2]=(l*a-o*u)*y,r[3]=p*y,r[4]=(h*i-o*c)*y,r[5]=(o*s-l*i)*y,r[6]=m*y,r[7]=(a*c-d*i)*y,r[8]=(u*i-a*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,a,o){var s=Math.cos(i),u=Math.sin(i);this.set(n*s,n*u,-n*(s*a+u*o)+a+e,-r*u,r*s,-r*(-u*a+s*o)+o+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],u=r[4],l=r[7];return r[0]=t*i+n*s,r[3]=t*a+n*u,r[6]=t*o+n*l,r[1]=-n*i+t*s,r[4]=-n*a+t*u,r[7]=-n*o+t*l,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Cd={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===wd&&(wd=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),wd.width=e.width,wd.height=e.height;var n=wd.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=wd}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},Rd=0;function Id(e,t,n,r,i,a,o,s,u,l){Object.defineProperty(this,"id",{value:Rd++}),this.uuid=Ad.generateUUID(),this.name="",this.image=void 0!==e?e:Id.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Id.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:Kc,this.wrapT=void 0!==r?r:Kc,this.magFilter=void 0!==i?i:$c,this.minFilter=void 0!==a?a:ed,this.anisotropy=void 0!==u?u:1,this.format=void 0!==o?o:sd,this.internalFormat=null,this.type=void 0!==s?s:td,this.offset=new xd(0,0),this.repeat=new xd(1,1),this.center=new xd(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Md,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:gd,this.version=0,this.onUpdate=null}function Od(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1}function Dd(e,t,n){this.width=e,this.height=t,this.scissor=new Od(0,0,e,t),this.scissorTest=!1,this.viewport=new Od(0,0,e,t),n=n||{},this.texture=new Id(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:$c,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function Pd(e,t,n){Dd.call(this,e,t,n),this.samples=4}function Ld(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}Id.DEFAULT_IMAGE=void 0,Id.DEFAULT_MAPPING=300,Id.prototype=Object.assign(Object.create(Ed.prototype),{constructor:Id,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=Ad.generateUUID()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var a=0,o=r.length;a<o;a++)i.push(Cd.getDataURL(r[a]))}else i=Cd.getDataURL(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Yc:e.x=e.x-Math.floor(e.x);break;case Kc:e.x=e.x<0?0:1;break;case Xc:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Yc:e.y=e.y-Math.floor(e.y);break;case Kc:e.y=e.y<0?0:1;break;case Xc:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Id.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.defineProperties(Od.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(Od.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,i,a=.01,o=.1,s=e.elements,u=s[0],l=s[4],c=s[8],d=s[1],h=s[5],f=s[9],p=s[2],m=s[6],g=s[10];if(Math.abs(l-d)<a&&Math.abs(c-p)<a&&Math.abs(f-m)<a){if(Math.abs(l+d)<o&&Math.abs(c+p)<o&&Math.abs(f+m)<o&&Math.abs(u+h+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var v=(u+1)/2,y=(h+1)/2,_=(g+1)/2,b=(l+d)/4,E=(c+p)/4,T=(f+m)/4;return v>y&&v>_?v<a?(n=0,r=.707106781,i=.707106781):(r=b/(n=Math.sqrt(v)),i=E/n):y>_?y<a?(n=.707106781,r=0,i=.707106781):(n=b/(r=Math.sqrt(y)),i=T/r):_<a?(n=.707106781,r=.707106781,i=0):(n=E/(i=Math.sqrt(_)),r=T/i),this.set(n,r,i,t),this}var S=Math.sqrt((m-f)*(m-f)+(c-p)*(c-p)+(d-l)*(d-l));return Math.abs(S)<.001&&(S=1),this.x=(m-f)/S,this.y=(c-p)/S,this.z=(d-l)/S,this.w=Math.acos((u+h+g-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Dd.prototype=Object.assign(Object.create(Ed.prototype),{constructor:Dd,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Pd.prototype=Object.assign(Object.create(Dd.prototype),{constructor:Pd,isWebGLMultisampleRenderTarget:!0,copy:function(e){return Dd.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign(Ld,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,a,o){var s=n[r+0],u=n[r+1],l=n[r+2],c=n[r+3],d=i[a+0],h=i[a+1],f=i[a+2],p=i[a+3];if(c!==p||s!==d||u!==h||l!==f){var m=1-o,g=s*d+u*h+l*f+c*p,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var _=Math.sqrt(y),b=Math.atan2(_,g*v);m=Math.sin(m*b)/_,o=Math.sin(o*b)/_}var E=o*v;if(s=s*m+d*E,u=u*m+h*E,l=l*m+f*E,c=c*m+p*E,m===1-o){var T=1/Math.sqrt(s*s+u*u+l*l+c*c);s*=T,u*=T,l*=T,c*=T}}e[t]=s,e[t+1]=u,e[t+2]=l,e[t+3]=c}}),Object.defineProperties(Ld.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(Ld.prototype,{isQuaternion:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,a=e.order,o=Math.cos,s=Math.sin,u=o(n/2),l=o(r/2),c=o(i/2),d=s(n/2),h=s(r/2),f=s(i/2);return"XYZ"===a?(this._x=d*l*c+u*h*f,this._y=u*h*c-d*l*f,this._z=u*l*f+d*h*c,this._w=u*l*c-d*h*f):"YXZ"===a?(this._x=d*l*c+u*h*f,this._y=u*h*c-d*l*f,this._z=u*l*f-d*h*c,this._w=u*l*c+d*h*f):"ZXY"===a?(this._x=d*l*c-u*h*f,this._y=u*h*c+d*l*f,this._z=u*l*f+d*h*c,this._w=u*l*c-d*h*f):"ZYX"===a?(this._x=d*l*c-u*h*f,this._y=u*h*c+d*l*f,this._z=u*l*f-d*h*c,this._w=u*l*c+d*h*f):"YZX"===a?(this._x=d*l*c+u*h*f,this._y=u*h*c+d*l*f,this._z=u*l*f-d*h*c,this._w=u*l*c-d*h*f):"XZY"===a&&(this._x=d*l*c-u*h*f,this._y=u*h*c-d*l*f,this._z=u*l*f+d*h*c,this._w=u*l*c+d*h*f),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,r=n[0],i=n[4],a=n[8],o=n[1],s=n[5],u=n[9],l=n[2],c=n[6],d=n[10],h=r+s+d;return h>0?(t=.5/Math.sqrt(h+1),this._w=.25/t,this._x=(c-u)*t,this._y=(a-l)*t,this._z=(o-i)*t):r>s&&r>d?(t=2*Math.sqrt(1+r-s-d),this._w=(c-u)/t,this._x=.25*t,this._y=(i+o)/t,this._z=(a+l)/t):s>d?(t=2*Math.sqrt(1+s-r-d),this._w=(a-l)/t,this._x=(i+o)/t,this._y=.25*t,this._z=(u+c)/t):(t=2*Math.sqrt(1+d-r-s),this._w=(o-i)/t,this._x=(a+l)/t,this._y=(u+c)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Ad.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,u=t._z,l=t._w;return this._x=n*l+a*o+r*u-i*s,this._y=r*l+a*s+i*o-n*u,this._z=i*l+a*u+n*s-r*o,this._w=a*l-n*o-r*s-i*u,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=1-o*o;if(s<=Number.EPSILON){var u=1-t;return this._w=u*a+t*this._w,this._x=u*n+t*this._x,this._y=u*r+t*this._y,this._z=u*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var l=Math.sqrt(s),c=Math.atan2(l,o),d=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=a*d+this._w*h,this._x=n*d+this._x*h,this._y=r*d+this._y*h,this._z=i*d+this._z*h,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var Nd=new Fd,kd=new Ld;function Fd(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}Object.assign(Fd.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(kd.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(kd.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,u=s*t+a*r-o*n,l=s*n+o*t-i*r,c=s*r+i*n-a*t,d=-i*t-a*n-o*r;return this.x=u*s+d*-i+l*-o-c*-a,this.y=l*s+d*-a+c*-i-u*-o,this.z=c*s+d*-o+u*-a-l*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this},projectOnVector:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)},projectOnPlane:function(e){return Nd.copy(this).projectOnVector(e),this.sub(Nd)},reflect:function(e){return this.sub(Nd.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(Ad.clamp(n,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});var Bd=new Fd,Ud=new Wd,jd=new Fd(0,0,0),Gd=new Fd(1,1,1),Hd=new Fd,Vd=new Fd,zd=new Fd;function Wd(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Wd.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,a,o,s,u,l,c,d,h,f,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=u,g[6]=l,g[10]=c,g[14]=d,g[3]=h,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Wd).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,n=e.elements,r=1/Bd.setFromMatrixColumn(e,0).length(),i=1/Bd.setFromMatrixColumn(e,1).length(),a=1/Bd.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),u=Math.sin(r),l=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var d=a*l,h=a*c,f=o*l,p=o*c;t[0]=s*l,t[4]=-s*c,t[8]=u,t[1]=h+f*u,t[5]=d-p*u,t[9]=-o*s,t[2]=p-d*u,t[6]=f+h*u,t[10]=a*s}else if("YXZ"===e.order){var m=s*l,g=s*c,v=u*l,y=u*c;t[0]=m+y*o,t[4]=v*o-g,t[8]=a*u,t[1]=a*c,t[5]=a*l,t[9]=-o,t[2]=g*o-v,t[6]=y+m*o,t[10]=a*s}else if("ZXY"===e.order){m=s*l,g=s*c,v=u*l,y=u*c;t[0]=m-y*o,t[4]=-a*c,t[8]=v+g*o,t[1]=g+v*o,t[5]=a*l,t[9]=y-m*o,t[2]=-a*u,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){d=a*l,h=a*c,f=o*l,p=o*c;t[0]=s*l,t[4]=f*u-h,t[8]=d*u+p,t[1]=s*c,t[5]=p*u+d,t[9]=h*u-f,t[2]=-u,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var _=a*s,b=a*u,E=o*s,T=o*u;t[0]=s*l,t[4]=T-_*c,t[8]=E*c+b,t[1]=c,t[5]=a*l,t[9]=-o*l,t[2]=-u*l,t[6]=b*c+E,t[10]=_-T*c}else if("XZY"===e.order){_=a*s,b=a*u,E=o*s,T=o*u;t[0]=s*l,t[4]=-c,t[8]=u*l,t[1]=_*c+T,t[5]=a*l,t[9]=b*c-E,t[2]=E*c-b,t[6]=o*l,t[10]=T*c+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(jd,e,Gd)},lookAt:function(e,t,n){var r=this.elements;return zd.subVectors(e,t),0===zd.lengthSq()&&(zd.z=1),zd.normalize(),Hd.crossVectors(n,zd),0===Hd.lengthSq()&&(1===Math.abs(n.z)?zd.x+=1e-4:zd.z+=1e-4,zd.normalize(),Hd.crossVectors(n,zd)),Hd.normalize(),Vd.crossVectors(zd,Hd),r[0]=Hd.x,r[4]=Vd.x,r[8]=zd.x,r[1]=Hd.y,r[5]=Vd.y,r[9]=zd.y,r[2]=Hd.z,r[6]=Vd.z,r[10]=zd.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],u=n[12],l=n[1],c=n[5],d=n[9],h=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],E=r[0],T=r[4],S=r[8],w=r[12],A=r[1],x=r[5],M=r[9],C=r[13],R=r[2],I=r[6],O=r[10],D=r[14],P=r[3],L=r[7],N=r[11],k=r[15];return i[0]=a*E+o*A+s*R+u*P,i[4]=a*T+o*x+s*I+u*L,i[8]=a*S+o*M+s*O+u*N,i[12]=a*w+o*C+s*D+u*k,i[1]=l*E+c*A+d*R+h*P,i[5]=l*T+c*x+d*I+h*L,i[9]=l*S+c*M+d*O+h*N,i[13]=l*w+c*C+d*D+h*k,i[2]=f*E+p*A+m*R+g*P,i[6]=f*T+p*x+m*I+g*L,i[10]=f*S+p*M+m*O+g*N,i[14]=f*w+p*C+m*D+g*k,i[3]=v*E+y*A+_*R+b*P,i[7]=v*T+y*x+_*I+b*L,i[11]=v*S+y*M+_*O+b*N,i[15]=v*w+y*C+_*D+b*k,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],u=e[13],l=e[2],c=e[6],d=e[10],h=e[14];return e[3]*(+i*s*c-r*u*c-i*o*d+n*u*d+r*o*h-n*s*h)+e[7]*(+t*s*h-t*u*d+i*a*d-r*a*h+r*u*l-i*s*l)+e[11]*(+t*u*c-t*o*h-i*a*c+n*a*h+i*o*l-n*u*l)+e[15]*(-r*o*l-t*s*c+t*o*d+r*a*c-n*a*d+n*s*l)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],l=r[5],c=r[6],d=r[7],h=r[8],f=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],_=r[15],b=f*y*d-v*p*d+v*c*m-l*y*m-f*c*_+l*p*_,E=g*p*d-h*y*d-g*c*m+u*y*m+h*c*_-u*p*_,T=h*v*d-g*f*d+g*l*m-u*v*m-h*l*_+u*f*_,S=g*f*c-h*v*c-g*l*p+u*v*p+h*l*y-u*f*y,w=i*b+a*E+o*T+s*S;if(0===w){var A="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(A);return console.warn(A),this.identity()}var x=1/w;return n[0]=b*x,n[1]=(v*p*s-f*y*s-v*o*m+a*y*m+f*o*_-a*p*_)*x,n[2]=(l*y*s-v*c*s+v*o*d-a*y*d-l*o*_+a*c*_)*x,n[3]=(f*c*s-l*p*s-f*o*d+a*p*d+l*o*m-a*c*m)*x,n[4]=E*x,n[5]=(h*y*s-g*p*s+g*o*m-i*y*m-h*o*_+i*p*_)*x,n[6]=(g*c*s-u*y*s-g*o*d+i*y*d+u*o*_-i*c*_)*x,n[7]=(u*p*s-h*c*s+h*o*d-i*p*d-u*o*m+i*c*m)*x,n[8]=T*x,n[9]=(g*f*s-h*v*s-g*a*m+i*v*m+h*a*_-i*f*_)*x,n[10]=(u*v*s-g*l*s+g*a*d-i*v*d-u*a*_+i*l*_)*x,n[11]=(h*l*s-u*f*s-h*a*d+i*f*d+u*a*m-i*l*m)*x,n[12]=S*x,n[13]=(h*v*o-g*f*o+g*a*p-i*v*p-h*a*y+i*f*y)*x,n[14]=(g*l*o-u*v*o-g*a*c+i*v*c+u*a*y-i*l*y)*x,n[15]=(u*f*o-h*l*o+h*a*c-i*f*c-u*a*p+i*l*p)*x,this},scale:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,u=i*a,l=i*o;return this.set(u*a+n,u*o-r*s,u*s+r*o,0,u*o+r*s,l*o+n,l*s-r*a,0,u*s-r*o,l*s+r*a,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,u=i+i,l=a+a,c=o+o,d=i*u,h=i*l,f=i*c,p=a*l,m=a*c,g=o*c,v=s*u,y=s*l,_=s*c,b=n.x,E=n.y,T=n.z;return r[0]=(1-(p+g))*b,r[1]=(h+_)*b,r[2]=(f-y)*b,r[3]=0,r[4]=(h-_)*E,r[5]=(1-(d+g))*E,r[6]=(m+v)*E,r[7]=0,r[8]=(f+y)*T,r[9]=(m-v)*T,r[10]=(1-(d+p))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:function(e,t,n){var r=this.elements,i=Bd.set(r[0],r[1],r[2]).length(),a=Bd.set(r[4],r[5],r[6]).length(),o=Bd.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],Ud.copy(this);var s=1/i,u=1/a,l=1/o;return Ud.elements[0]*=s,Ud.elements[1]*=s,Ud.elements[2]*=s,Ud.elements[4]*=u,Ud.elements[5]*=u,Ud.elements[6]*=u,Ud.elements[8]*=l,Ud.elements[9]*=l,Ud.elements[10]*=l,t.setFromRotationMatrix(Ud),n.x=i,n.y=a,n.z=o,this},makePerspective:function(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(t-e),u=2*i/(n-r),l=(t+e)/(t-e),c=(n+r)/(n-r),d=-(a+i)/(a-i),h=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=u,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),u=1/(n-r),l=1/(a-i),c=(t+e)*s,d=(n+r)*u,h=(a+i)*l;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*l,o[14]=-h,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});var qd=new Wd,Yd=new Ld;function Kd(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||Kd.DefaultOrder}function Xd(){this.mask=1}Kd.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Kd.DefaultOrder="XYZ",Object.defineProperties(Kd.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(Kd.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=Ad.clamp,i=e.elements,a=i[0],o=i[4],s=i[8],u=i[1],l=i[5],c=i[9],d=i[2],h=i[6],f=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(h,l),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-d,a),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-o,l)):(this._y=0,this._z=Math.atan2(u,a))):"ZYX"===t?(this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,l))):"YZX"===t?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-d,a)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===t?(this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,n){return qd.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qd,t,n)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return Yd.setFromEuler(this),this.setFromQuaternion(Yd,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Fd(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(Xd.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}});var Qd=0,Zd=new Fd,Jd=new Ld,$d=new Wd,eh=new Fd,th=new Fd,nh=new Fd,rh=new Ld,ih=new Fd(1,0,0),ah=new Fd(0,1,0),oh=new Fd(0,0,1),sh={type:"added"},uh={type:"removed"};function lh(){Object.defineProperty(this,"id",{value:Qd++}),this.uuid=Ad.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=lh.DefaultUp.clone();var e=new Fd,t=new Kd,n=new Ld,r=new Fd(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Wd},normalMatrix:{value:new Md}}),this.matrix=new Wd,this.matrixWorld=new Wd,this.matrixAutoUpdate=lh.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Xd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function ch(){lh.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}lh.DefaultUp=new Fd(0,1,0),lh.DefaultMatrixAutoUpdate=!0,lh.prototype=Object.assign(Object.create(Ed.prototype),{constructor:lh,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return Jd.setFromAxisAngle(e,t),this.quaternion.multiply(Jd),this},rotateOnWorldAxis:function(e,t){return Jd.setFromAxisAngle(e,t),this.quaternion.premultiply(Jd),this},rotateX:function(e){return this.rotateOnAxis(ih,e)},rotateY:function(e){return this.rotateOnAxis(ah,e)},rotateZ:function(e){return this.rotateOnAxis(oh,e)},translateOnAxis:function(e,t){return Zd.copy(e).applyQuaternion(this.quaternion),this.position.add(Zd.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(ih,e)},translateY:function(e){return this.translateOnAxis(ah,e)},translateZ:function(e){return this.translateOnAxis(oh,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4($d.getInverse(this.matrixWorld))},lookAt:function(e,t,n){e.isVector3?eh.copy(e):eh.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),th.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?$d.lookAt(th,eh,this.up):$d.lookAt(eh,th,this.up),this.quaternion.setFromRotationMatrix($d),r&&($d.extractRotation(r.matrixWorld),Jd.setFromRotationMatrix($d),this.quaternion.premultiply(Jd.inverse()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(sh)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(uh)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),$d.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),$d.multiply(e.parent.matrixWorld)),e.applyMatrix4($d),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Fd),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Ld),this.updateMatrixWorld(!0),this.matrixWorld.decompose(th,e,nh),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Fd),this.updateMatrixWorld(!0),this.matrixWorld.decompose(th,rh,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Fd),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,a=r.length;i<a;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,u=o.length;s<u;s++){var l=o[s];i(e.shapes,l)}else i(e.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,u=this.material.length;s<u;s++)c.push(i(e.materials,this.material[s]));r.material=c}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(e).object)}if(t){var d=m(e.geometries),h=m(e.materials),f=m(e.textures),p=m(e.images);o=m(e.shapes);d.length>0&&(n.geometries=d),h.length>0&&(n.materials=h),f.length>0&&(n.textures=f),p.length>0&&(n.images=p),o.length>0&&(n.shapes=o)}return n.object=r,n;function m(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}),ch.prototype=Object.assign(Object.create(lh.prototype),{constructor:ch,isScene:!0,copy:function(e,t){return lh.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=lh.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});var dh=[new Fd,new Fd,new Fd,new Fd,new Fd,new Fd,new Fd,new Fd],hh=new Fd,fh=new wh,ph=new Fd,mh=new Fd,gh=new Fd,vh=new Fd,yh=new Fd,_h=new Fd,bh=new Fd,Eh=new Fd,Th=new Fd,Sh=new Fd;function wh(e,t){this.min=void 0!==e?e:new Fd(1/0,1/0,1/0),this.max=void 0!==t?t:new Fd(-1/0,-1/0,-1/0)}function Ah(e,t,n,r,i){var a,o;for(a=0,o=e.length-3;a<=o;a+=3){Sh.fromArray(e,a);var s=i.x*Math.abs(Sh.x)+i.y*Math.abs(Sh.y)+i.z*Math.abs(Sh.z),u=t.dot(Sh),l=n.dot(Sh),c=r.dot(Sh);if(Math.max(-Math.max(u,l,c),Math.min(u,l,c))>s)return!1}return!0}Object.assign(wh.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,u=e.length;s<u;s+=3){var l=e[s],c=e[s+1],d=e[s+2];l<t&&(t=l),c<n&&(n=c),d<r&&(r=d),l>i&&(i=l),c>a&&(a=c),d>o&&(o=d)}return this.min.set(t,n,r),this.max.set(i,a,o),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,u=e.count;s<u;s++){var l=e.getX(s),c=e.getY(s),d=e.getZ(s);l<t&&(t=l),c<n&&(n=c),d<r&&(r=d),l>i&&(i=l),c>a&&(a=c),d>o&&(o=d)}return this.min.set(t,n,r),this.max.set(i,a,o),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var n=hh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Fd),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Fd),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),fh.copy(t.boundingBox),fh.applyMatrix4(e.matrixWorld),this.union(fh));for(var n=e.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Fd),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,hh),hh.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(bh),Eh.subVectors(this.max,bh),ph.subVectors(e.a,bh),mh.subVectors(e.b,bh),gh.subVectors(e.c,bh),vh.subVectors(mh,ph),yh.subVectors(gh,mh),_h.subVectors(ph,gh);var t=[0,-vh.z,vh.y,0,-yh.z,yh.y,0,-_h.z,_h.y,vh.z,0,-vh.x,yh.z,0,-yh.x,_h.z,0,-_h.x,-vh.y,vh.x,0,-yh.y,yh.x,0,-_h.y,_h.x,0];return!!Ah(t,ph,mh,gh,Eh)&&(!!Ah(t=[1,0,0,0,1,0,0,0,1],ph,mh,gh,Eh)&&(Th.crossVectors(vh,yh),Ah(t=[Th.x,Th.y,Th.z],ph,mh,gh,Eh)))},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Fd),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return hh.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(hh).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()||(dh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),dh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),dh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),dh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),dh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),dh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),dh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),dh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(dh)),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var xh=new wh;function Mh(e,t){this.center=void 0!==e?e:new Fd,this.radius=void 0!==t?t:0}Object.assign(Mh.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){var n=this.center;void 0!==t?n.copy(t):xh.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Fd),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new wh),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var Ch=new Fd,Rh=new Fd,Ih=new Fd,Oh=new Fd,Dh=new Fd,Ph=new Fd,Lh=new Fd;function Nh(e,t){this.origin=void 0!==e?e:new Fd,this.direction=void 0!==t?t:new Fd(0,0,-1)}Object.assign(Nh.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Fd),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,Ch)),this},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Fd),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=Ch.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ch.copy(this.direction).multiplyScalar(t).add(this.origin),Ch.distanceToSquared(e))},distanceSqToSegment:function(e,t,n,r){Rh.copy(e).add(t).multiplyScalar(.5),Ih.copy(t).sub(e).normalize(),Oh.copy(this.origin).sub(Rh);var i,a,o,s,u=.5*e.distanceTo(t),l=-this.direction.dot(Ih),c=Oh.dot(this.direction),d=-Oh.dot(Ih),h=Oh.lengthSq(),f=Math.abs(1-l*l);if(f>0)if(a=l*c-d,s=u*f,(i=l*d-c)>=0)if(a>=-s)if(a<=s){var p=1/f;o=(i*=p)*(i+l*(a*=p)+2*c)+a*(l*i+a+2*d)+h}else a=u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*d)+h;else a=-u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*d)+h;else a<=-s?o=-(i=Math.max(0,-(-l*u+c)))*i+(a=i>0?-u:Math.min(Math.max(-u,-d),u))*(a+2*d)+h:a<=s?(i=0,o=(a=Math.min(Math.max(-u,-d),u))*(a+2*d)+h):o=-(i=Math.max(0,-(l*u+c)))*i+(a=i>0?u:Math.min(Math.max(-u,-d),u))*(a+2*d)+h;else a=l>0?-u:u,o=-(i=Math.max(0,-(l*a+c)))*i+a*(a+2*d)+h;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(Ih).multiplyScalar(a).add(Rh),o},intersectSphere:function(e,t){Ch.subVectors(e.center,this.origin);var n=Ch.dot(this.direction),r=Ch.dot(Ch)-n*n,i=e.radius*e.radius;if(r>i)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,r,i,a,o,s,u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,d=this.origin;return u>=0?(n=(e.min.x-d.x)*u,r=(e.max.x-d.x)*u):(n=(e.max.x-d.x)*u,r=(e.min.x-d.x)*u),l>=0?(i=(e.min.y-d.y)*l,a=(e.max.y-d.y)*l):(i=(e.max.y-d.y)*l,a=(e.min.y-d.y)*l),n>a||i>r?null:((i>n||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),c>=0?(o=(e.min.z-d.z)*c,s=(e.max.z-d.z)*c):(o=(e.max.z-d.z)*c,s=(e.min.z-d.z)*c),n>s||o>r?null:((o>n||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},intersectsBox:function(e){return null!==this.intersectBox(e,Ch)},intersectTriangle:function(e,t,n,r,i){Dh.subVectors(t,e),Ph.subVectors(n,e),Lh.crossVectors(Dh,Ph);var a,o=this.direction.dot(Lh);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Oh.subVectors(this.origin,e);var s=a*this.direction.dot(Ph.crossVectors(Oh,Ph));if(s<0)return null;var u=a*this.direction.dot(Dh.cross(Oh));if(u<0)return null;if(s+u>o)return null;var l=-a*Oh.dot(Lh);return l<0?null:this.at(l/o,i)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var kh=new Fd,Fh=new Fd,Bh=new Md;function Uh(e,t){this.normal=void 0!==e?e:new Fd(1,0,0),this.constant=void 0!==t?t:0}Object.assign(Uh.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,n){var r=kh.subVectors(n,t).cross(Fh.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Fd),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new Fd);var n=e.delta(kh),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:t.copy(n).multiplyScalar(i).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Fd),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){var n=t||Bh.getNormalMatrix(e),r=this.coplanarPoint(kh).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var jh=new Fd,Gh=new Fd,Hh=new Fd,Vh=new Fd,zh=new Fd,Wh=new Fd,qh=new Fd,Yh=new Fd,Kh=new Fd,Xh=new Fd;function Qh(e,t,n){this.a=void 0!==e?e:new Fd,this.b=void 0!==t?t:new Fd,this.c=void 0!==n?n:new Fd}Object.assign(Qh,{getNormal:function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Fd),r.subVectors(n,t),jh.subVectors(e,t),r.cross(jh);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},getBarycoord:function(e,t,n,r,i){jh.subVectors(r,t),Gh.subVectors(n,t),Hh.subVectors(e,t);var a=jh.dot(jh),o=jh.dot(Gh),s=jh.dot(Hh),u=Gh.dot(Gh),l=Gh.dot(Hh),c=a*u-o*o;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Fd),0===c)return i.set(-2,-1,-1);var d=1/c,h=(u*s-o*l)*d,f=(a*l-o*s)*d;return i.set(1-h-f,f,h)},containsPoint:function(e,t,n,r){return Qh.getBarycoord(e,t,n,r,Vh),Vh.x>=0&&Vh.y>=0&&Vh.x+Vh.y<=1},getUV:function(e,t,n,r,i,a,o,s){return this.getBarycoord(e,t,n,r,Vh),s.set(0,0),s.addScaledVector(i,Vh.x),s.addScaledVector(a,Vh.y),s.addScaledVector(o,Vh.z),s},isFrontFacing:function(e,t,n,r){return jh.subVectors(n,t),Gh.subVectors(e,t),jh.cross(Gh).dot(r)<0}}),Object.assign(Qh.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return jh.subVectors(this.c,this.b),Gh.subVectors(this.a,this.b),.5*jh.cross(Gh).length()},getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Fd),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Qh.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Uh),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Qh.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,r,i){return Qh.getUV(e,this.a,this.b,this.c,t,n,r,i)},containsPoint:function(e){return Qh.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return Qh.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Fd);var n,r,i=this.a,a=this.b,o=this.c;zh.subVectors(a,i),Wh.subVectors(o,i),Yh.subVectors(e,i);var s=zh.dot(Yh),u=Wh.dot(Yh);if(s<=0&&u<=0)return t.copy(i);Kh.subVectors(e,a);var l=zh.dot(Kh),c=Wh.dot(Kh);if(l>=0&&c<=l)return t.copy(a);var d=s*c-l*u;if(d<=0&&s>=0&&l<=0)return n=s/(s-l),t.copy(i).addScaledVector(zh,n);Xh.subVectors(e,o);var h=zh.dot(Xh),f=Wh.dot(Xh);if(f>=0&&h<=f)return t.copy(o);var p=h*u-s*f;if(p<=0&&u>=0&&f<=0)return r=u/(u-f),t.copy(i).addScaledVector(Wh,r);var m=l*f-h*c;if(m<=0&&c-l>=0&&h-f>=0)return qh.subVectors(o,a),r=(c-l)/(c-l+(h-f)),t.copy(a).addScaledVector(qh,r);var g=1/(m+p+d);return n=p*g,r=d*g,t.copy(i).addScaledVector(zh,n).addScaledVector(Wh,r)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var Zh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Jh={h:0,s:0,l:0},$h={h:0,s:0,l:0};function ef(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}function tf(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function nf(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function rf(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function af(e,t,n,r,i,a){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new Fd,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new ef,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}Object.assign(ef.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(e=Ad.euclideanModulo(e,1),t=Ad.clamp(t,0,1),n=Ad.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=tf(i,r,e+1/3),this.g=tf(i,r,e),this.b=tf(i,r,e-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(o,s,u)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var l=n[1],c=l.length;if(3===c)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){var t=Zh[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=nf(e.r),this.g=nf(e.g),this.b=nf(e.b),this},copyLinearToSRGB:function(e){return this.r=rf(e.r),this.g=rf(e.g),this.b=rf(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),u=(s+o)/2;if(s===o)t=0,n=0;else{var l=o-s;switch(n=u<=.5?l/(o+s):l/(2-o-s),o){case r:t=(i-a)/l+(i<a?6:0);break;case i:t=(a-r)/l+2;break;case a:t=(r-i)/l+4}t/=6}return e.h=t,e.s=n,e.l=u,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){return this.getHSL(Jh),Jh.h+=e,Jh.s+=t,Jh.l+=n,this.setHSL(Jh.h,Jh.s,Jh.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(Jh),e.getHSL($h);var n=Ad.lerp(Jh.h,$h.h,t),r=Ad.lerp(Jh.s,$h.s,t),i=Ad.lerp(Jh.l,$h.l,t);return this.setHSL(n,r,i),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),ef.NAMES=Zh,Object.assign(af.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var of=0;function sf(){Object.defineProperty(this,"id",{value:of++}),this.uuid=Ad.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=Wc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=yd,this.stencilZFail=yd,this.stencilZPass=yd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function uf(e){sf.call(this),this.type="MeshBasicMaterial",this.color=new ef(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}sf.prototype=Object.assign(Object.create(Ed.prototype),{constructor:sf,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);i.length>0&&(n.textures=i),a.length>0&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(sf.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),uf.prototype=Object.create(sf.prototype),uf.prototype.constructor=uf,uf.prototype.isMeshBasicMaterial=!0,uf.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var lf=new Fd;function cf(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=_d,this.updateRange={offset:0,count:-1},this.version=0}function df(e,t,n){cf.call(this,new Int8Array(e),t,n)}function hf(e,t,n){cf.call(this,new Uint8Array(e),t,n)}function ff(e,t,n){cf.call(this,new Uint8ClampedArray(e),t,n)}function pf(e,t,n){cf.call(this,new Int16Array(e),t,n)}function mf(e,t,n){cf.call(this,new Uint16Array(e),t,n)}function gf(e,t,n){cf.call(this,new Int32Array(e),t,n)}function vf(e,t,n){cf.call(this,new Uint32Array(e),t,n)}function yf(e,t,n){cf.call(this,new Float32Array(e),t,n)}function _f(e,t,n){cf.call(this,new Float64Array(e),t,n)}function bf(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Ef(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty(cf.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(cf.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new ef),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new xd),t[n++]=a.x,t[n++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new Fd),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new Od),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this},applyMatrix3:function(e){for(var t=0,n=this.count;t<n;t++)lf.x=this.getX(t),lf.y=this.getY(t),lf.z=this.getZ(t),lf.applyMatrix3(e),this.setXYZ(t,lf.x,lf.y,lf.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)lf.x=this.getX(t),lf.y=this.getY(t),lf.z=this.getZ(t),lf.applyMatrix4(e),this.setXYZ(t,lf.x,lf.y,lf.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)lf.x=this.getX(t),lf.y=this.getY(t),lf.z=this.getZ(t),lf.applyNormalMatrix(e),this.setXYZ(t,lf.x,lf.y,lf.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)lf.x=this.getX(t),lf.y=this.getY(t),lf.z=this.getZ(t),lf.transformDirection(e),this.setXYZ(t,lf.x,lf.y,lf.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),df.prototype=Object.create(cf.prototype),df.prototype.constructor=df,hf.prototype=Object.create(cf.prototype),hf.prototype.constructor=hf,ff.prototype=Object.create(cf.prototype),ff.prototype.constructor=ff,pf.prototype=Object.create(cf.prototype),pf.prototype.constructor=pf,mf.prototype=Object.create(cf.prototype),mf.prototype.constructor=mf,gf.prototype=Object.create(cf.prototype),gf.prototype.constructor=gf,vf.prototype=Object.create(cf.prototype),vf.prototype.constructor=vf,yf.prototype=Object.create(cf.prototype),yf.prototype.constructor=yf,_f.prototype=Object.create(cf.prototype),_f.prototype.constructor=_f,Object.assign(bf.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,i=e.faces,a=0;a<i.length;a++){var o=i[a];o.materialIndex!==r&&(r=o.materialIndex,void 0!==t&&(t.count=3*a-t.start,n.push(t)),t={start:3*a,materialIndex:r})}void 0!==t&&(t.count=3*a-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,r=e.vertices,i=e.faceVertexUvs,a=i[0]&&i[0].length>0,o=i[1]&&i[1].length>0,s=e.morphTargets,u=s.length;if(u>0){t=[];for(var l=0;l<u;l++)t[l]={name:s[l].name,data:[]};this.morphTargets.position=t}var c,d=e.morphNormals,h=d.length;if(h>0){c=[];for(l=0;l<h;l++)c[l]={name:d[l].name,data:[]};this.morphTargets.normal=c}var f=e.skinIndices,p=e.skinWeights,m=f.length===r.length,g=p.length===r.length;r.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(l=0;l<n.length;l++){var v=n[l];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var _=v.normal;this.normals.push(_,_,_)}var b,E=v.vertexColors;if(3===E.length)this.colors.push(E[0],E[1],E[2]);else{var T=v.color;this.colors.push(T,T,T)}if(!0===a)void 0!==(b=i[0][l])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new xd,new xd,new xd));if(!0===o)void 0!==(b=i[1][l])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new xd,new xd,new xd));for(var S=0;S<u;S++){var w=s[S].vertices;t[S].data.push(w[v.a],w[v.b],w[v.c])}for(S=0;S<h;S++){var A=d[S].vertexNormals[l];c[S].data.push(A.a,A.b,A.c)}m&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),g&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});var Tf=1,Sf=new Wd,wf=new lh,Af=new Fd,xf=new wh,Mf=new wh,Cf=new Fd;function Rf(){Object.defineProperty(this,"id",{value:Tf+=2}),this.uuid=Ad.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Rf.prototype=Object.assign(Object.create(Ed.prototype),{constructor:Rf,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Ef(e)>65535?vf:mf)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new Md).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return Sf.makeRotationX(e),this.applyMatrix4(Sf),this},rotateY:function(e){return Sf.makeRotationY(e),this.applyMatrix4(Sf),this},rotateZ:function(e){return Sf.makeRotationZ(e),this.applyMatrix4(Sf),this},translate:function(e,t,n){return Sf.makeTranslation(e,t,n),this.applyMatrix4(Sf),this},scale:function(e,t,n){return Sf.makeScale(e,t,n),this.applyMatrix4(Sf),this},lookAt:function(e){return wf.lookAt(e),wf.updateMatrix(),this.applyMatrix4(wf.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Af).negate(),this.translate(Af.x,Af.y,Af.z),this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new yf(3*t.vertices.length,3),r=new yf(3*t.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(t.vertices)),this.setAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new yf(t.lineDistances.length,1);this.setAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new yf(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new bf).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new cf(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);this.setAttribute("normal",new cf(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var r=new Float32Array(3*e.colors.length);this.setAttribute("color",new cf(r,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new cf(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new cf(a,2).copyVector2sArray(e.uvs2))}for(var o in this.groups=e.groups,e.morphTargets){for(var s=[],u=e.morphTargets[o],l=0,c=u.length;l<c;l++){var d=u[l],h=new yf(3*d.data.length,3);h.name=d.name,s.push(h.copyVector3sArray(d.data))}this.morphAttributes[o]=s}if(e.skinIndices.length>0){var f=new yf(4*e.skinIndices.length,4);this.setAttribute("skinIndex",f.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var p=new yf(4*e.skinWeights.length,4);this.setAttribute("skinWeight",p.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new wh);var e=this.attributes.position,t=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];xf.setFromBufferAttribute(i),this.morphTargetsRelative?(Cf.addVectors(this.boundingBox.min,xf.min),this.boundingBox.expandByPoint(Cf),Cf.addVectors(this.boundingBox.max,xf.max),this.boundingBox.expandByPoint(Cf)):(this.boundingBox.expandByPoint(xf.min),this.boundingBox.expandByPoint(xf.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Mh);var e=this.attributes.position,t=this.morphAttributes.position;if(e){var n=this.boundingSphere.center;if(xf.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var a=t[r];Mf.setFromBufferAttribute(a),this.morphTargetsRelative?(Cf.addVectors(xf.min,Mf.min),xf.expandByPoint(Cf),Cf.addVectors(xf.max,Mf.max),xf.expandByPoint(Cf)):(xf.expandByPoint(Mf.min),xf.expandByPoint(Mf.max))}xf.getCenter(n);var o=0;for(r=0,i=e.count;r<i;r++)Cf.fromBufferAttribute(e,r),o=Math.max(o,n.distanceToSquared(Cf));if(t)for(r=0,i=t.length;r<i;r++){a=t[r];for(var s=this.morphTargetsRelative,u=0,l=a.count;u<l;u++)Cf.fromBufferAttribute(a,u),s&&(Af.fromBufferAttribute(e,u),Cf.add(Af)),o=Math.max(o,n.distanceToSquared(Cf))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(void 0===t.normal)this.setAttribute("normal",new cf(new Float32Array(n.length),3));else for(var r=t.normal.array,i=0,a=r.length;i<a;i++)r[i]=0;var o,s,u,l=t.normal.array,c=new Fd,d=new Fd,h=new Fd,f=new Fd,p=new Fd;if(e){var m=e.array;for(i=0,a=e.count;i<a;i+=3)o=3*m[i+0],s=3*m[i+1],u=3*m[i+2],c.fromArray(n,o),d.fromArray(n,s),h.fromArray(n,u),f.subVectors(h,d),p.subVectors(c,d),f.cross(p),l[o]+=f.x,l[o+1]+=f.y,l[o+2]+=f.z,l[s]+=f.x,l[s+1]+=f.y,l[s+2]+=f.z,l[u]+=f.x,l[u+1]+=f.y,l[u+2]+=f.z}else for(i=0,a=n.length;i<a;i+=9)c.fromArray(n,i),d.fromArray(n,i+3),h.fromArray(n,i+6),f.subVectors(h,d),p.subVectors(c,d),f.cross(p),l[i]=f.x,l[i+1]=f.y,l[i+2]=f.z,l[i+3]=f.x,l[i+4]=f.y,l[i+5]=f.z,l[i+6]=f.x,l[i+7]=f.y,l[i+8]=f.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,a=e.attributes[r],o=a.array,s=a.itemSize*t,u=Math.min(o.length,i.length-s),l=0,c=s;l<u;l++,c++)i[c]=o[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Cf.x=e.getX(t),Cf.y=e.getY(t),Cf.z=e.getZ(t),Cf.normalize(),e.setXYZ(t,Cf.x,Cf.y,Cf.z)},toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=new n.constructor(t.length*r),a=0,o=0,s=0,u=t.length;s<u;s++){a=t[s]*r;for(var l=0;l<r;l++)i[o++]=n[a++]}return new cf(i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Rf,n=this.index.array,r=this.attributes;for(var i in r){var a=e(r[i],n);t.setAttribute(i,a)}var o=this.morphAttributes;for(i in o){for(var s=[],u=o[i],l=0,c=u.length;l<c;l++){a=e(u[l],n);s.push(a)}t.morphAttributes[i]=s}t.morphTargetsRelative=this.morphTargetsRelative;for(var d=this.groups,h=(l=0,d.length);l<h;l++){var f=d[l];t.addGroup(f.start,f.count,f.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var a=(h=i[n]).toJSON();""!==h.name&&(a.name=h.name),e.data.attributes[n]=a}var o={},s=!1;for(var n in this.morphAttributes){for(var u=this.morphAttributes[n],l=[],c=0,d=u.length;c<d;c++){var h;a=(h=u[c]).toJSON();""!==h.name&&(a.name=h.name),l.push(a)}l.length>0&&(o[n]=l,s=!0)}s&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);var f=this.groups;f.length>0&&(e.data.groups=JSON.parse(JSON.stringify(f)));var p=this.boundingSphere;return null!==p&&(e.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),e},clone:function(){return(new Rf).copy(this)},copy:function(e){var t,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var a=e.attributes;for(t in a){var o=a[t];this.setAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var u=[],l=s[t];for(n=0,r=l.length;n<r;n++)u.push(l[n].clone());this.morphAttributes[t]=u}this.morphTargetsRelative=e.morphTargetsRelative;var c=e.groups;for(n=0,r=c.length;n<r;n++){var d=c[n];this.addGroup(d.start,d.count,d.materialIndex)}var h=e.boundingBox;null!==h&&(this.boundingBox=h.clone());var f=e.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var If=new Wd,Of=new Nh,Df=new Mh,Pf=new Fd,Lf=new Fd,Nf=new Fd,kf=new Fd,Ff=new Fd,Bf=new Fd,Uf=new Fd,jf=new Fd,Gf=new Fd,Hf=new xd,Vf=new xd,zf=new xd,Wf=new Fd,qf=new Fd;function Yf(e,t){lh.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Rf,this.material=void 0!==t?t:new uf,this.updateMorphTargets()}function Kf(e,t,n,r,i,a,o,s){if(null===(1===t.side?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,2!==t.side,s)))return null;qf.copy(s),qf.applyMatrix4(e.matrixWorld);var u=n.ray.origin.distanceTo(qf);return u<n.near||u>n.far?null:{distance:u,point:qf.clone(),object:e}}function Xf(e,t,n,r,i,a,o,s,u,l,c,d){Pf.fromBufferAttribute(i,l),Lf.fromBufferAttribute(i,c),Nf.fromBufferAttribute(i,d);var h=e.morphTargetInfluences;if(t.morphTargets&&a&&h){Uf.set(0,0,0),jf.set(0,0,0),Gf.set(0,0,0);for(var f=0,p=a.length;f<p;f++){var m=h[f],g=a[f];0!==m&&(kf.fromBufferAttribute(g,l),Ff.fromBufferAttribute(g,c),Bf.fromBufferAttribute(g,d),o?(Uf.addScaledVector(kf,m),jf.addScaledVector(Ff,m),Gf.addScaledVector(Bf,m)):(Uf.addScaledVector(kf.sub(Pf),m),jf.addScaledVector(Ff.sub(Lf),m),Gf.addScaledVector(Bf.sub(Nf),m)))}Pf.add(Uf),Lf.add(jf),Nf.add(Gf)}var v=Kf(e,t,n,r,Pf,Lf,Nf,Wf);if(v){s&&(Hf.fromBufferAttribute(s,l),Vf.fromBufferAttribute(s,c),zf.fromBufferAttribute(s,d),v.uv=Qh.getUV(Wf,Pf,Lf,Nf,Hf,Vf,zf,new xd)),u&&(Hf.fromBufferAttribute(u,l),Vf.fromBufferAttribute(u,c),zf.fromBufferAttribute(u,d),v.uv2=Qh.getUV(Wf,Pf,Lf,Nf,Hf,Vf,zf,new xd));var y=new af(l,c,d);Qh.getNormal(Pf,Lf,Nf,y.normal),v.face=y}return v}Yf.prototype=Object.assign(Object.create(lh.prototype),{constructor:Yf,isMesh:!0,copy:function(e){return lh.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)n=o[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var n,r=this.geometry,i=this.material,a=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),Df.copy(r.boundingSphere),Df.applyMatrix4(a),!1!==e.ray.intersectsSphere(Df)&&(If.getInverse(a),Of.copy(e.ray).applyMatrix4(If),null===r.boundingBox||!1!==Of.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var o,s,u,l,c,d,h,f,p,m=r.index,g=r.attributes.position,v=r.morphAttributes.position,y=r.morphTargetsRelative,_=r.attributes.uv,b=r.attributes.uv2,E=r.groups,T=r.drawRange;if(null!==m)if(Array.isArray(i))for(l=0,d=E.length;l<d;l++)for(p=i[(f=E[l]).materialIndex],c=Math.max(f.start,T.start),h=Math.min(f.start+f.count,T.start+T.count);c<h;c+=3)o=m.getX(c),s=m.getX(c+1),u=m.getX(c+2),(n=Xf(this,p,e,Of,g,v,y,_,b,o,s,u))&&(n.faceIndex=Math.floor(c/3),n.face.materialIndex=f.materialIndex,t.push(n));else for(l=Math.max(0,T.start),d=Math.min(m.count,T.start+T.count);l<d;l+=3)o=m.getX(l),s=m.getX(l+1),u=m.getX(l+2),(n=Xf(this,i,e,Of,g,v,y,_,b,o,s,u))&&(n.faceIndex=Math.floor(l/3),t.push(n));else if(void 0!==g)if(Array.isArray(i))for(l=0,d=E.length;l<d;l++)for(p=i[(f=E[l]).materialIndex],c=Math.max(f.start,T.start),h=Math.min(f.start+f.count,T.start+T.count);c<h;c+=3)(n=Xf(this,p,e,Of,g,v,y,_,b,o=c,s=c+1,u=c+2))&&(n.faceIndex=Math.floor(c/3),n.face.materialIndex=f.materialIndex,t.push(n));else for(l=Math.max(0,T.start),d=Math.min(g.count,T.start+T.count);l<d;l+=3)(n=Xf(this,i,e,Of,g,v,y,_,b,o=l,s=l+1,u=l+2))&&(n.faceIndex=Math.floor(l/3),t.push(n))}else if(r.isGeometry){var S,w,A,x,M=Array.isArray(i),C=r.vertices,R=r.faces,I=r.faceVertexUvs[0];I.length>0&&(x=I);for(var O=0,D=R.length;O<D;O++){var P=R[O],L=M?i[P.materialIndex]:i;if(void 0!==L&&(S=C[P.a],w=C[P.b],A=C[P.c],n=Kf(this,L,e,Of,S,w,A,Wf))){if(x&&x[O]){var N=x[O];Hf.copy(N[0]),Vf.copy(N[1]),zf.copy(N[2]),n.uv=Qh.getUV(Wf,S,w,A,Hf,Vf,zf,new xd)}n.face=P,n.faceIndex=O,t.push(n)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Qf=0,Zf=new Wd,Jf=new lh,$f=new Fd;function ep(){Object.defineProperty(this,"id",{value:Qf+=2}),this.uuid=Ad.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}ep.prototype=Object.assign(Object.create(Ed.prototype),{constructor:ep,isGeometry:!0,applyMatrix4:function(e){for(var t=(new Md).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(e)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var a=0,o=i.vertexNormals.length;a<o;a++)i.vertexNormals[a].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return Zf.makeRotationX(e),this.applyMatrix4(Zf),this},rotateY:function(e){return Zf.makeRotationY(e),this.applyMatrix4(Zf),this},rotateZ:function(e){return Zf.makeRotationZ(e),this.applyMatrix4(Zf),this},translate:function(e,t,n){return Zf.makeTranslation(e,t,n),this.applyMatrix4(Zf),this},scale:function(e,t,n){return Zf.makeScale(e,t,n),this.applyMatrix4(Zf),this},lookAt:function(e){return Jf.lookAt(e),Jf.updateMatrix(),this.applyMatrix4(Jf.matrix),this},fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index.array:void 0,r=e.attributes;if(void 0===r.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=r.position.array,a=void 0!==r.normal?r.normal.array:void 0,o=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,u=void 0!==r.uv2?r.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var l=0;l<i.length;l+=3)t.vertices.push((new Fd).fromArray(i,l)),void 0!==o&&t.colors.push((new ef).fromArray(o,l));function c(e,n,r,i){var l=void 0===o?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[r].clone()],c=new af(e,n,r,void 0===a?[]:[(new Fd).fromArray(a,3*e),(new Fd).fromArray(a,3*n),(new Fd).fromArray(a,3*r)],l,i);t.faces.push(c),void 0!==s&&t.faceVertexUvs[0].push([(new xd).fromArray(s,2*e),(new xd).fromArray(s,2*n),(new xd).fromArray(s,2*r)]),void 0!==u&&t.faceVertexUvs[1].push([(new xd).fromArray(u,2*e),(new xd).fromArray(u,2*n),(new xd).fromArray(u,2*r)])}var d=e.groups;if(d.length>0)for(l=0;l<d.length;l++)for(var h=d[l],f=h.start,p=f,m=f+h.count;p<m;p+=3)void 0!==n?c(n[p],n[p+1],n[p+2],h.materialIndex):c(p,p+1,p+2,h.materialIndex);else if(void 0!==n)for(l=0;l<n.length;l+=3)c(n[l],n[l+1],n[l+2]);else for(l=0;l<i.length/3;l+=3)c(l,l+1,l+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter($f).negate(),this.translate($f.x,$f.y,$f.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,r=new Wd;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var e=new Fd,t=new Fd,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r,i,a,o;for(void 0===e&&(e=!0),o=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)o[t]=new Fd;if(e){var s,u,l,c=new Fd,d=new Fd;for(r=0,i=this.faces.length;r<i;r++)a=this.faces[r],s=this.vertices[a.a],u=this.vertices[a.b],l=this.vertices[a.c],c.subVectors(l,u),d.subVectors(s,u),c.cross(d),o[a.a].add(c),o[a.b].add(c),o[a.c].add(c)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)o[(a=this.faces[r]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(t=0,n=this.vertices.length;t<n;t++)o[t].normalize();for(r=0,i=this.faces.length;r<i;r++){var h=(a=this.faces[r]).vertexNormals;3===h.length?(h[0].copy(o[a.a]),h[1].copy(o[a.b]),h[2].copy(o[a.c])):(h[0]=o[a.a].clone(),h[1]=o[a.b].clone(),h[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var r=(n=this.faces[e]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var a=new ep;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)u=new Fd,l={a:new Fd,b:new Fd,c:new Fd},o.push(u),s.push(l)}var u,l,c=this.morphNormals[e];for(a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],u=c.faceNormals[n],l=c.vertexNormals[n],u.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new wh),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Mh),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,u=e.faces,l=this.colors,c=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new Md).getNormalMatrix(t));for(var d=0,h=o.length;d<h;d++){var f=o[d].clone();void 0!==t&&f.applyMatrix4(t),a.push(f)}for(d=0,h=c.length;d<h;d++)l.push(c[d].clone());for(d=0,h=u.length;d<h;d++){var p,m,g,v=u[d],y=v.vertexNormals,_=v.vertexColors;(p=new af(v.a+i,v.b+i,v.c+i)).normal.copy(v.normal),void 0!==r&&p.normal.applyMatrix3(r).normalize();for(var b=0,E=y.length;b<E;b++)m=y[b].clone(),void 0!==r&&m.applyMatrix3(r).normalize(),p.vertexNormals.push(m);p.color.copy(v.color);for(b=0,E=_.length;b<E;b++)g=_[b],p.vertexColors.push(g.clone());p.materialIndex=v.materialIndex+n,s.push(p)}for(d=0,h=e.faceVertexUvs.length;d<h;d++){var T=e.faceVertexUvs[d];void 0===this.faceVertexUvs[d]&&(this.faceVertexUvs[d]=[]);for(b=0,E=T.length;b<E;b++){for(var S=T[b],w=[],A=0,x=S.length;A<x;A++)w.push(S[A].clone());this.faceVertexUvs[d].push(w)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,r,i,a,o,s,u={},l=[],c=[],d=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)e=this.vertices[n],void 0===u[t=Math.round(e.x*d)+"_"+Math.round(e.y*d)+"_"+Math.round(e.z*d)]?(u[t]=n,l.push(this.vertices[n]),c[n]=l.length-1):c[n]=c[u[t]];var h=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],a=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(a[f]===a[(f+1)%3]){h.push(n);break}}for(n=h.length-1;n>=0;n--){var p=h[n];for(this.faces.splice(p,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(p,1)}var m=this.vertices.length-l.length;return this.vertices=l,m},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new Fd(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var r,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===t&&(r=[]),o&&o.length===t&&(i=[]);for(n=0;n<t;n++){var s=e[n]._id;r&&r.push(a[s]),i&&i.push(o[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var r=[],i=0;i<this.vertices.length;i++){var a=this.vertices[i];r.push(a.x,a.y,a.z)}var o=[],s=[],u={},l=[],c={},d=[],h={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=f.normal.length()>0,g=f.vertexNormals.length>0,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=f.vertexColors.length>0,_=0;if(_=S(_,0,0),_=S(_,1,!0),_=S(_,2,!1),_=S(_,3,p),_=S(_,4,m),_=S(_,5,g),_=S(_,6,v),_=S(_,7,y),o.push(_),o.push(f.a,f.b,f.c),o.push(f.materialIndex),p){var b=this.faceVertexUvs[0][i];o.push(x(b[0]),x(b[1]),x(b[2]))}if(m&&o.push(w(f.normal)),g){var E=f.vertexNormals;o.push(w(E[0]),w(E[1]),w(E[2]))}if(v&&o.push(A(f.color)),y){var T=f.vertexColors;o.push(A(T[0]),A(T[1]),A(T[2]))}}function S(e,t,n){return n?e|1<<t:e&~(1<<t)}function w(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==u[t]||(u[t]=s.length/3,s.push(e.x,e.y,e.z)),u[t]}function A(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]||(c[t]=l.length,l.push(e.getHex())),c[t]}function x(e){var t=e.x.toString()+e.y.toString();return void 0!==h[t]||(h[t]=d.length/2,d.push(e.x,e.y)),h[t]}return e.data={},e.data.vertices=r,e.data.normals=s,l.length>0&&(e.data.colors=l),d.length>0&&(e.data.uvs=[d]),e.data.faces=o,e},clone:function(){return(new ep).copy(this)},copy:function(e){var t,n,r,i,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var u=e.colors;for(t=0,n=u.length;t<n;t++)this.colors.push(u[t].clone());var l=e.faces;for(t=0,n=l.length;t<n;t++)this.faces.push(l[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var c=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),r=0,i=c.length;r<i;r++){var d=c[r],h=[];for(a=0,o=d.length;a<o;a++){var f=d[a];h.push(f.clone())}this.faceVertexUvs[t].push(h)}}var p=e.morphTargets;for(t=0,n=p.length;t<n;t++){var m={};if(m.name=p[t].name,void 0!==p[t].vertices)for(m.vertices=[],r=0,i=p[t].vertices.length;r<i;r++)m.vertices.push(p[t].vertices[r].clone());if(void 0!==p[t].normals)for(m.normals=[],r=0,i=p[t].normals.length;r<i;r++)m.normals.push(p[t].normals[r].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,n=g.length;t<n;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],r=0,i=g[t].vertexNormals.length;r<i;r++){var y=g[t].vertexNormals[r],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),v.vertexNormals.push(_)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],r=0,i=g[t].faceNormals.length;r<i;r++)v.faceNormals.push(g[t].faceNormals[r].clone());this.morphNormals.push(v)}var b=e.skinWeights;for(t=0,n=b.length;t<n;t++)this.skinWeights.push(b[t].clone());var E=e.skinIndices;for(t=0,n=E.length;t<n;t++)this.skinIndices.push(E[t].clone());var T=e.lineDistances;for(t=0,n=T.length;t<n;t++)this.lineDistances.push(T[t]);var S=e.boundingBox;null!==S&&(this.boundingBox=S.clone());var w=e.boundingSphere;return null!==w&&(this.boundingSphere=w.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class tp extends Rf{constructor(e,t,n,r,i,a){super(),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};var o=this;e=e||1,t=t||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,a=Math.floor(a)||1;var s=[],u=[],l=[],c=[],d=0,h=0;function f(e,t,n,r,i,a,f,p,m,g,v){var y,_,b=a/m,E=f/g,T=a/2,S=f/2,w=p/2,A=m+1,x=g+1,M=0,C=0,R=new Fd;for(_=0;_<x;_++){var I=_*E-S;for(y=0;y<A;y++){var O=y*b-T;R[e]=O*r,R[t]=I*i,R[n]=w,u.push(R.x,R.y,R.z),R[e]=0,R[t]=0,R[n]=p>0?1:-1,l.push(R.x,R.y,R.z),c.push(y/m),c.push(1-_/g),M+=1}}for(_=0;_<g;_++)for(y=0;y<m;y++){var D=d+y+A*_,P=d+y+A*(_+1),L=d+(y+1)+A*(_+1),N=d+(y+1)+A*_;s.push(D,P,N),s.push(P,L,N),C+=6}o.addGroup(h,C,v),h+=C,d+=M}f("z","y","x",-1,-1,n,t,e,a,i,0),f("z","y","x",1,-1,n,t,-e,a,i,1),f("x","z","y",1,1,e,n,t,r,a,2),f("x","z","y",1,-1,e,n,-t,r,a,3),f("x","y","z",1,-1,e,t,n,r,i,4),f("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(s),this.setAttribute("position",new yf(u,3)),this.setAttribute("normal",new yf(l,3)),this.setAttribute("uv",new yf(c,2))}}function np(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function rp(e){for(var t={},n=0;n<e.length;n++){var r=np(e[n]);for(var i in r)t[i]=r[i]}return t}var ip={clone:np,merge:rp};function ap(e){sf.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function op(){lh.call(this),this.type="Camera",this.matrixWorldInverse=new Wd,this.projectionMatrix=new Wd,this.projectionMatrixInverse=new Wd}function sp(e,t,n,r){op.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}ap.prototype=Object.create(sf.prototype),ap.prototype.constructor=ap,ap.prototype.isShaderMaterial=!0,ap.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=np(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},ap.prototype.toJSON=function(e){var t=sf.prototype.toJSON.call(this,e);for(var n in t.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var i={};for(var a in this.extensions)!0===this.extensions[a]&&(i[a]=!0);return Object.keys(i).length>0&&(t.extensions=i),t},op.prototype=Object.assign(Object.create(lh.prototype),{constructor:op,isCamera:!0,copy:function(e,t){return lh.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Fd),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){lh.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){lh.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),sp.prototype=Object.assign(Object.create(op.prototype),{constructor:sp,isPerspectiveCamera:!0,copy:function(e,t){return op.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Ad.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Ad.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Ad.RAD2DEG*Math.atan(Math.tan(.5*Ad.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Ad.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var u=this.filmOffset;0!==u&&(i+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=lh.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var up=90;function lp(e,t,n,r){lh.call(this),this.type="CubeCamera";var i=new sp(up,1,e,t);i.up.set(0,-1,0),i.lookAt(new Fd(1,0,0)),this.add(i);var a=new sp(up,1,e,t);a.up.set(0,-1,0),a.lookAt(new Fd(-1,0,0)),this.add(a);var o=new sp(up,1,e,t);o.up.set(0,0,1),o.lookAt(new Fd(0,1,0)),this.add(o);var s=new sp(up,1,e,t);s.up.set(0,0,-1),s.lookAt(new Fd(0,-1,0)),this.add(s);var u=new sp(up,1,e,t);u.up.set(0,-1,0),u.lookAt(new Fd(0,0,1)),this.add(u);var l=new sp(up,1,e,t);l.up.set(0,-1,0),l.lookAt(new Fd(0,0,-1)),this.add(l),r=r||{format:od,magFilter:$c,minFilter:$c},this.renderTarget=new cp(n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=e.getRenderTarget(),r=this.renderTarget,c=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,a),e.setRenderTarget(r,2),e.render(t,o),e.setRenderTarget(r,3),e.render(t,s),e.setRenderTarget(r,4),e.render(t,u),r.texture.generateMipmaps=c,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(n)},this.clear=function(e,t,n,r){for(var i=e.getRenderTarget(),a=this.renderTarget,o=0;o<6;o++)e.setRenderTarget(a,o),e.clear(t,n,r);e.setRenderTarget(i)}}function cp(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),Dd.call(this,e,e,t)}function dp(e,t,n,r,i,a,o,s,u,l,c,d){Id.call(this,null,a,o,s,u,l,r,i,c,d),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=void 0!==u?u:Qc,this.minFilter=void 0!==l?l:Qc,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}lp.prototype=Object.create(lh.prototype),lp.prototype.constructor=lp,cp.prototype=Object.create(Dd.prototype),cp.prototype.constructor=cp,cp.prototype.isWebGLCubeRenderTarget=!0,cp.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var n=new ch,r={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},i=new ap({type:"CubemapFromEquirect",uniforms:np(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:1,blending:0});i.uniforms.tEquirect.value=t;var a=new Yf(new tp(5,5,5),i);n.add(a);var o=new lp(1,10,1);return o.renderTarget=this,o.renderTarget.texture.name="CubeCameraTexture",o.update(e,n),a.geometry.dispose(),a.material.dispose(),this},dp.prototype=Object.create(Id.prototype),dp.prototype.constructor=dp,dp.prototype.isDataTexture=!0;var hp=new Mh,fp=new Fd;function pp(e,t,n,r,i,a){this.planes=[void 0!==e?e:new Uh,void 0!==t?t:new Uh,void 0!==n?n:new Uh,void 0!==r?r:new Uh,void 0!==i?i:new Uh,void 0!==a?a:new Uh]}Object.assign(pp.prototype,{set:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromProjectionMatrix:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],l=n[6],c=n[7],d=n[8],h=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(o-r,c-s,p-d,y-m).normalize(),t[1].setComponents(o+r,c+s,p+d,y+m).normalize(),t[2].setComponents(o+i,c+u,p+h,y+g).normalize(),t[3].setComponents(o-i,c-u,p-h,y-g).normalize(),t[4].setComponents(o-a,c-l,p-f,y-v).normalize(),t[5].setComponents(o+a,c+l,p+f,y+v).normalize(),this},intersectsObject:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),hp.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(hp)},intersectsSprite:function(e){return hp.center.set(0,0,0),hp.radius=.7071067811865476,hp.applyMatrix4(e.matrixWorld),this.intersectsSphere(hp)},intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(fp.x=r.normal.x>0?e.max.x:e.min.x,fp.y=r.normal.y>0?e.max.y:e.min.y,fp.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(fp)<0)return!1}return!0},containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var mp={common:{diffuse:{value:new ef(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Md},uv2Transform:{value:new Md},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new xd(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ef(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ef(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Md}},sprite:{diffuse:{value:new ef(15658734)},opacity:{value:1},center:{value:new xd(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Md}}};function gp(){var e=null,t=!1,n=null;function r(i,a){!1!==t&&(n(i,a),e.requestAnimationFrame(r))}return{start:function(){!0!==t&&null!==n&&(e.requestAnimationFrame(r),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function vp(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){t.isInterleavedBufferAttribute&&(t=t.data);var a=r.get(t);void 0===a?r.set(t,function(t,n){var r=t.array,i=t.usage,a=e.createBuffer();e.bindBuffer(n,a),e.bufferData(n,r,i),t.onUploadCallback();var o=5126;return r instanceof Float32Array?o=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?o=5123:r instanceof Int16Array?o=5122:r instanceof Uint32Array?o=5125:r instanceof Int32Array?o=5124:r instanceof Int8Array?o=5120:r instanceof Uint8Array&&(o=5121),{buffer:a,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(t,i)):a.version<t.version&&(!function(t,r,i){var a=r.array,o=r.updateRange;e.bindBuffer(i,t),-1===o.count?e.bufferSubData(i,0,a):(n?e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):e.bufferSubData(i,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(a.buffer,t,i),a.version=t.version)}}}function yp(e,t,n,r){ep.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new _p(e,t,n,r)),this.mergeVertices()}function _p(e,t,n,r){Rf.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};var i,a,o=(e=e||1)/2,s=(t=t||1)/2,u=Math.floor(n)||1,l=Math.floor(r)||1,c=u+1,d=l+1,h=e/u,f=t/l,p=[],m=[],g=[],v=[];for(a=0;a<d;a++){var y=a*f-s;for(i=0;i<c;i++){var _=i*h-o;m.push(_,-y,0),g.push(0,0,1),v.push(i/u),v.push(1-a/l)}}for(a=0;a<l;a++)for(i=0;i<u;i++){var b=i+c*a,E=i+c*(a+1),T=i+1+c*(a+1),S=i+1+c*a;p.push(b,E,S),p.push(E,T,S)}this.setIndex(p),this.setAttribute("position",new yf(m,3)),this.setAttribute("normal",new yf(g,3)),this.setAttribute("uv",new yf(v,2))}yp.prototype=Object.create(ep.prototype),yp.prototype.constructor=yp,_p.prototype=Object.create(Rf.prototype),_p.prototype.constructor=_p;var bp={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP ) && ! defined( TOON )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP ) && ! defined( TOON )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP ) && ! defined( TOON )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) { \n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = saturate( clearcoat );\tmaterial.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_normalmap_pars_fragment:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Ep={basic:{uniforms:rp([mp.common,mp.specularmap,mp.envmap,mp.aomap,mp.lightmap,mp.fog]),vertexShader:bp.meshbasic_vert,fragmentShader:bp.meshbasic_frag},lambert:{uniforms:rp([mp.common,mp.specularmap,mp.envmap,mp.aomap,mp.lightmap,mp.emissivemap,mp.fog,mp.lights,{emissive:{value:new ef(0)}}]),vertexShader:bp.meshlambert_vert,fragmentShader:bp.meshlambert_frag},phong:{uniforms:rp([mp.common,mp.specularmap,mp.envmap,mp.aomap,mp.lightmap,mp.emissivemap,mp.bumpmap,mp.normalmap,mp.displacementmap,mp.fog,mp.lights,{emissive:{value:new ef(0)},specular:{value:new ef(1118481)},shininess:{value:30}}]),vertexShader:bp.meshphong_vert,fragmentShader:bp.meshphong_frag},standard:{uniforms:rp([mp.common,mp.envmap,mp.aomap,mp.lightmap,mp.emissivemap,mp.bumpmap,mp.normalmap,mp.displacementmap,mp.roughnessmap,mp.metalnessmap,mp.fog,mp.lights,{emissive:{value:new ef(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:bp.meshphysical_vert,fragmentShader:bp.meshphysical_frag},toon:{uniforms:rp([mp.common,mp.specularmap,mp.aomap,mp.lightmap,mp.emissivemap,mp.bumpmap,mp.normalmap,mp.displacementmap,mp.gradientmap,mp.fog,mp.lights,{emissive:{value:new ef(0)},specular:{value:new ef(1118481)},shininess:{value:30}}]),vertexShader:bp.meshtoon_vert,fragmentShader:bp.meshtoon_frag},matcap:{uniforms:rp([mp.common,mp.bumpmap,mp.normalmap,mp.displacementmap,mp.fog,{matcap:{value:null}}]),vertexShader:bp.meshmatcap_vert,fragmentShader:bp.meshmatcap_frag},points:{uniforms:rp([mp.points,mp.fog]),vertexShader:bp.points_vert,fragmentShader:bp.points_frag},dashed:{uniforms:rp([mp.common,mp.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:bp.linedashed_vert,fragmentShader:bp.linedashed_frag},depth:{uniforms:rp([mp.common,mp.displacementmap]),vertexShader:bp.depth_vert,fragmentShader:bp.depth_frag},normal:{uniforms:rp([mp.common,mp.bumpmap,mp.normalmap,mp.displacementmap,{opacity:{value:1}}]),vertexShader:bp.normal_vert,fragmentShader:bp.normal_frag},sprite:{uniforms:rp([mp.sprite,mp.fog]),vertexShader:bp.sprite_vert,fragmentShader:bp.sprite_frag},background:{uniforms:{uvTransform:{value:new Md},t2D:{value:null}},vertexShader:bp.background_vert,fragmentShader:bp.background_frag},cube:{uniforms:rp([mp.envmap,{opacity:{value:1}}]),vertexShader:bp.cube_vert,fragmentShader:bp.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:bp.equirect_vert,fragmentShader:bp.equirect_frag},distanceRGBA:{uniforms:rp([mp.common,mp.displacementmap,{referencePosition:{value:new Fd},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:bp.distanceRGBA_vert,fragmentShader:bp.distanceRGBA_frag},shadow:{uniforms:rp([mp.lights,mp.fog,{color:{value:new ef(0)},opacity:{value:1}}]),vertexShader:bp.shadow_vert,fragmentShader:bp.shadow_frag}};function Tp(e,t,n,r){var i,a,o=new ef(0),s=0,u=null,l=0,c=null;function d(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,r)}return{getClearColor:function(){return o},setClearColor:function(e,t){o.set(e),d(o,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){d(o,s=e)},render:function(t,r,h,f){var p=r.background,m=e.xr,g=m.getSession&&m.getSession();if(g&&"additive"===g.environmentBlendMode&&(p=null),null===p?d(o,s):p&&p.isColor&&(d(p,1),f=!0),(e.autoClear||f)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLCubeRenderTarget||p.mapping===qc)){void 0===a&&((a=new Yf(new tp(1,1,1),new ap({type:"BackgroundCubeMaterial",uniforms:np(Ep.cube.uniforms),vertexShader:Ep.cube.vertexShader,fragmentShader:Ep.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(a));var v=p.isWebGLCubeRenderTarget?p.texture:p;a.material.uniforms.envMap.value=v,a.material.uniforms.flipEnvMap.value=v.isCubeTexture?-1:1,u===p&&l===v.version&&c===e.toneMapping||(a.material.needsUpdate=!0,u=p,l=v.version,c=e.toneMapping),t.unshift(a,a.geometry,a.material,0,0,null)}else p&&p.isTexture&&(void 0===i&&((i=new Yf(new _p(2,2),new ap({type:"BackgroundMaterial",uniforms:np(Ep.background.uniforms),vertexShader:Ep.background.vertexShader,fragmentShader:Ep.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),i.material.uniforms.uvTransform.value.copy(p.matrix),u===p&&l===p.version&&c===e.toneMapping||(i.material.needsUpdate=!0,u=p,l=p.version,c=e.toneMapping),t.unshift(i,i.geometry,i.material,0,0,null))}}}function Sp(e,t,n,r){var i,a=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i)},this.renderInstances=function(r,o,s,u){if(0!==u){var l,c;if(a)l=e,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](i,o,s,u),n.update(s,i,u)}}}function wp(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=i(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var u=!0===n.logarithmicDepthBuffer,l=e.getParameter(34930),c=e.getParameter(35660),d=e.getParameter(3379),h=e.getParameter(34076),f=e.getParameter(34921),p=e.getParameter(36347),m=e.getParameter(36348),g=e.getParameter(36349),v=c>0,y=a||!!t.get("OES_texture_float");return{isWebGL2:a,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:o,logarithmicDepthBuffer:u,maxTextures:l,maxVertexTextures:c,maxTextureSize:d,maxCubemapSize:h,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y,maxSamples:a?e.getParameter(36183):0}}function Ap(){var e=this,t=null,n=0,r=!1,i=!1,a=new Uh,o=new Md,s={value:null,needsUpdate:!1};function u(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function l(t,n,r,i){var u=null!==t?t.length:0,l=null;if(0!==u){if(l=s.value,!0!==i||null===l){var c=r+4*u,d=n.matrixWorldInverse;o.getNormalMatrix(d),(null===l||l.length<c)&&(l=new Float32Array(c));for(var h=0,f=r;h!==u;++h,f+=4)a.copy(t[h]).applyMatrix4(d,o),a.normal.toArray(l,f),l[f+3]=a.constant}s.value=l,s.needsUpdate=!0}return e.numPlanes=u,e.numIntersection=0,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,a){var o=0!==e.length||i||0!==n||r;return r=i,t=l(e,a,0),n=e.length,o},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,u()},this.setState=function(e,a,o,c,d,h){if(!r||null===e||0===e.length||i&&!o)i?l(null):u();else{var f=i?0:n,p=4*f,m=d.clippingState||null;s.value=m,m=l(e,c,p,h);for(var g=0;g!==p;++g)m[g]=t[g];d.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=f}}}function xp(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=r,r}}}function Mp(e,t,n){var r=new WeakMap,i=new WeakMap;function a(e){var o=e.target,s=r.get(o);for(var u in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[u]);o.removeEventListener("dispose",a),r.delete(o);var l=i.get(s);l&&(t.remove(l),i.delete(s)),n.memory.geometries--}function o(e){var n=[],r=e.index,a=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var u=0,l=s.length;u<l;u+=3){var c=s[u+0],d=s[u+1],h=s[u+2];n.push(c,d,d,h,h,c)}}else{s=a.array;o=a.version;for(u=0,l=s.length/3-1;u<l;u+=3){c=u+0,d=u+1,h=u+2;n.push(c,d,d,h,h,c)}}var f=new(Ef(n)>65535?vf:mf)(n,1);f.version=o,t.update(f,34963);var p=i.get(e);p&&t.remove(p),i.set(e,f)}return{get:function(e,t){var i=r.get(t);return i||(t.addEventListener("dispose",a),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Rf).setFromObject(e)),i=t._bufferGeometry),r.set(t,i),n.memory.geometries++,i)},update:function(e){var n=e.index,r=e.attributes;for(var i in null!==n&&t.update(n,34963),r)t.update(r[i],34962);var a=e.morphAttributes;for(var i in a)for(var o=a[i],s=0,u=o.length;s<u;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var t=i.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return i.get(e)}}}function Cp(e,t,n,r){var i,a,o,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){a=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,a,t*o),n.update(r,i)},this.renderInstances=function(r,u,l,c){if(0!==c){var d,h;if(s)d=e,h="drawElementsInstanced";else if(h="drawElementsInstancedANGLE",null===(d=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[h](i,l,a,u*o,c),n.update(l,i,c)}}}function Rp(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(r=r||1,t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Ip(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Op(e){var t={},n=new Float32Array(8);return{update:function(r,i,a,o){var s=r.morphTargetInfluences,u=void 0===s?0:s.length,l=t[i.id];if(void 0===l){l=[];for(var c=0;c<u;c++)l[c]=[c,0];t[i.id]=l}var d=a.morphTargets&&i.morphAttributes.position,h=a.morphNormals&&i.morphAttributes.normal;for(c=0;c<u;c++){0!==(p=l[c])[1]&&(d&&i.deleteAttribute("morphTarget"+c),h&&i.deleteAttribute("morphNormal"+c))}for(c=0;c<u;c++){(p=l[c])[0]=c,p[1]=s[c]}l.sort(Ip);var f=0;for(c=0;c<8;c++){var p;if(p=l[c]){var m=p[0],g=p[1];if(g){d&&i.setAttribute("morphTarget"+c,d[m]),h&&i.setAttribute("morphNormal"+c,h[m]),n[c]=g,f+=g;continue}}n[c]=0}var v=i.morphTargetsRelative?1:1-f;o.getUniforms().setValue(e,"morphTargetBaseInfluence",v),o.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function Dp(e,t,n,r){var i=new WeakMap;return{update:function(e){var a=r.render.frame,o=e.geometry,s=t.get(e,o);return i.get(s)!==a&&(o.isGeometry&&s.updateFromObject(e),t.update(s),i.set(s,a)),e.isInstancedMesh&&n.update(e.instanceMatrix,34962),s},dispose:function(){i=new WeakMap}}}function Pp(e,t,n,r,i,a,o,s,u,l){e=void 0!==e?e:[],t=void 0!==t?t:301,o=void 0!==o?o:od,Id.call(this,e,t,n,r,i,a,o,s,u,l),this.flipY=!1}function Lp(e,t,n,r){Id.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:r||1},this.magFilter=Qc,this.minFilter=Qc,this.wrapR=Kc,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Np(e,t,n,r){Id.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:r||1},this.magFilter=Qc,this.minFilter=Qc,this.wrapR=Kc,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Ep.physical={uniforms:rp([Ep.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new ef(0)},clearcoatNormalScale:{value:new xd(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:bp.meshphysical_vert,fragmentShader:bp.meshphysical_frag},Pp.prototype=Object.create(Id.prototype),Pp.prototype.constructor=Pp,Pp.prototype.isCubeTexture=!0,Object.defineProperty(Pp.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),Lp.prototype=Object.create(Id.prototype),Lp.prototype.constructor=Lp,Lp.prototype.isDataTexture2DArray=!0,Np.prototype=Object.create(Id.prototype),Np.prototype.constructor=Np,Np.prototype.isDataTexture3D=!0;var kp=new Id,Fp=new Lp,Bp=new Np,Up=new Pp,jp=[],Gp=[],Hp=new Float32Array(16),Vp=new Float32Array(9),zp=new Float32Array(4);function Wp(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,a=jp[i];if(void 0===a&&(a=new Float32Array(i),jp[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function qp(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Yp(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Kp(e,t){var n=Gp[t];void 0===n&&(n=new Int32Array(t),Gp[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Xp(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Qp(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(qp(n,t))return;e.uniform2fv(this.addr,t),Yp(n,t)}}function Zp(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(qp(n,t))return;e.uniform3fv(this.addr,t),Yp(n,t)}}function Jp(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(qp(n,t))return;e.uniform4fv(this.addr,t),Yp(n,t)}}function $p(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(qp(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Yp(n,t)}else{if(qp(n,r))return;zp.set(r),e.uniformMatrix2fv(this.addr,!1,zp),Yp(n,r)}}function em(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(qp(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Yp(n,t)}else{if(qp(n,r))return;Vp.set(r),e.uniformMatrix3fv(this.addr,!1,Vp),Yp(n,r)}}function tm(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(qp(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Yp(n,t)}else{if(qp(n,r))return;Hp.set(r),e.uniformMatrix4fv(this.addr,!1,Hp),Yp(n,r)}}function nm(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||kp,i)}function rm(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Fp,i)}function im(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Bp,i)}function am(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||Up,i)}function om(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function sm(e,t){var n=this.cache;qp(n,t)||(e.uniform2iv(this.addr,t),Yp(n,t))}function um(e,t){var n=this.cache;qp(n,t)||(e.uniform3iv(this.addr,t),Yp(n,t))}function lm(e,t){var n=this.cache;qp(n,t)||(e.uniform4iv(this.addr,t),Yp(n,t))}function cm(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function dm(e,t){e.uniform1fv(this.addr,t)}function hm(e,t){e.uniform1iv(this.addr,t)}function fm(e,t){e.uniform2iv(this.addr,t)}function pm(e,t){e.uniform3iv(this.addr,t)}function mm(e,t){e.uniform4iv(this.addr,t)}function gm(e,t){var n=Wp(t,this.size,2);e.uniform2fv(this.addr,n)}function vm(e,t){var n=Wp(t,this.size,3);e.uniform3fv(this.addr,n)}function ym(e,t){var n=Wp(t,this.size,4);e.uniform4fv(this.addr,n)}function _m(e,t){var n=Wp(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function bm(e,t){var n=Wp(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Em(e,t){var n=Wp(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Tm(e,t,n){var r=t.length,i=Kp(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTexture2D(t[a]||kp,i[a])}function Sm(e,t,n){var r=t.length,i=Kp(n,r);e.uniform1iv(this.addr,i);for(var a=0;a!==r;++a)n.safeSetTextureCube(t[a]||Up,i[a])}function wm(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Xp;case 35664:return Qp;case 35665:return Zp;case 35666:return Jp;case 35674:return $p;case 35675:return em;case 35676:return tm;case 5124:case 35670:return om;case 35667:case 35671:return sm;case 35668:case 35672:return um;case 35669:case 35673:return lm;case 5125:return cm;case 35678:case 36198:case 36298:case 36306:case 35682:return nm;case 35679:case 36299:case 36307:return im;case 35680:case 36300:case 36308:case 36293:return am;case 36289:case 36303:case 36311:case 36292:return rm}}(t.type)}function Am(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return dm;case 35664:return gm;case 35665:return vm;case 35666:return ym;case 35674:return _m;case 35675:return bm;case 35676:return Em;case 5124:case 35670:return hm;case 35667:case 35671:return fm;case 35668:case 35672:return pm;case 35669:case 35673:return mm;case 35678:case 36198:case 36298:case 36306:case 35682:return Tm;case 35680:case 36300:case 36308:case 36293:return Sm}}(t.type)}function xm(e){this.id=e,this.seq=[],this.map={}}Am.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Yp(t,e)},xm.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,a=r.length;i!==a;++i){var o=r[i];o.setValue(e,t[o.id],n)}};var Mm=/([\w\d_]+)(\])?(\[|\.)?/g;function Cm(e,t){e.seq.push(t),e.map[t.id]=t}function Rm(e,t,n){var r=e.name,i=r.length;for(Mm.lastIndex=0;;){var a=Mm.exec(r),o=Mm.lastIndex,s=a[1],u="]"===a[2],l=a[3];if(u&&(s|=0),void 0===l||"["===l&&o+2===i){Cm(n,void 0===l?new wm(s,e,t):new Am(s,e,t));break}var c=n.map[s];void 0===c&&Cm(n,c=new xm(s)),n=c}}function Im(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var i=e.getActiveUniform(t,r);Rm(i,e.getUniformLocation(t,i.name),this)}}function Om(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}Im.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},Im.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},Im.upload=function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},Im.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n};var Dm=0;function Pm(e){switch(e){case gd:return["Linear","( value )"];case vd:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+e)}}function Lm(e,t,n){var r=e.getShaderParameter(t,35713),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function Nm(e,t){var n=Pm(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function km(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;case 5:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Fm(e){return""!==e}function Bm(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Um(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var jm=/^[ \t]*#include +<([\w\d./]+)>/gm;function Gm(e){return e.replace(jm,Hm)}function Hm(e,t){var n=bp[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Gm(n)}var Vm=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function zm(e){return e.replace(Vm,Wm)}function Wm(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[ i \]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function qm(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ym(e,t,n){var r,i,a,o,s,u=e.getContext(),l=n.defines,c=n.vertexShader,d=n.fragmentShader,h=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),f=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case qc:case 307:t="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:t="ENVMAP_TYPE_EQUIREC";break;case 305:t="ENVMAP_TYPE_SPHERE"}return t}(n),p=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:case 304:t="ENVMAP_MODE_REFRACTION"}return t}(n),m=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),g=e.gammaFactor>0?e.gammaFactor:1,v=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Fm).join("\n")}(n),y=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(l),_=u.createProgram();if(n.isRawShaderMaterial?((r=[y].filter(Fm).join("\n")).length>0&&(r+="\n"),(i=[v,y].filter(Fm).join("\n")).length>0&&(i+="\n")):(r=[qm(n),"#define SHADER_NAME "+n.shaderName,y,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Fm).join("\n"),i=[v,qm(n),"#define SHADER_NAME "+n.shaderName,y,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.envMap?"#define "+p:"",n.envMap?"#define "+m:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?bp.tonemapping_pars_fragment:"",0!==n.toneMapping?km("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?bp.encodings_pars_fragment:"",n.mapEncoding?Nm("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?Nm("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?Nm("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?Nm("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?Nm("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?(a="linearToOutputTexel",o=n.outputEncoding,s=Pm(o),"vec4 "+a+"( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Fm).join("\n")),c=Um(c=Bm(c=Gm(c),n),n),d=Um(d=Bm(d=Gm(d),n),n),c=zm(c),d=zm(d),n.isWebGL2&&!n.isRawShaderMaterial){var b=!1,E=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==c.match(E)&&null!==d.match(E)&&(b=!0,c=c.replace(E,""),d=d.replace(E,"")),r=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,i=["#version 300 es\n","#define varying in",b?"":"out highp vec4 pc_fragColor;",b?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i}var T,S,w=i+d,A=Om(u,35633,r+c),x=Om(u,35632,w);if(u.attachShader(_,A),u.attachShader(_,x),void 0!==n.index0AttributeName?u.bindAttribLocation(_,0,n.index0AttributeName):!0===n.morphTargets&&u.bindAttribLocation(_,0,"position"),u.linkProgram(_),e.debug.checkShaderErrors){var M=u.getProgramInfoLog(_).trim(),C=u.getShaderInfoLog(A).trim(),R=u.getShaderInfoLog(x).trim(),I=!0,O=!0;if(!1===u.getProgramParameter(_,35714)){I=!1;var D=Lm(u,A,"vertex"),P=Lm(u,x,"fragment");console.error("THREE.WebGLProgram: shader error: ",u.getError(),"35715",u.getProgramParameter(_,35715),"gl.getProgramInfoLog",M,D,P)}else""!==M?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",M):""!==C&&""!==R||(O=!1);O&&(this.diagnostics={runnable:I,programLog:M,vertexShader:{log:C,prefix:r},fragmentShader:{log:R,prefix:i}})}return u.detachShader(_,A),u.detachShader(_,x),u.deleteShader(A),u.deleteShader(x),this.getUniforms=function(){return void 0===T&&(T=new Im(u,_)),T},this.getAttributes=function(){return void 0===S&&(S=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),i=0;i<r;i++){var a=e.getActiveAttrib(t,i).name;n[a]=e.getAttribLocation(t,a)}return n}(u,_)),S},this.destroy=function(){u.deleteProgram(_),this.program=void 0},this.name=n.shaderName,this.id=Dm++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=A,this.fragmentShader=x,this}function Km(e,t,n){var r=[],i=n.isWebGL2,a=n.logarithmicDepthBuffer,o=n.floatVertexTextures,s=n.precision,u=n.maxVertexUniforms,l=n.vertexTextures,c={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},d=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function h(e){var t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=gd,t}this.getParameters=function(r,d,f,p,m,g,v){var y=p.fog,_=r.isMeshStandardMaterial?p.environment:null,b=r.envMap||_,E=c[r.type],T=v.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(o)return 1024;var n=u,r=Math.floor((n-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}(v):0;null!==r.precision&&(s=n.getMaxPrecision(r.precision))!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",s,"instead.");var S=function(e,t){var n;if(t){var r=Ep[t];n={name:e.type,uniforms:ip.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}}else n={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return n}(r,E);r.onBeforeCompile(S,e);var w=e.getRenderTarget();return{isWebGL2:i,shaderID:E,shaderName:S.name,uniforms:S.uniforms,vertexShader:S.vertexShader,fragmentShader:S.fragmentShader,defines:r.defines,isRawShaderMaterial:r.isRawShaderMaterial,isShaderMaterial:r.isShaderMaterial,precision:s,instancing:!0===v.isInstancedMesh,supportsVertexTextures:l,outputEncoding:null!==w?h(w.texture):e.outputEncoding,map:!!r.map,mapEncoding:h(r.map),matcap:!!r.matcap,matcapEncoding:h(r.matcap),envMap:!!b,envMapMode:b&&b.mapping,envMapEncoding:h(b),envMapCubeUV:!!b&&(b.mapping===qc||307===b.mapping),lightMap:!!r.lightMap,lightMapEncoding:h(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:h(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:1===r.normalMapType,tangentSpaceNormalMap:0===r.normalMapType,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||r.displacementMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||!r.displacementMap),fog:!!y,useFog:r.fog,fogExp2:y&&y.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:a,skinning:r.skinning&&T>0,maxBones:T,useVertexTexture:o,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:d.directional.length,numPointLights:d.point.length,numSpotLights:d.spot.length,numRectAreaLights:d.rectArea.length,numHemiLights:d.hemi.length,numDirLightShadows:d.directionalShadowMap.length,numPointLightShadows:d.pointShadowMap.length,numSpotLightShadows:d.spotShadowMap.length,numClippingPlanes:m,numClipIntersection:g,dithering:r.dithering,shadowMapEnabled:e.shadowMap.enabled&&f.length>0,shadowMapType:e.shadowMap.type,toneMapping:r.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:2===r.side,flipSided:1===r.side,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawbuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:i||null!==t.get("EXT_frag_depth"),rendererExtensionDrawBuffers:i||null!==t.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:i||null!==t.get("EXT_shader_texture_lod"),onBeforeCompile:r.onBeforeCompile}},this.getProgramCacheKey=function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(void 0===t.isRawShaderMaterial){for(var i=0;i<d.length;i++)n.push(t[d[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(t,n){for(var i,a=0,o=r.length;a<o;a++){var s=r[a];if(s.cacheKey===n){++(i=s).usedTimes;break}}return void 0===i&&(i=new Ym(e,n,t),r.push(i)),i},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=r.indexOf(e);r[t]=r[r.length-1],r.pop(),e.destroy()}},this.programs=r}function Xm(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Qm(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Zm(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Jm(){var e=[],t=0,n=[],r=[],i={id:-1};function a(n,r,a,o,s,u){var l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:a,program:a.program||i,groupOrder:o,renderOrder:n.renderOrder,z:s,group:u},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=a,l.program=a.program||i,l.groupOrder=o,l.renderOrder=n.renderOrder,l.z=s,l.group=u),t++,l}return{opaque:n,transparent:r,init:function(){t=0,n.length=0,r.length=0},push:function(e,t,i,o,s,u){var l=a(e,t,i,o,s,u);(!0===i.transparent?r:n).push(l)},unshift:function(e,t,i,o,s,u){var l=a(e,t,i,o,s,u);(!0===i.transparent?r:n).unshift(l)},finish:function(){for(var n=t,r=e.length;n<r;n++){var i=e[n];if(null===i.id)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.program=null,i.group=null}},sort:function(e,t){n.length>1&&n.sort(e||Qm),r.length>1&&r.sort(t||Zm)}}}function $m(){var e=new WeakMap;function t(n){var r=n.target;r.removeEventListener("dispose",t),e.delete(r)}return{get:function(n,r){var i,a=e.get(n);return void 0===a?(i=new Jm,e.set(n,new WeakMap),e.get(n).set(r,i),n.addEventListener("dispose",t)):void 0===(i=a.get(r))&&(i=new Jm,a.set(r,i)),i},dispose:function(){e=new WeakMap}}}function eg(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Fd,color:new ef};break;case"SpotLight":n={position:new Fd,direction:new Fd,color:new ef,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Fd,color:new ef,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Fd,skyColor:new ef,groundColor:new ef};break;case"RectAreaLight":n={color:new ef,position:new Fd,halfWidth:new Fd,halfHeight:new Fd}}return e[t.id]=n,n}}}var tg=0;function ng(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function rg(){for(var e,t=new eg,n=(e={},{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new xd};break;case"PointLight":n={shadowBias:0,shadowRadius:1,shadowMapSize:new xd,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},i=0;i<9;i++)r.probe.push(new Fd);var a=new Fd,o=new Wd,s=new Wd;return{setup:function(e,i,u){for(var l=0,c=0,d=0,h=0;h<9;h++)r.probe[h].set(0,0,0);var f=0,p=0,m=0,g=0,v=0,y=0,_=0,b=0,E=u.matrixWorldInverse;e.sort(ng),h=0;for(var T=e.length;h<T;h++){var S=e[h],w=S.color,A=S.intensity,x=S.distance,M=S.shadow&&S.shadow.map?S.shadow.map.texture:null;if(S.isAmbientLight)l+=w.r*A,c+=w.g*A,d+=w.b*A;else if(S.isLightProbe)for(var C=0;C<9;C++)r.probe[C].addScaledVector(S.sh.coefficients[C],A);else if(S.isDirectionalLight){if((O=t.get(S)).color.copy(S.color).multiplyScalar(S.intensity),O.direction.setFromMatrixPosition(S.matrixWorld),a.setFromMatrixPosition(S.target.matrixWorld),O.direction.sub(a),O.direction.transformDirection(E),S.castShadow){var R=S.shadow;(I=n.get(S)).shadowBias=R.bias,I.shadowRadius=R.radius,I.shadowMapSize=R.mapSize,r.directionalShadow[f]=I,r.directionalShadowMap[f]=M,r.directionalShadowMatrix[f]=S.shadow.matrix,y++}r.directional[f]=O,f++}else if(S.isSpotLight){if((O=t.get(S)).position.setFromMatrixPosition(S.matrixWorld),O.position.applyMatrix4(E),O.color.copy(w).multiplyScalar(A),O.distance=x,O.direction.setFromMatrixPosition(S.matrixWorld),a.setFromMatrixPosition(S.target.matrixWorld),O.direction.sub(a),O.direction.transformDirection(E),O.coneCos=Math.cos(S.angle),O.penumbraCos=Math.cos(S.angle*(1-S.penumbra)),O.decay=S.decay,S.castShadow){R=S.shadow;(I=n.get(S)).shadowBias=R.bias,I.shadowRadius=R.radius,I.shadowMapSize=R.mapSize,r.spotShadow[m]=I,r.spotShadowMap[m]=M,r.spotShadowMatrix[m]=S.shadow.matrix,b++}r.spot[m]=O,m++}else if(S.isRectAreaLight){(O=t.get(S)).color.copy(w).multiplyScalar(A),O.position.setFromMatrixPosition(S.matrixWorld),O.position.applyMatrix4(E),s.identity(),o.copy(S.matrixWorld),o.premultiply(E),s.extractRotation(o),O.halfWidth.set(.5*S.width,0,0),O.halfHeight.set(0,.5*S.height,0),O.halfWidth.applyMatrix4(s),O.halfHeight.applyMatrix4(s),r.rectArea[g]=O,g++}else if(S.isPointLight){if((O=t.get(S)).position.setFromMatrixPosition(S.matrixWorld),O.position.applyMatrix4(E),O.color.copy(S.color).multiplyScalar(S.intensity),O.distance=S.distance,O.decay=S.decay,S.castShadow){var I;R=S.shadow;(I=n.get(S)).shadowBias=R.bias,I.shadowRadius=R.radius,I.shadowMapSize=R.mapSize,I.shadowCameraNear=R.camera.near,I.shadowCameraFar=R.camera.far,r.pointShadow[p]=I,r.pointShadowMap[p]=M,r.pointShadowMatrix[p]=S.shadow.matrix,_++}r.point[p]=O,p++}else if(S.isHemisphereLight){var O;(O=t.get(S)).direction.setFromMatrixPosition(S.matrixWorld),O.direction.transformDirection(E),O.direction.normalize(),O.skyColor.copy(S.color).multiplyScalar(A),O.groundColor.copy(S.groundColor).multiplyScalar(A),r.hemi[v]=O,v++}}r.ambient[0]=l,r.ambient[1]=c,r.ambient[2]=d;var D=r.hash;D.directionalLength===f&&D.pointLength===p&&D.spotLength===m&&D.rectAreaLength===g&&D.hemiLength===v&&D.numDirectionalShadows===y&&D.numPointShadows===_&&D.numSpotShadows===b||(r.directional.length=f,r.spot.length=m,r.rectArea.length=g,r.point.length=p,r.hemi.length=v,r.directionalShadow.length=y,r.directionalShadowMap.length=y,r.pointShadow.length=_,r.pointShadowMap.length=_,r.spotShadow.length=b,r.spotShadowMap.length=b,r.directionalShadowMatrix.length=y,r.pointShadowMatrix.length=_,r.spotShadowMatrix.length=b,D.directionalLength=f,D.pointLength=p,D.spotLength=m,D.rectAreaLength=g,D.hemiLength=v,D.numDirectionalShadows=y,D.numPointShadows=_,D.numSpotShadows=b,r.version=tg++)},state:r}}function ig(){var e=new rg,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(r){e.setup(t,n,r)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function ag(){var e=new WeakMap;function t(n){var r=n.target;r.removeEventListener("dispose",t),e.delete(r)}return{get:function(n,r){var i;return!1===e.has(n)?(i=new ig,e.set(n,new WeakMap),e.get(n).set(r,i),n.addEventListener("dispose",t)):!1===e.get(n).has(r)?(i=new ig,e.get(n).set(r,i)):i=e.get(n).get(r),i},dispose:function(){e=new WeakMap}}}function og(e){sf.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function sg(e){sf.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Fd,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}og.prototype=Object.create(sf.prototype),og.prototype.constructor=og,og.prototype.isMeshDepthMaterial=!0,og.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},sg.prototype=Object.create(sf.prototype),sg.prototype.constructor=sg,sg.prototype.isMeshDistanceMaterial=!0,sg.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function ug(e,t,n){var r=new pp,i=new xd,a=new xd,o=new Od,s=[],u=[],l={},c={0:1,1:0,2:2},d=new ap({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new xd},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),h=d.clone();h.defines.HORIZONAL_PASS=1;var f=new Rf;f.setAttribute("position",new cf(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var p=new Yf(f,d),m=this;function g(n,r){var i=t.update(p);d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,d,p,null),h.uniforms.shadow_pass.value=n.mapPass.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,h,p,null)}function v(e,t,n){var r=e<<0|t<<1|n<<2,i=s[r];return void 0===i&&(i=new og({depthPacking:3201,morphTargets:e,skinning:t}),s[r]=i),i}function y(e,t,n){var r=e<<0|t<<1|n<<2,i=u[r];return void 0===i&&(i=new sg({morphTargets:e,skinning:t}),u[r]=i),i}function _(t,n,r,i,a,o){var s=t.geometry,u=null,d=v,h=t.customDepthMaterial;if(!0===r.isPointLight&&(d=y,h=t.customDistanceMaterial),void 0===h){var f=!1;!0===n.morphTargets&&(!0===s.isBufferGeometry?f=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:!0===s.isGeometry&&(f=s.morphTargets&&s.morphTargets.length>0));var p=!1;!0===t.isSkinnedMesh&&(!0===n.skinning?p=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),u=d(f,p,!0===t.isInstancedMesh)}else u=h;if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var m=u.uuid,g=n.uuid,_=l[m];void 0===_&&(_={},l[m]=_);var b=_[g];void 0===b&&(b=u.clone(),_[g]=b),u=b}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=3===o?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:c[n.side],u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,!0===r.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(r.matrixWorld),u.nearDistance=i,u.farDistance=a),u}function b(n,i,a,o,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var u=t.update(n),l=n.material;if(Array.isArray(l))for(var c=u.groups,d=0,h=c.length;d<h;d++){var f=c[d],p=l[f.materialIndex];if(p&&p.visible){var m=_(n,p,o,a.near,a.far,s);e.renderBufferDirect(a,null,u,m,n,f)}}else if(l.visible){m=_(n,l,o,a.near,a.far,s);e.renderBufferDirect(a,null,u,m,n,null)}}for(var g=n.children,v=0,y=g.length;v<y;v++)b(g[v],i,a,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,s,u){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==t.length){var l=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(0),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);for(var f=0,p=t.length;f<p;f++){var v=t[f],y=v.shadow;if(void 0!==y){i.copy(y.mapSize);var _=y.getFrameExtents();if(i.multiply(_),a.copy(y.mapSize),(i.x>n||i.y>n)&&(console.warn("THREE.WebGLShadowMap:",v,"has shadow exceeding max texture size, reducing"),i.x>n&&(a.x=Math.floor(n/_.x),i.x=a.x*_.x,y.mapSize.x=a.x),i.y>n&&(a.y=Math.floor(n/_.y),i.y=a.y*_.y,y.mapSize.y=a.y)),null===y.map&&!y.isPointLightShadow&&3===this.type){var E={minFilter:$c,magFilter:$c,format:sd};y.map=new Dd(i.x,i.y,E),y.map.texture.name=v.name+".shadowMap",y.mapPass=new Dd(i.x,i.y,E),y.camera.updateProjectionMatrix()}if(null===y.map){E={minFilter:Qc,magFilter:Qc,format:sd};y.map=new Dd(i.x,i.y,E),y.map.texture.name=v.name+".shadowMap",y.camera.updateProjectionMatrix()}e.setRenderTarget(y.map),e.clear();for(var T=y.getViewportCount(),S=0;S<T;S++){var w=y.getViewport(S);o.set(a.x*w.x,a.y*w.y,a.x*w.z,a.y*w.w),h.viewport(o),y.updateMatrices(v,S),r=y.getFrustum(),b(s,u,y.camera,v,this.type)}y.isPointLightShadow||3!==this.type||g(y,u)}else console.warn("THREE.WebGLShadowMap:",v,"has no shadow.")}m.needsUpdate=!1,e.setRenderTarget(l,c,d)}}}function lg(e,t,n){var r=n.isWebGL2;var i=new function(){var t=!1,n=new Od,r=null,i=new Od(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,o,s){!0===s&&(t*=o,r*=o,a*=o),n.set(t,r,a,o),!1===i.equals(n)&&(e.clearColor(t,r,a,o),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},a=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?B(2929):U(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},o=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null;return{setTest:function(e){t||(e?B(2960):U(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&i===n&&a===o||(e.stencilFunc(t,n,o),r=t,i=n,a=o)},setOp:function(t,n,r){o===t&&s===n&&u===r||(e.stencilOp(t,n,r),o=t,s=n,u=r)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,o=null,s=null,u=null,l=null}}},s=e.getParameter(34921),u=new Uint8Array(s),l=new Uint8Array(s),c=new Uint8Array(s),d={},h=null,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=null,E=!1,T=null,S=null,w=null,A=null,x=null,M=e.getParameter(35661),C=!1,R=0,I=e.getParameter(7938);-1!==I.indexOf("WebGL")?(R=parseFloat(/^WebGL\ ([0-9])/.exec(I)[1]),C=R>=1):-1!==I.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(I)[1]),C=R>=2);var O=null,D={},P=new Od,L=new Od;function N(t,n,r){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<r;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,i);return a}var k={};function F(n,i){(u[n]=1,0===l[n]&&(e.enableVertexAttribArray(n),l[n]=1),c[n]!==i)&&((r?e:t.get("ANGLE_instanced_arrays"))[r?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,i),c[n]=i)}function B(t){!0!==d[t]&&(e.enable(t),d[t]=!0)}function U(t){!1!==d[t]&&(e.disable(t),d[t]=!1)}k[3553]=N(3553,3553,1),k[34067]=N(34067,34069,6),i.setClear(0,0,0,1),a.setClear(1),o.setClear(0),B(2929),a.setFunc(3),z(!1),W(1),B(2884),V(0);var j={[Wc]:32774,101:32778,102:32779};if(r)j[103]=32775,j[104]=32776;else{var G=t.get("EXT_blend_minmax");null!==G&&(j[103]=G.MIN_EXT,j[104]=G.MAX_EXT)}var H={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function V(t,n,r,i,a,o,s,u){if(0!==t){if(f||(B(3042),f=!0),5===t)a=a||n,o=o||r,s=s||i,n===m&&a===y||(e.blendEquationSeparate(j[n],j[a]),m=n,y=a),r===g&&i===v&&o===_&&s===b||(e.blendFuncSeparate(H[r],H[i],H[o],H[s]),g=r,v=i,_=o,b=s),p=t,E=null;else if(t!==p||u!==E){if(m===Wc&&y===Wc||(e.blendEquation(32774),m=Wc,y=Wc),u)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}g=null,v=null,_=null,b=null,p=t,E=u}}else f&&(U(3042),f=!1)}function z(t){T!==t&&(t?e.frontFace(2304):e.frontFace(2305),T=t)}function W(t){0!==t?(B(2884),t!==S&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):U(2884),S=t}function q(t,n,r){t?(B(32823),A===n&&x===r||(e.polygonOffset(n,r),A=n,x=r)):U(32823)}function Y(t){void 0===t&&(t=33984+M-1),O!==t&&(e.activeTexture(t),O=t)}return{buffers:{color:i,depth:a,stencil:o},initAttributes:function(){for(var e=0,t=u.length;e<t;e++)u[e]=0},enableAttribute:function(e){F(e,0)},enableAttributeAndDivisor:F,disableUnusedAttributes:function(){for(var t=0,n=l.length;t!==n;++t)l[t]!==u[t]&&(e.disableVertexAttribArray(t),l[t]=0)},enable:B,disable:U,useProgram:function(t){return h!==t&&(e.useProgram(t),h=t,!0)},setBlending:V,setMaterial:function(e,t){2===e.side?U(2884):B(2884);var n=1===e.side;t&&(n=!n),z(n),1===e.blending&&!1===e.transparent?V(0):V(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),i.setMask(e.colorWrite);var r=e.stencilWrite;o.setTest(r),r&&(o.setMask(e.stencilWriteMask),o.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),o.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),q(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:z,setCullFace:W,setLineWidth:function(t){t!==w&&(C&&e.lineWidth(t),w=t)},setPolygonOffset:q,setScissorTest:function(e){e?B(3089):U(3089)},activeTexture:Y,bindTexture:function(t,n){null===O&&Y();var r=D[O];void 0===r&&(r={type:void 0,texture:void 0},D[O]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||k[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=D[O];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===P.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),P.copy(t))},viewport:function(t){!1===L.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),L.copy(t))},reset:function(){for(var t=0;t<l.length;t++)1===l[t]&&(e.disableVertexAttribArray(t),l[t]=0);d={},O=null,D={},h=null,p=null,T=null,S=null,i.reset(),a.reset(),o.reset()}}}function cg(e,t,n,r,i,a,o){var s,u=i.isWebGL2,l=i.maxTextures,c=i.maxCubemapSize,d=i.maxTextureSize,h=i.maxSamples,f=new WeakMap,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function m(e,t){return p?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var a=t?Ad.floorPowerOfTwo:Math.floor,o=a(i*e.width),u=a(i*e.height);void 0===s&&(s=m(o,u));var l=n?m(o,u):s;return l.width=o,l.height=u,l.getContext("2d").drawImage(e,0,0,o,u),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+u+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function v(e){return Ad.isPowerOfTwo(e.width)&&Ad.isPowerOfTwo(e.height)}function y(e,t){return e.generateMipmaps&&t&&e.minFilter!==Qc&&e.minFilter!==$c}function _(t,n,i,a){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log(Math.max(i,a))*Math.LOG2E}function b(n,r,i){if(!1===u)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var a=r;return 6403===r&&(5126===i&&(a=33326),5131===i&&(a=33325),5121===i&&(a=33321)),6407===r&&(5126===i&&(a=34837),5131===i&&(a=34843),5121===i&&(a=32849)),6408===r&&(5126===i&&(a=34836),5131===i&&(a=34842),5121===i&&(a=32856)),33325===a||33326===a||34842===a||34836===a?t.get("EXT_color_buffer_float"):34843!==a&&34837!==a||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),a}function E(e){return e===Qc||e===Zc||e===Jc?9728:9729}function T(t){var n=t.target;n.removeEventListener("dispose",T),function(t){var n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&f.delete(n),o.memory.textures--}function S(t){var n=t.target;n.removeEventListener("dispose",S),function(t){var n=r.get(t),i=r.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var a=0;a<6;a++)e.deleteFramebuffer(n.__webglFramebuffer[a]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[a]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(t.texture),r.remove(t)}(n),o.memory.textures--}var w=0;function A(e,t){var i=r.get(e);if(e.isVideoTexture&&function(e){var t=o.render.frame;f.get(e)!==t&&(f.set(e,t),e.update())}(e),e.version>0&&i.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==a.complete)return void D(i,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,i.__webglTexture)}function x(t,i){if(6===t.image.length){var o=r.get(t);if(t.version>0&&o.__version!==t.version){O(o,t),n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture),e.pixelStorei(37440,t.flipY);for(var s=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture),l=t.image[0]&&t.image[0].isDataTexture,d=[],h=0;h<6;h++)d[h]=s||l?l?t.image[h].image:t.image[h]:g(t.image[h],!1,!0,c);var f,p=d[0],m=v(p)||u,E=a.convert(t.format),T=a.convert(t.type),S=b(t.internalFormat,E,T);if(I(34067,t,m),s){for(h=0;h<6;h++){f=d[h].mipmaps;for(var w=0;w<f.length;w++){var A=f[w];t.format!==sd&&t.format!==od?null!==E?n.compressedTexImage2D(34069+h,w,S,A.width,A.height,0,A.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+h,w,S,A.width,A.height,0,E,T,A.data)}}o.__maxMipLevel=f.length-1}else{f=t.mipmaps;for(h=0;h<6;h++)if(l){n.texImage2D(34069+h,0,S,d[h].width,d[h].height,0,E,T,d[h].data);for(w=0;w<f.length;w++){var x=(A=f[w]).image[h].image;n.texImage2D(34069+h,w+1,S,x.width,x.height,0,E,T,x.data)}}else{n.texImage2D(34069+h,0,S,E,T,d[h]);for(w=0;w<f.length;w++){A=f[w];n.texImage2D(34069+h,w+1,S,E,T,A.image[h])}}o.__maxMipLevel=f.length}y(t,m)&&_(34067,t,p.width,p.height),o.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(33984+i),n.bindTexture(34067,o.__webglTexture)}}function M(e,t){n.activeTexture(33984+t),n.bindTexture(34067,r.get(e).__webglTexture)}var C={[Yc]:10497,[Kc]:33071,[Xc]:33648},R={[Qc]:9728,[Zc]:9984,[Jc]:9986,[$c]:9729,1007:9985,[ed]:9987};function I(n,a,o){o?(e.texParameteri(n,10242,C[a.wrapS]),e.texParameteri(n,10243,C[a.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,C[a.wrapR]),e.texParameteri(n,10240,R[a.magFilter]),e.texParameteri(n,10241,R[a.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),a.wrapS===Kc&&a.wrapT===Kc||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,E(a.magFilter)),e.texParameteri(n,10241,E(a.minFilter)),a.minFilter!==Qc&&a.minFilter!==$c&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var s=t.get("EXT_texture_filter_anisotropic");if(s){if(a.type===rd&&null===t.get("OES_texture_float_linear"))return;if(a.type===id&&null===(u||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function O(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",T),t.__webglTexture=e.createTexture(),o.memory.textures++)}function D(t,r,i){var o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),O(t,r),n.activeTexture(33984+i),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment);var s=function(e){return!u&&(e.wrapS!==Kc||e.wrapT!==Kc||e.minFilter!==Qc&&e.minFilter!==$c)}(r)&&!1===v(r.image),l=g(r.image,s,!1,d),c=v(l)||u,h=a.convert(r.format),f=a.convert(r.type),p=b(r.internalFormat,h,f);I(o,r,c);var m,E=r.mipmaps;if(r.isDepthTexture){if(p=6402,r.type===rd){if(!1===u)throw new Error("Float Depth Texture only supported in WebGL2.0");p=36012}else u&&(p=33189);r.format===ud&&6402===p&&r.type!==nd&&1014!==r.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=nd,f=a.convert(r.type)),r.format===ld&&(p=34041,r.type!==ad&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=ad,f=a.convert(r.type))),n.texImage2D(3553,0,p,l.width,l.height,0,h,f,null)}else if(r.isDataTexture)if(E.length>0&&c){for(var T=0,S=E.length;T<S;T++)m=E[T],n.texImage2D(3553,T,p,m.width,m.height,0,h,f,m.data);r.generateMipmaps=!1,t.__maxMipLevel=E.length-1}else n.texImage2D(3553,0,p,l.width,l.height,0,h,f,l.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(T=0,S=E.length;T<S;T++)m=E[T],r.format!==sd&&r.format!==od?null!==h?n.compressedTexImage2D(3553,T,p,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,T,p,m.width,m.height,0,h,f,m.data);t.__maxMipLevel=E.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,p,l.width,l.height,l.depth,0,h,f,l.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,p,l.width,l.height,l.depth,0,h,f,l.data),t.__maxMipLevel=0;else if(E.length>0&&c){for(T=0,S=E.length;T<S;T++)m=E[T],n.texImage2D(3553,T,p,h,f,m);r.generateMipmaps=!1,t.__maxMipLevel=E.length-1}else n.texImage2D(3553,0,p,h,f,l),t.__maxMipLevel=0;y(r,c)&&_(o,r,l.width,l.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function P(t,i,o,s){var u=a.convert(i.texture.format),l=a.convert(i.texture.type),c=b(i.texture.internalFormat,u,l);n.texImage2D(s,0,c,i.width,i.height,0,u,l,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function L(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){if(r){var i=k(n);e.renderbufferStorageMultisample(36161,i,33189,n.width,n.height)}else e.renderbufferStorage(36161,33189,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){i=k(n);e.renderbufferStorageMultisample(36161,i,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var o=a.convert(n.texture.format),s=a.convert(n.texture.type),u=b(n.texture.internalFormat,o,s);if(r){i=k(n);e.renderbufferStorageMultisample(36161,i,u,n.width,n.height)}else e.renderbufferStorage(36161,u,n.width,n.height)}e.bindRenderbuffer(36161,null)}function N(t){var n=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),A(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===ud)e.framebufferTexture2D(36160,36096,3553,i,0);else{if(n.depthTexture.format!==ld)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var a=0;a<6;a++)e.bindFramebuffer(36160,n.__webglFramebuffer[a]),n.__webglDepthbuffer[a]=e.createRenderbuffer(),L(n.__webglDepthbuffer[a],t)}else e.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),L(n.__webglDepthbuffer,t);e.bindFramebuffer(36160,null)}function k(e){return u&&e.isWebGLMultisampleRenderTarget?Math.min(h,e.samples):0}var F=!1,B=!1;this.allocateTextureUnit=function(){var e=w;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),w+=1,e},this.resetTextureUnits=function(){w=0},this.setTexture2D=A,this.setTexture2DArray=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?D(i,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,i.__webglTexture))},this.setTexture3D=function(e,t){var i=r.get(e);e.version>0&&i.__version!==e.version?D(i,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,i.__webglTexture))},this.setTextureCube=x,this.setTextureCubeDynamic=M,this.setupRenderTarget=function(t){var i=r.get(t),s=r.get(t.texture);t.addEventListener("dispose",S),s.__webglTexture=e.createTexture(),o.memory.textures++;var l=!0===t.isWebGLCubeRenderTarget,c=!0===t.isWebGLMultisampleRenderTarget,d=v(t)||u;if(l){i.__webglFramebuffer=[];for(var h=0;h<6;h++)i.__webglFramebuffer[h]=e.createFramebuffer()}else if(i.__webglFramebuffer=e.createFramebuffer(),c)if(u){i.__webglMultisampledFramebuffer=e.createFramebuffer(),i.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,i.__webglColorRenderbuffer);var f=a.convert(t.texture.format),p=a.convert(t.texture.type),m=b(t.texture.internalFormat,f,p),g=k(t);e.renderbufferStorageMultisample(36161,g,m,t.width,t.height),e.bindFramebuffer(36160,i.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,i.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(i.__webglDepthRenderbuffer=e.createRenderbuffer(),L(i.__webglDepthRenderbuffer,t,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(l){n.bindTexture(34067,s.__webglTexture),I(34067,t.texture,d);for(h=0;h<6;h++)P(i.__webglFramebuffer[h],t,36064,34069+h);y(t.texture,d)&&_(34067,t.texture,t.width,t.height),n.bindTexture(34067,null)}else n.bindTexture(3553,s.__webglTexture),I(3553,t.texture,d),P(i.__webglFramebuffer,t,36064,3553),y(t.texture,d)&&_(3553,t.texture,t.width,t.height),n.bindTexture(3553,null);t.depthBuffer&&N(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(y(t,v(e)||u)){var i=e.isWebGLCubeRenderTarget?34067:3553,a=r.get(t).__webglTexture;n.bindTexture(i,a),_(i,t,e.width,e.height),n.bindTexture(i,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(u){var n=r.get(t);e.bindFramebuffer(36008,n.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,n.__webglFramebuffer);var i=t.width,a=t.height,o=16384;t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024),e.blitFramebuffer(0,0,i,a,0,0,i,a,o,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),F=!0),e=e.texture),A(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===B&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),B=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?x(e,t):M(e,t)}}function dg(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===td)return 5121;if(1017===e)return 32819;if(1018===e)return 32820;if(1019===e)return 33635;if(1010===e)return 5120;if(1011===e)return 5122;if(e===nd)return 5123;if(1013===e)return 5124;if(1014===e)return 5125;if(e===rd)return 5126;if(e===id)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(1021===e)return 6406;if(e===od)return 6407;if(e===sd)return 6408;if(1024===e)return 6409;if(1025===e)return 6410;if(e===ud)return 6402;if(e===ld)return 34041;if(1028===e)return 6403;if(1029===e)return 36244;if(1030===e)return 33319;if(1031===e)return 33320;if(1032===e)return 36248;if(1033===e)return 36249;if(33776===e||33777===e||33778===e||33779===e){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===e)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===e)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===e)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===e)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===e||35841===e||35842===e||35843===e){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===e)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===e||37496===e)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(37492===e)return n.COMPRESSED_RGB8_ETC2;if(37496===e)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e||37840===e||37841===e||37842===e||37843===e||37844===e||37845===e||37846===e||37847===e||37848===e||37849===e||37850===e||37851===e||37852===e||37853===e?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:e===ad?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function hg(e){sp.call(this),this.cameras=e||[]}function fg(){lh.call(this),this.type="Group"}function pg(e,t){var n=this,r=null,i=1,a=null,o="local-floor",s=null,u=[],l=new Map,c=new sp;c.layers.enable(1),c.viewport=new Od;var d=new sp;d.layers.enable(2),d.viewport=new Od;var h=new hg([c,d]);h.layers.enable(1),h.layers.enable(2);var f=null,p=null;function m(e){var t=l.get(e.inputSource);t&&(t.targetRay&&t.targetRay.dispatchEvent({type:e.type}),t.grip&&t.grip.dispatchEvent({type:e.type}))}function g(){l.forEach((function(e,t){e.targetRay&&(e.targetRay.dispatchEvent({type:"disconnected",data:t}),e.targetRay.visible=!1),e.grip&&(e.grip.dispatchEvent({type:"disconnected",data:t}),e.grip.visible=!1)})),l.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),S.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function v(e){a=e,S.setContext(r),S.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function y(e){for(var t=r.inputSources,n=0;n<u.length;n++)l.set(t[n],u[n]);for(n=0;n<e.removed.length;n++){var i=e.removed[n];(a=l.get(i))&&(a.targetRay&&a.targetRay.dispatchEvent({type:"disconnected",data:i}),a.grip&&a.grip.dispatchEvent({type:"disconnected",data:i}),l.delete(i))}for(n=0;n<e.added.length;n++){var a;i=e.added[n];(a=l.get(i))&&(a.targetRay&&a.targetRay.dispatchEvent({type:"connected",data:i}),a.grip&&a.grip.dispatchEvent({type:"connected",data:i}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=u[e];return void 0===t&&(t={},u[e]=t),void 0===t.targetRay&&(t.targetRay=new fg,t.targetRay.matrixAutoUpdate=!1,t.targetRay.visible=!1),t.targetRay},this.getControllerGrip=function(e){var t=u[e];return void 0===t&&(t={},u[e]=t),void 0===t.grip&&(t.grip=new fg,t.grip.matrixAutoUpdate=!1,t.grip.visible=!1),t.grip},this.setFramebufferScaleFactor=function(e){i=e,1==n.isPresenting&&console.warn("WebXRManager: Cannot change framebuffer scale while presenting VR content")},this.setReferenceSpaceType=function(e){o=e},this.getReferenceSpace=function(){return a},this.getSession=function(){return r},this.setSession=function(e){if(null!==(r=e)){r.addEventListener("select",m),r.addEventListener("selectstart",m),r.addEventListener("selectend",m),r.addEventListener("squeeze",m),r.addEventListener("squeezestart",m),r.addEventListener("squeezeend",m),r.addEventListener("end",g);var n=t.getContextAttributes(),a={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil,framebufferScaleFactor:i},s=new XRWebGLLayer(r,t,a);r.updateRenderState({baseLayer:s}),r.requestReferenceSpace(o).then(v),r.addEventListener("inputsourceschange",y)}};var _=new Fd,b=new Fd;function E(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){h.near=d.near=c.near=e.near,h.far=d.far=c.far=e.far,f===h.near&&p===h.far||(r.updateRenderState({depthNear:h.near,depthFar:h.far}),f=h.near,p=h.far);var t=e.parent,n=h.cameras;E(h,t);for(var i=0;i<n.length;i++)E(n[i],t);e.matrixWorld.copy(h.matrixWorld);for(var a=e.children,o=(i=0,a.length);i<o;i++)a[i].updateMatrixWorld(!0);return function(e,t,n){_.setFromMatrixPosition(t.matrixWorld),b.setFromMatrixPosition(n.matrixWorld);var r=_.distanceTo(b),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),u=(i[9]+1)/i[5],l=(i[9]-1)/i[5],c=(i[8]-1)/i[0],d=(a[8]+1)/a[0],h=o*c,f=o*d,p=r/(-c+d),m=p*-c;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var g=o+p,v=s+p,y=h-m,E=f+(r-m),T=u*s/v*g,S=l*s/v*g;e.projectionMatrix.makePerspective(y,E,T,S,g,v)}(h,c,d),h};var T=null;var S=new gp;S.setAnimationLoop((function(t,n){if(null!==(s=n.getViewerPose(a))){var i=s.views,o=r.renderState.baseLayer;e.setFramebuffer(o.framebuffer);for(var l=0;l<i.length;l++){var c=i[l],d=o.getViewport(c),f=h.cameras[l];f.matrix.fromArray(c.transform.matrix),f.projectionMatrix.fromArray(c.projectionMatrix),f.viewport.set(d.x,d.y,d.width,d.height),0===l&&h.matrix.copy(f.matrix)}}var p=r.inputSources;for(l=0;l<u.length;l++){var m=u[l],g=p[l],v=null,y=null;g&&(m.targetRay&&null!==(v=n.getPose(g.targetRaySpace,a))&&(m.targetRay.matrix.fromArray(v.transform.matrix),m.targetRay.matrix.decompose(m.targetRay.position,m.targetRay.rotation,m.targetRay.scale)),m.grip&&g.gripSpace&&null!==(y=n.getPose(g.gripSpace,a))&&(m.grip.matrix.fromArray(y.transform.matrix),m.grip.matrix.decompose(m.grip.position,m.grip.rotation,m.grip.scale))),m.targetRay&&(m.targetRay.visible=null!==v),m.grip&&(m.grip.visible=null!==y)}T&&T(t,n)})),this.setAnimationLoop=function(e){T=e},this.dispose=function(){}}function mg(e){var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default",c=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,d=null,h=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=gd,this.physicallyCorrectLights=!1,this.toneMapping=1,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var f,p,m,g,v,y,_,b,E,T,S,w,A,x,M,C,R,I,O=this,D=!1,P=null,L=0,N=0,k=null,F=null,B=-1,U={geometry:null,program:null,wireframe:!1},j=null,G=null,H=new Od,V=new Od,z=null,W=t.width,q=t.height,Y=1,K=null,X=null,Q=new Od(0,0,W,q),Z=new Od(0,0,W,q),J=!1,$=new pp,ee=new Ap,te=!1,ne=!1,re=new Wd,ie=new Fd;function ae(){return null===k?Y:1}try{var oe={alpha:r,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:l,failIfMajorPerformanceCaveat:c,xrCompatible:!0};if(t.addEventListener("webglcontextlost",ce,!1),t.addEventListener("webglcontextrestored",de,!1),null===(f=n||t.getContext("webgl",oe)||t.getContext("experimental-webgl",oe)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===f.getShaderPrecisionFormat&&(f.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function se(){p=new xp(f),!1===(m=new wp(f,p,e)).isWebGL2&&(p.get("WEBGL_depth_texture"),p.get("OES_texture_float"),p.get("OES_texture_half_float"),p.get("OES_texture_half_float_linear"),p.get("OES_standard_derivatives"),p.get("OES_element_index_uint"),p.get("ANGLE_instanced_arrays")),p.get("OES_texture_float_linear"),I=new dg(f,p,m),(g=new lg(f,p,m)).scissor(V.copy(Z).multiplyScalar(Y).floor()),g.viewport(H.copy(Q).multiplyScalar(Y).floor()),v=new Rp(f),y=new Xm,_=new cg(f,p,g,y,m,I,v),b=new vp(f,m),E=new Mp(f,b,v),T=new Dp(f,E,b,v),M=new Op(f),S=new Km(O,p,m),w=new $m,A=new ag,x=new Tp(O,g,T,s),C=new Sp(f,p,v,m),R=new Cp(f,p,v,m),v.programs=S.programs,O.capabilities=m,O.extensions=p,O.properties=y,O.renderLists=w,O.state=g,O.info=v}se();var ue=new pg(O,f);this.xr=ue;var le=new ug(O,T,m.maxTextureSize);function ce(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function de(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1,se()}function he(e){var t=e.target;t.removeEventListener("dispose",he),function(e){fe(e),y.remove(e)}(t)}function fe(e){var t=y.get(e).program;e.program=void 0,void 0!==t&&S.releaseProgram(t)}this.shadowMap=le,this.getContext=function(){return f},this.getContextAttributes=function(){return f.getContextAttributes()},this.forceContextLoss=function(){var e=p.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=p.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(e){void 0!==e&&(Y=e,this.setSize(W,q,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new xd),e.set(W,q)},this.setSize=function(e,n,r){ue.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(W=e,q=n,t.width=Math.floor(e*Y),t.height=Math.floor(n*Y),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new xd),e.set(W*Y,q*Y).floor()},this.setDrawingBufferSize=function(e,n,r){W=e,q=n,Y=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new Od),e.copy(H)},this.getViewport=function(e){return e.copy(Q)},this.setViewport=function(e,t,n,r){e.isVector4?Q.set(e.x,e.y,e.z,e.w):Q.set(e,t,n,r),g.viewport(H.copy(Q).multiplyScalar(Y).floor())},this.getScissor=function(e){return e.copy(Z)},this.setScissor=function(e,t,n,r){e.isVector4?Z.set(e.x,e.y,e.z,e.w):Z.set(e,t,n,r),g.scissor(V.copy(Z).multiplyScalar(Y).floor())},this.getScissorTest=function(){return J},this.setScissorTest=function(e){g.setScissorTest(J=e)},this.setOpaqueSort=function(e){K=e},this.setTransparentSort=function(e){X=e},this.getClearColor=function(){return x.getClearColor()},this.setClearColor=function(){x.setClearColor.apply(x,arguments)},this.getClearAlpha=function(){return x.getClearAlpha()},this.setClearAlpha=function(){x.setClearAlpha.apply(x,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),f.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ce,!1),t.removeEventListener("webglcontextrestored",de,!1),w.dispose(),A.dispose(),y.dispose(),T.dispose(),ue.dispose(),ge.stop()},this.renderBufferImmediate=function(e,t){g.initAttributes();var n=y.get(e);e.hasPositions&&!n.position&&(n.position=f.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=f.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=f.createBuffer()),e.hasColors&&!n.color&&(n.color=f.createBuffer());var r=t.getAttributes();e.hasPositions&&(f.bindBuffer(34962,n.position),f.bufferData(34962,e.positionArray,35048),g.enableAttribute(r.position),f.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(f.bindBuffer(34962,n.normal),f.bufferData(34962,e.normalArray,35048),g.enableAttribute(r.normal),f.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(f.bindBuffer(34962,n.uv),f.bufferData(34962,e.uvArray,35048),g.enableAttribute(r.uv),f.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(f.bindBuffer(34962,n.color),f.bufferData(34962,e.colorArray,35048),g.enableAttribute(r.color),f.vertexAttribPointer(r.color,3,5126,!1,0,0)),g.disableUnusedAttributes(),f.drawArrays(4,0,e.count),e.count=0};var pe=new ch;this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=pe);var o=i.isMesh&&i.matrixWorld.determinant()<0,s=Ee(e,t,r,i);g.setMaterial(r,o);var u=!1;U.geometry===n.id&&U.program===s.id&&U.wireframe===(!0===r.wireframe)||(U.geometry=n.id,U.program=s.id,U.wireframe=!0===r.wireframe,u=!0),(r.morphTargets||r.morphNormals)&&(M.update(i,n,r,s),u=!0);var l=n.index,c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;var d,h=1;!0===r.wireframe&&(l=E.getWireframeAttribute(n),h=2);var v=C;null!==l&&(d=b.get(l),(v=R).setIndex(d)),u&&(!function(e,t,n,r){if(!1===m.isWebGL2&&(e.isInstancedMesh||t.isInstancedBufferGeometry)&&null===p.get("ANGLE_instanced_arrays"))return;g.initAttributes();var i=t.attributes,a=r.getAttributes(),o=n.defaultAttributeValues;for(var s in a){var u=a[s];if(u>=0){var l=i[s];if(void 0!==l){var c=l.normalized,d=l.itemSize;if(void 0===(S=b.get(l)))continue;var h=S.buffer,v=S.type,y=S.bytesPerElement;if(l.isInterleavedBufferAttribute){var _=l.data,E=_.stride,T=l.offset;_&&_.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(u,_.meshPerAttribute),void 0===t.maxInstancedCount&&(t.maxInstancedCount=_.meshPerAttribute*_.count)):g.enableAttribute(u),f.bindBuffer(34962,h),f.vertexAttribPointer(u,d,v,c,E*y,T*y)}else l.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(u,l.meshPerAttribute),void 0===t.maxInstancedCount&&(t.maxInstancedCount=l.meshPerAttribute*l.count)):g.enableAttribute(u),f.bindBuffer(34962,h),f.vertexAttribPointer(u,d,v,c,0,0)}else if("instanceMatrix"===s){var S;if(void 0===(S=b.get(e.instanceMatrix)))continue;h=S.buffer,v=S.type;g.enableAttributeAndDivisor(u+0,1),g.enableAttributeAndDivisor(u+1,1),g.enableAttributeAndDivisor(u+2,1),g.enableAttributeAndDivisor(u+3,1),f.bindBuffer(34962,h),f.vertexAttribPointer(u+0,4,v,!1,64,0),f.vertexAttribPointer(u+1,4,v,!1,64,16),f.vertexAttribPointer(u+2,4,v,!1,64,32),f.vertexAttribPointer(u+3,4,v,!1,64,48)}else if(void 0!==o){var w=o[s];if(void 0!==w)switch(w.length){case 2:f.vertexAttrib2fv(u,w);break;case 3:f.vertexAttrib3fv(u,w);break;case 4:f.vertexAttrib4fv(u,w);break;default:f.vertexAttrib1fv(u,w)}}}}g.disableUnusedAttributes()}(i,n,r,s),null!==l&&f.bindBuffer(34963,d.buffer));var y=null!==l?l.count:c.count,_=n.drawRange.start*h,T=n.drawRange.count*h,S=null!==a?a.start*h:0,w=null!==a?a.count*h:1/0,A=Math.max(_,S),x=Math.min(y,_+T,S+w)-1,I=Math.max(0,x-A+1);if(0!==I){if(i.isMesh)!0===r.wireframe?(g.setLineWidth(r.wireframeLinewidth*ae()),v.setMode(1)):v.setMode(4);else if(i.isLine){var O=r.linewidth;void 0===O&&(O=1),g.setLineWidth(O*ae()),i.isLineSegments?v.setMode(1):i.isLineLoop?v.setMode(2):v.setMode(3)}else i.isPoints?v.setMode(0):i.isSprite&&v.setMode(4);i.isInstancedMesh?v.renderInstances(n,A,I,i.count):n.isInstancedBufferGeometry?v.renderInstances(n,A,I,n.maxInstancedCount):v.render(A,I)}},this.compile=function(e,t){(h=A.get(e,t)).init(),e.traverse((function(e){e.isLight&&(h.pushLight(e),e.castShadow&&h.pushShadow(e))})),h.setupLights(t);var n={};e.traverse((function(t){if(t.material)if(Array.isArray(t.material))for(var r=0;r<t.material.length;r++)t.material[r].uuid in n==!1&&(be(t.material[r],e,t),n[t.material[r].uuid]=!0);else t.material.uuid in n==!1&&(be(t.material,e,t),n[t.material.uuid]=!0)}))};var me=null;var ge=new gp;function ve(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)h.pushLight(e),e.castShadow&&h.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||$.intersectsSprite(e)){r&&ie.setFromMatrixPosition(e.matrixWorld).applyMatrix4(re);var i=T.update(e);(a=e.material).visible&&d.push(e,i,a,n,ie.z,null)}}else if(e.isImmediateRenderObject)r&&ie.setFromMatrixPosition(e.matrixWorld).applyMatrix4(re),d.push(e,null,e.material,n,ie.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==v.render.frame&&(e.skeleton.update(),e.skeleton.frame=v.render.frame),!e.frustumCulled||$.intersectsObject(e))){r&&ie.setFromMatrixPosition(e.matrixWorld).applyMatrix4(re);i=T.update(e);var a=e.material;if(Array.isArray(a))for(var o=i.groups,s=0,u=o.length;s<u;s++){var l=o[s],c=a[l.materialIndex];c&&c.visible&&d.push(e,i,c,n,ie.z,l)}else a.visible&&d.push(e,i,a,n,ie.z,null)}var f=e.children;for(s=0,u=f.length;s<u;s++)ve(f[s],t,n,r)}}function ye(e,t,n,r){for(var i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,u=o.geometry,l=void 0===r?o.material:r,c=o.group;if(n.isArrayCamera){G=n;for(var d=n.cameras,f=0,p=d.length;f<p;f++){var m=d[f];s.layers.test(m.layers)&&(g.viewport(H.copy(m.viewport)),h.setupLights(m),_e(s,t,m,u,l,c))}}else G=null,_e(s,t,n,u,l,c)}}function _e(e,t,n,r,i,a){if(e.onBeforeRender(O,t,n,r,i,a),h=A.get(t,G||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var o=Ee(n,t,i,e);g.setMaterial(i),U.geometry=null,U.program=null,U.wireframe=!1,function(e,t){e.render((function(e){O.renderBufferImmediate(e,t)}))}(e,o)}else O.renderBufferDirect(n,t,r,i,e,a);e.onAfterRender(O,t,n,r,i,a),h=A.get(t,G||n)}function be(e,t,n){var r=y.get(e),i=h.state.lights,a=h.state.shadowsArray,o=i.state.version,s=S.getParameters(e,i.state,a,t,ee.numPlanes,ee.numIntersection,n),u=S.getProgramCacheKey(s),l=r.program,c=!0;if(void 0===l)e.addEventListener("dispose",he);else if(l.cacheKey!==u)fe(e);else if(r.lightsStateVersion!==o)r.lightsStateVersion=o,c=!1;else{if(void 0!==s.shaderID)return;c=!1}c&&(l=S.acquireProgram(s,u),r.program=l,r.uniforms=s.uniforms,r.environment=e.isMeshStandardMaterial?t.environment:null,r.outputEncoding=O.outputEncoding,e.program=l);var d=l.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var f=0;f<O.maxMorphTargets;f++)d["morphTarget"+f]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(f=0;f<O.maxMorphNormals;f++)d["morphNormal"+f]>=0&&e.numSupportedMorphNormals++}var p=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=ee.numPlanes,r.numIntersection=ee.numIntersection,p.clippingPlanes=ee.uniform),r.fog=t.fog,r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(p.ambientLightColor.value=i.state.ambient,p.lightProbe.value=i.state.probe,p.directionalLights.value=i.state.directional,p.directionalLightShadows.value=i.state.directionalShadow,p.spotLights.value=i.state.spot,p.spotLightShadows.value=i.state.spotShadow,p.rectAreaLights.value=i.state.rectArea,p.pointLights.value=i.state.point,p.pointLightShadows.value=i.state.pointShadow,p.hemisphereLights.value=i.state.hemi,p.directionalShadowMap.value=i.state.directionalShadowMap,p.directionalShadowMatrix.value=i.state.directionalShadowMatrix,p.spotShadowMap.value=i.state.spotShadowMap,p.spotShadowMatrix.value=i.state.spotShadowMatrix,p.pointShadowMap.value=i.state.pointShadowMap,p.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=r.program.getUniforms(),g=Im.seqWithValue(m.seq,p);r.uniformsList=g}function Ee(e,t,n,r){_.resetTextureUnits();var i=t.fog,a=n.isMeshStandardMaterial?t.environment:null,o=y.get(n),s=h.state.lights;if(te&&(ne||e!==j)){var u=e===j&&n.id===B;ee.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,o,u)}n.version===o.__version?void 0===o.program||n.fog&&o.fog!==i||o.environment!==a||o.needsLights&&o.lightsStateVersion!==s.state.version?be(n,t,r):void 0===o.numClippingPlanes||o.numClippingPlanes===ee.numPlanes&&o.numIntersection===ee.numIntersection?o.outputEncoding!==O.outputEncoding&&be(n,t,r):be(n,t,r):(be(n,t,r),o.__version=n.version);var l,c,d=!1,p=!1,v=!1,b=o.program,E=b.getUniforms(),T=o.uniforms;if(g.useProgram(b.program)&&(d=!0,p=!0,v=!0),n.id!==B&&(B=n.id,p=!0),d||j!==e){if(E.setValue(f,"projectionMatrix",e.projectionMatrix),m.logarithmicDepthBuffer&&E.setValue(f,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),j!==e&&(j=e,p=!0,v=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var S=E.map.cameraPosition;void 0!==S&&S.setValue(f,ie.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&E.setValue(f,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&E.setValue(f,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){E.setOptional(f,r,"bindMatrix"),E.setOptional(f,r,"bindMatrixInverse");var w=r.skeleton;if(w){var A=w.bones;if(m.floatVertexTextures){if(void 0===w.boneTexture){var x=Math.sqrt(4*A.length);x=Ad.ceilPowerOfTwo(x),x=Math.max(x,4);var M=new Float32Array(x*x*4);M.set(w.boneMatrices);var C=new dp(M,x,x,sd,rd);w.boneMatrices=M,w.boneTexture=C,w.boneTextureSize=x}E.setValue(f,"boneTexture",w.boneTexture,_),E.setValue(f,"boneTextureSize",w.boneTextureSize)}else E.setOptional(f,w,"boneMatrices")}}return(p||o.receiveShadow!==r.receiveShadow)&&(o.receiveShadow=r.receiveShadow,E.setValue(f,"receiveShadow",r.receiveShadow)),p&&(E.setValue(f,"toneMappingExposure",O.toneMappingExposure),E.setValue(f,"toneMappingWhitePoint",O.toneMappingWhitePoint),o.needsLights&&(c=v,(l=T).ambientLightColor.needsUpdate=c,l.lightProbe.needsUpdate=c,l.directionalLights.needsUpdate=c,l.directionalLightShadows.needsUpdate=c,l.pointLights.needsUpdate=c,l.pointLightShadows.needsUpdate=c,l.spotLights.needsUpdate=c,l.spotLightShadows.needsUpdate=c,l.rectAreaLights.needsUpdate=c,l.hemisphereLights.needsUpdate=c),i&&n.fog&&function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(T,i),n.isMeshBasicMaterial?Te(T,n):n.isMeshLambertMaterial?(Te(T,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(T,n)):n.isMeshToonMaterial?(Te(T,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(T,n)):n.isMeshPhongMaterial?(Te(T,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(T,n)):n.isMeshStandardMaterial?(Te(T,n,a),n.isMeshPhysicalMaterial?function(e,t,n){Se(e,t,n),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate());e.transparency.value=t.transparency}(T,n,a):Se(T,n,a)):n.isMeshMatcapMaterial?(Te(T,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(T,n)):n.isMeshDepthMaterial?(Te(T,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(T,n)):n.isMeshDistanceMaterial?(Te(T,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(T,n)):n.isMeshNormalMaterial?(Te(T,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(T,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(T,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(T,n)):n.isPointsMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*Y,e.scale.value=.5*q,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(T,n):n.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(T,n):n.isShadowMaterial&&(T.color.value.copy(n.color),T.opacity.value=n.opacity),void 0!==T.ltc_1&&(T.ltc_1.value=mp.LTC_1),void 0!==T.ltc_2&&(T.ltc_2.value=mp.LTC_2),Im.upload(f,o.uniformsList,T,_),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Im.upload(f,o.uniformsList,T,_),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&E.setValue(f,"center",r.center),E.setValue(f,"modelViewMatrix",r.modelViewMatrix),E.setValue(f,"normalMatrix",r.normalMatrix),E.setValue(f,"modelMatrix",r.matrixWorld),b}function Te(e,t,n){e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap);var r,i,a=t.envMap||n;a&&(e.envMap.value=a,e.flipEnvMap.value=a.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=y.get(a).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap&&(r=t.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),t.aoMap?i=t.aoMap:t.lightMap&&(i=t.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uv2Transform.value.copy(i.matrix))}function Se(e,t,n){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),(t.envMap||n)&&(e.envMapIntensity.value=t.envMapIntensity)}ge.setAnimationLoop((function(e){ue.isPresenting||me&&me(e)})),"undefined"!=typeof window&&ge.setContext(window),this.setAnimationLoop=function(e){me=e,ue.setAnimationLoop(e),ge.start()},this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),t&&t.isCamera){if(!D){U.geometry=null,U.program=null,U.wireframe=!1,B=-1,j=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ue.enabled&&ue.isPresenting&&(t=ue.getCamera(t)),(h=A.get(e,t)).init(),e.onBeforeRender(O,e,t,n||k),re.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),$.setFromProjectionMatrix(re),ne=this.localClippingEnabled,te=ee.init(this.clippingPlanes,ne,t),(d=w.get(e,t)).init(),ve(e,t,0,O.sortObjects),d.finish(),!0===O.sortObjects&&d.sort(K,X),te&&ee.beginShadows();var i=h.state.shadowsArray;le.render(i,e,t),h.setupLights(t),te&&ee.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),x.render(d,e,t,r);var a=d.opaque,o=d.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;a.length&&ye(a,e,t,s),o.length&&ye(o,e,t,s)}else a.length&&ye(a,e,t),o.length&&ye(o,e,t);e.onAfterRender(O,e,t),null!==k&&(_.updateRenderTargetMipmap(k),_.updateMultisampleRenderTarget(k)),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),d=null,h=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){P!==e&&null===k&&f.bindFramebuffer(36160,e),P=e},this.getActiveCubeFace=function(){return L},this.getActiveMipmapLevel=function(){return N},this.getRenderTarget=function(){return k},this.setRenderTarget=function(e,t,n){k=e,L=t,N=n,e&&void 0===y.get(e).__webglFramebuffer&&_.setupRenderTarget(e);var r=P,i=!1;if(e){var a=y.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=a[t||0],i=!0):r=e.isWebGLMultisampleRenderTarget?y.get(e).__webglMultisampledFramebuffer:a,H.copy(e.viewport),V.copy(e.scissor),z=e.scissorTest}else H.copy(Q).multiplyScalar(Y).floor(),V.copy(Z).multiplyScalar(Y).floor(),z=J;if(F!==r&&(f.bindFramebuffer(36160,r),F=r),g.viewport(H),g.scissor(V),g.setScissorTest(z),i){var o=y.get(e.texture);f.framebufferTexture2D(36160,36064,34069+(t||0),o.__webglTexture,n||0)}},this.readRenderTargetPixels=function(e,t,n,r,i,a,o){if(e&&e.isWebGLRenderTarget){var s=y.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){var u=!1;s!==F&&(f.bindFramebuffer(36160,s),u=!0);try{var l=e.texture,c=l.format,d=l.type;if(c!==sd&&I.convert(c)!==f.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(d===td||I.convert(d)===f.getParameter(35738)||d===rd&&(m.isWebGL2||p.get("OES_texture_float")||p.get("WEBGL_color_buffer_float"))||d===id&&(m.isWebGL2?p.get("EXT_color_buffer_float"):p.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===f.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&f.readPixels(t,n,r,i,I.convert(c),I.convert(d),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{u&&f.bindFramebuffer(36160,F)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(t.image.width*r),a=Math.floor(t.image.height*r),o=I.convert(t.format);_.setTexture2D(t,0),f.copyTexImage2D(3553,n,o,e.x,e.y,i,a,0),g.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r){var i=t.image.width,a=t.image.height,o=I.convert(n.format),s=I.convert(n.type);_.setTexture2D(n,0),t.isDataTexture?f.texSubImage2D(3553,r||0,e.x,e.y,i,a,o,s,t.image.data):f.texSubImage2D(3553,r||0,e.x,e.y,o,s,t.image),g.unbindTexture()},this.initTexture=function(e){_.setTexture2D(e,0),g.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function gg(e,t){this.name="",this.color=new ef(e),this.density=void 0!==t?t:25e-5}function vg(e,t,n){this.name="",this.color=new ef(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function yg(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=_d,this.updateRange={offset:0,count:-1},this.version=0}hg.prototype=Object.assign(Object.create(sp.prototype),{constructor:hg,isArrayCamera:!0}),fg.prototype=Object.assign(Object.create(lh.prototype),{constructor:fg,isGroup:!0}),Object.assign(pg.prototype,Ed.prototype),Object.assign(gg.prototype,{isFogExp2:!0,clone:function(){return new gg(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(vg.prototype,{isFog:!0,clone:function(){return new vg(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(yg.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(yg.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});var _g,bg=new Fd;function Eg(e,t,n,r){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function Tg(e){sf.call(this),this.type="SpriteMaterial",this.color=new ef(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}Object.defineProperties(Eg.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Eg.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)bg.x=this.getX(t),bg.y=this.getY(t),bg.z=this.getZ(t),bg.applyMatrix4(e),this.setXYZ(t,bg.x,bg.y,bg.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}}),Tg.prototype=Object.create(sf.prototype),Tg.prototype.constructor=Tg,Tg.prototype.isSpriteMaterial=!0,Tg.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var Sg=new Fd,wg=new Fd,Ag=new Fd,xg=new xd,Mg=new xd,Cg=new Wd,Rg=new Fd,Ig=new Fd,Og=new Fd,Dg=new xd,Pg=new xd,Lg=new xd;function Ng(e){if(lh.call(this),this.type="Sprite",void 0===_g){_g=new Rf;var t=new yg(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);_g.setIndex([0,1,2,0,2,3]),_g.setAttribute("position",new Eg(t,3,0,!1)),_g.setAttribute("uv",new Eg(t,2,3,!1))}this.geometry=_g,this.material=void 0!==e?e:new Tg,this.center=new xd(.5,.5)}function kg(e,t,n,r,i,a){xg.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(Mg.x=a*xg.x-i*xg.y,Mg.y=i*xg.x+a*xg.y):Mg.copy(xg),e.copy(t),e.x+=Mg.x,e.y+=Mg.y,e.applyMatrix4(Cg)}Ng.prototype=Object.assign(Object.create(lh.prototype),{constructor:Ng,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),wg.setFromMatrixScale(this.matrixWorld),Cg.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ag.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&wg.multiplyScalar(-Ag.z);var n,r,i=this.material.rotation;0!==i&&(r=Math.cos(i),n=Math.sin(i));var a=this.center;kg(Rg.set(-.5,-.5,0),Ag,a,wg,n,r),kg(Ig.set(.5,-.5,0),Ag,a,wg,n,r),kg(Og.set(.5,.5,0),Ag,a,wg,n,r),Dg.set(0,0),Pg.set(1,0),Lg.set(1,1);var o=e.ray.intersectTriangle(Rg,Ig,Og,!1,Sg);if(null!==o||(kg(Ig.set(-.5,.5,0),Ag,a,wg,n,r),Pg.set(0,1),null!==(o=e.ray.intersectTriangle(Rg,Og,Ig,!1,Sg)))){var s=e.ray.origin.distanceTo(Sg);s<e.near||s>e.far||t.push({distance:s,point:Sg.clone(),uv:Qh.getUV(Sg,Rg,Ig,Og,Dg,Pg,Lg,new xd),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return lh.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}});var Fg=new Fd,Bg=new Fd;function Ug(){lh.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function jg(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Yf.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Wd,this.bindMatrixInverse=new Wd}Ug.prototype=Object.assign(Object.create(lh.prototype),{constructor:Ug,isLOD:!0,copy:function(e){lh.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var t=this.levels;if(t.length>0){for(var n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null},raycast:function(e,t){if(this.levels.length>0){Fg.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Fg);this.getObjectForDistance(n).raycast(e,t)}},update:function(e){var t=this.levels;if(t.length>1){Fg.setFromMatrixPosition(e.matrixWorld),Bg.setFromMatrixPosition(this.matrixWorld);var n=Fg.distanceTo(Bg)/e.zoom;t[0].object.visible=!0;for(var r=1,i=t.length;r<i&&n>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}},toJSON:function(e){var t=lh.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var a=n[r];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}}),jg.prototype=Object.assign(Object.create(Yf.prototype),{constructor:jg,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Od,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Yf.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Gg=new Wd,Hg=new Wd;function Vg(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Wd)}}function zg(){lh.call(this),this.type="Bone"}Object.assign(Vg.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Wd;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:Hg;Gg.multiplyMatrices(o,t[i]),Gg.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)},clone:function(){return new Vg(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}}),zg.prototype=Object.assign(Object.create(lh.prototype),{constructor:zg,isBone:!0});var Wg=new Wd,qg=new Wd,Yg=[],Kg=new Yf;function Xg(e,t,n){Yf.call(this,e,t),this.instanceMatrix=new cf(new Float32Array(16*n),16),this.count=n,this.frustumCulled=!1}function Qg(e){sf.call(this),this.type="LineBasicMaterial",this.color=new ef(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}Xg.prototype=Object.assign(Object.create(Yf.prototype),{constructor:Xg,isInstancedMesh:!0,getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,r=this.count;if(Kg.geometry=this.geometry,Kg.material=this.material,void 0!==Kg.material)for(var i=0;i<r;i++)this.getMatrixAt(i,Wg),qg.multiplyMatrices(n,Wg),Kg.matrixWorld=qg,Kg.raycast(e,Yg),Yg.length>0&&(Yg[0].instanceId=i,Yg[0].object=this,t.push(Yg[0]),Yg.length=0)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),Qg.prototype=Object.create(sf.prototype),Qg.prototype.constructor=Qg,Qg.prototype.isLineBasicMaterial=!0,Qg.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this};var Zg=new Fd,Jg=new Fd,$g=new Wd,ev=new Nh,tv=new Mh;function nv(e,t,n){1===n&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),lh.call(this),this.type="Line",this.geometry=void 0!==e?e:new Rf,this.material=void 0!==t?t:new Qg}nv.prototype=Object.assign(Object.create(lh.prototype),{constructor:nv,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)Zg.fromBufferAttribute(t,r-1),Jg.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Zg.distanceTo(Jg);e.setAttribute("lineDistance",new yf(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices;(n=e.lineDistances)[0]=0;for(r=1,i=a.length;r<i;r++)n[r]=n[r-1],n[r]+=a[r-1].distanceTo(a[r])}return this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),tv.copy(n.boundingSphere),tv.applyMatrix4(r),tv.radius+=i,!1!==e.ray.intersectsSphere(tv)){$g.getInverse(r),ev.copy(e.ray).applyMatrix4($g);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new Fd,u=new Fd,l=new Fd,c=new Fd,d=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var h=n.index,f=n.attributes.position.array;if(null!==h)for(var p=h.array,m=0,g=p.length-1;m<g;m+=d){var v=p[m],y=p[m+1];if(s.fromArray(f,3*v),u.fromArray(f,3*y),!(ev.distanceSqToSegment(s,u,c,l)>o))c.applyMatrix4(this.matrixWorld),(E=e.ray.origin.distanceTo(c))<e.near||E>e.far||t.push({distance:E,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,g=f.length/3-1;m<g;m+=d){if(s.fromArray(f,3*m),u.fromArray(f,3*m+3),!(ev.distanceSqToSegment(s,u,c,l)>o))c.applyMatrix4(this.matrixWorld),(E=e.ray.origin.distanceTo(c))<e.near||E>e.far||t.push({distance:E,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){var _=n.vertices,b=_.length;for(m=0;m<b-1;m+=d){var E;if(!(ev.distanceSqToSegment(_[m],_[m+1],c,l)>o))c.applyMatrix4(this.matrixWorld),(E=e.ray.origin.distanceTo(c))<e.near||E>e.far||t.push({distance:E,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var rv=new Fd,iv=new Fd;function av(e,t){nv.call(this,e,t),this.type="LineSegments"}function ov(e,t){nv.call(this,e,t),this.type="LineLoop"}function sv(e){sf.call(this),this.type="PointsMaterial",this.color=new ef(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}av.prototype=Object.assign(Object.create(nv.prototype),{constructor:av,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)rv.fromBufferAttribute(t,r),iv.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+rv.distanceTo(iv);e.setAttribute("lineDistance",new yf(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices;for(n=e.lineDistances,r=0,i=a.length;r<i;r+=2)rv.copy(a[r]),iv.copy(a[r+1]),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+rv.distanceTo(iv)}return this}}),ov.prototype=Object.assign(Object.create(nv.prototype),{constructor:ov,isLineLoop:!0}),sv.prototype=Object.create(sf.prototype),sv.prototype.constructor=sv,sv.prototype.isPointsMaterial=!0,sv.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var uv=new Wd,lv=new Nh,cv=new Mh,dv=new Fd;function hv(e,t){lh.call(this),this.type="Points",this.geometry=void 0!==e?e:new Rf,this.material=void 0!==t?t:new sv,this.updateMorphTargets()}function fv(e,t,n,r,i,a,o){var s=lv.distanceSqToPoint(e);if(s<n){var u=new Fd;lv.closestPointToPoint(e,u),u.applyMatrix4(r);var l=i.ray.origin.distanceTo(u);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(s),point:u,index:t,face:null,object:o})}}function pv(e,t,n,r,i,a,o,s,u){Id.call(this,e,t,n,r,i,a,o,s,u),this.format=void 0!==o?o:od,this.minFilter=void 0!==a?a:$c,this.magFilter=void 0!==i?i:$c,this.generateMipmaps=!1}function mv(e,t,n,r,i,a,o,s,u,l,c,d){Id.call(this,null,a,o,s,u,l,r,i,c,d),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function gv(e,t,n,r,i,a,o,s,u){Id.call(this,e,t,n,r,i,a,o,s,u),this.needsUpdate=!0}function vv(e,t,n,r,i,a,o,s,u,l){if((l=void 0!==l?l:ud)!==ud&&l!==ld)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===ud&&(n=nd),void 0===n&&l===ld&&(n=ad),Id.call(this,null,r,i,a,o,s,l,n,u),this.image={width:e,height:t},this.magFilter=void 0!==o?o:Qc,this.minFilter=void 0!==s?s:Qc,this.flipY=!1,this.generateMipmaps=!1}function yv(e){Rf.call(this),this.type="WireframeGeometry";var t,n,r,i,a,o,s,u,l,c,d=[],h=[0,0],f={},p=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,r=m.length;t<r;t++){var g=m[t];for(n=0;n<3;n++)s=g[p[n]],u=g[p[(n+1)%3]],h[0]=Math.min(s,u),h[1]=Math.max(s,u),void 0===f[l=h[0]+","+h[1]]&&(f[l]={index1:h[0],index2:h[1]})}for(l in f)o=f[l],c=e.vertices[o.index1],d.push(c.x,c.y,c.z),c=e.vertices[o.index2],d.push(c.x,c.y,c.z)}else if(e&&e.isBufferGeometry){var v,y,_,b,E,T,S;if(c=new Fd,null!==e.index){for(v=e.attributes.position,y=e.index,0===(_=e.groups).length&&(_=[{start:0,count:y.count,materialIndex:0}]),i=0,a=_.length;i<a;++i)for(t=E=(b=_[i]).start,r=E+b.count;t<r;t+=3)for(n=0;n<3;n++)s=y.getX(t+n),u=y.getX(t+(n+1)%3),h[0]=Math.min(s,u),h[1]=Math.max(s,u),void 0===f[l=h[0]+","+h[1]]&&(f[l]={index1:h[0],index2:h[1]});for(l in f)o=f[l],c.fromBufferAttribute(v,o.index1),d.push(c.x,c.y,c.z),c.fromBufferAttribute(v,o.index2),d.push(c.x,c.y,c.z)}else for(t=0,r=(v=e.attributes.position).count/3;t<r;t++)for(n=0;n<3;n++)T=3*t+n,c.fromBufferAttribute(v,T),d.push(c.x,c.y,c.z),S=3*t+(n+1)%3,c.fromBufferAttribute(v,S),d.push(c.x,c.y,c.z)}this.setAttribute("position",new yf(d,3))}function _v(e,t,n){ep.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new bv(e,t,n)),this.mergeVertices()}function bv(e,t,n){Rf.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var r,i,a=[],o=[],s=[],u=[],l=1e-5,c=new Fd,d=new Fd,h=new Fd,f=new Fd,p=new Fd;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=t+1;for(r=0;r<=n;r++){var g=r/n;for(i=0;i<=t;i++){var v=i/t;e(v,g,d),o.push(d.x,d.y,d.z),v-l>=0?(e(v-l,g,h),f.subVectors(d,h)):(e(v+l,g,h),f.subVectors(h,d)),g-l>=0?(e(v,g-l,h),p.subVectors(d,h)):(e(v,g+l,h),p.subVectors(h,d)),c.crossVectors(f,p).normalize(),s.push(c.x,c.y,c.z),u.push(v,g)}}for(r=0;r<n;r++)for(i=0;i<t;i++){var y=r*m+i,_=r*m+i+1,b=(r+1)*m+i+1,E=(r+1)*m+i;a.push(y,_,E),a.push(_,b,E)}this.setIndex(a),this.setAttribute("position",new yf(o,3)),this.setAttribute("normal",new yf(s,3)),this.setAttribute("uv",new yf(u,2))}function Ev(e,t,n,r){ep.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new Tv(e,t,n,r)),this.mergeVertices()}function Tv(e,t,n,r){Rf.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},n=n||1;var i=[],a=[];function o(e,t,n,r){var i,a,o=Math.pow(2,r),u=[];for(i=0;i<=o;i++){u[i]=[];var l=e.clone().lerp(n,i/o),c=t.clone().lerp(n,i/o),d=o-i;for(a=0;a<=d;a++)u[i][a]=0===a&&i===o?l:l.clone().lerp(c,a/d)}for(i=0;i<o;i++)for(a=0;a<2*(o-i)-1;a++){var h=Math.floor(a/2);a%2==0?(s(u[i][h+1]),s(u[i+1][h]),s(u[i][h])):(s(u[i][h+1]),s(u[i+1][h+1]),s(u[i+1][h]))}}function s(e){i.push(e.x,e.y,e.z)}function u(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function l(e,t,n,r){r<0&&1===e.x&&(a[t]=e.x-1),0===n.x&&0===n.z&&(a[t]=r/2/Math.PI+.5)}function c(e){return Math.atan2(e.z,-e.x)}!function(e){for(var n=new Fd,r=new Fd,i=new Fd,a=0;a<t.length;a+=3)u(t[a+0],n),u(t[a+1],r),u(t[a+2],i),o(n,r,i,e)}(r=r||0),function(e){for(var t=new Fd,n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){for(var e=new Fd,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var n=c(e)/2/Math.PI+.5,r=(o=e,Math.atan2(-o.y,Math.sqrt(o.x*o.x+o.z*o.z))/Math.PI+.5);a.push(n,1-r)}var o;(function(){for(var e=new Fd,t=new Fd,n=new Fd,r=new Fd,o=new xd,s=new xd,u=new xd,d=0,h=0;d<i.length;d+=9,h+=6){e.set(i[d+0],i[d+1],i[d+2]),t.set(i[d+3],i[d+4],i[d+5]),n.set(i[d+6],i[d+7],i[d+8]),o.set(a[h+0],a[h+1]),s.set(a[h+2],a[h+3]),u.set(a[h+4],a[h+5]),r.copy(e).add(t).add(n).divideScalar(3);var f=c(r);l(o,h+0,e,f),l(s,h+2,t,f),l(u,h+4,n,f)}})(),function(){for(var e=0;e<a.length;e+=6){var t=a[e+0],n=a[e+2],r=a[e+4],i=Math.max(t,n,r),o=Math.min(t,n,r);i>.9&&o<.1&&(t<.2&&(a[e+0]+=1),n<.2&&(a[e+2]+=1),r<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new yf(i,3)),this.setAttribute("normal",new yf(i.slice(),3)),this.setAttribute("uv",new yf(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Sv(e,t){ep.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new wv(e,t)),this.mergeVertices()}function wv(e,t){Tv.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Av(e,t){ep.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new xv(e,t)),this.mergeVertices()}function xv(e,t){Tv.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Mv(e,t){ep.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Cv(e,t)),this.mergeVertices()}function Cv(e,t){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1];Tv.call(this,r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Rv(e,t){ep.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Iv(e,t)),this.mergeVertices()}function Iv(e,t){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r];Tv.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ov(e,t,n,r,i,a){ep.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new Dv(e,t,n,r,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function Dv(e,t,n,r,i){Rf.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},t=t||64,n=n||1,r=r||8,i=i||!1;var a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,u=new Fd,l=new Fd,c=new xd,d=new Fd,h=[],f=[],p=[],m=[];function g(i){d=e.getPointAt(i/t,d);var o=a.normals[i],c=a.binormals[i];for(s=0;s<=r;s++){var p=s/r*Math.PI*2,m=Math.sin(p),g=-Math.cos(p);l.x=g*o.x+m*c.x,l.y=g*o.y+m*c.y,l.z=g*o.z+m*c.z,l.normalize(),f.push(l.x,l.y,l.z),u.x=d.x+n*l.x,u.y=d.y+n*l.y,u.z=d.z+n*l.z,h.push(u.x,u.y,u.z)}}!function(){for(o=0;o<t;o++)g(o);g(!1===i?t:0),function(){for(o=0;o<=t;o++)for(s=0;s<=r;s++)c.x=o/t,c.y=s/r,p.push(c.x,c.y)}(),function(){for(s=1;s<=t;s++)for(o=1;o<=r;o++){var e=(r+1)*(s-1)+(o-1),n=(r+1)*s+(o-1),i=(r+1)*s+o,a=(r+1)*(s-1)+o;m.push(e,n,a),m.push(n,i,a)}}()}(),this.setIndex(m),this.setAttribute("position",new yf(h,3)),this.setAttribute("normal",new yf(f,3)),this.setAttribute("uv",new yf(p,2))}function Pv(e,t,n,r,i,a,o){ep.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Lv(e,t,n,r,i,a)),this.mergeVertices()}function Lv(e,t,n,r,i,a){Rf.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,a=a||3;var o,s,u=[],l=[],c=[],d=[],h=new Fd,f=new Fd,p=new Fd,m=new Fd,g=new Fd,v=new Fd,y=new Fd;for(o=0;o<=n;++o){var _=o/n*i*Math.PI*2;for(M(_,i,a,e,p),M(_+.01,i,a,e,m),v.subVectors(m,p),y.addVectors(m,p),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=r;++s){var b=s/r*Math.PI*2,E=-t*Math.cos(b),T=t*Math.sin(b);h.x=p.x+(E*y.x+T*g.x),h.y=p.y+(E*y.y+T*g.y),h.z=p.z+(E*y.z+T*g.z),l.push(h.x,h.y,h.z),f.subVectors(h,p).normalize(),c.push(f.x,f.y,f.z),d.push(o/n),d.push(s/r)}}for(s=1;s<=n;s++)for(o=1;o<=r;o++){var S=(r+1)*(s-1)+(o-1),w=(r+1)*s+(o-1),A=(r+1)*s+o,x=(r+1)*(s-1)+o;u.push(S,w,x),u.push(w,A,x)}function M(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,u=Math.cos(s);i.x=r*(2+u)*.5*a,i.y=r*(2+u)*o*.5,i.z=r*Math.sin(s)*.5}this.setIndex(u),this.setAttribute("position",new yf(l,3)),this.setAttribute("normal",new yf(c,3)),this.setAttribute("uv",new yf(d,2))}function Nv(e,t,n,r,i){ep.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new kv(e,t,n,r,i)),this.mergeVertices()}function kv(e,t,n,r,i){Rf.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var a,o,s=[],u=[],l=[],c=[],d=new Fd,h=new Fd,f=new Fd;for(a=0;a<=n;a++)for(o=0;o<=r;o++){var p=o/r*i,m=a/n*Math.PI*2;h.x=(e+t*Math.cos(m))*Math.cos(p),h.y=(e+t*Math.cos(m))*Math.sin(p),h.z=t*Math.sin(m),u.push(h.x,h.y,h.z),d.x=e*Math.cos(p),d.y=e*Math.sin(p),f.subVectors(h,d).normalize(),l.push(f.x,f.y,f.z),c.push(o/r),c.push(a/n)}for(a=1;a<=n;a++)for(o=1;o<=r;o++){var g=(r+1)*a+o-1,v=(r+1)*(a-1)+o-1,y=(r+1)*(a-1)+o,_=(r+1)*a+o;s.push(g,v,_),s.push(v,y,_)}this.setIndex(s),this.setAttribute("position",new yf(u,3)),this.setAttribute("normal",new yf(l,3)),this.setAttribute("uv",new yf(c,2))}hv.prototype=Object.assign(Object.create(lh.prototype),{constructor:hv,isPoints:!0,raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),cv.copy(n.boundingSphere),cv.applyMatrix4(r),cv.radius+=i,!1!==e.ray.intersectsSphere(cv)){uv.getInverse(r),lv.copy(e.ray).applyMatrix4(uv);var a=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(n.isBufferGeometry){var s=n.index,u=n.attributes.position.array;if(null!==s)for(var l=s.array,c=0,d=l.length;c<d;c++){var h=l[c];dv.fromArray(u,3*h),fv(dv,h,o,r,e,t,this)}else{c=0;for(var f=u.length/3;c<f;c++)dv.fromArray(u,3*c),fv(dv,c,o,r,e,t,this)}}else{var p=n.vertices;for(c=0,f=p.length;c<f;c++)fv(p[c],c,o,r,e,t,this)}}},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)n=o[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),pv.prototype=Object.assign(Object.create(Id.prototype),{constructor:pv,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),mv.prototype=Object.create(Id.prototype),mv.prototype.constructor=mv,mv.prototype.isCompressedTexture=!0,gv.prototype=Object.create(Id.prototype),gv.prototype.constructor=gv,gv.prototype.isCanvasTexture=!0,vv.prototype=Object.create(Id.prototype),vv.prototype.constructor=vv,vv.prototype.isDepthTexture=!0,yv.prototype=Object.create(Rf.prototype),yv.prototype.constructor=yv,_v.prototype=Object.create(ep.prototype),_v.prototype.constructor=_v,bv.prototype=Object.create(Rf.prototype),bv.prototype.constructor=bv,Ev.prototype=Object.create(ep.prototype),Ev.prototype.constructor=Ev,Tv.prototype=Object.create(Rf.prototype),Tv.prototype.constructor=Tv,Sv.prototype=Object.create(ep.prototype),Sv.prototype.constructor=Sv,wv.prototype=Object.create(Tv.prototype),wv.prototype.constructor=wv,Av.prototype=Object.create(ep.prototype),Av.prototype.constructor=Av,xv.prototype=Object.create(Tv.prototype),xv.prototype.constructor=xv,Mv.prototype=Object.create(ep.prototype),Mv.prototype.constructor=Mv,Cv.prototype=Object.create(Tv.prototype),Cv.prototype.constructor=Cv,Rv.prototype=Object.create(ep.prototype),Rv.prototype.constructor=Rv,Iv.prototype=Object.create(Tv.prototype),Iv.prototype.constructor=Iv,Ov.prototype=Object.create(ep.prototype),Ov.prototype.constructor=Ov,Dv.prototype=Object.create(Rf.prototype),Dv.prototype.constructor=Dv,Dv.prototype.toJSON=function(){var e=Rf.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},Pv.prototype=Object.create(ep.prototype),Pv.prototype.constructor=Pv,Lv.prototype=Object.create(Rf.prototype),Lv.prototype.constructor=Lv,Nv.prototype=Object.create(ep.prototype),Nv.prototype.constructor=Nv,kv.prototype=Object.create(Rf.prototype),kv.prototype.constructor=kv;var Fv=function(e,t,n){n=n||2;var r,i,a,o,s,u,l,c=t&&t.length,d=c?t[0]*n:e.length,h=Bv(e,0,d,n,!0),f=[];if(!h||h.next===h.prev)return f;if(c&&(h=function(e,t,n,r){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=Bv(e,t[i]*r,i<a-1?t[i+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(Kv(o));for(s.sort(Wv),i=0;i<s.length;i++)qv(s[i],n),n=Uv(n,n.next);return n}(e,t,h,n)),e.length>80*n){r=a=e[0],i=o=e[1];for(var p=n;p<d;p+=n)(s=e[p])<r&&(r=s),(u=e[p+1])<i&&(i=u),s>a&&(a=s),u>o&&(o=u);l=0!==(l=Math.max(a-r,o-i))?1/l:0}return jv(h,f,n,r,i,l),f};function Bv(e,t,n,r,i){var a,o;if(i===function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(a=t;a<n;a+=r)o=ny(a,e[a],e[a+1],o);else for(a=n-r;a>=t;a-=r)o=ny(a,e[a],e[a+1],o);return o&&Jv(o,o.next)&&(ry(o),o=o.next),o}function Uv(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!Jv(r,r.next)&&0!==Zv(r.prev,r,r.next))r=r.next;else{if(ry(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function jv(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=Yv(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,a,o,s,u,l=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,r=n,s=0,t=0;t<l&&(s++,r=r.nextZ);t++);for(u=l;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,l*=2}while(o>1)}(i)}(e,r,i,a);for(var s,u,l=e;e.prev!==e.next;)if(s=e.prev,u=e.next,a?Hv(e,r,i,a):Gv(e))t.push(s.i/n),t.push(e.i/n),t.push(u.i/n),ry(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?jv(e=Vv(e,t,n),t,n,r,i,a,2):2===o&&zv(e,t,n,r,i,a):jv(Uv(e),t,n,r,i,a,1);break}}}function Gv(e){var t=e.prev,n=e,r=e.next;if(Zv(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(Xv(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&Zv(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Hv(e,t,n,r){var i=e.prev,a=e,o=e.next;if(Zv(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,l=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,d=Yv(s,u,t,n,r),h=Yv(l,c,t,n,r),f=e.prevZ,p=e.nextZ;f&&f.z>=d&&p&&p.z<=h;){if(f!==e.prev&&f!==e.next&&Xv(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Zv(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&Xv(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Zv(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=d;){if(f!==e.prev&&f!==e.next&&Xv(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Zv(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&Xv(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Zv(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Vv(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!Jv(i,a)&&$v(i,r,r.next,a)&&ey(i,a)&&ey(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),ry(r),ry(r.next),r=e=a),r=r.next}while(r!==e);return r}function zv(e,t,n,r,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Qv(o,s)){var u=ty(o,s);return o=Uv(o,o.next),u=Uv(u,u.next),jv(o,t,n,r,i,a),void jv(u,t,n,r,i,a)}s=s.next}o=o.next}while(o!==e)}function Wv(e,t){return e.x-t.x}function qv(e,t){if(t=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>o){if(o=s,s===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n.prev;var u,l=n,c=n.x,d=n.y,h=1/0;r=n.next;for(;r!==l;)i>=r.x&&r.x>=c&&i!==r.x&&Xv(a<d?i:o,a,c,d,a<d?o:i,a,r.x,r.y)&&((u=Math.abs(a-r.y)/(i-r.x))<h||u===h&&r.x>n.x)&&ey(r,e)&&(n=r,h=u),r=r.next;return n}(e,t)){var n=ty(t,e);Uv(n,n.next)}}function Yv(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Kv(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Xv(e,t,n,r,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(i-o)*(r-s)>=0}function Qv(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&$v(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&ey(e,t)&&ey(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)}function Zv(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Jv(e,t){return e.x===t.x&&e.y===t.y}function $v(e,t,n,r){return!!(Jv(e,n)&&Jv(t,r)||Jv(e,r)&&Jv(n,t))||Zv(e,t,n)>0!=Zv(e,t,r)>0&&Zv(n,r,e)>0!=Zv(n,r,t)>0}function ey(e,t){return Zv(e.prev,e,e.next)<0?Zv(e,t,e.next)>=0&&Zv(e,e.prev,t)>=0:Zv(e,t,e.prev)<0||Zv(e,e.next,t)<0}function ty(e,t){var n=new iy(e.i,e.x,e.y),r=new iy(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function ny(e,t,n,r){var i=new iy(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ry(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function iy(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var ay={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return ay.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];oy(e),sy(n,e);var a=e.length;t.forEach(oy);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,sy(n,t[o]);var s=Fv(n,r);for(o=0;o<s.length;o+=3)i.push(s.slice(o,o+3));return i}};function oy(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function sy(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function uy(e,t){ep.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new ly(e,t)),this.mergeVertices()}function ly(e,t){Rf.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var n=this,r=[],i=[],a=0,o=e.length;a<o;a++){s(e[a])}function s(e){var a=[],o=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,u=void 0!==t.depth?t.depth:100,l=void 0===t.bevelEnabled||t.bevelEnabled,c=void 0!==t.bevelThickness?t.bevelThickness:6,d=void 0!==t.bevelSize?t.bevelSize:c-2,h=void 0!==t.bevelOffset?t.bevelOffset:0,f=void 0!==t.bevelSegments?t.bevelSegments:3,p=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:cy;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),u=t.amount);var g,v,y,_,b,E,T,S,w=!1;p&&(g=p.getSpacedPoints(s),w=!0,l=!1,v=p.computeFrenetFrames(s,!1),y=new Fd,_=new Fd,b=new Fd),l||(f=0,c=0,d=0,h=0);var A=e.extractPoints(o),x=A.shape,M=A.holes;if(!ay.isClockWise(x))for(x=x.reverse(),T=0,S=M.length;T<S;T++)E=M[T],ay.isClockWise(E)&&(M[T]=E.reverse());var C=ay.triangulateShape(x,M),R=x;for(T=0,S=M.length;T<S;T++)E=M[T],x=x.concat(E);function I(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var O,D,P,L,N,k,F=x.length,B=C.length;function U(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,u=n.x-e.x,l=n.y-e.y,c=o*o+s*s,d=o*l-s*u;if(Math.abs(d)>Number.EPSILON){var h=Math.sqrt(c),f=Math.sqrt(u*u+l*l),p=t.x-s/h,m=t.y+o/h,g=((n.x-l/f-p)*l-(n.y+u/f-m)*u)/(o*l-s*u),v=(r=p+o*g-e.x)*r+(i=m+s*g-e.y)*i;if(v<=2)return new xd(r,i);a=Math.sqrt(v/2)}else{var y=!1;o>Number.EPSILON?u>Number.EPSILON&&(y=!0):o<-Number.EPSILON?u<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(l)&&(y=!0),y?(r=-s,i=o,a=Math.sqrt(c)):(r=o,i=s,a=Math.sqrt(c/2))}return new xd(r/a,i/a)}for(var j=[],G=0,H=R.length,V=H-1,z=G+1;G<H;G++,V++,z++)V===H&&(V=0),z===H&&(z=0),j[G]=U(R[G],R[V],R[z]);var W,q,Y=[],K=j.concat();for(T=0,S=M.length;T<S;T++){for(E=M[T],W=[],G=0,V=(H=E.length)-1,z=G+1;G<H;G++,V++,z++)V===H&&(V=0),z===H&&(z=0),W[G]=U(E[G],E[V],E[z]);Y.push(W),K=K.concat(W)}for(O=0;O<f;O++){for(P=O/f,L=c*Math.cos(P*Math.PI/2),D=d*Math.sin(P*Math.PI/2)+h,G=0,H=R.length;G<H;G++)Q((N=I(R[G],j[G],D)).x,N.y,-L);for(T=0,S=M.length;T<S;T++)for(E=M[T],W=Y[T],G=0,H=E.length;G<H;G++)Q((N=I(E[G],W[G],D)).x,N.y,-L)}for(D=d+h,G=0;G<F;G++)N=l?I(x[G],K[G],D):x[G],w?(_.copy(v.normals[0]).multiplyScalar(N.x),y.copy(v.binormals[0]).multiplyScalar(N.y),b.copy(g[0]).add(_).add(y),Q(b.x,b.y,b.z)):Q(N.x,N.y,0);for(q=1;q<=s;q++)for(G=0;G<F;G++)N=l?I(x[G],K[G],D):x[G],w?(_.copy(v.normals[q]).multiplyScalar(N.x),y.copy(v.binormals[q]).multiplyScalar(N.y),b.copy(g[q]).add(_).add(y),Q(b.x,b.y,b.z)):Q(N.x,N.y,u/s*q);for(O=f-1;O>=0;O--){for(P=O/f,L=c*Math.cos(P*Math.PI/2),D=d*Math.sin(P*Math.PI/2)+h,G=0,H=R.length;G<H;G++)Q((N=I(R[G],j[G],D)).x,N.y,u+L);for(T=0,S=M.length;T<S;T++)for(E=M[T],W=Y[T],G=0,H=E.length;G<H;G++)N=I(E[G],W[G],D),w?Q(N.x,N.y+g[s-1].y,g[s-1].x+L):Q(N.x,N.y,u+L)}function X(e,t){var n,r;for(G=e.length;--G>=0;){n=G,(r=G-1)<0&&(r=e.length-1);var i=0,a=s+2*f;for(i=0;i<a;i++){var o=F*i,u=F*(i+1);J(t+n+o,t+r+o,t+r+u,t+n+u)}}}function Q(e,t,n){a.push(e),a.push(t),a.push(n)}function Z(e,t,i){$(e),$(t),$(i);var a=r.length/3,o=m.generateTopUV(n,r,a-3,a-2,a-1);ee(o[0]),ee(o[1]),ee(o[2])}function J(e,t,i,a){$(e),$(t),$(a),$(t),$(i),$(a);var o=r.length/3,s=m.generateSideWallUV(n,r,o-6,o-3,o-2,o-1);ee(s[0]),ee(s[1]),ee(s[3]),ee(s[1]),ee(s[2]),ee(s[3])}function $(e){r.push(a[3*e+0]),r.push(a[3*e+1]),r.push(a[3*e+2])}function ee(e){i.push(e.x),i.push(e.y)}!function(){var e=r.length/3;if(l){var t=0,i=F*t;for(G=0;G<B;G++)Z((k=C[G])[2]+i,k[1]+i,k[0]+i);for(i=F*(t=s+2*f),G=0;G<B;G++)Z((k=C[G])[0]+i,k[1]+i,k[2]+i)}else{for(G=0;G<B;G++)Z((k=C[G])[2],k[1],k[0]);for(G=0;G<B;G++)Z((k=C[G])[0]+F*s,k[1]+F*s,k[2]+F*s)}n.addGroup(e,r.length/3-e,0)}(),function(){var e=r.length/3,t=0;for(X(R,t),t+=R.length,T=0,S=M.length;T<S;T++)X(E=M[T],t),t+=E.length;n.addGroup(e,r.length/3-e,1)}()}this.setAttribute("position",new yf(r,3)),this.setAttribute("uv",new yf(i,2)),this.computeVertexNormals()}uy.prototype=Object.create(ep.prototype),uy.prototype.constructor=uy,uy.prototype.toJSON=function(){var e=ep.prototype.toJSON.call(this);return dy(this.parameters.shapes,this.parameters.options,e)},ly.prototype=Object.create(Rf.prototype),ly.prototype.constructor=ly,ly.prototype.toJSON=function(){var e=Rf.prototype.toJSON.call(this);return dy(this.parameters.shapes,this.parameters.options,e)};var cy={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],u=t[3*r+1],l=t[3*i],c=t[3*i+1];return[new xd(a,o),new xd(s,u),new xd(l,c)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],u=t[3*n+2],l=t[3*r],c=t[3*r+1],d=t[3*r+2],h=t[3*i],f=t[3*i+1],p=t[3*i+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(s-c)<.01?[new xd(o,1-u),new xd(l,1-d),new xd(h,1-p),new xd(m,1-v)]:[new xd(s,1-u),new xd(c,1-d),new xd(f,1-p),new xd(g,1-v)]}};function dy(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function hy(e,t){ep.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new fy(e,t)),this.mergeVertices()}function fy(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ep;var r=n.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),ly.call(this,r,t),this.type="TextBufferGeometry"}function py(e,t,n,r,i,a,o){ep.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new my(e,t,n,r,i,a,o)),this.mergeVertices()}function my(e,t,n,r,i,a,o){Rf.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,a=void 0!==a?a:0,o=void 0!==o?o:Math.PI;var s,u,l=Math.min(a+o,Math.PI),c=0,d=[],h=new Fd,f=new Fd,p=[],m=[],g=[],v=[];for(u=0;u<=n;u++){var y=[],_=u/n,b=0;for(0==u&&0==a?b=.5/t:u==n&&l==Math.PI&&(b=-.5/t),s=0;s<=t;s++){var E=s/t;h.x=-e*Math.cos(r+E*i)*Math.sin(a+_*o),h.y=e*Math.cos(a+_*o),h.z=e*Math.sin(r+E*i)*Math.sin(a+_*o),m.push(h.x,h.y,h.z),f.copy(h).normalize(),g.push(f.x,f.y,f.z),v.push(E+b,1-_),y.push(c++)}d.push(y)}for(u=0;u<n;u++)for(s=0;s<t;s++){var T=d[u][s+1],S=d[u][s],w=d[u+1][s],A=d[u+1][s+1];(0!==u||a>0)&&p.push(T,S,A),(u!==n-1||l<Math.PI)&&p.push(S,w,A)}this.setIndex(p),this.setAttribute("position",new yf(m,3)),this.setAttribute("normal",new yf(g,3)),this.setAttribute("uv",new yf(v,2))}function gy(e,t,n,r,i,a){ep.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new vy(e,t,n,r,i,a)),this.mergeVertices()}function vy(e,t,n,r,i,a){Rf.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},e=e||.5,t=t||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var o,s,u,l=[],c=[],d=[],h=[],f=e,p=(t-e)/(r=void 0!==r?Math.max(1,r):1),m=new Fd,g=new xd;for(s=0;s<=r;s++){for(u=0;u<=n;u++)o=i+u/n*a,m.x=f*Math.cos(o),m.y=f*Math.sin(o),c.push(m.x,m.y,m.z),d.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,h.push(g.x,g.y);f+=p}for(s=0;s<r;s++){var v=s*(n+1);for(u=0;u<n;u++){var y=o=u+v,_=o+n+1,b=o+n+2,E=o+1;l.push(y,_,E),l.push(_,b,E)}}this.setIndex(l),this.setAttribute("position",new yf(c,3)),this.setAttribute("normal",new yf(d,3)),this.setAttribute("uv",new yf(h,2))}function yy(e,t,n,r){ep.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new _y(e,t,n,r)),this.mergeVertices()}function _y(e,t,n,r){Rf.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||2*Math.PI,r=Ad.clamp(r,0,2*Math.PI);var i,a,o,s=[],u=[],l=[],c=1/t,d=new Fd,h=new xd;for(a=0;a<=t;a++){var f=n+a*c*r,p=Math.sin(f),m=Math.cos(f);for(o=0;o<=e.length-1;o++)d.x=e[o].x*p,d.y=e[o].y,d.z=e[o].x*m,u.push(d.x,d.y,d.z),h.x=a/t,h.y=o/(e.length-1),l.push(h.x,h.y)}for(a=0;a<t;a++)for(o=0;o<e.length-1;o++){var g=i=o+a*e.length,v=i+e.length,y=i+e.length+1,_=i+1;s.push(g,v,_),s.push(v,y,_)}if(this.setIndex(s),this.setAttribute("position",new yf(u,3)),this.setAttribute("uv",new yf(l,2)),this.computeVertexNormals(),r===2*Math.PI){var b=this.attributes.normal.array,E=new Fd,T=new Fd,S=new Fd;for(i=t*e.length*3,a=0,o=0;a<e.length;a++,o+=3)E.x=b[o+0],E.y=b[o+1],E.z=b[o+2],T.x=b[i+o+0],T.y=b[i+o+1],T.z=b[i+o+2],S.addVectors(E,T).normalize(),b[o+0]=b[i+o+0]=S.x,b[o+1]=b[i+o+1]=S.y,b[o+2]=b[i+o+2]=S.z}}function by(e,t){ep.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Ey(e,t)),this.mergeVertices()}function Ey(e,t){Rf.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],r=[],i=[],a=[],o=0,s=0;if(!1===Array.isArray(e))l(e);else for(var u=0;u<e.length;u++)l(e[u]),this.addGroup(o,s,u),o+=s,s=0;function l(e){var o,u,l,c=r.length/3,d=e.extractPoints(t),h=d.shape,f=d.holes;for(!1===ay.isClockWise(h)&&(h=h.reverse()),o=0,u=f.length;o<u;o++)l=f[o],!0===ay.isClockWise(l)&&(f[o]=l.reverse());var p=ay.triangulateShape(h,f);for(o=0,u=f.length;o<u;o++)l=f[o],h=h.concat(l);for(o=0,u=h.length;o<u;o++){var m=h[o];r.push(m.x,m.y,0),i.push(0,0,1),a.push(m.x,m.y)}for(o=0,u=p.length;o<u;o++){var g=p[o],v=g[0]+c,y=g[1]+c,_=g[2]+c;n.push(v,y,_),s+=3}}this.setIndex(n),this.setAttribute("position",new yf(r,3)),this.setAttribute("normal",new yf(i,3)),this.setAttribute("uv",new yf(a,2))}function Ty(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function Sy(e,t){Rf.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,r,i,a,o=[],s=Math.cos(Ad.DEG2RAD*t),u=[0,0],l={},c=["a","b","c"];e.isBufferGeometry?(a=new ep).fromBufferGeometry(e):a=e.clone(),a.mergeVertices(),a.computeFaceNormals();for(var d=a.vertices,h=a.faces,f=0,p=h.length;f<p;f++)for(var m=h[f],g=0;g<3;g++)n=m[c[g]],r=m[c[(g+1)%3]],u[0]=Math.min(n,r),u[1]=Math.max(n,r),void 0===l[i=u[0]+","+u[1]]?l[i]={index1:u[0],index2:u[1],face1:f,face2:void 0}:l[i].face2=f;for(i in l){var v=l[i];if(void 0===v.face2||h[v.face1].normal.dot(h[v.face2].normal)<=s){var y=d[v.index1];o.push(y.x,y.y,y.z),y=d[v.index2],o.push(y.x,y.y,y.z)}}this.setAttribute("position",new yf(o,3))}function wy(e,t,n,r,i,a,o,s){ep.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Ay(e,t,n,r,i,a,o,s)),this.mergeVertices()}function Ay(e,t,n,r,i,a,o,s){Rf.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};var u=this;e=void 0!==e?e:1,t=void 0!==t?t:1,n=n||1,r=Math.floor(r)||8,i=Math.floor(i)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var l=[],c=[],d=[],h=[],f=0,p=[],m=n/2,g=0;function v(n){var i,a,p,v=new xd,y=new Fd,_=0,b=!0===n?e:t,E=!0===n?1:-1;for(a=f,i=1;i<=r;i++)c.push(0,m*E,0),d.push(0,E,0),h.push(.5,.5),f++;for(p=f,i=0;i<=r;i++){var T=i/r*s+o,S=Math.cos(T),w=Math.sin(T);y.x=b*w,y.y=m*E,y.z=b*S,c.push(y.x,y.y,y.z),d.push(0,E,0),v.x=.5*S+.5,v.y=.5*w*E+.5,h.push(v.x,v.y),f++}for(i=0;i<r;i++){var A=a+i,x=p+i;!0===n?l.push(x,x+1,A):l.push(x+1,x,A),_+=3}u.addGroup(g,_,!0===n?1:2),g+=_}!function(){var a,v,y=new Fd,_=new Fd,b=0,E=(t-e)/n;for(v=0;v<=i;v++){var T=[],S=v/i,w=S*(t-e)+e;for(a=0;a<=r;a++){var A=a/r,x=A*s+o,M=Math.sin(x),C=Math.cos(x);_.x=w*M,_.y=-S*n+m,_.z=w*C,c.push(_.x,_.y,_.z),y.set(M,E,C).normalize(),d.push(y.x,y.y,y.z),h.push(A,1-S),T.push(f++)}p.push(T)}for(a=0;a<r;a++)for(v=0;v<i;v++){var R=p[v][a],I=p[v+1][a],O=p[v+1][a+1],D=p[v][a+1];l.push(R,I,D),l.push(I,O,D),b+=6}u.addGroup(g,b,0),g+=b}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(l),this.setAttribute("position",new yf(c,3)),this.setAttribute("normal",new yf(d,3)),this.setAttribute("uv",new yf(h,2))}function xy(e,t,n,r,i,a,o){wy.call(this,0,e,t,n,r,i,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function My(e,t,n,r,i,a,o){Ay.call(this,0,e,t,n,r,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function Cy(e,t,n,r){ep.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new Ry(e,t,n,r)),this.mergeVertices()}function Ry(e,t,n,r){Rf.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,a,o=[],s=[],u=[],l=[],c=new Fd,d=new xd;for(s.push(0,0,0),u.push(0,0,1),l.push(.5,.5),a=0,i=3;a<=t;a++,i+=3){var h=n+a/t*r;c.x=e*Math.cos(h),c.y=e*Math.sin(h),s.push(c.x,c.y,c.z),u.push(0,0,1),d.x=(s[i]/e+1)/2,d.y=(s[i+1]/e+1)/2,l.push(d.x,d.y)}for(i=1;i<=t;i++)o.push(i,i+1,0);this.setIndex(o),this.setAttribute("position",new yf(s,3)),this.setAttribute("normal",new yf(u,3)),this.setAttribute("uv",new yf(l,2))}hy.prototype=Object.create(ep.prototype),hy.prototype.constructor=hy,fy.prototype=Object.create(ly.prototype),fy.prototype.constructor=fy,py.prototype=Object.create(ep.prototype),py.prototype.constructor=py,my.prototype=Object.create(Rf.prototype),my.prototype.constructor=my,gy.prototype=Object.create(ep.prototype),gy.prototype.constructor=gy,vy.prototype=Object.create(Rf.prototype),vy.prototype.constructor=vy,yy.prototype=Object.create(ep.prototype),yy.prototype.constructor=yy,_y.prototype=Object.create(Rf.prototype),_y.prototype.constructor=_y,by.prototype=Object.create(ep.prototype),by.prototype.constructor=by,by.prototype.toJSON=function(){var e=ep.prototype.toJSON.call(this);return Ty(this.parameters.shapes,e)},Ey.prototype=Object.create(Rf.prototype),Ey.prototype.constructor=Ey,Ey.prototype.toJSON=function(){var e=Rf.prototype.toJSON.call(this);return Ty(this.parameters.shapes,e)},Sy.prototype=Object.create(Rf.prototype),Sy.prototype.constructor=Sy,wy.prototype=Object.create(ep.prototype),wy.prototype.constructor=wy,Ay.prototype=Object.create(Rf.prototype),Ay.prototype.constructor=Ay,xy.prototype=Object.create(wy.prototype),xy.prototype.constructor=xy,My.prototype=Object.create(Ay.prototype),My.prototype.constructor=My,Cy.prototype=Object.create(ep.prototype),Cy.prototype.constructor=Cy,Ry.prototype=Object.create(Rf.prototype),Ry.prototype.constructor=Ry;var Iy=Object.freeze({__proto__:null,WireframeGeometry:yv,ParametricGeometry:_v,ParametricBufferGeometry:bv,TetrahedronGeometry:Sv,TetrahedronBufferGeometry:wv,OctahedronGeometry:Av,OctahedronBufferGeometry:xv,IcosahedronGeometry:Mv,IcosahedronBufferGeometry:Cv,DodecahedronGeometry:Rv,DodecahedronBufferGeometry:Iv,PolyhedronGeometry:Ev,PolyhedronBufferGeometry:Tv,TubeGeometry:Ov,TubeBufferGeometry:Dv,TorusKnotGeometry:Pv,TorusKnotBufferGeometry:Lv,TorusGeometry:Nv,TorusBufferGeometry:kv,TextGeometry:hy,TextBufferGeometry:fy,SphereGeometry:py,SphereBufferGeometry:my,RingGeometry:gy,RingBufferGeometry:vy,PlaneGeometry:yp,PlaneBufferGeometry:_p,LatheGeometry:yy,LatheBufferGeometry:_y,ShapeGeometry:by,ShapeBufferGeometry:Ey,ExtrudeGeometry:uy,ExtrudeBufferGeometry:ly,EdgesGeometry:Sy,ConeGeometry:xy,ConeBufferGeometry:My,CylinderGeometry:wy,CylinderBufferGeometry:Ay,CircleGeometry:Cy,CircleBufferGeometry:Ry,BoxGeometry:class extends ep{constructor(e,t,n,r,i,a){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new tp(e,t,n,r,i,a)),this.mergeVertices()}},BoxBufferGeometry:tp});function Oy(e){sf.call(this),this.type="ShadowMaterial",this.color=new ef(0),this.transparent=!0,this.setValues(e)}function Dy(e){ap.call(this,e),this.type="RawShaderMaterial"}function Py(e){sf.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ef(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ef(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new xd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}function Ly(e){Py.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new xd(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(e)}function Ny(e){sf.call(this),this.type="MeshPhongMaterial",this.color=new ef(16777215),this.specular=new ef(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ef(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new xd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ky(e){sf.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ef(16777215),this.specular=new ef(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ef(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new xd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Fy(e){sf.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new xd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function By(e){sf.call(this),this.type="MeshLambertMaterial",this.color=new ef(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ef(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Uy(e){sf.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ef(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new xd(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function jy(e){Qg.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}Oy.prototype=Object.create(sf.prototype),Oy.prototype.constructor=Oy,Oy.prototype.isShadowMaterial=!0,Oy.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.color.copy(e.color),this},Dy.prototype=Object.create(ap.prototype),Dy.prototype.constructor=Dy,Dy.prototype.isRawShaderMaterial=!0,Py.prototype=Object.create(sf.prototype),Py.prototype.constructor=Py,Py.prototype.isMeshStandardMaterial=!0,Py.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},Ly.prototype=Object.create(Py.prototype),Ly.prototype.constructor=Ly,Ly.prototype.isMeshPhysicalMaterial=!0,Ly.prototype.copy=function(e){return Py.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearcoat=e.clearcoat,this.clearcoatRoughness=e.clearcoatRoughness,e.sheen?this.sheen=(this.sheen||new ef).copy(e.sheen):this.sheen=null,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.transparency=e.transparency,this},Ny.prototype=Object.create(sf.prototype),Ny.prototype.constructor=Ny,Ny.prototype.isMeshPhongMaterial=!0,Ny.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ky.prototype=Object.create(sf.prototype),ky.prototype.constructor=ky,ky.prototype.isMeshToonMaterial=!0,ky.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Fy.prototype=Object.create(sf.prototype),Fy.prototype.constructor=Fy,Fy.prototype.isMeshNormalMaterial=!0,Fy.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},By.prototype=Object.create(sf.prototype),By.prototype.constructor=By,By.prototype.isMeshLambertMaterial=!0,By.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Uy.prototype=Object.create(sf.prototype),Uy.prototype.constructor=Uy,Uy.prototype.isMeshMatcapMaterial=!0,Uy.prototype.copy=function(e){return sf.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},jy.prototype=Object.create(Qg.prototype),jy.prototype.constructor=jy,jy.prototype.isLineDashedMaterial=!0,jy.prototype.copy=function(e){return Qg.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Gy=Object.freeze({__proto__:null,ShadowMaterial:Oy,SpriteMaterial:Tg,RawShaderMaterial:Dy,ShaderMaterial:ap,PointsMaterial:sv,MeshPhysicalMaterial:Ly,MeshStandardMaterial:Py,MeshPhongMaterial:Ny,MeshToonMaterial:ky,MeshNormalMaterial:Fy,MeshLambertMaterial:By,MeshDepthMaterial:og,MeshDistanceMaterial:sg,MeshBasicMaterial:uf,MeshMatcapMaterial:Uy,LineDashedMaterial:jy,LineBasicMaterial:Qg,Material:sf}),Hy={arraySlice:function(e,t,n){return Hy.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,u=0;u!==t;++u)i[o++]=e[s+u];return i},flattenJSON:function(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),a=e[i++]}while(void 0!==a)}},subclip:function(e,t,n,r,i){i=i||30;var a=e.clone();a.name=t;for(var o=[],s=0;s<a.tracks.length;++s){for(var u=a.tracks[s],l=u.getValueSize(),c=[],d=[],h=0;h<u.times.length;++h){var f=u.times[h]*i;if(!(f<n||f>=r)){c.push(u.times[h]);for(var p=0;p<l;++p)d.push(u.values[h*l+p])}}0!==c.length&&(u.times=Hy.convertArray(c,u.times.constructor),u.values=Hy.convertArray(d,u.values.constructor),o.push(u))}a.tracks=o;var m=1/0;for(s=0;s<a.tracks.length;++s)m>a.tracks[s].times[0]&&(m=a.tracks[s].times[0]);for(s=0;s<a.tracks.length;++s)a.tracks[s].shift(-1*m);return a.resetDuration(),a}};function Vy(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function zy(e,t,n,r){Vy.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Wy(e,t,n,r){Vy.call(this,e,t,n,r)}function qy(e,t,n,r){Vy.call(this,e,t,n,r)}function Yy(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Hy.convertArray(t,this.TimeBufferType),this.values=Hy.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}function Ky(e,t,n){Yy.call(this,e,t,n)}function Xy(e,t,n,r){Yy.call(this,e,t,n,r)}function Qy(e,t,n,r){Yy.call(this,e,t,n,r)}function Zy(e,t,n,r){Vy.call(this,e,t,n,r)}function Jy(e,t,n,r){Yy.call(this,e,t,n,r)}function $y(e,t,n,r){Yy.call(this,e,t,n,r)}function e_(e,t,n,r){Yy.call(this,e,t,n,r)}function t_(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=Ad.generateUUID(),this.duration<0&&this.resetDuration()}function n_(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Qy;case"vector":case"vector2":case"vector3":case"vector4":return e_;case"color":return Xy;case"quaternion":return Jy;case"bool":case"boolean":return Ky;case"string":return $y}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];Hy.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(Vy.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(e>=i)break e;var s=t[1];e<s&&(n=2,i=s);for(o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===o)break;if(r=i,e>=(i=t[--n-1]))break t}a=n,n=0}for(;n<a;){var u=n+a>>>1;e<t[u]?a=u:n=u+1}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Vy.prototype,{beforeStart_:Vy.prototype.copySampleValue_,afterEnd_:Vy.prototype.copySampleValue_}),zy.prototype=Object.assign(Object.create(Vy.prototype),{constructor:zy,DefaultSettings_:{endingStart:fd,endingEnd:fd},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case pd:i=e,o=2*t-n;break;case md:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case pd:a=e,s=2*n-t;break;case md:a=1,s=n+r[1]-r[0];break;default:a=e-1,s=t}var u=.5*(n-t),l=this.valueSize;this._weightPrev=u/(t-o),this._weightNext=u/(s-n),this._offsetPrev=i*l,this._offsetNext=a*l},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=this._offsetPrev,c=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,g=-d*m+2*d*p-d*f,v=(1+d)*m+(-1.5-2*d)*p+(-.5+d)*f+1,y=(-1-h)*m+(1.5+h)*p+.5*f,_=h*m-h*p,b=0;b!==o;++b)i[b]=g*a[l+b]+v*a[u+b]+y*a[s+b]+_*a[c+b];return i}}),Wy.prototype=Object.assign(Object.create(Vy.prototype),{constructor:Wy,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,l=(n-t)/(r-t),c=1-l,d=0;d!==o;++d)i[d]=a[u+d]*c+a[s+d]*l;return i}}),qy.prototype=Object.assign(Object.create(Vy.prototype),{constructor:qy,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(Yy,{toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Hy.convertArray(e.times,Array),values:Hy.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}),Object.assign(Yy.prototype,{constructor:Yy,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:dd,InterpolantFactoryMethodDiscrete:function(e){return new qy(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Wy(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new zy(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case cd:t=this.InterpolantFactoryMethodDiscrete;break;case dd:t=this.InterpolantFactoryMethodLinear;break;case hd:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return cd;case this.InterpolantFactoryMethodLinear:return dd;case this.InterpolantFactoryMethodSmooth:return hd}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=Hy.arraySlice(n,i,a),this.values=Hy.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&Hy.isTypedArray(r)){o=0;for(var u=r.length;o!==u;++o){var l=r[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),e=!1;break}}}return e},optimize:function(){for(var e=Hy.arraySlice(this.times),t=Hy.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===hd,i=1,a=e.length-1,o=1;o<a;++o){var s=!1,u=e[o];if(u!==e[o+1]&&(1!==o||u!==u[0]))if(r)s=!0;else for(var l=o*n,c=l-n,d=l+n,h=0;h!==n;++h){var f=t[l+h];if(f!==t[c+h]||f!==t[d+h]){s=!0;break}}if(s){if(o!==i){e[i]=e[o];var p=o*n,m=i*n;for(h=0;h!==n;++h)t[m+h]=t[p+h]}++i}}if(a>0){e[i]=e[a];for(p=a*n,m=i*n,h=0;h!==n;++h)t[m+h]=t[p+h];++i}return i!==e.length?(this.times=Hy.arraySlice(e,0,i),this.values=Hy.arraySlice(t,0,i*n)):(this.times=e,this.values=t),this},clone:function(){var e=Hy.arraySlice(this.times,0),t=Hy.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}),Ky.prototype=Object.assign(Object.create(Yy.prototype),{constructor:Ky,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:cd,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Xy.prototype=Object.assign(Object.create(Yy.prototype),{constructor:Xy,ValueTypeName:"color"}),Qy.prototype=Object.assign(Object.create(Yy.prototype),{constructor:Qy,ValueTypeName:"number"}),Zy.prototype=Object.assign(Object.create(Vy.prototype),{constructor:Zy,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=(n-t)/(r-t),l=s+o;s!==l;s+=4)Ld.slerpFlat(i,0,a,s-o,a,s,u);return i}}),Jy.prototype=Object.assign(Object.create(Yy.prototype),{constructor:Jy,ValueTypeName:"quaternion",DefaultInterpolation:dd,InterpolantFactoryMethodLinear:function(e){return new Zy(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),$y.prototype=Object.assign(Object.create(Yy.prototype),{constructor:$y,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:cd,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),e_.prototype=Object.assign(Object.create(Yy.prototype),{constructor:e_,ValueTypeName:"vector"}),Object.assign(t_,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(n_(n[i]).scale(r));return new t_(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,a=n.length;i!==a;++i)t.push(Yy.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],u=[];s.push((o+i-1)%i,o,(o+1)%i),u.push(0,1,0);var l=Hy.getKeyframeOrder(s);s=Hy.sortedArray(s,1,l),u=Hy.sortedArray(u,1,l),r||0!==s[0]||(s.push(i),u.push(u[0])),a.push(new Qy(".morphTargetInfluences["+t[o].name+"]",s,u).scale(1/n))}return new t_(e,-1,a)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],u=s.name.match(i);if(u&&u.length>1){var l=r[d=u[1]];l||(r[d]=l=[]),l.push(s)}}var c=[];for(var d in r)c.push(t_.CreateFromMorphTargetSequence(d,r[d],t,n));return c},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];Hy.flattenJSON(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.length||-1,o=e.fps||30,s=e.hierarchy||[],u=0;u<s.length;u++){var l=s[u].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var c={},d=0;d<l.length;d++)if(l[d].morphTargets)for(var h=0;h<l[d].morphTargets.length;h++)c[l[d].morphTargets[h]]=-1;for(var f in c){var p=[],m=[];for(h=0;h!==l[d].morphTargets.length;++h){var g=l[d];p.push(g.time),m.push(g.morphTarget===f?1:0)}r.push(new Qy(".morphTargetInfluence["+f+"]",p,m))}a=c.length*(o||1)}else{var v=".bones["+t[u].name+"]";n(e_,v+".position",l,"pos",r),n(Jy,v+".quaternion",l,"rot",r),n(e_,v+".scale",l,"scl",r)}}return 0===r.length?null:new t_(i,a,r)}}),Object.assign(t_.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new t_(this.name,this.duration,e)}});var r_={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function i_(e,t,n){var r=this,i=!1,a=0,o=0,s=void 0,u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===i&&void 0!==r.onStart&&r.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return u.push(e,t),this},this.removeHandler=function(e){var t=u.indexOf(e);return-1!==t&&u.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=u.length;t<n;t+=2){var r=u[t],i=u[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}}var a_=new i_;function o_(e){this.manager=void 0!==e?e:a_,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(o_.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this}});var s_={};function u_(e){o_.call(this,e)}function l_(e){o_.call(this,e)}function c_(e){o_.call(this,e)}function d_(e){o_.call(this,e)}function h_(e){o_.call(this,e)}function f_(e){o_.call(this,e)}function p_(e){o_.call(this,e)}function m_(){this.type="Curve",this.arcLengthDivisions=200}function g_(e,t,n,r,i,a,o,s){m_.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function v_(e,t,n,r,i,a){g_.call(this,e,t,n,n,r,i,a),this.type="ArcCurve"}function y_(){var e=0,t=0,n=0,r=0;function i(i,a,o,s){e=i,t=o,n=-3*i+3*a-2*o-s,r=2*i-2*a+o+s}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,o,s){var u=(t-e)/a-(n-e)/(a+o)+(n-t)/o,l=(n-t)/o-(r-t)/(o+s)+(r-n)/s;i(t,n,u*=o,l*=o)},calc:function(i){var a=i*i;return e+t*i+n*a+r*(a*i)}}}u_.prototype=Object.assign(Object.create(o_.prototype),{constructor:u_,load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=r_.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;if(void 0===s_[e]){var o=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],u=!!o[2],l=o[3];l=decodeURIComponent(l),u&&(l=atob(l));try{var c,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var h=new Uint8Array(l.length),f=0;f<l.length;f++)h[f]=l.charCodeAt(f);c="blob"===d?new Blob([h.buffer],{type:s}):h.buffer;break;case"document":var p=new DOMParser;c=p.parseFromString(l,s);break;case"json":c=JSON.parse(l);break;default:c=l}setTimeout((function(){t&&t(c),i.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}),0)}}else{s_[e]=[],s_[e].push({onLoad:t,onProgress:n,onError:r});var m=new XMLHttpRequest;for(var g in m.open("GET",e,!0),m.addEventListener("load",(function(t){var n=this.response,r=s_[e];if(delete s_[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),r_.add(e,n);for(var a=0,o=r.length;a<o;a++){(s=r[a]).onLoad&&s.onLoad(n)}i.manager.itemEnd(e)}else{for(a=0,o=r.length;a<o;a++){var s;(s=r[a]).onError&&s.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}}),!1),m.addEventListener("progress",(function(t){for(var n=s_[e],r=0,i=n.length;r<i;r++){var a=n[r];a.onProgress&&a.onProgress(t)}}),!1),m.addEventListener("error",(function(t){var n=s_[e];delete s_[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),m.addEventListener("abort",(function(t){var n=s_[e];delete s_[e];for(var r=0,a=n.length;r<a;r++){var o=n[r];o.onError&&o.onError(t)}i.manager.itemError(e),i.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(e),m}s_[e].push({onLoad:t,onProgress:n,onError:r})},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),l_.prototype=Object.assign(Object.create(o_.prototype),{constructor:l_,load:function(e,t,n,r){var i=this,a=new u_(i.manager);a.setPath(i.path),a.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var r=t_.parse(e[n]);t.push(r)}return t}}),c_.prototype=Object.assign(Object.create(o_.prototype),{constructor:c_,load:function(e,t,n,r){var i=this,a=[],o=new mv;o.image=a;var s=new u_(this.manager);function u(u){s.load(e[u],(function(e){var n=i.parse(e,!0);a[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(l+=1)&&(1===n.mipmapCount&&(o.minFilter=$c),o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var l=0,c=0,d=e.length;c<d;++c)u(c);else s.load(e,(function(e){var n=i.parse(e,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){a[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)a[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),a[s].format=n.format,a[s].width=n.width,a[s].height=n.height}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=$c),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}}),d_.prototype=Object.assign(Object.create(o_.prototype),{constructor:d_,load:function(e,t,n,r){var i=this,a=new dp,o=new u_(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(e,(function(e){var n=i.parse(e);n&&(void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:Kc,a.wrapT=void 0!==n.wrapT?n.wrapT:Kc,a.magFilter=void 0!==n.magFilter?n.magFilter:$c,a.minFilter=void 0!==n.minFilter?n.minFilter:$c,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=ed),1===n.mipmapCount&&(a.minFilter=$c),a.needsUpdate=!0,t&&t(a,n))}),n,r),a}}),h_.prototype=Object.assign(Object.create(o_.prototype),{constructor:h_,load:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=r_.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1),r_.add(e,this),t&&t(this),i.manager.itemEnd(e)}function u(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",u,!1),r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",u,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}}),f_.prototype=Object.assign(Object.create(o_.prototype),{constructor:f_,load:function(e,t,n,r){var i=new Pp,a=new h_(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(n){a.load(e[n],(function(e){i.images[n]=e,6===++o&&(i.needsUpdate=!0,t&&t(i))}),void 0,r)}for(var u=0;u<e.length;++u)s(u);return i}}),p_.prototype=Object.assign(Object.create(o_.prototype),{constructor:p_,load:function(e,t,n,r){var i=new Id,a=new h_(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,(function(n){i.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);i.format=r?od:sd,i.needsUpdate=!0,void 0!==t&&t(i)}),n,r),i}}),Object.assign(m_.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,r=[],i=this.getPoint(0),a=0;for(r.push(0),n=1;n<=e;n++)a+=(t=this.getPoint(n/e)).distanceTo(i),r.push(a),i=t;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),i=0,a=r.length;n=t||e*r[a-1];for(var o,s=0,u=a-1;s<=u;)if((o=r[i=Math.floor(s+(u-s)/2)]-n)<0)s=i+1;else{if(!(o>0)){u=i;break}u=i-1}if(r[i=u]===n)return i/(a-1);var l=r[i];return(i+(n-l)/(r[i+1]-l))/(a-1)},getTangent:function(e){var t=1e-4,n=e-t,r=e+t;n<0&&(n=0),r>1&&(r=1);var i=this.getPoint(n);return this.getPoint(r).clone().sub(i).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,r,i,a=new Fd,o=[],s=[],u=[],l=new Fd,c=new Wd;for(n=0;n<=e;n++)r=n/e,o[n]=this.getTangentAt(r),o[n].normalize();s[0]=new Fd,u[0]=new Fd;var d=Number.MAX_VALUE,h=Math.abs(o[0].x),f=Math.abs(o[0].y),p=Math.abs(o[0].z);for(h<=d&&(d=h,a.set(1,0,0)),f<=d&&(d=f,a.set(0,1,0)),p<=d&&a.set(0,0,1),l.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],l),u[0].crossVectors(o[0],s[0]),n=1;n<=e;n++)s[n]=s[n-1].clone(),u[n]=u[n-1].clone(),l.crossVectors(o[n-1],o[n]),l.length()>Number.EPSILON&&(l.normalize(),i=Math.acos(Ad.clamp(o[n-1].dot(o[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(l,i))),u[n].crossVectors(o[n],s[n]);if(!0===t)for(i=Math.acos(Ad.clamp(s[0].dot(s[e]),-1,1)),i/=e,o[0].dot(l.crossVectors(s[0],s[e]))>0&&(i=-i),n=1;n<=e;n++)s[n].applyMatrix4(c.makeRotationAxis(o[n],i*n)),u[n].crossVectors(o[n],s[n]);return{tangents:o,normals:s,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),g_.prototype=Object.create(m_.prototype),g_.prototype.constructor=g_,g_.prototype.isEllipseCurve=!0,g_.prototype.getPoint=function(e,t){for(var n=t||new xd,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;i>r;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var l=Math.cos(this.aRotation),c=Math.sin(this.aRotation),d=s-this.aX,h=u-this.aY;s=d*l-h*c+this.aX,u=d*c+h*l+this.aY}return n.set(s,u)},g_.prototype.copy=function(e){return m_.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},g_.prototype.toJSON=function(){var e=m_.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},g_.prototype.fromJSON=function(e){return m_.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},v_.prototype=Object.create(g_.prototype),v_.prototype.constructor=v_,v_.prototype.isArcCurve=!0;var __=new Fd,b_=new y_,E_=new y_,T_=new y_;function S_(e,t,n,r){m_.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=r||.5}function w_(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function A_(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function x_(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function M_(e,t,n,r){m_.call(this),this.type="CubicBezierCurve",this.v0=e||new xd,this.v1=t||new xd,this.v2=n||new xd,this.v3=r||new xd}function C_(e,t,n,r){m_.call(this),this.type="CubicBezierCurve3",this.v0=e||new Fd,this.v1=t||new Fd,this.v2=n||new Fd,this.v3=r||new Fd}function R_(e,t){m_.call(this),this.type="LineCurve",this.v1=e||new xd,this.v2=t||new xd}function I_(e,t){m_.call(this),this.type="LineCurve3",this.v1=e||new Fd,this.v2=t||new Fd}function O_(e,t,n){m_.call(this),this.type="QuadraticBezierCurve",this.v0=e||new xd,this.v1=t||new xd,this.v2=n||new xd}function D_(e,t,n){m_.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Fd,this.v1=t||new Fd,this.v2=n||new Fd}function P_(e){m_.call(this),this.type="SplineCurve",this.points=e||[]}S_.prototype=Object.create(m_.prototype),S_.prototype.constructor=S_,S_.prototype.isCatmullRomCurve3=!0,S_.prototype.getPoint=function(e,t){var n,r,i,a,o=t||new Fd,s=this.points,u=s.length,l=(u-(this.closed?0:1))*e,c=Math.floor(l),d=l-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/u)+1)*u:0===d&&c===u-1&&(c=u-2,d=1),this.closed||c>0?n=s[(c-1)%u]:(__.subVectors(s[0],s[1]).add(s[0]),n=__),r=s[c%u],i=s[(c+1)%u],this.closed||c+2<u?a=s[(c+2)%u]:(__.subVectors(s[u-1],s[u-2]).add(s[u-1]),a=__),"centripetal"===this.curveType||"chordal"===this.curveType){var h="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(r),h),p=Math.pow(r.distanceToSquared(i),h),m=Math.pow(i.distanceToSquared(a),h);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),b_.initNonuniformCatmullRom(n.x,r.x,i.x,a.x,f,p,m),E_.initNonuniformCatmullRom(n.y,r.y,i.y,a.y,f,p,m),T_.initNonuniformCatmullRom(n.z,r.z,i.z,a.z,f,p,m)}else"catmullrom"===this.curveType&&(b_.initCatmullRom(n.x,r.x,i.x,a.x,this.tension),E_.initCatmullRom(n.y,r.y,i.y,a.y,this.tension),T_.initCatmullRom(n.z,r.z,i.z,a.z,this.tension));return o.set(b_.calc(d),E_.calc(d),T_.calc(d)),o},S_.prototype.copy=function(e){m_.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},S_.prototype.toJSON=function(){var e=m_.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},S_.prototype.fromJSON=function(e){m_.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Fd).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},M_.prototype=Object.create(m_.prototype),M_.prototype.constructor=M_,M_.prototype.isCubicBezierCurve=!0,M_.prototype.getPoint=function(e,t){var n=t||new xd,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(x_(e,r.x,i.x,a.x,o.x),x_(e,r.y,i.y,a.y,o.y)),n},M_.prototype.copy=function(e){return m_.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},M_.prototype.toJSON=function(){var e=m_.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},M_.prototype.fromJSON=function(e){return m_.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},C_.prototype=Object.create(m_.prototype),C_.prototype.constructor=C_,C_.prototype.isCubicBezierCurve3=!0,C_.prototype.getPoint=function(e,t){var n=t||new Fd,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(x_(e,r.x,i.x,a.x,o.x),x_(e,r.y,i.y,a.y,o.y),x_(e,r.z,i.z,a.z,o.z)),n},C_.prototype.copy=function(e){return m_.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},C_.prototype.toJSON=function(){var e=m_.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},C_.prototype.fromJSON=function(e){return m_.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},R_.prototype=Object.create(m_.prototype),R_.prototype.constructor=R_,R_.prototype.isLineCurve=!0,R_.prototype.getPoint=function(e,t){var n=t||new xd;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},R_.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},R_.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},R_.prototype.copy=function(e){return m_.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},R_.prototype.toJSON=function(){var e=m_.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},R_.prototype.fromJSON=function(e){return m_.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},I_.prototype=Object.create(m_.prototype),I_.prototype.constructor=I_,I_.prototype.isLineCurve3=!0,I_.prototype.getPoint=function(e,t){var n=t||new Fd;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},I_.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},I_.prototype.copy=function(e){return m_.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},I_.prototype.toJSON=function(){var e=m_.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},I_.prototype.fromJSON=function(e){return m_.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},O_.prototype=Object.create(m_.prototype),O_.prototype.constructor=O_,O_.prototype.isQuadraticBezierCurve=!0,O_.prototype.getPoint=function(e,t){var n=t||new xd,r=this.v0,i=this.v1,a=this.v2;return n.set(A_(e,r.x,i.x,a.x),A_(e,r.y,i.y,a.y)),n},O_.prototype.copy=function(e){return m_.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},O_.prototype.toJSON=function(){var e=m_.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},O_.prototype.fromJSON=function(e){return m_.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},D_.prototype=Object.create(m_.prototype),D_.prototype.constructor=D_,D_.prototype.isQuadraticBezierCurve3=!0,D_.prototype.getPoint=function(e,t){var n=t||new Fd,r=this.v0,i=this.v1,a=this.v2;return n.set(A_(e,r.x,i.x,a.x),A_(e,r.y,i.y,a.y),A_(e,r.z,i.z,a.z)),n},D_.prototype.copy=function(e){return m_.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},D_.prototype.toJSON=function(){var e=m_.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},D_.prototype.fromJSON=function(e){return m_.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},P_.prototype=Object.create(m_.prototype),P_.prototype.constructor=P_,P_.prototype.isSplineCurve=!0,P_.prototype.getPoint=function(e,t){var n=t||new xd,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],u=r[a],l=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return n.set(w_(o,s.x,u.x,l.x,c.x),w_(o,s.y,u.y,l.y,c.y)),n},P_.prototype.copy=function(e){m_.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},P_.prototype.toJSON=function(){var e=m_.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e},P_.prototype.fromJSON=function(e){m_.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new xd).fromArray(r))}return this};var L_=Object.freeze({__proto__:null,ArcCurve:v_,CatmullRomCurve3:S_,CubicBezierCurve:M_,CubicBezierCurve3:C_,EllipseCurve:g_,LineCurve:R_,LineCurve3:I_,QuadraticBezierCurve:O_,QuadraticBezierCurve3:D_,SplineCurve:P_});function N_(){m_.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function k_(e){N_.call(this),this.type="Path",this.currentPoint=new xd,e&&this.setFromPoints(e)}function F_(e){k_.call(this,e),this.uuid=Ad.generateUUID(),this.type="Shape",this.holes=[]}function B_(e,t){lh.call(this),this.type="Light",this.color=new ef(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function U_(e,t,n){B_.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(lh.DefaultUp),this.updateMatrix(),this.groundColor=new ef(t)}function j_(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new xd(512,512),this.map=null,this.mapPass=null,this.matrix=new Wd,this._frustum=new pp,this._frameExtents=new xd(1,1),this._viewportCount=1,this._viewports=[new Od(0,0,1,1)]}function G_(){j_.call(this,new sp(50,1,.5,500))}function H_(e,t,n,r,i,a){B_.call(this,e,t),this.type="SpotLight",this.position.copy(lh.DefaultUp),this.updateMatrix(),this.target=new lh,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new G_}function V_(){j_.call(this,new sp(90,1,.5,500)),this._frameExtents=new xd(4,2),this._viewportCount=6,this._viewports=[new Od(2,1,1,1),new Od(0,1,1,1),new Od(3,1,1,1),new Od(1,1,1,1),new Od(3,0,1,1),new Od(1,0,1,1)],this._cubeDirections=[new Fd(1,0,0),new Fd(-1,0,0),new Fd(0,0,1),new Fd(0,0,-1),new Fd(0,1,0),new Fd(0,-1,0)],this._cubeUps=[new Fd(0,1,0),new Fd(0,1,0),new Fd(0,1,0),new Fd(0,1,0),new Fd(0,0,1),new Fd(0,0,-1)]}function z_(e,t,n,r){B_.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new V_}function W_(e,t,n,r,i,a){op.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function q_(){j_.call(this,new W_(-5,5,5,-5,.5,500))}function Y_(e,t){B_.call(this,e,t),this.type="DirectionalLight",this.position.copy(lh.DefaultUp),this.updateMatrix(),this.target=new lh,this.shadow=new q_}function K_(e,t){B_.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function X_(e,t,n,r){B_.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function Q_(e){o_.call(this,e),this.textures={}}N_.prototype=Object.assign(Object.create(m_.prototype),{constructor:N_,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new R_(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,a=this.curves[r],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*e:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),u=0;u<s.length;u++){var l=s[u];t&&t.equals(l)||(n.push(l),t=l)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){m_.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=m_.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){m_.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push((new L_[r.type]).fromJSON(r))}return this}}),k_.prototype=Object.assign(Object.create(N_.prototype),{constructor:k_,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){var n=new R_(this.currentPoint.clone(),new xd(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,n,r){var i=new O_(this.currentPoint.clone(),new xd(e,t),new xd(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this},bezierCurveTo:function(e,t,n,r,i,a){var o=new M_(this.currentPoint.clone(),new xd(e,t),new xd(n,r),new xd(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this},splineThru:function(e){var t=new P_([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,i,a),this},absarc:function(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this},ellipse:function(e,t,n,r,i,a,o,s){var u=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(e+u,t+l,n,r,i,a,o,s),this},absellipse:function(e,t,n,r,i,a,o,s){var u=new g_(e,t,n,r,i,a,o,s);if(this.curves.length>0){var l=u.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(u);var c=u.getPoint(1);return this.currentPoint.copy(c),this},copy:function(e){return N_.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=N_.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return N_.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),F_.prototype=Object.assign(Object.create(k_.prototype),{constructor:F_,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){k_.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){var e=k_.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){k_.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push((new k_).fromJSON(r))}return this}}),B_.prototype=Object.assign(Object.create(lh.prototype),{constructor:B_,isLight:!0,copy:function(e){return lh.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=lh.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),U_.prototype=Object.assign(Object.create(B_.prototype),{constructor:U_,isHemisphereLight:!0,copy:function(e){return B_.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(j_.prototype,{_projScreenMatrix:new Wd,_lightPositionWorld:new Fd,_lookTarget:new Fd,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,n=this.matrix,r=this._projScreenMatrix,i=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(e.matrixWorld),t.position.copy(a),i.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(i),t.updateMatrixWorld(),r.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),G_.prototype=Object.assign(Object.create(j_.prototype),{constructor:G_,isSpotLightShadow:!0,updateMatrices:function(e){var t=this.camera,n=2*Ad.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),j_.prototype.updateMatrices.call(this,e)}}),H_.prototype=Object.assign(Object.create(B_.prototype),{constructor:H_,isSpotLight:!0,copy:function(e){return B_.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),V_.prototype=Object.assign(Object.create(j_.prototype),{constructor:V_,isPointLightShadow:!0,updateMatrices:function(e,t){void 0===t&&(t=0);var n=this.camera,r=this.matrix,i=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;i.setFromMatrixPosition(e.matrixWorld),n.position.copy(i),a.copy(n.position),a.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(a),n.updateMatrixWorld(),r.makeTranslation(-i.x,-i.y,-i.z),o.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}}),z_.prototype=Object.assign(Object.create(B_.prototype),{constructor:z_,isPointLight:!0,copy:function(e){return B_.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),W_.prototype=Object.assign(Object.create(op.prototype),{constructor:W_,isOrthographicCamera:!0,copy:function(e,t){return op.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var u=(this.right-this.left)/this.view.fullWidth/this.zoom,l=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(i+=u*this.view.offsetX)+u*this.view.width,s=(o-=l*this.view.offsetY)-l*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=lh.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),q_.prototype=Object.assign(Object.create(j_.prototype),{constructor:q_,isDirectionalLightShadow:!0,updateMatrices:function(e){j_.prototype.updateMatrices.call(this,e)}}),Y_.prototype=Object.assign(Object.create(B_.prototype),{constructor:Y_,isDirectionalLight:!0,copy:function(e){return B_.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),K_.prototype=Object.assign(Object.create(B_.prototype),{constructor:K_,isAmbientLight:!0}),X_.prototype=Object.assign(Object.create(B_.prototype),{constructor:X_,isRectAreaLight:!0,copy:function(e){return B_.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=B_.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Q_.prototype=Object.assign(Object.create(o_.prototype),{constructor:Q_,load:function(e,t,n,r){var i=this,a=new u_(i.manager);a.setPath(i.path),a.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new Gy[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=(new ef).setHex(e.sheen)),void 0!==e.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(r.morphNormals=e.morphNormals),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.vertexTangents&&(r.vertexTangents=e.vertexTangents),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var i in e.uniforms){var a=e.uniforms[i];switch(r.uniforms[i]={},a.type){case"t":r.uniforms[i].value=n(a.value);break;case"c":r.uniforms[i].value=(new ef).setHex(a.value);break;case"v2":r.uniforms[i].value=(new xd).fromArray(a.value);break;case"v3":r.uniforms[i].value=(new Fd).fromArray(a.value);break;case"v4":r.uniforms[i].value=(new Od).fromArray(a.value);break;case"m3":r.uniforms[i].value=(new Md).fromArray(a.value);case"m4":r.uniforms[i].value=(new Wd).fromArray(a.value);break;default:r.uniforms[i].value=a.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new xd).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new xd).fromArray(e.clearcoatNormalScale)),r},setTextures:function(e){return this.textures=e,this}});var Z_=function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)};function J_(){Rf.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function $_(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),cf.call(this,e,t,n),this.meshPerAttribute=r||1}function eb(e){o_.call(this,e)}J_.prototype=Object.assign(Object.create(Rf.prototype),{constructor:J_,isInstancedBufferGeometry:!0,copy:function(e){return Rf.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=Rf.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),$_.prototype=Object.assign(Object.create(cf.prototype),{constructor:$_,isInstancedBufferAttribute:!0,copy:function(e){return cf.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=cf.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),eb.prototype=Object.assign(Object.create(o_.prototype),{constructor:eb,load:function(e,t,n,r){var i=this,a=new u_(i.manager);a.setPath(i.path),a.load(e,(function(e){t(i.parse(JSON.parse(e)))}),n,r)},parse:function(e){var t=e.isInstancedBufferGeometry?new J_:new Rf,n=e.data.index;if(void 0!==n){var r=new tb[n.type](n.array);t.setIndex(new cf(r,1))}var i=e.data.attributes;for(var a in i){var o=i[a],s=(r=new tb[o.type](o.array),new(o.isInstancedBufferAttribute?$_:cf)(r,o.itemSize,o.normalized));void 0!==o.name&&(s.name=o.name),t.setAttribute(a,s)}var u=e.data.morphAttributes;if(u)for(var a in u){for(var l=u[a],c=[],d=0,h=l.length;d<h;d++){o=l[d],s=new cf(r=new tb[o.type](o.array),o.itemSize,o.normalized);void 0!==o.name&&(s.name=o.name),c.push(s)}t.morphAttributes[a]=c}e.data.morphTargetsRelative&&(t.morphTargetsRelative=!0);var f=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==f){d=0;for(var p=f.length;d!==p;++d){var m=f[d];t.addGroup(m.start,m.count,m.materialIndex)}}var g=e.data.boundingSphere;if(void 0!==g){var v=new Fd;void 0!==g.center&&v.fromArray(g.center),t.boundingSphere=new Mh(v,g.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t}});var tb={Int8Array,Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function nb(e){o_.call(this,e)}nb.prototype=Object.assign(Object.create(o_.prototype),{constructor:nb,load:function(e,t,n,r){var i=this,a=""===this.path?Z_(e):this.path;this.resourcePath=this.resourcePath||a;var o=new u_(i.manager);o.setPath(this.path),o.load(e,(function(n){var a=null;try{a=JSON.parse(n)}catch(t){return void 0!==r&&r(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)},parse:function(e,t){var n=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,n),i=this.parseImages(e.images,(function(){void 0!==t&&t(s)})),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,r,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new F_).fromJSON(e[n]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var r=new eb,i=0,a=e.length;i<a;i++){var o,s=e[i];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new Iy[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new Iy[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new Iy[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new Iy[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new Iy[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new Iy[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new Iy[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new Iy[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new Iy[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new Iy[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new Iy[s.type]((new L_[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new Iy[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new Iy[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],l=0,c=s.shapes.length;l<c;l++){var d=t[s.shapes[l]];u.push(d)}o=new Iy[s.type](u,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(u=[],l=0,c=s.shapes.length;l<c;l++){d=t[s.shapes[l]];u.push(d)}var h=s.options.extrudePath;void 0!==h&&(s.options.extrudePath=(new L_[h.type]).fromJSON(h)),o=new Iy[s.type](u,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(s);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),!0===o.isBufferGeometry&&void 0!==s.userData&&(o.userData=s.userData),n[s.uuid]=o}return n},parseMaterials:function(e,t){var n={},r={};if(void 0!==e){var i=new Q_;i.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if("MultiMaterial"===s.type){for(var u=[],l=0;l<s.materials.length;l++){var c=s.materials[l];void 0===n[c.uuid]&&(n[c.uuid]=i.parse(c)),u.push(n[c.uuid])}r[s.uuid]=u}else void 0===n[s.uuid]&&(n[s.uuid]=i.parse(s)),r[s.uuid]=n[s.uuid]}}return r},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=t_.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),t.push(i)}return t},parseImages:function(e,t){var n=this,r={};function i(e){return n.manager.itemStart(e),a.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}if(void 0!==e&&e.length>0){var a=new h_(new i_(t));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=e.length;o<s;o++){var u=e[o],l=u.url;if(Array.isArray(l)){r[u.uuid]=[];for(var c=0,d=l.length;c<d;c++){var h=l[c],f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;r[u.uuid].push(i(f))}}else{f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.resourcePath+u.url;r[u.uuid]=i(f)}}}return r},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o,s=e[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(o=Array.isArray(t[s.image])?new Pp(t[s.image]):new Id(t[s.image])).needsUpdate=!0,o.uuid=s.uuid,void 0!==s.name&&(o.name=s.name),void 0!==s.mapping&&(o.mapping=n(s.mapping,ib)),void 0!==s.offset&&o.offset.fromArray(s.offset),void 0!==s.repeat&&o.repeat.fromArray(s.repeat),void 0!==s.center&&o.center.fromArray(s.center),void 0!==s.rotation&&(o.rotation=s.rotation),void 0!==s.wrap&&(o.wrapS=n(s.wrap[0],ab),o.wrapT=n(s.wrap[1],ab)),void 0!==s.format&&(o.format=s.format),void 0!==s.type&&(o.type=s.type),void 0!==s.encoding&&(o.encoding=s.encoding),void 0!==s.minFilter&&(o.minFilter=n(s.minFilter,ob)),void 0!==s.magFilter&&(o.magFilter=n(s.magFilter,ob)),void 0!==s.anisotropy&&(o.anisotropy=s.anisotropy),void 0!==s.flipY&&(o.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(o.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(o.unpackAlignment=s.unpackAlignment),r[s.uuid]=o}return r},parseObject:function(e,t,n){var r;function i(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function a(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":r=new ch,void 0!==e.background&&Number.isInteger(e.background)&&(r.background=new ef(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new vg(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new gg(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new sp(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new W_(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new K_(e.color,e.intensity);break;case"DirectionalLight":r=new Y_(e.color,e.intensity);break;case"PointLight":r=new z_(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new X_(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new H_(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new U_(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=i(e.geometry),s=a(e.material);r=o.bones&&o.bones.length>0?new jg(o,s):new Yf(o,s);break;case"InstancedMesh":o=i(e.geometry),s=a(e.material);var u=e.count,l=e.instanceMatrix;(r=new Xg(o,s,u)).instanceMatrix=new cf(new Float32Array(l.array),16);break;case"LOD":r=new Ug;break;case"Line":r=new nv(i(e.geometry),a(e.material),e.mode);break;case"LineLoop":r=new ov(i(e.geometry),a(e.material));break;case"LineSegments":r=new av(i(e.geometry),a(e.material));break;case"PointCloud":case"Points":r=new hv(i(e.geometry),a(e.material));break;case"Sprite":r=new Ng(a(e.material));break;case"Group":r=new fg;break;default:r=new lh}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,d=0;d<c.length;d++)r.add(this.parseObject(c[d],t,n));if("LOD"===e.type){void 0!==e.autoUpdate&&(r.autoUpdate=e.autoUpdate);for(var h=e.levels,f=0;f<h.length;f++){var p=h[f],m=r.getObjectByProperty("uuid",p.object);void 0!==m&&r.addLevel(m,p.distance)}}return r}});var rb,ib={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:qc,CubeUVRefractionMapping:307},ab={RepeatWrapping:Yc,ClampToEdgeWrapping:Kc,MirroredRepeatWrapping:Xc},ob={NearestFilter:Qc,NearestMipmapNearestFilter:Zc,NearestMipmapLinearFilter:Jc,LinearFilter:$c,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:ed};function sb(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),o_.call(this,e),this.options=void 0}function ub(){this.type="ShapePath",this.color=new ef,this.subPaths=[],this.currentPath=null}function lb(e){this.type="Font",this.data=e}function cb(e,t,n,r,i){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o,s,u,l,c,d,h,f,p=new ub;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),g=0,v=m.length;g<v;){switch(m[g++]){case"m":o=m[g++]*t+n,s=m[g++]*t+r,p.moveTo(o,s);break;case"l":o=m[g++]*t+n,s=m[g++]*t+r,p.lineTo(o,s);break;case"q":u=m[g++]*t+n,l=m[g++]*t+r,c=m[g++]*t+n,d=m[g++]*t+r,p.quadraticCurveTo(c,d,u,l);break;case"b":u=m[g++]*t+n,l=m[g++]*t+r,c=m[g++]*t+n,d=m[g++]*t+r,h=m[g++]*t+n,f=m[g++]*t+r,p.bezierCurveTo(c,d,h,f,u,l)}}return{offsetX:a.ha*t,path:p}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+i.familyName+".")}function db(e){o_.call(this,e)}sb.prototype=Object.assign(Object.create(o_.prototype),{constructor:sb,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=r_.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout((function(){t&&t(a),i.manager.itemEnd(e)}),0),a;fetch(e).then((function(e){return e.blob()})).then((function(e){return void 0===i.options?createImageBitmap(e):createImageBitmap(e,i.options)})).then((function(n){r_.add(e,n),t&&t(n),i.manager.itemEnd(e)})).catch((function(t){r&&r(t),i.manager.itemError(e),i.manager.itemEnd(e)})),i.manager.itemStart(e)}}),Object.assign(ub.prototype,{moveTo:function(e,t){return this.currentPath=new k_,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this},bezierCurveTo:function(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new F_;a.curves=i.curves,t.push(a)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],u=s.x-o.x,l=s.y-o.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(o=t[a],u=-u,s=t[i],l=-l),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var c=l*(e.x-o.x)-u*(e.y-o.y);if(0===c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var i=ay.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return n(a);var o,s,u,l=[];if(1===a.length)return s=a[0],(u=new F_).curves=s.curves,l.push(u),l;var c=!i(a[0].getPoints());c=e?!c:c;var d,h,f=[],p=[],m=[],g=0;p[g]=void 0,m[g]=[];for(var v=0,y=a.length;v<y;v++)o=i(d=(s=a[v]).getPoints()),(o=e?!o:o)?(!c&&p[g]&&g++,p[g]={s:new F_,p:d},p[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:d[0]});if(!p[0])return n(a);if(p.length>1){for(var _=!1,b=[],E=0,T=p.length;E<T;E++)f[E]=[];for(E=0,T=p.length;E<T;E++)for(var S=m[E],w=0;w<S.length;w++){for(var A=S[w],x=!0,M=0;M<p.length;M++)r(A.p,p[M].p)&&(E!==M&&b.push({froms:E,tos:M,hole:w}),x?(x=!1,f[M].push(A)):_=!0);x&&f[E].push(A)}b.length>0&&(_||(m=f))}v=0;for(var C=p.length;v<C;v++){u=p[v].s,l.push(u);for(var R=0,I=(h=m[v]).length;R<I;R++)u.holes.push(h[R].h)}return l}}),Object.assign(lb.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var n=[],r=function(e,t,n){for(var r=Array.from?Array.from(e):String(e).split(""),i=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*i,o=[],s=0,u=0,l=0;l<r.length;l++){var c=r[l];if("\n"===c)s=0,u-=a;else{var d=cb(c,i,s,u,n);s+=d.offsetX,o.push(d.path)}}return o}(e,t,this.data),i=0,a=r.length;i<a;i++)Array.prototype.push.apply(n,r[i].toShapes());return n}}),db.prototype=Object.assign(Object.create(o_.prototype),{constructor:db,load:function(e,t,n,r){var i=this,a=new u_(this.manager);a.setPath(this.path),a.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=i.parse(n);t&&t(r)}),n,r)},parse:function(e){return new lb(e)}});var hb=function(){return void 0===rb&&(rb=new(window.AudioContext||window.webkitAudioContext)),rb};function fb(e){o_.call(this,e)}function pb(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new Fd)}function mb(e,t){B_.call(this,void 0,t),this.sh=void 0!==e?e:new pb}function gb(e,t,n){mb.call(this,void 0,n);var r=(new ef).set(e),i=(new ef).set(t),a=new Fd(r.r,r.g,r.b),o=new Fd(i.r,i.g,i.b),s=Math.sqrt(Math.PI),u=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(u)}function vb(e,t){mb.call(this,void 0,t);var n=(new ef).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}fb.prototype=Object.assign(Object.create(o_.prototype),{constructor:fb,load:function(e,t,n,r){var i=new u_(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.load(e,(function(e){var n=e.slice(0);hb().decodeAudioData(n,(function(e){t(e)}))}),n,r)}}),Object.assign(pb.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScale(a[1],.488603*r),t.addScale(a[2],.488603*i),t.addScale(a[3],.488603*n),t.addScale(a[4],n*r*1.092548),t.addScale(a[5],r*i*1.092548),t.addScale(a[6],.315392*(3*i*i-1)),t.addScale(a[7],n*i*1.092548),t.addScale(a[8],.546274*(n*n-r*r)),t},getIrradianceAt:function(e,t){var n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScale(a[1],1.023328*r),t.addScale(a[2],1.023328*i),t.addScale(a[3],1.023328*n),t.addScale(a[4],.858086*n*r),t.addScale(a[5],.858086*r*i),t.addScale(a[6],.743125*i*i-.247708),t.addScale(a[7],.858086*n*i),t.addScale(a[8],.429043*(n*n-r*r)),t},add:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},equals:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e,t){void 0===t&&(t=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);for(var n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}),Object.assign(pb,{getBasisAt:function(e,t){var n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}),mb.prototype=Object.assign(Object.create(B_.prototype),{constructor:mb,isLightProbe:!0,copy:function(e){return B_.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return B_.prototype.toJSON.call(this,e)}}),gb.prototype=Object.assign(Object.create(mb.prototype),{constructor:gb,isHemisphereLightProbe:!0,copy:function(e){return mb.prototype.copy.call(this,e),this},toJSON:function(e){return mb.prototype.toJSON.call(this,e)}}),vb.prototype=Object.assign(Object.create(mb.prototype),{constructor:vb,isAmbientLightProbe:!0,copy:function(e){return mb.prototype.copy.call(this,e),this},toJSON:function(e){return mb.prototype.toJSON.call(this,e)}});var yb=new Wd,_b=new Wd;function bb(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new sp,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new sp,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,r,i=e.projectionMatrix.clone(),a=t.eyeSep/2,o=a*t.near/t.focus,s=t.near*Math.tan(Ad.DEG2RAD*t.fov*.5)/t.zoom;_b.elements[12]=-a,yb.elements[12]=a,n=-s*t.aspect+o,r=s*t.aspect+o,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(i),n=-s*t.aspect-o,r=s*t.aspect-o,i.elements[0]=2*t.near/(r-n),i.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(_b),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(yb)}}),Object.assign(bb.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});var Eb=new Fd,Tb=new Ld,Sb=new Fd,wb=new Fd;function Ab(){lh.call(this),this.type="AudioListener",this.context=hb(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new bb}function xb(e){lh.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}Ab.prototype=Object.assign(Object.create(lh.prototype),{constructor:Ab,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){lh.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Eb,Tb,Sb),wb.set(0,0,-1).applyQuaternion(Tb),t.positionX){var r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Eb.x,r),t.positionY.linearRampToValueAtTime(Eb.y,r),t.positionZ.linearRampToValueAtTime(Eb.z,r),t.forwardX.linearRampToValueAtTime(wb.x,r),t.forwardY.linearRampToValueAtTime(wb.y,r),t.forwardZ.linearRampToValueAtTime(wb.z,r),t.upX.linearRampToValueAtTime(n.x,r),t.upY.linearRampToValueAtTime(n.y,r),t.upZ.linearRampToValueAtTime(n.z,r)}else t.setPosition(Eb.x,Eb.y,Eb.z),t.setOrientation(wb.x,wb.y,wb.z,n.x,n.y,n.z)}}),xb.prototype=Object.assign(Object.create(lh.prototype),{constructor:xb,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(void 0===e&&(e=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var Mb=new Fd,Cb=new Ld,Rb=new Fd,Ib=new Fd;function Ob(e){xb.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Db(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Pb(e,t,n){this.binding=e,this.valueSize=n;var r,i=Float64Array;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Ob.prototype=Object.assign(Object.create(xb.prototype),{constructor:Ob,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(e){if(lh.prototype.updateMatrixWorld.call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(Mb,Cb,Rb),Ib.set(0,0,1).applyQuaternion(Cb);var t=this.panner;if(t.positionX){var n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Mb.x,n),t.positionY.linearRampToValueAtTime(Mb.y,n),t.positionZ.linearRampToValueAtTime(Mb.z,n),t.orientationX.linearRampToValueAtTime(Ib.x,n),t.orientationY.linearRampToValueAtTime(Ib.y,n),t.orientationZ.linearRampToValueAtTime(Ib.z,n)}else t.setPosition(Mb.x,Mb.y,Mb.z),t.setOrientation(Ib.x,Ib.y,Ib.z)}}}),Object.assign(Db.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(Pb.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,i<1){var o=3*t;this._mixBufferRegion(n,r,o,1-i,t)}for(var s=t,u=t+t;s!==u;++s)if(n[s]!==n[s+t]){a.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=3*n;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,r,i){if(r>=.5)for(var a=0;a!==i;++a)e[t+a]=e[n+a]},_slerp:function(e,t,n,r){Ld.slerpFlat(e,t,e,t,e,n,r)},_lerp:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}}});var Lb="\\[\\]\\.:\\/",Nb=new RegExp("[\\[\\]\\.:\\/]","g"),kb="[^\\[\\]\\.:\\/]",Fb="[^"+Lb.replace("\\.","")+"]",Bb=/((?:WC+[\/:])*)/.source.replace("WC",kb),Ub=/(WCOD+)?/.source.replace("WCOD",Fb),jb=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",kb),Gb=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",kb),Hb=new RegExp("^"+Bb+Ub+jb+Gb+"$"),Vb=["material","materials","bones"];function zb(e,t,n){var r=n||Wb.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function Wb(e,t,n){this.path=t,this.parsedPath=n||Wb.parseTrackName(t),this.node=Wb.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function qb(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var r=t.tracks,i=r.length,a=new Array(i),o={endingStart:fd,endingEnd:fd},s=0;s!==i;++s){var u=r[s].createInterpolant(null);a[s]=u,u.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Yb(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Kb(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Xb(e,t,n){yg.call(this,e,t),this.meshPerAttribute=n||1}function Qb(e,t,n,r){this.ray=new Nh(e,t),this.near=n||0,this.far=r||1/0,this.camera=null,this.layers=new Xd,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Zb(e,t){return e.distance-t.distance}function Jb(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var i=e.children,a=0,o=i.length;a<o;a++)Jb(i[a],t,n,!0)}function $b(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}Object.assign(zb.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Wb,{Composite:zb,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Wb.Composite(e,t,n):new Wb(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Nb,"")},parseTrackName:function(e){var t=Hb.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Vb.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function(e){for(var n=0;n<e.length;n++){var i=e[n];if(i.name===t||i.uuid===t)return i;var a=r(i.children);if(a)return a}return null},i=r(e.children);if(i)return i}return null}}),Object.assign(Wb.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=Wb.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var a=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var s=e[r];if(void 0!==s){var u=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(e.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===i){i=o;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][u]}else{var c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Wb.prototype,{_getValue_unbound:Wb.prototype.getValue,_setValue_unbound:Wb.prototype.setValue}),Object.assign(function(){this.uuid=Ad.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,u=void 0,l=0,c=arguments.length;l!==c;++l){var d=arguments[l],h=d.uuid,f=r[h];if(void 0===f){f=t++,r[h]=f,e.push(d);for(var p=0,m=s;p!==m;++p)o[p].push(new Wb(d,i[p],a[p]))}else if(f<n){u=e[f];var g=--n,v=e[g];r[v.uuid]=f,e[f]=v,r[h]=g,e[g]=d;for(p=0,m=s;p!==m;++p){var y=o[p],_=y[g],b=y[f];y[f]=_,void 0===b&&(b=new Wb(d,i[p],a[p])),y[g]=b}}else e[f]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],u=s.uuid,l=n[u];if(void 0!==l&&l>=t){var c=t++,d=e[c];n[d.uuid]=l,e[l]=d,n[u]=c,e[c]=s;for(var h=0,f=i;h!==f;++h){var p=r[h],m=p[c],g=p[l];p[l]=m,p[c]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var u=arguments[o],l=u.uuid,c=r[l];if(void 0!==c)if(delete r[l],c<n){var d=--n,h=e[d],f=e[y=--t];r[h.uuid]=c,e[c]=h,r[f.uuid]=d,e[d]=f,e.pop();for(var p=0,m=a;p!==m;++p){var g=(_=i[p])[d],v=_[y];_[c]=g,_[d]=v,_.pop()}}else{var y;r[(f=e[y=--t]).uuid]=c,e[c]=f,e.pop();for(p=0,m=a;p!==m;++p){var _;(_=i[p])[c]=_[y],_.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,u=s.length,l=this.nCachedObjects_,c=new Array(u);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(c);for(var d=l,h=s.length;d!==h;++d){var f=s[d];c[d]=new Wb(f,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=n,a[n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}),Object.assign(qb.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,a=i/r,o=r/i;e.warp(1,a,t),this.warp(o,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var r=this._mixer,i=r.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,u=a.sampleValues;return s[0]=i,s[1]=i+n,u[0]=e/o,u[1]=t/o,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*n;if(a<0||0===n)return;this._startTime=null,t=n*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var u=this._interpolants,l=this._propertyBindings,c=0,d=u.length;c!==d;++c)u[c].evaluate(o),l[c].accumulate(r,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,r=this.loop,i=this._loopCount,a=2202===r;if(0===e)return-1===i?t:a&&1==(1&i)?n-t:t;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=n)t=n;else{if(!(t<0)){this.time=t;break e}t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),t>=n||t<0){var o=Math.floor(t/n);t-=n*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?n:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var u=e<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=t;if(a&&1==(1&i))return n-t}return t},_setEndings:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=pd,r.endingEnd=pd):(r.endingStart=e?this.zeroSlopeAtStart?pd:fd:md,r.endingEnd=t?this.zeroSlopeAtEnd?pd:fd:md)},_scheduleFading:function(e,t,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}),Yb.prototype=Object.assign(Object.create(Ed.prototype),{constructor:Yb,_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,u=this._bindingsByRootAndName,l=u[s];void 0===l&&(l={},u[s]=l);for(var c=0;c!==i;++c){var d=r[c],h=d.name,f=l[h];if(void 0!==f)a[c]=f;else{if(void 0!==(f=a[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,h));continue}var p=t&&t._propertyBindings[c].binding.parsedPath;++(f=new Pb(Wb.create(n,h,p),d.ValueTypeName,d.getValueSize())).referenceCount,this._addInactiveBinding(f,s,h),a[c]=f}o[c].resultBuffer=f.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,u=s[s.length-1],l=e._byClipCacheIndex;u._byClipCacheIndex=l,s[l]=u,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=r[t],a=this._bindings;void 0===i&&(i={},r[t]=i),i[n]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u,t[u]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[r]},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Wy(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?t_.findByName(n,e):e,a=null!==i?i.uuid:e,o=this._actionsByClip[a],s=null;if(void 0!==o){var u=o.actionByRoot[r];if(void 0!==u)return u;s=o.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var l=new qb(this,i,t);return this._bindAction(l,s),this._addInactiveAction(l,a,r),l},existingAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?t_.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o){t[o]._update(r,e,i,a)}var s=this._bindings,u=this._nActiveBindings;for(o=0;o!==u;++o)s[o].apply(a);return this},setTime:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var u=a[o];this._deactivateAction(u);var l=u._cacheIndex,c=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,c._cacheIndex=l,t[l]=c,t.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),Kb.prototype.clone=function(){return new Kb(void 0===this.value.clone?this.value:this.value.clone())},Xb.prototype=Object.assign(Object.create(yg.prototype),{constructor:Xb,isInstancedInterleavedBuffer:!0,copy:function(e){return yg.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(Qb.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var r=n||[];return Jb(e,this,r,t),r.sort(Zb),r},intersectObjects:function(e,t,n){var r=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,a=e.length;i<a;i++)Jb(e[i],this,r,t);return r.sort(Zb),r}}),Object.assign($b.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Ad.clamp(t/this.radius,-1,1))),this}}),Object.assign(function(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}});var eE=new xd;function tE(e,t){this.min=void 0!==e?e:new xd(1/0,1/0),this.max=void 0!==t?t:new xd(-1/0,-1/0)}Object.assign(tE.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var n=eE.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new xd),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new xd),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new xd),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new xd),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return eE.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var nE=new Fd,rE=new Fd;function iE(e,t){this.start=void 0!==e?e:new Fd,this.end=void 0!==t?t:new Fd}function aE(e){lh.call(this),this.material=e,this.render=function(){}}Object.assign(iE.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Fd),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Fd),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Fd),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){nE.subVectors(e,this.start),rE.subVectors(this.end,this.start);var n=rE.dot(rE),r=rE.dot(nE)/n;return t&&(r=Ad.clamp(r,0,1)),r},closestPointToPoint:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Fd),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),aE.prototype=Object.create(lh.prototype),aE.prototype.constructor=aE,aE.prototype.isImmediateRenderObject=!0;var oE=new Fd;function sE(e,t){lh.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new Rf,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,a=1;i<32;i++,a++){var o=i/32*Math.PI*2,s=a/32*Math.PI*2;r.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}n.setAttribute("position",new yf(r,3));var u=new Qg({fog:!1});this.cone=new av(n,u),this.add(this.cone),this.update()}sE.prototype=Object.create(lh.prototype),sE.prototype.constructor=sE,sE.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},sE.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),oE.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(oE),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var uE=new Fd,lE=new Wd,cE=new Wd;function dE(e){for(var t=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var r=0;r<t.children.length;r++)n.push.apply(n,e(t.children[r]));return n}(e),n=new Rf,r=[],i=[],a=new ef(0,0,1),o=new ef(0,1,0),s=0;s<t.length;s++){var u=t[s];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.setAttribute("position",new yf(r,3)),n.setAttribute("color",new yf(i,3));var l=new Qg({vertexColors:!0,depthTest:!1,depthWrite:!1,transparent:!0});av.call(this,n,l),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function hE(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var r=new my(t,4,2),i=new uf({wireframe:!0,fog:!1});Yf.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dE.prototype=Object.create(av.prototype),dE.prototype.constructor=dE,dE.prototype.isSkeletonHelper=!0,dE.prototype.updateMatrixWorld=function(e){var t=this.bones,n=this.geometry,r=n.getAttribute("position");cE.getInverse(this.root.matrixWorld);for(var i=0,a=0;i<t.length;i++){var o=t[i];o.parent&&o.parent.isBone&&(lE.multiplyMatrices(cE,o.matrixWorld),uE.setFromMatrixPosition(lE),r.setXYZ(a,uE.x,uE.y,uE.z),lE.multiplyMatrices(cE,o.parent.matrixWorld),uE.setFromMatrixPosition(lE),r.setXYZ(a+1,uE.x,uE.y,uE.z),a+=2)}n.getAttribute("position").needsUpdate=!0,lh.prototype.updateMatrixWorld.call(this,e)},hE.prototype=Object.create(Yf.prototype),hE.prototype.constructor=hE,hE.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},hE.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var fE=new Fd,pE=new ef,mE=new ef;function gE(e,t,n){lh.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new xv(t);r.rotateY(.5*Math.PI),this.material=new uf({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=!0);var i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.setAttribute("color",new cf(a,3)),this.add(new Yf(r,this.material)),this.update()}function vE(e,t,n,r){e=e||10,t=t||10,n=new ef(void 0!==n?n:4473924),r=new ef(void 0!==r?r:8947848);for(var i=t/2,a=e/t,o=e/2,s=[],u=[],l=0,c=0,d=-o;l<=t;l++,d+=a){s.push(-o,0,d,o,0,d),s.push(d,0,-o,d,0,o);var h=l===i?n:r;h.toArray(u,c),c+=3,h.toArray(u,c),c+=3,h.toArray(u,c),c+=3,h.toArray(u,c),c+=3}var f=new Rf;f.setAttribute("position",new yf(s,3)),f.setAttribute("color",new yf(u,3));var p=new Qg({vertexColors:!0});av.call(this,f,p)}function yE(e,t,n,r,i,a){e=e||10,t=t||16,n=n||8,r=r||64,i=new ef(void 0!==i?i:4473924),a=new ef(void 0!==a?a:8947848);var o,s,u,l,c,d,h,f=[],p=[];for(l=0;l<=t;l++)u=l/t*(2*Math.PI),o=Math.sin(u)*e,s=Math.cos(u)*e,f.push(0,0,0),f.push(o,0,s),h=1&l?i:a,p.push(h.r,h.g,h.b),p.push(h.r,h.g,h.b);for(l=0;l<=n;l++)for(h=1&l?i:a,d=e-e/n*l,c=0;c<r;c++)u=c/r*(2*Math.PI),o=Math.sin(u)*d,s=Math.cos(u)*d,f.push(o,0,s),p.push(h.r,h.g,h.b),u=(c+1)/r*(2*Math.PI),o=Math.sin(u)*d,s=Math.cos(u)*d,f.push(o,0,s),p.push(h.r,h.g,h.b);var m=new Rf;m.setAttribute("position",new yf(f,3)),m.setAttribute("color",new yf(p,3));var g=new Qg({vertexColors:!0});av.call(this,m,g)}gE.prototype=Object.create(lh.prototype),gE.prototype.constructor=gE,gE.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},gE.prototype.update=function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");pE.copy(this.light.color),mE.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?pE:mE;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(fE.setFromMatrixPosition(this.light.matrixWorld).negate())},vE.prototype=Object.assign(Object.create(av.prototype),{constructor:vE,copy:function(e){return av.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),yE.prototype=Object.create(av.prototype),yE.prototype.constructor=yE;var _E=new Fd,bE=new Fd,EE=new Fd;function TE(e,t,n){lh.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var r=new Rf;r.setAttribute("position",new yf([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new Qg({fog:!1});this.lightPlane=new nv(r,i),this.add(this.lightPlane),(r=new Rf).setAttribute("position",new yf([0,0,0,0,0,1],3)),this.targetLine=new nv(r,i),this.add(this.targetLine),this.update()}TE.prototype=Object.create(lh.prototype),TE.prototype.constructor=TE,TE.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},TE.prototype.update=function(){_E.setFromMatrixPosition(this.light.matrixWorld),bE.setFromMatrixPosition(this.light.target.matrixWorld),EE.subVectors(bE,_E),this.lightPlane.lookAt(bE),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(bE),this.targetLine.scale.z=EE.length()};var SE=new Fd,wE=new op;function AE(e){var t=new Rf,n=new Qg({color:16777215,vertexColors:!0}),r=[],i=[],a={},o=new ef(16755200),s=new ef(16711680),u=new ef(43775),l=new ef(16777215),c=new ef(3355443);function d(e,t,n){h(e,n),h(t,n)}function h(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(r.length/3-1)}d("n1","n2",o),d("n2","n4",o),d("n4","n3",o),d("n3","n1",o),d("f1","f2",o),d("f2","f4",o),d("f4","f3",o),d("f3","f1",o),d("n1","f1",o),d("n2","f2",o),d("n3","f3",o),d("n4","f4",o),d("p","n1",s),d("p","n2",s),d("p","n3",s),d("p","n4",s),d("u1","u2",u),d("u2","u3",u),d("u3","u1",u),d("c","t",l),d("p","c",c),d("cn1","cn2",c),d("cn3","cn4",c),d("cf1","cf2",c),d("cf3","cf4",c),t.setAttribute("position",new yf(r,3)),t.setAttribute("color",new yf(i,3)),av.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function xE(e,t,n,r,i,a,o){SE.set(i,a,o).unproject(r);var s=t[e];if(void 0!==s)for(var u=n.getAttribute("position"),l=0,c=s.length;l<c;l++)u.setXYZ(s[l],SE.x,SE.y,SE.z)}AE.prototype=Object.create(av.prototype),AE.prototype.constructor=AE,AE.prototype.update=function(){var e=this.geometry,t=this.pointMap;wE.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),xE("c",t,e,wE,0,0,-1),xE("t",t,e,wE,0,0,1),xE("n1",t,e,wE,-1,-1,-1),xE("n2",t,e,wE,1,-1,-1),xE("n3",t,e,wE,-1,1,-1),xE("n4",t,e,wE,1,1,-1),xE("f1",t,e,wE,-1,-1,1),xE("f2",t,e,wE,1,-1,1),xE("f3",t,e,wE,-1,1,1),xE("f4",t,e,wE,1,1,1),xE("u1",t,e,wE,.7,1.1,-1),xE("u2",t,e,wE,-.7,1.1,-1),xE("u3",t,e,wE,0,2,-1),xE("cf1",t,e,wE,-1,0,1),xE("cf2",t,e,wE,1,0,1),xE("cf3",t,e,wE,0,-1,1),xE("cf4",t,e,wE,0,1,1),xE("cn1",t,e,wE,-1,0,-1),xE("cn2",t,e,wE,1,0,-1),xE("cn3",t,e,wE,0,-1,-1),xE("cn4",t,e,wE,0,1,-1),e.getAttribute("position").needsUpdate=!0};var ME=new wh;function CE(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new Rf;i.setIndex(new cf(n,1)),i.setAttribute("position",new cf(r,3)),av.call(this,i,new Qg({color:t})),this.matrixAutoUpdate=!1,this.update()}function RE(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Rf;r.setIndex(new cf(n,1)),r.setAttribute("position",new yf([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),av.call(this,r,new Qg({color:t})),this.geometry.computeBoundingSphere()}function IE(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var r=void 0!==n?n:16776960,i=new Rf;i.setAttribute("position",new yf([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),nv.call(this,i,new Qg({color:r}));var a=new Rf;a.setAttribute("position",new yf([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new Yf(a,new uf({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}CE.prototype=Object.create(av.prototype),CE.prototype.constructor=CE,CE.prototype.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&ME.setFromObject(this.object),!ME.isEmpty()){var t=ME.min,n=ME.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}},CE.prototype.setFromObject=function(e){return this.object=e,this.update(),this},CE.prototype.copy=function(e){return av.prototype.copy.call(this,e),this.object=e.object,this},CE.prototype.clone=function(){return(new this.constructor).copy(this)},RE.prototype=Object.create(av.prototype),RE.prototype.constructor=RE,RE.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),lh.prototype.updateMatrixWorld.call(this,e))},IE.prototype=Object.create(nv.prototype),IE.prototype.constructor=IE,IE.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?1:0,this.lookAt(this.plane.normal),lh.prototype.updateMatrixWorld.call(this,e)};var OE,DE,PE=new Fd;function LE(e,t,n,r,i,a){lh.call(this),void 0===e&&(e=new Fd(0,0,1)),void 0===t&&(t=new Fd(0,0,0)),void 0===n&&(n=1),void 0===r&&(r=16776960),void 0===i&&(i=.2*n),void 0===a&&(a=.2*i),void 0===OE&&((OE=new Rf).setAttribute("position",new yf([0,0,0,0,1,0],3)),(DE=new Ay(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new nv(OE,new Qg({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Yf(DE,new uf({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,a)}function NE(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new Rf;n.setAttribute("position",new yf(t,3)),n.setAttribute("color",new yf([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new Qg({vertexColors:!0});av.call(this,n,r)}LE.prototype=Object.create(lh.prototype),LE.prototype.constructor=LE,LE.prototype.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{PE.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(PE,t)}},LE.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},LE.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},LE.prototype.copy=function(e){return lh.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},LE.prototype.clone=function(){return(new this.constructor).copy(this)},NE.prototype=Object.create(av.prototype),NE.prototype.constructor=NE;var kE,FE,BE,UE,jE=[.125,.215,.35,.446,.526,.582],GE=5+jE.length,HE={[gd]:0,[vd]:1,3002:2,3004:3,3005:4,3006:5,3007:6},{_lodPlanes:VE,_sizeLods:zE,_sigmas:WE}=(new W_,kE=20,FE=new Float32Array(kE),BE=new Fd(0,1,0),(UE=new Dy({defines:{n:kE},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:FE},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:BE},inputEncoding:{value:HE[3e3]},outputEncoding:{value:HE[3e3]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tfor (int i = 0; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfor (int dir = -1; dir < 2; dir += 2) {\n\t\t\tif (i == 0 && dir == 1)\n\t\t\t\tcontinue;\n\t\t\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\t\t\tif (all(equal(axis, vec3(0.0))))\n\t\t\t\taxis = cross(vec3(0.0, 1.0, 0.0), vOutputDirection);\n\t\t\taxis = normalize(axis);\n\t\t\tfloat theta = dTheta * float(dir * i);\n\t\t\tfloat cosTheta = cos(theta);\n\t\t\t// Rodrigues' axis-angle rotation\n\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t\t\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\t\t\tgl_FragColor.rgb +=\n\t\t\t\t\tweights[i] * bilinearCubeUV(envMap, sampleDirection, mipInt);\n\t\t}\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",function(){for(var e=[],t=[],n=[],r=8,i=0;i<GE;i++){var a=Math.pow(2,r);t.push(a);var o=1/a;i>4?o=jE[i-8+4-1]:0==i&&(o=0),n.push(o);for(var s=1/(a-1),u=-s/2,l=1+s/2,c=[u,u,l,u,l,l,u,u,l,l,u,l],d=new Float32Array(108),h=new Float32Array(72),f=new Float32Array(36),p=0;p<6;p++){var m=p%3*2/3-1,g=p>2?0:-1,v=[m,g,0,m+2/3,g,0,m+2/3,g+1,0,m,g,0,m+2/3,g+1,0,m,g+1,0];d.set(v,18*p),h.set(c,12*p);var y=[p,p,p,p,p,p];f.set(y,6*p)}var _=new Rf;_.setAttribute("position",new cf(d,3)),_.setAttribute("uv",new cf(h,2)),_.setAttribute("faceIndex",new cf(f,1)),e.push(_),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}());function qE(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),S_.call(this,e),this.type="catmullrom"}m_.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(m_.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(N_.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new ep,n=0,r=e.length;n<r;n++){var i=e[n];t.vertices.push(new Fd(i.x,i.y,i.z||0))}return t}}),Object.assign(k_.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),qE.prototype=Object.create(S_.prototype),Object.assign(qE.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),vE.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},dE.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(o_.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Z_(e)}}),o_.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(nb.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(tE.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(wh.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),pp.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},iE.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Ad,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Ad.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Ad.ceilPowerOfTwo(e)}}),Object.assign(Md.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Wd.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Fd).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)}}),Uh.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Ld.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Nh.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Qh.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Qh,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Qh.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Qh.getNormal(e,t,n,r)}}),Object.assign(F_.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new uy(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new by(this,e)}}),Object.assign(xd.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Fd.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Od.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ep.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(lh.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(lh.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Yf.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Yf.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Ug.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Vg.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),jg.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(m_.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),sp.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(B_.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(cf.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===bd},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(bd)}}}),Object.assign(cf.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?bd:_d),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Rf.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new cf(arguments[1],arguments[2])))},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Rf.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Qb.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(yg.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===bd},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(yg.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?bd:_d),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(ly.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Kb.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(sf.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ef}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Ny.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ap.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(mg.prototype,{clearTarget:function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(mg.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?vd:gd}}}),Object.defineProperties(ug.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Dd.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(xb.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new fb).load(e,(function(e){t.setBuffer(e)})),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Db.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},lp.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Cd.crossOrigin=void 0,Cd.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new p_;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},Cd.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new f_;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,n,void 0,r);return t&&(a.mapping=t),a},Cd.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Cd.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"114"}}));var YE=function(e,t){var n,r,i,a,o;void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.enabled=!0,this.target=new Fd,this.currentDistance=1,this.minDistance=-700,this.maxDistance=200,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:Bc,MIDDLE:Uc,RIGHT:jc},this.touches={ONE:Gc,TWO:Vc},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(u),s.update(),f=h.NONE},this.update=(n=new Fd,r=(new Ld).setFromUnitVectors(e.up,new Fd(0,1,0)),i=r.clone().inverse(),a=new Fd,o=new Ld,function(){var e=s.object.position;if(n.copy(e).sub(s.target),n.applyQuaternion(r),m.setFromVector3(n),s.autoRotate&&f===h.NONE&&R(2*Math.PI/60/60*s.autoRotateSpeed),s.enableDamping?(m.theta+=g.theta*s.dampingFactor,m.phi+=g.phi*s.dampingFactor):(m.theta+=g.theta,m.phi+=g.phi),m.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,m.theta)),m.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,m.phi)),m.makeSafe(),s.currentDistance>=0){var t=s.currentDistance;m.radius!=t&&(m.radius=s.currentDistance,y=!0)}else{var c=75+.06*s.currentDistance;s.object.fov!=c&&(s.object.fov=c,s.object.updateProjectionMatrix(),y=!0)}return m.radius=Math.max(s.minDistance,Math.min(s.maxDistance,m.radius)),!0===s.enableDamping?s.target.addScaledVector(v,s.dampingFactor):s.target.add(v),n.setFromSpherical(m),n.applyQuaternion(i),e.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(g.theta*=1-s.dampingFactor,g.phi*=1-s.dampingFactor,v.multiplyScalar(1-s.dampingFactor)):(g.set(0,0,0),v.set(0,0,0)),!!(y||a.distanceToSquared(s.object.position)>p||8*(1-o.dot(s.object.quaternion))>p)&&(y?s.dispatchEvent(l):s.dispatchEvent(u),a.copy(s.object.position),o.copy(s.object.quaternion),y=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",$,!1),s.domElement.removeEventListener("mousedown",W,!1),s.domElement.removeEventListener("wheel",K,!1),s.domElement.removeEventListener("touchstart",Q,!1),s.domElement.removeEventListener("touchend",J,!1),s.domElement.removeEventListener("touchmove",Z,!1),document.removeEventListener("mousemove",q,!1),document.removeEventListener("mouseup",Y,!1),s.domElement.removeEventListener("keydown",X,!1)};var s=this,u={type:"change"},l={type:"zoom"},c={type:"start"},d={type:"end"},h={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},f=h.NONE,p=1e-6,m=new $b,g=new $b,v=new Fd,y=!1,_=new xd,b=new xd,E=new xd,T=new xd,S=new xd,w=new xd,A=new xd,x=new xd,M=new xd;function C(){return Math.pow(.95,s.zoomSpeed)}function R(e){g.theta-=e}function I(e){g.phi-=e}var O,D=(O=new Fd,function(e,t){O.setFromMatrixColumn(t,0),O.multiplyScalar(-e),v.add(O)}),P=function(){var e=new Fd;return function(t,n){!0===s.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(s.object.up,e)),e.multiplyScalar(t),v.add(e)}}(),L=function(){var e=new Fd;return function(t,n){var r=s.domElement;if(s.object.isPerspectiveCamera){var i=s.object.position;e.copy(i).sub(s.target);var a=e.length();a*=Math.tan(s.object.fov/2*Math.PI/180),D(2*t*a/r.clientHeight,s.object.matrix),P(2*n*a/r.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(D(t*(s.object.right-s.object.left)/s.object.zoom/r.clientWidth,s.object.matrix),P(n*(s.object.top-s.object.bottom)/s.object.zoom/r.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function N(e){s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),y=!0):s.object.isPerspectiveCamera||(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function k(e){s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),y=!0):s.object.isPerspectiveCamera||(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function F(e){_.set(e.clientX,e.clientY)}function B(e){T.set(e.clientX,e.clientY)}function U(e){if(1==e.touches.length)_.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);_.set(t,n)}}function j(e){if(1==e.touches.length)T.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);T.set(t,n)}}function G(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);A.set(0,r)}function H(e){if(1==e.touches.length)b.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);b.set(t,n)}E.subVectors(b,_).multiplyScalar(s.rotateSpeed);var r=s.domElement;R(2*Math.PI*E.x/r.clientHeight),I(2*Math.PI*E.y/r.clientHeight),_.copy(b)}function V(e){if(1==e.touches.length)S.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);S.set(t,n)}w.subVectors(S,T).multiplyScalar(s.panSpeed),L(w.x,w.y),T.copy(S)}function z(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);x.set(0,r),M.set(0,Math.pow(x.y/A.y,s.zoomSpeed)),N(M.y),A.copy(x)}function W(e){if(!1!==s.enabled){var t;switch(e.preventDefault(),s.domElement.focus?s.domElement.focus():window.focus(),e.button){case 0:t=s.mouseButtons.LEFT;break;case 1:t=s.mouseButtons.MIDDLE;break;case 2:t=s.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Uc:if(!1===s.enableZoom)return;!function(e){A.set(e.clientX,e.clientY)}(e),f=h.DOLLY;break;case Bc:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enablePan)return;B(e),f=h.PAN}else{if(!1===s.enableRotate)return;F(e),f=h.ROTATE}break;case jc:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enableRotate)return;F(e),f=h.ROTATE}else{if(!1===s.enablePan)return;B(e),f=h.PAN}break;default:f=h.NONE}f!==h.NONE&&(document.addEventListener("mousemove",q,!1),document.addEventListener("mouseup",Y,!1),s.dispatchEvent(c))}}function q(e){if(!1!==s.enabled)switch(e.preventDefault(),f){case h.ROTATE:if(!1===s.enableRotate)return;!function(e){b.set(e.clientX,e.clientY),E.subVectors(b,_).multiplyScalar(s.rotateSpeed);var t=s.domElement;R(2*Math.PI*E.x/t.clientHeight),I(2*Math.PI*E.y/t.clientHeight),_.copy(b),s.update()}(e);break;case h.DOLLY:if(!1===s.enableZoom)return;!function(e){x.set(e.clientX,e.clientY),M.subVectors(x,A),M.y>0?N(C()):M.y<0&&k(C()),A.copy(x),s.update()}(e);break;case h.PAN:if(!1===s.enablePan)return;!function(e){S.set(e.clientX,e.clientY),w.subVectors(S,T).multiplyScalar(s.panSpeed),L(w.x,w.y),T.copy(S),s.update()}(e)}}function Y(e){!1!==s.enabled&&(document.removeEventListener("mousemove",q,!1),document.removeEventListener("mouseup",Y,!1),s.dispatchEvent(d),f=h.NONE)}function K(e){!1===s.enabled||!1===s.enableZoom||f!==h.NONE&&f!==h.ROTATE||(e.preventDefault(),e.stopPropagation(),s.dispatchEvent(c),function(e){s.currentDistance+=15*Math.sign(e.deltaY),s.currentDistance=Math.clamp(0!=s.currentDistance?s.currentDistance:Math.sign(e.deltaY)+.1,s.minDistance,s.maxDistance),e.deltaY<0?k(C()):e.deltaY>0&&N(C()),s.update()}(e),s.dispatchEvent(d))}function X(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){var t=!1;switch(e.keyCode){case s.keys.UP:L(0,s.keyPanSpeed),t=!0;break;case s.keys.BOTTOM:L(0,-s.keyPanSpeed),t=!0;break;case s.keys.LEFT:L(s.keyPanSpeed,0),t=!0;break;case s.keys.RIGHT:L(-s.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),s.update())}(e)}function Q(e){if(!1!==s.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(s.touches.ONE){case Gc:if(!1===s.enableRotate)return;U(e),f=h.TOUCH_ROTATE;break;case Hc:if(!1===s.enablePan)return;j(e),f=h.TOUCH_PAN;break;default:f=h.NONE}break;case 2:switch(s.touches.TWO){case Vc:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){s.enableZoom&&G(e),s.enablePan&&j(e)}(e),f=h.TOUCH_DOLLY_PAN;break;case zc:if(!1===s.enableZoom&&!1===s.enableRotate)return;!function(e){s.enableZoom&&G(e),s.enableRotate&&U(e)}(e),f=h.TOUCH_DOLLY_ROTATE;break;default:f=h.NONE}break;default:f=h.NONE}f!==h.NONE&&s.dispatchEvent(c)}}function Z(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),f){case h.TOUCH_ROTATE:if(!1===s.enableRotate)return;H(e),s.update();break;case h.TOUCH_PAN:if(!1===s.enablePan)return;V(e),s.update();break;case h.TOUCH_DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){s.enableZoom&&z(e),s.enablePan&&V(e)}(e),s.update();break;case h.TOUCH_DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;!function(e){s.enableZoom&&z(e),s.enableRotate&&H(e)}(e),s.update();break;default:f=h.NONE}}function J(e){!1!==s.enabled&&(s.dispatchEvent(d),f=h.NONE)}function $(e){!1!==s.enabled&&e.preventDefault()}s.domElement.addEventListener("contextmenu",$,!1),s.domElement.addEventListener("mousedown",W,!1),s.domElement.addEventListener("wheel",K,!1),s.domElement.addEventListener("touchstart",Q,!1),s.domElement.addEventListener("touchend",J,!1),s.domElement.addEventListener("touchmove",Z,!1),s.domElement.addEventListener("keydown",X,!1),-1===s.domElement.tabIndex&&(s.domElement.tabIndex=0),this.update()};(YE.prototype=Object.create(Ed.prototype)).constructor=YE;var KE=function(e,t){YE.call(this,e,t),this.mouseButtons.LEFT=jc,this.mouseButtons.RIGHT=Bc,this.touches.ONE=Hc,this.touches.TWO=zc};(KE.prototype=Object.create(Ed.prototype)).constructor=KE;var XE=function(e){var t=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var n,r,i,a,o=function(e){t.deviceOrientation=e},s=function(){t.screenOrientation=window.orientation||0},u=(n=new Fd(0,0,1),r=new Kd,i=new Ld,a=new Ld(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(e,t,o,s,u){r.set(o,t,-s,"YXZ"),e.setFromEuler(r),e.multiply(a),e.multiply(i.setFromAxisAngle(n,-u))});this.connect=function(){s(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then((function(e){"granted"==e&&(window.addEventListener("orientationchange",s,!1),window.addEventListener("deviceorientation",o,!1))})).catch((function(e){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",e)})):(window.addEventListener("orientationchange",s,!1),window.addEventListener("deviceorientation",o,!1)),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",s,!1),window.removeEventListener("deviceorientation",o,!1),t.enabled=!1},this.update=function(){if(!1!==t.enabled){var e=t.deviceOrientation;if(e){var n=e.alpha?Ad.degToRad(e.alpha)+t.alphaOffset:0,r=e.beta?Ad.degToRad(e.beta):0,i=e.gamma?Ad.degToRad(e.gamma):0,a=t.screenOrientation?Ad.degToRad(t.screenOrientation):0;u(t.object.quaternion,n,r,i,a)}}},this.dispose=function(){t.disconnect()},this.connect()};var QE=function(){function e(e){this.object=e.camera,this.domElement=e.canvas,this.orbit=new YE(this.object,this.domElement),this.speed=.5,this.orbit.target.set(0,1,-1),this.orbit.enableZoom=!0,this.orbit.enablePan=!1,this.orbit.rotateSpeed=-this.speed,e.orientation&&(this.orientation=new XE(this.object)),e.halfView&&(this.orbit.minAzimuthAngle=-Math.PI/4,this.orbit.maxAzimuthAngle=Math.PI/4)}var t=e.prototype;return t.update=function(){if(this.orientation){this.orientation.update();var e=this.orientation.object.quaternion,t=function(e,t,n,r){var i=e*t+n*r;if(i>.499){var a=2*Math.atan2(e,r);return new Fd(Math.PI/2,0,a)}if(i<-.499){var o=-2*Math.atan2(e,r);return new Fd(-Math.PI/2,0,o)}var s=e*e,u=t*t,l=n*n,c=Math.atan2(2*t*r-2*e*n,1-2*u-2*l);return new Fd(Math.asin(2*i),Math.atan2(2*e*r-2*t*n,1-2*s-2*l),c)}(e.x,e.y,e.z,e.w);void 0===this.lastAngle_&&(this.lastAngle_=t),this.orbit.rotateLeft((this.lastAngle_.z-t.z)*(1+this.speed)),this.orbit.rotateUp((this.lastAngle_.y-t.y)*(1+this.speed)),this.lastAngle_=t}this.orbit.update()},t.dispose=function(){this.orbit.dispose(),this.orientation&&this.orientation.dispose()},t.enable=function(){this.orbit.enabled=!0,this.orientation&&(this.orientation.enabled=!0)},t.disable=function(){this.orbit.enabled=!1,this.orientation&&(this.orientation.enabled=!1)},e}(),ZE=function(e){function n(n,r){var i;return(i=e.call(this)||this).player=n,i.canvas=r,i.onMoveEnd=t.a.bind(o(i),i.onMoveEnd),i.onMoveStart=t.a.bind(o(i),i.onMoveStart),i.onMove=t.a.bind(o(i),i.onMove),i.onControlBarMove=t.a.bind(o(i),i.onControlBarMove),i.player.controlBar.on(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],i.onControlBarMove),i.oldReportUserActivity=i.player.reportUserActivity,i.player.reportUserActivity=function(){},i.canvas.addEventListener("mousedown",i.onMoveStart),i.canvas.addEventListener("touchstart",i.onMoveStart),i.canvas.addEventListener("mousemove",i.onMove),i.canvas.addEventListener("touchmove",i.onMove),i.canvas.addEventListener("mouseup",i.onMoveEnd),i.canvas.addEventListener("touchend",i.onMoveEnd),i.shouldTogglePlay=!1,i}a(n,e);var r=n.prototype;return r.togglePlay=function(){this.trigger("vrtoggleplay")},r.onMoveStart=function(e){this.player.controls()&&("mousedown"!==e.type||t.a.dom.isSingleLeftClick(e))?(this.shouldTogglePlay=!0,this.touchMoveCount_=0):this.shouldTogglePlay=!1},r.onMoveEnd=function(e){if("touchend"===e.type&&this.touchMoveCount_<10)return!1===this.player.userActive()?void this.player.userActive(!0):void this.player.userActive(!1);this.shouldTogglePlay&&"mouseup"===e.type&&this.togglePlay()},r.onMove=function(e){this.touchMoveCount_++,this.shouldTogglePlay=!1},r.onControlBarMove=function(e){this.player.userActive(!0)},r.dispose=function(){this.canvas.removeEventListener("mousedown",this.onMoveStart),this.canvas.removeEventListener("touchstart",this.onMoveStart),this.canvas.removeEventListener("mousemove",this.onMove),this.canvas.removeEventListener("touchmove",this.onMove),this.canvas.removeEventListener("mouseup",this.onMoveEnd),this.canvas.removeEventListener("touchend",this.onMoveEnd),this.player.controlBar.off(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],this.onControlBarMove),this.player.reportUserActivity=this.oldReportUserActivity},n}(t.a.EventTarget),JE=function(e){function t(){return e.apply(this,arguments)||this}return a(t,e),t.prototype.buildCSSClass=function(){return"vjs-big-vr-play-button "+e.prototype.buildCSSClass.call(this)},t}(t.a.getComponent("BigPlayButton"));t.a.registerComponent("BigVrPlayButton",JE);var $E=function(e){function t(t,n){return e.call(this,t,n)||this}a(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-button-vr "+e.prototype.buildCSSClass.call(this)},n.handleClick=function(e){this.active_?(i.a.dispatchEvent(new i.a.Event("vrdisplaydeactivate")),this.active_=!1):(i.a.dispatchEvent(new i.a.Event("vrdisplayactivate")),this.active_=!0)},n.dispose=function(){e.prototype.dispose.call(this)},t}(t.a.getComponent("Button"));t.a.registerComponent("CardboardButton",$E);var eT=t.a.getPlugin("plugin"),tT={},nT=function(e){function n(n,r){var i;return(i=e.call(this,n)||this).options=t.a.mergeOptions(tT,r),i.bigPlayButtonIndex_=n.children().indexOf(n.getChild("BigPlayButton"))||0,navigator.xr||(i.polyfill_=new Fc),i.handleVrDisplayActivate_=t.a.bind(o(i),i.handleVrDisplayActivate_),i.handleVrDisplayDeactivate_=t.a.bind(o(i),i.handleVrDisplayDeactivate_),i.handleResize_=t.a.bind(o(i),i.handleResize_),i.animate_=t.a.bind(o(i),i.animate_),i.currentSession=null,i.on(n,"loadedmetadata",i.init),i.player.ready((function(){i.player.addClass("vjs-xr")})),i}a(n,e);var r=n.prototype;return r.handleVrDisplayActivate_=function(){if(this.xrSupported){var e=this;navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor"]}).then((function(t){e.renderer.xr.setSession(t),e.xrActive=!0,e.currentSession=t,t.requestReferenceSpace("local").then((function(t){e.xrReferenceSpace=t})),e.controls3d.disable(),e.trigger("xrSessionActivated")}))}},r.handleVrDisplayDeactivate_=function(){this.xrSupported&&(this.animationFrameId_&&(this.currentSession.cancelAnimationFrame(this.animationFrameId_),this.animationFrameId_=0),this.currentSession.end(),this.currentSession=null,this.xrActive=!1,this.controls3d.enable(),this.trigger("xrSessionDeactivated"))},r.requestAnimationFrame=function(e){return this.xrActive?this.currentSession.requestAnimationFrame(e):this.player.requestAnimationFrame(e)},r.cancelAnimationFrame=function(e){return this.player.cancelAnimationFrame(e)},r.togglePlay_=function(){this.player.paused()?this.player.play():this.player.pause()},r.animate_=function(e,t){this.initialized_&&(this.getVideoEl_().readyState===this.getVideoEl_().HAVE_ENOUGH_DATA&&this.videoTexture&&(this.videoTexture.needsUpdate=!0),this.camera.getWorldDirection(this.cameraVector),this.animationFrameId_=this.requestAnimationFrame(this.animate_),this.xrActive||this.controls3d.update(),this.xrActive&&t&&(this.xrPose=t.getViewerPose(this.xrReferenceSpace),this.trigger("xrCameraUpdate")),this.renderer.render(this.scene,this.camera))},r.handleResize_=function(){var e=this.player.currentWidth(),t=this.player.currentHeight();this.camera.aspect=e/t,this.camera.updateProjectionMatrix()},r.init=function(){this.reset(),this.xrSupported=!1,this.camera=new sp(75,this.player.currentWidth()/this.player.currentHeight(),1,1e3),this.cameraVector=new Fd,this.camera.layers.enable(1),this.scene=new ch,this.videoTexture=new pv(this.getVideoEl_()),this.videoTexture.generateMipmaps=!1,this.videoTexture.minFilter=$c,this.videoTexture.magFilter=$c,this.videoTexture.format=od;var e=0,t=0,n=0;this.scene&&this.scene.remove(this.movieScreen),this.movieGeometry=new my(256,32,32),this.movieMaterial=new uf({map:this.videoTexture,side:1}),this.movieScreen=new Yf(this.movieGeometry,this.movieMaterial),this.movieScreen.position.set(e,t,n),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.scene.add(this.movieScreen),this.player.removeChild("BigPlayButton"),this.player.addChild("BigVrPlayButton",{},this.bigPlayButtonIndex_),this.player.bigPlayButton=this.player.getChild("BigVrPlayButton"),this.camera.position.set(0,0,0),this.renderer=new mg({devicePixelRatio:window.devicePixelRatio,alpha:!1,clearColor:16777215,antialias:!0}),this.renderer.setSize(this.player.currentWidth(),this.player.currentHeight()),this.renderedCanvas=this.renderer.domElement,this.renderedCanvas.setAttribute("style","width: 100%; height: 100%; position: absolute; top:0;");var r=this.getVideoEl_().style;if(this.player.el().insertBefore(this.renderedCanvas,this.player.el().firstChild),r.zIndex="-1",r.opacity="0",this.xrActive=!1,!this.controls3d){var i={camera:this.camera,canvas:this.renderedCanvas,halfView:!1,orientation:!1};this.controls3d=new QE(i),this.canvasPlayerControls=new ZE(this.player,this.renderedCanvas)}if(window.navigator.xr){this.renderer.xr.enabled=!0;var a=this;navigator.xr.isSessionSupported("immersive-vr").then((function(e){e?(a.xrSupported=!0,a.addCardboardButton_(),console.log("webxr session supported")):console.log("web xr device not found, using orbit controls")}))}else console.log("web xr not available");a.completeInitialization(),this.animationFrameId_=this.requestAnimationFrame(this.animate_),this.on(this.player,"fullscreenchange",this.handleResize_),window.addEventListener("vrdisplaypresentchange",this.handleResize_,!0),window.addEventListener("resize",this.handleResize_,!0),window.addEventListener("vrdisplayactivate",this.handleVrDisplayActivate_,!0),window.addEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_,!0)},r.completeInitialization=function(){this.initialized_=!0,this.trigger("initialized")},r.addCardboardButton_=function(){this.player.controlBar.getChild("CardboardButton")||this.player.controlBar.addChild("CardboardButton",{})},r.getVideoEl_=function(){return this.player.el().getElementsByTagName("video")[0]},r.reset=function(){if(this.initialized_){this.controls3d&&(this.controls3d.dispose(),this.controls3d=null),this.canvasPlayerControls&&(this.canvasPlayerControls.dispose(),this.canvasPlayerControls=null),window.removeEventListener("resize",this.handleResize_,!0),window.removeEventListener("vrdisplaypresentchange",this.handleResize_,!0),window.removeEventListener("vrdisplayactivate",this.handleVrDisplayActivate_,!0),window.removeEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_,!0),this.player.getChild("BigPlayButton")||this.player.addChild("BigPlayButton",{},this.bigPlayButtonIndex_),this.player.getChild("BigVrPlayButton")&&this.player.removeChild("BigVrPlayButton"),this.player.getChild("CardboardButton")&&this.player.controlBar.removeChild("CardboardButton");var e=this.getVideoEl_().style;e.zIndex="",e.opacity="",this.renderedCanvas&&this.renderedCanvas.parentNode.removeChild(this.renderedCanvas),this.animationFrameId_&&this.cancelAnimationFrame(this.animationFrameId_),this.initialized_=!1}},r.dispose=function(){this.reset(),e.prototype.dispose.call(this)},r.polyfillVersion=function(){return Fc.version},n}(eT);nT.defaultState={},nT.VERSION="0.0.2",t.a.registerPlugin("xr",nT)}).call(this,n(27))},function(e,t,n){},function(e,t,n){},function(e,t,n){var r=n(1192),i=n(1193),a=n(1194),o=n(1196);e.exports=function(e,t){return r(e)||i(e,t)||a(e,t)||o()}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}},function(e,t,n){var r=n(1195);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}])}));
//# sourceMappingURL=main.ba8dc4f0348d7754b624.js.map